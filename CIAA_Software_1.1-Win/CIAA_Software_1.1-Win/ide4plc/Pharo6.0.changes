'From Pharo6.0 of 13 May 2016 [Latest update: #60493] on 17 May 2017 at 1:01:41.053846 pm'!----QUIT----2017-05-17T13:02:17.571196+02:00 Pharo-60493.image priorSource: 0!----QUIT----2017-05-17T13:02:52.052925+02:00 Pharo-60493.image priorSource: 92!----QUIT/NOSAVE----2017-05-17T13:03:08.259387+02:00 Pharo-60493.image priorSource: 172!----QUIT----2017-05-17T13:03:42.089076+02:00 Pharo-60493.image priorSource: 172!----QUIT----2017-05-17T13:09:56.388095+02:00 Pharo-60493.image priorSource: 342!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 5/17/2017 15:15' prior: 59349094!commentForCurrentUpdate ^ '20064 ClassTest>>#testMethodsReferencingClass uses non-existing BehaviorTests	https://pharo.fogbugz.com/f/cases/20064'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 5/17/2017 15:15'!script60494	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.144.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.52.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.15.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.192.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.101.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.6.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2510.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.173.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.615.mczMorphic-Core-TheIntegrator.313.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.49.mczPharoBootstrap-Initialization-TheIntegrator.4.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.386.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.181.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.71.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.37.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.38.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 5/17/2017 15:15'!update60494	"self new update60494"	self withUpdateLog: '20064 ClassTest>>#testMethodsReferencingClass uses non-existing BehaviorTests	https://pharo.fogbugz.com/f/cases/20064'.	self loadTogether: self script60494 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60493!ScriptLoader removeSelector: #script60493!"ScriptLoader60"!!ClassTest methodsFor: 'testing - navigation' stamp: 'PavelKrivanek 5/16/2017 14:47' prior: 19489936!testMethodsReferencingClass	self assert: (ClassTest methodsReferencingClass: (Smalltalk classNamed: #ExampleForTest111)) equals: {(ClassTest >> #testOrdersACollectionOfClassesBySuperclass)}.	self		assert: ((ClassTest methodsReferencingClass: (Smalltalk classNamed: #ExampleForTest1)) sort: [ :a :b | a name <= b name]) asArray		equals:			{ClassTest>>#referencingMethod1. 			ClassTest>>#referencingMethod2. 			ClassTest>>#testOrdersACollectionOfClassesBySuperclass}.	self assert: (ClassTest methodsReferencingClass: (Smalltalk classNamed: #BehaviorTest)) isEmpty! !"Kernel-Tests"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.568.mcz') load.ScriptLoader new update60494.!----End fileIn----!----QUIT----2017-05-18T09:47:15.580373+02:00 Pharo.image priorSource: 424!----QUIT----2017-05-18T09:47:26.423036+02:00 Pharo.image priorSource: 20220!----QUIT----2017-05-19T09:35:29.483671+02:00 Pharo.image priorSource: 20296!----QUIT----2017-05-19T09:35:36.656906+02:00 Pharo.image priorSource: 20374!----QUIT----2017-05-19T14:15:05.912563+02:00 Pharo.image priorSource: 20452!----QUIT----2017-05-19T14:15:13.143532+02:00 Pharo.image priorSource: 20530!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 5/22/2017 09:50' prior: 33555030!commentForCurrentUpdate ^ '20064 ClassTest>>#testMethodsReferencingClass uses non-existing BehaviorTests	https://pharo.fogbugz.com/f/cases/2006420074 Red-pane-of-death when sources file missing	https://pharo.fogbugz.com/f/cases/20074'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 5/22/2017 09:50'!script60495	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.144.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.52.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.15.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.192.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.101.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.6.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2510.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.173.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.615.mczMorphic-Core-TheIntegrator.313.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.49.mczPharoBootstrap-Initialization-TheIntegrator.4.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.386.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.181.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.37.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.38.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 5/22/2017 09:50'!update60495	"self new update60495"	self withUpdateLog: '20064 ClassTest>>#testMethodsReferencingClass uses non-existing BehaviorTests	https://pharo.fogbugz.com/f/cases/2006420074 Red-pane-of-death when sources file missing	https://pharo.fogbugz.com/f/cases/20074'.	self loadTogether: self script60495 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60494!ScriptLoader removeSelector: #script60494!"ScriptLoader60"!!SourceFileArray methodsFor: 'private' stamp: 'BenComan 5/21/2017 23:27' prior: 61198173!createReadOnlyFiles	| readOnly failed |		failed := false.	readOnly := files collect: [ :file | 		file 			ifNil: [  failed := true. nil ]			ifNotNil: [ [ file readOnlyCopy ]         		on: FileDoesNotExistException        		do: [ failed := true. nil ] ]	].	^ failed ifFalse: [ readOnly ] ifTrue: [ self closeFileArray: readOnly. nil ]! !"System-Sources"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.571.mcz') load.ScriptLoader new update60495.!----End fileIn----!----QUIT----2017-05-22T09:53:26.771406+02:00 Pharo.image priorSource: 20608!----QUIT----2017-05-22T09:53:36.987945+02:00 Pharo.image priorSource: 40350!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 5/23/2017 11:30' prior: 33575210!commentForCurrentUpdate ^ '20068 Change sources file name for bootstrapped image	https://pharo.fogbugz.com/f/cases/20068'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 5/23/2017 11:30'!script60496	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.144.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.52.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.15.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.192.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.101.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.6.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2510.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.173.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.615.mczMorphic-Core-TheIntegrator.313.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.49.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.386.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.181.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.37.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.38.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 5/23/2017 11:30'!update60496	"self new update60496"	self withUpdateLog: '20068 Change sources file name for bootstrapped image	https://pharo.fogbugz.com/f/cases/20068'.	self loadTogether: self script60496 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60495!ScriptLoader removeSelector: #script60495!"ScriptLoader60"!!PharoBootstrapInitialization class methodsFor: 'public api' stamp: 'PavelKrivanek 5/18/2017 15:54' prior: 54387033!initializeCommandLineHandlerAndErrorHandling	"This method is run before the new bootstrapped image is saved!!"	ProcessorScheduler initialize.		Delay initialize.	SmallInteger initialize.		ProcessorScheduler startUp.		OSPlatform startUp: true.		"2 following lines are used to initialize Unicode tag constants.	Must be replaced by an uptodate version of Unicode class>>#initializeTagConstants and a call to it"	#(#Cc #Cf #Co #Cs #Ll #Lm #Lo #Lt #Lu #Mc #Me #Mn #Nd #Nl #No #Pc #Pd #Pe #Pf #Pi #Po #Ps #Sc #Sk #Sm #So #Zl #Zp #Zs)			doWithIndex: [ :each :index | Unicode classPool at: each put: index ].Unicode classPool at: #Cn put: 0.	UnicodeDefinitions initializeUnicodeClass.	EncodedCharSet initialize.	String initialize.	ByteString initialize. "needed by TextConverter to install LineEnd convention (called by Smalltalk openLog)"	ZnUTF8Encoder initialize.			"Weak array class initialization 2 lines"	Smalltalk specialObjectsArray at: 42 put: Semaphore new."to put in EPObjectSpace>>#createSpecialObjectsArray?"	WeakArray restartFinalizationProcess.		DiskStore useFilePlugin "initialize".	FileStream initialize.	FileStream classVarNamed: 'TheStdioHandles' put: FileStream stdioHandles. "FileStream startup"	ByteTextConverter initialize.	MultiByteFileStream initialize.	ASTCache default: ASTCache new. "ASTCache initialize, neeeded to print stack on error"	FileLocator startUp: true. "FileLocator initialize"	Smalltalk globals 		at: #Transcript		put: (NonInteractiveTranscript stdout install).	CompilationContext initialize.	Float initialize.	ZipConstants initialize.	ZipWriteStream initialize.	"Initialize classes related to compiler"	InflateStream initialize.	ByteTextConverter initialize.	ZipWriteStream initialize.	SetElement initialize.	ExternalSemaphoreTable initialize.	MacRomanTextConverter initialize.	Collection initialize.	ISOLanguageDefinition initialize.	CompiledMethod initialize.	MD5NonPrimitive initialize.	DangerousClassNotifier initialize.	Categorizer initialize.	Slot initialize.	CP1252TextConverter initialize.	SHA1 initialize.	TraitBehavior initialize.	RPackage initialize.	CompilationContext initialize.	OCASTTranslator initialize.	UIManager classVarNamed: 'Default' put: NonInteractiveUIManager new.	UIManager default activate.	Smalltalk sourceFileVersionString: 'PharoV60'.	(Smalltalk class classVariableNamed: 'LastImagePath') value: Smalltalk imagePath. "set the default value"	SourceFiles := SourceFileArray new ensureOpen. "needed to get source from a compiled method, used to log an error."	Smalltalk openSourceFiles.		BasicCommandLineHandler new activate. "BasicCommandLineHandler startUp:"	Processor terminateActive.! !"PharoBootstrap-Initialization"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.572.mcz') load.ScriptLoader new update60496.!----End fileIn----!----QUIT----2017-05-23T11:33:20.381382+02:00 Pharo.image priorSource: 40428!----QUIT----2017-05-23T11:33:30.825145+02:00 Pharo.image priorSource: 62354!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 5/23/2017 15:34' prior: 33595030!commentForCurrentUpdate ^ '20084 Highlight Message Send is not enabled by default in bootstrapped/reloaded image	https://pharo.fogbugz.com/f/cases/2008420072 Importing Resource Help needs improvement	https://pharo.fogbugz.com/f/cases/2007219809 Failing test: WeakAnnouncerTest>>#testNoDeadWeakSubscriptions	https://pharo.fogbugz.com/f/cases/19809'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 5/23/2017 15:34'!script60497	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.144.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.15.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.192.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.101.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2510.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.173.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.615.mczMorphic-Core-TheIntegrator.313.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.49.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.386.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.181.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.37.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.38.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 5/23/2017 15:34'!update60497	"self new update60497"	self withUpdateLog: '20084 Highlight Message Send is not enabled by default in bootstrapped/reloaded image	https://pharo.fogbugz.com/f/cases/2008420072 Importing Resource Help needs improvement	https://pharo.fogbugz.com/f/cases/2007219809 Failing test: WeakAnnouncerTest>>#testNoDeadWeakSubscriptions	https://pharo.fogbugz.com/f/cases/19809'.	self loadTogether: self script60497 merge: false.	(SystemAnnouncer uniqueInstance subscriptions glmSubscriptions select: [:sub | sub subscriber isNil]) do: #finalize. 3 timesRepeat: [Smalltalk garbageCollect ].	self flushCaches.! !ScriptLoader removeSelector: #update60496!ScriptLoader removeSelector: #script60496!"ScriptLoader60"!!ImportingResourceHelp class methodsFor: 'documentation' stamp: 'AlexandreBergel 5/19/2017 15:40' prior: 29378986!encodingAndDecoding	^ HelpTopic 		title: 'Encoding and Decoding'		contents: (self heading: 'Encoding and Decoding'),'The basic mechanism to encode and decode data is provided by the class Base64MimeConverter. Consider the following example:mimeEncoded := ''Hello World'' asByteArray base64Encoded.(Base64MimeConverter mimeDecodeToBytes: mimeEncoded readStream) contents asStringThe variable mimeEncoded contains an encoding of the Hello World string using the mime64 encoding. The method #mimeDecodeToBytes: reads mime64 strings from a stream. The example uses a string, but it could refers to any objects. You essentially need a ReadStream. '! !!ImportingResourceHelp class methodsFor: 'documentation' stamp: 'AlexandreBergel 5/19/2017 15:48'!encodingAndDecodingImage	^ HelpTopic 		title: 'Encoding and Decoding Image'		contents: (self heading: 'Encoding and Decoding Image'),'Embedding pictures in plan source code is often the reason why one need to encode resources. The following script loads an image located in the filesystem, create a string-friendly representation, and store it in a method. You probably want to keep the image in a class variable or a hash table.',(self bold: 'form := PNGReadWriter formFromStream: ''/Users/alexandrebergel/Dropbox/Screenshots/Screenshot 2017-05-19 15.25.44.png'' asFileReference readStream."Write the stream on a stream"w := WriteStream on: ByteArray new.PNGReadWriter putForm: form onStream: w.w contents."Convert the byteArray into mime 64. It takes less space in the image"encodedContent := w contents base64Encoded."The following code converts the stream content "PNGReadWriter formFromStream: (Base64MimeConverter mimeDecodeToBytes: encodedContent readStream)."We encode the image as a method"Object compile: ''imageSource  ^ '''',  encodedContent, ''''.Object compile: ''image ^ PNGReadWriter formFromStream: (Base64MimeConverter mimeDecodeToBytes: self imageSource readStream). ''."A better implementation is to cache the image in an instance or class variable""The following expression return the image initially encoded"Object new image '),''! !!ImportingResourceHelp class methodsFor: 'documentation' stamp: 'AlexandreBergel 5/19/2017 15:39' prior: 29378243!overview	^ HelpTopic 		title: 'Overview'		contents: (self heading: 'Overview'),'Non trivial applications often rely on resources that may be externally provided such as icons, pictures, sounds. Such resources are typically defined as external files. Naturally, you can make your application depends on external files, however, importing resource files within the Pharo image and make it integrally part of you code has a number of advantages:- you can simply deploy your application by downloading it from smalltalkhub. - having less dependencies on external files is always good to avoid technical subtilities such as file path containing weird characters. '! !!ImportingResourceHelp class methodsFor: 'accessing' stamp: 'AlexandreBergel 5/19/2017 15:40' prior: 29380828!pages	^#(overview encodingAndDecoding encodingAndDecodingImage)! !!BaselineOfIDE methodsFor: 'actions' stamp: 'PavelKrivanek 5/23/2017 12:47' prior: 18109028!additionalInitialization	self class environment at: #GTGenericStackDebugger ifPresent: [	  Smalltalk tools register: GTGenericStackDebugger as: #debugger.	  Smalltalk tools registeredDebuggersWithRanks.	  Smalltalk tools debuggers add: ((self class environment at: #GTGenericStackDebugger)->3).	  Smalltalk tools debuggers add: ((self class environment at: #GTSUnitDebugger)->70).	  Smalltalk tools debuggers add: ((self class environment at: #GTBytecodeDebugger)->5).].	  	self class environment at: #GTPlayground ifPresent: [:playground | 	  Smalltalk tools register: playground as: #workspace.].	self class environment at: #GTInspector ifPresent: [:inspector | 	  Smalltalk tools register: inspector as: #inspector.].	  Smalltalk tools register: ExternalChangesBrowser as: #changeList.	Smalltalk tools register: FileList as: #fileList.	Smalltalk tools register: Finder as: #finder.	Smalltalk tools register: ProcessBrowser as: #processBrowser.	Smalltalk tools register: RecentMessageList as: #recentMessageList.	Smalltalk tools register: SyntaxErrorDebugger as: #syntaxErrorDebugger.	Smalltalk tools register: TimeProfiler as: #timeProfiler.	(MorphicCoreUIManager classPool at: #UIProcess) ifNotNil: [ :proc | proc terminate ].	MorphicCoreUIManager classPool at: #UIProcess put: nil.	PolymorphSystemSettings desktopColor:  Color veryVeryLightGray lighter.	SourceCodeFonts setSourceCodeFonts: 10.	FreeTypeSystemSettings loadFt2Library: true.	FreeTypeSettings current monitorType: #LCD.	FreeTypeSettings current glyphContrast: 55.		CatalogSettings displayCatalogProjectsInSpotter: false.	RealEstateAgent usedStrategy: #cascadeFor:initialExtent:world:.	GrowlMorph position: #bottomLeft.	ShortcutReminder enabled: true.	self class environment at: #QASettings ifPresent: [:qaSettings |	  qaSettings nautilusPlugin: true].	KMRepository reset.	Morph shortcutsHandler: KMShortcutHandler new.	"because of Komitter"	MCSaveVersionDialog previousMessages add: String new.	RBProgramNode formatterClass: BIConfigurableFormatter.	Color flushCache.	ASTTransformExamplePluginActive recompile.	PharoCommandLineHandler recompile.	SmalltalkImage recompile.		RubCharacterScanner initialize.		RubAbstractTextArea highlightMessageSend: true.		Pharo3DarkTheme beCurrent.		Smalltalk ui theme settings secondarySelectionColor: (Color r: 0.31 g: 0.31 b: 0.36 alpha: 1.0).		3 timesRepeat: [		Smalltalk garbageCollect.		Undeclared removeUnreferencedKeys.].		self loadIceberg.! !"BaselineOfIDE"!"ImportingResource-Help"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.573.mcz') load.ScriptLoader new update60497.!----End fileIn----!----QUIT----2017-05-23T15:38:14.333294+02:00 Pharo.image priorSource: 62432!----QUIT----2017-05-23T15:38:24.907147+02:00 Pharo.image priorSource: 87995!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 6/1/2017 15:55' prior: 33617034!commentForCurrentUpdate ^ '20095 SystemProgressMorph should call doOneCycleNow on refresh only when active process is UIProcess	https://pharo.fogbugz.com/f/cases/2009520099 Cairo fonts crashing on 64bits	https://pharo.fogbugz.com/f/cases/20099'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 6/1/2017 15:55'!script60498	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.15.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.192.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.101.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2510.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.173.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.313.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.49.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.386.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.181.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.37.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.38.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 6/1/2017 15:55'!update60498	"self new update60498"	self withUpdateLog: '20095 SystemProgressMorph should call doOneCycleNow on refresh only when active process is UIProcess	https://pharo.fogbugz.com/f/cases/2009520099 Cairo fonts crashing on 64bits	https://pharo.fogbugz.com/f/cases/20099'.	self loadTogether: self script60498 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60497!ScriptLoader removeSelector: #script60497!"ScriptLoader60"!!SystemProgressMorph methodsFor: 'updating' stamp: 'DenisKudryashov 5/30/2017 18:12' prior: 63149702!refresh	"We may be blocking the UI thread, and thus have to draw the world ourselves when necessary"	lastRefresh := Time millisecondClockValue.	UIManager default uiProcess == Processor activeProcess		ifTrue: [ self currentWorld doOneCycleNow]! !!CairoFontFace class methodsFor: 'instance creation' stamp: 'EstebanLorenzano 6/1/2017 12:10' prior: 18768599!fromFreetypeFace: aFace	| handle cairoFace |		handle := aFace handle pointerAt: 1. 	cairoFace := self primFtFace: handle loadFlags: ( LoadNoHinting | LoadTargetLCD | LoadNoAutohint | LoadNoBitmap). 		^ cairoFace initializeWithFreetypeFace: aFace! !!CairoFontFace class methodsFor: 'instance creation' stamp: 'EstebanLorenzano 6/1/2017 12:10' prior: 18768082!primFtFace: aFace loadFlags: flags"cairo_font_face_t * cairo_ft_font_face_create_for_ft_face                                                        (FT_Face face,                                                         int load_flags);"	<primitive: #primitiveNativeCall module: #NativeBoostPlugin error: errorCode>		^ self nbCall: #( CairoFontFace cairo_ft_font_face_create_for_ft_face(void * aFace , int flags )) ! !!CairoScaledFont class methodsFor: 'instance creation' stamp: 'EstebanLorenzano 6/1/2017 12:09' prior: 18799108!fromFreetypeFont: aFont	| ftFace face |	^ CairoBackendCache soleInstance at: aFont ifAbsentPut: [ | emphasis |			emphasis := aFont simulatedEmphasis.			ftFace := aFont face.			face := CairoBackendCache soleInstance 				at: {ftFace.	emphasis} 				ifAbsentPut: [ | cff |					cff := CairoFontFace fromFreetypeFace: ftFace.					emphasis ifNotNil: [ cff synthesizeEmphasis: emphasis ].					cff ].			self fromFreetypeFont: aFont cairoFace: face ]! !!AthensCairoMatrix class methodsFor: 'field definition' stamp: 'EstebanLorenzano 6/1/2017 15:34' prior: 17537657!fieldsDesc	"self rebuildFieldAccessors"	^ #(   double sx; double shx;   double shy; double sy;   double x; double y;	)! !!SystemProgressItemMorph methodsFor: 'private' stamp: 'DenisKudryashov 5/30/2017 18:12' prior: 63145033!refresh	lastRefresh := Time millisecondClockValue.	UIManager default uiProcess == Processor activeProcess		ifTrue: [ self currentWorld doOneCycleNow ]! !"Athens-Cairo"!"Morphic-Base"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.574.mcz') load.ScriptLoader new update60498.!----End fileIn----!----QUIT----2017-06-01T15:57:07.284048+02:00 Pharo.image priorSource: 88073!----QUIT----2017-06-01T15:57:17.746509+02:00 Pharo.image priorSource: 109737!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 6/6/2017 15:11' prior: 33642674!commentForCurrentUpdate ^ '20102 SmallInteger>>#digitAt: not ready for 64-bit - Some Kernel-Tests-Numbers fail to take 64-bit into account	https://pharo.fogbugz.com/f/cases/2010220070 terminal color not reset after a error message	https://pharo.fogbugz.com/f/cases/2007019949 ensureEndsWith: does not handle start of stream case	https://pharo.fogbugz.com/f/cases/1994920101 Typos and general writing of release welcome text	https://pharo.fogbugz.com/f/cases/20101'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 6/6/2017 15:11'!script60499	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.194.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.103.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2513.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.175.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.313.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.386.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.37.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.38.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 6/6/2017 15:11'!update60499	"self new update60499"	self withUpdateLog: '20102 SmallInteger>>#digitAt: not ready for 64-bit - Some Kernel-Tests-Numbers fail to take 64-bit into account	https://pharo.fogbugz.com/f/cases/2010220070 terminal color not reset after a error message	https://pharo.fogbugz.com/f/cases/2007019949 ensureEndsWith: does not handle start of stream case	https://pharo.fogbugz.com/f/cases/1994920101 Typos and general writing of release welcome text	https://pharo.fogbugz.com/f/cases/20101'.	self loadTogether: self script60499 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60498!ScriptLoader removeSelector: #script60498!"ScriptLoader60"!!WelcomeHelp class methodsFor: 'pages' stamp: 'PhilippeBack 6/1/2017 18:10' prior: 84508630!changeLog	^ HelpTopic 		title: 'ChangeLog'		contents: (self heading: 'Highlights (aka New Stuff) in Pharo 6.0'),'- The PharoVM and image are also provided in a 64-bit version in Linux and macOS/OSX and bring even better performance and stability- A new code changes management system named Epicea for reviewing and recovering of your code easily- Integrated support for Git through an easy-to-use tool for repositories and commits management named Iceberg (as a preview in Pharo 6, it will be the default in Pharo 7)- The unified foreign function interface (UnifiedFFI) for interfacing with the outside world is significantly improved- The PharoVM is now part of OpenSmalltalk initiative- Introduction of object immutability, alternative bytecode sets and block closures independent of outer context- Pharo can now be bootstrapped from source code managed by Git- Pharo modularity is improved- Pharo is faster- The Dark Theme was improved and set as default color theme of Pharo', (self heading: 'All Issues'), 'Over 1400 fixes and enhancements were integrated in this release.As the complete list of fixed issues is too large to be placed here, you can review it on the FogBugz issue tracker (', (self url: 'https://pharo.fogbugz.com'), ') (requires account).', (self subheading: 'Tools'),'- Epicea provides a code changes manager- Iceberg provides a Git repositories manager- GTInspector, GTDebugger and other tools are now based on FastTable (long lists of items are rendered much faster)- GToolkit and GTools have been updated- Quality Assistant has been improved- Interrupt key (Cmd+ /, Ctrl+.) has been made more reliable- Playground variables are now visible from debugger- Debugger temp names mapping is fixed- There is a "Close all debuggers"  in the taskbar context menu- GTDebugger has a "Run to here" feature- Results and critiques can be filtered in the MessageBrowser- Dependency Analyzer has been improved- Nautilus enhancements        - Splitting of large variable entries in the Variables menu        - Deprecated methods are shown with strikethrough emphasis        - Abstract classes are shown in italics with a slight color adjustment', (self subheading: 'VM related'), '- 64-bits support- Improvement of host platforms management (32-bit/64-bit)- Improved UnifiedFFI- The PharoVM is now part of OpenSmalltalk initiative- Introduction of object immutability- Introduction of FullBlockClosure which will help in future evolutions of Pharo- Ephemerons support, introduction of the EphemeronRegistry- Support of alternative bytecode sets and introduction of Sista Encoder, the encoder for the SistaV1 bytecode set. This will be the bedrock on which Pharo will improve',(self subheading: 'Reflectivity'), '- General improvements- haltOnce is active by default per method. It does not require global turning on (enable haltOnce) and it is managed from the source code area in Nautilus- Execution counter for message nodes in the source code area in Nautilus- API for Metalinks on AST nodes- Mirror primitives (Those are reflection primitives which access object state without messaging them, see MirrorPrimitives class)- Inlined method const can be implemented by Metalinks', (self subheading: 'Other'), '- Dark Theme improvements- Improvement of theme change while windows are open- Support of two double quotes inside comments- Standalone Morphic worlds in separate windows- Fix of several memory leaks- Improvement of working directory structure (introduction of a ''pharo-local'' directory to include Pharo directories such as ''package-cache'')- Better autocategorization of methods- Introduction of a FuzzyMatcher for approximate string matching- Glamour integration in Spec- Renaming (Cmd+R / Ctrl+R) in Nautilus supports more AST nodes- anObject asMethodConst to cache expressions dynamically- GlobalIdentifier for computer identification- NeoUUIDGenerator replaces the old UUIDGenerator- STON was improved and is now used by Monticello FileTree- Storage of suspended announcements- Improved newAnonymousSubclass- Inheritable process specific variables- Fuel improvements- Enablement of <example> methods so that they can be executed easily- Support for <sampleInstance>- New class and method API for tags as replacement for categories and protocols- TabMorph improvements- Unification of Dictionary APIs (including an OrderedDictionary)- Package manifests improvements- Improvement of RadioButton groups', (self subheading: 'Cleanups'), '- Object>>#name is now deprecated and will be removed in Pharo 7- Better system modularization- Ability for the system to be fully bootstrapped from source code- Turn off of catalog search in Spotter by default (This improves the stability of Pharo when used with poor Internet connections)- Removal of Chroma-CubeHelix and TxWorkspace- Rename of Pragma>>#selector to Pragma>>#methodSelector- Improvement of icons management (#iconNamed: introduced in order to replace DNU-based icons)- Limit use of #asClass in order to rely on an environment- It is now possible to give a rewrite rule when deprecating a method to automatically rewrite code with deprecation (#deprecated:transformWith:)- Deprecation of the following:        Object>>name        ShortRunArray class        Object>>confirm:orCancel:        Object>>ifNil:ifNotNilDo:        Object>>ifNotNilDo:        Object>>ifNotNilDo:ifNil:        Collection>>ifEmpty:ifNotEmptyDo:        Collection>>ifNotEmptyDo:        Collection>>ifNotEmptyDo:ifEmpty:        SequenceableCollection>>copyLast:        Integer>>asBytesDescription        Pragma>>method:', (self subheading: 'Unit testing/Documentation'), '- RecursionStopper provides an easy way to check if we are in a recursion and execute code just once in a recursion- New process specific variable ''CurrentExecutionEnvironment'' with value DefaultExecutionEnvironment by default and TestExecutionEnvironment during a test run- SUnit is improved by introducing a time limit for tests, preventing "forked debuggers"- New assert extension to compare floats with #closeTo:- More class comments and documentation', (self subheading: 'Network'), '- Support Server Name Indication (SNI) in Zodiac/SSLPlugin- Zinc/Zodiac updateYou can see the Pharo 6.0 changelog at: ', (self url: 'https://github.com/pharo-project/pharo-changelogs/blob/master/Pharo60ChangeLogs.md')! !!WelcomeHelp class methodsFor: 'pages' stamp: 'PhilippeBack 6/1/2017 17:54' prior: 84516114!documentation	^ HelpTopic 		title: 'More Documentation'		contents: (self heading: 'More Documentation'), 			'The most important documentation is the one you can get by exploring the system, reading class comments and looking for examples. You can find "in image" help by clicking on the following expression:', (self doItFrom: 'HelpBrowser open.'), 'This browser is also accessible from the World>Help>Help Browser menu (just click the desktop, select Help, and then Help Browser).A compendium of Pharo documentation can be found at: ', (self url: 'http://pharo.org/documentation'), 'There you can find:- Pharo books: ', (self url: 'http://books.pharo.org'), '- Screencasts: ', (self url: 'https://www.youtube.com/channel/UCp3mNigANqkesFzdm058bvw'), '- Presentations: ', (self url: 'http://www.slideshare.net/pharoproject/')! !!WelcomeHelp class methodsFor: 'pages' stamp: 'PhilippeBack 6/1/2017 17:54' prior: 84519806!exploreEnvironment	^ HelpTopic 		title: 'Explore the Pharo Environment'		contents: (self heading: 'Explore the Pharo Environment'), 				'The best way to learn Pharo is to explore it by yourself. This is live objects all the way down: they can be inspected, browsed, changed... everything in the environment you have in your hands.But sometimes it can be hard to get started with the tools and capabilities the environment provides.The most complete and updated guide for the Pharo environment can be found in the "Updated Pharo by Example" free book. It is still a work in progress, but most of it is already done. You can find the book here: ', (self url: 'https://github.com/SquareBracketAssociates/UpdatedPharoByExample'), 'One chapter of particular interest is the one that provides a quick tour of the environment: ', (self url: 'https://ci.inria.fr/pharo-contribution/job/UpdatedPharoByExample/lastSuccessfulBuild/artifact/book-result/PharoTour/PharoTour.pdf')! !!WelcomeHelp class methodsFor: 'pages' stamp: 'PhilippeBack 6/1/2017 17:55' prior: 84515442!gettingHelp	^ HelpTopic 		title: 'Getting Help'		contents: (self heading: 'Getting Help'),		'Pharo has a vibrant community that shares knowledge in different ways: - The "Pharo Users" mailing list: 	', (self url: 'http://lists.pharo.org/mailman/listinfo/pharo-users_lists.pharo.org'), '- The "Pharo Discord channel": 	', 	(self url: 'http://discord.gg/Sj2rhxn'), '- The "Pharo IRC Channel": 	', (self url: 'irc.freenode.net, #pharo channel '), 'You can find more information, lists to browse/suscribe and places to share code at: ', (self url: 'http://pharo.org/community')! !!WelcomeHelp class methodsFor: 'pages' stamp: 'PhilippeBack 6/1/2017 18:11' prior: 84518270!learn	^ HelpTopic 		title: 'Learn Pharo'		contents: (self heading: 'Learn Pharo'), 		'You can learn Pharo by clicking on the following expression: 	', (self doItFrom: 'ProfStef go.'), (self subheading: 'MOOC'), 'Pharo has an excellent MOOC (Massive Open Online Course). You can find more information here: ', (self url: 'http://mooc.pharo.org'), (self subheading: 'Books'), 'There are several free Pharo books that can be download here: ', (self url: 'http://books.pharo.org'), 'A very interesting starting point would be looking into the "Updated Pharo by Example" free book. It is still a work in progress, but most of it is already done. You can find the book here: ', (self url: 'https://github.com/SquareBracketAssociates/UpdatedPharoByExample'), ''! !!WelcomeHelp class methodsFor: 'showing' stamp: 'PhilippeBack 6/1/2017 17:23' prior: 84517046!open	<script>	^ (HelpBrowser openOn: self) next! !!WelcomeHelp class methodsFor: 'showing' stamp: 'PhilippeBack 6/1/2017 17:24' prior: 84515001!openForRelease	<script>	| browser window findBlock |		findBlock := [ :each | (each isKindOf: SystemWindow) and: [ each label = self bookName ] ]. 	World submorphs 		detect: findBlock 		ifFound: [ :oldWindow | oldWindow delete ].	browser := self open.	window := browser dependents detect: findBlock.	window extent: 700@400.	window center: Display extent / 2! !!WelcomeHelp class methodsFor: 'pages' stamp: 'PhilippeBack 6/1/2017 18:13' prior: 84517171!useExternalPackages	^ HelpTopic 		title: 'Using Eternal Packages'		contents: (self heading: 'Using External Packages'), 'Pharo already comes pre-loaded with a rich set of packages that you can use to explore the system and develop your own applications. However there is also a huge library of user contributed projects that you can also load using the "Catalog Browser". To open it click on the following expression:		', (self doItFrom: 'CatalogBrowser open.'), 'This browser is also accessible from the World>Tools>Catalog Browser menu (just click the desktop, select Tools, and then Catalog Browser).Catalog projects can be browsed online: ', (self url: 'http://catalog.pharo.org'), 'You can also a rough list (not very friendly) of many packages available stored in smalltalkhub repository:', (self url: 'http://smalltalkhub.com/list'), '(this list is not a compendium of packages for Pharo but is a good place to start looking for something in particular and which happens to not be present in the catalog).The catalog can be enabled in Spotter by enabling the "Display catalog projects in Spotter" system preference.'! !!WelcomeHelp class methodsFor: 'pages' stamp: 'PhilippeBack 6/1/2017 17:58' prior: 84519159!welcome	^ HelpTopic 		title: 'Welcome to Pharo 6.0'		contents: (self heading: 'Pharo 6.0'), 		'Welcome to Pharo, an immersive live programming environment.Pharo is a pure object-oriented programming language and a powerful environment, focused on simplicity and immediate feedback (think IDE and OS rolled into one).For more information, please visit here: ', (self url: 'http://pharo.org'),(self subheading: 'Color themes'),'White theme: ', (self doItFrom: 'Pharo3Theme beCurrent. '), ' Dark theme: ', (self doItFrom: 'Pharo3DarkTheme beCurrent. ').! !!WriteStreamTest methodsFor: 'tests' stamp: 'KKSubbu 6/2/2017 21:03' prior: 84725775!testEnsureEndsWith	"self debug: #testEnsureEndsWith"	| stream |	stream := self newStream.	stream nextPutAll: 'this is a test'.	stream ensureEndsWith: Character cr.	stream nextPutAll: 'for WriteStreamTest'.	self assert: stream contents equals: (('this is a test' copyWith: Character cr), 'for WriteStreamTest').		"Manually put a new line and verify there are no 2 new lines"	stream := self newStream.	stream nextPutAll: ('this is a test' copyWith: Character cr).	stream ensureEndsWith: Character cr.	stream nextPutAll: 'for WriteStreamTest'.	self assert: stream contents equals: (('this is a test' copyWith: Character cr), 'for WriteStreamTest').		"Test with a empty stream"	stream := self newStream.	stream ensureEndsWith: Character cr.	self assert: stream contents equals: ''.! !!IntegerTest methodsFor: 'tests - bitLogic' stamp: 'SvenVanCaekenberghe 6/1/2017 20:45' prior: 29635981!testBitString	"self debug: #testBitString"		Smalltalk vm wordSize = 4		ifTrue: [			self assert: 2 bitString equals: '0000000000000000000000000000010'.			self assert: -1 bitString equals: '1111111111111111111111111111111'.			self assert: -2 bitString equals: '1111111111111111111111111111110'.			self assert: 2 bitStringLength equals: 31 ]. 	Smalltalk vm wordSize = 8		ifTrue: [			self assert: 2 bitString equals: '0000000000000000000000000000000000000000000000000000000000010'.			self assert: -1 bitString equals: '1111111111111111111111111111111111111111111111111111111111111'.			self assert: -2 bitString equals: '1111111111111111111111111111111111111111111111111111111111110'.			self assert: 2 bitStringLength equals: 61 ]. 	"32 minus 1 for immediate encoding = 31 = 30 for number + 1 for sign"	"64 minus 3 for immediate encoding = 61 = 60 for number + 1 for sign"	self assert: 2 bitStringLength equals: (SmallInteger maxVal highBit + 1).! !!IntegerTest methodsFor: 'tests - instance creation' stamp: 'SvenVanCaekenberghe 6/1/2017 21:07' prior: 29639619!testCreationFromBytes1	"self run: #testCreationFromBytes1"	"it is illegal for a LargeInteger to be less than SmallInteger maxVal." 	"here we test that Integer>>byte!!byte2:byte3:byte4: resconstructs SmallInteger maxVal as an instance of SmallInteger. "  	| maxSmallInt hexString byte1 byte2 byte3 byte4 builtInteger |	Smalltalk vm wordSize = 4 ifFalse: [ ^ self skip ].	maxSmallInt := SmallInteger maxVal.	hexString := maxSmallInt printStringHex.	self assert: hexString size = 8.	byte4 := Number readFrom: (hexString copyFrom: 1 to: 2) base: 16.	byte3 := Number readFrom: (hexString copyFrom: 3 to: 4) base: 16.	byte2 := Number readFrom: (hexString copyFrom: 5 to: 6) base: 16.	byte1 := Number readFrom: (hexString copyFrom: 7 to: 8) base: 16.	builtInteger := Integer byte1: byte1 byte2: byte2 byte3: byte3 byte4: byte4.	self assert: builtInteger = maxSmallInt.	self assert: builtInteger class = SmallInteger! !!IntegerTest methodsFor: 'tests - instance creation' stamp: 'SvenVanCaekenberghe 6/1/2017 21:07' prior: 29640579!testCreationFromBytes2 	"self run: #testCreationFromBytes2"	"it is illegal for a LargeInteger to be less than SmallInteger maxVal." 	"here we test that Integer>>byte!!byte2:byte3:byte4: resconstructs (SmallInteger maxVal + 1) as an instance of LargePositiveInteger. "	| maxSmallInt hexString byte1 byte2 byte3 byte4 builtInteger |	Smalltalk vm wordSize = 4 ifFalse: [ ^ self skip ].	maxSmallInt := SmallInteger maxVal.	hexString := (maxSmallInt + 1) printStringHex.	self assert: hexString size = 8.	byte4 := Number readFrom: (hexString copyFrom: 1 to: 2) base: 16.	byte3 := Number readFrom: (hexString copyFrom: 3 to: 4) base: 16.	byte2 := Number readFrom: (hexString copyFrom: 5 to: 6) base: 16.	byte1 := Number readFrom: (hexString copyFrom: 7 to: 8) base: 16.	builtInteger := Integer byte1: byte1 byte2: byte2 byte3: byte3 byte4: byte4.	self assert: builtInteger = (maxSmallInt + 1).	self deny: builtInteger class = SmallInteger! !!IntegerTest methodsFor: 'tests - instance creation' stamp: 'SvenVanCaekenberghe 6/1/2017 21:07' prior: 29625524!testCreationFromBytes3	"self run: #testCreationFromBytes3"	"it is illegal for a LargeInteger to be less than SmallInteger maxVal." 	"here we test that Integer>>byte!!byte2:byte3:byte4: resconstructs (SmallInteger maxVal - 1) as an instance of SmallInteger. "	| maxSmallInt hexString byte1 byte2 byte3 byte4 builtInteger |	Smalltalk vm wordSize = 4 ifFalse: [ ^ self skip ].	maxSmallInt := SmallInteger maxVal.	hexString := (maxSmallInt - 1) printStringHex.	self assert: hexString size = 8.	byte4 := Number readFrom: (hexString copyFrom: 1 to: 2) base: 16.	byte3 := Number readFrom: (hexString copyFrom: 3 to: 4) base: 16.	byte2 := Number readFrom: (hexString copyFrom: 5 to: 6) base: 16.	byte1 := Number readFrom: (hexString copyFrom: 7 to: 8) base: 16.	builtInteger := Integer byte1: byte1 byte2: byte2 byte3: byte3 byte4: byte4.	self assert: builtInteger = (maxSmallInt - 1).	self assert: builtInteger class = SmallInteger! !!VTermOutputDriver methodsFor: 'coloring' stamp: 'kks 5/19/2017 19:58' prior: 84236066!errorColor 	self red! !!STCommandLineHandler class methodsFor: 'printing' stamp: 'kks 5/19/2017 20:01' prior: 59101401!printCompilerWarning: aSyntaxErrorNotification	| stderr position contents errorLine errorMessage maxLineNumberSize lineNumber |		"format the error"	position := aSyntaxErrorNotification location.	contents := aSyntaxErrorNotification errorCode.	errorLine := contents lineNumberCorrespondingToIndex: position.	stderr := VTermOutputDriver stderr.			"first gather the error title to be able to underline it properly"	errorMessage := String streamContents: [ :s|		s nextPutAll: 'Syntax Error on line '; 			print: errorLine; nextPutAll: ': '; 			print: aSyntaxErrorNotification errorMessage].		 stderr red;		nextPutAll: errorMessage; lf;		nextPutAll: ('' padLeftTo: errorMessage size with: $=); lf;		clear.		"print each source line and mark the found syntax error"	maxLineNumberSize := contents lines size asString size.	lineNumber := 0.	contents lineIndicesDo: [:start :endWithoutDelimiters :end |		lineNumber := lineNumber + 1.		lineNumber == errorLine ifTrue: [ stderr errorColor ].		"0 pad the line numbers to the same size"		stderr 			nextPutAll: (lineNumber asString padLeftTo: maxLineNumberSize with: $0);			nextPutAll: ': ';			nextPutAll: (contents copyFrom: start to: endWithoutDelimiters);			lf.			"print the marker under the error line"		(lineNumber == errorLine)			ifTrue: [					stderr nextPutAll:( '_^_' padLeftTo: position - start + maxLineNumberSize + 4);							 lf;							 clear]	]! !!PharoWelcomePage class methodsFor: 'opening' stamp: 'PhilippeBack 6/1/2017 17:22' prior: 54501828!open	<script>	| group welcome help zen about window |	welcome := WelcomeHelp open.	help := HelpBrowser open.	zen := TextModel new			text: ProfStef pharoZenValuesContents;			title: 'Pharo Zen';			aboutText: ProfStef aboutPharoZen;			beForText;			openWithSpec.				about := TextModel new			text: Smalltalk systemInformationString withCRs;			title: 'About Pharo';			beForText;			openWithSpec.	group := GroupWindowMorph new.	group addWindow: welcome window.	group addWindow: help window.	group addWindow: SettingBrowser open.	group addWindow: KeymapBrowser new openWithSpec window.	group addWindow: zen window.	group addWindow: about window.	window := (group openInWindowLabeled: self title translated)		extent: welcome window extent;		yourself.			group tabGroup selectedPageIndex: 1.	^ window! !!PharoWelcomePage class methodsFor: 'opening' stamp: 'PhilippeBack 6/1/2017 17:22' prior: 54502733!openForRelease	<script>	| window |		World submorphs 		detect: [ :each | (each isKindOf: SystemWindow) and: [ each label = self title ] ] 		ifFound: [ :oldWindow | oldWindow delete ].	window := self open.	window extent: 750@400.	window center: Display extent / 2! !!SmallIntegerTest methodsFor: 'tests - Class Methods' stamp: 'SvenVanCaekenberghe 6/1/2017 20:03' prior: 60216021!testMaxVal	Smalltalk vm wordSize = 4		ifTrue: [ self assert: SmallInteger maxVal = 16r3FFFFFFF ].	Smalltalk vm wordSize = 8		ifTrue: [ self assert: SmallInteger maxVal = 16rFFFFFFFFFFFFFFF ]! !!SmallIntegerTest methodsFor: 'tests - Class Methods' stamp: 'SvenVanCaekenberghe 6/1/2017 20:04' prior: 60215871!testMinVal	Smalltalk vm wordSize = 4		ifTrue: [ self assert: SmallInteger minVal = -16r40000000 ].	Smalltalk vm wordSize = 8		ifTrue: [ self assert: SmallInteger minVal = -16r1000000000000000 ]! !!SmallIntegerTest methodsFor: 'tests - printing' stamp: 'SvenVanCaekenberghe 6/1/2017 20:08' prior: 60217483!testPrintString	self assert: 1 printString equals: '1'.	self assert: -1 printString equals: '-1'.	Smalltalk vm wordSize = 4		ifTrue: [ 			self assert: SmallInteger minVal printString equals: '-1073741824'.			self assert: SmallInteger maxVal printString equals: '1073741823' ].	Smalltalk vm wordSize = 8		ifTrue: [ 			self assert: SmallInteger minVal printString equals: '-1152921504606846976'.			self assert: SmallInteger maxVal printString equals: '1152921504606846975' ].	self assert: 12345 printString equals: '12345'.	self assert: -54321 printString equals: '-54321'.		self assert: 0 decimalDigitLength equals: 1.	self assert: 4 decimalDigitLength equals: 1.	self assert: 12 decimalDigitLength equals: 2.	self assert: 123 decimalDigitLength equals: 3.	self assert: 1234 decimalDigitLength equals: 4.	self assert: 56789 decimalDigitLength equals: 5.	self assert: 657483 decimalDigitLength equals: 6.	self assert: 6571483 decimalDigitLength equals: 7.	self assert: 65174383 decimalDigitLength equals: 8.	self assert: 625744831 decimalDigitLength equals: 9.	self assert: 1000001111 decimalDigitLength equals: 10.	Smalltalk vm wordSize = 4		ifTrue: [ self assert: SmallInteger maxVal decimalDigitLength equals: 10 ].	Smalltalk vm wordSize = 8		ifTrue: [ self assert: SmallInteger maxVal decimalDigitLength equals: 19 ].! !!SmallInteger methodsFor: 'system primitives' stamp: 'SvenVanCaekenberghe 6/2/2017 09:42' prior: 60213036!digitAt: n	"Answer the value of an apparent byte-indexable field in the receiver,	 analogous to the large integers, which are organized as bytes."	n = 1		ifTrue: [ 			"Negate carefully in case the receiver is SmallInteger minVal"			^ self < 0				ifTrue: [ -256 - self bitAnd: 255 ]				ifFalse: [ self bitAnd: 255 ] ].	^ self < 0		ifTrue: [ (-256 - self bitShift: -8) + 1 digitAt: n - 1 ]		ifFalse: [ (self bitShift: 8 - (n bitShift: 3)) bitAnd: 255 ]! !!WriteStream methodsFor: 'accessing' stamp: 'kks 4/18/2017 22:42' prior: 84716398!ensureEndsWith: anObject	"Append anObject to the receiver IFF it is non-empty and there is not one on the end."	(position == 0 or: [(collection at: position) = anObject]) ifTrue: [^self].	self nextPut: anObject! !"CodeImportCommandLineHandlers"!"Collections-Streams"!"Collections-Tests"!"Kernel"!"Kernel-Tests"!"Pharo-Help"!"System-CommandLine"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.575.mcz') load.ScriptLoader new update60499.!----End fileIn----!----QUIT----2017-06-06T15:14:03.768117+02:00 Pharo.image priorSource: 109815!----QUIT----2017-06-06T15:14:14.551317+02:00 Pharo.image priorSource: 153371!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 6/13/2017 17:20' prior: 33664417!commentForCurrentUpdate ^ '20146 ZnHTTPSTests>>#testGetPharoVersion started to fail	https://pharo.fogbugz.com/f/cases/20146'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 6/13/2017 17:20'!script60500	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.194.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.103.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2513.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.175.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.313.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.386.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.37.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 6/13/2017 17:20'!update60500	"self new update60500"	self withUpdateLog: '20146 ZnHTTPSTests>>#testGetPharoVersion started to fail	https://pharo.fogbugz.com/f/cases/20146'.	self loadTogether: self script60500 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60499!ScriptLoader removeSelector: #script60499!"ScriptLoader60"!!ZnHTTPSTests methodsFor: 'testing' stamp: 'PavelKrivanek 6/13/2017 16:53' prior: 85303548!testGetPharoVersion	| client lastBuildVersion version |	self ensureSocketStreamFactory.	self isNativeSSLPluginPresent ifFalse: [ ^ self ].	self runningOnWindowsInriaCI ifTrue: [ ^ self ].	lastBuildVersion := (client := ZnClient new)		beOneShot;		get: 'https://ci.inria.fr/pharo/job/Pharo-6.0/lastSuccessfulBuild/api/xml?xpath=/*/fullDisplayName'.	self assert: client isSuccess.	self assert: (client response contentType matches: ZnMimeType applicationXml).	self assert: client response contentLength > 0.	self assert: lastBuildVersion notNil.	self assert: lastBuildVersion isString.	self assert: lastBuildVersion size > 0.	version := (lastBuildVersion copyAfter: $>) copyUpTo: $<.	self deny: version isEmpty! !"Zinc-Zodiac"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.576.mcz') load.ScriptLoader new update60500.!----End fileIn----!----QUIT----2017-06-14T09:44:11.413887+02:00 Pharo.image priorSource: 153450!----QUIT----2017-06-14T09:44:21.849899+02:00 Pharo.image priorSource: 173343!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 6/14/2017 14:17' prior: 33708053!commentForCurrentUpdate ^ '20093 Missing source stamp makes changes hard to view	https://pharo.fogbugz.com/f/cases/2009320148 transforming deprecations should take #showWarning into account	https://pharo.fogbugz.com/f/cases/20148'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 6/14/2017 14:18'!script60501	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.194.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.103.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2515.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.175.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.313.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.388.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.37.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 6/14/2017 14:18'!update60501	"self new update60501"	self withUpdateLog: '20093 Missing source stamp makes changes hard to view	https://pharo.fogbugz.com/f/cases/2009320148 transforming deprecations should take #showWarning into account	https://pharo.fogbugz.com/f/cases/20148'.	self loadTogether: self script60501 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60500!ScriptLoader removeSelector: #script60500!"ScriptLoader60"!!VersionBrowser methodsFor: 'accessing' stamp: 'akevalion 6/2/2017 12:19' prior: 84263674!displayStringsFor: aMethodVersion	| author version cleanStampParts |		"a stamp is a string in the form  'GuillermoPolito 3/4/2015 14:33'"	"It may be incomplete, empty or even start with spaces."	cleanStampParts := aMethodVersion stamp trim substrings.		author := cleanStampParts ifEmpty: [ '<missing>' ] ifNotEmpty: [ :parts | parts first ].	version := cleanStampParts ifEmpty: [ '<missing>' ] ifNotEmpty: [ :parts | parts allButFirst joinUsing: ' ' ].		^ {author.	version.	(aMethodVersion realClass name).	(aMethodVersion selector).	('{' , aMethodVersion category , '}')}! !!Deprecation class methodsFor: 'logging' stamp: 'MarcusDenker 6/14/2017 10:12' prior: 22471619!deprecationsWhile: aBlock	"returns a log of all deprecated methods seen while executing aBlock"	| oldLog result |	oldLog := Log.	Log := Set new.	aBlock value.	result := Log.	oldLog ifNotNil: [oldLog addAll: result].	Log := oldLog.	^result! !!Deprecation class methodsFor: 'class initialization' stamp: 'MarcusDenker 6/14/2017 10:11' prior: 22471111!initialize	Log := nil "#deprecationsWhile: logs all deprecations here"! !!Deprecation class methodsFor: 'settings' stamp: 'MarcusDenker 6/14/2017 10:12' prior: 22471882!raiseWarning	"If true, then a dialog is popup for each deprecated method invocation"	^ RaiseWarning ifNil: [RaiseWarning := true]! !!Deprecation class methodsFor: 'settings' stamp: 'MarcusDenker 6/14/2017 10:12' prior: 22471221!showWarning	"If true, then a message is send to the Transcript for each deprecated method invocation"	^ ShowWarning ifNil: [ShowWarning := true]! !!Deprecation methodsFor: 'handling' stamp: 'MarcusDenker 6/14/2017 09:49' prior: 22467842!transform	| node rewriteRule aMethod |	self raiseWarning ifFalse: [ ^ self ]. "when desprecations are disables, we do not want to transform, either"	self rewriterClass ifNil:[ ^ self signal ].	aMethod := self contextOfSender method.	aMethod isDoIt ifTrue:[^ self]. "no need to transform doits"	node := self contextOfSender sourceNodeExecuted.	rewriteRule := self rewriterClass new 		replace: rule key with: rule value.	(rewriteRule executeTree: node)		ifFalse: [ ^ self ].	node replaceWith: rewriteRule tree. 	Author 		useAuthor: 'AutoDeprecationRefactoring'		during: [aMethod origin compile: aMethod ast formattedCode classified: aMethod protocol].		Log 		ifNotNil: [:log | log add: self].	self logTranscript! !"Kernel"!"Spec-Tools"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.577.mcz') load.ScriptLoader new update60501.!----End fileIn----!----QUIT----2017-06-14T14:20:25.717131+02:00 Pharo.image priorSource: 173422!----QUIT----2017-06-14T14:20:36.169244+02:00 Pharo.image priorSource: 195237!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 6/23/2017 14:15' prior: 33728025!commentForCurrentUpdate ^ '20110 AllocationTest>>#testOutOfMemorySignal not well suited to 64-bit	https://pharo.fogbugz.com/f/cases/2011020096 Add script pragma to SpaceTally>>printSpaceAnalysis	https://pharo.fogbugz.com/f/cases/2009620174  In the debug halo of a morph: clicking on "inspect morph" and "explore morph" bring up the same window.	https://pharo.fogbugz.com/f/cases/20174'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 6/23/2017 14:15'!script60502	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.194.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.103.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.78.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.85.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2515.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.177.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.315.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.388.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.39.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 6/23/2017 14:15'!update60502	"self new update60502"	self withUpdateLog: '20110 AllocationTest>>#testOutOfMemorySignal not well suited to 64-bit	https://pharo.fogbugz.com/f/cases/2011020096 Add script pragma to SpaceTally>>printSpaceAnalysis	https://pharo.fogbugz.com/f/cases/2009620174  In the debug halo of a morph: clicking on "inspect morph" and "explore morph" bring up the same window.	https://pharo.fogbugz.com/f/cases/20174'.	self loadTogether: self script60502 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60501!ScriptLoader removeSelector: #script60501!"ScriptLoader60"!!SpaceTally class methodsFor: 'fileout' stamp: 'MarcusDenker 6/22/2017 15:39' prior: 62052990!printSpaceAnalysis		<script>	self new printSpaceAnalysis! !!Morph methodsFor: 'debug and other' stamp: 'MarcusDenker 6/22/2017 15:34' prior: 51484071!buildDebugMenu: aHand	"Answer a debugging menu for the receiver. 	 The hand argument is seemingly historical and plays no role presently"	| aMenu |	aMenu := UIManager default newMenuIn: self for: self.	(self hasProperty: #errorOnDraw)		ifTrue: [ aMenu add: 'start drawing again' selector: #resumeAfterDrawError ].	(self hasProperty: #drawError)		ifTrue: [ aMenu add: 'debug drawing error' selector: #debugDrawError.			aMenu addLine ].	(self hasProperty: #errorOnStep)		ifTrue: [ aMenu add: 'start stepping again' selector: #resumeAfterStepError.			aMenu addLine ].	aMenu add: 'inspect morph' selector: #inspectInMorphic:.	aMenu lastItem		icon: (self iconNamed: #smallInspectItIcon).	aMenu add: 'inspect owner chain' selector: #inspectOwnerChain.	aMenu lastItem		icon: (self iconNamed: #smallInspectItIcon).	self isMorphicModel		ifTrue: [ aMenu add: 'inspect model' target: self model selector: #inspect.			aMenu lastItem				icon: (self iconNamed: #smallInspectItIcon) ].	aMenu addLine.	aMenu		add: 'browse morph class'		target: self		selector: #browseHierarchy.	self isMorphicModel		ifTrue: [ aMenu				add: 'browse model class'				target: self model				selector: #browseHierarchy ].	^ aMenu! !AllocationTest removeSelector: #testOutOfMemorySignal!"Kernel-Tests"!"Morphic-Core"!"Tool-Profilers"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.578.mcz') load.ScriptLoader new update60502.!----End fileIn----!----QUIT----2017-06-26T14:11:01.865402+02:00 Pharo.image priorSource: 195316!----QUIT----2017-06-26T14:11:13.050177+02:00 Pharo.image priorSource: 216495!----QUIT----2017-06-28T07:15:11.489762+02:00 Pharo.image priorSource: 216574!----QUIT----2017-06-28T07:15:18.88258+02:00 Pharo.image priorSource: 216653!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 6/28/2017 17:06' prior: 33749919!commentForCurrentUpdate ^ '20167 Regression with PNGReaderWriter in P6	https://pharo.fogbugz.com/f/cases/2016720198 inner structure access does not work on multiple architecture	https://pharo.fogbugz.com/f/cases/20198'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 6/28/2017 17:06'!script60503	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.21.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.194.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.103.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-TheIntegrator.5.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.428.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.80.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.87.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2515.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.177.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1178.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.315.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.388.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.39.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.109.mczUnifiedFFI-Legacy-TheIntegrator.4.mczUnifiedFFI-Tests-TheIntegrator.42.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 6/28/2017 17:06'!update60503	"self new update60503"	self withUpdateLog: '20167 Regression with PNGReaderWriter in P6	https://pharo.fogbugz.com/f/cases/2016720198 inner structure access does not work on multiple architecture	https://pharo.fogbugz.com/f/cases/20198'.	self loadTogether: self script60503 merge: false.	self loadConfiguration: 'UnifiedFFI' version: '0.26.8'.self flushCaches.! !ScriptLoader removeSelector: #update60502!ScriptLoader removeSelector: #script60502!"ScriptLoader60"!!PNGReadWriterTest methodsFor: 'tests - decoding' stamp: 'dtl 6/18/2017 17:07'!testNewFromSampleBytes	"Based on a problem report by Hilaire Fernandes, this fails on 64 bit Spur if a	synthesized LargeInteger parameter to Bitmap #at:put: is not normalized prior	to calling the primitive. See problem report at	http://lists.pharo.org/pipermail/pharo-users_lists.pharo.org/2017-June/032660.html"	| sampleBytes png form |	sampleBytes := #[137 80 78 71 13 10 26 10 0 0 0 13 73 72		68 82 0 0 0 48 0 0 0 48 16 6 0 0 0 7 146 37 196 0 0 0 6 98 75 71 68 255		255 255 255 255 255 9 88 247 220 0 0 0 9 112 72 89 115 0 0 0 72 0 0 0 72		0 70 201 107 62 0 0 1 153 73 68 65 84 120 218 237 155 73 110 195 48 12		69 227 162 183 211 9 180 11 130 220 77 39 208 249 210 77 181 8 81 69 19		39 169 255 109 12 35 137 197 255 105 81 244 144 219 13 0 0 0 0 0 116 16		66 8 33 188 94 214 113 120 99 214 151 111 238 1 115 206 57 231 235 178		54 68 10 238 19 112 58 1 189 1 238 158 16 233 25 255 37 117 224 221 141		215 210 193 158 128 83 140 215 210 181 156 0 26 216 169 139 180 155 210		218 50 184 124 126 74 34 122 245 204 234 101 207 224 41 221 145 150 14		49 67 118 77 132 118 220 98 93 208 168 64 107 172 226 18 63 19 91 194		172 103 132 117 124 106 194 117 132 210 227 215 143 103 109 124 65 173 4		181 4 173 149 128 254 223 121 49 190 160 190 6 212 4 126 22 94 12 163 91		173 241 229 112 219 141 188 51 106 184 223 46 139 162 62 3 164 137 49		198 24 253 117 89 219 241 183 145 181 82 180 94 154 192 47 212 248 247		253 209 45 152 102 205 120 36 130 137 182 193 159 19 5 22 233 53 158 126		31 48 209 54 190 181 15 8 189 247 215 71 141 174 25 127 218 243 137 105		168 17 53 99 164 140 247 154 8 183 119 67 139 177 41 165 148 210 117 209		125 233 241 181 16 187 18 158 21 254 124 62 30 247 251 186 241 173 113		122 227 148 70 237 145 100 175 33 210 120 139 207 205 237 232 255 22 71		129 45 16 60 3 158 163 123 6 140 214 74 239 198 207 198 201 189 102 12		151 32 26 128 155 23 150 22 105 189 96 38 181 88 31 211 206 113 163 165		151 109 17 182 110 231 118 213 193 222 5 237 154 8 171 184 217 254 31		176 123 9 114 255 146 177 187 128 224 3 0 0 0 0 192 198 252 0 102 116 72		96 211 171 62 8 0 0 0 0 73 69 78 68 174 66 96 130].	png := PNGReadWriter on: sampleBytes readStream.	form := png nextImage.	self assert: Form equals: form class.! !!PNGReadWriter methodsFor: 'pixel copies' stamp: 'dtl 6/18/2017 15:04' prior: 53948907!copyPixelsRGB: y	"Handle non-interlaced RGB color mode (colorType = 2)"	| i pixel tempForm tempBits |	(transparentPixelValue isNil and: [ bitsPerChannel = 8 ]) ifTrue: [ "Do the same trick as in #copyPixelsRGBA:"		| targetIndex |		tempBits := ByteArray new: thisScanline size * 4 // 3 withAll: 16rFF.		tempForm := Form extent: width@1 depth: 32 bits: tempBits.		targetIndex := 1.		1 to: thisScanline size by: 3 do: [ :index |			tempBits				at: targetIndex put: (thisScanline at: index);				at: targetIndex + 1 put: (thisScanline at: index + 1);				at: targetIndex + 2 put: (thisScanline at: index + 2).			targetIndex := targetIndex + 4 ].		cachedDecoderMap 			ifNil:[cachedDecoderMap := self rgbaDecoderMapForDepth: depth].		(BitBlt toForm: form)			sourceForm: tempForm;			destOrigin: 0@y;			combinationRule: Form over;			colorMap: cachedDecoderMap;			copyBits.		^self ].	tempForm := Form extent: width@1 depth: 32.	tempBits := tempForm bits.	pixel := LargePositiveInteger new: 4.	pixel at: 4 put: 16rFF.	bitsPerChannel = 8		ifTrue:			[i := 1.			1 to: width do:				[ :x |				pixel					at: 3 put: (thisScanline at: i);					at: 2 put: (thisScanline at: i+1);					at: 1 put: (thisScanline at: i+2).				tempBits at: x put: pixel normalize.				i := i + 3].			transparentPixelValue				ifNotNil:					[1 to: width do: [ :x |						(tempBits at: x) = transparentPixelValue							ifTrue: [tempBits at: x put: 0]]]]		ifFalse:			[i := 1.			1 to: width do:				[ :x |				(transparentPixelValue == nil or: [(1 to: 6) anySatisfy: [:k | (transparentPixelValue digitAt: k) ~= (thisScanline at: i + 6 - k)]])					ifTrue:						[pixel							at: 3 put: (thisScanline at: i);							at: 2 put: (thisScanline at: i+2);							at: 1 put: (thisScanline at: i+4).						tempBits at: x put: pixel normalize]					ifFalse:						[tempBits at: x put: 0].				i := i + 6]].		tempForm displayOn: form at: 0@y rule: Form over.! !!PNGReadWriter methodsFor: 'pixel copies' stamp: 'dtl 6/18/2017 15:04' prior: 53957421!copyPixelsRGB: y at: startX by: incX	"Handle interlaced RGB color mode (colorType = 2)"	| i pixel tempForm tempBits xx loopsToDo |	tempForm := Form extent: width@1 depth: 32.	tempBits := tempForm bits.	pixel := LargePositiveInteger new: 4.	pixel at: 4 put: 16rFF.	loopsToDo := width - startX + incX - 1 // incX.	bitsPerChannel = 8		ifTrue:			[i := (startX // incX * 3) + 1.			xx := startX+1.			1 to: loopsToDo do:				[ :j |				pixel					at: 3 put: (thisScanline at: i);					at: 2 put: (thisScanline at: i+1);					at: 1 put: (thisScanline at: i+2).				tempBits at: xx put: pixel normalize.				i := i + 3.				xx := xx + incX].			transparentPixelValue				ifNotNil: [startX to: width-1 by: incX do: [ :x |					(tempBits at: x+1) = transparentPixelValue						ifTrue: [	tempBits at: x+1 put: 0]]]]		ifFalse:			[i := (startX // incX * 6) + 1.			xx := startX+1.			1 to: loopsToDo do:				[ :j |				(transparentPixelValue == nil or: [(1 to: 6) anySatisfy: [:k | (transparentPixelValue digitAt: k) ~= (thisScanline at: i + 6 - k)]])					ifTrue:						[pixel							at: 3 put: (thisScanline at: i);							at: 2 put: (thisScanline at: i+2);							at: 1 put: (thisScanline at: i+4).						tempBits at: xx put: pixel normalize.]					ifFalse:						[tempBits at: xx put: 0].				i := i + 6.				xx := xx + incX]].	tempForm displayOn: form at: 0@y rule: Form over.! !!PNGReadWriter methodsFor: 'pixel copies' stamp: 'dtl 6/18/2017 15:03' prior: 53944375!copyPixelsRGBA: y	"Handle non-interlaced RGBA color modes (colorType = 6)"	| i pixel tempForm tempBits ff |	bitsPerChannel = 8 ifTrue: [		ff := Form extent: width@1 depth: 32 bits: thisScanline.		cachedDecoderMap 			ifNil:[cachedDecoderMap := self rgbaDecoderMapForDepth: depth].		(BitBlt toForm: form)			sourceForm: ff;			destOrigin: 0@y;			combinationRule: Form over;			colorMap: cachedDecoderMap;			copyBits.		^self.	].	tempForm := Form extent: width@1 depth: 32.	tempBits := tempForm bits.	pixel := LargePositiveInteger new: 4.	i := -7.	0 to: width-1 do: [ :x |			i := i + 8.			pixel at: 4 put: (thisScanline at: i+6);				at: 3 put: (thisScanline at: i);				at: 2 put: (thisScanline at: i+2);				at: 1 put: (thisScanline at: i+4).			tempBits at: x+1 put: pixel normalize.	].	tempForm displayOn: form at: 0@y rule: Form over.! !!PNGReadWriter methodsFor: 'pixel copies' stamp: 'dtl 6/18/2017 15:02' prior: 53963469!copyPixelsRGBA: y at: startX by: incX	"Handle interlaced RGBA color modes (colorType = 6)"	| i pixel tempForm tempBits |	tempForm := Form extent: width@1 depth: 32.	tempBits := tempForm bits.	pixel := LargePositiveInteger new: 4.	bitsPerChannel = 8 ifTrue: [		i := (startX // incX << 2) + 1.		startX to: width-1 by: incX do: [ :x |			pixel at: 4 put: (thisScanline at: i+3);				at: 3 put: (thisScanline at: i);				at: 2 put: (thisScanline at: i+1);				at: 1 put: (thisScanline at: i+2).			tempBits at: x+1 put: pixel normalize.			i := i + 4.		]	] ifFalse: [		i := (startX // incX << 3) +1.		startX to: width-1 by: incX do: [ :x |			pixel at: 4 put: (thisScanline at: i+6);				at: 3 put: (thisScanline at: i);				at: 2 put: (thisScanline at: i+2);				at: 1 put: (thisScanline at: i+4).			tempBits at: x+1 put: pixel normalize.			i := i + 8.		].	].	tempForm displayOn: form at: 0@y rule: Form paintAlpha.! !"Graphics-Files"!"Graphics-Tests"!!ConfigurationOfUnifiedFFI methodsFor: 'symbolic versions' stamp: 'EstebanLorenzano 6/28/2017 12:42' prior: 21193873!stable: spec	<symbolicVersion: #'stable'>	spec for: #'common' version: '0.26.8'! !!ConfigurationOfUnifiedFFI methodsFor: 'versions' stamp: 'EstebanLorenzano 6/28/2017 12:42'!v0_26_8: spec	<version: '0.26.8' imports: #('0.13-baseline' )>	spec for: #'common' do: [		spec blessing: #'stable'.		spec description: '- fixed size_t for i386/x86_64- fixed accessing to inner structures for i386/x86_64'.		spec author: 'EstebanLorenzano'.		spec timestamp: '2017-06-28 12:30'.		spec 			package: 'FFI-Pools' with: 'FFI-Pools-eem.3';			package: 'FFI-Kernel' with: 'FFI-Kernel-EstebanLorenzano.45';			package: 'Alien' with: 'Alien-RonieSalgado.40';			package: 'UnifiedFFI' with: 'UnifiedFFI-EstebanLorenzano.111';			package: 'UnifiedFFI-Tests' with: 'UnifiedFFI-Tests-EstebanLorenzano.41';			package: 'UnifiedFFI-Legacy' with: 'UnifiedFFI-Legacy-EstebanLorenzano.3' ]! !"ConfigurationOfUnifiedFFI"!!FFIConstants commentStamp: '' prior: 24017986!!!FFIConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 18:54' prior: 24021054!initialize	"FFIConstants initialize"	self initializeTypeConstants.	self initializeErrorConstants.	self initializeCallingConventions.! !!FFIConstants class methodsFor: 'pool initialization' stamp: 'eem 8/4/2009 19:49' prior: 24020615!initializeCallingConventions	"These constants map onto the flags inst var of an ExternalFunction.	 The first eight bits define the calling convention.  Attribute flags	 occupy bits 8 on up."	"FFIConstants initializeCallingConventions"	FFICallTypesMask := 255.	FFICallTypeCDecl := 0.	FFICallTypeApi := 1.	FFICallFlagThreaded := 256! !!FFIConstants class methodsFor: 'pool initialization' stamp: 'eem 11/5/2009 10:21' prior: 24019118!initializeErrorConstants	"FFIConstants initializeErrorConstants"	"No callout mechanism available"	FFINoCalloutAvailable := -1.	"generic error"	FFIErrorGenericError := 0.	"primitive invoked without ExternalFunction"	FFIErrorNotFunction := 1.	"bad arguments to primitive call"	FFIErrorBadArgs := 2.	"generic bad argument"	FFIErrorBadArg := 3.	"int passed as pointer"	FFIErrorIntAsPointer := 4.	"bad atomic type (e.g., unknown)"	FFIErrorBadAtomicType := 5.	"argument coercion failed"	FFIErrorCoercionFailed := 6.	"Type check for non-atomic types failed"	FFIErrorWrongType := 7.	"struct size wrong or too large"	FFIErrorStructSize := 8.	"unsupported calling convention"	FFIErrorCallType := 9.	"cannot return the given type"	FFIErrorBadReturn := 10.	"bad function address"	FFIErrorBadAddress := 11.	"no module given but required for finding address"	FFIErrorNoModule := 12.	"function address not found"	FFIErrorAddressNotFound := 13.	"attempt to pass 'void' parameter"	FFIErrorAttemptToPassVoid := 14.	"module not found"	FFIErrorModuleNotFound := 15.	"external library invalid"	FFIErrorBadExternalLibrary := 16.	"external function invalid"	FFIErrorBadExternalFunction := 17.	"ExternalAddress points to ST memory (don't you dare to do this!!)"	FFIErrorInvalidPointer := 18.	"Stack frame required more than 16k bytes to pass arguments."	FFIErrorCallFrameTooBig := 19! !!FFIConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 18:34' prior: 24018105!initializeTypeConstants	"type void"	FFITypeVoid := 0.	"type bool"	FFITypeBool := 1.	"basic integer types.	note: (integerType anyMask: 1) = integerType isSigned"	FFITypeUnsignedByte := 2.	FFITypeSignedByte := 3.	FFITypeUnsignedShort := 4.	FFITypeSignedShort := 5.	FFITypeUnsignedInt := 6.	FFITypeSignedInt := 7.	"64bit types"	FFITypeUnsignedLongLong := 8.	FFITypeSignedLongLong := 9.	"special integer types"	FFITypeUnsignedChar := 10.	FFITypeSignedChar := 11.	"float types"	FFITypeSingleFloat := 12.	FFITypeDoubleFloat := 13.	"type flags"	FFIFlagAtomic := 16r40000. "type is atomic"	FFIFlagPointer := 16r20000. "type is pointer to base type"	FFIFlagStructure := 16r10000. "baseType is structure of 64k length"	FFIStructSizeMask := 16rFFFF. "mask for max size of structure"	FFIAtomicTypeMask := 16r0F000000. "mask for atomic type spec"	FFIAtomicTypeShift := 24. "shift for atomic type"! !"FFI-Pools"!!FFIExternalStructureReferenceHandle methodsFor: 'accessing' stamp: 'EstebanLorenzano 6/27/2017 14:29'!getHandle	^ handle! !!FFIExternalStructure class methodsFor: 'accessing' stamp: 'EstebanLorenzano 6/16/2017 08:49' prior: 24067773!structureAlignment	externalStructureAlignment ifNil: [ self compileFields ].	^ externalStructureAlignment! !!ExternalType methodsFor: '*UnifiedFFI' stamp: 'EstebanLorenzano 6/27/2017 15:27' prior: 23753519!offsetReadFieldAt: offsetVariableName	"Answer a string defining the accessor to an entity of the receiver type starting at the 	 given byte offset. 	 Private. Used for field definition only.	 NOTE: This is used on UFFI to define field accessors that depends on a class variable 	 (this works like this to allow mapping 32bits and 64bits structures)"	self isPointerType ifTrue:		[| accessor |		accessor := self pointerSize caseOf: {						[nil]	->	[#pointerAt:].						[4]	->	[#shortPointerAt:].						[8]	->	[#longPointerAt:] }.		 ^String streamContents:			[:s|			 referentClass				ifNil:					[s nextPutAll: '^ExternalData fromHandle: (handle ', accessor, ' ';						nextPutAll: offsetVariableName;						nextPutAll: ') type: ExternalType ';						nextPutAll: (AtomicTypeNames at: self atomicType);						nextPutAll: ' asPointerType']				ifNotNil:					[s nextPutAll: '^';						print: referentClass;						nextPutAll: ' fromHandle: (handle ', accessor, ' ';						nextPutAll: offsetVariableName;						nextPut: $)]]].	self isAtomic ifFalse: "structure type"		[^ self offsetReadStructFieldAt: offsetVariableName ].	"Atomic non-pointer types"	^String streamContents:		[:s|		s nextPutAll:'^handle ';			nextPutAll: (AtomicSelectors at: self atomicType);			space; nextPutAll: offsetVariableName].! !!ExternalType methodsFor: '*UnifiedFFI' stamp: 'EstebanLorenzano 6/27/2017 15:29'!offsetReadStructFieldAt: offsetVariableName	^ '^ {1} fromHandle: (handle structAt: {2} length: {1} byteSize)' 		format: { 			referentClass name.			offsetVariableName }! !!ExternalType methodsFor: '*UnifiedFFI' stamp: 'EstebanLorenzano 6/27/2017 15:21' prior: 23749828!offsetWriteFieldAt: offsetVariableName with: valueName	"Answer a string defining the accessor to an entity of the receiver type starting at the given byte offset. 	 Private. Used for field definition only."	self isPointerType ifTrue:		[| accessor |		accessor := self pointerSize caseOf: {						[nil]	->	[#pointerAt:].						[4]	->	[#shortPointerAt:].						[8]	->	[#longPointerAt:] }.		^String streamContents:			[:s|			s nextPutAll:'handle ', accessor, ' ';				nextPutAll: offsetVariableName;				nextPutAll:' put: ';				nextPutAll: valueName;				nextPutAll:' getHandle.']].	self isAtomic ifFalse:[		^ self offsetWriteStructFieldAt: offsetVariableName with: valueName ].	^String streamContents:[:s|		s nextPutAll:'handle ';			nextPutAll: (AtomicSelectors at: self atomicType); space; 			nextPutAll: offsetVariableName;			nextPutAll:' put: ';			nextPutAll: valueName].! !!ExternalType methodsFor: '*UnifiedFFI' stamp: 'EstebanLorenzano 6/27/2017 15:35'!offsetWriteStructFieldAt: offsetVariableName with: valueName	^ 'handle structAt: {1} put: {2} getHandle length: {3} byteSize' 		format: {			offsetVariableName. 			valueName. 			referentClass name }! !!FFISizeT class methodsFor: 'converting' stamp: 'EstebanLorenzano 6/19/2017 11:17' prior: 24168971!asExternalTypeOn: generator	^ generator resolveType: #ulong! !!FFISizeT methodsFor: 'private' stamp: 'EstebanLorenzano 6/19/2017 10:57' prior: 24168483!basicHandle: aHandle at: index	^ aHandle platformUnsignedLongAt: index! !!FFISizeT methodsFor: 'private' stamp: 'EstebanLorenzano 6/19/2017 10:57' prior: 24168650!basicHandle: aHandle at: index put: value	^ aHandle platformUnsignedLongAt: index put: value! !!FFISizeT methodsFor: 'emitting code' stamp: 'EstebanLorenzano 6/19/2017 11:13'!readFieldAt: byteOffset	self isPointer ifTrue: [ 		^ self pointerReadFieldAt: byteOffset ].	^ String streamContents: [ :stream |		stream << '^handle platformUnsignedLongAt: ' << byteOffset asString ].! !!FFISizeT methodsFor: 'emitting code' stamp: 'EstebanLorenzano 6/19/2017 11:09'!writeFieldAt: byteOffset with: valueName	self isPointer ifTrue: [ 		^ self externalTypeWithArity 			writeFieldAt: byteOffset			with: valueName ].	^ String streamContents: [ :stream |		stream 			<< '^handle platformUnsignedLongAt: ' << byteOffset asString			<< ' put: ' << valueName ]! !!FFIExternalStructureType methodsFor: 'emitting code' stamp: 'EstebanLorenzano 6/27/2017 15:40' prior: 24102484!offsetReadReferenceAt: offsetVariableName	^ '^ {1} fromHandle: (handle referenceStructAt: {2} length: {1} byteSize)'		format: { self objectClass name. offsetVariableName }! !!FFIExternalStructureType methodsFor: 'emitting code' stamp: 'EstebanLorenzano 6/27/2017 15:42' prior: 24102101!readReferenceAt: byteOffset	^ '^ {1} fromHandle: (handle referenceStructAt: {2} length: {1} byteSize)'		format: { 			self objectClass name.			byteOffset }! !!FFICallbackType methodsFor: 'emitting code' stamp: 'EstebanLorenzano 4/13/2017 17:11' prior: 23963994!offsetWriteFieldAt: offsetVariableName with: valueName	| cr tab |	cr := String cr.	tab := String tab.	^ String streamContents: [ :stream | 		stream 			<< 'handle ' << cr 			<< tab << tab << 'pointerAt: ' << offsetVariableName << cr 			<< tab << tab << 'put: (anObject ' << cr 			<< tab << tab << tab << 'ifNotNil: [ ExternalAddress fromAddress: anObject thunk address ]' << cr			<< tab << tab << tab << 'ifNil: [ ExternalAddress null ])' ]! !"UnifiedFFI"!"UnifiedFFI-Tests"!"UnifiedFFI-Legacy"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.579.mcz') load.ScriptLoader new update60503.!----End fileIn----!----QUIT----2017-06-28T17:09:15.864278+02:00 Pharo.image priorSource: 216732!----QUIT----2017-06-28T17:09:26.342968+02:00 Pharo.image priorSource: 253892!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 6/29/2017 12:31' prior: 33771334!commentForCurrentUpdate ^ '20185 Request pipe after block argments	https://pharo.fogbugz.com/f/cases/2018520183 TraitDescription>>fileOutLocalMethodsInCategory:on: method temp var name overlap	https://pharo.fogbugz.com/f/cases/2018320184 Request space between argument and selector in StdioStream>>next:	https://pharo.fogbugz.com/f/cases/20184'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 6/29/2017 12:31'!script60504	^ 'AST-Core-TheIntegrator.494.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.23.mczCodeImport-TheIntegrator.90.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.194.mczCollections-Strings-TheIntegrator.449.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.103.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.29.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-eem.3.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.430.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.188.mczGraphics-Files-TheIntegrator.80.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.87.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.30.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2517.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.177.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1180.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.315.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.83.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.890.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.790.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.388.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.73.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.66.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.39.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.988.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.195.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-EstebanLorenzano.111.mczUnifiedFFI-Legacy-EstebanLorenzano.3.mczUnifiedFFI-Tests-EstebanLorenzano.41.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.459.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.46.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 6/29/2017 12:31'!update60504	"self new update60504"	self withUpdateLog: '20185 Request pipe after block argments	https://pharo.fogbugz.com/f/cases/2018520183 TraitDescription>>fileOutLocalMethodsInCategory:on: method temp var name overlap	https://pharo.fogbugz.com/f/cases/2018320184 Request space between argument and selector in StdioStream>>next:	https://pharo.fogbugz.com/f/cases/20184'.	self loadTogether: self script60504 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60503!ScriptLoader removeSelector: #script60503!"ScriptLoader60"!!Context class methodsFor: 'simulation' stamp: 'MarcusDenker 6/29/2017 11:20' prior: 21724094!runSimulated: aBlock	"Simulate the execution of the argument, current. Answer the result it 	returns."	^ thisContext sender		runSimulated: aBlock		contextAtEachStep: [:ignored | ]	"Context runSimulated: [Pen new defaultNib: 5; go: 100]"! !!MCMczReader methodsFor: 'loading' stamp: 'MarcusDenker 6/29/2017 11:20' prior: 31818543!loadDefinitions	definitions := OrderedCollection new.	(self zip memberNamed: 'snapshot.bin') ifNotNil:		[:m | [^ definitions := (MCDataStream on: m contentStream) next definitions]			on: Error do: [:fallThrough | ]].	"otherwise"	(self zip membersMatching: 'snapshot/*')		do: [:m | self extractDefinitionsFrom: m].! !!MCVersion methodsFor: 'enumerating' stamp: 'MarcusDenker 6/29/2017 11:18' prior: 32089434!withAllDependenciesDo: aBlock	self allDependenciesDo: aBlock ifUnresolved: [:ignored | ].	aBlock value: self! !!MCMcdReader methodsFor: 'loading' stamp: 'MarcusDenker 6/29/2017 11:20' prior: 31808620!loadPatch	| old new |	(self zip memberNamed: 'patch.bin') ifNotNil:		[:m | [^ patch := (MCDataStream on: m contentStream) next ]			on: Error do: [:fallThrough | ]].	definitions := OrderedCollection new.	(self zip membersMatching: 'old/*')		do: [:m | self extractDefinitionsFrom: m].	old := definitions asArray.	definitions := OrderedCollection new.	(self zip membersMatching: 'new/*')		do: [:m | self extractDefinitionsFrom: m].	new := definitions asArray.	^ patch := self buildPatchFrom: old to: new.	! !!MCPatch methodsFor: 'intializing' stamp: 'MarcusDenker 6/29/2017 11:18' prior: 31920696!initializeWithBase: baseSnapshot target: targetSnapshot	| base target |		operations := OrderedCollection new.	base := MCDefinitionIndex definitions: baseSnapshot definitions.	target := MCDefinitionIndex definitions: targetSnapshot definitions.		target definitions 		do: [ :t |			base				definitionLike: t				ifPresent: [:b | (b isSameRevisionAs: t) ifFalse: [operations add: (MCModification of: b to: t)]]				ifAbsent:  [operations add: (MCAddition of: t)] ]		displayingProgress: 'Diffing...'.			base definitions do: [:b |		target			definitionLike: b			ifPresent: [:t | ]			ifAbsent: [operations add: (MCRemoval of: b)]]		! !!TClassDescription methodsFor: '*CodeExport' stamp: 'MarcusDenker 6/29/2017 11:12' prior: 86056743!fileOutLocalMethodsInCategory: aSymbol on: aFileStream	"File out only the local (non-trait) methods for this category."	| selectors selectorsLocal |	aFileStream cr.	selectors := self selectorsToFileOutCategory: aSymbol.   selectorsLocal := selectors select:[:s | self isLocalSelector: s ].	"Overridden to preserve author stamps in sources file regardless"	selectorsLocal do: [:sel |		self printMethodChunk: sel on: aFileStream ].	^ self! !!StdioStream methodsFor: 'accessing' stamp: 'OleksandrZaytsev 6/28/2017 16:54' prior: 62348092!next: n	"Return a string with the next n characters of the filestream in it."	| readBuffer read startingAt |	readBuffer := ByteArray new: n.	startingAt := 1.	peekBuffer ifNotNil: [ 		readBuffer at: 1 put: peekBuffer.		startingAt := startingAt + 1.		peekBuffer := nil ].	read := self primRead: handle into: readBuffer startingAt: startingAt count: n - startingAt + 1.	^read = (n - startingAt + 1)		ifTrue: [ readBuffer ]		ifFalse: [ readBuffer copyFrom: 1 to: read ]! !!Trait method!fileOutLocalMethodsInCategory: aSymbol on: aFileStream	"File out only the local (non-trait) methods for this category."	| selectors selectorsLocal |	aFileStream cr.	selectors := self selectorsToFileOutCategory: aSymbol.   selectorsLocal := selectors select:[:s | self isLocalSelector: s ].	"Overridden to preserve author stamps in sources file regardless"	selectorsLocal do: [:sel |		self printMethodChunk: sel on: aFileStream ].	^ self! !!Trait method!fileOutLocalMethodsInCategory: aSymbol on: aFileStream	"File out only the local (non-trait) methods for this category."	| selectors selectorsLocal |	aFileStream cr.	selectors := self selectorsToFileOutCategory: aSymbol.   selectorsLocal := selectors select:[:s | self isLocalSelector: s ].	"Overridden to preserve author stamps in sources file regardless"	selectorsLocal do: [:sel |		self printMethodChunk: sel on: aFileStream ].	^ self! !"CodeExport"!"Files"!"Kernel"!"Monticello"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.580.mcz') load.ScriptLoader new update60504.!----End fileIn----!----QUIT----2017-06-29T12:37:38.234233+02:00 Pharo.image priorSource: 253971!----QUIT----2017-06-29T12:37:58.541211+02:00 Pharo.image priorSource: 277897!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 6/30/2017 14:14' prior: 33808574!commentForCurrentUpdate ^ '20187 Request use of block in certain methods	https://pharo.fogbugz.com/f/cases/2018720188 Request representation of integer literal without float exponent	https://pharo.fogbugz.com/f/cases/2018820182 Extra dot in literal array	https://pharo.fogbugz.com/f/cases/2018218760 Failing test: WeakAnnouncerTest>>#testNoDeadWeakSubscriptions	https://pharo.fogbugz.com/f/cases/1876020186 Request removal of extra statement separators (dot)	https://pharo.fogbugz.com/f/cases/20186'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 6/30/2017 14:15'!script60505	^ 'AST-Core-TheIntegrator.496.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.23.mczCodeImport-TheIntegrator.92.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.194.mczCollections-Strings-TheIntegrator.451.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.103.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.31.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-eem.3.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.431.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.190.mczGraphics-Files-TheIntegrator.80.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.87.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.32.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2518.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.177.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1180.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.315.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.85.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.892.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.792.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.388.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.76.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.69.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.39.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.990.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.197.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-EstebanLorenzano.111.mczUnifiedFFI-Legacy-EstebanLorenzano.3.mczUnifiedFFI-Tests-EstebanLorenzano.41.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.461.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.48.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 6/30/2017 14:15'!update60505	"self new update60505"	self withUpdateLog: '20187 Request use of block in certain methods	https://pharo.fogbugz.com/f/cases/2018720188 Request representation of integer literal without float exponent	https://pharo.fogbugz.com/f/cases/2018820182 Extra dot in literal array	https://pharo.fogbugz.com/f/cases/2018218760 Failing test: WeakAnnouncerTest>>#testNoDeadWeakSubscriptions	https://pharo.fogbugz.com/f/cases/1876020186 Request removal of extra statement separators (dot)	https://pharo.fogbugz.com/f/cases/20186'.	self loadTogether: self script60505 merge: false.	(SystemAnnouncer uniqueInstance subscriptions glmSubscriptions select: [:sub | sub subscriber isNil]) do: #finalize. 3 timesRepeat: [Smalltalk garbageCollect ].	self flushCaches.! !ScriptLoader removeSelector: #update60504!ScriptLoader removeSelector: #script60504!"ScriptLoader60"!!RBProgramNode methodsFor: 'accessing' stamp: 'MarcusDenker 6/30/2017 10:03' prior: 56263770!comments: aCollection	(aCollection ifNil: [#()])		ifEmpty: [ self removeProperty: #comments ifAbsent: [] ] 		ifNotEmpty: [ self propertyAt: #comments put: aCollection ].! !!UTF16TextConverter methodsFor: 'conversion' stamp: 'MarcusDenker 6/29/2017 12:20' prior: 65417347!nextFromStream: aStream	| character1 character2 readBOM charValue |	aStream isBinary ifTrue: [^ aStream basicNext].	character1 := aStream basicNext ifNil: [^nil].	character2 := aStream basicNext ifNil: [^nil].	readBOM := false.	(character1 asciiValue = 16rFF and: [character2 asciiValue = 16rFE]) ifTrue: 		[self useLittleEndian: true.		readBOM := true].	(character1 asciiValue = 16rFE and: [character2 asciiValue = 16rFF]) ifTrue: 		[self useLittleEndian: false.		readBOM := true].	readBOM ifTrue: 		[self useByteOrderMark: true.		character1 := aStream basicNext ifNil: [^nil].		character2 := aStream basicNext ifNil: [^nil]].	charValue := self useLittleEndian 		ifTrue: [(character2 charCode bitShift: 8) + character1 charCode] 		ifFalse: [(character1 charCode bitShift: 8) + character2 charCode].	^ self charFromStream: aStream withFirst: charValue.! !!TemporaryVariable methodsFor: 'comparing' stamp: 'MarcusDenker 6/30/2017 10:05' prior: 63541185!hash	^ (name hash		bitXor: method hash)		bitXor: (startpc ifNil: [0])! !!TextFontChange class methodsFor: 'as yet unclassified' stamp: 'MarcusDenker 6/30/2017 10:05' prior: 63909793!defaultFontChange  "Answer a TextFontChange that represents the default font"  | defaultFontStyle fontIndex |  defaultFontStyle := TextStyle default.  fontIndex := defaultFontStyle ifNil: [1] ifNotNil: [defaultFontStyle defaultFontIndex].  ^ self new fontNumber: fontIndex.! !!UIManager methodsFor: 'ui process' stamp: 'MarcusDenker 6/29/2017 12:17' prior: 65091276!spawnNewProcess	"do nothing by default"! !!ChunkReadStream methodsFor: 'decorated' stamp: 'MarcusDenker 6/29/2017 12:22' prior: 19183935!parseLangTagFor: aString	| string peek runsRaw foundTag |	string := aString.	"Test for ]lang[ tag"	peek := self skipSeparators; peek.	peek = $] ifFalse: [ ^ string ].  "no tag"	foundTag := (decoratedStream upTo: $[).	foundTag = ']lang' ifTrue: [		runsRaw := self basicNextChunk.		string := self decodeString: aString andRuns: runsRaw	] ifFalse: [		"If we find a ] but not a lang tag, there is something really wrong and we are not ready to parse that"		^ string , self basicNextChunk	].	^ string! !!TBehaviorCategorization methodsFor: 'organization' stamp: 'MarcusDenker 6/30/2017 10:08' prior: 85966532!category	"Answer the system organization category for the receiver. First check whether the	category name stored in the ivar is still correct and only if this fails look it up	(latter is much more expensive)"	| result |	self basicCategory ifNotNil: [ :symbol |		((self environment organization listAtCategoryNamed: symbol) includes: self name)			ifTrue: [ ^symbol ] ].	result := (self environment organization categoryOfElement: self name)		ifNil: [ #Unclassified ]		ifNotNil: [ :res | res ].	self basicCategory: result.		^ result! !!Job class methodsFor: 'examples' stamp: 'MarcusDenker 6/29/2017 12:18' prior: 29986359!exampleCurrentValue	[ :job| 		job title: 'Simulating some progress for 1 Second'.		1 second wait. "simulate some work"		job currentValue: 50.		1 second wait. "simulate some more work"		job currentValue: 100.		1 second wait. "simulate some more work"	] asJob run! !!ConfigurationCommandLineHandler methodsFor: 'printing' stamp: 'MarcusDenker 6/30/2017 10:07' prior: 20156717!printConfigurations: configurations	self inform: (String streamContents:  [ :s|		s			nextPutAll: 'Found ';			print: configurations size;			nextPutAll: ' Configuration';			nextPutAll: (configurations size = 1 ifTrue: [':'] ifFalse: ['s:']) ]).		configurations do: [ :name | 			self << name. 			self stdout lf ].	! !!SourceFileArray methodsFor: 'private - copying' stamp: 'MarcusDenker 6/30/2017 10:05' prior: 61195344!readOnlyCopy	"Answer a read only copy of self. The caller is responsible of closing it."	^ self species new		sourcesFileStream: (self sourcesFileStream ifNotNil: [:aStream | aStream readOnlyCopy]);		changesFileStream: (self changesFileStream ifNotNil: [:aStream | aStream readOnlyCopy]);		yourself! !!ZnImageExampleDelegate methodsFor: 'accessing' stamp: 'MarcusDenker 6/30/2017 11:00' prior: 85343737!html	^ ZnHtmlOutputStream streamContents: [ :html |		 html page: 'Image' do: [			html 				tag: #src attributes: #(src 'image?raw=true');				tag: #br;				tag: #form attributes: #(enctype 'multipart/form-data' action image method POST) do: [					html						tag: #h3 with: 'Change the image:';						tag: #input attributes: #(type file name file);						tag: #input attributes: #(type submit value Upload) ] ] ]! !!IRPrinterV2 methodsFor: 'visiting' stamp: 'MarcusDenker 6/29/2017 12:21' prior: 28857190!visitPopIntoRemoteTemp: remoteTemp	stream nextPutAll: 'popIntoRemoteTemp: '.	remoteTemp name printOn: stream.	stream nextPutAll: ' inVector: '.	remoteTemp tempVectorName printOn: stream! !!IRPrinterV2 methodsFor: 'visiting' stamp: 'MarcusDenker 6/29/2017 12:22' prior: 28858059!visitPushRemoteTemp: remoteTemp	stream nextPutAll: 'pushRemoteTemp: '.	remoteTemp name printOn: stream.	stream nextPutAll: ' inVector: '.	remoteTemp tempVectorName printOn: stream! !!IRPrinterV2 methodsFor: 'visiting' stamp: 'MarcusDenker 6/29/2017 12:22' prior: 28855547!visitStoreRemoteTemp: remoteTemp	stream nextPutAll: 'storeRemoteTemp: '.	remoteTemp name printOn: stream.	stream nextPutAll: ' inVector: '.	remoteTemp tempVectorName printOn: stream.! !!IRBytecodeDecompiler methodsFor: 'instruction decoding' stamp: 'MarcusDenker 6/29/2017 12:19' prior: 28775840!jump: dist	| index seq instr newSeq seqs |	index := instructionStream pc + dist.	dist >= 0 ifTrue: [		"jump forward"		^ irBuilder jumpAheadTo: index ].	"jump to the jump instuction itself"	dist >= -2 ifTrue: 		[	irBuilder jumpBackTarget: index.			irBuilder jumpBackTo: index.		^self].	"jump backward"	seqs := irBuilder ir allSequences.	seq := seqs findLast: [:s | s notEmpty and: [s first bytecodeIndex <= index]].	seq := seqs at: seq.	seq first bytecodeIndex = index		ifTrue: [ newSeq := seq ]		ifFalse: [			instr := seq detect: [:i | (seq after: i) bytecodeIndex = index].			newSeq := seq splitAfter: instr ].	irBuilder addJumpBackTarget: index to: newSeq.	"if we have split the currentSequence of the irBuilder, make sure to set it	to the newSeq"	irBuilder currentSequence = seq ifTrue: [irBuilder currentSequence: newSeq].	irBuilder jumpBackTo: index.! !!Form methodsFor: 'other' stamp: 'MarcusDenker 6/29/2017 12:23' prior: 25521945!fillAlpha: alphaValue	"Fill a 32bit form with a constant alpha value"	| bb |	self depth = 32 ifFalse:[^self error: 'Only valid for 32 bit forms'].	bb := BitBlt toForm: self.	bb combinationRule: 7. "bitOr:with:"	bb fillColor: (Bitmap with: alphaValue << 24).	bb copyBits.! !!PharoChangesCondenser methodsFor: 'initialization' stamp: 'MarcusDenker 6/29/2017 12:18' prior: 54402043!reset	remoteStringMap := IdentityDictionary new.	newChangesFile := self temporaryFile.		"Keep a copy of the source streams for performance"	sourceStreams := Array			with: PharoFilesOpener default sourcesFileOrNil			with: PharoFilesOpener default changesFileOrNil! !!MultiByteFileStream methodsFor: 'fileIn/Out' stamp: 'MarcusDenker 6/29/2017 12:24' prior: 52064442!nextChunk	"Answer the contents of the receiver, up to the next terminator	character. Doubled terminators indicate an embedded terminator	character."	self skipSeparators.	^ self		parseLangTagFor: (self basicChunk				ifNil: [String						new: 1000						streamContents: [:stream | 							| character state |							[(character := self next) == nil								or: [character == $!!										and: [state := converter saveStateOf: self.											self next ~~ $!!]]]								whileFalse: [stream nextPut: character].							character								ifNotNil: [converter restoreStateOf: self with: state.]]])! !!MultiByteFileStream methodsFor: 'fileIn/Out' stamp: 'MarcusDenker 6/29/2017 12:24' prior: 52069235!nextPreamble	"Assuming that preamble part does not contain ]lang[ tag"	self skipSeparators.	^ self basicChunk				ifNil: [String						new: 1000						streamContents: [:stream | 							| character state |							[(character := self next) == nil								or: [character == $!!										and: [state := converter saveStateOf: self.											self next ~~ $!!]]]								whileFalse: [stream nextPut: character].							character								ifNotNil: [converter restoreStateOf: self with: state.]]]! !!Protocol methodsFor: 'initialization' stamp: 'MarcusDenker 6/29/2017 12:17' prior: 55287718!initialize	super initialize.	methods := IdentitySet new.	name := self class defaultName.! !!IRReconstructor methodsFor: 'initialize' stamp: 'MarcusDenker 6/29/2017 12:21' prior: 28870270!createTempVectorNamed: name withVars: anArray	" Don't add the temp yet, we only know it's index at the end of the block or method "	"self addVectorTemps: anArray"	" Update the byte index to point before the pushing of the new vector "	sourceMapByteIndex := sourceMapByteIndex - 2.	self add: (IRInstruction createTempVectorNamed: name withVars: anArray)! !!ZdcPluginSSLSession methodsFor: 'accessing' stamp: 'MarcusDenker 6/30/2017 10:07' prior: 84802687!serverName: serverName	"Set the Server Name Indication (SNI) to serverName, 	the fully qualified domain name of the host to connect to.	This should be set by a client before #connect is attempted."		^ self primitiveSSL: handle setStringProperty: 2 toValue: (serverName ifNil: [''])! !!Text class methodsFor: 'instance creation' stamp: 'MarcusDenker 6/30/2017 10:09' prior: 63718200!fromString: aString   "Answer an instance of me whose characters are those of the argument, aString."  | defaultFontStyle fontNumber |  defaultFontStyle := TextStyle default.  fontNumber := defaultFontStyle ifNil: [1] ifNotNil: [defaultFontStyle defaultFontIndex].  ^ self    string: aString    attributes:{ "No default attributes" }! !!Text class methodsFor: 'initialization' stamp: 'MarcusDenker 6/30/2017 11:09' prior: 63716753!initialize	"Text initialize"	"Initialize constants shared by classes associated with text display."	TextSharedInformation at: #CaretForm put:				(Form extent: 16@5					fromArray: #(	 						2r00110000000000000000000000000000 						2r00110000000000000000000000000000 					 	2r01111000000000000000000000000000 					 	2r11111100000000000000000000000000 					 	2r11001100000000000000000000000000)					offset: -3@0).! !!String methodsFor: 'converting' stamp: 'MarcusDenker 6/29/2017 12:24' prior: 62489088!withNoLineLongerThan: aNumber	"Answer a string with the same content as receiver, but rewrapped so that no line has more characters than the given number"	(aNumber isNumber not or: [ aNumber < 1 ]) ifTrue: [self error: 'too narrow'].	^self class		new: self size * (aNumber + 1) // aNumber "provision for supplementary line breaks"		streamContents: [ :stream |			self lineIndicesDo: [ :start :endWithoutDelimiters :end |				| pastEnd lineStart |				pastEnd := endWithoutDelimiters + 1.				"eliminate spaces at beginning of line"				lineStart := (self indexOfAnyOf: CSNonSeparators startingAt: start ifAbsent: [pastEnd]) min: pastEnd.				[| lineStop lineEnd spacePosition |				lineEnd := lineStop  := lineStart + aNumber min: pastEnd.				spacePosition := lineStart.				[spacePosition < lineStop] whileTrue: [					spacePosition := self indexOfAnyOf: CSSeparators startingAt: spacePosition + 1 ifAbsent: [pastEnd].					spacePosition <= lineStop ifTrue: [lineEnd := spacePosition].				].				"split before space or before lineStop if no space"				stream nextPutAll: (self copyFrom: lineStart to: lineEnd - 1).				"eliminate spaces at beginning of next line"				lineStart := self indexOfAnyOf: CSNonSeparators startingAt: lineEnd ifAbsent: [pastEnd].				lineStart <= endWithoutDelimiters ]					whileTrue: [stream cr].				stream nextPutAll: (self copyFrom: pastEnd to: end) ] ]! !!Trait method!category	"Answer the system organization category for the receiver. First check whether the	category name stored in the ivar is still correct and only if this fails look it up	(latter is much more expensive)"	| result |	self basicCategory ifNotNil: [ :symbol |		((self environment organization listAtCategoryNamed: symbol) includes: self name)			ifTrue: [ ^symbol ] ].	result := (self environment organization categoryOfElement: self name)		ifNil: [ #Unclassified ]		ifNotNil: [ :res | res ].	self basicCategory: result.		^ result! !!Trait method!category	"Answer the system organization category for the receiver. First check whether the	category name stored in the ivar is still correct and only if this fails look it up	(latter is much more expensive)"	| result |	self basicCategory ifNotNil: [ :symbol |		((self environment organization listAtCategoryNamed: symbol) includes: self name)			ifTrue: [ ^symbol ] ].	result := (self environment organization categoryOfElement: self name)		ifNil: [ #Unclassified ]		ifNotNil: [ :res | res ].	self basicCategory: result.		^ result! !!Trait method!category	"Answer the system organization category for the receiver. First check whether the	category name stored in the ivar is still correct and only if this fails look it up	(latter is much more expensive)"	| result |	self basicCategory ifNotNil: [ :symbol |		((self environment organization listAtCategoryNamed: symbol) includes: self name)			ifTrue: [ ^symbol ] ].	result := (self environment organization categoryOfElement: self name)		ifNil: [ #Unclassified ]		ifNotNil: [ :res | res ].	self basicCategory: result.		^ result! !"AST-Core"!"CodeImport"!"Collections-Strings"!"ConfigurationCommandLineHandler-Core"!"Files"!"Graphics-Display Objects"!"Jobs"!"Kernel"!"Multilingual-TextConversion"!"OpalCompiler-Core"!"Slot"!"System-Sources"!"Text-Core"!"Traits"!"UIManager"!"Zinc-HTTP"!"Zodiac-Core"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.581.mcz') load.ScriptLoader new update60505.!----End fileIn----!----QUIT----2017-06-30T14:18:17.675696+02:00 Pharo.image priorSource: 277976!----QUIT----2017-06-30T14:18:34.498843+02:00 Pharo.image priorSource: 312306!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 7/4/2017 16:11' prior: 33832579!commentForCurrentUpdate ^ '20092 Improve speed of WriteStream>>tab:	https://pharo.fogbugz.com/f/cases/2009220088 Improve speed of Character>>isSeparator in when the separator is not a space	https://pharo.fogbugz.com/f/cases/2008820204 Text class>>#fromString	https://pharo.fogbugz.com/f/cases/20204'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 7/4/2017 16:11'!script60506	^ 'AST-Core-TheIntegrator.496.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.23.mczCodeImport-TheIntegrator.92.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.195.mczCollections-Strings-TheIntegrator.451.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.105.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.31.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-eem.3.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.431.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.190.mczGraphics-Files-TheIntegrator.80.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.87.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.32.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2520.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.177.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.192.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1180.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.315.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.85.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.892.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.792.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.388.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.76.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.71.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.39.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.990.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.197.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-EstebanLorenzano.111.mczUnifiedFFI-Legacy-EstebanLorenzano.3.mczUnifiedFFI-Tests-EstebanLorenzano.41.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.461.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.48.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 7/4/2017 16:11'!update60506	"self new update60506"	self withUpdateLog: '20092 Improve speed of WriteStream>>tab:	https://pharo.fogbugz.com/f/cases/2009220088 Improve speed of Character>>isSeparator in when the separator is not a space	https://pharo.fogbugz.com/f/cases/2008820204 Text class>>#fromString	https://pharo.fogbugz.com/f/cases/20204'.	self loadTogether: self script60506 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60505!ScriptLoader removeSelector: #script60505!"ScriptLoader60"!!WriteStreamTest methodsFor: 'tests' stamp: 'HenrikNergaard 5/29/2017 12:15'!testEnsureNoSpace	"self debug: #testEnsureASpace2"	| stream |	stream := self newStream.	stream ensureNoSpace.		self assert: stream contents equals: ''.		stream nextPutAll: ' a '.	stream ensureNoSpace.	self assert: stream contents equals: ' a'.		stream nextPutAll: 'b  '.	stream ensureNoSpace.	self assert: stream contents equals: ' ab'.			! !!Character methodsFor: 'testing' stamp: 'MarcusDenker 7/1/2017 14:52' prior: 19056099!isSeparator    | in |    ^ (in := self asInteger) == 32 or: [ in == 13 or: [ in == 9 or: [ in == 10 or: [ in == 12 ] ] ] ]! !!Text class methodsFor: 'instance creation' stamp: 'MarcusDenker 7/1/2017 14:47' prior: 33861804!fromString: aString   "Answer an instance of me whose characters are those of the argument, aString."  ^ self    string: aString    attributes:{ "No default attributes" }! !!Stream methodsFor: 'accessing' stamp: 'HenrikNergaard 5/29/2017 12:09' prior: 62373559!next: anInteger put: anObject 	<compilerOptions: #(+ optionInlineTimesRepeat)>		"Make anObject be the next anInteger number of objects accessible by the 	receiver. Answer anObject."		anInteger timesRepeat: [ self nextPut: anObject ].	^ anObject! !!CharacterTest methodsFor: 'tests' stamp: 'MarcusDenker 7/1/2017 14:55'!testIsSeparator    {Character space.    Character cr.    Character lf.    Character newPage.    Character tab} do: [ :each | self assert: each isSeparator ].    Character alphabet do: [ :each | self deny: each isSeparator ]! !!WriteStream methodsFor: 'accessing' stamp: 'HenrikNergaard 5/29/2017 12:10' prior: 84714960!crlf	"Append a line feed character to the receiver."	self cr; lf! !!WriteStream methodsFor: 'character writing' stamp: 'HenrikNergaard 5/29/2017 12:10' prior: 84721483!crtab	"Append a return character, followed by a single tab character, to the 	receiver."	self cr; tab! !!WriteStream methodsFor: 'character writing' stamp: 'HenrikNergaard 5/29/2017 12:10' prior: 84716139!crtab: anInteger 	"Append a return character, followed by anInteger tab characters, to the 	receiver."	self cr; tab: anInteger! !!WriteStream methodsFor: 'character writing' stamp: 'HenrikNergaard 5/29/2017 12:15' prior: 84721850!ensureNoSpace	"If there is not one on the end, remove it."	| space |		space := Character space.		[ position > 0 and: [(collection at: position) = space ]]		whileTrue: [ self skip: -1 ]! !!WriteStream methodsFor: 'character writing' stamp: 'HenrikNergaard 5/29/2017 12:11' prior: 84719188!space: anInteger 	"Append anInteger space characters to the receiver."		self next: anInteger put: Character space	! !!WriteStream methodsFor: 'character writing' stamp: 'HenrikNergaard 5/29/2017 12:12' prior: 84717846!tab: anInteger 	"Append anInteger tab characters to the receiver."		self next: anInteger put: Character tab! !"Collections-Streams"!"Collections-Tests"!"Kernel"!"Text-Core"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.582.mcz') load.ScriptLoader new update60506.!----End fileIn----!----QUIT----2017-07-04T16:14:02.32477+02:00 Pharo.image priorSource: 312385!----QUIT----2017-07-04T16:14:12.807834+02:00 Pharo.image priorSource: 334804!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 7/6/2017 14:44' prior: 33866987!commentForCurrentUpdate ^ '20218 Master branch (Pharo 6) needs to be safely merged into development branch (Pharo 7).	https://pharo.fogbugz.com/f/cases/20218'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 7/6/2017 14:45'!script60507	^ 'AST-Core-TheIntegrator.496.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.23.mczCodeImport-TheIntegrator.92.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.195.mczCollections-Strings-TheIntegrator.451.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.105.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.31.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-eem.3.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.431.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.190.mczGraphics-Files-TheIntegrator.80.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.87.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.34.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2522.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.177.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.195.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1183.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.315.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.54.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.85.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.892.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1435.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.792.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.388.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.76.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.73.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.39.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.992.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.197.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.113.mczUnifiedFFI-Legacy-EstebanLorenzano.3.mczUnifiedFFI-Tests-EstebanLorenzano.41.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.461.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.48.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 7/6/2017 14:45'!update60507	"self new update60507"	self withUpdateLog: '20218 Master branch (Pharo 6) needs to be safely merged into development branch (Pharo 7).	https://pharo.fogbugz.com/f/cases/20218'.	self loadTogether: self script60507 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60506!ScriptLoader removeSelector: #script60506!"ScriptLoader60"!!Context class methodsFor: 'simulation' stamp: 'PavelKrivanek 7/6/2017 11:21' prior: 33827420!runSimulated: aBlock	"Simulate the execution of the argument, current. Answer the result it 	returns."	^ thisContext sender		runSimulated: aBlock		contextAtEachStep: [:ignored |]	"Context runSimulated: [Pen new defaultNib: 5; go: 100]"! !!MCMczReader methodsFor: 'loading' stamp: 'PavelKrivanek 7/6/2017 11:20' prior: 33827758!loadDefinitions	definitions := OrderedCollection new.	(self zip memberNamed: 'snapshot.bin') ifNotNil:		[:m | [^ definitions := (MCDataStream on: m contentStream) next definitions]			on: Error do: [:fallThrough |]].	"otherwise"	(self zip membersMatching: 'snapshot/*')		do: [:m | self extractDefinitionsFrom: m].! !!TBehaviorCategorization methodsFor: 'organization' stamp: 'PavelKrivanek 7/6/2017 11:16' prior: 33854492!category	"Answer the system organization category for the receiver. First check whether the	category name stored in the ivar is still correct and only if this fails look it up	(latter is much more expensive)"	| result |	self basicCategory ifNotNil: [ :symbol |		((self environment organization listAtCategoryNamed: symbol) includes: self name)			ifTrue: [ ^symbol ] ].	result := (self environment organization categoryOfElement: self name)		ifNil: [ #Unclassified ]		ifNotNil: [:aString | aString ].	self basicCategory: result.		^ result! !!MCVersion methodsFor: 'enumerating' stamp: 'PavelKrivanek 7/6/2017 11:19' prior: 33828175!withAllDependenciesDo: aBlock	self allDependenciesDo: aBlock ifUnresolved: [:ignored |].	aBlock value: self! !!Text class methodsFor: 'initialization' stamp: 'PavelKrivanek 7/6/2017 11:18' prior: 33862248!initialize	"Text initialize"	"Initialize constants shared by classes associated with text display."	TextSharedInformation at: #CaretForm put:				(Form extent: 16@5					fromArray: #(							2r00110000000000000000000000000000						2r00110000000000000000000000000000					 	2r01111000000000000000000000000000					 	2r11111100000000000000000000000000					 	2r11001100000000000000000000000000)					offset: -3@0).! !!MCMcdReader methodsFor: 'loading' stamp: 'PavelKrivanek 7/6/2017 11:21' prior: 33828379!loadPatch	| old new |	(self zip memberNamed: 'patch.bin') ifNotNil:		[:m | [^ patch := (MCDataStream on: m contentStream) next ]			on: Error do: [:fallThrough |]].	definitions := OrderedCollection new.	(self zip membersMatching: 'old/*')		do: [:m | self extractDefinitionsFrom: m].	old := definitions asArray.	definitions := OrderedCollection new.	(self zip membersMatching: 'new/*')		do: [:m | self extractDefinitionsFrom: m].	new := definitions asArray.	^ patch := self buildPatchFrom: old to: new.	! !!FFISizeT class methodsFor: 'converting' stamp: 'PavelKrivanek 7/6/2017 11:17' prior: 33805469!asExternalTypeOn: generator	"We resolve size_t to a uint/ulong which may be not the case always"	^ generator resolveType: #ulong! !!MCPatch methodsFor: 'intializing' stamp: 'PavelKrivanek 7/6/2017 11:20' prior: 33828989!initializeWithBase: baseSnapshot target: targetSnapshot	| base target |		operations := OrderedCollection new.	base := MCDefinitionIndex definitions: baseSnapshot definitions.	target := MCDefinitionIndex definitions: targetSnapshot definitions.		target definitions 		do: [ :t |			base				definitionLike: t				ifPresent: [:b | (b isSameRevisionAs: t) ifFalse: [operations add: (MCModification of: b to: t)]]				ifAbsent:  [operations add: (MCAddition of: t)] ]		displayingProgress: 'Diffing...'.			base definitions do: [:b |		target			definitionLike: b			ifPresent: [:t |]			ifAbsent: [operations add: (MCRemoval of: b)]]		! !!Job class methodsFor: 'examples' stamp: 'PavelKrivanek 7/6/2017 11:21' prior: 33855129!exampleCurrentValue	[ :job| 		job title: 'Simulating some progress for 1 Second'. 		1 second wait. "simulate some work"		job currentValue: 50.		1 second wait. "simulate some more work"		job currentValue: 100.		1 second wait. "simulate some more work"	] asJob run! !!Trait method!category	"Answer the system organization category for the receiver. First check whether the	category name stored in the ivar is still correct and only if this fails look it up	(latter is much more expensive)"	| result |	self basicCategory ifNotNil: [ :symbol |		((self environment organization listAtCategoryNamed: symbol) includes: self name)			ifTrue: [ ^symbol ] ].	result := (self environment organization categoryOfElement: self name)		ifNil: [ #Unclassified ]		ifNotNil: [:aString | aString ].	self basicCategory: result.		^ result! !!Trait method!category	"Answer the system organization category for the receiver. First check whether the	category name stored in the ivar is still correct and only if this fails look it up	(latter is much more expensive)"	| result |	self basicCategory ifNotNil: [ :symbol |		((self environment organization listAtCategoryNamed: symbol) includes: self name)			ifTrue: [ ^symbol ] ].	result := (self environment organization categoryOfElement: self name)		ifNil: [ #Unclassified ]		ifNotNil: [:aString | aString ].	self basicCategory: result.		^ result! !!Trait method!category	"Answer the system organization category for the receiver. First check whether the	category name stored in the ivar is still correct and only if this fails look it up	(latter is much more expensive)"	| result |	self basicCategory ifNotNil: [ :symbol |		((self environment organization listAtCategoryNamed: symbol) includes: self name)			ifTrue: [ ^symbol ] ].	result := (self environment organization categoryOfElement: self name)		ifNil: [ #Unclassified ]		ifNotNil: [:aString | aString ].	self basicCategory: result.		^ result! !"Jobs"!"Kernel"!"Monticello"!"Text-Core"!"Traits"!"UnifiedFFI"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.583.mcz') load.ScriptLoader new update60507.!----End fileIn----!----QUIT----2017-07-06T14:47:02.648193+02:00 Pharo.image priorSource: 334882!----QUIT----2017-07-06T14:47:13.080132+02:00 Pharo.image priorSource: 359862!!ScriptLoader methodsFor: 'public' stamp: 'TheIntegrator 7/11/2017 17:51' prior: 33889484!commentForCurrentUpdate ^ '20226 TabMorph should use stepping mechanism for animating background building	https://pharo.fogbugz.com/f/cases/2022620238 Run out of memory the image hangs without out of memory warning	https://pharo.fogbugz.com/f/cases/20238'! !!ScriptLoader methodsFor: 'pharo - scripts' stamp: 'TheIntegrator 7/11/2017 17:51'!script60508	^ 'AST-Core-TheIntegrator.496.mczAST-Tests-Core-TheIntegrator.134.mczAlien-RonieSalgado.40.mczAnnouncements-Core-TheIntegrator.84.mczAnnouncements-Help-TheIntegrator.12.mczAnnouncements-Tests-Core-TheIntegrator.39.mczAthens-Balloon-MarcusDenker.20.mczAthens-Cairo-TheIntegrator.147.mczAthens-CairoPools-NicolaiHess.14.mczAthens-Core-AliakseiSyrel.57.mczAthens-Examples-TheIntegrator.47.mczAthens-Morphic-TheIntegrator.69.mczAthens-Text-HenrikNergaard.17.mczBalloon-TheIntegrator.139.mczBalloon-Tests-TheIntegrator.2.mczBaselineOfBasicTools-TheIntegrator.8.mczBaselineOfDisplay-TheIntegrator.4.mczBaselineOfIDE-TheIntegrator.55.mczBaselineOfIceberg-cypress.1.mczBaselineOfLibGit-cypress.1.mczBaselineOfMetacello-EstebanLorenzano.89.mczBaselineOfMorphic-TheIntegrator.34.mczBaselineOfMorphicCore-TheIntegrator.7.mczBaselineOfPharoBootstrap-TheIntegrator.4.mczBaselineOfSUnit-TheIntegrator.4.mczBaselineOfUI-TheIntegrator.11.mczBaselineOfUnifiedFFI-TheIntegrator.4.mczBlueInk-Core-TheIntegrator.29.mczBlueInk-Extras-TheIntegrator.12.mczBlueInk-Tests-TheIntegrator.12.mczCodeExport-TheIntegrator.23.mczCodeImport-TheIntegrator.92.mczCodeImportCommandLineHandlers-TheIntegrator.17.mczCollections-Abstract-TheIntegrator.345.mczCollections-Arithmetic-TheIntegrator.22.mczCollections-Atomic-TheIntegrator.16.mczCollections-DoubleLinkedList-TheIntegrator.2.mczCollections-DoubleLinkedListTests-TheIntegrator.2.mczCollections-Native-TheIntegrator.19.mczCollections-Sequenceable-TheIntegrator.261.mczCollections-Stack-TheIntegrator.10.mczCollections-Streams-TheIntegrator.195.mczCollections-Strings-TheIntegrator.451.mczCollections-Support-TheIntegrator.67.mczCollections-Tests-TheIntegrator.105.mczCollections-Unordered-TheIntegrator.248.mczCollections-Weak-TheIntegrator.108.mczColors-TheIntegrator.3.mczCompiler-TheIntegrator.608.mczCompression-TheIntegrator.182.mczCompression-Tests-TheIntegrator.7.mczConfigurationCommandLineHandler-Core-TheIntegrator.31.mczConfigurationCommandLineHandler-Tests-MarcusDenker.11.mczContributingToTheCatalogHelp-TheIntegrator.9.mczDebugger-Tests-TheIntegrator.6.mczDebuggerActions-TheIntegrator.92.mczDebuggerFilters-TheIntegrator.9.mczDebuggerModel-TheIntegrator.130.mczDeprecated60-TheIntegrator.22.mczEmbeddedFreeType-TheIntegrator.30.mczEmbeddedFreeType-Tests-TheIntegrator.4.mczEmergencyEvaluator-TheIntegrator.35.mczEpicea-TheIntegrator.858.mczEpiceaBrowsers-MartinDias.180.mczEpiceaBrowsersTests-MartinDias.32.mczEpiceaTests-MartinDias.25.mczFFI-Kernel-EstebanLorenzano.45.mczFFI-Pools-eem.3.mczFileSystem-Core-TheIntegrator.222.mczFileSystem-Disk-TheIntegrator.110.mczFileSystem-Memory-TheIntegrator.63.mczFileSystem-Tests-Core-TheIntegrator.103.mczFileSystem-Tests-Disk-StephaneDucasse.25.mczFileSystem-Tests-Memory-TheIntegrator.8.mczFileSystem-Zip-TheIntegrator.19.mczFiles-TheIntegrator.431.mczFiles-Tests-TheIntegrator.12.mczFlashback-Decompiler-EstebanLorenzano.21.mczFlashback-Decompiler-Tests-TheIntegrator.97.mczFontChooser-TheIntegrator.24.mczFontInfrastructure-TheIntegrator.18.mczFontInfrastructure-Tests-TheIntegrator.2.mczFreeType-TheIntegrator.756.mczFreeType-Tests-TheIntegrator.2.mczFuel-MartinDias.826.mczFuelCommandLineHandler-TheIntegrator.25.mczFuelPlatform-Core-MaxLeske.2.mczFuelPlatform-Pharo-06-MaxLeske.2.mczFuelPlatform-Pharo-Core-MaxLeske.1.mczFuelSystem-FileRegistry-TheIntegrator.4.mczFuelTests-MaxLeske.415.mczFuelTools-Debugger-MaxLeske.14.mczFuzzyMatcher-TheIntegrator.20.mczFuzzyMatcher-Tests-TheIntegrator.8.mczGT-BytecodeDebugger-AndreiChis.36.mczGT-Debugger-TheIntegrator.383.mczGT-EventRecorder-TheIntegrator.81.mczGT-EventRecorder-Tests-TheIntegrator.42.mczGT-Inspector-TheIntegrator.468.mczGT-InspectorExtensions-Core-AndreiChis.259.mczGT-Playground-TheIntegrator.148.mczGT-SUnitDebugger-TudorGirba.39.mczGT-Spotter-AliakseiSyrel.412.mczGT-Spotter-EventRecorder-AndreiChis.114.mczGT-SpotterExtensions-Core-TheIntegrator.224.mczGT-Tests-Debugger-AndreiChis.14.mczGT-Tests-Inspector-AndreiChis.60.mczGT-Tests-Playground-StefanReichhart.4.mczGT-Tests-Spotter-AndreiChis.31.mczGeneralRules-TheIntegrator.11.mczGlamour-Announcements-AndreiChis.11.mczGlamour-Browsers-AndreiChis.112.mczGlamour-Core-AndreiChis.338.mczGlamour-Examples-TheIntegrator.321.mczGlamour-FastTable-TheIntegrator.85.mczGlamour-Helpers-TudorGirba.40.mczGlamour-Morphic-Brick-TheIntegrator.448.mczGlamour-Morphic-Brick-Tests-TheIntegrator.16.mczGlamour-Morphic-Pager-AndreiChis.114.mczGlamour-Morphic-Renderer-AndreiChis.361.mczGlamour-Morphic-Theme-TheIntegrator.233.mczGlamour-Morphic-Widgets-TheIntegrator.209.mczGlamour-Presentations-AndreiChis.190.mczGlamour-Rubric-Presentations-AndreiChis.61.mczGlamour-SpecIntegration-TheIntegrator.6.mczGlamour-Tests-Core-TheIntegrator.115.mczGlamour-Tests-Morphic-TheIntegrator.140.mczGlamour-Tests-Resources-AndreiChis.5.mczGlamour-Tests-Rubric-AndreiChis.36.mczGofer-Core-TheIntegrator.237.mczGofer-Tests-TheIntegrator.164.mczGofer-UI-TheIntegrator.2.mczGraphics-Canvas-TheIntegrator.14.mczGraphics-Display Objects-TheIntegrator.190.mczGraphics-Files-TheIntegrator.80.mczGraphics-Fonts-TheIntegrator.109.mczGraphics-Primitives-TheIntegrator.203.mczGraphics-Shapes-TheIntegrator.4.mczGraphics-Tests-TheIntegrator.87.mczGraphics-Transformations-TheIntegrator.17.mczGrowl-TheIntegrator.47.mczHelpSystem-Core-TheIntegrator.178.mczHelpSystem-Tests-TheIntegrator.32.mczHiedra-MartinDias.146.mczHiedraTests-MartinDias.2.mczHowToContributeHelp-TheIntegrator.4.mczHudsonBuildTools20-TheIntegrator.100.mczIceberg-cypress.1.mczIceberg-Libgit-cypress.1.mczIceberg-Metacello-Integration-cypress.1.mczIceberg-Plugin-cypress.1.mczIceberg-UI-cypress.1.mczImportingResource-Help-TheIntegrator.8.mczIssueTracking-TheIntegrator.6.mczIssueTracking-Tests-TheIntegrator.3.mczJobs-TheIntegrator.34.mczJobsTests-TheIntegrator.2.mczKernel-TheIntegrator.2522.mczKernel-Rules-TheIntegrator.13.mczKernel-Tests-TheIntegrator.177.mczKernel-Tests-Rules-TheIntegrator.5.mczKeymapping-Core-TheIntegrator.204.mczKeymapping-KeyCombinations-TheIntegrator.66.mczKeymapping-Pragmas-TheIntegrator.62.mczKeymapping-Settings-StephaneDucasse.83.mczKeymapping-Tests-TheIntegrator.111.mczKeymapping-Tools-Spec-TheIntegrator.32.mczKomitter-TheIntegrator.195.mczLibGit-Core-cypress.1.mczManifest-Core-TheIntegrator.252.mczManifest-Resources-Tests-MarcusDenker.14.mczManifest-Tests-TheIntegrator.55.mczMenuRegistration-TheIntegrator.93.mczMessageBrowserRefactoringAddition-StephaneDucasse.2.mczMetacello-Base-EstebanLorenzano.126.mczMetacello-Bitbucket-EstebanLorenzano.8.mczMetacello-Core-TheIntegrator.838.mczMetacello-FileTree-EstebanLorenzano.38.mczMetacello-GitBasedRepository-TheIntegrator.24.mczMetacello-GitHub-TheIntegrator.56.mczMetacello-MC-TheIntegrator.741.mczMetacello-PharoCommonPlatform-TheIntegrator.26.mczMetacello-Platform-TheIntegrator.5.mczMetacello-ProfStef-TheIntegrator.22.mczMetacello-Reference-EstebanLorenzano.38.mczMetacello-TestsCommonMC-TheIntegrator.9.mczMetacello-TestsCore-EstebanLorenzano.41.mczMetacello-TestsMC-EstebanLorenzano.405.mczMetacello-TestsMCCore-EstebanLorenzano.8.mczMetacello-TestsMCResources-EstebanLorenzano.33.mczMetacello-TestsPlatform-TheIntegrator.25.mczMetacello-TestsReference-EstebanLorenzano.22.mczMetacello-ToolBox-TheIntegrator.154.mczMetacello-Tutorial-EstebanLorenzano.28.mczMonticello-TheIntegrator.1183.mczMonticello-OldDataStreamCompatibility-TheIntegrator.11.mczMonticello-Tests-TheIntegrator.43.mczMonticelloConfigurations-TheIntegrator.75.mczMonticelloFileServices-TheIntegrator.9.mczMonticelloFileTree-Core-TheIntegrator.152.mczMonticelloFileTree-FileSystem-Utilities-TheIntegrator.34.mczMonticelloGUI-TheIntegrator.437.mczMonticelloMocks-TheIntegrator.9.mczMonticelloRemoteRepositories-TheIntegrator.19.mczMoose-Algos-Graph-VincentBlondeau.33.mczMorphic-Base-TheIntegrator.618.mczMorphic-Core-TheIntegrator.315.mczMorphic-Examples-TheIntegrator.64.mczMorphic-Tests-TheIntegrator.13.mczMorphic-Widgets-Basic-TheIntegrator.110.mczMorphic-Widgets-ColorPicker-TheIntegrator.23.mczMorphic-Widgets-Extra-TheIntegrator.30.mczMorphic-Widgets-FastTable-TheIntegrator.222.mczMorphic-Widgets-List-TheIntegrator.23.mczMorphic-Widgets-Pluggable-TheIntegrator.79.mczMorphic-Widgets-PolyTabs-TheIntegrator.8.mczMorphic-Widgets-Scrolling-TheIntegrator.37.mczMorphic-Widgets-Tabs-TheIntegrator.56.mczMorphic-Widgets-Taskbar-TheIntegrator.27.mczMorphic-Widgets-TickList-TheIntegrator.2.mczMorphic-Widgets-Tree-TheIntegrator.66.mczMorphic-Widgets-Windows-TheIntegrator.117.mczMultilingual-Encodings-TheIntegrator.63.mczMultilingual-Languages-TheIntegrator.59.mczMultilingual-OtherLanguages-TheIntegrator.22.mczMultilingual-Tests-TheIntegrator.46.mczMultilingual-TextConversion-TheIntegrator.85.mczMultilingual-TextConverterOtherLanguages-TheIntegrator.4.mczNECompletion-TheIntegrator.257.mczNECompletion-Tests-TheIntegrator.10.mczNautilus-TheIntegrator.1366.mczNautilus-GroupManager-TheIntegrator.24.mczNautilus-GroupManagerUI-TheIntegrator.44.mczNautilus-Tests-TheIntegrator.52.mczNautilusCommon-TheIntegrator.327.mczNautilusGroupAutoBuilder-TheIntegrator.20.mczNautilusRefactoring-TheIntegrator.315.mczNetwork-Kernel-TheIntegrator.138.mczNetwork-MIME-TheIntegrator.75.mczNetwork-Mail-TheIntegrator.52.mczNetwork-Protocols-TheIntegrator.105.mczNetwork-Tests-TheIntegrator.28.mczNetwork-UUID-TheIntegrator.64.mczNetwork-Url-TheIntegrator.103.mczNewValueHolder-TheIntegrator.35.mczNodeNavigation-TheIntegrator.57.mczNodeNavigation-Tests-TheIntegrator.3.mczNonInteractiveTranscript-TheIntegrator.25.mczOSWindow-Core-TheIntegrator.125.mczOSWindow-SDL2-TheIntegrator.110.mczOSWindow-SDL2-Examples-TheIntegrator.16.mczOSWindow-Tests-RonieSalgado.3.mczOSWindow-VM-MerwanOuddane.4.mczOmbu-MartinDias.277.mczOmbuTests-MartinDias.33.mczOpalCompiler-Core-TheIntegrator.892.mczOpalCompiler-Tests-TheIntegrator.380.mczOpalTools-TheIntegrator.24.mczPharo-Help-TheIntegrator.52.mczPharoBootstrap-Initialization-TheIntegrator.7.mczPharoDocComment-StephaneDucasse.6.mczPolymorph-Widgets-TheIntegrator.1437.mczPolymorph-Widgets-Rules-TheIntegrator.11.mczPragmaCollector-TheIntegrator.18.mczProfStef-Core-TheIntegrator.85.mczProfStef-Help-TheIntegrator.18.mczProfStef-Tests-TheIntegrator.27.mczQualityAssistant-YuriyTymchuk.117.mczQualityAssistant-Test-YuriyTymchuk.2.mczQualityAssistantRecording-Uko.28.mczRPackage-Core-TheIntegrator.470.mczRPackage-Tests-TheIntegrator.199.mczRandom-Core-TheIntegrator.10.mczRandom-Tests-TheIntegrator.6.mczRecentSubmissions-TheIntegrator.246.mczRefactoring-Changes-TheIntegrator.70.mczRefactoring-Core-TheIntegrator.345.mczRefactoring-Critics-TheIntegrator.300.mczRefactoring-Environment-TheIntegrator.88.mczRefactoring-Help-TheIntegrator.7.mczRefactoring-Tests-Changes-TheIntegrator.40.mczRefactoring-Tests-Core-TheIntegrator.147.mczRefactoring-Tests-Critics-TheIntegrator.54.mczRefactoring-Tests-Environment-TheIntegrator.30.mczReflectionMirrors-Primitives-TheIntegrator.9.mczReflectionMirrors-Primitives-Tests-TheIntegrator.6.mczReflectivity-TheIntegrator.339.mczReflectivity-Examples-TheIntegrator.51.mczReflectivity-Tests-TheIntegrator.228.mczReflectivity-Tools-TheIntegrator.79.mczReflectivity-Tools-Tests-TheIntegrator.32.mczRegex-Core-TheIntegrator.40.mczRegex-Help-MarcusDenker.5.mczRegex-Tests-Core-TheIntegrator.11.mczReleaseTests-TheIntegrator.33.mczRenraku-YuriyTymchuk.150.mczRenraku-Help-YuriyTymchuk.3.mczRenraku-Test-YuriyTymchuk.23.mczRing-Core-Containers-TheIntegrator.45.mczRing-Core-Kernel-TheIntegrator.248.mczRing-Monticello-TheIntegrator.43.mczRing-Tests-Containers-MarcusDenker.18.mczRing-Tests-Kernel-TheIntegrator.95.mczRing-Tests-Monticello-MarcusDenker.19.mczRingChunkImporter-TheIntegrator.8.mczRubric-TheIntegrator.448.mczRubric-Rules-TheIntegrator.6.mczRubric-Styling-TheIntegrator.11.mczRubric-Tests-TheIntegrator.10.mczSTON-Core-TheIntegrator.86.mczSTON-Tests-TheIntegrator.77.mczSTON-Text support-TheIntegrator.2.mczSUnit-Core-TheIntegrator.221.mczSUnit-Help-MarcusDenker.9.mczSUnit-Rules-TheIntegrator.5.mczSUnit-Tests-TheIntegrator.68.mczSUnit-UI-TheIntegrator.153.mczSUnit-UITesting-TheIntegrator.36.mczScriptLoader-Tests-TheIntegrator.4.mczScriptingExtensions-TheIntegrator.6.mczScriptingExtensions-Tests-TheIntegrator.3.mczSettings-Graphics-TheIntegrator.34.mczSettings-Polymorph-TheIntegrator.98.mczSettings-System-TheIntegrator.43.mczShoreLine-Report-Core-TommasoDalSasso.11.mczShoreLine-Report-Settings-TheIntegrator.7.mczShoreLine-Report-UI-TheIntegrator.19.mczShout-TheIntegrator.313.mczShout-Tests-TheIntegrator.2.mczSlot-TheIntegrator.792.mczSlot-Tests-TheIntegrator.105.mczSmartSuggestions-TheIntegrator.269.mczSmartSuggestions-Tests-TheIntegrator.39.mczSortFunctions-Core-TheIntegrator.7.mczSortFunctions-Tests-TheIntegrator.6.mczSpec-Core-TheIntegrator.541.mczSpec-Debugger-TheIntegrator.284.mczSpec-Examples-TheIntegrator.133.mczSpec-Help-TheIntegrator.13.mczSpec-Inspector-TheIntegrator.289.mczSpec-Layout-TheIntegrator.75.mczSpec-MorphicAdapters-TheIntegrator.292.mczSpec-PolyWidgets-TheIntegrator.93.mczSpec-Tests-TheIntegrator.107.mczSpec-Tools-TheIntegrator.388.mczStartupPreferences-TheIntegrator.153.mczSystem-Announcements-TheIntegrator.138.mczSystem-BasicCommandLineHandler-TheIntegrator.21.mczSystem-Caching-TheIntegrator.29.mczSystem-CachingTests-TheIntegrator.19.mczSystem-Changes-TheIntegrator.309.mczSystem-Changes-FileServices-TheIntegrator.4.mczSystem-Clipboard-TheIntegrator.42.mczSystem-CommandLine-TheIntegrator.183.mczSystem-CommandLine-TextSupport-TheIntegrator.6.mczSystem-CommandLineHandler-TheIntegrator.26.mczSystem-FileRegistry-TheIntegrator.53.mczSystem-Finalization-TheIntegrator.44.mczSystem-Hashing-TheIntegrator.52.mczSystem-History-EstebanLorenzano.7.mczSystem-History-Tests-EstebanLorenzano.3.mczSystem-Identification-TheIntegrator.9.mczSystem-Identification-Tests-TheIntegrator.2.mczSystem-Installers-TheIntegrator.44.mczSystem-Localization-TheIntegrator.108.mczSystem-Localization-Tests-TheIntegrator.8.mczSystem-Model-TheIntegrator.13.mczSystem-OSEnvironments-TheIntegrator.40.mczSystem-Object Events-TheIntegrator.28.mczSystem-Platforms-TheIntegrator.85.mczSystem-Serial Port-StephaneDucasse.23.mczSystem-SessionManager-TheIntegrator.43.mczSystem-SessionManager-Tests-ChristopheDemarey.9.mczSystem-Settings-TheIntegrator.374.mczSystem-Settings-Rules-TheIntegrator.2.mczSystem-Settings-Tests-TheIntegrator.15.mczSystem-Sound-TheIntegrator.20.mczSystem-Sources-TheIntegrator.76.mczSystem-Support-TheIntegrator.1276.mczSystem-Support-Rules-TheIntegrator.2.mczSystem-SupportTests-TheIntegrator.7.mczSystem-VMEvents-TheIntegrator.19.mczTests-TheIntegrator.794.mczText-Core-TheIntegrator.73.mczText-Diff-TheIntegrator.6.mczText-Edition-TheIntegrator.128.mczText-Edition-Tests-EstebanLorenzano.3.mczText-Scanning-TheIntegrator.33.mczText-Tests-TheIntegrator.10.mczTool-Base-TheIntegrator.195.mczTool-Catalog-TheIntegrator.61.mczTool-CriticBrowser-TheIntegrator.67.mczTool-DependencyAnalyser-ChristopheDemarey.31.mczTool-DependencyAnalyser-Test-TheIntegrator.18.mczTool-DependencyAnalyser-Test-Data-ChristopheDemarey.2.mczTool-DependencyAnalyser-UI-ChristopheDemarey.54.mczTool-Diff-TheIntegrator.52.mczTool-ExternalBrowser-TheIntegrator.59.mczTool-FileList-TheIntegrator.99.mczTool-FileList-Tests-EstebanLorenzano.3.mczTool-Finder-TheIntegrator.78.mczTool-ImageCleaner-TheIntegrator.19.mczTool-ProcessBrowser-TheIntegrator.27.mczTool-Profilers-TheIntegrator.39.mczTool-SystemReporter-TheIntegrator.19.mczTool-Transcript-TheIntegrator.25.mczTool-Workspace-TheIntegrator.48.mczTools-TheIntegrator.1532.mczTools-Test-TheIntegrator.26.mczTraits-TheIntegrator.992.mczTranscript-TheIntegrator.56.mczTravisIntegrationHelp-TheIntegrator.8.mczTxText-Athens-EstebanLorenzano.58.mczTxText-AthensTests-HenrikNergaard.13.mczTxText-Model-MarcusDenker.67.mczTxText-Styler-HenrikNergaard.18.mczTxTextTests-Model-SeanDeNigris.29.mczUIManager-TheIntegrator.197.mczUnicode-Initialization-TheIntegrator.17.mczUnifiedFFI-TheIntegrator.113.mczUnifiedFFI-Legacy-EstebanLorenzano.3.mczUnifiedFFI-Tests-EstebanLorenzano.41.mczUpdateStreamer-Core-TheIntegrator.34.mczUpdateStreamer-Tests-TheIntegrator.9.mczVersionner-Commit-TheIntegrator.34.mczVersionner-Core-Announcements-ChristopheDemarey.6.mczVersionner-Core-Commands-MarcusDenker.65.mczVersionner-Core-DependenciesModel-MarcusDenker.106.mczVersionner-Core-Model-PabloTesone.57.mczVersionner-Nautilus-PavelKrivanek.1.mczVersionner-Spec-Browser-PabloTesone.212.mczVersionner-Tests-Core-Commands-MarcusDenker.21.mczVersionner-Tests-Core-DependenciesModel-ChristopheDemarey.46.mczVersionner-Tests-Core-Model-TheIntegrator.36.mczVersionner-Tests-Resources-MarcusDenker.18.mczWorldMenuHelp-TheIntegrator.2.mczWriteBarrierTests-TheIntegrator.20.mczZinc-Character-Encoding-Core-SvenVanCaekenberghe.46.mczZinc-Character-Encoding-Tests-TheIntegrator.31.mczZinc-FileSystem-TheIntegrator.15.mczZinc-HTTP-TheIntegrator.461.mczZinc-Resource-Meta-Core-SvenVanCaekenberghe.61.mczZinc-Resource-Meta-FileSystem-SvenVanCaekenberghe.8.mczZinc-Resource-Meta-Tests-SvenVanCaekenberghe.37.mczZinc-Tests-SvenVanCaekenberghe.238.mczZinc-Zodiac-TheIntegrator.40.mczZodiac-Core-TheIntegrator.48.mczZodiac-Extra-StephaneDucasse.10.mczZodiac-Tests-TheIntegrator.17.mcz'findTokens: String lf , String cr! !!ScriptLoader methodsFor: 'pharo - updates' stamp: 'TheIntegrator 7/11/2017 17:51'!update60508	"self new update60508"	self withUpdateLog: '20226 TabMorph should use stepping mechanism for animating background building	https://pharo.fogbugz.com/f/cases/2022620238 Run out of memory the image hangs without out of memory warning	https://pharo.fogbugz.com/f/cases/20238'.	self loadTogether: self script60508 merge: false.	self flushCaches.! !ScriptLoader removeSelector: #update60507!ScriptLoader removeSelector: #script60507!"ScriptLoader60"!!TabBuildingIconMorph commentStamp: 'DenisKudryashov 7/6/2017 15:19' prior: 0!I implement rotated icon to animate background tab building. I use stepping mechanizm for animation.Just create my instance with #new message to use in other morphs.Internal Representation and Key Implementation Points.    Instance Variables	progress:		<Integer>	progressIconMorph:		<ImageMorph>    Implementation Points!!MorphicUIManager methodsFor: 'debug' stamp: 'DenisKudryashov 7/11/2017 15:10' prior: 51990251!lowSpaceWatcherDefaultAction: theInterruptedProcess	"Create a Notifier on the active scheduling process with the given label."	| preemptedProcess projectProcess debugSession |	ActiveHand ifNotNil:[ActiveHand interrupted].	ActiveWorld := World. "reinstall active globals"	ActiveHand := World primaryHand.	ActiveHand interrupted. "make sure this one's interrupted too"	ActiveEvent := nil.	projectProcess := self uiProcess.	"we still need the accessor for a while"	preemptedProcess := theInterruptedProcess ifNil: [Processor preemptedProcess].	"Only debug preempted process if its priority is >= projectProcess' priority"	preemptedProcess priority < projectProcess priority 		ifTrue:[preemptedProcess := projectProcess].	preemptedProcess suspend.		debugSession := preemptedProcess 		newDebugSessionNamed: 'Space is low' 		startedAt: preemptedProcess suspendedContext.			debugSession logStackToFileIfNeeded.	debugSession isAboutUIProcess ifTrue: [ 		DefaultExecutionEnvironment beActiveDuring: [self spawnNewProcess]].		Smalltalk tools debugger 		openOn: debugSession 		withFullView: false 		andNotification: self lowSpaceWarningMessage! !!TabBuildingIconMorph methodsFor: 'stepping and presenter' stamp: 'DenisKudryashov 7/6/2017 15:17'!currentIcon	^TabMorph perform: (#refreshIcon, progress asString) asSymbol! !!TabBuildingIconMorph methodsFor: 'initialization' stamp: 'DenisKudryashov 7/6/2017 15:17'!initialize	super initialize.	self 		clipLayoutCells: true;		color: Color transparent.	progress := 1.	progressIconMorph := self currentIcon asMorph.	self addMorphBack: progressIconMorph.	self extent: progressIconMorph extent.! !!TabBuildingIconMorph methodsFor: 'stepping and presenter' stamp: 'DenisKudryashov 7/6/2017 15:17'!step	progress := progress + 1.	progress > 10 ifTrue: [ progress := 1 ].		progressIconMorph form: self currentIcon! !!TabBuildingIconMorph methodsFor: 'stepping and presenter' stamp: 'DenisKudryashov 7/6/2017 15:17'!stepTime		^ 100 "milliseconds"! !!TabMorph methodsFor: 'protocol' stamp: 'DenisKudryashov 7/6/2017 15:12' prior: 63411623!retrieveMorph: aBlock	"This is a hard request. The result is blocking contrary to softRetrieveMorph.	Late binding so the morph may be built only on demand"	morph ifNotNil: [ 		aBlock value: morph.		^ nil ].	retrievingSemaphore isSignaled		ifFalse: [ self softRetrieveMorph ].	^ [ retrievingSemaphore wait.		morph ifNotNil: [ 			UIManager default defer: [aBlock value: morph ]]] 				fork! !!TabMorph methodsFor: 'protocol' stamp: 'DenisKudryashov 7/6/2017 15:20' prior: 63406869!softRetrieveMorph	| oldIcon |	"Like retrieveMorph but done in a separated process"		morph ifNotNil: [ ^ self ].		retrievingProcess 		ifNotNil: [ 			"The retrieving process is already running, let's wait for its result"			retrievingProcess isTerminated 				ifFalse: [ ^ self ] ].		oldIcon := self icon ifNotNil: [ :i | i form ].	label icon: TabBuildingIconMorph new.	retrievingProcess := [ [		morph := retrievingBlock value]	ensure: [				UIManager default defer: [			self icon: oldIcon.			self triggerEvent: #tabRefreshed with: self].		"I should signal all waiters here"		[retrievingSemaphore isEmpty] whileFalse: [ retrievingSemaphore signal].	] ] forkAt: Processor activePriority - 2! !TabMorph removeSelector: #createAnimationProcess!"Morphic-Widgets-Tabs"!"Polymorph-Widgets"!"Postscript:Leave the line above, and replace the rest of this comment by a useful one.Executable statements should follow this comment, and shouldbe separated by periods, with no exclamation points (!!).Be sure to put any further comments in double-quotes, like this one."|repository|repository := MCHttpRepository                location: 'http://smalltalkhub.com/mc/Pharo/Pharo60/main'                user: ''                password: ''.(repository loadVersionFromFileNamed:'ScriptLoader60-TheIntegrator.584.mcz') load.ScriptLoader new update60508.!----End fileIn----!----QUIT----2017-07-12T13:02:48.26072+02:00 Pharo.image priorSource: 359941!----QUIT----2017-07-12T13:02:59.007705+02:00 Pharo.image priorSource: 383187!----SNAPSHOT----2017-07-15T17:10:07.119136-03:00 Pharo6.0.image priorSource: 383265!!TraitPLCButton commentStamp: 'EricPernia 12/25/2016 21:20' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A TraitPLCButton is xxxxxxxxx.!!TraitPLCOneLineTag commentStamp: 'EricPernia 12/25/2016 21:20' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A TraitPLCOneLineTag is xxxxxxxxx.!!ConexionMorph commentStamp: 'EricPernia 12/25/2016 21:52' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------ ConexionMorph!!IDE4PLC_ConnectableBlocks_TestCase commentStamp: 'EricPernia 12/25/2016 21:51' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------IDE4PLC_ConnectableBlocks_TestCase!!PLC_ImageButtonMorph commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DesktopIcon is xxxxxxxxx.Instance Variables	imagePath:			<String>	imagePathHover:	<String>	objetive: <An Object that Understend a message bellow>	action:	<Symbol>imagePath	- The phat of the principal image of the button.imagePathHover	- The phat of the principal image of the button.objetive	- The target of the left click action.	action	- The acton to perform on left click.!!PLC_DesktopIconMorph commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DesktopIcon is xxxxxxxxx.!!PLC_ImageOpenSuicideMorph commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ImageOpenSuicide is xxxxxxxxx.Instance Variables!!PLC_ImageSuicideMorph commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ImageSuicide is xxxxxxxxx.Instance Variables!!PLC_ProIconMorph commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ProIcon is xxxxxxxxx.Instance Variables!!PLC_ToolbarButtonMorph commentStamp: 'EricPernia 12/25/2016 21:22' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ToolbarButton is xxxxxxxxx.Instance Variables	action:		<Object>	colorHover:		<Object>	imagePath:		<Object>	imagePathHover:		<Object>action	- xxxxxcolorHover	- xxxxximagePath	- xxxxximagePathHover	- xxxxx!!BloqueMorph commentStamp: 'EricPernia 12/25/2016 21:54' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueMorph!!BloqueOsciloscopio commentStamp: 'EricPernia 12/25/2016 21:54' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueOsciloscopio!!BorderedMorphConMetodosDePosiciones commentStamp: 'EricPernia 12/25/2016 21:53' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BorderedMorphConMetodosDePosiciones!!BMCMDPManejoDelClickYBloques commentStamp: 'EricPernia 12/25/2016 21:53' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BMCMDPManejoDelClickYBloques!!PinEntradaMorph commentStamp: 'EricPernia 12/25/2016 21:53' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------PinEntradaMorph!!PinSalidaMorph commentStamp: 'EricPernia 12/25/2016 21:53' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------PinSalidaMorph!!Propiedades commentStamp: 'EricPernia 12/25/2016 21:53' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------Propiedades!!GraficoMorph commentStamp: 'EricPernia 12/25/2016 21:52' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------GraficoMorph!!PLC_View commentStamp: 'EricPernia 12/25/2016 21:22' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_View is xxxxxxxxx.Instance Variables	model:		<Object>model	- xxxxx!!PLC_GraphicView commentStamp: 'EricPernia 12/25/2016 21:21' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_View is xxxxxxxxx.Instance Variables	controller:		<Object>	editor:		<Object>	elements:		<Object>	keyboardFocusElement:		<Object>	selectedElements:		<Object>	uiContext:		<Object>	unselectedElements:		<Object>controller	- xxxxxeditor	- xxxxxelements	- xxxxxkeyboardFocusElement	- xxxxxselectedElements	- xxxxxuiContext	- xxxxxunselectedElements	- xxxxx!!PLC_EditableGrid commentStamp: 'EricPernia 12/25/2016 21:21' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Grid is xxxxxxxxx.Instance Variables	identifier:		<Object>	morphRows:		<Object>	pouDeclarations:		<Object>	rows:		<Object>	selectedIndex:		<Object>identifier	- xxxxxmorphRows	- xxxxxpouDeclarations	- xxxxxrows	- xxxxxselectedIndex	- xxxxx!!PLC_GraphicProgramView commentStamp: 'EricPernia 12/25/2016 22:02' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GraphicProgramView is xxxxxxxxx.Instance Variables!!PLC_LadderView commentStamp: 'EricPernia 12/25/2016 21:21' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LadderView is xxxxxxxxx.Instance Variables	groups:		<Object>groups	- xxxxx!!BasicParsers commentStamp: 'EricPernia 12/25/2016 21:57' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!Bloque commentStamp: 'EricPernia 12/25/2016 21:56' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------Bloque!!BloqueDerivador commentStamp: 'EricPernia 12/25/2016 21:56' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueDerivador!!BloqueFuncionConstante commentStamp: 'EricPernia 12/25/2016 21:56' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueFuncionConstanteInstance Variables	constante:		<Object>constante	- xxxxx!!BloqueFuncionRampaT commentStamp: 'EricPernia 12/25/2016 21:56' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueFuncionRampaT!!BloqueFuncionSenoT commentStamp: 'EricPernia 12/25/2016 21:56' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueFuncionSenoT!!BloqueFuncionSincT commentStamp: 'EricPernia 12/25/2016 21:55' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueFuncionSincT!!BloqueFuncionT commentStamp: 'EricPernia 12/25/2016 21:55' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueFuncionT!!BloqueFuncionTAlCuadrado commentStamp: 'EricPernia 12/25/2016 21:55' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueFuncionTAlCuadrado!!BloqueGanancia commentStamp: 'EricPernia 12/25/2016 21:55' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueGanancia!!BloqueRetardo commentStamp: 'EricPernia 12/25/2016 21:54' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueRetardo!!BloqueSalida commentStamp: 'EricPernia 12/25/2016 21:54' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueSalida!!BloqueSumador commentStamp: 'EricPernia 12/25/2016 21:54' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------BloqueSumador!!CIAA_CProject commentStamp: 'EricPernia 12/25/2016 21:52' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!IDE4PLC commentStamp: 'EricPernia 12/25/2016 21:52' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLeriC is xxxxxxxxx.Instance Variables!!IDE4PLCParsers commentStamp: 'EricPernia 12/25/2016 21:51' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!Modelo commentStamp: 'EricPernia 12/25/2016 21:51' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------Modelo!!PLC_Aligns commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Aligns is xxxxxxxxx.Instance Variables!!PLC_CenterAlign commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CenterAlign is xxxxxxxxx.Instance Variables!!PLC_LeftAlign commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LeftAlign is xxxxxxxxx.Instance Variables!!PLC_RightAlign commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_RightAlign is xxxxxxxxx.Instance Variables!!PLC_Assignments commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Assignments is xxxxxxxxx.Instance Variables	actualArgument:		<Object>	formalParameter:		<Object>	pouCall:		<Object>actualArgument	- xxxxxformalParameter	- xxxxxpouCall	- xxxxx!!PLC_InputAssignment commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_InputAssignment is xxxxxxxxx.Instance Variables!!PLC_InOutAssignment commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_InOutAssignment is xxxxxxxxx.Instance Variables!!PLC_OutputAssignment commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_OutputAssignment is xxxxxxxxx.Instance Variables!!PLC_CIAA_FileSystem commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_FileSystem is xxxxxxxxx.Instance Variables	batFilesPath:		<Object>	cLibraryPath:		<Object>	guiImagesPath:		<Object>	hLibraryPath:		<Object>	ilExportPath:		<Object>	mainPath:		<Object>	workspacePath:		<Object>batFilesPath	- xxxxxcLibraryPath	- xxxxxguiImagesPath	- xxxxxhLibraryPath	- xxxxxilExportPath	- xxxxxmainPath	- xxxxxworkspacePath	- xxxxx!!PLC_CalledPOU commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CalledPOU is xxxxxxxxx.Instance Variables	standardFunctionBlocks:		<Object>	standardFunctions:		<Object>	standardPrograms:		<Object>	userFunctionBlocks:		<Object>	userFunctions:		<Object>	userPrograms:		<Object>standardFunctionBlocks	- xxxxxstandardFunctions	- xxxxxstandardPrograms	- xxxxxuserFunctionBlocks	- xxxxxuserFunctions	- xxxxxuserPrograms	- xxxxx!!PLC_ClassWithIdentifier commentStamp: 'EricPernia 12/25/2016 21:50' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ClassWithIdentifier is xxxxxxxxx.Instance Variables	identifier:		<Object>identifier	- xxxxx!!PLC_CPU commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CPU is xxxxxxxxx.Instance Variables	currentResult:		<Object>	programCounter:		<Object>	stack:		<Object>	stackPointer:		<Object>currentResult	- xxxxxprogramCounter	- xxxxxstack	- xxxxxstackPointer	- xxxxx!!PLC_DataType commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DataType is xxxxxxxxx.Instance Variables!!PLC_DerivedDataType commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DerivedDataType is xxxxxxxxx.Instance Variables	description:		<Object>description	- xxxxx!!PLC_StructureDecl commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_StructureDecl is xxxxxxxxx.Instance Variables	declarations:		<Object>declarations	- xxxxx!!PLC_TypeDecl commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_TypeDecl is xxxxxxxxx.Instance Variables	dataType:		<Object>dataType	- xxxxx!!PLC_ElementaryDataType commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ElementaryDataType is xxxxxxxxx.Instance Variables!!PLC_BitStrings commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_BitStrings is xxxxxxxxx.Instance Variables!!PLC_Boolean commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Boolean is xxxxxxxxx.Instance Variables!!PLC_Byte commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Byte is xxxxxxxxx.Instance Variables!!PLC_DoubleWord commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DoubleWord is xxxxxxxxx.Instance Variables!!PLC_LongWord commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LongWord is xxxxxxxxx.Instance Variables!!PLC_Word commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Word is xxxxxxxxx.Instance Variables!!PLC_DateAndTime commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DateAndTime is xxxxxxxxx.Instance Variables!!PLC_Date commentStamp: 'EricPernia 12/25/2016 21:49' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Date is xxxxxxxxx.Instance Variables!!PLC_DateAndTimeOfDay commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DateAndTimeOfDay is xxxxxxxxx.Instance Variables!!PLC_TimeOfDay commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_TimeOfDay is xxxxxxxxx.Instance Variables!!PLC_Reals commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Reals is xxxxxxxxx.Instance Variables!!PLC_LongReal commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LongReal is xxxxxxxxx.Instance Variables!!PLC_Real commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Real is xxxxxxxxx.Instance Variables!!PLC_SignedIntegers commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_SignedIntegers is xxxxxxxxx.Instance Variables!!PLC_DoubleInteger commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DoubleInteger is xxxxxxxxx.Instance Variables!!PLC_Duration commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Duration is xxxxxxxxx.Instance Variables	days:		<Object>	hours:		<Object>	milliseconds:		<Object>	minutes:		<Object>	seconds:		<Object>days	- xxxxxhours	- xxxxxmilliseconds	- xxxxxminutes	- xxxxxseconds	- xxxxx!!PLC_Integer commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Integer is xxxxxxxxx.Instance Variables!!PLC_LongInteger commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LongInteger is xxxxxxxxx.Instance Variables!!PLC_ShortInteger commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ShortInteger is xxxxxxxxx.Instance Variables!!PLC_UnspecifiedInteger commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UnspecifiedInteger is xxxxxxxxx.Instance Variables!!PLC_Strings commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Strings is xxxxxxxxx.Instance Variables!!PLC_DoubleByteString commentStamp: 'EricPernia 12/25/2016 21:48' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DoubleByteString is xxxxxxxxx.Instance Variables!!PLC_SingleByteString commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_SingleByteString is xxxxxxxxx.Instance Variables!!PLC_UnsignedIntegers commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UnsignedIntegers is xxxxxxxxx.Instance Variables!!PLC_UnsignedDoubleInteger commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UnsignedDoubleInteger is xxxxxxxxx.Instance Variables!!PLC_UnsignedInteger commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UnsignedInteger is xxxxxxxxx.Instance Variables!!PLC_UnsignedLongInteger commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UnsignedLongInteger is xxxxxxxxx.Instance Variables!!PLC_UnsignedShortInteger commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UnsignedShortInteger is xxxxxxxxx.Instance Variables!!PLC_Void commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Void is xxxxxxxxx.Instance Variables!!PLC_GenericDataType commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GenericDataType is xxxxxxxxx.Instance Variables!!PLC_AnyBit commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyBit is xxxxxxxxx.Instance Variables!!PLC_AnyDataType commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyDataType is xxxxxxxxx.Instance Variables!!PLC_AnyDate commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyDate is xxxxxxxxx.Instance Variables!!PLC_AnyDerived commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyDerived is xxxxxxxxx.Instance Variables!!PLC_AnyElementary commentStamp: 'EricPernia 12/25/2016 21:47' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyElementary is xxxxxxxxx.Instance Variables!!PLC_AnyInteger commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyInteger is xxxxxxxxx.Instance Variables!!PLC_AnyMagnitude commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyMagnitude is xxxxxxxxx.Instance Variables!!PLC_AnyNumeric commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyNumeric is xxxxxxxxx.Instance Variables!!PLC_AnyReal commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyReal is xxxxxxxxx.Instance Variables!!PLC_AnyString commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AnyString is xxxxxxxxx.Instance Variables!!PLC_Element commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Element is xxxxxxxxx.Instance Variables	inputs:		<Object>	outputs:		<Object>inputs	- xxxxxoutputs	- xxxxx!!PLC_ActualArgument commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ActualArgument is xxxxxxxxx.Instance Variables	actualArgument:		<Object>actualArgument	- xxxxx!!PLC_ActualArgumentReader commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ActualArgumentReader is xxxxxxxxx.Instance Variables!!PLC_ActualArgumentWriter commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ActualArgumentWriter is xxxxxxxxx.Instance Variables!!PLC_Coil commentStamp: 'EricPernia 12/25/2016 21:46' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Coil is xxxxxxxxx.Instance Variables	modifier:		<Object>	morph:		<Object>modifier	- xxxxxmorph	- xxxxx!!PLC_Contact commentStamp: 'EricPernia 12/25/2016 21:45' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Contact is xxxxxxxxx.Instance Variables	modifier:		<Object>	morph:		<Object>modifier	- xxxxxmorph	- xxxxx!!PLC_GraphicPOUCall commentStamp: 'EricPernia 12/25/2016 21:45' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GraphicPOUCall is xxxxxxxxx.Instance Variables	declaration:		<Object>	instance:		<Object>	network:		<Object>	numberOfCompiledImputs:		<Object>declaration	- xxxxxinstance	- xxxxxnetwork	- xxxxxnumberOfCompiledImputs	- xxxxx!!PLC_GraphicFunctionBlockCall commentStamp: 'EricPernia 12/25/2016 21:45' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------PLC_GraphicFunctionBlockCallInstance Variables!!PLC_GraphicFunctionCall commentStamp: 'EricPernia 12/25/2016 21:45' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------PLC_GraphicFunctionCallInstance Variables!!PLC_LeftPowerRail commentStamp: 'EricPernia 12/25/2016 21:45' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------PLC_LeftPowerRail!!PLC_RightPowerRail commentStamp: 'EricPernia 12/25/2016 21:44' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_RightPowerRail is xxxxxxxxx.Instance Variables!!PLC_VerticalLink commentStamp: 'EricPernia 12/25/2016 21:43' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VerticalLink is xxxxxxxxx.Instance Variables	numberOfCompiledImputs:		<Object>	objectTypeDecl:		<Object>	objectVarDecl:		<Object>numberOfCompiledImputs	- xxxxxobjectTypeDecl	- xxxxxobjectVarDecl	- xxxxx!!PLC_HardwareConfiguration commentStamp: 'EricPernia 12/25/2016 21:43' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_HardwareConfiguration is xxxxxxxxx.Instance Variables	devices:		<Object>	devicesChange:		<Object>	softwareConfiguration:		<Object>devices	- xxxxxdevicesChange	- xxxxxsoftwareConfiguration	- xxxxx!!PLC_POU commentStamp: 'EricPernia 12/25/2016 21:43' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_POU is xxxxxxxxx.Instance Variables	dataType:		<Object>	declarations:		<Object>	pouBody:		<Object>dataType	- xxxxxdeclarations	- xxxxxpouBody	- xxxxx!!PLC_Function commentStamp: 'EricPernia 12/25/2016 21:43' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Function is xxxxxxxxx.Instance Variables	instance:		<Object>instance	- xxxxx!!PLC_FunctionBlock commentStamp: 'EricPernia 12/25/2016 21:43' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_FunctionBlock is xxxxxxxxx.Instance Variables!!PLC_Program commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Program is xxxxxxxxx.Instance Variables!!PLC_Project commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Project is xxxxxxxxx.Instance Variables	hardwareConfigurations:		<Object>	libraries:		<Object>hardwareConfigurations	- xxxxxlibraries	- xxxxx!!PLC_Resource commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Resource is xxxxxxxxx.Instance Variables	declarations:		<Object>	processor:		<Object>	programConfigurations:		<Object>	softwareConfiguration:		<Object>	taskConfigurations:		<Object>declarations	- xxxxxprocessor	- xxxxxprogramConfigurations	- xxxxxsoftwareConfiguration	- xxxxxtaskConfigurations	- xxxxx!!PLC_SoftwareConfiguration commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_SoftwareConfiguration is xxxxxxxxx.Instance Variables	declarations:		<Object>	hardwareConfiguration:		<Object>	resources:		<Object>declarations	- xxxxxhardwareConfiguration	- xxxxxresources	- xxxxx!!PLC_TaskConfiguration commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_TaskConfiguration is xxxxxxxxx.Instance Variables	inputAssignments:		<Object>	inputDecls:		<Object>	programConfigurations:		<Object>	resource:		<Object>inputAssignments	- xxxxxinputDecls	- xxxxxprogramConfigurations	- xxxxxresource	- xxxxx!!PLC_CyclicTaskConfiguration commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CyclicTaskConfiguration is xxxxxxxxx.Instance Variables!!PLC_VariableCategoryDecl commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VariableCategoryDecl is xxxxxxxxx.Instance Variables	declarations:		<Object>	scope:		<Object>declarations	- xxxxxscope	- xxxxx!!PLC_VC_Config commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Config is xxxxxxxxx.Instance Variables!!PLC_VC_Constant commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Constant is xxxxxxxxx.Instance Variables!!PLC_VC_Extern commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Extern is xxxxxxxxx.Instance Variables!!PLC_VC_FunInstVar commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_funInstVar is xxxxxxxxx.Instance Variables!!PLC_VC_Global commentStamp: 'EricPernia 12/25/2016 21:42' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Global is xxxxxxxxx.Instance Variables!!PLC_VC_InOut commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_InOut is xxxxxxxxx.Instance Variables!!PLC_VC_Input commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Input is xxxxxxxxx.Instance Variables!!PLC_VC_Instance commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Instance is xxxxxxxxx.Instance Variables!!PLC_VC_Output commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Output is xxxxxxxxx.Instance Variables!!PLC_VC_OutputWired commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_OutputWired is xxxxxxxxx.Instance Variables!!PLC_VC_Return commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Return is xxxxxxxxx.Instance Variables!!PLC_VC_Temp commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Temp is xxxxxxxxx.Instance Variables!!PLC_VC_Var commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VC_Var is xxxxxxxxx.Instance Variables!!PLC_VariableDecl commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VariableDecl is xxxxxxxxx.Instance Variables	dataType:		<Object>	description:		<Object>	initialValue:		<Object>	operand:		<Object>	variableCategory:		<Object>dataType	- xxxxxdescription	- xxxxxinitialValue	- xxxxxoperand	- xxxxxvariableCategory	- xxxxx!!PLC_LocatedSymbolicVariableDecl commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LocatedSymbolicVariableDecl is xxxxxxxxx.Instance Variables	physicalAddress:		<Object>physicalAddress	- xxxxx!!PLC_LocatedVariableDecl commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LocatedVariableDecl is xxxxxxxxx.Instance Variables	physicalAddress:		<Object>physicalAddress	- xxxxx!!PLC_SymbolicVariableDecl commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_SymbolicVariableDecl is xxxxxxxxx.Instance Variables!!PLC_InstanceVariableDecl commentStamp: 'EricPernia 12/25/2016 21:41' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_InstanceVariableDecl is xxxxxxxxx.Instance Variables!!PLC_CompilerAndWriter commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CompilerAndWriter is xxxxxxxxx.Instance Variables	fileSystem:		<Object>fileSystem	- xxxxx!!PLC_ConnectableBlock commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ConnectableBlock is xxxxxxxxx.Instance Variables	connectableBlocksNetwork:		<Object>	element:		<Object>	inputs:		<Object>	outputs:		<Object>connectableBlocksNetwork	- xxxxxelement	- xxxxxinputs	- xxxxxoutputs	- xxxxx!!PLC_ConnectableBlockConnection commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ConnectableBlockConnection is xxxxxxxxx.Instance Variables	inputPin:		<Object>	outputPin:		<Object>inputPin	- xxxxxoutputPin	- xxxxx!!PLC_ConnectableBlockPin commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ConnectableBlockPin is xxxxxxxxx.Instance Variables	block:		<Object>	connection:		<Object>block	- xxxxxconnection	- xxxxx!!PLC_ConnectableBlockInputPin commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ConnectableBlockInputPin is xxxxxxxxx.Instance Variables!!PLC_ConnectableBlockOutputPin commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ConnectableBlockOutputPin is xxxxxxxxx.Instance Variables!!PLC_ConnectableBlocksNetwork commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ConnectableBlocksNetwork is xxxxxxxxx.Instance Variables	blocks:		<Object>	networkController:		<Object>	networkLabel:		<Object>	pouBody:		<Object>blocks	- xxxxxnetworkController	- xxxxxnetworkLabel	- xxxxxpouBody	- xxxxx!!PLC_LadderNetwork commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LadderNetwork is xxxxxxxxx.Instance Variables!!PLC_Controller commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Editor is xxxxxxxxx.Instance Variables	window:		<Object>window	- xxxxx!!PLC_EditorCProject commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!PLC_EditorDevices commentStamp: 'EricPernia 12/25/2016 21:40' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_EditorBoards is xxxxxxxxx.Instance Variables	borderColor:		<Object>	color:		<Object>	keyboardFocusMorph:		<Object>	pouDeclarations:		<Object>	pouDeclarationsView:		<Object>	selectedIndex:		<Object>	titleColor:		<Object>	titleName:		<Object>	window:		<Object>borderColor	- xxxxxcolor	- xxxxxkeyboardFocusMorph	- xxxxxpouDeclarations	- xxxxxpouDeclarationsView	- xxxxxselectedIndex	- xxxxxtitleColor	- xxxxxtitleName	- xxxxxwindow	- xxxxx!!PLC_EditorPOU commentStamp: 'EricPernia 12/25/2016 21:39' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_POU_Editor is xxxxxxxxx.Instance Variables	borderColor:		<Object>	color:		<Object>	keyboardFocusMorph:		<Object>	pou:		<Object>	pouBodyEditor:		<Object>	pouDeclsEditor:		<Object>	titleColor:		<Object>	titleName:		<Object>borderColor	- xxxxxcolor	- xxxxxkeyboardFocusMorph	- xxxxxpou	- xxxxxpouBodyEditor	- xxxxxpouDeclsEditor	- xxxxxtitleColor	- xxxxxtitleName	- xxxxx!!PLC_EditorPOUBody commentStamp: 'EricPernia 12/25/2016 21:39' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_POU_Body_Editor is xxxxxxxxx.Instance Variables	borderColor:		<Object>	color:		<Object>	keyboardFocusMorph:		<Object>	pouBody:		<Object>	pouBodyView:		<Object>	titleColor:		<Object>	titleName:		<Object>borderColor	- xxxxxcolor	- xxxxxkeyboardFocusMorph	- xxxxxpouBody	- xxxxxpouBodyView	- xxxxxtitleColor	- xxxxxtitleName	- xxxxx!!PLC_EditorPOUDeclarations commentStamp: 'EricPernia 12/25/2016 21:39' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_POU_Declarations_Editor is xxxxxxxxx.Instance Variables	borderColor:		<Object>	color:		<Object>	keyboardFocusMorph:		<Object>	pouDeclarations:		<Object>	pouDeclarationsView:		<Object>	selectedIndex:		<Object>	titleColor:		<Object>	titleName:		<Object>borderColor	- xxxxxcolor	- xxxxxkeyboardFocusMorph	- xxxxxpouDeclarations	- xxxxxpouDeclarationsView	- xxxxxselectedIndex	- xxxxxtitleColor	- xxxxxtitleName	- xxxxx!!PLC_LadderController commentStamp: 'EricPernia 12/25/2016 21:39' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LadderController is xxxxxxxxx.Instance Variables	ladderNetwork:		<Object>	ladderView:		<Object>ladderNetwork	- xxxxxladderView	- xxxxx!!PLC_ListSelector commentStamp: 'EricPernia 12/25/2016 21:39' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ListSelector is xxxxxxxxx.Instance Variables	borderColor:		<Object>	color:		<Object>	library:		<Object>	target:		<Object>	targetMessage:		<Object>	view:		<Object>borderColor	- xxxxxcolor	- xxxxxlibrary	- xxxxxtarget	- xxxxxtargetMessage	- xxxxxview	- xxxxx!!PLC_VariableDeclController commentStamp: 'EricPernia 12/25/2016 21:39' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VariableDeclController is xxxxxxxxx.!!PLC_DevicePLC commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DevicePLC is xxxxxxxxx.Instance Variables	analogInputs:		<Object>	analogOutputs:		<Object>	cpu:		<Object>	deviceName:		<Object>	digitalInputs:		<Object>	digitalOutputs:		<Object>	hardwareConfiguration:		<Object>analogInputs	- xxxxxanalogOutputs	- xxxxxcpu	- xxxxxdeviceName	- xxxxxdigitalInputs	- xxxxxdigitalOutputs	- xxxxxhardwareConfiguration	- xxxxx!!PLC_DevicePhysicalAddress commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DevicePhysicalAddress is xxxxxxxxx.Instance Variables	device:		<Object>	index:		<Object>	locationPrefix:		<Object>	sizePrefix:		<Object>device	- xxxxxindex	- xxxxxlocationPrefix	- xxxxxsizePrefix	- xxxxx!!PLC_EditorProgram commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_EditorProgram is xxxxxxxxx.Instance Variables	drawingArea:		<Object>	instructions:		<Object>	menubar:		<Object>	projectTree:		<Object>	properties:		<Object>	toolbar:		<Object>	window:		<Object>drawingArea	- xxxxxinstructions	- xxxxxmenubar	- xxxxxprojectTree	- xxxxxproperties	- xxxxxtoolbar	- xxxxxwindow	- xxxxx!!PLC_ErrorOperand commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ErrorOpenad is xxxxxxxxx.!!PLC_GraphicElementGroup commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GraphicElementGroup is xxxxxxxxx.!!PLC_GraphicElementProperties commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GraphicElementProperties is xxxxxxxxx.Instance Variables	drawBounds:		<Object>	drawGrid:		<Object>	drawLayoutRectangle:		<Object>	drawTextLineBorder:		<Object>	scale:		<Object>drawBounds	- xxxxxdrawGrid	- xxxxxdrawLayoutRectangle	- xxxxxdrawTextLineBorder	- xxxxxscale	- xxxxx!!PLC_GraphicElementState commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GraphicElementState is xxxxxxxxx.Instance Variables!!PLC_CSL1_ConnectedToBlock commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_ConnectedToBlock is xxxxxxxxx.Instance Variables!!PLC_CSL1_ConnectedToCoil commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_ConnectedToCoil is xxxxxxxxx.Instance Variables!!PLC_CSL1_ConnectedToContact commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_ConnectedToContact is xxxxxxxxx.Instance Variables!!PLC_CSL1_ConnectedToLeftPowerRail commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_ConnectedToLeftPowerRail is xxxxxxxxx.Instance Variables!!PLC_CSL1_ConnectedToRightPowerRail commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_ConnectedToRightPowerRail is xxxxxxxxx.Instance Variables!!PLC_CSL1_LeftAndRightConnectedToVerticalLink commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_LeftAndRightConnectedToVerticalLink is xxxxxxxxx.Instance Variables!!PLC_CSL1_LeftConnectedToVerticalLink commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_LeftConnectedToVerticalLink is xxxxxxxxx.Instance Variables!!PLC_CSL1_PinFromBooleanFormalParameter commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_PinFromBooleanFormalParameter is xxxxxxxxx.Instance Variables!!PLC_CSL1_PinFromNotBooleanFormalParameter commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_PinFromNotBooleanFormalParameter is xxxxxxxxx.Instance Variables!!PLC_CSL1_RightConnectedToVerticalLink commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_RightConnectedToVerticalLink is xxxxxxxxx.Instance Variables!!PLC_CSL1_Void commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL1_Void is xxxxxxxxx.Instance Variables!!PLC_CSL2_ConnectedToLeftPowerRailTroughFirstOutputPin commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL2_ConnectedToLeftPowerRailTroughFirstOutputPin is xxxxxxxxx.Instance Variables!!PLC_CSL2_NotConnectedToLeftPowerRailTroughFirstOutputPin commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL2_NotConnectedToLeftPowerRailTroughFirstOutputPin is xxxxxxxxx.Instance Variables!!PLC_CSL2_PinFallingEdge commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL2_PinFallingEdge is xxxxxxxxx.Instance Variables!!PLC_CSL2_PinNegated commentStamp: 'EricPernia 12/25/2016 21:34' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL2_PinNegated is xxxxxxxxx.Instance Variables!!PLC_CSL2_PinNormal commentStamp: 'EricPernia 12/25/2016 21:33' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL2_PinNormal is xxxxxxxxx.Instance Variables!!PLC_CSL2_PinRisingEdge commentStamp: 'EricPernia 12/25/2016 21:33' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CSL2_PinRisingEdge is xxxxxxxxx.Instance Variables!!PLC_UISL1_DraggingAnother commentStamp: 'EricPernia 12/25/2016 21:33' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UISL1_DraggingAnother is xxxxxxxxx.Instance Variables!!PLC_UISL1_DraggingAnother2 commentStamp: 'EricPernia 12/25/2016 21:33' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!PLC_UISL1_DraggingSelf commentStamp: 'EricPernia 12/25/2016 21:33' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UISL1_DraggingSelf is xxxxxxxxx.Instance Variables!!PLC_UISL1_Selected commentStamp: 'EricPernia 12/25/2016 21:33' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UISL1_Selected is xxxxxxxxx.Instance Variables!!PLC_UISL1_Unselected commentStamp: 'EricPernia 12/25/2016 21:32' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UISL1_Unselected is xxxxxxxxx.Instance Variables!!PLC_UISL1_Unselected2 commentStamp: 'EricPernia 12/25/2016 21:32' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!PLC_UISL2_KeyboardFocus commentStamp: 'EricPernia 12/25/2016 21:32' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UISL2_KeyboardFocus is xxxxxxxxx.Instance Variables!!PLC_UISL2_OverDropArea commentStamp: 'EricPernia 12/25/2016 21:31' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UISL2_OverDropArea is xxxxxxxxx.Instance Variables!!PLC_UISL2_UnderDragArea commentStamp: 'EricPernia 12/25/2016 21:31' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UISL2_UnderDragArea is xxxxxxxxx.Instance Variables!!PLC_UISL3_MouseOver commentStamp: 'EricPernia 12/25/2016 21:31' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UISL3_MouseOver is xxxxxxxxx.Instance Variables!!PLC_UIS_VoidState commentStamp: 'EricPernia 12/25/2016 21:31' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_UIS_VoidState is xxxxxxxxx.Instance Variables!!PLC_IL_Instruction commentStamp: 'EricPernia 12/25/2016 21:31' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_IL_Instruction is xxxxxxxxx.Instance Variables	label:		<Object>	modifiers:		<Object>	operands:		<Object>label	- xxxxxmodifiers	- xxxxxoperands	- xxxxx!!PLC_ArithmeticAndComparisonInstructions commentStamp: 'EricPernia 12/25/2016 21:31' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ArithmeticAndComparisonInstructions is xxxxxxxxx.Instance Variables!!PLC_ADD_Instruction commentStamp: 'EricPernia 12/25/2016 21:31' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ADD_Instruction is xxxxxxxxx.Instance Variables!!PLC_DIV_Instruction commentStamp: 'EricPernia 12/25/2016 21:31' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_DIV_Instruction is xxxxxxxxx.Instance Variables!!PLC_EQ_Instruction commentStamp: 'EricPernia 12/25/2016 21:30' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_EQ_Instruction is xxxxxxxxx.Instance Variables!!PLC_GE_Instruction commentStamp: 'EricPernia 12/25/2016 21:30' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GE_Instruction is xxxxxxxxx.Instance Variables!!PLC_GT_Instruction commentStamp: 'EricPernia 12/25/2016 21:30' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GT_Instruction is xxxxxxxxx.Instance Variables!!PLC_LE_Instruction commentStamp: 'EricPernia 12/25/2016 21:30' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LE_Instruction is xxxxxxxxx.Instance Variables!!PLC_LT_Instruction commentStamp: 'EricPernia 12/25/2016 21:30' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LT_Instruction is xxxxxxxxx.Instance Variables!!PLC_MOD_Instruction commentStamp: 'EricPernia 12/25/2016 21:30' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_MOD_Instruction is xxxxxxxxx.Instance Variables!!PLC_MUL_Instruction commentStamp: 'EricPernia 12/25/2016 21:30' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_MUL_Instruction is xxxxxxxxx.Instance Variables!!PLC_NE_Instruction commentStamp: 'EricPernia 12/25/2016 21:30' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_NE_Instruction is xxxxxxxxx.Instance Variables!!PLC_SUB_Instruction commentStamp: 'EricPernia 12/25/2016 21:29' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_SUB_Instruction is xxxxxxxxx.Instance Variables!!PLC_CAL_Instruction commentStamp: 'EricPernia 12/25/2016 21:29' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CAL_Instruction is xxxxxxxxx.Instance Variables!!PLC_LD_Instruction commentStamp: 'EricPernia 12/25/2016 21:29' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LD_Instruction is xxxxxxxxx.Instance Variables!!PLC_LogicalInstructions commentStamp: 'EricPernia 12/25/2016 21:28' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LogicalInstructions is xxxxxxxxx.Instance Variables!!PLC_AND_Instruction commentStamp: 'EricPernia 12/25/2016 21:28' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_AND_Instruction is xxxxxxxxx.Instance Variables!!PLC_OR_Instruction commentStamp: 'EricPernia 12/25/2016 21:28' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_OR_Instruction is xxxxxxxxx.Instance Variables!!PLC_XOR_Instruction commentStamp: 'EricPernia 12/25/2016 21:28' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_XOR_Instruction is xxxxxxxxx.Instance Variables!!PLC_NOT_Instruction commentStamp: 'EricPernia 12/25/2016 21:28' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_NOT_Instruction is xxxxxxxxx.Instance Variables!!PLC_ST_Instruction commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ST_Instruction is xxxxxxxxx.Instance Variables!!PLC_SetAndReset commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_SetAndReset is xxxxxxxxx.Instance Variables!!PLC_R_Instruction commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_R_Instruction is xxxxxxxxx.Instance Variables!!PLC_S_Instruction commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_S_Instruction is xxxxxxxxx.Instance Variables!!PLC_StandarBody_Instruction commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_StandarBody_Instruction is xxxxxxxxx.Instance Variables	cCode:		<Object>cCode	- xxxxx!!PLC_IL_Modifiers commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_IL_Modifiers is xxxxxxxxx.Instance Variables!!PLC_IL_CModifier commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_IL_CModifier is xxxxxxxxx.Instance Variables!!PLC_IL_NModifier commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_IL_NModifier is xxxxxxxxx.Instance Variables!!PLC_IL_NullModifier commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_IL_NullModifier is xxxxxxxxx.Instance Variables!!PLC_IL_ParenthesisModifier commentStamp: 'EricPernia 12/25/2016 21:27' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_IL_ParenthesisModifier is xxxxxxxxx.Instance Variables!!PLC_Identifier commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Identifier is xxxxxxxxx.Instance Variables	identifier:		<Object>identifier	- xxxxx!!PLC_Language commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!PLC_Libraries commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Libraries is xxxxxxxxx.Instance Variables	dataTypes:		<Object>	funcionBlockDecls:		<Object>	functionBlockList:		<Object>	functionDecls:		<Object>	functionList:		<Object>	ilInstructions:		<Object>	ladderElementList:		<Object>	ladderElements:		<Object>	programDecls:		<Object>	programList:		<Object>	stdFuncionBlocks:		<Object>	stdFuncions:		<Object>dataTypes	- xxxxxfuncionBlockDecls	- xxxxxfunctionBlockList	- xxxxxfunctionDecls	- xxxxxfunctionList	- xxxxxilInstructions	- xxxxxladderElementList	- xxxxxladderElements	- xxxxxprogramDecls	- xxxxxprogramList	- xxxxxstdFuncionBlocks	- xxxxxstdFuncions	- xxxxx!!PLC_Literal commentStamp: 'EricPernia 12/25/2016 21:25' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Literal is xxxxxxxxx.Instance Variables	dataType:		<Object>	dataValue:		<Object>dataType	- xxxxxdataValue	- xxxxx!!PLC_Location commentStamp: 'EricPernia 12/25/2016 21:25' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Location is xxxxxxxxx.Instance Variables	dataValue:		<Object>	declaration:		<Object>dataValue	- xxxxxdeclaration	- xxxxx!!PLC_ObjGuardable commentStamp: 'EricPernia 12/25/2016 21:25' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!PLC_Objects commentStamp: 'EricPernia 12/25/2016 21:25' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Objects is xxxxxxxxx.Instance Variables	objects:		<Object>objects	- xxxxx!!PLC_POUBody commentStamp: 'EricPernia 12/25/2016 21:24' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_POUBody is xxxxxxxxx.Instance Variables	networks:		<Object>	pou:		<Object>networks	- xxxxxpou	- xxxxx!!PLC_InstructionListBody commentStamp: 'EricPernia 12/25/2016 21:24' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_InstructionListBody is xxxxxxxxx.Instance Variables!!PLC_LadderBody commentStamp: 'EricPernia 12/25/2016 21:24' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LadderBody is xxxxxxxxx.Instance Variables!!PLC_StandardBody commentStamp: 'EricPernia 12/25/2016 21:24' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_StandardBody is xxxxxxxxx.Instance Variables	cCode:		<Object>	calledPOUs:		<Object>cCode	- xxxxxcalledPOUs	- xxxxx!!PLC_POU_Declarations commentStamp: 'EricPernia 12/25/2016 21:24' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_POU_Declarations is xxxxxxxxx.Instance Variables	funInstVarDecls:		<Object>	pouDecl:		<Object>	userDataTypesDecls:		<Object>	userVarDecls:		<Object>funInstVarDecls	- xxxxxpouDecl	- xxxxxuserDataTypesDecls	- xxxxxuserVarDecls	- xxxxx!!PLC_Function_Declarations commentStamp: 'EricPernia 12/25/2016 21:24' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Function_Declarations is xxxxxxxxx.Instance Variables!!PLC_POU_Editor_Backup commentStamp: 'EricPernia 12/25/2016 21:24' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_POU_Editor_Backup is xxxxxxxxx.Instance Variables	keyboardFocusNetwork:		<Object>	selectedVariableIndex:		<Object>keyboardFocusNetwork	- xxxxxselectedVariableIndex	- xxxxx!!PLC_ProgramAccumulator_POU commentStamp: 'EricPernia 12/25/2016 21:24' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ProgramAccumulator_POU is xxxxxxxxx.Instance Variables	compiledBody:		<Object>	compilerDataTypesDecls:		<Object>	compilerVarDecls:		<Object>compiledBody	- xxxxxcompilerDataTypesDecls	- xxxxxcompilerVarDecls	- xxxxx!!PLC_Project_Editor commentStamp: 'EricPernia 12/25/2016 21:23' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Project_Editor is xxxxxxxxx.Instance Variables	borderColor:		<Object>	color:		<Object>	hardConfigEditor:		<Object>	keyboardFocusMorph:		<Object>	project:		<Object>	titleColor:		<Object>	titleName:		<Object>borderColor	- xxxxxcolor	- xxxxxhardConfigEditor	- xxxxxkeyboardFocusMorph	- xxxxxproject	- xxxxxtitleColor	- xxxxxtitleName	- xxxxx!!PLC_Proyect_Editor_OLD commentStamp: 'EricPernia 12/25/2016 21:23' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Proyect_Editor_OLD is xxxxxxxxx.Instance Variables	keyboardFocusNetwork:		<Object>	selectedVariableIndex:		<Object>keyboardFocusNetwork	- xxxxxselectedVariableIndex	- xxxxx!!PLC_Resource_Declarations commentStamp: 'EricPernia 12/25/2016 21:23' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Resource_Declarations is xxxxxxxxx.Instance Variables	resourceDecl:		<Object>	userDataTypesDecls:		<Object>	userVarDecls:		<Object>resourceDecl	- xxxxxuserDataTypesDecls	- xxxxxuserVarDecls	- xxxxx!!PLC_StPersistence commentStamp: 'EricPernia 12/25/2016 21:19' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------!!PLC_StructureInitialization commentStamp: 'EricPernia 12/25/2016 21:23' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_StructureInitialization is xxxxxxxxx.Instance Variables	structDecl:		<Object>	values:		<Object>structDecl	- xxxxxvalues	- xxxxx!!PLC_StructureItem commentStamp: 'EricPernia 12/25/2016 21:23' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_StructureItem is xxxxxxxxx.Instance Variables	items:		<Object>items	- xxxxx!!PLC_TextualPOUCall commentStamp: 'EricPernia 12/25/2016 21:23' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_TextualPOUCall is xxxxxxxxx.Instance Variables	declaration:		<Object>	inOutAssignments:		<Object>	inputAssignments:		<Object>	instanceOperand:		<Object>	outputAssignments:		<Object>declaration	- xxxxxinOutAssignments	- xxxxxinputAssignments	- xxxxxinstanceOperand	- xxxxxoutputAssignments	- xxxxx!!PLC_ProgramConfiguration commentStamp: 'EricPernia 12/25/2016 21:22' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ProgramConfiguration is xxxxxxxxx.Instance Variables	task:		<Object>task	- xxxxx!!PLC_TextualFunctionBlockCall commentStamp: 'EricPernia 12/25/2016 21:22' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_TextualFunctionBlockCall is xxxxxxxxx.Instance Variables!!PLC_TextualFunctionCall commentStamp: 'EricPernia 12/25/2016 21:22' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_TextualFunctionCall is xxxxxxxxx.Instance Variables	returnAssignment:		<Object>returnAssignment	- xxxxx!!PLC_Variable commentStamp: 'EricPernia 12/25/2016 21:22' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Variable is xxxxxxxxx.Instance Variables	dataValue:		<Object>	declaration:		<Object>dataValue	- xxxxxdeclaration	- xxxxx!!PLC_VoidOperand commentStamp: 'EricPernia 12/25/2016 21:21' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VoidOpenad is xxxxxxxxx.Instance Variables!!SalidaActiva commentStamp: 'EricPernia 12/25/2016 21:21' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A SalidaActiva is xxxxxxxxx.!!PLC_GraphicElementMorph commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GraphicElementMorph is xxxxxxxxx.Instance Variables	connectionStateLayer1:		<Object>	connectionStateLayer2:		<Object>	userInteractionStateLayer1:		<Object>	userInteractionStateLayer2:		<Object>	userInteractionStateLayer3:		<Object>	xPositioned:		<Object>	yPositioned:		<Object>connectionStateLayer1	- xxxxxconnectionStateLayer2	- xxxxxuserInteractionStateLayer1	- xxxxxuserInteractionStateLayer2	- xxxxxuserInteractionStateLayer3	- xxxxxxPositioned	- xxxxxyPositioned	- xxxxx!!PLC_GraphicElementWithPinsMorph commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_GraphicElementWithPinsMorph is xxxxxxxxx.Instance Variables	inputPins:		<Object>	outputPins:		<Object>inputPins	- xxxxxoutputPins	- xxxxx!!PLC_BlockMorph commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_BlockMorph is xxxxxxxxx.Instance Variables	inputFormalParameters:		<Object>	instanceVariable:		<Object>	modelElement:		<Object>	outputFormalParameters:		<Object>inputFormalParameters	- xxxxxinstanceVariable	- xxxxxmodelElement	- xxxxxoutputFormalParameters	- xxxxx!!PLC_ContactsAndCoils commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ContactsAndCoils is xxxxxxxxx.Instance Variables	instanceVariable:		<Object>instanceVariable	- xxxxx!!PLC_CoilMorph commentStamp: 'EricPernia 12/25/2016 21:38' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CoilMorph is xxxxxxxxx.Instance Variables	isConnectedToRightPowerRail:		<Object>isConnectedToRightPowerRail	- xxxxx!!PLC_NCoilMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_NCoilMorph is xxxxxxxxx.Instance Variables!!PLC_NOContactMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_NOContactMorph is xxxxxxxxx.Instance Variables!!PLC_NCContactMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_NCContactMorph is xxxxxxxxx.Instance Variables!!PLC_LeftPowerRailMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_LeftPowerRailMorph is xxxxxxxxx.Instance Variables!!PLC_RightPowerRailMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_RightPowerRailMorph is xxxxxxxxx.Instance Variables!!PLC_VerticalLinkMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_VerticalLinkMorph is xxxxxxxxx.Instance Variables!!PLC_HorizontalLinkMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_HorizontalLinkMorph is xxxxxxxxx.Instance Variables!!PLC_PinBlockMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_PinBlockMorph is xxxxxxxxx.Instance Variables!!PLC_PinMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_PinMorph is xxxxxxxxx.Instance Variables!!PLC_TagMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_TagMorph is xxxxxxxxx.Instance Variables	graphicElement:		<Object>	text:		<Object>	textAlign:		<Object>graphicElement	- xxxxxtext	- xxxxxtextAlign	- xxxxx!!PLC_BlockNameMorph commentStamp: 'EricPernia 12/25/2016 21:37' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_BlockNameMorph is xxxxxxxxx.Instance Variables!!PLC_ButtonMorph commentStamp: 'EricPernia 12/25/2016 21:36' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_Button is xxxxxxxxx.Instance Variables	action:		<Object>	objetive:		<Object>action	- xxxxxobjetive	- xxxxx!!PLC_EditableTagMorph commentStamp: 'EricPernia 12/25/2016 21:36' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_EditableTagMorph is xxxxxxxxx.Instance Variables	pluggableTextMorph:		<Object>pluggableTextMorph	- xxxxx!!PLC_ActualArgumentMorph commentStamp: 'EricPernia 12/25/2016 21:36' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_ActualArgumentMorph is xxxxxxxxx.Instance Variables!!PLC_CellMorph commentStamp: 'EricPernia 12/25/2016 21:36' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_CellMorph is xxxxxxxxx.Instance Variables	pluggableTextMorph:		<Object>pluggableTextMorph	- xxxxx!!PLC_FormalParameterMorph commentStamp: 'EricPernia 12/25/2016 21:36' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_FormalParameterMorph is xxxxxxxxx.Instance Variables!!PLC_InOutFormalParameterMorph commentStamp: 'EricPernia 12/25/2016 21:36' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_InOutFormalParameterMorph is xxxxxxxxx.Instance Variables	inOutFPAssociated:		<Object>inOutFPAssociated	- xxxxx!!PLC_OneLineTagMorph commentStamp: 'EricPernia 12/25/2016 21:36' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_OneLineTagMorph is xxxxxxxxx.Instance Variables!!PLC_OverloadedMorph commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_OverloadedMorph is xxxxxxxxx.Instance Variables!!PLC_RowMorph commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_RowMorph is xxxxxxxxx.Instance Variables	backgroundBorderColor:		<Object>	backgroundBorderWidth:		<Object>	backgroundColor:		<Object>	emphasis:		<Object>	leftMargin:		<Object>	rightMargin:		<Object>	textColor:		<Object>backgroundBorderColor	- xxxxxbackgroundBorderWidth	- xxxxxbackgroundColor	- xxxxxemphasis	- xxxxxleftMargin	- xxxxxrightMargin	- xxxxxtextColor	- xxxxx!!PLC_TitleMorph commentStamp: 'EricPernia 12/25/2016 21:35' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_TitleMorph is xxxxxxxxx.Instance Variables	backgroundBorderColor:		<Object>	backgroundBorderWidth:		<Object>	backgroundColor:		<Object>	emphasis:		<Object>	leftMargin:		<Object>	rightMargin:		<Object>	textColor:		<Object>backgroundBorderColor	- xxxxxbackgroundBorderWidth	- xxxxxbackgroundColor	- xxxxxemphasis	- xxxxxleftMargin	- xxxxxrightMargin	- xxxxxtextColor	- xxxxx!!PLC_InsertionPointMorph commentStamp: 'EricPernia 12/25/2016 21:26' prior: 0!Copyright  2012-2017 Eric Nicols Pernia.This class is part of IDE4PLC.IDE4PLC is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.IDE4PLC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.You should have received a copy of the GNU Lesser General Public License along with IDE4PLC. If not, see <http://www.gnu.org/licenses/>.------------------------------------------------------------------A PLC_InsertionPointMorph is xxxxxxxxx.Instance Variables	drawingLayer:		<Object>	properties:		<Object>drawingLayer	- xxxxxproperties	- xxxxx!!TraitPLCButton methodsFor: 'event handling' stamp: 'EricPernia 4/27/2015 00:03'!handlesMouseDown: anEvent	"Permite manejar el evento de cuando el usuatio clickea el mouse sobre el morph."	^ true.! !!TraitPLCButton methodsFor: 'event handling' stamp: 'EricPernia 4/27/2015 00:03'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^true.! !!TraitPLCButton methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:45'!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			self objetive ifNotNil: [		self objetive perform: self action.	]! !!TraitPLCButton methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:04'!leftDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."! !!TraitPLCButton methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:04'!leftDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!TraitPLCButton methodsFor: 'event handling' stamp: 'EricPernia 4/27/2015 00:06'!mouseDown: anEvent	"Manejador del evento mouse down"	"Do nothing upon mouse-down except inform the hand to watch for a double-click; wait until an 	ensuing click:, doubleClick:, or drag: message gets dispatched"	"Note that mouseMove: and mouseUp: events are not sent to aMorph until it becomes the mouse focus,	which is typically done by aMorph in its click:, doubleClick:, or drag: methods."		anEvent redButtonPressed "click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#leftClick:. #leftDoubleClick:. #leftDoubleClickTimeout:. #startDrag:.}				threshold: 5.								].				anEvent yellowButtonPressed "action-click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#rightClick:. #rightDoubleClick:. #rightDoubleClickTimeout:. nil.}				threshold: 5.			].! !!TraitPLCButton methodsFor: 'event handling' stamp: 'EricPernia 4/27/2015 00:06'!mouseEnter: anEvent	"Manejador del evento mouse enter. Este mensaje se le envia al 	morph cuando el puntero del mouse empieza a pasar por el."	self mouseOver.! !!TraitPLCButton methodsFor: 'event handling' stamp: 'EricPernia 4/27/2015 00:05'!mouseLeave: anEvent	"Manejador del evento mouse leave. Este mensaje se le envia al 	morph cuando el puntero del mouse deja de pasarpor el."	self mouseOut.! !!TraitPLCButton methodsFor: 'event handling' stamp: 'EricPernia 4/27/2015 00:05'!mouseUp: anEvent	"Manejador del evento mouse up"		! !!TraitPLCButton methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:05'!rightClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."! !!TraitPLCButton methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:05'!rightDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."	! !!TraitPLCButton methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:05'!rightDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!TraitPLCButton methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:05'!startDrag: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(startDrag) sent when the mouse moves more than threshold pixels from evt's position within DoubleClickTime."			anEvent hand grabMorph: self! !!TraitPLCOneLineTag methodsFor: 'drawing' stamp: 'EricPernia 4/27/2015 20:59'!stringsToDraw	"Devuelve una Ordered collection con los strings haciendo wrap al contenedor."	| strings |		"Strings es una OC de lineas de texto"	strings := OrderedCollection new.		strings add: super stringsToDraw first.	^ strings.! !!ConexionMorph class methodsFor: 'instance creation' stamp: 'EricPernia 12/19/2010 05:37'!newConPinEntrada: unPinEntradaMorph yPinSalida: unPinSalidaMorph	| conexion |		conexion := self new.						conexion pinEntradaMorph: unPinEntradaMorph.	conexion pinSalidaMorph: unPinSalidaMorph..		conexion construir.		conexion pinEntradaMorph bloqueMorph addDependent: conexion.	conexion pinSalidaMorph bloqueMorph addDependent: conexion.	"b addDependent: a. Con esto nos aseguramos que Smalltalk le avise a 'a' cuando cambie 'b'"		^conexion.! !!ConexionMorph methodsFor: 'event handling' stamp: 'EricPernia 12/19/2010 06:24'!click: evt	super click: evt.  "Borrar, hace que no haga anda al clikearla"		"self ponerConexionEnRojo."		 "HACER METODO, tiene que hacer que se ponga roja y si luego tocan suprimir cuando esta en roja se borra la flecha y se desconectan los bloques internos."! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:54'!construir		self construirPrimerSegmento.	self construirSegundoSegmento.	self construirTercerSegmento.	self construirTriangulo.	self openInWorld.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 13:54'!construirPrimerSegmento	self vertices: self verticesPrimerSegmento		color: Color black 		borderWidth: 2 		borderColor: Color black.	self beStraightSegments.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 9/16/2011 14:34'!construirSegundoSegmento	|segmento|		segmento := PolygonMorph  new.		segmento vertices: self verticesSegundoSegmento				color: Color black 				borderWidth: 2 				borderColor: Color black.						segmento beStraightSegments.		self addMorph: segmento.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 9/16/2011 14:35'!construirTercerSegmento	|segmento|		segmento := PolygonMorph  new.		segmento vertices: self verticesTercerSegmento				color: Color black 				borderWidth: 2 				borderColor: Color black.						segmento beStraightSegments.		self addMorph: segmento.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 9/16/2011 14:36'!construirTriangulo	|segmento|		segmento := PolygonMorph  new.		segmento vertices: self verticesTriangulo				color: Color black 				borderWidth: 2 				borderColor: Color black.						segmento beStraightSegments.		self addMorph: segmento.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:17'!coordenadaMediaDesdePinEntrada	^ self coordenadaPinSalidaMorph x + self distanciaMediaEntrePines @ self coordenadaPinEntradaMorph y.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:16'!coordenadaMediaDesdePinSalida	^ self coordenadaPinSalidaMorph x + self distanciaMediaEntrePines @ self coordenadaPinSalidaMorph y.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 15:28'!coordenadaPinEntradaMorph	^ self pinEntradaMorph centro.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:22'!coordenadaPinEntradaMorphEste	^ self pinEntradaMorph este.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 15:28'!coordenadaPinSalidaMorph	^ self pinSalidaMorph centro.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:27'!distanciaMediaEntrePines	"Relativa a Pin salida"	^ (self coordenadaPinEntradaMorph x - self coordenadaPinSalidaMorph x / 2) asInteger.  ! !!ConexionMorph methodsFor: 'accessing' stamp: 'EricPernia 12/5/2010 21:13'!pinEntradaMorph	^ pinEntradaMorph! !!ConexionMorph methodsFor: 'accessing' stamp: 'EricPernia 12/5/2010 21:13'!pinEntradaMorph: anObject	pinEntradaMorph := anObject! !!ConexionMorph methodsFor: 'accessing' stamp: 'EricPernia 12/5/2010 21:13'!pinSalidaMorph	^ pinSalidaMorph! !!ConexionMorph methodsFor: 'accessing' stamp: 'EricPernia 12/5/2010 21:13'!pinSalidaMorph: anObject	pinSalidaMorph := anObject! !!ConexionMorph methodsFor: 'updating' stamp: 'EricPernia 8/10/2015 03:34'!update: aPoint	self removeAllMorphs.	self delete.	self construir.	World changed.! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:20'!verticesPrimerSegmento	^{(self coordenadaPinSalidaMorph). (self coordenadaMediaDesdePinSalida)}! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:20'!verticesSegundoSegmento	^{(self coordenadaMediaDesdePinSalida). (self coordenadaMediaDesdePinEntrada)}! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:20'!verticesTercerSegmento	^{(self coordenadaMediaDesdePinEntrada). (self coordenadaPinEntradaMorph)}! !!ConexionMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 16:22'!verticesTriangulo	^ {(self coordenadaPinEntradaMorphEste - (10 @ 4)). (self coordenadaPinEntradaMorphEste). (self coordenadaPinEntradaMorphEste + (10 negated @ 4))}! !!IDE4PLC_ConnectableBlocks_TestCase methodsFor: 'unit-tests' stamp: 'EricPernia 4/7/2015 02:03'!testConncetableBlockAddInputPins	"Test a ConnectableBlock instance add / remove input and outputs pins"	| connBlock1 inputPin1 inputPin2 inputPin3 inputPin4 inputPin5 |	connBlock1 := PLC_ConnectableBlock new.				"Add input pin"		self assert: connBlock1 inputs size equals: 0.		connBlock1 addInputPin.	self assert: connBlock1 inputs size equals: 1.		connBlock1 addInputPin.	self assert: connBlock1 inputs size equals: 2.		connBlock1 addInputPin.	self assert: connBlock1 inputs size equals: 3.		self assert: (connBlock1 inputs at: 1) class equals: PLC_ConnectableBlockInputPin.	self assert: (connBlock1 inputs at: 2) class equals: PLC_ConnectableBlockInputPin.	self assert: (connBlock1 inputs at: 3) class equals: PLC_ConnectableBlockInputPin.				"Add input pin after another pin"		inputPin2 := connBlock1 inputs at: 2.	inputPin3 := connBlock1 inputs at: 3.		connBlock1 addInputPinAfter: inputPin2.		self assert: connBlock1 inputs size equals: 4.	self assert: (connBlock1 inputs at: 2) equals: inputPin2.	self assert: (connBlock1 inputs at: 4) equals: inputPin3.				"Add input pin after pin 1"		inputPin1 := connBlock1 inputs at: 1.	inputPin2 := connBlock1 inputs at: 2.	inputPin3 := connBlock1 inputs at: 3.	inputPin4 := connBlock1 inputs at: 4.		connBlock1 addInputPinAfter: inputPin1.		self assert: connBlock1 inputs size equals: 5.	self assert: (connBlock1 inputs at: 1) equals: inputPin1.	self assert: (connBlock1 inputs at: 3) equals: inputPin2.	self assert: (connBlock1 inputs at: 4) equals: inputPin3.	self assert: (connBlock1 inputs at: 5) equals: inputPin4.				"Add input pin after last pin"		inputPin1 := connBlock1 inputs at: 1.	inputPin2 := connBlock1 inputs at: 2.	inputPin3 := connBlock1 inputs at: 3.	inputPin4 := connBlock1 inputs at: 4.	inputPin5 := connBlock1 inputs at: 5.		connBlock1 addInputPinAfter: inputPin5.		self assert: connBlock1 inputs size equals: 6.	self assert: (connBlock1 inputs at: 1) equals: inputPin1.	self assert: (connBlock1 inputs at: 2) equals: inputPin2.	self assert: (connBlock1 inputs at: 3) equals: inputPin3.	self assert: (connBlock1 inputs at: 4) equals: inputPin4.	self assert: (connBlock1 inputs at: 5) equals: inputPin5.			! !!IDE4PLC_ConnectableBlocks_TestCase methodsFor: 'unit-tests' stamp: 'EricPernia 4/7/2015 01:56'!testConncetableBlockAddOutputPins	"Test a ConnectableBlock instance add / remove input and outputs pins"	| connBlock1 outputPin1 outputPin2 outputPin3 outputPin4 outputPin5 |	connBlock1 := PLC_ConnectableBlock new.				"Add output pin"		self assert: connBlock1 outputs size equals: 0.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 1.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 2.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 3.		self assert: (connBlock1 outputs at: 1) class equals: PLC_ConnectableBlockOutputPin.	self assert: (connBlock1 outputs at: 2) class equals: PLC_ConnectableBlockOutputPin.	self assert: (connBlock1 outputs at: 3) class equals: PLC_ConnectableBlockOutputPin.				"Add output pin after another pin"		outputPin2 := connBlock1 outputs at: 2.	outputPin3 := connBlock1 outputs at: 3.		connBlock1 addOutputPinAfter: outputPin2.		self assert: connBlock1 outputs size equals: 4.	self assert: (connBlock1 outputs at: 2) equals: outputPin2.	self assert: (connBlock1 outputs at: 4) equals: outputPin3.				"Add output pin after pin 1"		outputPin1 := connBlock1 outputs at: 1.	outputPin2 := connBlock1 outputs at: 2.	outputPin3 := connBlock1 outputs at: 3.	outputPin4 := connBlock1 outputs at: 4.		connBlock1 addOutputPinAfter: outputPin1.		self assert: connBlock1 outputs size equals: 5.	self assert: (connBlock1 outputs at: 1) equals: outputPin1.	self assert: (connBlock1 outputs at: 3) equals: outputPin2.	self assert: (connBlock1 outputs at: 4) equals: outputPin3.	self assert: (connBlock1 outputs at: 5) equals: outputPin4.				"Add output pin after last pin"		outputPin1 := connBlock1 outputs at: 1.	outputPin2 := connBlock1 outputs at: 2.	outputPin3 := connBlock1 outputs at: 3.	outputPin4 := connBlock1 outputs at: 4.	outputPin5 := connBlock1 outputs at: 5.		connBlock1 addOutputPinAfter: outputPin5.		self assert: connBlock1 outputs size equals: 6.	self assert: (connBlock1 outputs at: 1) equals: outputPin1.	self assert: (connBlock1 outputs at: 2) equals: outputPin2.	self assert: (connBlock1 outputs at: 3) equals: outputPin3.	self assert: (connBlock1 outputs at: 4) equals: outputPin4.	self assert: (connBlock1 outputs at: 5) equals: outputPin5.		! !!IDE4PLC_ConnectableBlocks_TestCase methodsFor: 'unit-tests' stamp: 'EricPernia 4/7/2015 01:06'!testConncetableBlockCreation	"Test a new ConnectableBlock instance"	| connBlock1 |	connBlock1 := PLC_ConnectableBlock new.		self assert: connBlock1 inputs class == OrderedCollection.	self assert: connBlock1 outputs class equals: OrderedCollection.! !!IDE4PLC_ConnectableBlocks_TestCase methodsFor: 'unit-tests' stamp: 'EricPernia 4/7/2015 02:41'!testConncetableBlockRemoveInputPins	"Test a ConnectableBlock instance add / remove input and outputs pins"	| connBlock1 inputPin1 inputPin2 inputPin3 inputPin4 inputPin5 |	connBlock1 := PLC_ConnectableBlock new.			"Add input pins"	connBlock1 addInputPin.	connBlock1 addInputPin.	connBlock1 addInputPin.	connBlock1 addInputPin.	connBlock1 addInputPin.		inputPin1 := connBlock1 inputs at: 1.	inputPin2 := connBlock1 inputs at: 2.	inputPin3 := connBlock1 inputs at: 3.	inputPin4 := connBlock1 inputs at: 4.	inputPin5 := connBlock1 inputs at: 5.		self assert: connBlock1 inputs size equals: 5.		connBlock1 removeInputPinAt: 3.		self assert: connBlock1 inputs size equals: 4.		self assert: (connBlock1 inputs at: 3) equals: inputPin4.	self assert: (connBlock1 inputs at: 4) equals: inputPin5.! !!IDE4PLC_ConnectableBlocks_TestCase methodsFor: 'integration-tests' stamp: 'EricPernia 4/16/2015 17:03'!testInteractionsAutoconnect	"Testea una interaccin entre bloques conectables, pines y conexiones."	"En este caso testea que no se pueda conectar una salida de un bloque conectable a una de sus propias entradas. 	Es decir, que no se pueda conectar a si mismo."	| connBlock1      |	connBlock1 := PLC_ConnectableBlock new.				"Add output pin"		self assert: connBlock1 outputs size equals: 0.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 1.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 2.! !!IDE4PLC_ConnectableBlocks_TestCase methodsFor: 'integration-tests' stamp: 'EricPernia 4/16/2015 17:03'!testInteractionsMultipleInputConnections	"Testea una interaccin entre bloques conectables, pines y conexiones."	"En este caso testea que no se pueda conectar una salida de un bloque 	conectable a ms de una entrada de otro bloque conectable."	| connBlock1      |	connBlock1 := PLC_ConnectableBlock new.				"Add output pin"		self assert: connBlock1 outputs size equals: 0.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 1.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 2.! !!IDE4PLC_ConnectableBlocks_TestCase methodsFor: 'integration-tests' stamp: 'EricPernia 4/16/2015 17:03'!testInteractionsMultipleOutputConnections	"Testea una interaccin entre bloques conectables, pines y conexiones."	"En este caso testea que no se puedan conectar diferentes salidas provenientes de 	uno o varios boques conectables a un mismo pin de entrada de otro bloque conectable."	| connBlock1      |	connBlock1 := PLC_ConnectableBlock new.				"Add output pin"		self assert: connBlock1 outputs size equals: 0.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 1.		connBlock1 addOutputPin.	self assert: connBlock1 outputs size equals: 2.! !!PLC_DesktopIconMorph class methodsFor: 'instance creation' stamp: 'EricPernia 9/15/2015 16:34'!clearIcons	"Desreferencia todos los Iconos, no los borra"		self deleteIcons.! !!PLC_DesktopIconMorph class methodsFor: 'instance creation' stamp: 'EricPernia 3/20/2016 19:46'!createIcons	"Crea todos los Iconos"		device := self deviceIcon.	pou := self pouIcon.	"project := self projectIcon."	"library := self libraryIcon."	! !!PLC_DesktopIconMorph class methodsFor: 'instance creation' stamp: 'EricPernia 3/20/2016 20:08'!deleteIcons 	"Borra los Morphs y los desreferencia"	device ifNotNil: [device delete].	device := nil.		pou ifNotNil: [pou delete].	pou := nil.		library ifNotNil: [library delete].	library := nil.		project ifNotNil: [project delete].	project := nil.! !!PLC_DesktopIconMorph class methodsFor: 'instance creation' stamp: 'EricPernia 2/15/2016 00:07'!desktopIconsPath	"Devuelve el path de imagenes"	^ 'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , '/GUI_Images/DesktopIcons/'! !!PLC_DesktopIconMorph class methodsFor: 'class variables' stamp: 'EricPernia 3/20/2016 19:47'!device 	device ifNil: [		device := self deviceIcon.		].		^ device ! !!PLC_DesktopIconMorph class methodsFor: 'instance creation' stamp: 'EricPernia 3/20/2016 19:46'!deviceIcon	"Devuelve un nuevo DesktopIcon de Device"		| icon |			icon := PLC_DesktopIconMorph new.	icon imagePath: PLC_DesktopIconMorph desktopIconsPath , 'Device.png'.	icon imagePathHover: PLC_DesktopIconMorph desktopIconsPath , 'Device_hover_' , Theme , '.png'.	icon mouseOut.	icon position: InitialPosition.	"ACA LE PASO A AQUIEN LE DICE OPEN"	icon objetive: IDE4PLC.	icon action: #openDeviceEditor.				^ icon.	! !!PLC_DesktopIconMorph class methodsFor: 'class variables' stamp: 'EricPernia 4/27/2015 01:05'!library 	library ifNil: [		library := self libraryIcon.		].		^ library ! !!PLC_DesktopIconMorph class methodsFor: 'instance creation' stamp: 'EricPernia 2/15/2016 01:25'!libraryIcon	"Devuelve un nuevo DesktopIcon de Biblioteca de POUs"		| icon |			icon := PLC_DesktopIconMorph new.	icon imagePath: PLC_DesktopIconMorph desktopIconsPath , 'POULibrary.png'.	icon imagePathHover: PLC_DesktopIconMorph desktopIconsPath , 'POULibrary_hover_' , Theme , '.png'.	icon mouseOut.	icon position: InitialPosition + (260@0). 	"ACA LE PASO A AQUIEN LE DICE OPEN -  	Con open IDE4PLC resetea la declaracion de programa. 	Esto es un parche horrible."	icon objetive: IDE4PLC.	icon action: #openPOUEditor.				^ icon.! !!PLC_DesktopIconMorph class methodsFor: 'class variables' stamp: 'EricPernia 4/27/2015 01:04'!pou	pou ifNil: [		pou := self pouIcon.		].		^ pou! !!PLC_DesktopIconMorph class methodsFor: 'instance creation' stamp: 'EricPernia 2/15/2016 01:24'!pouIcon	"Devuelve un nuevo DesktopIcon de Crear POU"		| icon |			icon := PLC_DesktopIconMorph new.	icon imagePath: PLC_DesktopIconMorph desktopIconsPath , 'POU.png'.	icon imagePathHover: PLC_DesktopIconMorph desktopIconsPath , 'POU_hover_' , Theme , '.png'.	icon mouseOut.	icon position: InitialPosition + (130@0). 	"ACA LE PASO A AQUIEN LE DICE OPEN"	icon objetive: IDE4PLC.	icon action: #openPOUEditor.				^ icon.! !!PLC_DesktopIconMorph class methodsFor: 'class variables' stamp: 'EricPernia 4/27/2015 01:02'!project 	project ifNil: [		project := self projectIcon.		].		^ project ! !!PLC_DesktopIconMorph class methodsFor: 'instance creation' stamp: 'EricPernia 5/3/2015 08:34'!projectIcon	"Devuelve un nuevo DesktopIcon de Proyecto"		| icon |			icon := PLC_ProIconMorph new.	icon imagePath: PLC_DesktopIconMorph desktopIconsPath , 'Project.png'.	icon imagePathHover: PLC_DesktopIconMorph desktopIconsPath , 'Project_hover_' , Theme , '.png'.	icon mouseOut.	icon position: InitialPosition.		^ icon.	! !!PLC_DesktopIconMorph class methodsFor: 'class variables' stamp: 'EricPernia 4/27/2015 00:27'!screen1920x1080	"Indica la posicion de los iconos cuando la pantalla es de 1920x1080 px"		InitialPosition := 20@20. ! !!PLC_DesktopIconMorph class methodsFor: 'class variables' stamp: 'EricPernia 4/27/2015 00:27'!screen800x600	"Indica la posicion de los iconos cuando la pantalla es de 800 x600 px"		InitialPosition := 83@200. ! !!PLC_DesktopIconMorph methodsFor: 'initialize-release' stamp: 'EricPernia 4/28/2015 16:01'!desktopIconsPath	"Devuelve el path de imagenes"	^ self class desktopIconsPath! !!PLC_ImageButtonMorph class methodsFor: 'class variables' stamp: 'EricPernia 5/31/2013 02:16'!blackTheme	"Cambia el Tema a tema negro"		Theme := 'black'.! !!PLC_ImageButtonMorph class methodsFor: 'class variables' stamp: 'EricPernia 5/31/2013 02:16'!blueTheme	"Cambia el Tema a tema azul"		Theme := 'blue'.! !!PLC_ImageButtonMorph class methodsFor: 'instance creation' stamp: 'EricPernia 2/15/2016 01:49'!closeButtonWithObjetive: anObject	"Devuelve un nuevo DesktopIcon de Crear POU"		^ PLC_ImageButtonMorph 		newWithImage: 'close14.png' 		andImageHover: 'close14_hover.png'		andObjetive: anObject  		andAction: #close.! !!PLC_ImageButtonMorph class methodsFor: 'instance creation' stamp: 'EricPernia 3/20/2016 00:07'!imageButtonsPath	"Devuelve el path de imagenes"	^ 'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , '/GUI_Images/EditorPOU/Buttons/'! !!PLC_ImageButtonMorph class methodsFor: 'instance creation' stamp: 'EricPernia 4/28/2015 16:00'!newWithImage: aString andImageHover: aString2 andObjetive: anObject  andAction: aSymbol	"Devuelve un nuevo DesktopIcon de Crear POU"		^ PLC_ImageButtonMorph 		newWithImagePath: self imageButtonsPath , aString 		andImagePathHover: self imageButtonsPath , aString2 		andObjetive: anObject  		andAction: aSymbol.! !!PLC_ImageButtonMorph class methodsFor: 'instance creation' stamp: 'EricPernia 4/29/2015 02:37'!newWithImagePath: aString andImagePathHover: aString2 andObjetive: anObject  andAction: aSymbol	"Devuelve un nuevo DesktopIcon de Crear POU"		| imageButton |			imageButton := PLC_ImageButtonMorph new.		imageButton imagePath: aString.	imageButton imagePathHover: aString2.	imageButton objetive: anObject.		imageButton action: aSymbol.		imageButton mouseOut.		^ imageButton.! !!PLC_ImageButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:07'!action	^ action! !!PLC_ImageButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:07'!action: anObject	action := anObject! !!PLC_ImageButtonMorph methodsFor: 'mouse events' stamp: 'EricPernia 5/17/2015 19:37'!doAction			self objetive ifNotNil: ["		Transcript show: self objetive asString , ' ' , self action asString , ''."		self objetive perform: self action.	]! !!PLC_ImageButtonMorph methodsFor: 'event handling'!handlesMouseDown: anEvent	"Permite manejar el evento de cuando el usuatio clickea el mouse sobre el morph."	^ true.! !!PLC_ImageButtonMorph methodsFor: 'event handling'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^true.! !!PLC_ImageButtonMorph methodsFor: 'initialize-release' stamp: 'EricPernia 4/28/2015 15:59'!imageButtonsPath	"Devuelve el path de imagenes"	^ self class imageButtonsPath! !!PLC_ImageButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:07'!imagePath	^ imagePath! !!PLC_ImageButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:07'!imagePath: anObject	imagePath := anObject! !!PLC_ImageButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:07'!imagePathHover	^ imagePathHover! !!PLC_ImageButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:07'!imagePathHover: anObject	imagePathHover := anObject! !!PLC_ImageButtonMorph methodsFor: 'initialize-release' stamp: 'EricPernia 2/15/2016 01:54'!initialize	"Inicializacin del cono"	super initialize.		self imagePath: self imageButtonsPath , 'defaut.png'.	self imagePathHover: self imageButtonsPath , 'defaut.png'.			self image: ( Form fromFileNamed: self imagePath ).		self openInWorld.! !!PLC_ImageButtonMorph methodsFor: 'mouse events' stamp: 'EricPernia 5/17/2015 19:37'!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			self doAction! !!PLC_ImageButtonMorph methodsFor: 'mouse events'!leftDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."! !!PLC_ImageButtonMorph methodsFor: 'mouse events'!leftDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!PLC_ImageButtonMorph methodsFor: 'event handling'!mouseDown: anEvent	"Manejador del evento mouse down"	"Do nothing upon mouse-down except inform the hand to watch for a double-click; wait until an 	ensuing click:, doubleClick:, or drag: message gets dispatched"	"Note that mouseMove: and mouseUp: events are not sent to aMorph until it becomes the mouse focus,	which is typically done by aMorph in its click:, doubleClick:, or drag: methods."		anEvent redButtonPressed "click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#leftClick:. #leftDoubleClick:. #leftDoubleClickTimeout:. #startDrag:.}				threshold: 5.								].				anEvent yellowButtonPressed "action-click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#rightClick:. #rightDoubleClick:. #rightDoubleClickTimeout:. nil.}				threshold: 5.			].! !!PLC_ImageButtonMorph methodsFor: 'event handling'!mouseEnter: anEvent	"Manejador del evento mouse enter. Este mensaje se le envia al 	morph cuando el puntero del mouse empieza a pasar por el."	self mouseOver.! !!PLC_ImageButtonMorph methodsFor: 'event handling'!mouseLeave: anEvent	"Manejador del evento mouse leave. Este mensaje se le envia al 	morph cuando el puntero del mouse deja de pasarpor el."	self mouseOut.! !!PLC_ImageButtonMorph methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:51'!mouseOut	"Cuando el mouse est fuera del cono cambia su imagen"	self image: ( Form fromFileNamed: self imagePath ).! !!PLC_ImageButtonMorph methodsFor: 'mouse events' stamp: 'EricPernia 4/27/2015 00:49'!mouseOver	"Cuando el mouse est sobre el cono cambia su imagen"	self image: ( Form fromFileNamed: self imagePathHover ).! !!PLC_ImageButtonMorph methodsFor: 'event handling'!mouseUp: anEvent	"Manejador del evento mouse up"		! !!PLC_ImageButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:15'!objetive		^ objetive! !!PLC_ImageButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:15'!objetive: anObject		objetive := anObject! !!PLC_ImageButtonMorph methodsFor: 'mouse events'!rightClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."! !!PLC_ImageButtonMorph methodsFor: 'mouse events'!rightDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."	! !!PLC_ImageButtonMorph methodsFor: 'mouse events'!rightDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!PLC_ImageButtonMorph methodsFor: 'mouse events'!startDrag: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(startDrag) sent when the mouse moves more than threshold pixels from evt's position within DoubleClickTime."			anEvent hand grabMorph: self! !!PLC_ImageOpenSuicideMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 11/19/2013 16:56'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^false.! !!PLC_ImageOpenSuicideMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 4/27/2015 00:55'!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			| editorConfigSoft |			editorConfigSoft := PLC_ImageSuicideMorph new.	editorConfigSoft imagePath: 'IDE4PLC_files/GUI_Images/dummy/configSW.png'.	editorConfigSoft mouseOut.	editorConfigSoft position: 10@10.			self delete.! !!PLC_ImageSuicideMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 11/19/2013 16:56'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^false.! !!PLC_ImageSuicideMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 11/19/2013 16:51'!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			self delete! !!PLC_ProIconMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 4/27/2015 00:55'!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			| editorConfigHard |			editorConfigHard := PLC_ImageOpenSuicideMorph new.	editorConfigHard imagePath: 'IDE4PLC_files/GUI_Images/dummy/configHW.png'.	editorConfigHard mouseOut.	editorConfigHard position: 10@10.! !!PLC_ToolbarButtonMorph methodsFor: 'initialize - release' stamp: 'EricPernia 4/26/2015 15:59'!initialize	"Inicializacin del cono"	super initialize.		self imagePath: self desktopIconsPath , 'Project.png'.	self imagePathHover: self desktopIconsPath , 'Project_hover_blue.png'.			self image: ( Form fromFileNamed: self imagePath ).		self openInWorld.! !!BloqueMorph class methodsFor: 'instance creation' stamp: 'EricPernia 8/10/2015 03:12'!newConBloque: unBloque	|bloqueMorph|		bloqueMorph := self new.	bloqueMorph bloque: unBloque.	bloqueMorph modelo: unBloque modelo.	bloqueMorph modelo agregarBloque: unBloque.	bloqueMorph modelo morphs add: bloqueMorph.		bloqueMorph construir.	bloqueMorph openInWorld.		^bloqueMorph.	! !!BloqueMorph class methodsFor: 'instance creation' stamp: 'EricPernia 8/10/2015 02:13'!newConBloque: unBloque yModelo: unModelo	|bloqueMorph|		bloqueMorph := self new.	bloqueMorph bloque: unBloque.	bloqueMorph modelo: unModelo.	bloqueMorph modelo agregarBloque: unBloque.	bloqueMorph modelo morphs add: bloqueMorph.		bloqueMorph construir.	bloqueMorph openInWorld.		^bloqueMorph.	! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 15:04'!agregarPinEntrada		self pinesEntrada add: (PinEntradaMorph newConBloqueMorph: self).	self addMorph: (self pinesEntrada last).	! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 15:07'!agregarPinSalida 		self pinesSalida add: (PinSalidaMorph newConBloqueMorph: self).	self addMorph: (self pinesSalida last).! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 06:32'!alturaChip		self mayorCantidadPines > 3 		ifTrue: [^(self mayorCantidadPines + 1) * 10 + 1] 		ifFalse: [^41]. ! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 07:27'!alturaPinEntrada	^self pinesEntrada first extent y.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 07:27'!alturaPinSalida	^self pinesSalida first extent y.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 07:02'!anchoChip		^self extent x.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 06:34'!anchoPin	^self pinesEntrada first extent x.! !!BloqueMorph methodsFor: 'accessing' stamp: 'EricPernia 12/3/2010 04:02'!bloque	^ bloque! !!BloqueMorph methodsFor: 'accessing' stamp: 'EricPernia 12/3/2010 04:02'!bloque: anObject	bloque := anObject! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 4/24/2012 04:25'!cambiarNombreDeBloque: unNombreDeBloque	self bloque nombre: unNombreDeBloque asString.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 05:18'!cantidadPinesEntrada	^self pinesEntrada size.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 05:18'!cantidadPinesSalida	^self pinesSalida size.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/5/2010 16:37'!construir	self construirPines.	self construirChip.	self construirNombre.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 8/8/2015 07:22'!construirChip.	self extent: 51 @ (self alturaChip); position: 300@300; color: Color white.		self posicionarPines.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/7/2010 12:24'!construirNombre.	campoNombre := PluggableTextMorph		on: self		text: #nombreBloque		accept: #cambiarNombreDeBloque:.			campoNombre extent: 80@20;		position: (self position + (0 @ self alturaChip) + (0@10));		borderWidth: 1;		hasUnacceptedEdits: true;		acceptOnCR: true;		setNameTo: #edicionNombre.			self addMorph: campoNombre.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/3/2010 17:50'!construirPines	self construirPinesEntrada.	self construirPinesSalida.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 06:30'!construirPinesEntrada.	self bloque conexionesDeEntrada size timesRepeat: [self agregarPinEntrada].! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 06:30'!construirPinesSalida 	self bloque salidas size timesRepeat: [self agregarPinSalida].! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 06:46'!distanciaEntrePinesEntrada	^(self extent y / (self cantidadPinesEntrada + 1)) asInteger.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 06:47'!distanciaEntrePinesSalida	^(self extent y / (self cantidadPinesSalida + 1)) asInteger.! !!BloqueMorph methodsFor: 'initialization' stamp: 'EricPernia 12/3/2010 17:41'!initialize	super initialize.		self pinesEntrada: OrderedCollection new.	self pinesSalida: OrderedCollection new.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 05:17'!mayorCantidadPines	self cantidadPinesEntrada > self cantidadPinesSalida 		ifTrue: [^self cantidadPinesEntrada] 		ifFalse: [^self cantidadPinesSalida]. ! !!BloqueMorph methodsFor: 'accessing' stamp: 'EricPernia 12/3/2010 04:02'!modelo	^ modelo! !!BloqueMorph methodsFor: 'accessing' stamp: 'EricPernia 12/3/2010 04:02'!modelo: anObject	modelo := anObject! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/5/2010 16:39'!nombreBloque		^ self bloque nombre.! !!BloqueMorph methodsFor: 'accessing' stamp: 'EricPernia 12/3/2010 17:37'!pinesEntrada	^ pinesEntrada! !!BloqueMorph methodsFor: 'accessing' stamp: 'EricPernia 12/3/2010 17:37'!pinesEntrada: anObject	pinesEntrada := anObject! !!BloqueMorph methodsFor: 'accessing' stamp: 'EricPernia 12/3/2010 17:37'!pinesSalida	^ pinesSalida! !!BloqueMorph methodsFor: 'accessing' stamp: 'EricPernia 12/3/2010 17:37'!pinesSalida: anObject	pinesSalida := anObject! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 07:28'!posicionInicialPinesEntrada	^self position - (self anchoPin @ (self alturaPinEntrada / 2) asInteger).! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 07:28'!posicionInicialPinesSalida	^self position + (self anchoChip @ (self alturaPinSalida / 2) asInteger negated ).! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 05:26'!posicionarPines	self posicionarPinesEntrada.	self posicionarPinesSalida.! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 07:19'!posicionarPinesEntrada	self cantidadPinesEntrada > 0 		ifTrue: [(1 to: self cantidadPinesEntrada) 			do: 	[:i | (self pinesEntrada at: i) position: self posicionInicialPinesEntrada + (0 @ (self distanciaEntrePinesEntrada * i))]		].! !!BloqueMorph methodsFor: 'building' stamp: 'EricPernia 12/4/2010 07:26'!posicionarPinesSalida 	self cantidadPinesSalida > 0		ifTrue: [(1 to: self cantidadPinesSalida) 			do: [:i | (self pinesSalida at: i) position: self posicionInicialPinesSalida + (0 @ (self distanciaEntrePinesSalida * i))]		].! !!BloqueMorph methodsFor: 'change reporting' stamp: 'EricPernia 12/19/2010 06:05'!position: aPoint	super position: aPoint.	self changed: aPoint.	"self color = Color white ifTrue: [self color: Color red] ifFalse: [self color: Color white]." "Para ver si manda el changed."	"self changed: (#valor)."! !!BloqueOsciloscopio methodsFor: 'initialize-release' stamp: 'EricPernia 12/7/2010 19:08'!agregarPinSalida ! !!BloqueOsciloscopio methodsFor: 'initialize-release' stamp: 'EricPernia 8/10/2015 02:12'!initialize	|prop|	super initialize.	self color: Color red.		prop := Propiedades newConBloqueMorph: self.	prop construir.	self addMorph: prop.	! !!BMCMDPManejoDelClickYBloques class methodsFor: 'instance creation' stamp: 'EricPernia 12/19/2010 06:20'!newConBloqueMorph: unBloqueMorph	| pin |		pin:= self new.		pin 		extent: 7@5; 		color: Color black;		borderWidth: 0;		bloqueMorph: unBloqueMorph.			^pin.! !!BMCMDPManejoDelClickYBloques methodsFor: 'accessing' stamp: 'EricPernia 12/19/2010 06:21'!bloqueMorph	^ bloqueMorph! !!BMCMDPManejoDelClickYBloques methodsFor: 'accessing' stamp: 'EricPernia 12/19/2010 06:21'!bloqueMorph: anObject	bloqueMorph := anObject! !!BMCMDPManejoDelClickYBloques methodsFor: 'event handling' stamp: 'EricPernia 12/19/2010 06:19'!click: evt	super click: evt.! !!BMCMDPManejoDelClickYBloques methodsFor: 'event handling' stamp: 'EricPernia 12/19/2010 06:19'!handlesMouseDown: evt	^ true! !!BMCMDPManejoDelClickYBloques methodsFor: 'event handling' stamp: 'EricPernia 12/19/2010 06:19'!mouseDown: evt	"Do nothing upon mouse-down except inform the hand to watch for a double-click; 	wait until an ensuing click:, doubleClick:, or drag: message gets dispatched"	evt hand waitForClicksOrDrag: self event: evt! !!PinEntradaMorph methodsFor: 'event handling' stamp: 'EricPernia 12/8/2010 07:51'!click: evt	SalidaActiva unico clickeoPinEntradaMorph: self.! !!PinSalidaMorph methodsFor: 'event handling' stamp: 'EricPernia 12/8/2010 07:46'!apagar	SalidaActiva unico pinSalidaMorph: nil.	self color: Color black.! !!PinSalidaMorph methodsFor: 'event handling' stamp: 'EricPernia 12/8/2010 08:00'!apagarOtroPinEncendido	SalidaActiva unico apagarPinSiTiene.	! !!PinSalidaMorph methodsFor: 'event handling' stamp: 'EricPernia 8/8/2015 07:25'!click: evt	self color = Color black 		ifTrue: [			self apagarOtroPinEncendido. 			SalidaActiva unico pinSalidaMorph isNil 				ifTrue: [] 				ifFalse: [SalidaActiva unico pinSalidaMorph apagar].			self encender.			]		ifFalse: [self apagar]. ! !!PinSalidaMorph methodsFor: 'event handling' stamp: 'EricPernia 12/8/2010 07:56'!encender	SalidaActiva unico pinSalidaMorph: self.	self color: Color red.! !!Propiedades methodsFor: 'event handling' stamp: 'EricPernia 8/12/2015 01:01'!click: evt	(self modelo simulate) 		ifTrue:  [ 			self graficoMorph vincularCon: self bloqueMorph modelo salida: self bloqueMorph bloque.			self graficoMorph changed. 			self graficoMorph position: 20@20.			self graficoMorph openInWorld.		].			! !!Propiedades methodsFor: 'initialize-release' stamp: 'EricPernia 8/12/2015 01:05'!construir	self extent: 30@20; 		color: Color black;		borderWidth: 1;		position: self position + (10@10).		! !!Propiedades methodsFor: 'accessing' stamp: 'EricPernia 8/12/2015 01:05'!graficoMorph	^ GraficoMorph unico.! !!Propiedades methodsFor: 'accessing' stamp: 'EricPernia 8/10/2015 02:15'!modelo	^ self owner modelo! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:55'!centro	"Es el valor del centro relativo a sef position, es decir, el origen que se mide hacia derecha y hacia abajo tantos pixeles desde self position"	^self position + self centroRelativo.  ! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:55'!centroRelativo	"Es el valor del centro relativo a sef position, es decir, el origen que se mide hacia derecha y hacia abajo tantos pixeles desde self position"	^(self extent /2) asIntegerPoint.  ! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:56'!este	"Devuelve la posicion este del grafico la cual es con respecto al origen el punto mas a la derecha del grafico."	^self position + (self extent x @ self centroRelativo y).! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:24'!noreste	"Devuelve la posicion este del grafico la cual es con respecto al origen el punto mas a la derecha del grafico."	^self position + (self extent x @ 0).! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:25'!noroeste	"Devuelve la posicion este del grafico la cual es con respecto al origen el punto mas a la derecha del grafico."	^self position.! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:56'!norte	"Devuelve la posicion norte del grafico la cual es con respecto al origen el punto mas hacia arriba del grafico."	^self position + (self centroRelativo x @ 0).! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:56'!oeste	"Devuelve la posicion oeste del grafico la cual es con respecto al origen el punto mas a la izquierda del grafico."	^self position + (0 @ self centroRelativo y).! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:26'!sudeste	"Devuelve la posicion este del grafico la cual es con respecto al origen el punto mas a la derecha del grafico."	^self position + self extent! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 15:26'!sudoeste	"Devuelve la posicion este del grafico la cual es con respecto al origen el punto mas a la derecha del grafico."	^self position + (0 @ self extent y).! !!BorderedMorphConMetodosDePosiciones methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 16:06'!sur	"Devuelve la posicion sur del grafico la cual es con respecto al origen el punto mas hacia abajo del grafico."	^self position + (self centroRelativo x @ self extent y).! !!GraficoMorph class methodsFor: 'instance creation' stamp: 'EricPernia 12/10/2010 17:33'!borrarInstanciaUnica	Instancia:= nil.! !!GraficoMorph class methodsFor: 'instance creation' stamp: 'EricPernia 12/7/2010 17:29'!unico	Instancia isNil ifTrue: [ Instancia:= self new].	^Instancia.! !!GraficoMorph methodsFor: 'drawing' stamp: 'EricPernia 12/4/2010 00:51'!altoFuncion	(self yMax - self yMin) abs = 0 		ifTrue: [^(self yMax) abs * 3] 		ifFalse: [^(self yMax - self yMin) abs + 0.1]. 	! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/2/2010 00:05'!bloqueSalida	^ bloqueSalida! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/2/2010 00:05'!bloqueSalida: anObject	bloqueSalida := anObject! !!GraficoMorph methodsFor: 'event handling' stamp: 'EricPernia 8/9/2015 20:24'!click: evt	self delete.! !!GraficoMorph methodsFor: 'drawing' stamp: 'EricPernia 12/3/2010 03:27'!construir	self extent: 751@551.	self position: 20@20.	self color: Color black."self extent: ((self tamanioHorizontal)@(self tamanioVertical))."! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/1/2010 05:35'!divisionesEjeX	^ divisionesEjeX! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/1/2010 05:35'!divisionesEjeX: anObject	divisionesEjeX := anObject! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/1/2010 05:35'!divisionesEjeY	^ divisionesEjeY! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/1/2010 05:35'!divisionesEjeY: anObject	divisionesEjeY := anObject! !!GraficoMorph methodsFor: 'drawing' stamp: 'EricPernia 12/3/2010 21:07'!drawOn: aCanvas	"Me dibujo cosas"	super drawOn: aCanvas.	"dibujo los ejes"	aCanvas line: (self oeste) to: (self este)  color: (Color white). 	"Eje X"	aCanvas line: (self norte) to: (self sur)  color: (Color white).		"Eje Y"		"dibujo graduaciones"	(1 to: self divisionesEjeX) do: [ :i | 		aCanvas line: 			(self gradEjeXPBInicial + (self incrGradEjeX: i) ) to: (self gradEjeXPTInicial  + (self incrGradEjeX: i) )  			color: (Color white).]. 	"Graduaciones en X"	(1 to: self divisionesEjeY) do: [ :i | 		aCanvas line: 			(self gradEjeYPLInicial + (self incrGradEjeY: i) ) to: (self gradEjeYPRInicial  + (self incrGradEjeY: i) )  			color: (Color white).]. 	"Graduaciones en Y"								"Dibujo el grafico		Se multiplican los valores de X e Y por sus respectivos factores de escala segun tamao de grafico."		"Interpolacion lineal"		(1 to: self vectorTiempos size -1) do: [ :i | aCanvas line: 			( self oeste + ( ((i-1)* self factorDeEscalaX) @((self valorEn: i)* self factorDeEscalaY)) asIntegerPoint) 			to: ( self oeste + (((i)* self factorDeEscalaX) @((self valorEn: (i+1))* self factorDeEscalaY)) asIntegerPoint)  			color: (Color yellow)].	"Puntos"		"(1 to: self vectorTiempos size) do: [ :i | aCanvas point: 			( self oeste + ( ((i-1)* self factorDeEscalaX) @((self valorEn: i)* self factorDeEscalaY)) asIntegerPoint) 			color: (Color yellow)]."! !!GraficoMorph methodsFor: 'drawing' stamp: 'EricPernia 12/1/2010 19:17'!factorDeEscalaX	^self extent x / (self vectorTiempos size) abs 	! !!GraficoMorph methodsFor: 'drawing' stamp: 'EricPernia 12/3/2010 20:16'!factorDeEscalaY	^ self extent y / self altoFuncion 	! !!GraficoMorph methodsFor: 'dibujarEjesYGrilla' stamp: 'EricPernia 12/1/2010 06:26'!gradEjeXPBInicial	"Devuelve la posicion inicial Inferior (bottom) de la linea de la grilla de x"	^ self oeste - (0@4).! !!GraficoMorph methodsFor: 'dibujarEjesYGrilla' stamp: 'EricPernia 12/1/2010 06:20'!gradEjeXPTInicial	"Devuelve la posicion inicial Superior (Top) de la linea de la grilla de x"	^ self oeste + (0@4).! !!GraficoMorph methodsFor: 'dibujarEjesYGrilla' stamp: 'EricPernia 12/1/2010 06:35'!gradEjeYPLInicial	"Devuelve la posicion inicial izquierda (Left) de la linea de la grilla de Y"	^ self norte - (4@0).! !!GraficoMorph methodsFor: 'dibujarEjesYGrilla' stamp: 'EricPernia 12/1/2010 06:31'!gradEjeYPRInicial	"Devuelve la posicion inicial derecha (Right) de la linea de la grilla de Y"	^ self norte + (4@0).! !!GraficoMorph methodsFor: 'event handling' stamp: 'EricPernia 8/9/2015 20:26'!handlesMouseDown: evt	^ true! !!GraficoMorph methodsFor: 'dibujarEjesYGrilla' stamp: 'EricPernia 12/1/2010 23:37'!incrGradEjeX: unNumero	"Devuelve el incremento desde gradEjeX que debe ir haciendo para hallar los proximos puntos de la grilla"		^ (self tamanioDeGrilla * unNumero) asIntegerPoint x @ 0.! !!GraficoMorph methodsFor: 'dibujarEjesYGrilla' stamp: 'EricPernia 12/1/2010 23:43'!incrGradEjeY: unNumero	"Devuelve el incremento desde gradEjeY que debe ir haciendo para hallar los proximos puntos de la grilla"				^ 0 @ ((self tamanioDeGrilla * unNumero) asIntegerPoint  y).! !!GraficoMorph methodsFor: 'initialization' stamp: 'EricPernia 12/3/2010 03:26'!initialize	super initialize.	vectorTiempos:= (0 to: 0).	vectorResultados := OrderedCollection new.	vectorResultados add: 0.	self divisionesEjeX: 10.	self divisionesEjeY: 10.		self construir.	"self openInWorld."! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/2/2010 00:05'!modelo	^ modelo! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/2/2010 00:05'!modelo: anObject	modelo := anObject! !!GraficoMorph methodsFor: 'event handling' stamp: 'EricPernia 8/9/2015 20:26'!mouseDown: evt	"Do nothing upon mouse-down except inform the hand to watch for a double-click; 	wait until an ensuing click:, doubleClick:, or drag: message gets dispatched"	evt hand waitForClicksOrDrag: self event: evt! !!GraficoMorph methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 14:17'!origen	^self position + self origenRelativo. ! !!GraficoMorph methodsFor: 'posicionesEnGrafico' stamp: 'EricPernia 12/7/2010 16:10'!origenRelativo	"Es el valor del origen relativo a sef position, es decir, el origen que se mide hacia derecha y hacia abajo tantos pixeles desde self position"	^self centroRelativo. ! !!GraficoMorph methodsFor: 'dibujarEjesYGrilla' stamp: 'EricPernia 12/1/2010 05:39'!tamanioDeGrilla	"Devuelve el tectangulo mas chico de grilla que lo calcula con los numeros de divisiones por ejes que tiene almacenados"	^ (self extent x / (self divisionesEjeX ) @ (self extent y / (self divisionesEjeY )) ) asIntegerPoint.! !!GraficoMorph methodsFor: 'updating' stamp: 'EricPernia 12/1/2010 01:49'!update: unAspecto	"me avisan que un dependiente (el modelo o el bloque de salida) cambio su estado"	self changed.! !!GraficoMorph methodsFor: 'drawing' stamp: 'EricPernia 12/2/2010 01:23'!valorEn: i	"Devuelve f(t) del vectorResultados en la posicion que le pido"		^(self vectorResultados at: i) negated.	"(self vectorTiempos indexOf: t)"! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/1/2010 02:03'!vectorResultados	^ vectorResultados! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/1/2010 02:03'!vectorResultados: anObject	vectorResultados := anObject! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/1/2010 02:03'!vectorTiempos	^ vectorTiempos! !!GraficoMorph methodsFor: 'accessing' stamp: 'EricPernia 12/1/2010 02:03'!vectorTiempos: anObject	vectorTiempos := anObject! !!GraficoMorph methodsFor: 'initialization' stamp: 'EricPernia 12/2/2010 01:12'!vincularCon: unModelo salida: unBloqueDeSalida	self modelo: unModelo.	self vectorTiempos: unModelo tiempo.		self bloqueSalida: unBloqueDeSalida. 	self vectorResultados: unBloqueDeSalida salidasEnElTiempo.		self changed.! !!GraficoMorph methodsFor: 'drawing' stamp: 'EricPernia 12/1/2010 07:21'!yMax	^self vectorResultados asSortedCollection last.! !!GraficoMorph methodsFor: 'drawing' stamp: 'EricPernia 12/1/2010 07:21'!yMin	^self vectorResultados asSortedCollection first.! !!PLC_EditableGrid class methodsFor: 'initialize-release' stamp: 'EricPernia 11/18/2013 01:33'!newWithRows: ro	"Nuevo con ciertas filas, que adentro tienen columnas"	| grid |		grid := self new.	grid rows: ro.		"Regresco la vista"	grid refresh.				^ grid.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/17/2013 20:54'!cellExtentCategory	"El tamao de Celda de la columna Categoria"	^ 108@23! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 4/23/2015 05:08'!cellExtentDescription	"El tamao de Celda de la columna Descripcion"	^ 294@23! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 4/23/2015 05:08'!cellExtentInitialValue	"El tamao de Celda de la columna Valor Inicial"	^ 100@23	! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 4/23/2015 05:12'!cellExtentName	"El tamao de Celda de la columna Name"	^ 150@23	! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 4/23/2015 05:10'!cellExtentType	"El tamao de Celda de la columna Tipo de Datos"	^ 80@23	! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/18/2013 03:00'!colNumberFor: aMorph	"Devuelve numero de columna donde este ubicado el morph"	self morphRows do: [ :col |		(col includes: aMorph)			ifTrue: [				^ col indexOf: aMorph				 ].		].		^ 1.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/18/2013 02:37'!colPositions	"Es una OC con las posiciones de columnas"	| colExt |	colExt := OrderedCollection new.		colExt add: 0.			colExt add: 		self cellExtentCategory x + 1.			colExt add: 		self cellExtentCategory x 		+ self cellExtentName x + 2.			colExt add: 		self cellExtentCategory x 		+ self cellExtentName x		+ self cellExtentType x + 3.			colExt add: 		self cellExtentCategory x 		+ self cellExtentName x		+ self cellExtentType x 		+ self cellExtentInitialValue x +4.	^ colExt.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/17/2013 22:35'!colSize	"Devuelve la cantidad de columnas"	^ self rows first size.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/17/2013 21:11'!colWidths	"Es una OC con los anchos de columnas"	| colExt |	colExt := OrderedCollection new.		colExt add: self cellExtentCategory x.	colExt add: self cellExtentName x.	colExt add: self cellExtentType x.	colExt add: self cellExtentInitialValue x.	colExt add: self cellExtentDescription x.	^ colExt.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 5/2/2015 07:27'!createRowsMorphs	"Fila de titulos. Es una OC con los titulos de izquierda a derecha"	| cellMorph morphCol |		morphRows := OrderedCollection new.			morphCol := OrderedCollection new.			( 1 to: self rowSize ) do: [ :rowIndex |				( 1 to: self colSize ) do: [ :colIndex |						cellMorph := PLC_CellMorph 				newWithText: ( self nameAt: rowIndex at: colIndex ) 				andContainer: self.						cellMorph extent: ( self colWidths at: colIndex ) @ self rowHeight.			cellMorph color: PLC_GraphicElementProperties uniqueInstance rowColorHeader.			cellMorph centerAlign.			cellMorph position: ( self position x + 2 + self colPositions at: colIndex ) 					@ ( self position y + 2 + ( self rowHeight * (rowIndex ) ) + rowIndex ).					cellMorph changed.					cellMorph extentChanged.								morphCol add: cellMorph.						"Lo agrego de submorph"			self addMorph: cellMorph.			"Lo agrego al diccionario elementos"			self elements at: cellMorph put: ( self nameAt: rowIndex at: colIndex ).				"Lo agrego a la lista de seleccionados y le doy el foco del teclado"			self selectedAndKeyboardFocus: cellMorph.										].					morphRows add: morphCol.			morphCol := OrderedCollection new.						].	self extent: ( self extent x @ 		(rows size + 4 + (rows size + 1 * self rowHeight) ) 		).! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/18/2013 02:50'!createTitleRowMorphs	"Fila de titulos. Es una OC con los titulos de izquierda a derecha"	| titleMorph |		( 1 to: self titleRowNames size ) do: [ :index |		index.				titleMorph := PLC_TitleMorph new.		titleMorph extent: ( self colWidths at: index ) @ self rowHeight ;			backgroundColor: PLC_GraphicElementProperties uniqueInstance rowColorHeader;			backgroundBorderWidth: 1;			leftMargin: 0;			emphasis: 0;			text: ( self titleRowNames  at: index );			centerAlign;			changed;			position: ( self position x + self colPositions at: index ) @ self position y + 2.			"Lo agrego de submorph"		self addMorph: titleMorph.		"Lo agrego al diccionario elementos"		self elements at: titleMorph put: ( self titleRowNames  at: index ).			"Lo agrego a la lista de seleccionados y le doy el foco del teclado"		self selectedAndKeyboardFocus: titleMorph.				].! !!PLC_EditableGrid methodsFor: 'events - keyboard' stamp: 'EricPernia 5/3/2015 07:18'!handleKeystroke: anEvent	"Manejador del evento de teclado."		"anEvent hand newKeyboardFocus: self. " "Le doy al morph el foco del teclado."	"anEvent hand newKeyboardFocus: nil." "Le saco al morph el foco del teclado."	"anEvent shiftPressed ifTrue: [Transcript show:  keyValue.] ." "Detecta si la tecla Shift esta presionada durante el evento"	"anEvent commandKeyPressed ifTrue: [ self color: Color blue.] ." "Detecta si la tecla Control esta presionada durante el evento"	| keyValue |		"Si editable vale ture puede manejar eventos del teclado"	(self editable) ifTrue: [		keyValue := anEvent keyValue."			Transcript show: anEvent asString , ' ' , keyValue asString  , ''."		keyValue = 127 "delete"			ifTrue: [ self keyDeletePressed. ].		keyValue = 30 "up arrow"			ifTrue: [self keyUpPressed. ].				keyValue = 31 "down arrow"			ifTrue: [self keyDownPressed. ].			keyValue = 29 "right arrow"			ifTrue: [self keyRightPressed. ].		keyValue = 28 "left arrow"			ifTrue: [self keyLeftPressed. ].				].	! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 05:15'!identifier		^ identifier! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 05:15'!identifier: anObject		identifier := anObject! !!PLC_EditableGrid methodsFor: 'initialize-release' stamp: 'EricPernia 5/2/2015 07:24'!initialize	"comment stating purpose of message"	super initialize. "Siempre hay que hacerlo en una subclase de MORPH"		rows := OrderedCollection new.	selectedIndex := 1.			"Cambio el tamo de la grilla"	self extent: 740@195.	"Cambio el color de la grilla"	self color: PLC_GraphicElementProperties uniqueInstance rowColorSelected.	"Cambio la posicin de la grilla"	self position: 0@0.	! !!PLC_EditableGrid methodsFor: 'loop' stamp: 'EricPernia 2/17/2016 02:23'!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			| submorphUnderCursor rowNumber |				anEvent hand newKeyboardFocus: self. "Le doy al Network Morph el foco del teclado."	self gotKeyboardFocus.	submorphUnderCursor := self submorphUnderCursor: anEvent.		"self lostKeyboardFocus."	submorphUnderCursor		ifNil: [			self unselectAll.	 "Pasa todos a la lista de deseleccionados y actualiza los estados de los elementos graficos."								]				ifNotNil: [			self unselectAll.	 "Pasa todos a la lista de deseleccionados y actualiza los estados de los elementos graficos."						"si selecciono la cabecera rowNumber = 0"			rowNumber := self rowNumberFor: submorphUnderCursor.			"Transcript show: rowNumber asString.Transcript show: ''."						"Si rowNumber = 0 tengo seleccionado el titulo"			(rowNumber > 0) 				ifTrue: [										self selectedAndKeyboardFocus: submorphUnderCursor.						(self morphsAt: rowNumber) do: [ :each |						self addSelectedAndKeyboardFocus: each. 						].							self selectedIndex: rowNumber.									]							ifFalse: [					self selectedIndex: 0.					].						].				"Esto es para que se ponga la seleccion en gris si la grilla no es editable"		self editable ifFalse: [ self lostKeyboardFocus ].		self changed.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/18/2013 02:00'!morphAt: rowNumber at: colNumber	"Devuelve el morph de la celda ubicada en la fila: rowNumber columna: colNumber"	^ ( self morphRows at: rowNumber ) at: colNumber.! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 01:59'!morphRows		^ morphRows! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 01:59'!morphRows: anObject		morphRows := anObject! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 5/17/2015 18:37'!morphsAt: rowNumber	"Devuelve una coleccion de morphs de la fila: rowNumber"	( self morphRows size > 0 )		ifTrue: [ 			( rowNumber <= self morphRows size )				ifTrue: [ 					^ self morphRows at: rowNumber.					].		].		^ nil.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/17/2013 22:32'!nameAt: rowNumber at: colNumber	"Devuelve el texto que va en la celda ubicada en la fila: rowNumber columna: colNumber"	^ ( self rows at: rowNumber ) at: colNumber.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/18/2013 03:01'!positionNumberFor: aMorph	"Devuelve numero de fila y columna donde este ubicado el morph"	^ (self rowNumberFor: aMorph) @ (self colNumberFor: aMorph)! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 20:49'!pouDeclarations		^ pouDeclarations! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 20:49'!pouDeclarations: anObject		pouDeclarations := anObject! !!PLC_EditableGrid methodsFor: 'loop' stamp: 'EricPernia 2/17/2016 02:23'!refresh	"Regresco la vista"			super refresh.		"Elimino sus OC de celdas morphs"	self morphRows: nil.		"Creo las celdas editables Morphs"	self createTitleRowMorphs.	self createRowsMorphs.			( self morphRows size > 0 )		ifTrue: [			self selectedIndex: self morphRows size.							"Selecciono la ultima fila que haba sido seleccionada"			self unselectAll.			self selectedAndKeyboardFocus: (self morphsAt: selectedIndex) first. 			(self morphsAt: selectedIndex) do: [ :each |				self addSelectedAndKeyboardFocus: each 				].				].! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 4/27/2015 19:30'!rowHeight	"Devuelve el alto de las filas"	^ 18.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 5/17/2015 16:23'!rowNumberFor: aMorph	"Devuelve numero de fila donde este ubicado el morph"	self morphRows do: [ :col |		(col includes: aMorph)			ifTrue: [				^ self morphRows indexOf: col				 ].		].	"Si selecciono la cabecera devuelve 0"	^ 0.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 11/17/2013 22:36'!rowSize	"Devuelve la cantidad de filas"	^ self rows size.! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 20:46'!rows		^ rows! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 20:46'!rows: anObject		rows := anObject! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 20:46'!selectedIndex		^ selectedIndex! !!PLC_EditableGrid methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 20:46'!selectedIndex: anObject		selectedIndex := anObject! !!PLC_EditableGrid methodsFor: 'loop' stamp: 'EricPernia 11/18/2013 06:29'!textChangedIn: aPLC_CellMorph by: aString	"Cambi el texto del morph aPLC_EditaleTagMorph por el del string aString"		"Le cambia el texto. No hace falta refrescar toda la grilla"	"aPLC_CellMorph text: aString."		"	Transcript show: (self positionNumberFor: aPLC_CellMorph) asString , ''."		"Le envio un punto (fila@columna) y el texto al controlador para que modifique el modelo"	self editor 		textChangedInView: (self positionNumberFor: aPLC_CellMorph) 		by: aString.! !!PLC_EditableGrid methodsFor: 'cell' stamp: 'EricPernia 2/17/2016 02:23'!titleRowNames	"Fila de titulos. Es una OC con los titulos de izquierda a derecha"	| titlesRowOC |	titlesRowOC := OrderedCollection new.		titlesRowOC add: 'Editable Grid -> Category' translated.	titlesRowOC add: 'Editable Grid -> Name' translated.	titlesRowOC add: 'Editable Grid -> Datatype' translated.	titlesRowOC add: 'Editable Grid -> Initial value' translated.	titlesRowOC add: 'Editable Grid -> Description' translated.	^ titlesRowOC.! !!PLC_GraphicProgramView methodsFor: 'model accessing' stamp: 'EricPernia 8/4/2013 02:41'!blockConnectedToInput: anInputNumber for: aGraphicElement	"Devuelve el elemento morph del bloque conectable conectado	a la entrada anInputNumber del elemento morph aGraphicElement."	| connectableBlock |	connectableBlock := ( self modelElementForGraphicElement: aGraphicElement ) blockConnectedToInput: anInputNumber.		^ self graphicElementForModelElement: connectableBlock.! !!PLC_GraphicProgramView methodsFor: 'model accessing' stamp: 'EricPernia 8/4/2013 02:41'!blockConnectedToOutput: anOutputNumber for: aGraphicElement	"Devuelve el elemento morph del bloque conectable conectado	a la salida anOutputNumber del elemento morph aGraphicElement."	| connectableBlock |	connectableBlock := ( self modelElementForGraphicElement: aGraphicElement ) blockConnectedToOutput: anOutputNumber.		^ self graphicElementForModelElement: connectableBlock.! !!PLC_GraphicProgramView methodsFor: 'model accessing' stamp: 'EricPernia 8/4/2013 02:41'!connectedAtInput: aNumber for: aGraphicElement	"Devuelve el elemento morph del bloque conectable o conexin conectado	a la entrada aNumber del elemento morph aGraphicElement."	| connectableBlock |	connectableBlock := ( self modelElementForGraphicElement: aGraphicElement ) connectedAtInput: aNumber.		^ self graphicElementForModelElement: connectableBlock.	! !!PLC_GraphicProgramView methodsFor: 'model accessing' stamp: 'EricPernia 8/4/2013 02:41'!connectedAtOutput: aNumber for: aGraphicElement	"Devuelve el elemento morph del bloque conectable o conexin conectado	a la salida aNumber del elemento morph aGraphicElement."	| connectableBlock |	connectableBlock := ( self modelElementForGraphicElement: aGraphicElement) connectedAtOutput: aNumber.		^ self graphicElementForModelElement: connectableBlock.! !!PLC_GraphicProgramView methodsFor: 'compilation' stamp: 'CarlosLombardi 11/19/2016 18:42'!generateCode	"METODO PROVISORIO. Se lo enva el editor ladder. Sirve para mostrar en un Transcript el programa compilado."		| progAcc |		"Creo el acumulador de objetos de programa."	progAcc := PLC_ProgramAccumulator_POU new.		"Le envio la peticin al controlador de que se compile en el programa de objetos"	self controller generateCodeIn: progAcc.		"Abro un Transcript y muestro las 2 compilaciones"	Transcript open ; clear.		Transcript show: '	Programa en IL:	------------------------' , progAcc compilerDataTypesDecls ilCompile ,'' ,  progAcc compilerVarDecls ilCompile ,'' , progAcc compiledBody ilCompile ,''.			Transcript show: '	Programa en C:	------------------------' , progAcc compilerDataTypesDecls cCompile ,'' ,  progAcc compilerVarDecls cCompile ,'' , progAcc compiledBody cCompile ,''.	! !!PLC_GraphicProgramView methodsFor: 'model accessing' stamp: 'EricPernia 8/4/2013 02:41'!modelElementForGraphicElement: aGraphicElement	"Devuelve el bloque conectable o conexion correspondiente al elemento grafico."	^ self elements at: aGraphicElement! !!PLC_GraphicProgramView methodsFor: 'commands send to self' stamp: 'EricPernia 5/2/2015 00:43'!textChangedIn: actualArgumentMorph by: aString	"Cambia el alactual argument del elemento del modelo de actualArgumentMorph por el string aString"		| connectableBlock |			"Busco el bloque conectable del actualArgumentMorph"	connectableBlock := self modelElementForGraphicElement: actualArgumentMorph.		"Le doy la orden al controller para que cambie el actual argument"	self controller changeActualArgumentFor: connectableBlock by: aString	! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 5/1/2013 20:42'!addCoilOnKeyboardFocusElement	"Agrega una Bobina sobre el elemento que tenga el foco del teclado."		| aConnectableBlockOrConnection |		"Busco el Bloque Conectable o conexion del elemento con el Foco del Teclado."	aConnectableBlockOrConnection := self elements at: self keyboardFocusElement.		self ladderController addCoilOn: aConnectableBlockOrConnection.	! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 4/3/2016 05:57'!addFunctionBlockOnKeyboardFocusElement	"Agrega un Bloque Funcin sobre el elemento que tenga el foco del teclado."		| funBlkList |		"Obtengo el controlador de la lista de funciones de la biblioteca"	funBlkList := PLC_Libraries uniqueInstance functionBlockList.		"Le seteo al list que el resultado me lo mande a mi (self = ladderView)"	funBlkList target: self.		"Le seteo al list que mensaje me tiene que mandar a mi con el resultado como parametro"	funBlkList targetMessage: #addFunctionBlockOnKeyboardFocusElement:.			"Le mando al controlador de la lista de funciones contenido en su	 biblioteca que muestre su vista de Lista de Funciones"	"funBlkList openAt: self positionInWorld + ( 288 @ 26 negated )."	funBlkList openAt: self owner position + ( 288 @ 26 negated ).! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 11/17/2013 06:03'!addFunctionBlockOnKeyboardFocusElement: aFunctionBlock	"Agrega el Bloque de Funcin Elegido aFunctionBlock sobre el elemento que tenga el foco del teclado.		addFunctionBlockOnKeyboardFocusElement"		| aConnectableBlockOrConnection |		"Busco el Bloque Conectable o conexion del elemento con el Foco del Teclado."	aConnectableBlockOrConnection := self elements at: self keyboardFocusElement.			self ladderController 		addFunctionBlockCallWithDeclaration: aFunctionBlock		on: 	aConnectableBlockOrConnection.! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 4/3/2016 05:56'!addFunctionOnKeyboardFocusElement	"Agrega una Funcin sobre el elemento que tenga el foco del teclado."		| funList |		"Obtengo el controlador de la lista de funciones"	funList := PLC_Libraries uniqueInstance functionList.		"Le seteo al list que el resultado me lo mande a mi (self = ladderView)"	funList target: self.		"Le seteo al list que mensaje me tiene que mandar a mi con el resultado como parametro"	funList targetMessage: #addFunctionOnKeyboardFocusElement:.			"Le mando al controlador de la lista de funciones contenido en su	 biblioteca que muestre su vista de Lista de Funciones"	"funList openAt: self positionInWorld + ( 98 @ 26 negated )."		funList openAt: self owner position + ( 98 @ 26 negated ).! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 11/17/2013 05:33'!addFunctionOnKeyboardFocusElement: aFunction	"Agrega la Funcin Elegida aFunction sobre el elemento que tenga el foco del teclado.		addFunctionBlockOnKeyboardFocusElement"		| aConnectableBlockOrConnection |		"Busco el Bloque Conectable o conexion del elemento con el Foco del Teclado."	aConnectableBlockOrConnection := self elements at: self keyboardFocusElement.			self ladderController 		addFunctionCallWithDeclaration: aFunction		on: 	aConnectableBlockOrConnection.! !!PLC_LadderView methodsFor: 'as yet unclassified' stamp: 'EricPernia 4/3/2016 05:58'!addLadderComponentOnKeyboardFocusElement	"Agrega un Componente Ladder sobre el elemento que tenga el foco del teclado."		| ladderComponentList |		"Obtengo el controlador de la lista de funciones de la biblioteca"	ladderComponentList := PLC_Libraries uniqueInstance ladderElementList.		"Le seteo al list que el resultado me lo mande a mi (self = ladderView)"	ladderComponentList target: self.		"Le seteo al list que mensaje me tiene que mandar a mi con el resultado como parametro"	ladderComponentList targetMessage: #addLadderComponentOnKeyboardFocusElement:.			"Le mando al controlador de la lista de funciones contenido en su	 biblioteca que muestre su vista de Lista de Funciones"	"ladderComponentList openAt: self positionInWorld + ( 50 @ 26 negated )."	ladderComponentList openAt: self owner position + ( 50 @ 26 negated ). ! !!PLC_LadderView methodsFor: 'as yet unclassified' stamp: 'EricPernia 5/3/2015 06:46'!addLadderComponentOnKeyboardFocusElement: aComponent	"Agrega el componente Ladder Elegido aComponent 	sobre el elemento que tenga el foco del teclado."		| aConnectableBlockOrConnection |		"Busco el Bloque Conectable o conexion del elemento con el Foco del Teclado."	aConnectableBlockOrConnection := self elements at: self keyboardFocusElement.			self ladderController 		addLadderComponent: aComponent 		on: 	aConnectableBlockOrConnection.! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 5/1/2013 20:42'!addNCContactOnKeyboardFocusElement	"Agrega un Contacto normal cerrado sobre el elemento que tenga el foco del teclado."		| aConnectableBlockOrConnection |		"Busco el Bloque Conectable o conexion del elemento con el Foco del Teclado."	aConnectableBlockOrConnection := self elements at: self keyboardFocusElement.		self ladderController addNCContactOn: aConnectableBlockOrConnection.! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 5/1/2013 20:42'!addNCoilOnKeyboardFocusElement	"Agrega una Bobina Negada sobre el elemento que tenga el foco del teclado."		| aConnectableBlockOrConnection |		"Busco el Bloque Conectable o conexion del elemento con el Foco del Teclado."	aConnectableBlockOrConnection := self elements at: self keyboardFocusElement.		self ladderController addNCoilOn: aConnectableBlockOrConnection.! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 5/1/2013 20:13'!addNOContactOnKeyboardFocusElement	"Agrega un Contacto normal abierto sobre el elemento que tenga el foco del teclado."		| aConnectableBlockOrConnection |		"Busco el Bloque Conectable o conexion del elemento con el Foco del Teclado."	aConnectableBlockOrConnection := self elements at: self keyboardFocusElement.		self ladderController addNOContactOn: aConnectableBlockOrConnection.! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 7/17/2013 01:53'!closeBranchOnSelectedElements	"Cierra una rama entre una conexion o bloque y otra conexion si se puede."		| aPLC_ConnectableBlockOrConnection aPLC_Connection |		aPLC_ConnectableBlockOrConnection := self selectedElements first.	aPLC_ConnectableBlockOrConnection := self modelElementForGraphicElement: aPLC_ConnectableBlockOrConnection.		aPLC_Connection := self selectedElements last.	aPLC_Connection := self modelElementForGraphicElement: aPLC_Connection.		self ladderController closeBranchFrom: aPLC_ConnectableBlockOrConnection to: aPLC_Connection.! !!PLC_LadderView methodsFor: 'model accessing' stamp: 'EricPernia 11/5/2013 13:24'!connectableBlocksNetwork	"Devuelve la connectableBlocksNetwork de su controlador."	^ self controller ladderNetwork ! !!PLC_LadderView methodsFor: 'draw elements' stamp: 'EricPernia 7/4/2013 02:47'!drawElementFromBlock: connectableBlock	"Dibujo el elemento grafico de connectableBlock."	| graphicElement |		"Chequeo si ya lo dibuje, si es as no lo vuelvo a dibujar."	( self wasDrawn: connectableBlock ) 		ifTrue: [			^ nil.			] 		ifFalse: [			"Creo el elemento grafico."			graphicElement := connectableBlock graphicElement.				"Lo agrego de submorph"			self addMorph: graphicElement.				"Lo agrego al diccionario elementos"			self elements at: graphicElement put: connectableBlock.						"Le pido al elemento que aguregue sus morphs dependientes al ladderView si tiene.			Estos pueden ser Actual Arguments o Pines"			graphicElement addDependentsOnLadderView: self from: connectableBlock.						"Dibujo todas sus salidas"			self drawOutputsForElement: graphicElement.						"Lo agrego a la lista de seleccionados y le doy el foco del teclado"			self selectedAndKeyboardFocus: graphicElement.						^ graphicElement.			].! !!PLC_LadderView methodsFor: 'draw elements' stamp: 'EricPernia 11/5/2013 13:19'!drawElements	"Dibuja todos los elementos explorando el modelo. Los agrego al diccionario elements."		| connectableBlock |		"Busco en el modelo el Riel Izquierdo en el modelo"	connectableBlock := self ladderNetwork leftPowerRailBlock.		"Comienzo a dibujar todo el modelo comenzando por el LeftPowerRail.	Cuando termina de dibujar el elemento dibuja todos los elementos conectados a sus salidas.	En consecuencia, dibuja todos los elementos del modelo."	self drawElementFromBlock: connectableBlock.! !!PLC_LadderView methodsFor: 'drawing' stamp: 'EricPernia 10/9/2013 14:00'!drawGridOn: aCanvas	"Dibujo la grilla."	(0 to: self gridSize y - 1) do: [ :vIndex |		(0 to: self gridSize x - 1) do: [ :hIndex |			aCanvas frameRectangle: ( self gridRectangleIn: (hIndex @ vIndex) )  width: 1 colors: {Color lightGray} dashes: {1}.			].		].! !!PLC_LadderView methodsFor: 'drawing groups' stamp: 'EricPernia 7/9/2013 02:00'!drawGroups	"Dibuja los grupos de elementos con la misma posicin vertical (ciam) del ladderView"		| morph |	self groups do: [ :group |				"Dibujo el rectangulo del grupo"		morph := BorderedMorph new.		morph color: ( Color lightBlue alpha: 0.5 ).		morph borderColor: Color blue.		morph extent: group layoutRectangle extent.		morph position: group layoutRectangle topLeft.				"Aado este rectangulo como submorph"		self addMorph: morph.				].! !!PLC_LadderView methodsFor: 'draw elements' stamp: 'EricPernia 11/5/2013 13:19'!drawHorizontalLinks	"Dibuja todos los Horizontal Links del modelo. Los agrega al diccionario elements."		| leftPowerRailMorph |		"Busco en el modelo el Riel Izquierdo en el modelo"	leftPowerRailMorph := self graphicElementForModelElement: (self ladderNetwork leftPowerRailBlock).	"Comienzo a dibujar todos los horizontal links del modelo comenzando por las salidas del LeftPowerRail.	Cuando termina de dibujar le pide que dibuje a todos los elementos conectados a sus salidas.	En consecuencia, dibuja todos los horizontal links del modelo."	leftPowerRailMorph drawHorizontalLinksFrom: self.! !!PLC_LadderView methodsFor: 'draw elements' stamp: 'EricPernia 7/17/2013 01:57'!drawHorizontalLinksFrom: connectableBlock	"Dibuja todos los Horizontal Links a las salidas de connectableBlock. 	Los agrega al diccionario elements. Por ltimo le dice a los elementos	graficos conectados a sus salidas que dibujen sus horizontal links."	| graphicElement horizontalLink connection outputConnectableBlock |		graphicElement := self graphicElementForModelElement: connectableBlock.	"Si no tiene salidas no hace nada!!!!"	( 1 to: graphicElement outputPins size ) do: [ :ind |				"Creo el Horizontal Link corespondiente a la salida numero ind."		horizontalLink := PLC_HorizontalLinkMorph new.				"Lo agrego de submorph"		self addMorph: horizontalLink.				"Busco la conexion a la salida numero ind de connectableBlock"		connection := connectableBlock connectedAtOutput: ind.				"Busco el bloque conectable conectado a la salida numero ind"		outputConnectableBlock := connectableBlock blockConnectedToOutput: ind.			"Lo agrego al diccionario elementos"		self elements at: horizontalLink put: connection.					"Lo agrego a la lista de seleccionados y le doy el foco del teclado"		self selectedAndKeyboardFocus: horizontalLink.				"Posiciono el Horizontal Link"		horizontalLink centeredToTheRight: ( graphicElement outputPins at: ind ).				"Actualizo su tamao"		horizontalLink extentChanged.							"Dibujo los horizontal links de los elementos conectados a sus salidas"		self drawHorizontalLinksFrom: outputConnectableBlock.				].! !!PLC_LadderView methodsFor: 'drawing' stamp: 'EricPernia 10/9/2013 14:00'!drawOn: aCanvas	"Dibujo la grilla."	super drawOn: aCanvas.		self properties drawGrid ifTrue: [		self drawGridOn: aCanvas.		].! !!PLC_LadderView methodsFor: 'draw elements' stamp: 'EricPernia 8/6/2013 23:48'!drawOutputsForElement: aGraphicElement	"Dibujo todos los morphs conectados a las salidas de aGraphicElement"	| connectableBlock outputConnectableBlock |		"Obtengo el bloque conectable de aGraphicElement."	connectableBlock := self modelElementForGraphicElement: aGraphicElement.			"Si no tiene salidas no hace nada!!!!"	( 1 to: aGraphicElement outputPinsSize ) do: [ :ind |				"Busco el bloque conectable conectado a la salida numero ind"		outputConnectableBlock := connectableBlock blockConnectedToOutput: ind.				"Dibujo el elemento grafico del bloque hallado"		self drawElementFromBlock: outputConnectableBlock.		].! !!PLC_LadderView methodsFor: 'model exploration' stamp: 'EricPernia 11/5/2013 13:19'!exploreModel	"Explora el modelo"	| connectableBlockLPR graphicElementLPR |	"Inicializo las colecciones de los grupos de elementos del modelo."	self groups: OrderedCollection new.		"Busco en el modelo el Riel Izquierdo en el modelo"	connectableBlockLPR := self ladderNetwork leftPowerRailBlock.	"Obtengo el elemento grafico del bloque conectable"	graphicElementLPR := self graphicElementForModelElement: connectableBlockLPR.		"Comienzo a explorar todo el modelo comenzando por el LeftPowerRail."	graphicElementLPR exploreModel.					! !!PLC_LadderView methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 06:59'!gotAGroupHorizontallyUnderElement: aGraphicElementMorph	"Devuelve true si encuentra un Grupo cuyo layoutRectangle pise el layoutRectangle de aGraphicElementMorph.	Si no encuentra ninguno devuelve false."		( self maxRightGroupUnderElement: aGraphicElementMorph ) 		ifNil: [			^ false.			] 		ifNotNil: [			^ true.			].! !!PLC_LadderView methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 06:43'!gotAnElementVerticallyUnderGroup: aGroup	"Devuelve true si encuentra un Elemento cuyo layoutRectangle pise el layoutRectangle de aGroup.	Si no encuentra ninguno devuelve false."		( self maxBottomElementUnderGroup: aGroup ) 		ifNil: [			^ false.			] 		ifNotNil: [			^ true.			].! !!PLC_LadderView methodsFor: 'model exploration' stamp: 'EricPernia 7/17/2013 01:56'!graphicElementForModelElement: aModelElement	"Devuelve el elemento grafico correspondiente al bloque conectable o conexion."	^ self elements keyAtValue: aModelElement.! !!PLC_LadderView methodsFor: 'grid' stamp: 'EricPernia 10/9/2013 13:58'!gridExtent	"Devuelve el tamao en pixeles de una celda de la grilla gris."		^ self properties gridExtent.! !!PLC_LadderView methodsFor: 'grid' stamp: 'EricPernia 10/9/2013 13:58'!gridOrigin	"Devuelve la posicion 0@0 de la grilla"	^ self position + self properties gridOrigin.! !!PLC_LadderView methodsFor: 'grid' stamp: 'EricPernia 10/9/2013 13:58'!gridRectangleIn: aPoint	"Rectangulo del tamao de la grilla"		| rectangle |		rectangle := Rectangle origin: ( 0 @ 0 ) corner: self gridExtent.	^ rectangle translateBy: aPoint * self gridExtent + self gridOrigin.! !!PLC_LadderView methodsFor: 'grid' stamp: 'EricPernia 10/9/2013 13:58'!gridSize	"Devuelve el tamao de la grilla gris. Es decir, cuantos rectangulos por cuantos tiene la grilla"		^ ( 6 @ 10 ).! !!PLC_LadderView methodsFor: 'model exploration' stamp: 'EricPernia 7/9/2013 02:32'!groupFor: anElementOrGroup	"Devuelve el grupo que contiene al elemento o grupo anElementOrGroup."		^ self groups 		detect: [ :group |			group includes: anElementOrGroup.			]		ifNone: [ ^ nil ].! !!PLC_LadderView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:52'!groups		^ groups! !!PLC_LadderView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!groups: anObject		groups := anObject! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 4/22/2013 01:45'!keyBPressed	"Este mensaje se dispara cuando presionan la tecla B."	self addCoilOnKeyboardFocusElement.! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 5/1/2013 19:45'!keyCPressed	"Este mensaje se dispara cuando presionan la tecla C."		self addNOContactOnKeyboardFocusElement.	"	Transcript show: ' Key C pressed'."	! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 5/3/2015 05:30'!keyDPressed	"Este mensaje se dispara cuando presionan la tecla D."	self addLadderComponentOnKeyboardFocusElement.! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 6/29/2013 18:54'!keyFPressed	"Este mensaje se dispara cuando presionan la tecla F."		self addFunctionOnKeyboardFocusElement.	"	Transcript show: ' Key C pressed'."	! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 6/29/2013 18:54'!keyGPressed	"Este mensaje se dispara cuando presionan la tecla G."		self addFunctionBlockOnKeyboardFocusElement.	"	Transcript show: ' Key C pressed'."	! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 4/22/2013 01:45'!keyNPressed	"Este mensaje se dispara cuando presionan la tecla N."	self addNCoilOnKeyboardFocusElement.! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 5/1/2013 23:23'!keyOPressed	"Este mensaje se dispara cuando presionan la tecla O."		self openBranchOnKeyboardFocusElement.! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 5/1/2013 23:25'!keyPPressed	"Este mensaje se dispara cuando presionan la tecla P."		self closeBranchOnSelectedElements.! !!PLC_LadderView methodsFor: 'keyboard events' stamp: 'EricPernia 5/1/2013 19:47'!keyVPressed	"Este mensaje se dispara cuando presionan la tecla V."	self addNCContactOnKeyboardFocusElement.	"		Transcript show: ' Key V pressed'.	"! !!PLC_LadderView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:41'!ladderController	^ self controller! !!PLC_LadderView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!ladderController: anObject	self controller: anObject.! !!PLC_LadderView methodsFor: 'model accessing' stamp: 'EricPernia 11/5/2013 13:22'!ladderNetwork	"Devuelve la ladderNetwork de su controlador."	^ self controller ladderNetwork ! !!PLC_LadderView methodsFor: 'layout' stamp: 'EricPernia 11/5/2013 13:19'!layoutElements	"Dispone en pantalla todos los elementos dentro del ladderView"	| connectableBlockLPR graphicElementLPR |		"Busco en el modelo el Riel Izquierdo en el modelo"	connectableBlockLPR := self ladderNetwork leftPowerRailBlock.	"Obtengo el elemento grafico del bloque conectable"	graphicElementLPR := self graphicElementForModelElement: connectableBlockLPR.		"Comienzo a explorar todo el modelo comenzando por el LeftPowerRail."	graphicElementLPR layoutOn: self.	! !!PLC_LadderView methodsFor: 'layout' stamp: 'EricPernia 3/13/2016 20:21'!maxBottomElementUnderGroup: aGroup 	"Devuelve el elemento de mayor layoutRectangle bottom cuyo 	layoutRectangle pise al layoutRectangle de aGroup."		| elementsUnderGroup maxElement | 	"Selecciono los elementos que estn bajo aGroup"	elementsUnderGroup := OrderedCollection new.	self elements keys asOrderedCollection do: [ :each | 		( each layoutRectangle intersects: aGroup layoutRectangle )			ifTrue: [ elementsUnderGroup add: each. ].		].		"Extraigo de la coleccion los elementos pertenecientes al grupo.	Porque sino el grupo siempre pisa a los elementos que lo forman."	aGroup elements do: [ :each |		( elementsUnderGroup includes: each )			ifTrue: [ 				elementsUnderGroup remove:	each.						].		].		"Extraigo los elementos dependientes de los elementos del grupo."	aGroup elementsDependentsUnderGroupLayoutRectangle do: [ :each |		( elementsUnderGroup includes: each )			ifTrue: [ 				elementsUnderGroup remove:	each.						].		].		"Extraigo los elementos que no estn ya posicionados en X."	elementsUnderGroup removeAllSuchThat: [ :each |		( each xPositioned not )	].		"Extraigo los elementos que no estn ya posicionados en Y."	elementsUnderGroup removeAllSuchThat: [ :each |		( each yPositioned not )	].		"Busco el elemento cuyo layoutRectangle bottom sea maximo"	( elementsUnderGroup size > 0 )		ifTrue: [			maxElement := elementsUnderGroup first.			elementsUnderGroup do: [ :actualElem | 				( actualElem layoutRectangle bottom >= maxElement layoutRectangle bottom )					ifTrue: [ maxElement := actualElem. ]. 				].			]		ifFalse: [ 			^ nil.			].			^ maxElement.	! !!PLC_LadderView methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 07:11'!maxRightGroupUnderElement: aGraphicElementMorph	"Devuelve true si encuentra un Grupo cuyo layoutRectangle pise el layoutRectangle de aGraphicElementMorph.	Si no encuentra ninguno devuelve nil."		| groupsUnderElement group maxRightGroup | 		"Obtengo el grupo del elemento"	group := self groupFor: aGraphicElementMorph.				"Selecciono los grupos que estn bajo aGraphicElementMorph"	groupsUnderElement := OrderedCollection new.	self groups do: [ :each | 		( each layoutRectangle intersects: aGraphicElementMorph layoutRectangle )			ifTrue: [ groupsUnderElement add: each. ].		].	"Extraigo de la coleccion el grupo perteneciente a aGraphicElementMorph.	Porque sino el grupo siempre pisa a los elementos que lo forman."	groupsUnderElement 		remove: group 		ifAbsent: [ nil. ].		"Busco el grupo cuyo layoutRectangle right sea maximo"	( groupsUnderElement size > 0 )		ifTrue: [			maxRightGroup := groupsUnderElement first.			groupsUnderElement do: [ :actualElem | 				( actualElem layoutRectangle right >= maxRightGroup layoutRectangle right )					ifTrue: [ maxRightGroup := actualElem. ]. 				].			]		ifFalse: [ 			^ nil.			].	^ maxRightGroup.	! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 5/1/2013 23:18'!openBranchOnConnection: aGraphicConnection	"Abre una rama sobre una conexion (==)."		| aConnection |		"Busco la conexion del elemento con el Foco del Teclado."	aConnection := self elements at: self keyboardFocusElement.		self ladderController openBranchOnConnection: aConnection.	! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 5/1/2013 23:35'!openBranchOnKeyboardFocusElement	"Abre una rama sobre la conexion que tenga el foco del teclado."		| aConnectableBlockOrConnection |		"Busco la conexion del elemento con el Foco del Teclado."	aConnectableBlockOrConnection := self keyboardFocusElement.		"Evio la peticion al elemento grafico"	aConnectableBlockOrConnection openBranchOnConnectionFrom: self.! !!PLC_LadderView methodsFor: 'loop' stamp: 'EricPernia 8/4/2013 04:28'!refresh	"Refresca la vista la vista"	super refresh.		self drawElements; 							"Dibuja los elemetos en el origen y los agrega a sus colecciones"		exploreModel;								"Crea los grupos de elementos"		updateOutputsConnectonStates;			"Actualiza los estados de conexion de los elementos"		layoutElements;							"Dispone todos los elementos en pantalla"		drawHorizontalLinks;						"Dibuja todos los Horizontal Links"		extentChanged.							"Actualiza el tamao del ladderView"	"Restauro la lista de seleccionados y el Foco del teclado"	"self restoreUIContext." "ANDA MAL"							"Hago que sea visible"	"self visible: true."! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 7/17/2013 01:54'!removeCoil: aContact	"Remueve una Bobina."		| aConnectableBlock |		"Busco el Bloque Conectable del elemento grafico."	aConnectableBlock := self modelElementForGraphicElement: aContact.		"Le envio la peticon al controlador"	self ladderController removeCoil: aConnectableBlock.! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 7/31/2013 22:13'!removeContact: aContact	"Remueve un Contacto."		| aConnectableBlock |		"Busco el Bloque Conectable del elemento grafico."	aConnectableBlock := self modelElementForGraphicElement: aContact.		"Le envio la peticion al controlador"	self ladderController removeContact: aConnectableBlock.! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 7/31/2013 22:13'!removeFunctionCall: aFunctionCallGraphicElementMorph	"Remueve un llamado a Funcin."		| aConnectableBlock |		"Busco el Bloque Conectable del elemento grafico."	aConnectableBlock := self modelElementForGraphicElement: aFunctionCallGraphicElementMorph.		"Le envio la peticion al controlador"	self ladderController removeFunctionCall: aConnectableBlock.! !!PLC_LadderView methodsFor: 'commands send to controller' stamp: 'EricPernia 7/31/2013 22:13'!removeRightPowerRail: aRightPowerRail	"Remueve un Right Power Rail:."		| aConnectableBlock |		"Busco el Bloque Conectable del elemento grafico."	aConnectableBlock := self modelElementForGraphicElement: aRightPowerRail.		"Le envio la peticion al controlador"	self ladderController removeRightPowerRail: aConnectableBlock.! !!PLC_LadderView methodsFor: 'loop' stamp: 'EricPernia 7/17/2013 01:57'!restoreUIContext	"Restauro la lista de seleccionados y el Foco del teclado"			| selectedConnectableBlocks keyboardFocusConnectableBlock |	uiContext ifNotNil: [ 				"Paso todos los elementos a la lista de deseleccionados"		self unselectAll.		"Busco las la lista de bloques conectables seleccionados"		selectedConnectableBlocks := uiContext at: 1.			"Aado a la lista de seleccionados los elementos restantes"		selectedConnectableBlocks do: [ :each |			self addSelectedAndKeyboardFocus: ( self graphicElementForModelElement: each ).			].			"Busco el bloque conectable con foco del teclado"		keyboardFocusConnectableBlock := uiContext at: 2.				"Aado el elemento del foco del teclado"		self addSelectedAndKeyboardFocus: ( self graphicElementForModelElement: keyboardFocusConnectableBlock ).				].! !!PLC_LadderView methodsFor: 'loop' stamp: 'EricPernia 7/17/2013 01:54'!saveUIContext	"Guardo los bloques conectables de los elementos morph seleccionados 	y del elemento morph con foco del teclado, si existen."			| selectedConnectableBlocks keyboardFocusConnectableBlock |			( self selectedElements = nil and: [ self keyboardFocusElement = nil ] )		ifFalse: [ 					selectedConnectableBlocks := OrderedCollection new.						self selectedElements ifNotNil: [				self selectedElements do: [ :each |					selectedConnectableBlocks add: 					( self modelElementForGraphicElement: each ).					].				].			self keyboardFocusElement 				ifNotNil: [  					keyboardFocusConnectableBlock := 						( self modelElementForGraphicElement: self keyboardFocusElement ).					].							uiContext := {selectedConnectableBlocks. keyboardFocusConnectableBlock. }.					].			! !!PLC_LadderView methodsFor: 'connection states' stamp: 'EricPernia 11/5/2013 13:20'!updateOutputsConnectonStates	"Actualiza las capas de estado de conexion de todos los elementos dentro del ladderView"	| connectableBlockLPR graphicElementLPR |		"Busco en el modelo el Riel Izquierdo en el modelo"	connectableBlockLPR := self ladderNetwork leftPowerRailBlock.	"Obtengo el elemento grafico del bloque conectable"	graphicElementLPR := self graphicElementForModelElement: connectableBlockLPR.		"Comienzo a actualizar todos los estados de conexion de los elementos graficos 	comenzando por el LeftPowerRail."	graphicElementLPR updateOutputsConnectonStates.	! !!PLC_LadderView methodsFor: 'draw elements' stamp: 'EricPernia 3/29/2013 04:35'!wasDrawn: connectableBlock	"Responde true si el elemento ya fue dibujado antes. Para responder chequea en su diccionario elements."	^ self elements values includes: connectableBlock.	! !!PLC_LadderView methodsFor: 'model exploration' stamp: 'EricPernia 7/9/2013 00:54'!wasExplored: aGraphicElement.	"Responde true si el elemento ya fue explorado. Para verificarlo lo busca en sus grupos."	^ self groups anySatisfy: [ :group |		group includes: aGraphicElement.		 ].! !!PLC_GraphicView class methodsFor: 'instance creation' stamp: 'EricPernia 5/2/2015 01:00'!newWithController: aController	"Nuevo con un controlador de MVC"	| view |		"Creo la vista"	view := self new.		"Le asigno un controlador"	view controller: aController.		"Regresco la vista"	view refresh.			^ view.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 5/3/2015 07:29'!aboutToBeGrabbedBy: aHand 	"Este mensaje llega cuando est a punto de ser agarrado por el puntero del mouse (HandMorph)."		super aboutToBeGrabbedBy: aHand.	self stopStepping.	! !!PLC_GraphicView methodsFor: 'elements in screen directions' stamp: 'EricPernia 8/4/2013 02:34'!aboveMorphFor: aPLC_GraphicElementMorph	"Devuelve el Morph de arriba del morph pasado como parmetro"	| startPoint stopPoint result distance |		result := nil.		startPoint := aPLC_GraphicElementMorph topCenter.	stopPoint := startPoint x @  self top.		distance := startPoint y - stopPoint y.	"	Transcript show: startPoint asString , ' ' ,  stopPoint asString ,  ' ' , distance asString , '		'."		1 to: distance do: [ :index | | col |"		Transcript show: ( startPoint - ( 0 @ index ) ) asString , '		'."		col := (self submorphs select: [ :each | each containsPoint: startPoint - ( 0 @ index ) ])."		Transcript show: col."		col ifNotEmpty:	[ ^ col first].		].		result ifNil: [^ aPLC_GraphicElementMorph ].		! !!PLC_GraphicView methodsFor: 'commands send to self' stamp: 'EricPernia 8/4/2013 02:31'!addSelectedAndKeyboardFocus: aPLC_GraphicElementMorph	"Aade el elemento a la lista de seleccionados y le da el foco del teclado."		(self unselectedElements includes: aPLC_GraphicElementMorph)		ifTrue: [			self unselectedElements remove: aPLC_GraphicElementMorph.				].			(self selectedElements includes: aPLC_GraphicElementMorph)		ifFalse: [			self selectedElements add: aPLC_GraphicElementMorph.				].	self selectedElements do: [ :each |		each selected;			notKeyboardFocus.		].		self keyboardFocusElement: aPLC_GraphicElementMorph.	aPLC_GraphicElementMorph keyboardFocus.! !!PLC_GraphicView methodsFor: 'elements in screen directions' stamp: 'EricPernia 8/4/2013 02:34'!beneathMorphFor: aPLC_GraphicElementMorph	"Devuelve el Morph de abajo del morph pasado como parmetro"	| startPoint stopPoint result distance |		result := nil.		startPoint := aPLC_GraphicElementMorph bottomCenter.	stopPoint := startPoint x @  self bottom.		distance := stopPoint y - startPoint y.		"Transcript show: startPoint asString , ' ' ,  stopPoint asString ,  ' ' , distance asString , '		'."		1 to: distance do: [ :index | | col |"		Transcript show: ( startPoint + ( 0 @ index ) ) asString , '		'."		col := (self submorphs select: [ :each | each containsPoint: startPoint + ( 0 @ index ) ]).		"Transcript show: col."		col ifNotEmpty:	[ ^ col first].		].		result ifNil: [^ aPLC_GraphicElementMorph ].		! !!PLC_GraphicView methodsFor: 'extent' stamp: 'EricPernia 8/4/2013 02:35'!bottomOfGraphicElementBelowOfAll	"Devuelve el bottom del layoutRectangle del elemento mas abajo en pantalla dentro del ladderView"	^ self elements keys 		inject: 0		into: [:resParcial :elem | 			resParcial max: elem layoutRectangle bottom].! !!PLC_GraphicView methodsFor: 'commands send to controller' stamp: 'EricPernia 8/4/2013 02:31'!commandCopy	"Este mensaje se dispara cuando presionan las teclas Ctrl + C."			Transcript show: 'COPY'.	! !!PLC_GraphicView methodsFor: 'commands send to controller' stamp: 'EricPernia 8/4/2013 02:32'!commandPaste	"Este mensaje se dispara cuando presionan las teclas Ctrl + C."			Transcript show: 'PASTE'.	! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!controller		^ controller! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!controller: anObject		controller := anObject! !!PLC_GraphicView methodsFor: 'extent' stamp: 'EricPernia 8/4/2013 02:35'!defaultExtent	^ 10@10.! !!PLC_GraphicView methodsFor: 'submorphs' stamp: 'EricPernia 8/4/2013 02:36'!dragRectangle	"Devuelve un Rectangle de 288@168 alrededor de la posicion actual del puntero del mouse.	El cual es irtersecado con el rea de la network para que no se pase para los costados."	| center origin corner|		center := World activeHand cursorPoint.		origin := center - (144@84).	corner := center + (144@84).		^ (Rectangle origin: origin corner: corner) intersect: self bounds.	! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 5/3/2015 04:52'!editable		^ editable! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 5/3/2015 04:52'!editable: anObject		editable := anObject! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 01:27'!editor		^ editor! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 01:27'!editor: anObject		editor := anObject! !!PLC_GraphicView methodsFor: 'commands send to self' stamp: 'EricPernia 11/18/2013 04:49'!editorKeyBoradFocus	"Avisa a su owner que le dieron el foco del teclado."		self editor ifNotNil: [ 		"Le saco el foco del teclado a la network que lo tenia"		( self editor keyboardFocusMorph == self  )			ifFalse: [ 				self editor keyboardFocusMorph lostKeyboardFocus.				self selectedElements do: [ :each |					each draggingAnother.					].									 ].		"Le doy el foco del reclado a esta"		self editor keyboardFocusMorph: self.		].		! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!elements	^ elements! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!elements: anObject	elements := anObject! !!PLC_GraphicView methodsFor: 'extent' stamp: 'EricPernia 8/4/2013 02:35'!extentChanged	self extent: self totalExtent.! !!PLC_GraphicView methodsFor: 'commands send to self' stamp: 'EricPernia 11/18/2013 01:29'!gotKeyboardFocus	"Evento cuando el ladderView le dan el foco del teclado."		self borderColor: PLC_GraphicElementProperties uniqueInstance rowColorSelected.	self changed.	self selectedElements do: [ :each |		each selected.		].		self editorKeyBoradFocus.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 5/3/2015 05:41'!handleKeystroke: anEvent	"Manejador del evento de teclado."		"anEvent hand newKeyboardFocus: self. " "Le doy al morph el foco del teclado."	"anEvent hand newKeyboardFocus: nil." "Le saco al morph el foco del teclado."	"anEvent shiftPressed ifTrue: [Transcript show:  keyValue.] ." "Detecta si la tecla Shift esta presionada durante el evento"	"anEvent commandKeyPressed ifTrue: [ self color: Color blue.] ." "Detecta si la tecla Control esta presionada durante el evento"	| keyValue |		"Si editable vale ture puede manejar eventos del teclado"	(self editable) ifTrue: [		keyValue := anEvent keyValue."			Transcript show: anEvent asString , ' ' , keyValue asString  , ''."		keyValue = 127 "delete"			ifTrue: [ self keyDeletePressed. ].				( keyValue = 111 "o" or: [ keyValue = 79 "O" ] )			ifTrue: [ self keyOPressed. ].		( keyValue = 112 "p" or: [ keyValue = 80 "P" ] )			ifTrue: [ self keyPPressed. ].		( keyValue = 99 "c" or: [ keyValue = 67 "C" ] )			ifTrue: [ 				anEvent commandKeyPressed "Detecta la tecla control del teclado"					ifTrue: [self commandCopy] 					ifFalse: [self keyCPressed] 				]. 				( keyValue = 100 "d" or: [ keyValue = 68 "D" ] )			ifTrue: [self keyDPressed].				( keyValue = 118 "v" or: [ keyValue = 86 "V" ] )			ifTrue: [ 				anEvent commandKeyPressed 					ifTrue: [self commandPaste] 					ifFalse: [self keyVPressed] 				].  				( keyValue = 98 "b" or: [ keyValue = 66 "B" ] )			ifTrue: [ self keyBPressed. ].				( keyValue = 110 "n" or: [ keyValue = 78 "N" ] )			ifTrue: [ self keyNPressed. ].		keyValue = 30 "up arrow"			ifTrue: [self keyUpPressed. ].				keyValue = 31 "down arrow"			ifTrue: [self keyDownPressed. ].			keyValue = 29 "right arrow"			ifTrue: [self keyRightPressed. ].		keyValue = 28 "left arrow"			ifTrue: [self keyLeftPressed. ].				].	! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 5/3/2015 05:05'!handlesMouseDown: anEvent	"Permite manejar el evento de cuando el usuatio clickea el mouse sobre el morph."	^ true.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!handlesMouseOver: anEvent	"Permite manejar el evento de cuando el usuatio pasa el puntero del  mouse sobre el morph."	^ true.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 5/3/2015 07:28'!handlesMouseOverDragging: anEvent	"Permite manejar el evento de cuando el usuatio clickea el mouse sobre el morph."	^ true.! !!PLC_GraphicView methodsFor: 'initialize-release' stamp: 'EricPernia 5/3/2015 04:54'!initialize	"comment stating purpose of message"	super initialize. "Siempre hay que hacerlo en una subclase de MORPH"		"Cambio el tamao y color"	self extent: self defaultExtent.	self color: Color white.	self borderColor: Color white.	self borderWidth: 2.			self editable: true.				"Abro"	self openInWorld.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!justDroppedInto: aMorph event: anEvent	"Recien soltado dentro de aMorph"		self stopStepping.! !!PLC_GraphicView methodsFor: 'keyboard events' stamp: 'EricPernia 8/4/2013 02:44'!keyDeletePressed	"Este mensaje se dispara cuando presionan la tecla Suprimir."	self removeSelectedElements.! !!PLC_GraphicView methodsFor: 'keyboard events' stamp: 'EricPernia 8/4/2013 02:44'!keyDownPressed	"Este mensaje se dispara cuando presionan la tecla Down Arrow."			| newKeyboardFocusElement |		newKeyboardFocusElement := self beneathMorphFor: self keyboardFocusElement.		self unselectAll.	self selectedAndKeyboardFocus: newKeyboardFocusElement.		"self networkMorph position: self networkMorph position + (0 @ 1)."	! !!PLC_GraphicView methodsFor: 'keyboard events' stamp: 'EricPernia 8/4/2013 02:44'!keyLeftPressed	"Este mensaje se dispara cuando presionan la tecla Left Arrow."		| newKeyboardFocusElement |		newKeyboardFocusElement := self leftMorphFor: self keyboardFocusElement.		self unselectAll.	self selectedAndKeyboardFocus: newKeyboardFocusElement.		"networkMorph position: self networkMorph position - (1 @ 0)."! !!PLC_GraphicView methodsFor: 'keyboard events' stamp: 'EricPernia 8/4/2013 02:44'!keyRightPressed	"Este mensaje se dispara cuando presionan la tecla Right Arrow."		| newKeyboardFocusElement |		newKeyboardFocusElement := self rightMorphFor: self keyboardFocusElement.		self unselectAll.	self selectedAndKeyboardFocus: newKeyboardFocusElement.		"self networkMorph position: self networkMorph position + (1 @ 0)."	! !!PLC_GraphicView methodsFor: 'keyboard events' stamp: 'EricPernia 8/4/2013 02:44'!keyUpPressed	"Este mensaje se dispara cuando presionan la tecla Up Arrow."		| newKeyboardFocusElement |		newKeyboardFocusElement := self aboveMorphFor: self keyboardFocusElement.		self unselectAll.	self selectedAndKeyboardFocus: newKeyboardFocusElement.		"self networkMorph position: self networkMorph position - (0 @ 1)."	! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!keyboardFocusElement	^ keyboardFocusElement! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!keyboardFocusElement: anObject	keyboardFocusElement := anObject! !!PLC_GraphicView methodsFor: 'mouse events' stamp: 'EricPernia 11/18/2013 00:04'!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			| submorphUnderCursor |				anEvent hand newKeyboardFocus: self. "Le doy al Network Morph el foco del teclado."	self gotKeyboardFocus.	submorphUnderCursor := self submorphUnderCursor: anEvent.		"self lostKeyboardFocus."	submorphUnderCursor		ifNil: [			anEvent shiftPressed 				ifTrue: [					]				ifFalse: [					self unselectAll.	 "Pasa todos a la lista de deseleccionados y actualiza los estados de los elementos graficos."										].							] 		ifNotNil: [			anEvent shiftPressed 				ifTrue: [					self addSelectedAndKeyboardFocus: submorphUnderCursor.					]				ifFalse: [					self unselectAll.	 "Pasa todos a la lista de deseleccionados y actualiza los estados de los elementos graficos."					self selectedAndKeyboardFocus: submorphUnderCursor.										].					]. 			self changed.! !!PLC_GraphicView methodsFor: 'mouse events' stamp: 'EricPernia 5/3/2015 05:05'!leftDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."	| submorphUnderCursor |			"Evito editar la grilla"	self editable ifFalse: [ ^ nil. ].					anEvent hand newKeyboardFocus: self. "Le doy al Network Morph el foco del teclado."	self gotKeyboardFocus.		submorphUnderCursor := self submorphUnderCursor: anEvent.		self keyboardFocusElement lostKeyboardFocus.	self unselectAll.	 "Pasa todos a la lista de deseleccionados y actualiza los estados de los elementos graficos."			submorphUnderCursor		ifNil: [			] 		ifNotNil: [			"Lo selecciono y le doy el foco del teclado."			self selectedAndKeyboardFocus: submorphUnderCursor.						"Pongo el morh al frente de todos"			submorphUnderCursor comeToFront.						"Le mando que hagaa su gracia al morph"			self selectedElements first changeFunction: anEvent.			]. 			self changed.! !!PLC_GraphicView methodsFor: 'mouse events' stamp: 'EricPernia 8/4/2013 02:37'!leftDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime.""	self networkController leftDoubleClickTimeout: anEvent."! !!PLC_GraphicView methodsFor: 'elements in screen directions' stamp: 'EricPernia 8/4/2013 02:34'!leftMorphFor: aPLC_GraphicElementMorph	"Devuelve el Morph a la izquieda del morph pasado como parmetro"	| startPoint stopPoint result distance |		result := nil.		startPoint := aPLC_GraphicElementMorph leftCenter.	stopPoint := (self left) @ startPoint y.		distance := startPoint x - stopPoint x.	"	Transcript show: startPoint asString , ' ' ,  stopPoint asString , '		'."		1 to: distance do: [ :index | | col |		"Transcript show: (startPoint - ( index @ 0 )) asString , ' '"		col := (self submorphs select: [ :each | each containsPoint: startPoint - ( index @ 0 ) ]).		"Transcript show: col."		col ifNotEmpty:	[ ^ col first].		].		result ifNil: [^ aPLC_GraphicElementMorph ].		! !!PLC_GraphicView methodsFor: 'commands send to self' stamp: 'EricPernia 11/18/2013 00:18'!lostKeyboardFocus	"Evento cuando el ladderView pierde el foco del teclado."		self borderColor: Color white.		self selectedElements do: [ :each |		each draggingAnother.		].! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!mouseDown: anEvent	"Manejador del evento mouse down"	"Do nothing upon mouse-down except inform the hand to watch for a double-click; wait until an 	ensuing click:, doubleClick:, or drag: message gets dispatched"	"Note that mouseMove: and mouseUp: events are not sent to aMorph until it becomes the mouse focus,	which is typically done by aMorph in its click:, doubleClick:, or drag: methods."		anEvent redButtonPressed "click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#leftClick:. #leftDoubleClick:. #leftDoubleClickTimeout:. #startDrag:.}				threshold: 5.								].				anEvent yellowButtonPressed "action-click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#rightClick:. #rightDoubleClick:. #rightDoubleClickTimeout:. nil.}				threshold: 5.			].! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!mouseEnter: anEvent	"Manejador del evento mouse up"		self stopStepping.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!mouseEnterDragging: anEvent	"Manejador del evento mouse up"		self startStepping.		"Para caundo el morph bajo el que este arrastrando el cursor pueda ser el mismo Network"	"anEvent hand submorphsDo: [ :subm | 		subm == self 			ifFalse: [				self startStepping.				].		]."! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!mouseLeave: anEvent	"Manejador del evento mouse up"		self stopStepping.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!mouseLeaveDragging: anEvent	"Manejador del evento mouse up"	self unselectAll.	self stopStepping.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!mouseMove: anEvent	"Manejador del evento mouse move. Este evento ocurre cuando se 	presiona el mouse y se arrastra presionado sobre el morph.""	anEvent redButtonPressed 		ifTrue: [self color: Color white.].			anEvent yellowButtonPressed 		ifTrue: [self color: Color black].	self changed."! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!mouseUp: anEvent	"Manejador del evento mouse up"	self stopStepping. "Ver......"! !!PLC_GraphicView methodsFor: 'properties' stamp: 'EricPernia 8/4/2013 02:36'!properties	"Devuelve la unica instancia de la clase PLC_GraphicElementProperties"	^ PLC_GraphicElementProperties uniqueInstance.! !!PLC_GraphicView methodsFor: 'loop' stamp: 'EricPernia 5/2/2015 00:55'!refresh	"Refresca la vista la vista"	"Hago la vista invisible durante todo el proceso de dibujado"	"self visible: false."		"Guardo los bloques conectables de los elementos morph 	seleccionados y del elemento morph con foco del teclado."	"self saveUIContext." "ANDA MAL"			"Remuevo todos los submorphs"	self removeAllMorphs. "REVISAR SI BORRA BIEN, SI NO USAR DELETE"		"Inicializo el diccionario elements que contiene asociaciones 	graphicElement --> connectableBlock "	self elements: Dictionary new.		"Inicializo las Colecciones"	self unselectedElements: OrderedCollection new.	self selectedElements: OrderedCollection new.	self keyboardFocusElement: self.! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!rejectDropMorphEvent: anEvent	"Manejador del evento mouse up"		self unselectAll.	"Ver..."! !!PLC_GraphicView methodsFor: 'commands send to controller' stamp: 'EricPernia 8/4/2013 02:31'!removeSelectedElements	"Remueve todos los elementos seleccionados."		"Remuevo todos los elementos seleccionados"	"SE JODE PORQUE CAMBIAN LOS ELEMENTOS AL BORRAR EL PRIMERO"	"self selectedElements do: [ :elem |			elem removeElementFrom: self.		]."		"Parche momentaneo, solo borro el primero de los seleccionados"	(self selectedElements size > 0 )		ifTrue: [			self selectedElements first removeElementFrom: self.			].! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!repelsMorph: aMorph event: anEvent	"Devuelve un booleano"	self stopStepping.	(self submorphs) do: [:submorph | submorph unselected.]. 	^(self wantsDroppedMorph: aMorph event: anEvent) not.! !!PLC_GraphicView methodsFor: 'mouse events' stamp: 'EricPernia 8/4/2013 02:37'!rightClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."	"	self networkController rightClick: anEvent."! !!PLC_GraphicView methodsFor: 'mouse events' stamp: 'EricPernia 8/4/2013 02:37'!rightDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."	"	self networkController rightDoubleClick: anEvent."! !!PLC_GraphicView methodsFor: 'mouse events' stamp: 'EricPernia 8/4/2013 02:37'!rightDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime.""	self networkController rightDoubleClickTimeout: anEvent."! !!PLC_GraphicView methodsFor: 'elements in screen directions' stamp: 'EricPernia 8/4/2013 02:34'!rightMorphFor: aPLC_GraphicElementMorph	"Devuelve el Morph a la derecha del morph pasado como parmetro"	| startPoint stopPoint result distance |		result := nil.		startPoint := aPLC_GraphicElementMorph rightCenter.	stopPoint := (self right) @ startPoint y.		distance := stopPoint x - startPoint x.	"	Transcript show: startPoint asString , ' ' ,  stopPoint asString , '		'."		1 to: distance do: [ :index | | col |		"Transcript show: (startPoint - ( index @ 0 )) asString , ' '"		col := (self submorphs select: [ :each | each containsPoint: startPoint + ( index @ 0 ) ]).		"Transcript show: col."		col ifNotEmpty:	[ ^ col first].		].		result ifNil: [^ aPLC_GraphicElementMorph ].		! !!PLC_GraphicView methodsFor: 'extent' stamp: 'EricPernia 8/4/2013 02:35'!rightOfGraphicElementRightOfAll	"Devuelve el right del layoutRectangle del elemento mas a la derecha en pantalla dentro del ladderView"	^ self elements keys 		inject: 0		into: [:resParcial :elem | 			resParcial max: elem layoutRectangle right].! !!PLC_GraphicView methodsFor: 'commands send to self' stamp: 'EricPernia 8/4/2013 02:31'!selectedAndKeyboardFocus: aPLC_GraphicElementMorph	"Aade el elemento a la lista de seleccionados. Borra los anteriores."		self unselectAll.		(self unselectedElements includes: aPLC_GraphicElementMorph)		ifTrue: [			self unselectedElements remove: aPLC_GraphicElementMorph.			].				self selectedElements add: aPLC_GraphicElementMorph.		self keyboardFocusElement: aPLC_GraphicElementMorph.		self unselectedElements do: [ :each |		each notKeyboardFocus.				].		aPLC_GraphicElementMorph		selected;		keyboardFocus.	! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!selectedElements	^ selectedElements! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!selectedElements: anObject	selectedElements := anObject! !!PLC_GraphicView methodsFor: 'mouse events' stamp: 'EricPernia 8/4/2013 02:37'!startDrag: anEvent	"(startDrag) sent when the mouse moves more than threshold pixels 	from evt's position within DoubleClickTime."		"	self networkController startDrag: anEvent."! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!step	"accion cada vez que le llega el mensaje step"	"self submorphsUnderDraggRectangle do: [:submorph | 		submorph underDraggArea].		self submorphsNotUnderDraggRectangle do: [:submorph | 		submorph notUnderDraggArea]."	! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!stepTime	"stepTime en ms"	^ 100.! !!PLC_GraphicView methodsFor: 'submorphs' stamp: 'EricPernia 8/4/2013 02:36'!submorphUnderCursor: anEvent	"Devuelve un submorph o nil."		| collection |		collection := self submorphsUnderCursor: anEvent.		(collection size > 0)		ifTrue: [			^ collection first.			]		ifFalse: [			^ nil.			]! !!PLC_GraphicView methodsFor: 'submorphs' stamp: 'EricPernia 8/4/2013 02:36'!submorphsNotUnderCursor: anEvent	"Devuelve una coleccin de submorphs Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."		| collection |		collection := OrderedCollection new.		self submorphsDo: [ :submorph | 		(submorph containsPoint: anEvent cursorPoint)			ifFalse: [ collection add: submorph.]		].		^ collection.! !!PLC_GraphicView methodsFor: 'submorphs' stamp: 'EricPernia 8/4/2013 02:36'!submorphsNotUnderDraggRectangle	"Devuelve una coleccin de submorphs  que estan bajo el rea del DraggRectangle"		| collection |		collection := OrderedCollection new.		self submorphsDo: [ :submorph | 		(submorph bounds intersects: self dragRectangle)			ifFalse: [ collection add: submorph.]		].		^ collection.! !!PLC_GraphicView methodsFor: 'submorphs' stamp: 'EricPernia 8/4/2013 02:36'!submorphsOn: aRectangle	"Devuelve una coleccin de submorphs  que estan bajo el rea de aRectangle"		| collection |		collection := OrderedCollection new.		self submorphsDo: [ :submorph | 		(submorph bounds intersects: aRectangle)			ifTrue: [ collection add: submorph.]		].		^ collection.! !!PLC_GraphicView methodsFor: 'submorphs' stamp: 'EricPernia 8/4/2013 02:36'!submorphsUnderCursor: anEvent	"Devuelve una coleccin de submorphs Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."		| collection |		collection := OrderedCollection new.		self submorphsDo: [ :submorph | 		(submorph containsPoint: anEvent cursorPoint)			ifTrue: [ collection add: submorph.]		].		^ collection.! !!PLC_GraphicView methodsFor: 'submorphs' stamp: 'EricPernia 8/4/2013 02:36'!submorphsUnderDraggRectangle	"Devuelve una coleccin de submorphs  que estan bajo el rea del DraggRectangle"		| collection |		collection := OrderedCollection new.		self submorphsDo: [ :submorph | 		(submorph bounds intersects: self dragRectangle)			ifTrue: [ collection add: submorph.]		].		^ collection.! !!PLC_GraphicView methodsFor: 'submorphs' stamp: 'EricPernia 8/4/2013 02:36'!submorphsUnselectAll	"Pasa todos sus submorphs al estado deseleccionado"	self submorphs do: [:submorph | 		submorph unselected].	! !!PLC_GraphicView methodsFor: 'extent' stamp: 'EricPernia 8/4/2013 02:35'!totalExtent	^ ( self rightOfGraphicElementRightOfAll + self gridOrigin x ) @ ( self bottomOfGraphicElementBelowOfAll + self gridOrigin y ).! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!uiContext		^ uiContext! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!uiContext: anObject		uiContext := anObject! !!PLC_GraphicView methodsFor: 'commands send to self' stamp: 'EricPernia 8/4/2013 02:31'!unselectAll	"Pasa todos los elementos a la Coleccion de deseleccionados y actualiza los estados de los elementos graficos."		self selectedElements removeAll.	self unselectedElements removeAll.		self submorphs do: [ :each |		self unselectedElements add: each.			].			self unselectedElements do: [ :each |		each unselected.		].! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!unselectedElements	^ unselectedElements! !!PLC_GraphicView methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 02:29'!unselectedElements: anObject	unselectedElements := anObject! !!PLC_GraphicView methodsFor: 'event handling' stamp: 'EricPernia 8/4/2013 02:41'!wantsDroppedMorph: aMorph event: anEvent	self stopStepping.	^  aMorph isKindOf: PLC_GraphicElementMorph. "Tiene que responder true si el morph es un elemento Ladder o FBD"! !!PLC_View methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 05:09'!model: anObject		model := anObject! !!BasicParsers class methodsFor: 'numbers' stamp: 'CarlosLombardi 9/13/2016 09:18'!decimalPart	"a parser for the decimal part of a number"	^($. asParser, self naturalNumber) ==>	[ :nodes | ('0.', nodes second asString) asNumber. ]! !!BasicParsers class methodsFor: 'numbers' stamp: 'CarlosLombardi 9/13/2016 09:21'!integerNumber	"a parser for a signed integer number"	^(self optionalSign, self naturalNumber)  ==> 		[ :nodes | nodes first value: nodes second ].! !!BasicParsers class methodsFor: 'numbers' stamp: 'CarlosLombardi 9/13/2016 02:18'!naturalNumber	"a parser for a natural number"	^#digit asParser plus flatten ==> [:str | str asNumber]! !!BasicParsers class methodsFor: 'numbers' stamp: 'CarlosLombardi 9/13/2016 02:18'!optionalSign	"a parser for an optional sign, e.g. the minus sign in -4349.21"	^$- asParser optional ==> [:charOrNil | 	charOrNil 		ifNil: [ [:n | n] ] ifNotNil: [ [:n | n negated] ]	]! !!BasicParsers class methodsFor: 'numbers' stamp: 'CarlosLombardi 9/22/2016 11:17'!realNumber	"a parser for a real number. Scientific notation to be done"	| positiveRealWithIntegerPart positiveReal |	positiveRealWithIntegerPart := 		(self integerNumber, self decimalPart optional) ==>		[ :nodes | nodes first + (nodes second ifNil: [0]) ] .	positiveReal := positiveRealWithIntegerPart / self decimalPart .	^(self optionalSign, positiveReal)  ==> 	[ :nodes | (nodes first value: nodes second) asFloat ].! !!Bloque class methodsFor: 'instance creation' stamp: 'EricPernia 12/3/2010 04:47'!newConNombre: unNombre	|bloque|		bloque := self new.	bloque nombre: unNombre.		^bloque.	! !!Bloque class methodsFor: 'instance creation' stamp: 'EricPernia 8/10/2015 03:16'!newConNombre: unNombre yModelo: unModelo	|bloque|		bloque := self new.	bloque nombre: unNombre.		bloque modelo: unModelo.	unModelo agregarBloque: bloque.		^bloque.	! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/26/2010 12:42'!SosBloqueDeSalida		^false.! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/26/2010 12:42'!SosBloqueDerivador		^false.! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 12:58'!agregarEntrada	"Agrega una entrada a la OrderedCollection conexionesDeEntrada creandole en su interior un nuevo array de 2 elementos."		| vector |		vector := Array new: 2.	conexionesDeEntrada add: vector.! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 12:59'!agregarSalida	"Agrega una salida a la OrderedCollection salidas con valor inicial 0."	salidas add: 0.! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:00'!cantidadDeEntradas	"Devuelve la cantidad de conexionesDeEntrada del bloque."	^self conexionesDeEntrada size.! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/12/2010 05:48'!cantidadDeSalidas	"Devuelve la cantidad de salidas del bloque."	^salidas size.! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:02'!condicionInicial: unValor ParaLaSalida: unNumeroDeSalida	"Carga la condicion inicial unValor en la OrderedCollection salidas en la posicion que le paso en unNumeroDeSalida."	self salidas at: unNumeroDeSalida put: unValor.! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 11/10/2010 23:37'!conexionesDeEntrada	^ conexionesDeEntrada! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 11/10/2010 23:37'!conexionesDeEntrada: anObject	conexionesDeEntrada := anObject! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 12/3/2010 17:24'!deconectarEntrada: unNumeroDeEntrada.	"Desconecta la entrada numero unNumeroDeEntrada."	(self conexionesDeEntrada at: unNumeroDeEntrada) at: 1 put: nil; at: 2 put: nil. ! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 11/10/2010 23:37'!entradas	^ entradas! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 11/10/2010 23:37'!entradas: anObject	entradas := anObject! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:04'!guardarValorDeEntrada: unValor	"Agrega el valor unValor a la OrderedCollection entradas."	self entradas add: unValor.! !!Bloque methodsFor: 'initialize-release' stamp: 'EricPernia 11/15/2010 13:03'!initialize	"Crea las listas apuntando estas 3 variables a nuevas OrderedCollection."	conexionesDeEntrada := OrderedCollection new.	entradas := OrderedCollection new.	salidas := OrderedCollection new.! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 8/12/2015 00:41'!leerEntradasEnTiempo: t	"Lee y almacena en la OrederedCollection entradas todas las salidas de otros bloques que tiene conectadas a sus entradas.	(vector at: 1) devuelve un bloque.	(vector at: 2) devuelve un numero que representa un numero de salida dedicho bloque"	self conexionesDeEntrada do: [ :vector | self guardarValorDeEntrada: ((vector at: 1) salida: (vector at: 2) enTiempo: t) ].! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 8/10/2015 03:14'!modelo	^ modelo! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 8/10/2015 03:14'!modelo: anObject	modelo := anObject! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 11/12/2010 20:18'!nombre	^ nombre! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 11/12/2010 20:18'!nombre: anObject	nombre := anObject! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 12/3/2010 16:40'!removerEntrada: unNumeroDeEntrada	"Remueve la entrada numero unNumeroDeEntrada de la la OrderedCollection conexionesDeEntrada."		self conexionesDeEntrada remove: (self conexionesDeEntrada at: unNumeroDeEntrada).! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 12/3/2010 16:42'!removerSalida: unNumeroDeSalida	"Remueve la salida numero unNumeroDeSalida de la la OrderedCollection salidas."		self salidas remove: (self salidas at: unNumeroDeSalida).! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 12/3/2010 16:44'!resetearEntradas 	"Apunta la variable entradas a una nueva OrderedCollection para perder los valores de entradas y 	tener nuevamente su indice en cero para el proximo calculo de entradas."		self entradas: self entradas removeAll. ! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/14/2010 18:55'!salida: unNumeroDeSalida	^self salidas at: unNumeroDeSalida.! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:31'!salida: unNumeroDeSalida conectateCon: unBloque entrada: unNumeroDeEntrada.	"Conteca la salida del bloque al que le mando este mensaje con la entrada del otro bloque.	Para lograrlo, pone en la OrderedCollection 'conexionesDeEntrada' de 'unBloque' en la posicion 	'unNumeroDeEntrada' que tiene un array de 2 elementos cuyo primer valor 'self'' (el bloque al 	que le mandan el mensaje) y con 'unNumeroDeSalida' como segundo valor del array."	(unBloque conexionesDeEntrada at: unNumeroDeEntrada) at: 1 put: self; at: 2 put: unNumeroDeSalida. ! !!Bloque methodsFor: 'acciones' stamp: 'EricPernia 8/12/2015 00:50'!salida: unNumeroDeSalida enTiempo: t	"Calcuala y devuelve la salida del bloque al que el mandan este mensaje para eltiempo t."	self leerEntradasEnTiempo: t. 			"Lee sus entradas en el tiempo t. Este lee las entradas haciendo que 											se ramifique hasta los bloques de entrada el flujo dle programa."											self funcionEnTiempo: t. 				"Ejecuta las tareas del bloque. Este metodo se debe definir en las 											subclases y debe escribir las salidas."													self resetearEntradas.					"Reseteo las entradas."							^ self salidas at: unNumeroDeSalida.	"Devuelve su salida en el tiempo t. Esta linea hace la magia de que 											vuelva todo hacia la salida"			! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 11/10/2010 23:37'!salidas	^ salidas! !!Bloque methodsFor: 'accessing' stamp: 'EricPernia 11/10/2010 23:37'!salidas: anObject	salidas := anObject! !!BloqueDerivador methodsFor: 'acciones' stamp: 'EricPernia 11/26/2010 12:43'!SosBloqueDerivador		^true.! !!BloqueDerivador methodsFor: 'accessing' stamp: 'EricPernia 11/16/2010 01:22'!dt	^ dt! !!BloqueDerivador methodsFor: 'accessing' stamp: 'EricPernia 11/16/2010 01:22'!dt: anObject	dt := anObject! !!BloqueDerivador methodsFor: 'acciones' stamp: 'EricPernia 11/16/2010 05:11'!funcionEnTiempo: t 	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	este bloque calcula la derivada utilizando el teorema del limite"	"salidas at: 1 put: ((muestraSiguiente- (entradas at:1))/dt)." "Derivada hacia adelante" 	salidas at: 1 put: ( ((entradas at: 1) - muestraAnterior) / dt ). "Derivada hacia atras"	! !!BloqueDerivador methodsFor: 'acciones' stamp: 'EricPernia 11/16/2010 05:08'!guardarValorDeEntradaAnterior: unValor	muestraAnterior := unValor.! !!BloqueDerivador methodsFor: 'initialize-release' stamp: 'EricPernia 11/16/2010 01:15'!initialize 	"Inicializo el bloque."	super initialize.	self agregarEntrada.	self agregarSalida.! !!BloqueDerivador methodsFor: 'acciones' stamp: 'EricPernia 11/16/2010 05:04'!leerEntradasEnTiempo: t	"Lee y almacena en la OrederedCollection entradas todas las salidas de otros bloques que tiene conectadas a sus entradas.		(vector at: 1) devuelve un bloque.	(vector at: 2) devuelve un numero que representa un numero de salida de dicho bloque,		El derivador lee una muestraSiguiente la guarda, luego lee la muestra actual y la guarda en la entrada"	self conexionesDeEntrada do: [ :vector | self guardarValorDeEntradaAnterior: ((vector at: 1) salida: (vector at: 2))].  "Leo la entrada anterior"	"self conexionesDeEntrada do: [ :vector | self muestraSiguiente: ((vector at: 1) salida: (vector at: 2) enTiempo:(t+dt))]." "Leo la entrada futura"	self conexionesDeEntrada do: [ :vector | self guardarValorDeEntrada: ((vector at: 1) salida: (vector at: 2)enTiempo: t)]. "Leo la entrada actual"! !!BloqueDerivador methodsFor: 'accessing' stamp: 'EricPernia 11/16/2010 01:22'!muestraSiguiente	^ muestraSiguiente! !!BloqueDerivador methodsFor: 'accessing' stamp: 'EricPernia 11/16/2010 01:22'!muestraSiguiente: anObject	muestraSiguiente := anObject! !!BloqueFuncionConstante methodsFor: 'accessing' stamp: 'EricPernia 11/12/2010 20:35'!constante	^ constante! !!BloqueFuncionConstante methodsFor: 'accessing' stamp: 'EricPernia 11/12/2010 20:35'!constante: anObject	constante := anObject! !!BloqueFuncionConstante methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:35'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	Este BloqueConstante devuelve una constante para cualquier tiempo."	salidas at: 1 put: (self constante). ! !!BloqueFuncionConstante methodsFor: 'initialize-release' stamp: 'EricPernia 11/13/2010 18:00'!initialize 	"Inicializo el bloque constante que siempre tiene una salida y su valor de constantes se inicializa en 1."	super initialize.	self agregarSalida.	self constante: 1.! !!BloqueFuncionRampaT methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:38'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	Este BloqueFuncionRampaT devuelve una funcion rampa ( f(t)=0 si t<0, f(t) = t si t>=0 )."	salidas at: 1 put: ((t <0) ifTrue: [0] ifFalse: [t]). ! !!BloqueFuncionRampaT methodsFor: 'initialize-release' stamp: 'EricPernia 11/14/2010 06:35'!initialize 	"Inicializo el bloque funcion rampa que siempre tiene una salida 0 con t menor a cero e y=t para t mayor o igual a cero."	super initialize.	self agregarSalida.! !!BloqueFuncionSenoT methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:39'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	Este BloqueFuncionSenoT devuelve una funcion seno ( f(t) = sen(t) para todo t )."	salidas at: 1 put: (t sin). ! !!BloqueFuncionSenoT methodsFor: 'initialize-release' stamp: 'EricPernia 11/14/2010 07:08'!initialize 	"Inicializo el bloque funcion rampa que siempre tiene una salida 0 con t menor a cero e y=t para t mayor o igual a cero."	super initialize.	self agregarSalida.! !!BloqueFuncionSincT methodsFor: 'acciones' stamp: 'EricPernia 12/10/2010 17:32'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	Este BloqueFuncionSenoT devuelve una funcion seno ( f(t) = sen(pi t)/(pi t) para todo t )."	salidas at: 1 put: 		(t* Float pi) sin / (t=0 ifTrue: [1] ifFalse:[t* Float pi]).! !!BloqueFuncionSincT methodsFor: 'initialize-release' stamp: 'EricPernia 12/10/2010 16:27'!initialize 	"Inicializo el bloque funcion rampa que siempre tiene una salida 0 con t menor a cero e y=t para t mayor o igual a cero."	super initialize.	self agregarSalida.! !!BloqueFuncionT methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:40'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	Este BloqueFuncionT devuelve una funcion lineal t ( f(t) = t para todo t )."	salidas at: 1 put: t. ! !!BloqueFuncionT methodsFor: 'initialize-release' stamp: 'EricPernia 11/16/2010 02:18'!initialize 	"Inicializo el bloque funcion rampa que siempre tiene una salida y=t para todo t."	super initialize.	self agregarSalida.! !!BloqueFuncionTAlCuadrado methodsFor: 'acciones' stamp: 'EricPernia 11/16/2010 02:19'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	Este BloqueFuncionT devuelve una funcion lineal t ( f(t) = t para todo t )."	salidas at: 1 put: (t*t). ! !!BloqueFuncionTAlCuadrado methodsFor: 'initialize-release' stamp: 'EricPernia 11/16/2010 02:18'!initialize 	"Inicializo el bloque funcion rampa que siempre tiene una salida y=t para todo t."	super initialize.	self agregarSalida.! !!BloqueGanancia methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:42'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	Este BloqueGanancia multiplica su entrada por el valor ganancia y el resultado lo escribe en su salida."	salidas at: 1 put: ((entradas at: 1) * (self ganancia)). ! !!BloqueGanancia methodsFor: 'accessing' stamp: 'EricPernia 11/14/2010 07:16'!ganancia	^ ganancia! !!BloqueGanancia methodsFor: 'accessing' stamp: 'EricPernia 11/14/2010 07:16'!ganancia: anObject	ganancia := anObject! !!BloqueGanancia methodsFor: 'initialize-release' stamp: 'EricPernia 11/16/2010 01:16'!initialize 	"Inicializo el bloque ganancia."	super initialize.	self agregarEntrada.	self agregarSalida.	self ganancia: 1.! !!BloqueRetardo methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:44'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Y guarda el resultado en la salida correspondiente.	Este BloqueRetardo copia su entrada a al salida pero retrasada una muestra. 	Esto lo logra gracias a la redefinicion del metodo leerEntradasEnTiempo: ."	self salidas at: 1 put: (self entradas at: 1).	! !!BloqueRetardo methodsFor: 'initialize-release' stamp: 'EricPernia 11/14/2010 18:02'!initialize 	"Inicializo el bloque."	super initialize.	self agregarSalida.	self agregarEntrada.! !!BloqueRetardo methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:48'!leerEntradasEnTiempo: t	"Lee y almacena en la OrederedCollection entradas todas las salidas de otros bloques que tiene conectadas a sus entradas.		(vector at: 1) devuelve un bloque.	(vector at: 2) devuelve un numero que representa un numero de salida de dicho bloque,		El retardo de una muestra ocurre debido a que en lugar de mandarle el mensaje 	'salida: enTeimpo:', le envia el mensaje 'salida:' el cual devuelve su salida calcualada en 	el paso anterior o la condicion inicial si es la primera muestra del vector de tiempo."	self conexionesDeEntrada do: [ :vector | self guardarValorDeEntrada: ((vector at: 1) salida: (vector at: 2))].	! !!BloqueSalida methodsFor: 'acciones' stamp: 'EricPernia 11/26/2010 12:43'!SosBloqueDeSalida		^true.! !!BloqueSalida methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:52'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t..	Este bloque BloqueSalida acumula los valores que va calculando para cada tiempo en 	su 	OrderedCollection saliconexionesDeEntrada ."	self salidas at: 1 put: (self entradas at: 1). 	self salidasEnElTiempo add: (self entradas at: 1)! !!BloqueSalida methodsFor: 'initialize-release' stamp: 'EricPernia 11/14/2010 06:28'!initialize 	"Inicializo el bloque salida que siempre tiene una entrada y guarda las salidas para todo t que se le pase."	super initialize.	self agregarEntrada.	self agregarSalida.	salidasEnElTiempo := OrderedCollection new.	! !!BloqueSalida methodsFor: 'accessing' stamp: 'EricPernia 11/14/2010 06:29'!salidasEnElTiempo	^ salidasEnElTiempo! !!BloqueSalida methodsFor: 'accessing' stamp: 'EricPernia 11/14/2010 06:29'!salidasEnElTiempo: anObject	salidasEnElTiempo := anObject! !!BloqueSumador methodsFor: 'acciones' stamp: 'EricPernia 11/13/2010 18:58'!agregarEntradaConSigno: unSigno	self agregarEntrada.	self agregarSigno: unSigno.	! !!BloqueSumador methodsFor: 'acciones' stamp: 'EricPernia 11/13/2010 18:56'!agregarSigno: unSigno	(unSigno asCharacter) = $+ 		ifTrue: [signosEntradas add: 1.] 		ifFalse: [			(unSigno asCharacter) = $- 				ifTrue: [signosEntradas add: (1 negated).] 				ifFalse: [^'Solo se permiten como signo los caracteres o strings de un caracter + o -']			].! !!BloqueSumador methodsFor: 'acciones' stamp: 'EricPernia 11/15/2010 13:54'!cambiarSignoPor: unSigno aEntrada: unNumero	"Cambia el signo de la entrada que le paso."	(unSigno asCharacter) = $+ 		ifTrue: [signosEntradas at: unNumero put: 1.] 		ifFalse: [			(unSigno asCharacter) = $- 				ifTrue: [signosEntradas at: unNumero put: (1 negated).] 				ifFalse: [^'Solo se permiten como signo los caracteres o strings de un caracter + o -']			].! !!BloqueSumador methodsFor: 'acciones' stamp: 'EricPernia 11/26/2010 13:58'!funcionEnTiempo: t	"Calcula lo que hace el bloque en el tiempo t.	Este BloqueSuma realiza la suma de todas sus entradas afectadaspor un signo el cual se el setea 	y guarda el resultado en su salida."	(1 to: entradas size) do: [:i | entradas at: i put: ((entradas at: i) * (signosEntradas at: i))].	self salidas at: 1 put: (		entradas 			inject: 0 			into: [:total :entrada | total + entrada]).  "Implementacion con inject into"	"|out|	total := 0.	entradas do: [:entrada|  total := total + entrada].	self salidas at: 1 put: total. " "Implementacion vieja"	! !!BloqueSumador methodsFor: 'initialize-release' stamp: 'EricPernia 11/16/2010 01:17'!initialize 	"Inicializo el bloque suma."	super initialize.	signosEntradas := OrderedCollection new.	self agregarSalida.	self agregarEntradaConSigno: $+.	self agregarEntradaConSigno: $+.	! !!IDE4PLC class methodsFor: 'Services Clean Build Download' stamp: 'EricPernia 3/17/2016 01:37'!buildCProgram	PLC_CompilerAndWriter current buildCProgram.! !!IDE4PLC class methodsFor: 'localization' stamp: 'EricPernia 3/12/2016 19:22'!changeLanguage: aPLC_Language	"Cambia el idioma de la GUI y la reinicia"	self clearAllInstances.		self setLanguage: aPLC_Language.		self initializeGUI.! !!IDE4PLC class methodsFor: 'Services Version' stamp: 'EricPernia 2/19/2016 01:33'!ciaaFirmwareVersion	^ 'Firmware Upa 1.0.0 LTS (release date 2015.12.23).'.! !!IDE4PLC class methodsFor: 'Services Clean Build Download' stamp: 'EricPernia 3/24/2016 22:35'!cleanCProgram	PLC_CompilerAndWriter current cleanCProgram: (self createConfigSoftWithPOU: pou ).! !!IDE4PLC class methodsFor: 'Initialization' stamp: 'EricPernia 9/15/2015 16:48'!clearAllInstances	"Borra todas las instancias nicas de IDE4PLC para que se pueda inicializar 	y no se ejecute el initialize automtico de cada clase."		"Clase con identificador"	"PLC_ClassWithIdentifier initialize."	"Compilador y grabador (usa PLC_FileSystem y OSProcess)"	PLC_CompilerAndWriter clearInstance.	"Es el que usa FileStream para finalmente crear los 	archivos .C, .H y .IL"	PLC_CIAA_FileSystem clearInstance.	"Tipos de datos"	PLC_DataType clearTypes.	"PLC_DataType createDataTypes."	"Funciones y Bloques de Funcin"	PLC_Function clearFunctions.	PLC_Function createStdFunctions.	PLC_FunctionBlock clearFunctionBlocks.	PLC_FunctionBlock createStdFunctionBlocks.	PLC_Program clearPrograms.	"Elementos de lenguajes grficos"	"PLC_Element initialize."	PLC_Element clearElements.	"PLC_GraphicFunctionBlockCall initialize.	PLC_VerticalLink initialize."	"Elementos IL"	"PLC_IL_Modifiers initialize."	PLC_IL_Modifiers clearInstances.	"Morphs de los elementos grficos"	PLC_GraphicElementProperties clearInstance.	"Estados de los Morphs de los elementos grfico"	PLC_Aligns clearAligns.	PLC_GraphicElementState clearStates.	"Bibliotecas"	PLC_Libraries clearInstance.	"Elimino la POU de la clase"	self clearProgDecl.		"Iconos"	PLC_DesktopIconMorph clearIcons.! !!IDE4PLC class methodsFor: 'Services Generate POU and C code' stamp: 'EricPernia 5/8/2015 00:42'!clearProgDecl	pou := nil.		! !!IDE4PLC class methodsFor: 'Services Generate POU and C code' stamp: 'EricPernia 3/17/2016 01:27'!createConfigSoftWithPOU: aPOU	| programitaDecl  pouCall categoriaDeInstancia declDeInstancia operandoInstancia 	tarea proyecto configHard configSoft recurso |	programitaDecl := aPOU.	"--------------------------------------------------------------------------------------------------------------"					"PROYECTO					------------------"	proyecto := PLC_Project newWithName: 'IDE4PLC_CIAA'.	proyecto libraries.	proyecto hardwareConfigurations.	proyecto projectName.	proyecto identifier.	proyecto addHardwareConfiguration: (		PLC_HardwareConfiguration 			newWithName: 'Config_CIAA'		).			"proyecto explore."					"--------------------------------------------------------------------------------------------------------------"				"CONFIGURACION DE HARDWARE DESDE PROYECTO				------------------------------------------------------------------------------"	configHard := proyecto hardwareConfigurations first.	configHard addDevice: PLC_DevicePLC plericLPC1769 at: 0.	"--------------------------------------------------------------------------------------------------------------"				"CONFIGURACION DE SOFTWARE DESDE LA DE HARDWARE				----------------------------------------------------------------------------------------"	"Para crear y almacenar una Configuracion de software en la de hardware"	configSoft := configHard createSoftwareConfiguration.	"--------------------------------------------------------------------------------------------------------------"				"RECURSO DESDE LA CONFIGURACION DE SOFTWARE				-------------------------------------------------------------------------------"	recurso := configSoft resources first.	recurso ilCompile.					"--------------------------------------------------------------------------------------------------------------"			"CREO UNA TAREA PERIODICA			 -------------------------------------------"					tarea := PLC_TaskConfiguration newWithName: 'TareaPer'.	"--------------------------------------------------------------------------------------------------------------"			"DECLARACION DE VARIABLE DE INSTANCIA (del Programa) EN RECURSO			 -----------------------------------------------------------------------------------------------------------"				"Obtengo la Categora VAR_GLOBAL en Recurso"	categoriaDeInstancia := recurso globalVarDecls.	"Es la declaracion de variable de instancia que voy a poner en la lista de VAR_GLOBAL en Recurso"	declDeInstancia := programitaDecl instanceDecl.	"Agrego la variable a la categoria, Declara la instancia en el Recurso"	categoriaDeInstancia add: declDeInstancia.	"CREACION DE OPERANDO VARIABLE INSTANCIA A PARTIR DE SU DECLARACION:"	"Creo un operando instancia desde la declaracion. ESTO LO VA A TENER QUE HACER EL PARSER EN IL"	operandoInstancia :=  declDeInstancia operand.			"--------------------------------------------------------------------------------------------------------------"			"CREO UNA CONFIGURACION DE (o llamado a) PROGRAMA			 --------------------------------------------------------------------------------------"	"Le asigno la instancia creada"		pouCall := PLC_ProgramConfiguration 		newFromDeclaration: programitaDecl 		andInstanceOperand: operandoInstancia.					"--------------------------------------------------------------------------------------------------------------"			"AADO LAS CONFIG DE TAREA y PROGRAMA ALRECURSO 				-------------------------------------------------------------------------------------"										"Agrego al recurso configuraciones de Tareas y Programas"		recurso addProgConfig: pouCall.	recurso addTaskConfig: tarea.	"--------------------------------------------------------------------------------------------------------------"			"CONFIGURO LA TAREA PERIODICA			 ---------------------------------------------------"					"PRIORIDAD"	(tarea inputAssignments at: 3) actualArgument dataValue: 9.	"PERIODICIDAD cada 20 ms"	(tarea inputAssignments at: 2) actualArgument dataValue: 20. 	"--------------------------------------------------------------------------------------------------------------"			"CONFIGURO LA CONFIG DE PROGRAMA			 ---------------------------------------------------------"			"Asigno una las entradas del llamado a programa con direcciones fisicas  %IX0.0"				(pouCall inputAssignments at: 1) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 1) 					andDataValue: nil				).	"globalVarDecls at: 1 = %I0.0"				(pouCall inputAssignments at: 2) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 2) 					andDataValue: nil				).			(pouCall inputAssignments at: 3) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 3) 					andDataValue: nil				).			(pouCall inputAssignments at: 4) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 4) 					andDataValue: nil				).		"PARCHE - Comentario para que ande con la EDU-CIAA, Actualmente no se usa en el codigo generado"		"(pouCall inputAssignments at: 5) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 5) 					andDataValue: nil				).			(pouCall inputAssignments at: 6) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 6) 					andDataValue: nil				).			(pouCall inputAssignments at: 7) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 7) 					andDataValue: nil				).			(pouCall inputAssignments at: 8) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 8) 					andDataValue: nil				)."	"Asigno una las salidas del llamado a programa con direcciones fisicas  %QX0.0"				(pouCall outputAssignments at: 1) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 9) 					andDataValue: nil				).	"recurso globalVarDecls at: 9 = %Q0.0"			(pouCall outputAssignments at: 2) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 10) 					andDataValue: nil				).				(pouCall outputAssignments at: 3) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 11) 					andDataValue: nil				).				(pouCall outputAssignments at: 4) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 12) 					andDataValue: nil				).				(pouCall outputAssignments at: 5) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 13) 					andDataValue: nil				).				(pouCall outputAssignments at: 6) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 14) 					andDataValue: nil				).			"	(pouCall outputAssignments at: 7) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 15) 					andDataValue: nil				).				(pouCall outputAssignments at: 8) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 16) 					andDataValue: nil				).	"	"--------------------------------------------------------------------------------------------------------------"			"ASOCIO CONFIG DE TAREA CON CONFIG PROGRAMA			-------------------------------------------------------------------------------"				"Aado la configuracion de programa o llamado a programa a la tarea (asociacion)"	tarea addProgConfig: pouCall.	"--------------------------------------------------------------------------------------------------------------"	^ configSoft.		! !!IDE4PLC class methodsFor: 'Services Generate POU and C code' stamp: 'EricPernia 2/17/2016 02:47'!createProgDecl	^ PLC_DevicePLC current createProgDecl.! !!IDE4PLC class methodsFor: 'Services Generate POU and C code' stamp: 'EricPernia 3/17/2016 01:28'!createProyectWithPOU: aPOU	| programitaDecl  pouCall categoriaDeInstancia declDeInstancia operandoInstancia 	tarea proyecto configHard configSoft recurso |	programitaDecl := aPOU.	"--------------------------------------------------------------------------------------------------------------"					"PROYECTO					------------------"	proyecto := PLC_Project newWithName: 'IDE4PLC_CIAA'.	proyecto libraries.	proyecto hardwareConfigurations.	proyecto projectName.	proyecto identifier.	proyecto addHardwareConfiguration: (		PLC_HardwareConfiguration 			newWithName: 'Config_CIAA'		).			"proyecto explore."					"--------------------------------------------------------------------------------------------------------------"				"CONFIGURACION DE HARDWARE DESDE PROYECTO				------------------------------------------------------------------------------"	configHard := proyecto hardwareConfigurations first.	configHard addDevice: PLC_DevicePLC plericLPC1769 at: 0.	"--------------------------------------------------------------------------------------------------------------"				"CONFIGURACION DE SOFTWARE DESDE LA DE HARDWARE				----------------------------------------------------------------------------------------"	"Para crear y almacenar una Configuracion de software en la de hardware"	configSoft := configHard createSoftwareConfiguration.	"--------------------------------------------------------------------------------------------------------------"				"RECURSO DESDE LA CONFIGURACION DE SOFTWARE				-------------------------------------------------------------------------------"	recurso := configSoft resources first.	recurso ilCompile.					"--------------------------------------------------------------------------------------------------------------"			"CREO UNA TAREA PERIODICA			 -------------------------------------------"					tarea := PLC_TaskConfiguration newWithName: 'MAIN_TASK'.	"--------------------------------------------------------------------------------------------------------------"			"DECLARACION DE VARIABLE DE INSTANCIA (del Programa) EN RECURSO			 -----------------------------------------------------------------------------------------------------------"				"Obtengo la Categora VAR_GLOBAL en Recurso"	categoriaDeInstancia := recurso globalVarDecls.	"Es la declaracion de variable de instancia que voy a poner en la lista de VAR_GLOBAL en Recurso"	declDeInstancia := programitaDecl instanceDecl.	"Agrego la variable a la categoria, Declara la instancia en el Recurso"	categoriaDeInstancia add: declDeInstancia.	"CREACION DE OPERANDO VARIABLE INSTANCIA A PARTIR DE SU DECLARACION:"	"Creo un operando instancia desde la declaracion. ESTO LO VA A TENER QUE HACER EL PARSER EN IL"	operandoInstancia :=  declDeInstancia operand.			"--------------------------------------------------------------------------------------------------------------"			"CREO UNA CONFIGURACION DE (o llamado a) PROGRAMA			 --------------------------------------------------------------------------------------"	"Le asigno la instancia creada"		pouCall := PLC_ProgramConfiguration 		newFromDeclaration: programitaDecl 		andInstanceOperand: operandoInstancia.					"--------------------------------------------------------------------------------------------------------------"			"AADO LAS CONFIG DE TAREA y PROGRAMA ALRECURSO 				-------------------------------------------------------------------------------------"										"Agrego al recurso configuraciones de Tareas y Programas"		recurso addProgConfig: pouCall.	recurso addTaskConfig: tarea.	"--------------------------------------------------------------------------------------------------------------"			"CONFIGURO LA TAREA PERIODICA			 ---------------------------------------------------"					"PRIORIDAD"	(tarea inputAssignments at: 3) actualArgument dataValue: 9.	"PERIODICIDAD cada 20 ms"	(tarea inputAssignments at: 2) actualArgument dataValue: 20. 	"--------------------------------------------------------------------------------------------------------------"			"CONFIGURO LA CONFIG DE PROGRAMA			 ---------------------------------------------------------"			"Asigno una las entradas del llamado a programa con direcciones fisicas  %IX0.0"				(pouCall inputAssignments at: 1) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 1) 					andDataValue: nil				).	"globalVarDecls at: 1 = %I0.0"				(pouCall inputAssignments at: 2) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 2) 					andDataValue: nil				).			(pouCall inputAssignments at: 3) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 3) 					andDataValue: nil				).			(pouCall inputAssignments at: 4) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 4) 					andDataValue: nil				).			(pouCall inputAssignments at: 5) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 5) 					andDataValue: nil				).			(pouCall inputAssignments at: 6) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 6) 					andDataValue: nil				).			(pouCall inputAssignments at: 7) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 7) 					andDataValue: nil				).			(pouCall inputAssignments at: 8) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 8) 					andDataValue: nil				).	"Asigno una las salidas del llamado a programa con direcciones fisicas  %QX0.0"				(pouCall outputAssignments at: 1) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 9) 					andDataValue: nil				).	"recurso globalVarDecls at: 9 = %Q0.0"			(pouCall outputAssignments at: 2) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 10) 					andDataValue: nil				).				(pouCall outputAssignments at: 3) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 11) 					andDataValue: nil				).				(pouCall outputAssignments at: 4) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 12) 					andDataValue: nil				).				(pouCall outputAssignments at: 5) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 13) 					andDataValue: nil				).				(pouCall outputAssignments at: 6) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 14) 					andDataValue: nil				).				(pouCall outputAssignments at: 7) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 15) 					andDataValue: nil				).				(pouCall outputAssignments at: 8) 			actualArgument: (				PLC_Location 					newWithDeclaration: (recurso globalVarDecls at: 16) 					andDataValue: nil				).		"--------------------------------------------------------------------------------------------------------------"			"ASOCIO CONFIG DE TAREA CON CONFIG PROGRAMA			-------------------------------------------------------------------------------"				"Aado la configuracion de programa o llamado a programa a la tarea (asociacion)"	tarea addProgConfig: pouCall.	"--------------------------------------------------------------------------------------------------------------"	^ proyecto.		! !!IDE4PLC class methodsFor: 'Services Clean Build Download' stamp: 'EricPernia 3/17/2016 01:37'!downloadProgram	PLC_CompilerAndWriter current downloadProgram.! !!IDE4PLC class methodsFor: 'Services Clean Build Download' stamp: 'EricPernia 3/17/2016 02:10'!generateCBuildDownloadProgram	"Genera el cdigo C, lo Compila y lo Descarga al dispositivo"	"Genera el cdigo C"	self generateProgramCCode.		"Build y Download"	PLC_CompilerAndWriter current buildDownloadProgram.	! !!IDE4PLC class methodsFor: 'Services Generate POU and C code' stamp: 'EricPernia 3/16/2016 03:33'!generateProgramCCode	(self createConfigSoftWithPOU: pou ) cCompile.! !!IDE4PLC class methodsFor: 'Self Modification' stamp: 'EricPernia 9/15/2015 16:41'!hideDevelopTools	"Saca el menu World"	PasteUpMorph compile: 'handlesMouseDown: evt		^false.'.! !!IDE4PLC class methodsFor: 'Initialization' stamp: 'EricPernia 3/24/2016 17:45'!initializeGUI	"Esta clase inicializa la parte visual del proyecto"	"GUI - Iconos de escritorio"	PLC_DesktopIconMorph clearIcons.	"PLC_ImageButtonMorph blackTheme."	PLC_ImageButtonMorph blueTheme.	"PLC_DesktopIconMorph screen1920x1080."	PLC_DesktopIconMorph screen800x600.	PLC_DesktopIconMorph createIcons.		"CAMBIAR FONDO EN PARO"	World backgroundImage: (		ImageReadWriter formFromFileNamed:  			'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , '/GUI_Images/Backgrounds/default.jpg'		) layout: #scaled.	"CANCELAR MENU WORD SIGUE ANDANDO CON ESC"	self hideDevelopTools.		"CAMBIAR LOGO DE PHARO SOBRE EL FONDO DE PHARO. 	Buscar el submorph de world y cambiarlo:"		"	World submorphs.	World submorphs size.	(World submorphs at: 1) image: (Form fromFileNamed: 'IDE4PLC_files/Locale/C/GUI_Images/Backgrounds/Logos.png').	"! !!IDE4PLC class methodsFor: 'Initialization' stamp: 'EricPernia 3/12/2016 19:23'!initializeIDE4PLC	"Esta clase inicializa todas las que usa el proyecto"		self clearAllInstances.		"Incicializo el diccionario del lenguaje de la GUI"	self setLanguage: PLC_Language esArUtf8.		self initializeGUI.! !!IDE4PLC class methodsFor: 'OS Config' stamp: 'EricPernia 5/18/2015 04:08'!linux	PLC_CIAA_FileSystem current linuxConfig.	PLC_CompilerAndWriter current linuxConfig.! !!IDE4PLC class methodsFor: 'Initialization' stamp: 'EricPernia 9/15/2015 16:27'!loadIDE4PLCDependences	"Esta clase inicializa todas las que usa el proyecto""			OS PROCESS			========="	"Ejecutar una vez"	Gofer it 	      squeaksource: 'MetacelloRepository';  	     package: 'ConfigurationOfOSProcess';   	    load.	"Ejecutar una vez"	(ConfigurationOfOSProcess project version: #stable) load.	"Ejecutar una vez"	OSProcess thisOSProcess stdOut.	"Ejecutar cada vez que quiero abrir algo, por ejemplo:"	"OSProcess command: 'calc'.""			 PETIT PARSER			=========="	"Pharo Smalltalk is the main development environment of PetitParser. 	To load the core library evaluate the following code:"	Gofer new	    renggli: 'petit'; 	    package: 'PetitParser';	    load.	"To get the full toolset, including a dedicated editor and some 	experimental tools, use the following Metacello script: 	(No funciona en Pharo 1.3)"	"Gofer new	    renggli: 'petit';	    package: 'ConfigurationOfPetitParser';	    load.	(Smalltalk at: #ConfigurationOfPetitParser)	    perform: #loadDefault."! !!IDE4PLC class methodsFor: 'OS Config' stamp: 'EricPernia 5/18/2015 04:07'!macOsX	PLC_CIAA_FileSystem current macOsXConfig.	PLC_CompilerAndWriter current macOsXConfig.! !!IDE4PLC class methodsFor: 'Services Device Editor' stamp: 'EricPernia 3/20/2016 20:44'!openDeviceEditor	| deviceEditor |		"Creo un nuevo editor - Para que cargue los cambios en la device"	deviceEditor := PLC_EditorDevices		newWithDevice: PLC_DevicePLC current		andColor: ( Color r: 1 g: 1 b: 1 alpha: 0.5 )  		andBorderColor: Color black 		andTitleColor:  PLC_GraphicElementProperties uniqueInstance programHeaderColor 		andTitleName: 'Editor Device -> Title' translated.			deviceEditor open.! !!IDE4PLC class methodsFor: 'Services Generate POU and C code' stamp: 'EricPernia 3/20/2016 19:18'!openPOUEditor	| pouEditor |		"Creo un nuevo editor de POU - Para que cargue los cambios en la pou"	pouEditor := PLC_EditorPOU 		newWithPOU: IDE4PLC pou		andColor: ( Color r: 1 g: 1 b: 1 alpha: 0.5 )  		andBorderColor: Color black 		andTitleColor:  PLC_GraphicElementProperties uniqueInstance programColor 		andTitleName: 'Editor POU -> Title' translated.			"Le asigno el editor"	PLC_DesktopIconMorph pou objetive: pouEditor.	PLC_DesktopIconMorph pou action: #open.			PLC_DesktopIconMorph pou doAction.! !!IDE4PLC class methodsFor: 'Services Generate POU and C code' stamp: 'EricPernia 11/19/2013 16:06'!pou	pou ifNil: [		pou := self createProgDecl.		].		^ pou! !!IDE4PLC class methodsFor: 'Services Generate POU and C code' stamp: 'EricPernia 11/19/2013 15:44'!pou: obj	pou := obj.! !!IDE4PLC class methodsFor: 'Services Save Remove' stamp: 'EricPernia 2/15/2016 01:25'!resetPou	pou := nil.		self openPOUEditor.! !!IDE4PLC class methodsFor: 'Services Save Remove' stamp: 'EricPernia 5/18/2015 15:08'!save	WorldState saveSession.! !!IDE4PLC class methodsFor: 'Services Save Remove' stamp: 'EricPernia 5/17/2015 19:44'!savePou	WorldState saveSession.! !!IDE4PLC class methodsFor: 'localization' stamp: 'EricPernia 3/12/2016 19:19'!setLanguage: aPLC_Language	"Cambia el idioma de la GUI"	NaturalLanguageTranslator current: aPLC_Language.! !!IDE4PLC class methodsFor: 'Self Modification' stamp: 'EricPernia 9/15/2015 16:42'!showDevelopTools	"Saca el menu World"	PasteUpMorph compile: 'handlesMouseDown: evt		^true.'.! !!IDE4PLC class methodsFor: 'Services Version' stamp: 'EricPernia 11/3/2016 01:48'!version	^ 'IDE4PLC v 1.0.5'! !!IDE4PLC class methodsFor: 'OS Config' stamp: 'EricPernia 5/18/2015 04:08'!windows	PLC_CIAA_FileSystem current windowsConfig.	PLC_CompilerAndWriter current windowsConfig.! !!IDE4PLCParsers class methodsFor: 'as yet unclassified' stamp: 'CarlosLombardi 9/22/2016 10:10'!idParser	"a parser for an identifier.		(letter | _) (letter | _ | digit)*"	| firstLetter subsequentLetters |	firstLetter := #letter asParser / $_ asParser .	subsequentLetters := #letter asParser / $_ asParser / #digit asParser.	^(firstLetter, subsequentLetters star) end flatten .		! !!IDE4PLCParsers class methodsFor: 'as yet unclassified' stamp: 'CarlosLombardi 9/22/2016 00:54'!literalBOOLParser	"a parser for a BOOL literal.		(BOOL#)?(true|false) "	| trueOrFalse boolType boolLiteral |	trueOrFalse := ('true' asParser ==> [:str | true]) / ('false' asParser  ==> [:str | false]).	boolType := 'BOOL#' asParser.	boolLiteral := (boolType optional , trueOrFalse) end ==> [ :nodes | 		PLC_Literal 						newWithDataType: PLC_DataType Bool						andDataValue: nodes second	] .	^boolLiteral! !!IDE4PLCParsers class methodsFor: 'as yet unclassified' stamp: 'CarlosLombardi 10/14/2016 20:51'!literalINTParser	"a parser for a INT literal, understood as signed integer.		(INT#)?integer "	| intType intLiteral |	intType := 'INT#' asParser.	intLiteral := (intType , BasicParsers integerNumber) end ==> [ :nodes | 		PLC_Literal			newWithDataType: PLC_DataType Int				andDataValue: nodes second 	] .	^intLiteral	! !!IDE4PLCParsers class methodsFor: 'as yet unclassified' stamp: 'CarlosLombardi 9/22/2016 11:11'!literalREALParser	"a parser for a REAL literal.		(REAL#)?real "	| realType realLiteral |	realType := 'REAL#' asParser.	realLiteral := (realType optional , BasicParsers realNumber) end ==> [ :nodes | 		PLC_Literal			newWithDataType: PLC_DataType Real				andDataValue: nodes second 	] .	^realLiteral! !!IDE4PLCParsers class methodsFor: 'as yet unclassified' stamp: 'CarlosLombardi 9/22/2016 01:14'!literalTIMEParser	"a parser for a TIME literal.		(TIME|T)#uinteger "	| timeType timeLiteral |	timeType := 'TIME#' asParser / 'T#' asParser.	timeLiteral := (timeType, BasicParsers naturalNumber) end ==> [ :nodes | 		PLC_Literal			newWithDataType: PLC_DataType Time			andDataValue: nodes second 	] .	^timeLiteral! !!IDE4PLCParsers class methodsFor: 'as yet unclassified' stamp: 'CarlosLombardi 10/15/2016 11:51'!unspecifiedIntegerParser	"a parser for an unsigned integer literal, with no specified type.		(INT#)?integer "	| intLiteral |	intLiteral := BasicParsers integerNumber end ==> [ :num | 		PLC_Literal			newWithDataType: PLC_DataType UnspecifiedInt 			andDataValue: num	] .	^intLiteral	! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 11/13/2010 02:44'!agregarBloque: unBloque	"Agrega un bloque a la lista bloques del modelo."	bloques add: unBloque.! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!bloques	^ bloques! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!bloques: anObject	bloques := anObject! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 11/26/2010 12:41'!bloquesDeSalida	"Devuelve una OrderedCollection de bloques de salida"	^self bloques select: [:bloque | bloque SosBloqueDeSalida].! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 11/26/2010 12:44'!bloquesDerivativos	"Devuelve una OrderedCollection de bloques derivativos"	^self bloques select: [:bloque | bloque SosBloqueDerivador].! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 8/8/2015 07:34'!borrate	"Borra los bloques graficos y los del modelo."		self morphs do: [ :m | m delete. ].		self morphs: OrderedCollection new. 	self bloques: Set new. ! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 12/1/2010 00:47'!crearVectorDeTiempo	"Creo los valores del vector de tiempo"		tiempo := ti to: tf by: dt.   "Objeto intervalo. Desde ti a tf con paso dt"! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!dt	^ dt! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!dt: anObject	dt := anObject! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 8/12/2015 00:58'!evaluarBloquesDeSalida. 	tiempo do: [ :t | 		self bloquesDeSalida do: [ :bloque | 			( (bloque conexionesDeEntrada first first) isNotNil )				ifTrue: [					bloque salida: 1 enTiempo: t.					^ true.					]				ifFalse: [ 					^ false.				].		]	].! !!Modelo methodsFor: 'initialize-release' stamp: 'EricPernia 8/8/2015 07:32'!initialize	"Crea las Ordered Collection."	bloques := Set new.	morphs := OrderedCollection new.! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 8/8/2015 07:23'!morphs	^ morphs! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 8/8/2015 07:23'!morphs: anObject	morphs := anObject! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 8/12/2015 01:08'!mostraOsciloscopioConNombre: aString	| osc graficoMorph |		graficoMorph := GraficoMorph unico.		( (bloques select: [:each | each nombre = aString ]) size >= 1 )		ifTrue: [ 						osc := (bloques select: [:each | each nombre = aString ]) asOrderedCollection first.						self halt.						(self simulate) 				ifTrue:  [ 					graficoMorph vincularCon: self salida: osc.					graficoMorph changed. 					graficoMorph position: 20@20.					graficoMorph openInWorld.				].				] .			! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 11/26/2010 12:49'!pasarElPasoALosBloquesDerivativos	self bloquesDerivativos do: [:bloqueDeriv | bloqueDeriv dt: self dt.].! !!Modelo methodsFor: 'acciones' stamp: 'EricPernia 8/12/2015 00:55'!simulate	"Corre la simulacion.	1 - Crea el vector de tiempos.	2 - Le pasa el dt a los bloques derivativos	3 - Le pide a cada bloque de salida su salida en el tiempo t."		self crearVectorDeTiempo.	self pasarElPasoALosBloquesDerivativos. 	^ self evaluarBloquesDeSalida. ! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!tf	^ tf! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!tf: anObject	tf := anObject! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!ti	^ ti! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!ti: anObject	ti := anObject! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!tiempo	^ tiempo! !!Modelo methodsFor: 'accessing' stamp: 'EricPernia 11/13/2010 02:42'!tiempo: anObject	tiempo := anObject! !!PLC_Aligns class methodsFor: 'instance creation' stamp: 'EricPernia 4/6/2012 17:39'!center	"Devuelve la nica instancia de alineacin central"		AlignsCreated ifFalse: [self createAligns].		^ Aligns at: #center! !!PLC_Aligns class methodsFor: 'instance creation' stamp: 'EricPernia 4/6/2012 17:19'!clearAligns	"Borra las alineaciones"	Aligns := Dictionary new.	AlignsCreated := false.	! !!PLC_Aligns class methodsFor: 'instance creation' stamp: 'EricPernia 7/14/2012 19:01'!createAligns	"Crea las 3 instancias nicas de alineaciones"	Aligns := Dictionary new.		Aligns at: #left put: PLC_LeftAlign new.	Aligns at: #center put: PLC_CenterAlign new.	Aligns at: #right put: PLC_RightAlign new.	AlignsCreated := true.! !!PLC_Aligns class methodsFor: 'class initialization' stamp: 'EricPernia 7/15/2013 02:22'!initialize	super initialize.	AlignsCreated ifNil: [		AlignsCreated := false		].! !!PLC_Aligns class methodsFor: 'instance creation' stamp: 'EricPernia 7/14/2012 19:02'!left	"Devuelve la nica instancia de alineacin izquierda"		AlignsCreated ifFalse: [self createAligns].		^ Aligns at: #left! !!PLC_Aligns class methodsFor: 'instance creation' stamp: 'EricPernia 7/14/2012 19:02'!right	"Devuelve la nica instancia de alineacin derecha"		AlignsCreated ifFalse: [self createAligns].		^ Aligns at: #right! !!PLC_CenterAlign methodsFor: 'style' stamp: 'EricPernia 6/27/2013 02:28'!inOutLineFor: aPLC_GraphicElementMorph	"Morph que representa la linea que continua el pin del tag in out."		^ aPLC_GraphicElementMorph leftInOutLine.! !!PLC_CenterAlign methodsFor: 'extent' stamp: 'EricPernia 7/6/2013 01:10'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Devuelve el tamao en pixeles del layoutRectangle	cuado tiene alineacin centrada."		^ aPLC_GraphicElementMorph centerLayoutRectangleExtent.! !!PLC_CenterAlign methodsFor: 'position' stamp: 'EricPernia 7/6/2013 01:09'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]	cuado tiene alineacin centrada."		^ aPLC_GraphicElementMorph centerLayoutRectanglePosition.! !!PLC_CenterAlign methodsFor: 'position' stamp: 'EricPernia 7/14/2012 19:10'!txtPositionXFor: aString in: aMorph.	"Devuelve la posicion horizontal (en x) de donde tiene que estar 	el string segun el tipo de alineacion"		^ ((aMorph extent x - aString asMorph extent x) / 2.0) rounded + aMorph position x.! !!PLC_CenterAlign methodsFor: 'style' stamp: 'EricPernia 6/14/2012 04:24'!underlineStyleWithColor: aColor andOrigin: anOrigin andDirection: aDirection	"Estilo del Morph subrrayado de la etiqueta. Tiene un color degradado."		^ PLC_GraphicElementProperties uniqueInstance 		centerUnderlineStyleWithColor: aColor 		andOrigin: anOrigin 		andDirection: aDirection.! !!PLC_LeftAlign methodsFor: 'style' stamp: 'EricPernia 6/27/2013 02:27'!inOutLineFor: aPLC_GraphicElementMorph	"Morph que representa la linea que continua el pin del tag in out."		^ aPLC_GraphicElementMorph leftInOutLine.! !!PLC_LeftAlign methodsFor: 'extent' stamp: 'EricPernia 7/6/2013 01:10'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Devuelve el tamao en pixeles del layoutRectangle	cuado tiene alineacin izquierda."		^ aPLC_GraphicElementMorph leftLayoutRectangleExtent.! !!PLC_LeftAlign methodsFor: 'position' stamp: 'EricPernia 7/6/2013 01:02'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]	cuado tiene alineacin izquierda."		^ aPLC_GraphicElementMorph leftLayoutRectanglePosition.! !!PLC_LeftAlign methodsFor: 'position' stamp: 'EricPernia 7/14/2012 19:10'!txtPositionXFor: aString in: aMorph.	"Devuelve la posicion horizontal (en x) de donde tiene que estar 	el string segun el tipo de alineacion"		^ aMorph position x + aMorph leftMargin.! !!PLC_LeftAlign methodsFor: 'style' stamp: 'EricPernia 6/14/2012 04:21'!underlineStyleWithColor: aColor andOrigin: anOrigin andDirection: aDirection	"Estilo del Morph subrrayado de la etiqueta. Tiene un color degradado."		^ PLC_GraphicElementProperties uniqueInstance 		leftUnderlineStyleWithColor: aColor 		andOrigin: anOrigin 		andDirection: aDirection! !!PLC_RightAlign methodsFor: 'style' stamp: 'EricPernia 6/27/2013 02:28'!inOutLineFor: aPLC_GraphicElementMorph	"Morph que representa la linea que continua el pin del tag in out."		^ aPLC_GraphicElementMorph rightInOutLine.! !!PLC_RightAlign methodsFor: 'extent' stamp: 'EricPernia 7/6/2013 01:11'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Devuelve el tamao en pixeles del layoutRectangle	cuado tiene alineacin derecha."		^ aPLC_GraphicElementMorph rightLayoutRectangleExtent.! !!PLC_RightAlign methodsFor: 'position' stamp: 'EricPernia 7/6/2013 01:03'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]	cuado tiene alineacin izquierda."		^ aPLC_GraphicElementMorph rightLayoutRectanglePosition.! !!PLC_RightAlign methodsFor: 'position' stamp: 'EricPernia 6/26/2013 00:17'!txtPositionXFor: aString in: aMorph.	"Devuelve la posicion horizontal (en x) de donde tiene que estar 	el string segun el tipo de alineacion"		^  (aMorph extent x - aString asMorph extent x) + aMorph position x - aMorph rightMargin.! !!PLC_RightAlign methodsFor: 'style' stamp: 'EricPernia 6/14/2012 04:23'!underlineStyleWithColor: aColor andOrigin: anOrigin andDirection: aDirection	"Estilo del Morph subrrayado de la etiqueta. Tiene un color degradado."		^ PLC_GraphicElementProperties uniqueInstance 		rightUnderlineStyleWithColor: aColor 		andOrigin: anOrigin 		andDirection: aDirection.! !!PLC_Assignments class methodsFor: 'instance creation' stamp: 'EricPernia 6/13/2013 15:59'!newWithFormalParameter: aFormalParameter andActtualArgument: anActualArgument 	"Crea una nueva instancia con los 2 operandos pasados como parametros"	| assignment |		assignment := self new.		assignment formalParameter: aFormalParameter.	assignment actualArgument: anActualArgument.		^ assignment.! !!PLC_Assignments class methodsFor: 'instance creation' stamp: 'EricPernia 11/7/2013 13:04'!newWithFormalParameter: aFormalParameter andActtualArgument: anActualArgument andPouCall: aPouCall	"Crea una nueva instancia con los 3 parametros"	| assignment |		assignment := self new.		assignment formalParameter: aFormalParameter.	assignment actualArgument: anActualArgument.	assignment pouCall: aPouCall.		^ assignment.! !!PLC_Assignments methodsFor: 'accessing' stamp: 'EricPernia 6/13/2013 15:59'!actualArgument	^ actualArgument! !!PLC_Assignments methodsFor: 'accessing' stamp: 'EricPernia 6/13/2013 15:59'!actualArgument: anObject	actualArgument := anObject! !!PLC_Assignments methodsFor: 'accessing' stamp: 'EricPernia 6/13/2013 15:59'!formalParameter	^ formalParameter! !!PLC_Assignments methodsFor: 'accessing' stamp: 'EricPernia 6/13/2013 15:59'!formalParameter: anObject	formalParameter := anObject! !!PLC_Assignments methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 11:10'!pouCall	^ pouCall! !!PLC_Assignments methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 11:10'!pouCall: anObject	pouCall := anObject! !!PLC_InOutAssignment methodsFor: 'library' stamp: 'EricPernia 6/11/2013 22:22'!keyword	"Devuelve el symbol del elemento"	^ #InOutAssignment ! !!PLC_InputAssignment methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 01:56'!cCompile	"Compila la declaracin de variable a C	Devuelve por ejemplo:		INST.IN = VAR		"		| cCode |			"Chequeo que Tenga algo asignado sino no lo compilo"	( self actualArgument dataType ~= PLC_DataType Void )		ifTrue: [ 						"Genero NombreInstancia"			cCode := self pouCall instanceOperand cCompile.			"Genero NombreInstancia.VarInterna"			cCode := cCode , '.' , self formalParameter identifier.				"Genero NombreInstancia.VarInterna = Argumento"			cCode := cCode  , ' = ' , self actualArgument cCompile.				^ cCode.						]		ifFalse: [ 			^ ''.			].! !!PLC_InputAssignment methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 01:56'!ilCompile	"Compila la declaracin de variable a IL	Devuelve por ejemplo:		IN := VAR		"	"Chequeo que Tenga algo asignado sino no lo compilo"	( self actualArgument dataType ~= PLC_DataType Void )		ifTrue: [ 			^ self formalParameter identifier , ' := ' , self actualArgument ilCompile.			]		ifFalse: [ 			^ ''.			].! !!PLC_InputAssignment methodsFor: 'library' stamp: 'EricPernia 6/11/2013 22:22'!keyword	"Devuelve el symbol del elemento"	^ #InputAssignment ! !!PLC_OutputAssignment methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 01:56'!cCompile	"Compila la declaracin de variable a C	Devuelve por ejemplo:		VAR = INST.IOUT	"		| cCode |	"Chequeo que Tenga algo asignado sino no lo compilo"	( self actualArgument dataType ~= PLC_DataType Void )		ifTrue: [ 						"Genero NombreInstancia"			cCode := self pouCall instanceOperand cCompile.			"Genero NombreInstancia.VarInterna"			cCode := cCode , '.' , self formalParameter identifier.				"Genero Argumento = NombreInstancia.VarInterna"			cCode := self actualArgument cCompile , ' = ' , cCode.				^ cCode.						]		ifFalse: [ 			^ ''.			].! !!PLC_OutputAssignment methodsFor: 'compilation' stamp: 'EricPernia 3/25/2016 17:52'!cCompileFormalParameter	"Compila el parametro formal de la declaracin de variable a C	Devuelve por ejemplo:		INST.IOUT	"		| cCode |	"Genero NombreInstancia"	cCode := self pouCall instanceOperand cCompile.	"Genero NombreInstancia.VarInterna"	cCode := cCode , '.' , self formalParameter identifier.	^ cCode.! !!PLC_OutputAssignment methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 01:56'!ilCompile	"Compila la declaracin de variable a IL	Devuelve por ejemplo:		OUT => VAR		"	"Chequeo que Tenga algo asignado sino no lo compilo"	( self actualArgument dataType ~= PLC_DataType Void )		ifTrue: [ 			^ self formalParameter identifier , ' => ' , self actualArgument ilCompile.			]		ifFalse: [ 			^ ''.			].! !!PLC_OutputAssignment methodsFor: 'library' stamp: 'EricPernia 6/11/2013 22:23'!keyword	"Devuelve el symbol del elemento"	^ #OutputAssignment ! !!PLC_CIAA_FileSystem class methodsFor: 'instance creation' stamp: 'EricPernia 5/7/2015 04:50'!clearInstance 	"Elimina la unica instancia de esta clase."	Instance ifNotNil: [		Instance := nil.	].! !!PLC_CIAA_FileSystem class methodsFor: 'instance creation' stamp: 'EricPernia 5/18/2015 02:59'!current 	"Devuelve la unica instancia de esta clase."	Instance ifNil: [		Instance := PLC_CIAA_FileSystem new.	].		^ Instance.! !!PLC_CIAA_FileSystem class methodsFor: 'instance creation' stamp: 'EricPernia 5/18/2015 02:35'!uniqueInstance 	"Devuelve la unica instancia de esta clase."	Instance ifNil: [		Instance := self new.	].		^ Instance.! !!PLC_CIAA_FileSystem methodsFor: 'filePaths' stamp: 'EricPernia 3/16/2016 19:55'!buildDownloadFile	"Devuelve el Path entero al archivo PLC_BuildDownload"		^ self scriptsPath , self ds , self os , self ds , 'PLC_BuildDownload', self scriptExtension.! !!PLC_CIAA_FileSystem methodsFor: 'filePaths' stamp: 'EricPernia 5/18/2015 02:12'!buildFile	"Devuelve el Path entero al archivo PLC_Build"		^ self scriptsPath , self ds , self os , self ds , 'PLC_Build', self scriptExtension.! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:34'!cCodePath		^ cCodePath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:33'!cCodePath: anObject		cCodePath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 3/25/2016 00:07'!cleanCFolders	"Elimina las carpetas del protecto y las crea vacias."	| working folder |	"Directorio de trabajo, en este caso IDE4PLC"	working := FileSystem disk workingDirectory.		"Creo la carpeta IDE4PLC/IDE4PLC_user_projects/plc_application, si exite primero borra la anterior"	folder := ( working / plcApplicationPath ).	( folder exists )		ifTrue: [			folder deleteAll.		].	folder createDirectory.		"Creo la carpeta Firmware/out/gen/plc_application/etc"	( working / etcPath ) createDirectory.	"Creo la carpeta Firmware/out/gen/plc_application/mak"	( working / makPath ) createDirectory.! !!PLC_CIAA_FileSystem methodsFor: 'filePaths' stamp: 'EricPernia 3/16/2016 19:55'!cleanFile	"Devuelve el Path entero al archivo PLC_Clean"		^ self scriptsPath , self ds , self os , self ds , 'PLC_Clean', self scriptExtension.! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 3/25/2016 00:25'!createCFolders	"Crea las carpetas del proyecto con FileSystem"	| working folder |	"Directorio de trabajo, en este caso IDE4PLC"	working := FileSystem disk workingDirectory.		"Creo la carpeta IDE4PLC/IDE4PLC_user_projects/plc_application, si exite primero borra la anterior"		folder := ( working / plcApplicationPath ).		( folder exists )		ifTrue: [						( (working / srcPath) exists )				ifTrue: [					GrowlMorph 						openWithLabel: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 label' translated						contents: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents1' translated , '' , 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents2' translated , plcApplicationPath asString.				]							ifFalse: [					GrowlMorph 						openWithLabel: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 label' translated						contents: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents2' translated , plcApplicationPath asString.				].					folder deleteAll.				].		folder createDirectory.			"Creo la carpeta Firmware/out/gen/plc_application/etc"	( working / etcPath ) createDirectory.	"Creo la carpeta Firmware/out/gen/plc_application/inc"	( working / incPath ) createDirectory.	"Creo la carpeta Firmware/out/gen/plc_application/mak"	( working / makPath ) createDirectory.	"Creo la carpeta Firmware/out/gen/plc_application/src"	( working / srcPath ) createDirectory.! !!PLC_CIAA_FileSystem methodsFor: 'filePaths' stamp: 'EricPernia 5/18/2015 02:12'!downloadFile	"Devuelve el Path entero al archivo PLC_Download"		^ self scriptsPath , self ds , self os , self ds , 'PLC_Download', self scriptExtension.! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 5/18/2015 02:53'!ds	"devuelve un string con el separador de carpeta. 	La llame asi por el $(DS) de makefile que te reemplaza por \ o /"	^ self folderSeparator! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!etcPath		^ etcPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!etcPath: anObject		etcPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!firmwarePath		^ firmwarePath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!firmwarePath: anObject		firmwarePath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 5/17/2015 22:50'!folderSeparator	"devuelve un string con el separador de carpeta"	(os = 'windows')		ifTrue: [			^ '\'.			]		ifFalse: [			^ '/'.			].! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!genPath		^ genPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!genPath: anObject		genPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!guiImagesPath		^ guiImagesPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!guiImagesPath: anObject		guiImagesPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!ilExportPath		^ ilExportPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!ilExportPath: anObject		ilExportPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!incPath		^ incPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!incPath: anObject		incPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'initialize-release' stamp: 'EricPernia 5/18/2015 02:17'!initialize 	"Inicializaciones"		"Por default la carpeta Firmware est en la misma que IDE4PLC 	dentro de la cual est el working directory de Pharo"		firmwarePath := '..' , self ds , 'Firmware'.				"Por default inicia para windows"	os := 'windows'.		"Inicializo o refrezco los dems si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		! !!PLC_CIAA_FileSystem methodsFor: 'unix' stamp: 'EricPernia 7/14/2016 01:11'!linuxConfig 	"Configuro los Paths para linux"		"Por default inicia para windows"	os := 'linux'.		"Por default la carpeta Firmware est en la misma que IDE4PLC 	dentro de la cual est el working directory de Pharo"		firmwarePath := '..' , self ds ,  '..' , self ds , 'Firmware'.				"Inicializo o refrezco los demas si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		"Path a los scripts que compilan y bajan a la placa"	scriptsPath := 'shared' , self ds , 'IDE4PLC_files' , self ds , 'Boards' , 		self ds , PLC_DevicePLC current deviceName , self ds , 'Scripts'.! !!PLC_CIAA_FileSystem methodsFor: 'unix' stamp: 'EricPernia 5/18/2015 17:57'!macOsXConfig 	"Configuro los Paths para MAC"			"Por default inicia para windows"	os := 'macOsX'.		"Por default la carpeta Firmware est en la misma que IDE4PLC 	dentro de la cual est el working directory de Pharo"		firmwarePath := '..' , self ds ,  '..' , self ds , 'Firmware'.			"Inicializo o refrezco los dems si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!makPath		^ makPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!makPath: anObject		makPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!os		^ os! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!os: anObject		os := anObject! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!osekGenPath		^ osekGenPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!osekGenPath: anObject		osekGenPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!plcApplicationPath		^ plcApplicationPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!plcApplicationPath: anObject		plcApplicationPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 3/16/2016 20:05'!refreshPaths 	"Refresca los Paths en base a la ubicacion de la carpeta Firmware y del sistema operativo"		"Path gen del CIAA Firmware"	genPath := firmwarePath , self ds , 'out' , self ds , 'gen'.	"Ruta de plc_application"	plcApplicationPath := 'IDE4PLC_user_projects' , self ds , 'plc_application'.		"Ruta de src donde pone todos los .c generados, 	como genera necesita la / al final, los copiados no"	srcPath := plcApplicationPath , self ds , 'src' , self ds.	"Ruta de inc donde pone todos los .h generados"	incPath := plcApplicationPath , self ds , 'inc' , self ds.		"Ruta de destino del plc_application.oil"	etcPath := plcApplicationPath , self ds , 'etc'.	"Ruta destino de Makefile"	makPath := plcApplicationPath , self ds , 'mak'.		"Path a los archivos que tiene que copiar Makefile y plc_application.oil"	cCodePath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'C_Code'.		"Path a los archivos que tiene que copiar de OSEK, los que se generan a partir del .oil"	osekGenPath := cCodePath , self ds , 'osekGen'.		"Path a los scripts que compilan y bajan a la placa"	scriptsPath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'Scripts'.		"Path a las imagenes de la GUI"	guiImagesPath :=  'IDE4PLC_files' , self ds , 'GUI_Images'. 		"Path a donde genera IL"	ilExportPath := 'IL_Export'.! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 5/18/2015 02:14'!scriptExtension	"devuelve un string con el tipo de archivo de script de windows"	(os = 'windows')ifTrue: [			^ self windowsScript.		]		ifFalse: [			^ self unixScript.		].! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!scriptsPath		^ scriptsPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!scriptsPath: anObject		scriptsPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!srcPath		^ srcPath! !!PLC_CIAA_FileSystem methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 02:22'!srcPath: anObject		srcPath := anObject! !!PLC_CIAA_FileSystem methodsFor: 'unix' stamp: 'EricPernia 5/18/2015 02:14'!unixScript	"devuelve un string con el tipo de archivo de script de unix"	^ '.sh'.! !!PLC_CIAA_FileSystem methodsFor: 'windows' stamp: 'EricPernia 5/18/2015 17:57'!windowsConfig 	"Configuro los Paths para windows"			"Por default inicia para windows"	os := 'windows'.		"Por default la carpeta Firmware est en la misma que IDE4PLC 	dentro de la cual est el working directory de Pharo"		firmwarePath := '..' , self ds , 'Firmware'.			"Inicializo o refrezco los dems si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		! !!PLC_CIAA_FileSystem methodsFor: 'windows' stamp: 'EricPernia 5/17/2015 22:46'!windowsScript	"devuelve un string con el tipo de archivo de script de windows"	^ '.bat'.! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 11/1/2013 17:01'!write: aString in: filePathString in: fileNameString 	"Graba el string aString en el archivo de texto cuya ruta es filePathString y nombre de archivo fileNameString"	| stream |		"forceNewFileNamed: Crea un nuevo archivo con el nombre dado, 	y devuelve un stream abierto para escritura en ese archivo. 	Si el archivo ya existe lo borra sin preguntar."	stream := StandardFileStream forceNewFileNamed:  filePathString , fileNameString.		stream nextPutAll: aString.	stream cr.	stream close.! !!PLC_CalledPOU methodsFor: 'add - remove' stamp: 'EricPernia 11/15/2013 16:38'!addStandardFunctionBlocks: aPOUDeclsOrderedCollection	"Aade las declaraciones que le llegan como una Ordered Collection"		self standardFunctionBlocks addAll: aPOUDeclsOrderedCollection asSet.! !!PLC_CalledPOU methodsFor: 'add - remove' stamp: 'EricPernia 11/15/2013 18:25'!addStandardFunctions: aPOUDeclsOrderedCollection	"Aade las declaraciones que le llegan como una Ordered Collection"		self standardFunctions addAll: aPOUDeclsOrderedCollection asSet.! !!PLC_CalledPOU methodsFor: 'add - remove' stamp: 'EricPernia 11/15/2013 16:38'!addUserFunctionBlocks: aPOUDeclsOrderedCollection	"Aade las declaraciones que le llegan como una Ordered Collection"		self userFunctionBlocks addAll: aPOUDeclsOrderedCollection asSet.! !!PLC_CalledPOU methodsFor: 'add - remove' stamp: 'EricPernia 11/15/2013 16:39'!addUserFunctions: aPOUDeclsOrderedCollection	"Aade las declaraciones que le llegan como una Ordered Collection"		self userFunctions addAll: aPOUDeclsOrderedCollection asSet.! !!PLC_CalledPOU methodsFor: 'add - remove' stamp: 'EricPernia 11/8/2013 12:56'!addUserPrograms: aPOUCallsOrderedCollection	"Aade las declaraciones de programas a rtir de los llamados a programas que	 le llegan como una Ordered Collection"		| pouDecls |		pouDecls := aPOUCallsOrderedCollection collect: [ :each | 		each declaration.		].	self userPrograms addAll: pouDecls asSet.! !!PLC_CalledPOU methodsFor: 'initialize-release' stamp: 'EricPernia 11/8/2013 12:43'!initialize	"Inicializo las colecciones, son set para evitar repetidos."	standardFunctions := Set new.	userFunctions := Set new.		standardFunctionBlocks := Set new.	userFunctionBlocks := Set new.		standardPrograms := Set new.	userPrograms := Set new.! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!standardFunctionBlocks		^ standardFunctionBlocks! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!standardFunctionBlocks: anObject		standardFunctionBlocks := anObject! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!standardFunctions		^ standardFunctions! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!standardFunctions: anObject		standardFunctions := anObject! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!standardPrograms		^ standardPrograms! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!standardPrograms: anObject		standardPrograms := anObject! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!userFunctionBlocks		^ userFunctionBlocks! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!userFunctionBlocks: anObject		userFunctionBlocks := anObject! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!userFunctions		^ userFunctions! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!userFunctions: anObject		userFunctions := anObject! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!userPrograms		^ userPrograms! !!PLC_CalledPOU methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 12:43'!userPrograms: anObject		userPrograms := anObject! !!PLC_CPU class methodsFor: 'accessing' stamp: 'EricPernia 9/1/2012 19:19'!firstCheckFlag_BORRAME	^ FirstCheckFlag_BORRAME! !!PLC_CPU class methodsFor: 'accessing' stamp: 'EricPernia 9/1/2012 19:19'!firstCheckFlag_BORRAME: anObject	FirstCheckFlag_BORRAME := anObject! !!PLC_CPU class methodsFor: 'instance creation' stamp: 'EricPernia 11/7/2013 21:50'!lpc1769	"Devuelve una instancia de PLC PLeriC"	| cpu |		cpu := self new.		cpu identifier: 'NXP_LPC1769_Microcontroller'.		^ cpu.! !!PLC_CPU class methodsFor: 'instance creation' stamp: 'EricPernia 9/2/2015 00:10'!nxpLpc4337	"Devuelve una instancia de CPU LPC4337"	| cpu |		cpu := self new.		cpu identifier: 'NXP_LPC4337_Microcontroller'.		^ cpu.! !!PLC_CPU methodsFor: 'accessing' stamp: 'EricPernia 7/28/2012 01:57'!currentResult	^ currentResult! !!PLC_CPU methodsFor: 'accessing' stamp: 'EricPernia 7/28/2012 01:57'!currentResult: anObject	currentResult := anObject! !!PLC_CPU methodsFor: 'initialize-release' stamp: 'EricPernia 11/7/2013 21:49'!initialize	"Inicializaciones"		stack := 0.	stackPointer := 0.	programCounter := 0.	currentResult := 0.! !!PLC_CPU methodsFor: 'accessing' stamp: 'EricPernia 7/28/2012 01:57'!programCounter	^ programCounter! !!PLC_CPU methodsFor: 'accessing' stamp: 'EricPernia 7/28/2012 01:57'!programCounter: anObject	programCounter := anObject! !!PLC_CPU methodsFor: 'accessing' stamp: 'EricPernia 7/28/2012 01:57'!stack	^ stack! !!PLC_CPU methodsFor: 'accessing' stamp: 'EricPernia 7/28/2012 01:57'!stack: anObject	stack := anObject! !!PLC_CPU methodsFor: 'accessing' stamp: 'EricPernia 7/28/2012 01:57'!stackPointer	^ stackPointer! !!PLC_CPU methodsFor: 'accessing' stamp: 'EricPernia 7/28/2012 01:57'!stackPointer: anObject	stackPointer := anObject! !!PLC_ClassWithIdentifier class methodsFor: 'class initialization' stamp: 'EricPernia 11/9/2012 16:17'!initialize	"inicializacion de la clase"	self invalidIdentifiers: OrderedCollection new.	self invalidIdentifiers add: 'Isertar_Identificador'.		self repeatableIdentifiers: OrderedCollection new.		self repeatableIdentifiers add: 'EN'.	self repeatableIdentifiers add: 'ENO'.		self repeatableIdentifiers add: 'IN'.	self repeatableIdentifiers add: 'IN0'.	self repeatableIdentifiers add: 'IN1'.	self repeatableIdentifiers add: 'IN2'.	self repeatableIdentifiers add: 'IN3'.	self repeatableIdentifiers add: 'IN4'.	self repeatableIdentifiers add: 'IN5'.		self repeatableIdentifiers add: 'OUT'.	self repeatableIdentifiers add: 'OUT0'.	self repeatableIdentifiers add: 'OUT1'.	self repeatableIdentifiers add: 'OUT2'.	self repeatableIdentifiers add: 'OUT3'.	self repeatableIdentifiers add: 'OUT4'.	self repeatableIdentifiers add: 'OUT5'.		self repeatableIdentifiers add: 'RetVal'.	self repeatableIdentifiers add: 'N'.	self repeatableIdentifiers add: 'G'.	self repeatableIdentifiers add: 'K'.	self repeatableIdentifiers add: 'MN'.	self repeatableIdentifiers add: 'MX'.		self repeatableIdentifiers add: 'Q'.	self repeatableIdentifiers add: 'Q1'.	self repeatableIdentifiers add: 'QU'.	self repeatableIdentifiers add: 'QD'.	self repeatableIdentifiers add: 'S'.	self repeatableIdentifiers add: 'S1'.	self repeatableIdentifiers add: 'R'.	self repeatableIdentifiers add: 'R1'.	self repeatableIdentifiers add: 'LD'.	self repeatableIdentifiers add: 'CLK'.	self repeatableIdentifiers add: 'CU'.	self repeatableIdentifiers add: 'CD'.	self repeatableIdentifiers add: 'CV'.	self repeatableIdentifiers add: 'PV'.	self repeatableIdentifiers add: 'PT'.	self repeatableIdentifiers add: 'ET'.				! !!PLC_ClassWithIdentifier class methodsFor: 'accessing' stamp: 'EricPernia 10/31/2012 02:31'!invalidIdentifiers	^ invalidIdentifiers! !!PLC_ClassWithIdentifier class methodsFor: 'accessing' stamp: 'EricPernia 10/31/2012 02:31'!invalidIdentifiers: anObject	invalidIdentifiers := anObject! !!PLC_ClassWithIdentifier class methodsFor: 'instance creation' stamp: 'EricPernia 10/31/2012 02:32'!newWithName: aString	"Crea una nueva instancia con el nombre aString"	| temp |		temp := self new.	temp identfier: aString.		self invalidIdentifiers add: aString.		^ temp.! !!PLC_ClassWithIdentifier class methodsFor: 'accessing' stamp: 'EricPernia 11/9/2012 15:36'!repeatableIdentifiers	^ repeatableIdentifiers! !!PLC_ClassWithIdentifier class methodsFor: 'accessing' stamp: 'EricPernia 11/9/2012 15:37'!repeatableIdentifiers: anObject	repeatableIdentifiers := anObject! !!PLC_ClassWithIdentifier methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 00:23'!identifier	identifier		ifNil: [			^ 'Insertar_Identificador'			] 		ifNotNil: [			^ identifier.			].! !!PLC_ClassWithIdentifier methodsFor: 'accessing' stamp: 'EricPernia 5/10/2013 14:46'!identifier: aString	| oldIdentifier |	identifier := aString.	"oldIdentifier := self identifier."		"Chequeo que no sea un identificador repetido."	"( self class invalidIdentifiers includes: aString )		ifTrue: [			self error: 'Identificador utilizado, elija otro.'			] 		ifFalse: ["						"Valido el identificador"			"identifier := ( PLC_Identifier validatePLCIdentifier: aString )."				"Aca toco la clase. Ver si est bien."			"( oldIdentifier =  'Isertar_Identificador' )				ifFalse: [					self class invalidIdentifiers remove: oldIdentifier. 					]. ""Remuevo el viejo identificador de los identificadores ya utilizados"						"(self class repeatableIdentifiers includes: aString )				ifFalse: [					self class invalidIdentifiers add: aString."" Aado el nuevo identificador de los identificadores ya utilizados"				"	].			]."	! !!PLC_DataType class methodsFor: 'GUI information' stamp: 'EricPernia 5/31/2013 21:40'!AllDataTypeNameStrings	"Devuelve una coleccion de todos los nombres de los tipos de datos."	| col | 		col := self AllDataTypeNames.		^ col collect: [ :each|		each asString.		].! !!PLC_DataType class methodsFor: 'InformationForLiterals' stamp: 'EricPernia 5/31/2013 21:38'!AllDataTypeNames	"Devuelve una coleccion de todos los nombres de los tipos de datos."	^ self AnyDataType acceptedDataTypes.! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:47'!AnyBit	"Retorna la unica instancia del tipo genrico PLC_AnyBit"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_BIT.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:47'!AnyDataType	"Retorna la unica instancia del tipo genrico AnyDataType"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:45'!AnyDate	"Retorna la unica instancia del tipo genrico AnyDate"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_DATE.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:44'!AnyDerived	"Retorna la unica instancia del tipo genrico AnyDerived"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_DERIVED.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:44'!AnyElementary	"Retorna la unica instancia del tipo genrico AnyElementary"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_ELEMENTARY.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:44'!AnyInteger	"Retorna la unica instancia del tipo genrico AnyInteger"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_INT.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:44'!AnyMagnitude	"Retorna la unica instancia del tipo genrico AnyMagnitude"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_MAGNITUDE.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:44'!AnyNumeric	"Retorna la unica instancia del tipo genrico AnyNumeric"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_NUM.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:44'!AnyReal	"Retorna la unica instancia del tipo genrico AnyReal"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_REAL.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 5/1/2012 00:43'!AnyString	"Retorna la unica instancia del tipo genrico AnyString"	TypesCreated ifFalse: [self createDataTypes].		^ GenericDataTypes at: #ANY_STRING.		"Jerarquia de tipos genricos:AnyDataType	AnyDerived	AnyElementary		AnyMagnitude			AnyNumeric				AnyReal				AnyInteger		PLC_AnyBit		AnyString		AnyDate"! !!PLC_DataType class methodsFor: 'InformationForLiterals' stamp: 'EricPernia 5/6/2012 22:37'!BitStringDataTypesNames	"Devuelve una coleccion de los Nombres de tipo de dato Bit String"	^ self AnyBit acceptedDataTypes.! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:43'!Bool	"Retorna la unica instancia del tipo Bool"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #BOOL.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:43'!Byte	"Retorna la unica instancia del tipo Byte"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #BYTE.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:43'!DInt	"Retorna la unica instancia del tipo DInt"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #DINT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"	! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:43'!DT	"Retorna la unica instancia del tipo DateAndTime"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #DT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:43'!DWord	"Retorna la unica instancia del tipo DWord"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #DWORD.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:43'!Date	"Retorna la unica instancia del tipo Date"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #DATE.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:43'!DateAndTime	"Retorna la unica instancia del tipo DateAndTime"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #DATE_AND_TIME.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!Int	"Retorna la unica instancia del tipo Int"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #INT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"	! !!PLC_DataType class methodsFor: 'InformationForLiterals' stamp: 'EricPernia 5/6/2012 17:10'!IntegerDataTypesNames	"Devuelve una coleccion de los Nombres de tipo de dato enteros"	^ self AnyInteger acceptedDataTypes.! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!LInt	"Retorna la unica instancia del tipo LInt"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #LINT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"	! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!LReal	"Retorna la unica instancia del tipo LReal"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #LREAL.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!LWord	"Retorna la unica instancia del tipo LWord"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #LWORD.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!Real	"Retorna la unica instancia del tipo Real"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #REAL.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'InformationForLiterals' stamp: 'EricPernia 5/6/2012 17:10'!RealDataTypesNames	"Devuelve una coleccion de los Nombres de tipo de dato reales"	^ self AnyReal acceptedDataTypes.! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!SInt	"Retorna la unica instancia del tipo SInt"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #SINT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!String	"Retorna la unica instancia del tipo String"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #STRING.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!TOD	"Retorna la unica instancia del tipo TimeOfDay"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #TOD.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!Time	"Retorna la unica instancia del tipo Time"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #TIME.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:42'!TimeOfDay	"Retorna la unica instancia del tipo TimeOfDay"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #TIME_OF_DAY.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:41'!UDInt	"Retorna la unica instancia del tipo UDInt"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #UDINT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:41'!UInt	"Retorna la unica instancia del tipo UInt"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #UINT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:41'!ULInt	"Retorna la unica instancia del tipo ULInt"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #ULINT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 5/1/2012 00:41'!USInt	"Retorna la unica instancia del tipo USInt"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #USINT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'CarlosLombardi 10/15/2016 11:35'!UnspecifiedInt	"Retorna la unica instancia del tipo Unspecified Int"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #UNSP_INT.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 6/14/2013 02:29'!Void	"Retorna la unica instancia del tipo Void"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #VOID.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 4/30/2012 23:10'!WString	"Retorna la unica instancia del tipo WString"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #WSTRING.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 4/30/2012 23:10'!Word	"Retorna la unica instancia del tipo Word"	TypesCreated ifFalse: [self createDataTypes].		^ ElementaryDataTypes at: #WORD.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'DerivedDataTypes' stamp: 'EricPernia 6/16/2013 18:01'!addDerivedDataType: aUserDefinedDataType	"Aade un tipo de dato definido por el usuario, por ahora solo tengo tipos estructurados.	Tambien lo usa el compilador de Ladder."	| symbolIdentifier |		symbolIdentifier := aUserDefinedDataType keyword.		DerivedDataTypes at: symbolIdentifier put: aUserDefinedDataType.! !!PLC_DataType class methodsFor: 'instance creation' stamp: 'EricPernia 5/31/2013 14:11'!allDataTypes	"Retorna el diccionario de tipos por defecto junto con el de los tipos definidos por el usuario"		DerivedDataTypes.		^ self. "HACERRRRRRRRRRRRRRRRRRRRRRRRRRRRRR"! !!PLC_DataType class methodsFor: 'instance creation' stamp: 'EricPernia 5/31/2013 14:02'!clearTypes	"Borra los tipos de datos"	ElementaryDataTypes := Dictionary new.	GenericDataTypes := Dictionary new.		DerivedDataTypes := Dictionary new.		TypesCreated := false.		! !!PLC_DataType class methodsFor: 'instance creation' stamp: 'EricPernia 4/30/2012 23:03'!createDataTypes	"Crea los tipos de datos"			ElementaryDataTypes := Dictionary new.	GenericDataTypes := Dictionary new.		self createElementaryDataTypes. 	self createGenericDataTypes. 		TypesCreated := true.! !!PLC_DataType class methodsFor: 'instance creation' stamp: 'CarlosLombardi 10/15/2016 11:35'!createElementaryDataTypes	"Crea los tipos de datos elementales"	| typeTemp |		"Bit strings"		typeTemp := PLC_Void new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_Boolean new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_Byte new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_Word new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_DoubleWord new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_LongWord new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.	"Unspecified Integer"	typeTemp := PLC_UnspecifiedInteger new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		"Signed Integers"		typeTemp := PLC_ShortInteger new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_Integer new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_DoubleInteger new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_LongInteger new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		"Unsigned Integers"		typeTemp := PLC_UnsignedShortInteger new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_UnsignedInteger new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_UnsignedDoubleInteger new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp :=  PLC_UnsignedLongInteger new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		"Reals"		typeTemp := PLC_Real new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_LongReal new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		"Character Strings"		typeTemp := PLC_SingleByteString new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp :=  PLC_DoubleByteString new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		"Time and date"		typeTemp := PLC_Duration new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp :=  PLC_Date new.	ElementaryDataTypes at: typeTemp keyword put: typeTemp.		typeTemp := PLC_TimeOfDay new.	ElementaryDataTypes at: (typeTemp keywords at: 1) put: typeTemp.	ElementaryDataTypes at: (typeTemp keywords at: 2) put: typeTemp.		typeTemp :=  PLC_DateAndTimeOfDay new.	ElementaryDataTypes at: (typeTemp keywords at: 1) put: typeTemp.	ElementaryDataTypes at: (typeTemp keywords at: 2) put: typeTemp.! !!PLC_DataType class methodsFor: 'instance creation' stamp: 'EricPernia 4/30/2012 23:00'!createGenericDataTypes	"Crea los tipos de datos Genericos. 	Estan tabulados jerarquicamente, no tiene nada que ver con los mensajes entre los objetos."	| typeTemp |		typeTemp := PLC_AnyDataType new.	GenericDataTypes at: typeTemp keyword put: typeTemp.			typeTemp := PLC_AnyDerived new.		GenericDataTypes at: typeTemp keyword put: typeTemp.			typeTemp := PLC_AnyElementary new.		GenericDataTypes at: typeTemp keyword put: typeTemp.				typeTemp := PLC_AnyMagnitude new.			GenericDataTypes at: typeTemp keyword put: typeTemp.					typeTemp := PLC_AnyNumeric new.				GenericDataTypes at: typeTemp keyword put: typeTemp.									typeTemp := PLC_AnyReal new.					GenericDataTypes at: typeTemp keyword put: typeTemp.					typeTemp := PLC_AnyInteger new.					GenericDataTypes at: typeTemp keyword put: typeTemp.									typeTemp := PLC_AnyBit new.			GenericDataTypes at: typeTemp keyword put: typeTemp.						typeTemp := PLC_AnyString new.			GenericDataTypes at: typeTemp keyword put: typeTemp.						typeTemp := PLC_AnyDate new.			GenericDataTypes at: typeTemp keyword put: typeTemp.	! !!PLC_DataType class methodsFor: 'GUI information' stamp: 'EricPernia 5/2/2015 15:57'!dataTypeFromString: aString	"Devuelve un tipo de datos si lo encuentra en sus diccionarios."	| dataTypeKey | 		dataTypeKey := aString asUppercase asSymbol.		"Si asigno alguno de estos se cuelga, buscar la causa."	( #(#STRING #DT #DATE #TIME_OF_DAY #DATE_AND_TIME #TOD #VOID #TIME #WSTRING) includes: dataTypeKey )		ifTrue: [ ^ nil. ].		"Busco en el diccionario de tipos elementales"	( self elementaryDataTypes keys includes: dataTypeKey )		ifTrue: [			^ self elementaryDataTypes at: dataTypeKey.		].		"falta que busque en derived y generic data types"		"Si no encuentra devuelve nil"	^ nil.! !!PLC_DataType class methodsFor: 'DerivedDataTypes' stamp: 'EricPernia 5/31/2013 16:10'!derivedDataTypes	"Retorna el diccionario de tipos"		^ DerivedDataTypes.! !!PLC_DataType class methodsFor: 'ElementaryDataTypes' stamp: 'EricPernia 4/30/2012 23:01'!elementaryDataTypes	"Retorna el diccionario de tipos"		^ ElementaryDataTypes.		"Bool Byte Word DWord LWord SInt Int DInt LInt USInt UInt UDInt ULInt Real LReal String WString Time Date TimeOfDay TOD DateAndTime DT"! !!PLC_DataType class methodsFor: 'GenericDataTypes' stamp: 'EricPernia 10/31/2012 18:14'!genericDataTypes	"Retorna el diccionario de tipos"		^ GenericDataTypes.! !!PLC_DataType class methodsFor: 'class initialization' stamp: 'EricPernia 4/25/2012 16:06'!initialize	super initialize.	TypesCreated := false! !!PLC_DataType class methodsFor: 'DerivedDataTypes' stamp: 'EricPernia 5/31/2013 16:09'!removeAllDerivedDataTypes	"Borra todos los tipos derivados."	DerivedDataTypes := Dictionary new.! !!PLC_DataType methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:38'!accept: aSymbol	"Devuelve un booleano que indica si acepta el tipo de datos que le llega como parametro aSymbol"	^ self acceptedDataTypes includes: aSymbol.! !!PLC_DataType methodsFor: 'types' stamp: 'EricPernia 1/25/2014 22:41'!acceptType: aPLC_DataType	"Devuelve un booleano que indica si acepta el tipo de datos que le llega como parametrol"	^ self = aPLC_DataType.		"^ self acceptedDataTypes includes: aPLC_DataType keyword."! !!PLC_DataType methodsFor: 'wired' stamp: 'EricPernia 1/23/2014 00:35'!acceptWire	"Responde true si el tipo de datos puede cablearse en 	un lenguaje grfico si es utilizado como pin de una POU.	No tiene sentido en los lenguajes textuales."	^ false.! !!PLC_DataType methodsFor: 'compilation' stamp: 'EricPernia 6/16/2013 21:32'!cCompile	"Compila a C"	^ self cCompileDataType.! !!PLC_DataType methodsFor: 'compilation' stamp: 'EricPernia 6/16/2013 21:32'!cCompileDataType	"Compila a C"	^ 'PLC_' , self keyword asString.! !!PLC_DataType methodsFor: 'coercion' stamp: 'CarlosLombardi 10/14/2016 21:29'!canCoerce: aValue to: aDataType	"whether it is possible for a literal of this type having the specified value, 	 to be coerced to the given type"	^false	! !!PLC_DataType methodsFor: 'types' stamp: 'EricPernia 8/11/2012 19:39'!dataType 	"Devuelve el nombre del tipo de dato."	^ self keyword asString , ': ' , self description.! !!PLC_DataType methodsFor: 'compilation' stamp: 'EricPernia 6/16/2013 21:32'!ilCompile	"Compila a IL"	^ self ilCompileDataType.! !!PLC_DataType methodsFor: 'compilation' stamp: 'EricPernia 6/16/2013 19:03'!ilCompileDataType	"Compila a IL"	^ self keyword asString.! !!PLC_DataType methodsFor: 'testing' stamp: 'CarlosLombardi 10/15/2016 10:51'!isPLCIntegerType	"whether I represent an integer type"	^false! !!PLC_DataType methodsFor: 'testing' stamp: 'CarlosLombardi 10/15/2016 10:52'!isPLCSignedType	"whether I represent an numerical signed type"	^false! !!PLC_DataType methodsFor: 'testing' stamp: 'CarlosLombardi 10/15/2016 11:07'!isPLCUnspecifiedType	"whether I represent the temporary type assigned to a literal whose precise type	 is to be unspecified "	^false! !!PLC_DerivedDataType methodsFor: 'types' stamp: 'EricPernia 6/16/2013 22:15'!acceptValue: aValue	"Devuelve un booleano que indica si el tipo de datos acepta la constante que se le queire asignar"	^ aValue structDecl = self.! !!PLC_DerivedDataType methodsFor: 'types' stamp: 'EricPernia 4/25/2012 21:42'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^ {self keyword.}.! !!PLC_DerivedDataType methodsFor: 'accessing' stamp: 'EricPernia 10/31/2012 18:10'!description	^ description! !!PLC_DerivedDataType methodsFor: 'accessing' stamp: 'EricPernia 10/31/2012 18:10'!description: anObject	description := anObject! !!PLC_DerivedDataType methodsFor: 'initialize-release' stamp: 'EricPernia 5/31/2013 18:22'!initialize	"Inicializa la declaracion de variable"		description := ''.	! !!PLC_DerivedDataType methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 19:55'!isDerivedDataType	"Devuelve un booleano respondiendo si es un tipo derivado"	^ true.! !!PLC_DerivedDataType methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 19:55'!isElementaryDataType	"Devuelve un booleano respondiendo si es un tipo elemental"	^ false.! !!PLC_DerivedDataType methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 19:55'!isGenericDataType	"Devuelve un booleano respondiendo si es un tipo genrico"	^ false.! !!PLC_DerivedDataType methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 22:28'!isStructDataType	"Devuelve un booleano respondiendo si es un tipo elemental"	^ false.! !!PLC_DerivedDataType methodsFor: 'types' stamp: 'EricPernia 5/31/2013 18:15'!keyword	"Devuelve el keyword del tipo de dato."	^ #TYPE! !!PLC_StructureDecl class methodsFor: 'instance creation' stamp: 'EricPernia 6/16/2013 17:15'!newWithIdentifier: ident 	"Nueva instancia con identificador ident."	| struct |		struct := self new.	struct identifier: ident.		^ struct.! !!PLC_StructureDecl methodsFor: 'collection' stamp: 'EricPernia 6/16/2013 17:19'!add: varDecl	"Aade una declaracion de variable a su colecccion de declaraciones"	self declarations add: varDecl.! !!PLC_StructureDecl methodsFor: 'collection' stamp: 'EricPernia 6/2/2013 08:08'!at: aNumber	"Devuelve una declaracion de variable a su colecccion de declaraciones en la posicion aNumber"	^ self declarations at: aNumber.! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 6/16/2013 20:47'!cCompile	"Compila la declaracin de tipo de dato estructurado a C como declaracion"	^ self cCompileWithoutInitialValue.! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 6/16/2013 19:06'!cCompileDataType	"Compila la declaracin de tipo de dato estructurado a C como tipo de datos"		^ self dataType.! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 21:42'!cCompileWithoutInitialValue	"Compila la declaracin de tipo de dato estructurado a C como declaracion	Devuelve:		struct nombreEstructura{		varDeclWithoutInitialValue ;		varDeclWithoutInitialValue ;		...		}	"	| structDec |		structDec := '', self dataType , '{'.			self declarations do: [ :each |		structDec := structDec , '			' , each cCompileWithoutInitialValue , ';'.		].			structDec := structDec , '		}'.		^ structDec.! !!PLC_StructureDecl methodsFor: 'types' stamp: 'EricPernia 6/16/2013 17:43'!dataType	"Devuelve su tipo de datos"		^ 'struct ' , self identifier.! !!PLC_StructureDecl methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 08:06'!declarations	^ declarations! !!PLC_StructureDecl methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 08:07'!declarations: anObject	declarations := anObject! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 6/2/2013 08:07'!identifierAt: aNumber	"Devuelve el identificador de la variable que contiene en el idice aNumber"	^ (self declarations at: aNumber ) identifier.! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 21:10'!ilCompile	"Compila la declaracin de tipo de dato estructurado a IL como declaracion	Devuelve:			NombreTipoStructura : 			STRUCT				varDecl ;				varDecl ;				...			END_STRUCT			"	| strucTypeDec |			strucTypeDec := '				STRUCT'.		self declarations do: [ :each |		strucTypeDec := strucTypeDec , '					' , each ilCompile , ';'.		].			strucTypeDec := strucTypeDec , '				END_STRUCT'.		^ strucTypeDec.! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 6/16/2013 19:06'!ilCompileDataType	"Compila la declaracin de tipo de dato estructurado a IL como tipo de datos"		^ self dataType.! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 6/20/2013 16:29'!ilCompileWithoutInitialValue	"Compila la declaracin de tipo de dato estructurado a IL como declaracion	Devuelve:			NombreTipoStructura : 			STRUCT				varDeclWithoutInitialValue ;				varDeclWithoutInitialValue ;				...			END_STRUCT			"	| strucTypeDec |			strucTypeDec := '		STRUCT'.		self declarations do: [ :each |		strucTypeDec := strucTypeDec , '			' , each ilCompileWithoutInitialValue , ';'.		].			strucTypeDec := strucTypeDec , '		END_STRUCT'.		^ strucTypeDec.! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 6/16/2013 21:14'!initialValue	"Devuelve el identificador de la variable que contiene en el idice aNumber"	^ PLC_StructureInitialization newWithStructDecl: self.! !!PLC_StructureDecl methodsFor: 'compilation' stamp: 'EricPernia 6/17/2013 00:13'!initialValue: aStructInitialization	"Devuelve el identificador de la variable que contiene en el idice aNumber"	( 1 to: self declarations size ) do: [ :index |		( self declarations at: index )			 initialValue: ( aStructInitialization values at: index ).		].! !!PLC_StructureDecl methodsFor: 'initialize-release' stamp: 'EricPernia 6/2/2013 08:10'!initialize	"Inicializaciones		declarations es una coleccion de objetos PLC_SimpleSymbolicVarDecl"	super initialize.	declarations := OrderedCollection new.! !!PLC_StructureDecl methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 19:55'!isDerivedDataType	"Devuelve un booleano respondiendo si es un tipo derivado"	^ true.! !!PLC_StructureDecl methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 19:55'!isElementaryDataType	"Devuelve un booleano respondiendo si es un tipo elemental"	^ false.! !!PLC_StructureDecl methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 19:55'!isGenericDataType	"Devuelve un booleano respondiendo si es un tipo genrico"	^ false.! !!PLC_StructureDecl methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 22:30'!isStructDataType	"Devuelve un booleano respondiendo si es un tipo elemental"	^ true.! !!PLC_StructureDecl methodsFor: 'types' stamp: 'EricPernia 6/16/2013 19:29'!keyword	"Devuelve el keyword del tipo de dato."	^ self identifier asSymbol.! !!PLC_StructureDecl methodsFor: 'collection' stamp: 'EricPernia 6/2/2013 08:08'!remove: aSimpleSymbolicVarDecl	"Remueve una declaracion de variable a su colecccion de declaraciones"	self declarations remove: aSimpleSymbolicVarDecl.! !!PLC_TypeDecl class methodsFor: 'instance creation' stamp: 'EricPernia 11/5/2013 12:43'!newWithDataType: type andIdentifier: ident 	"cNueva isntancia con tipo de datos type e identificador ident."	| typedef |		typedef := self new.		typedef dataType: type.	typedef identifier: ident.		"Aado el nuevo tipo de datos al dicccionario de tipos 	de datos Dervidados o Creados por el usuario"	PLC_DataType addDerivedDataType: typedef.		^ typedef.! !!PLC_TypeDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 21:41'!cCompile	"Compila la declaracin de tipo de dato estructurado a C	Devuelve:		typedef dataType dataName;	"		^ '		typedef ' , 		dataType cCompile , 		' ' , 		self identifier , ';'.! !!PLC_TypeDecl methodsFor: 'compilation' stamp: 'EricPernia 6/21/2013 19:08'!cCompileDataType	"Compila a C"	^ self identifier.! !!PLC_TypeDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 21:40'!cCompileWithoutInitialValue	"Compila la declaracin de tipo de dato estructurado a C	Devuelve:		typedef dataType dataName;	"		^ '		typedef ' , 		dataType cCompileWithoutInitialValue , 		' ' , self identifier , ';'.! !!PLC_TypeDecl methodsFor: 'accessing' stamp: 'EricPernia 6/15/2013 14:38'!dataType		^ dataType! !!PLC_TypeDecl methodsFor: 'accessing' stamp: 'EricPernia 6/15/2013 14:38'!dataType: anObject		dataType := anObject! !!PLC_TypeDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 21:11'!ilCompile	"Compila la declaracin de tipo de dato estructurado a IL	Devuelve:		TYPE		dataName : dataType ;	END_TYPE		"		| type |		type :=  '		TYPE			' , 	self identifier ,	' : '.		( self dataType isStructDataType )		ifTrue: [ 			type := type ,''.			].		type := type ,		self dataType ilCompile , 		' ;' ,		'		END_TYPE'.	^ type. ! !!PLC_TypeDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 21:11'!ilCompileWithoutInitialValue	"Compila la declaracin de tipo de dato estructurado a IL	Devuelve:		TYPE		dataName : dataType ;	END_TYPE		"		| type |		type :=  '		TYPE	' , 	self identifier ,	' : '.		( self dataType isStructDataType )		ifTrue: [ 			type := type ,''.			].		type := type ,		self dataType ilCompileWithoutInitialValue , 		' ;' ,		'		END_TYPE'.	^ type. ! !!PLC_TypeDecl methodsFor: 'Data Types' stamp: 'EricPernia 6/17/2013 00:58'!initialValue	"Devuelve el valor inicial del tipo de dato."	^ self dataType initialValue.! !!PLC_TypeDecl methodsFor: 'Data Types' stamp: 'EricPernia 6/16/2013 17:58'!keyword	"Devuelve el keyword del tipo de dato."	^ self identifier asSymbol.! !!PLC_BitStrings methodsFor: 'types' stamp: 'EricPernia 8/11/2012 19:47'!description	"Devuelve la descripcin del tipo de dato."	^ 'Cadena de bits de longitud ' , self bitSize asString , '.'.! !!PLC_BitStrings methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:31'!maxValue	"Valor mximo permitido del tipo de dato."	| N |		N := self bitSize.		^ (2 raisedTo: N) - 1.! !!PLC_BitStrings methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:30'!minValue	"Valor mnimo permitido del tipo de dato."		^ 0.! !!PLC_Boolean methodsFor: 'testing' stamp: 'EricPernia 9/2/2012 19:30'!acceptValue: aValue	"Devuelve un booleano que indica si el tipo de datos acepta la constante que se le queire asignar"	^ aValue = true or: [ aValue = false ].! !!PLC_Boolean methodsFor: 'wired' stamp: 'EricPernia 9/13/2013 17:08'!acceptWire	"Responde true si el tipo de datos puede cablearse en un lenguaje grfico si es utilizado como pin de una POU.	No riene sentido en los lenguajes textuales."	^ true.! !!PLC_Boolean methodsFor: 'types' stamp: 'EricPernia 3/2/2012 19:26'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 1.! !!PLC_Boolean methodsFor: 'types' stamp: 'EricPernia 8/11/2012 20:02'!description	"Devuelve la descripcin del tipo de dato."	^ 'Booleano, ' ,  self range asString.! !!PLC_Boolean methodsFor: 'types' stamp: 'EricPernia 6/16/2013 21:35'!initialValue	"Devuelve el valor inicial del tipo de dato."		^ PLC_Literal newWithDataType: self andDataValue: false.! !!PLC_Boolean methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:51'!keyword	"Devuelve el keyword del tipo de dato."	^ #BOOL.! !!PLC_Boolean methodsFor: 'types' stamp: 'EricPernia 4/25/2012 13:36'!range	"Devuelve el rango de representacion del tipo de dato."	^ '0 o 1, o bien, TRUE o FALSE'.! !!PLC_Byte methodsFor: 'types' stamp: 'EricPernia 3/3/2012 15:53'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 8.! !!PLC_Byte methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:52'!keyword	"Devuelve el keyword del tipo de dato."	^ #BYTE.! !!PLC_DoubleWord methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:25'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 32.! !!PLC_DoubleWord methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:56'!keyword	"Devuelve el keyword del tipo de dato."	^ #DWORD.! !!PLC_LongWord methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:25'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 64.! !!PLC_LongWord methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:57'!keyword	"Devuelve el keyword del tipo de dato."	^ #LWORD.! !!PLC_Word methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:25'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 16.! !!PLC_Word methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:56'!keyword	"Devuelve el keyword del tipo de dato."	^ #WORD.! !!PLC_Date methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:21'!keyword	"Devuelve el keyword del tipo de dato."	^ #DATE.! !!PLC_DateAndTimeOfDay methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:31'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^ self keywords.! !!PLC_DateAndTimeOfDay methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:31'!keyword	"Devuelve el keyword del tipo de dato."	^ self keywords at:2.! !!PLC_DateAndTimeOfDay methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:31'!keywords	"Devuelve los keywords del tipo de dato."	^ {#DT. #DATE_AND_TIME.}.! !!PLC_TimeOfDay methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:32'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^ self keywords.! !!PLC_TimeOfDay methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:32'!keyword	"Devuelve el keyword del tipo de dato."	^ self keywords at:2.! !!PLC_TimeOfDay methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:32'!keywords	"Devuelve los keywords del tipo de dato."	^ {#TOD. #TIME_OF_DAY.}.! !!PLC_ElementaryDataType methodsFor: 'types' stamp: 'EricPernia 1/26/2014 05:09'!acceptValue: aValue	"Devuelve un booleano que indica si el tipo de datos acepta la constante que se le queire asignar"	aValue isInteger 		ifTrue: [ ^ aValue between: self minValue and: self maxValue. ] 		ifFalse: [ ^ false ].! !!PLC_ElementaryDataType methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:24'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^ {self keyword.}.! !!PLC_ElementaryDataType methodsFor: 'types' stamp: 'EricPernia 6/16/2013 20:55'!initialValue	"Devuelve el valor inicial del tipo de dato."		^ PLC_Literal newWithDataType: self andDataValue: 0.! !!PLC_ElementaryDataType methodsFor: 'testing' stamp: 'EricPernia 4/25/2012 14:22'!isDerivedDataType	"Devuelve un booleano respondiendo si es un tipo derivado"	^ false.! !!PLC_ElementaryDataType methodsFor: 'testing' stamp: 'EricPernia 4/25/2012 14:22'!isElementaryDataType	"Devuelve un booleano respondiendo si es un tipo elemental"	^ true.! !!PLC_ElementaryDataType methodsFor: 'testing' stamp: 'EricPernia 4/25/2012 14:22'!isGenericDataType	"Devuelve un booleano respondiendo si es un tipo genrico"	^ false.! !!PLC_ElementaryDataType methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 22:28'!isStructDataType	"Devuelve un booleano respondiendo si es un tipo elemental"	^ false.! !!PLC_ElementaryDataType methodsFor: 'testing' stamp: 'EricPernia 8/12/2012 00:08'!range	"Devuelve el rango de representacion del tipo de dato."	^ self minValue asString , ' a ' , self maxValue asString.! !!PLC_LongReal methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:26'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 64.! !!PLC_LongReal methodsFor: 'types' stamp: 'EricPernia 8/12/2012 00:22'!description	"Devuelve la descripcin del tipo de dato."	^ 'Real largo.'.! !!PLC_LongReal methodsFor: 'types' stamp: 'EricPernia 4/25/2012 17:23'!keyword	"Devuelve el keyword del tipo de dato."	^ #LREAL.! !!PLC_LongReal methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:51'!maxPositiveValue	"Valor mximo positivo permitido del tipo de dato."			^ 1.7976931348623157e308.! !!PLC_LongReal methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:51'!minPositiveValue	"Valor mnimo positivo permitido del tipo de dato."			^ 2.2250738585072020e-308.! !!PLC_Real methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:27'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 32.! !!PLC_Real methodsFor: 'types' stamp: 'EricPernia 8/12/2012 00:22'!description	"Devuelve la descripcin del tipo de dato."	^ 'Real.'.! !!PLC_Real methodsFor: 'types' stamp: 'EricPernia 4/25/2012 17:22'!keyword	"Devuelve el keyword del tipo de dato."	^ #REAL.! !!PLC_Real methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:50'!maxPositiveValue	"Valor mximo positivo permitido del tipo de dato."			^ 3.4028235e38.! !!PLC_Real methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:50'!minPositiveValue	"Valor mnimo positivo permitido del tipo de dato."			^ 1.175494351e-38.! !!PLC_Reals methodsFor: 'types' stamp: 'EricPernia 1/26/2014 05:14'!acceptValue: aValue	"Devuelve un booleano que indica si el tipo de datos acepta la constante que se le queire asignar"	aValue isFloat 		ifTrue: [ ^ aValue abs between: 0.0 and: self maxPositiveValue.] 		ifFalse: [ ^ false ].		"Estrictamente seria:^ aValue abs between: self minPositiveValue and: self maxPositiveValue."! !!PLC_Reals methodsFor: 'types' stamp: 'EricPernia 6/16/2013 20:56'!initialValue	"Devuelve el valor inicial del tipo de dato."		^ PLC_Literal newWithDataType: self andDataValue: 0.0.! !!PLC_Reals methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:49'!maxNegativeValue	"Valor mximo negativo permitido del tipo de dato."		^ self maxPositiveValue negated.! !!PLC_Reals methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:49'!minNegativeValue	"Valor mnimo negativo permitido del tipo de dato."			^ self minPositiveValue negated.! !!PLC_Reals methodsFor: 'types' stamp: 'EricPernia 8/12/2012 01:10'!range	"Devuelve el rango de representacion del tipo de dato."	^ self maxNegativeValue asString , ' a ' , self minNegativeValue asString , ' y de ' , self minPositiveValue asString , ' a ' , self maxPositiveValue asString.! !!PLC_DoubleInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:27'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 32.! !!PLC_DoubleInteger methodsFor: 'types' stamp: 'EricPernia 8/11/2012 23:48'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero doble.'.! !!PLC_DoubleInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:15'!keyword	"Devuelve el keyword del tipo de dato."	^ #DINT.! !!PLC_Duration methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:20'!keyword	"Devuelve el keyword del tipo de dato."	^ #TIME.! !!PLC_Integer methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:27'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 16.! !!PLC_Integer methodsFor: 'types' stamp: 'EricPernia 8/11/2012 23:48'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero.'.! !!PLC_Integer methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:14'!keyword	"Devuelve el keyword del tipo de dato."	^ #INT.! !!PLC_LongInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:27'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 64.! !!PLC_LongInteger methodsFor: 'types' stamp: 'EricPernia 8/11/2012 23:48'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero largo.'.! !!PLC_LongInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:16'!keyword	"Devuelve el keyword del tipo de dato."	^ #LINT.! !!PLC_ShortInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:28'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 8.! !!PLC_ShortInteger methodsFor: 'types' stamp: 'EricPernia 8/11/2012 23:49'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero corto.'.! !!PLC_ShortInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:15'!keyword	"Devuelve el keyword del tipo de dato."	^ #SINT.! !!PLC_SignedIntegers methodsFor: 'testing' stamp: 'CarlosLombardi 10/15/2016 10:51'!isPLCIntegerType	"whether I represent an integer type"	^true! !!PLC_SignedIntegers methodsFor: 'testing' stamp: 'CarlosLombardi 10/15/2016 10:52'!isPLCSignedType	"whether I represent an numerical signed type"	^true! !!PLC_SignedIntegers methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:31'!maxValue	"Valor mximo permitido del tipo de dato."	| N |		N := self bitSize.		^ (2 raisedTo: (N - 1)) - 1! !!PLC_SignedIntegers methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:31'!minValue	"Valor mnimo permitido del tipo de dato."	| N |		N := self bitSize.		^ (2 raisedTo: (N - 1)) negated.! !!PLC_UnspecifiedInteger methodsFor: 'types' stamp: 'CarlosLombardi 10/14/2016 21:10'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 32.! !!PLC_UnspecifiedInteger methodsFor: 'coercion' stamp: 'CarlosLombardi 10/15/2016 10:56'!canCoerce: aValue to: aDataType	"whether it is possible for a literal of this type having the specified value, 	 to be coerced to the given type"	^aDataType isPLCIntegerType & ((aValue >= 0) | aDataType isPLCSignedType not)	! !!PLC_UnspecifiedInteger methodsFor: 'types' stamp: 'CarlosLombardi 10/14/2016 21:10'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero sin especificar.'.! !!PLC_UnspecifiedInteger methodsFor: 'testing' stamp: 'CarlosLombardi 10/15/2016 11:06'!isPLCUnspecifiedType	"whether I represent the temporary type assigned to a literal whose precise type	 is to be unspecified "	^true! !!PLC_UnspecifiedInteger methodsFor: 'types' stamp: 'CarlosLombardi 10/14/2016 21:13'!keyword	"Devuelve el keyword del tipo de dato."	^ #UNSP_INT.! !!PLC_UnspecifiedInteger methodsFor: 'coercion' stamp: 'CarlosLombardi 10/15/2016 11:05'!typeToCoerce: aValue to: aDataType	"the data type to coerce the specified value to the given type"	^aDataType 	! !!PLC_DoubleByteString methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:10'!keyword	"Devuelve el keyword del tipo de dato."	^ #WSTRING.! !!PLC_SingleByteString methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:10'!keyword	"Devuelve el keyword del tipo de dato."	^ #STRING.! !!PLC_UnsignedDoubleInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:31'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 32.! !!PLC_UnsignedDoubleInteger methodsFor: 'types' stamp: 'EricPernia 8/11/2012 20:18'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero doble sin signo.'.! !!PLC_UnsignedDoubleInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:17'!keyword	"Devuelve el keyword del tipo de dato."	^ #UDINT.! !!PLC_UnsignedInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:31'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 16.! !!PLC_UnsignedInteger methodsFor: 'types' stamp: 'EricPernia 8/11/2012 20:18'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero sin signo.'.! !!PLC_UnsignedInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:49'!keyword	"Devuelve el keyword del tipo de dato."	^ #UINT.! !!PLC_UnsignedIntegers methodsFor: 'testing' stamp: 'CarlosLombardi 10/15/2016 10:53'!isPLCIntegerType	"whether I represent an integer type"	^true! !!PLC_UnsignedIntegers methodsFor: 'types' stamp: 'EricPernia 4/26/2012 00:31'!maxValue	"Valor mximo permitido del tipo de dato."	| N |		N := self bitSize.		^ (2 raisedTo: N) - 1.! !!PLC_UnsignedIntegers methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:44'!minValue	"Valor mnimo permitido del tipo de dato."	^ 0.! !!PLC_UnsignedLongInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:32'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 64.! !!PLC_UnsignedLongInteger methodsFor: 'types' stamp: 'EricPernia 8/11/2012 20:19'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero largo sin signo.'.! !!PLC_UnsignedLongInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:19'!keyword	"Devuelve el keyword del tipo de dato."	^ #ULINT.! !!PLC_UnsignedShortInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 23:32'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 8.! !!PLC_UnsignedShortInteger methodsFor: 'types' stamp: 'EricPernia 8/11/2012 20:19'!description	"Devuelve la descripcin del tipo de dato."	^ 'Entero corto sin signo.'.! !!PLC_UnsignedShortInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 15:18'!keyword	"Devuelve el keyword del tipo de dato."	^ #USINT.! !!PLC_Void methodsFor: 'types' stamp: 'EricPernia 6/14/2013 02:27'!acceptValue: aValue	"Devuelve un booleano que indica si el tipo de datos acepta la constante que se le queire asignar"	^ false! !!PLC_Void methodsFor: 'types' stamp: 'EricPernia 6/14/2013 02:22'!bitSize	"Devuelve el tamao del tipo de dato en cantidad de bits."	^ 0.! !!PLC_Void methodsFor: 'types' stamp: 'EricPernia 6/14/2013 02:22'!description	"Devuelve la descripcin del tipo de dato."	^ 'Vaco.'.! !!PLC_Void methodsFor: 'types' stamp: 'EricPernia 6/16/2013 21:36'!initialValue	"Devuelve el valor inicial del tipo de dato."		^ PLC_Literal newWithDataType: self andDataValue: nil.! !!PLC_Void methodsFor: 'types' stamp: 'EricPernia 6/14/2013 02:22'!keyword	"Devuelve el keyword del tipo de dato."	^ #VOID.! !!PLC_Void methodsFor: 'types' stamp: 'EricPernia 6/14/2013 02:28'!maxValue	"Valor mnimo permitido del tipo de dato."	^ 'NULL'! !!PLC_Void methodsFor: 'types' stamp: 'EricPernia 6/14/2013 02:28'!minValue	"Valor mnimo permitido del tipo de dato."	^ 'NULL'! !!PLC_AnyBit methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType Bool acceptedDataTypes ,		PLC_DataType Byte acceptedDataTypes ,		PLC_DataType Word acceptedDataTypes ,		PLC_DataType DWord acceptedDataTypes , 		PLC_DataType LWord acceptedDataTypes.! !!PLC_AnyBit methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:34'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_BIT.! !!PLC_AnyDataType methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType AnyDerived acceptedDataTypes ,		PLC_DataType AnyElementary acceptedDataTypes.! !!PLC_AnyDataType methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:25'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY.! !!PLC_AnyDate methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType Date acceptedDataTypes , 		PLC_DataType DateAndTime acceptedDataTypes , 		PLC_DataType TimeOfDay acceptedDataTypes.! !!PLC_AnyDate methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:33'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_DATE.! !!PLC_AnyDerived methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados.	En este caso devuelve todos los tipos de datos creados por el	uduario."	^ PLC_DataType derivedDataTypes keys.! !!PLC_AnyDerived methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:33'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_DERIVED.! !!PLC_AnyElementary methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType AnyMagnitude acceptedDataTypes ,		PLC_DataType AnyBit acceptedDataTypes ,		PLC_DataType AnyString acceptedDataTypes ,		PLC_DataType AnyDate acceptedDataTypes.		! !!PLC_AnyElementary methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:33'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_ELEMENTARY.! !!PLC_AnyInteger methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType SInt acceptedDataTypes , 				PLC_DataType Int acceptedDataTypes ,			PLC_DataType DInt acceptedDataTypes ,		PLC_DataType LInt acceptedDataTypes ,		PLC_DataType USInt acceptedDataTypes ,				PLC_DataType UInt acceptedDataTypes ,		PLC_DataType UDInt acceptedDataTypes ,		PLC_DataType ULInt acceptedDataTypes.! !!PLC_AnyInteger methodsFor: 'types' stamp: 'EricPernia 4/25/2012 19:45'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_INT.! !!PLC_AnyMagnitude methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType AnyNumeric acceptedDataTypes ,		PLC_DataType Time acceptedDataTypes.		! !!PLC_AnyMagnitude methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:36'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_MAGNITUDE.! !!PLC_AnyNumeric methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType AnyInteger acceptedDataTypes ,		PLC_DataType AnyReal acceptedDataTypes.! !!PLC_AnyNumeric methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:36'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_NUM.! !!PLC_AnyReal methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType Real acceptedDataTypes ,			PLC_DataType LReal acceptedDataTypes. ! !!PLC_AnyReal methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:39'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_REAL.! !!PLC_AnyString methodsFor: 'types' stamp: 'EricPernia 11/5/2013 12:43'!acceptedDataTypes	"Devuelve un Array que contiene la lista de los tipos aceptados"	^	PLC_DataType String acceptedDataTypes ,		PLC_DataType WString acceptedDataTypes.! !!PLC_AnyString methodsFor: 'types' stamp: 'EricPernia 4/25/2012 14:34'!keyword	"Devuelve el keyword del tipo de dato."	^ #ANY_STRING.! !!PLC_GenericDataType methodsFor: 'testing' stamp: 'EricPernia 4/25/2012 13:53'!isDerivedDataType	"Devuelve un booleano respondiendo si es un tipo derivado"	^ false.! !!PLC_GenericDataType methodsFor: 'testing' stamp: 'EricPernia 4/25/2012 13:53'!isElementaryDataType	"Devuelve un booleano respondiendo si es un tipo elemental"	^ false.! !!PLC_GenericDataType methodsFor: 'testing' stamp: 'EricPernia 4/25/2012 13:53'!isGenericDataType	"Devuelve un booleano respondiendo si es un tipo genrico"	^ true.! !!PLC_GenericDataType methodsFor: 'testing' stamp: 'EricPernia 6/16/2013 22:28'!isStructDataType	"Devuelve un booleano respondiendo si es un tipo elemental"	^ false.! !!PLC_ActualArgument methodsFor: 'accessing' stamp: 'EricPernia 9/7/2013 02:02'!actualArgument	^ actualArgument! !!PLC_ActualArgument methodsFor: 'accessing' stamp: 'EricPernia 9/7/2013 02:02'!actualArgument: anObject	actualArgument := anObject! !!PLC_ActualArgument methodsFor: 'connectableBlocks' stamp: 'CarlosLombardi 11/19/2016 17:57'!addInput	"Agrega una entrada al elemento."	"la salida solo es usada para conectar el argumento al elemento que lo tiene como argumento,	 por eso le dejo nil como valor"	self inputs add: nil "PLC_VoidOperand new".! !!PLC_ActualArgument methodsFor: 'connectableBlocks' stamp: 'CarlosLombardi 11/19/2016 17:57'!addOutput	"Agrega una salida al elemento."		"la salida solo es usada para conectar el argumento al elemento que lo tiene como argumento,	 por eso le dejo nil como valor"	self outputs add: nil "PLC_VoidOperand new".! !!PLC_ActualArgument methodsFor: 'checking' stamp: 'CarlosLombardi 10/16/2016 10:22'!check: rawOperand in: aPLC_ConnectableBlock	"I check the given raw operand. The result of the check is an operand as well. 	 It could be either:	 - the same raw operand, if I can accept it as is.	 - a specified operand, if the raw operand is not fully specified and I can find a way	   to make it complete.	 - an error operand, if I reject the raw operand						   ______ 	 			   |		  | 				   |		  |		  raw  --|	     |--  			 	   |______|		"		| varDecl errorText operand |	"If the rawOperand is already an error, just return it"		rawOperand isError ifTrue: [ ^rawOperand ].	operand := rawOperand.	errorText := nil.			"Obtengo la declaracin del parametro correspondiente a este argumento"	varDecl := self parameterDeclIn: aPLC_ConnectableBlock .	"posible transformacion"	(operand canBeCoercedTo: varDecl dataType) ifTrue: [ 		operand := operand coercedTo: varDecl dataType 	] .	errorText := self typeError: operand ifAssignedTo: varDecl .	"veo si hubo algun error"	errorText ifNotNil: [ :text | 		operand := PLC_ErrorOperand new 			dataValue: operand asSimpleString ; 			errorText: errorText ; 			yourself ] .			"fin"	^ operand! !!PLC_ActualArgument methodsFor: 'connectableBlocks' stamp: 'EricPernia 9/7/2013 02:06'!connectionToAddElement: aPLC_ElemenMorph inBlock: aPLC_ConnectableBlock	"Devuelve la conexion para aadirle un nuevo elemento."	| connectableBlock |		"Busco el contacto, bobina o bloque conectado al actual argument"	connectableBlock := aPLC_ConnectableBlock blockConnectedToOutput: 1.		"Le pido la conexion para aadirle un nuevo elemento"	^ connectableBlock element connectionToAddElement: aPLC_ElemenMorph inBlock: connectableBlock.! !!PLC_ActualArgument methodsFor: 'graphic element' stamp: 'CarlosLombardi 10/29/2016 11:25'!graphicElementFor: aConnectableBlock	"Devuelve el Elemento grafico (Morph)."	| argumentMorph |	argumentMorph := PLC_ActualArgumentMorph		newWithText: self actualArgument identifier		andContainer: aConnectableBlock connectableBlocksNetwork controller view.	^ argumentMorph			"	M = PLC_ConnectableBlocksNetwork	V = PLC_LadderView	C = PLC_LadderController	"! !!PLC_ActualArgument methodsFor: 'initialize-release' stamp: 'CarlosLombardi 11/19/2016 18:33'!initialize	"Inicializaciones"	super initialize.		self actualArgument: PLC_VoidOperand new.	self rememberOriginalArgument .! !!PLC_ActualArgument methodsFor: 'testing' stamp: 'EricPernia 9/7/2013 02:02'!isActualArgumentReader	"Devuelve true si el elemento es una ActualArgumentReader."	^ false.! !!PLC_ActualArgument methodsFor: 'testing' stamp: 'EricPernia 9/7/2013 02:02'!isActualArgumentWriter	"Devuelve true si el elemento es una ActualArgumentWriter."	^ false.! !!PLC_ActualArgument methodsFor: 'library' stamp: 'EricPernia 9/7/2013 02:03'!keyword	"Devuelve el symbol del elemento"	^ #ActualArgument! !!PLC_ActualArgument methodsFor: 'accessing' stamp: 'CarlosLombardi 11/19/2016 18:29'!originalArgument	^ originalArgument! !!PLC_ActualArgument methodsFor: 'accessing' stamp: 'CarlosLombardi 11/19/2016 18:29'!originalArgument: anObject	originalArgument := anObject! !!PLC_ActualArgument methodsFor: 'accessing' stamp: 'CarlosLombardi 11/19/2016 18:32'!rememberOriginalArgument	"I remember my current actual argument as original argument"	self originalArgument: self actualArgument	! !!PLC_ActualArgument methodsFor: 'accessing' stamp: 'CarlosLombardi 11/19/2016 18:31'!restoreOriginalArgument	"I restore the actual argument that I had when was created "	self originalArgument ifNotNil: [:orig | self actualArgument: orig ]	! !!PLC_ActualArgument methodsFor: 'checking' stamp: 'CarlosLombardi 10/16/2016 10:27'!typeError: operand ifAssignedTo: varDecl	"I do the typechecking corresponding to the assignment	   varDecl := operand	 and return the resulting error message, a String.	 If the operand passes the typecheck, then I return nil "		| errorText |	errorText := nil .  "I make this explicit"		(errorText isNil & (varDecl dataType acceptType: operand dataType) not)		ifTrue: [ errorText := 'Tipos incompatibles' ].			^errorText! !!PLC_ActualArgumentReader methodsFor: 'accept' stamp: 'EricPernia 9/14/2013 02:39'!accept: anOperand in: aPLC_ConnectableBlock	"Devuelve true acepta el operando que le llega como parmetro.	Necesito pasarle el bloque conectable para que pueda moverse 	a travs de las conexiones.				   ______ 	 			   |		  | 				   |		  |	anOperand  --|	        |--  			 	   |______|		"		anOperand isPLCLiteral		ifTrue: [ ^ self acceptLiteral: anOperand in: aPLC_ConnectableBlock ].		anOperand isVariable		ifTrue: [ ^ self acceptVariable: anOperand in: aPLC_ConnectableBlock ].		anOperand isStructItem 		ifTrue: [ ^ self acceptStructItem: anOperand in: aPLC_ConnectableBlock ].		anOperand isVoid		ifTrue: [ ^ true ].! !!PLC_ActualArgumentReader methodsFor: 'accept' stamp: 'CarlosLombardi 10/2/2016 23:35'!acceptLiteral: aLiteralOperand in: aPLC_ConnectableBlock	"Devuelve true acepta el operando que le llega como parmetro"	"				   ______ 	 			   |		  | 				   |		  |		   10  --|	     |--  			 	   |______|		"		| varDecl |		"Obtengo la declaracin del parametro correspondiente a este argumento"	varDecl := self parameterDeclIn: aPLC_ConnectableBlock .		"CHEQUEO - Le pregunto a la variable si acepta el valor y el tipo del literal.	Le pregunta tambien a su categoria: >>acceptLiteral"	^ ( varDecl acceptLiteral: aLiteralOperand )! !!PLC_ActualArgumentReader methodsFor: 'accept' stamp: 'EricPernia 9/14/2013 02:36'!acceptStructItem: aStructItemOperand in: aPLC_ConnectableBlock	"Devuelve true acepta el operando que le llega como parmetro"	"							   ______ 	 						   |		  | 							   |		  |	VAR_STRUCT.VAR_ITEM  --|	        |--  						 	   |______|		"		"Hacer chequeos que faltan"	^ false.! !!PLC_ActualArgumentReader methodsFor: 'accept' stamp: 'CarlosLombardi 10/2/2016 23:36'!acceptVariable: aVariableOperand in: aPLC_ConnectableBlock	"Devuelve true acepta el operando que le llega como parmetro				   ______ 	 			   |		  | 				   |		  |	     VAR  --|	    |--  			 	   |______|		"		"Hacer chequeos que faltan"	| varDecl |		"1 - PRIEMER CHEQUEO - Chequea si la varaible que quiero asignar puede leerse o no.	Si no puede, sale, si puede sigue chequeando."	( self canReadVariable: aVariableOperand )		ifFalse: [ ^ false ].		"Obtengo el parametro correspondiente a este argumento"	varDecl := self parameterDeclIn: aPLC_ConnectableBlock .			"2 - SEGUNDO CHEQUEO - Le pregunto a la variable si acepta el tipo de aVariableOperand.	Si da falso ya sale y sino hace el segundo chequeo"	^ varDecl acceptVariable: aVariableOperand.! !!PLC_ActualArgumentReader methodsFor: 'accept' stamp: 'EricPernia 9/14/2013 03:08'!canReadVariable: aVariableOperand	"Devuelve true si la variable (operando) que le llega como parmetro tiene permiso de lectura"		^ ( aVariableOperand declaration variableCategory varType ~= '_OUTPUT' )! !!PLC_ActualArgumentReader methodsFor: 'initialize-release' stamp: 'CarlosLombardi 11/19/2016 17:54'!initialize	"Inicializaciones"	super initialize.		"this is needed only to connect the argument reader with the element having this as argument,	 the actual object pointed by the output is never used"	self addOutput .! !!PLC_ActualArgumentReader methodsFor: 'testing' stamp: 'EricPernia 11/10/2012 03:38'!isActualArgumentReader	"Devuelve true si el elemento es una ActualArgumentReader."	^ true.! !!PLC_ActualArgumentReader methodsFor: 'library' stamp: 'EricPernia 5/31/2013 21:43'!keyword	"Devuelve el symbol del elemento"	^ #ActualArgumentReader! !!PLC_ActualArgumentReader methodsFor: 'accessing' stamp: 'CarlosLombardi 10/2/2016 23:59'!parameterDeclIn: aPLC_ConnectableBlock 	"The declaration of the parameter corresponding to this argument"		| inputPinNumber otherConnectableBlock varDecl |		"Obtengo el nmero de pin de entrada al que est conectado el pin de salida nico este Actual Argument"	inputPinNumber := aPLC_ConnectableBlock inputPinNumberConnectedToOutput: 1.		"Obtengo el bloque conectable al que est conectado este Actual Argument"	otherConnectableBlock := aPLC_ConnectableBlock blockConnectedToOutput: 1.		"Obtengo la declaracin de variable de la entrada numero inputPinNumber de otherConnectableBlock"	varDecl := otherConnectableBlock element inputs at: inputPinNumber.		^varDecl ! !!PLC_ActualArgumentReader methodsFor: 'checking' stamp: 'CarlosLombardi 10/16/2016 10:28'!typeError: operand ifAssignedTo: varDecl	"I do the typechecking corresponding to the assignment	   varDecl := operand	 and return the resulting error message, a String.	 If the operand passes the typecheck, then I return nil "		| errorText |		errorText := super typeError: operand ifAssignedTo: varDecl .	(errorText isNil & operand dataType isPLCUnspecifiedType)		ifTrue: [ errorText := 'El valor no corresponde al tipo del argumento' ].	(errorText isNil & operand isPLCLiteral) ifTrue: [ 		(varDecl dataType acceptValue: operand dataValue)			ifFalse: [ errorText := 'Valor fuera de rango' ]	] .	^errorText! !!PLC_ActualArgumentWriter methodsFor: 'accept' stamp: 'EricPernia 9/14/2013 02:39'!accept: anOperand in: aPLC_ConnectableBlock	"Devuelve true acepta el operando que le llega como parmetro.	Necesito pasarle el bloque conectable para que pueda moverse 	a travs de las conexiones.	  ______ 	  |		| 	  |		|	--|	      |--  anOperand	  |_____|		"		anOperand isPLCLiteral		ifTrue: [ ^ false ].		anOperand isVariable		ifTrue: [ ^ self acceptVariable: anOperand in: aPLC_ConnectableBlock ].		anOperand isStructItem 		ifTrue: [ ^ self acceptStructItem: anOperand in: aPLC_ConnectableBlock ].		anOperand isVoid		ifTrue: [ ^ true ].! !!PLC_ActualArgumentWriter methodsFor: 'accept' stamp: 'EricPernia 9/14/2013 02:38'!acceptStructItem: aStructItemOperand in: aPLC_ConnectableBlock	"Devuelve true acepta el operando que le llega como parmetro"	"	  ______ 	  |		| 	  |		|	--|	      |--  VAR_STRUCT.VAR_ITEM	  |_____|		"		"Hacer chequeos que faltan"	^ false.! !!PLC_ActualArgumentWriter methodsFor: 'accept' stamp: 'EricPernia 9/14/2013 02:38'!acceptVariable: aVariableOperand in: aPLC_ConnectableBlock	"Devuelve true acepta el operando que le llega como parmetro"	"	  ______ 	  |		| 	  |		|	--|	      |--  VAR	  |_____|		"		"Hacer chequeos que faltan"		"Chequeo 2"	^ self canWriteVariable: aVariableOperand.! !!PLC_ActualArgumentWriter methodsFor: 'accept' stamp: 'EricPernia 9/14/2013 03:08'!canWriteVariable: aVariableOperand	"Devuelve true si la variable (operando) que le llega como parmetro tiene permiso de escritura"	"Todas pueden escribirse menos las inputs es decir:		  ______ 	  |		| 	  |		|	--|	      |--  aVariableOperand	  |_____|		Se fija si puede ponerle un valor a aVariableOperand	"		^ ( aVariableOperand declaration variableCategory varType ~= '_INPUT' )! !!PLC_ActualArgumentWriter methodsFor: 'connectableBlocks' stamp: 'EricPernia 5/3/2013 02:04'!connectionToAddElement: aPLC_ElemenMorph inBlock: aPLC_ConnectableBlock	"Devuelve la conexion para aadirle un nuevo elemento."	| connectableBlock |	"Busco el contacto, bobina o bloque conectado al actual argument"	connectableBlock := aPLC_ConnectableBlock blockConnectedToInput: 1.		"Le pido la conexion para aadirle un nuevo elemento"	^ connectableBlock element connectionToAddElement: aPLC_ElemenMorph inBlock: connectableBlock.! !!PLC_ActualArgumentWriter methodsFor: 'initialize-release' stamp: 'CarlosLombardi 11/19/2016 17:55'!initialize	"Inicializaciones"	super initialize.	"this is needed only to connect the argument writer with the element having this as argument,	 the actual object pointed by the input is never used"	self addInput .! !!PLC_ActualArgumentWriter methodsFor: 'testing' stamp: 'EricPernia 11/10/2012 03:38'!isActualArgumentWriter	"Devuelve true si el elemento es una ActualArgumentWriter."	^ true.! !!PLC_ActualArgumentWriter methodsFor: 'library' stamp: 'EricPernia 5/31/2013 21:41'!keyword	"Devuelve el symbol del elemento"	^ #ActualArgumentWriter! !!PLC_ActualArgumentWriter methodsFor: 'accessing' stamp: 'CarlosLombardi 10/14/2016 18:12'!parameterDeclIn: aPLC_ConnectableBlock 	"The declaration of the parameter corresponding to this argument"		| outputPinNumber otherConnectableBlock varDecl |		"Obtengo el nmero de pin de entrada al que est conectado el pin de salida nico este Actual Argument"	outputPinNumber := aPLC_ConnectableBlock outputPinNumberConnectedToInput: 1.		"Obtengo el bloque conectable al que est conectado este Actual Argument"	otherConnectableBlock := aPLC_ConnectableBlock blockConnectedToInput: 1.		"Obtengo la declaracin de variable de la entrada numero inputPinNumber de otherConnectableBlock"	varDecl := otherConnectableBlock element outputs at: outputPinNumber.		^varDecl ! !!PLC_ActualArgumentWriter methodsFor: 'check' stamp: 'CarlosLombardi 10/16/2016 10:30'!typeError: operand ifAssignedTo: varDecl	"I do the typechecking corresponding to the assignment	   varDecl := operand	 and return the resulting error message, a String.	 If the operand passes the typecheck, then I return nil "		| errorText |		errorText := super typeError: operand ifAssignedTo: varDecl .	(errorText isNil & operand isPLCLiteral) ifTrue: [ 		errorText := 'Un valor de salida no puede ser literal' 	] .	^errorText! !!PLC_Coil methodsFor: 'connectableBlocks' stamp: 'EricPernia 5/5/2013 21:26'!actualArgumentFor: aPLC_ConnectableBlock	"Devuelve el actualArgument que en este caso es una variable simbolica simple"				^ ( self connectableBlockActualArgumentFor: aPLC_ConnectableBlock ) element actualArgument! !!PLC_Coil methodsFor: 'connectableBlocks' stamp: 'EricPernia 5/5/2013 21:25'!connectableBlockActualArgumentFor: aPLC_ConnectableBlock	"Devuelve el actualArgument"				^ (aPLC_ConnectableBlock blockConnectedToOutput: 2).! !!PLC_Coil methodsFor: 'compilation' stamp: 'EricPernia 11/17/2013 07:31'!generateCodeIn: aProgramAccumulator for: aPLC_ConnectableBlock	"Agrega los objetos que genera a aObjectProgram.	Como es una instancia nica debo pasarle como parmetro el bloque para el cual quiero que compile	para que pueda leer sus entradas y salidas."		| instruction |			PLC_CPU firstCheckFlag_BORRAME		ifTrue: [						"Genero: LD true - Para comenzar con el CR en 1 en el caso que la bobina 			o bloque de funcion este conectado directamente a la barra izquieda"						instruction := PLC_LD_Instruction new.				instruction modifiers add: PLC_IL_Modifiers NullModifier. 			instruction operands add: (PLC_Literal newWithDataType: PLC_DataType Bool andDataValue: true).								"Agrego los objetos generados, estos deben entende ilCompile y cCompile"			aProgramAccumulator add: instruction.					].	PLC_CPU firstCheckFlag_BORRAME: false.				instruction := PLC_ST_Instruction new.			instruction modifiers add: self modifier.		instruction operands add: (self actualArgumentFor: aPLC_ConnectableBlock).				"Agrego los objetos generados, estos deben entende ilCompile y cCompile"	aProgramAccumulator add: instruction.		(aPLC_ConnectableBlock blockConnectedToOutput: 1) generateCodeIn: aProgramAccumulator.! !!PLC_Coil methodsFor: 'graphic element' stamp: 'EricPernia 5/1/2013 18:38'!graphicElementFor: aConnectableBlock	"Devuelve el Elemento grafico (Morph)."			"Esto esta feo, es casi igual a preguntar por al clase"	( self modifier isNullModifier )		ifTrue: [			^ PLC_CoilMorph newFromConnectableBlock: aConnectableBlock.			] 		ifFalse: [			^ PLC_NCoilMorph newFromConnectableBlock: aConnectableBlock.			].! !!PLC_Coil methodsFor: 'initialize-release' stamp: 'EricPernia 6/12/2013 01:51'!initialize	"Inicializaciones"	super initialize.		self addInput.	self addOutput.	self addOutput.! !!PLC_Coil methodsFor: 'testing' stamp: 'EricPernia 11/6/2012 18:59'!isCoil	"Devuelve true si el elemento es una Bobina."	^ true.! !!PLC_Coil methodsFor: 'accessing' stamp: 'EricPernia 9/1/2012 20:05'!modifier	^ modifier! !!PLC_Coil methodsFor: 'accessing' stamp: 'EricPernia 9/1/2012 20:05'!modifier: anObject	modifier := anObject! !!PLC_Coil methodsFor: 'accessing' stamp: 'EricPernia 10/18/2012 10:59'!morph	^ morph! !!PLC_Coil methodsFor: 'accessing' stamp: 'EricPernia 10/18/2012 10:59'!morph: anObject	morph := anObject! !!PLC_Contact methodsFor: 'parallel' stamp: 'EricPernia 9/13/2013 17:30'!acceptParallel	"Responde true si el elemento acepta estar conectado en una rama paralela en Ladder.		|	c1		 c2			b1	|-----|  |----------|  |-----+-----(  )------|	|				    |	|	c3			    |	|-----|  |---------==----+		|		Quiero agregar un elemento en la conexin ==		"	^ true.! !!PLC_Contact methodsFor: 'conectableBlocks' stamp: 'EricPernia 5/5/2013 21:27'!actualArgumentFor: aPLC_ConnectableBlock	"Devuelve el actualArgument que en este caso es una variable simbolica simple"				^ ( self connectableBlockActualArgumentFor: aPLC_ConnectableBlock ) element actualArgument! !!PLC_Contact methodsFor: 'conectableBlocks' stamp: 'EricPernia 5/5/2013 21:27'!connectableBlockActualArgumentFor: aPLC_ConnectableBlock	"Devuelve el actualArgument"				^ (aPLC_ConnectableBlock blockConnectedToInput: 2).! !!PLC_Contact methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 16:23'!generateCodeIn: aProgramAccumulator for: aPLC_ConnectableBlock	"Agrega los objetos que genera a aObjectProgram.	Como es una instancia nica debo pasarle como parmetro el bloque para el cual quiero que compile	para que pueda leer sus entradas y salidas."		| instruction |		PLC_CPU firstCheckFlag_BORRAME		ifTrue: [			instruction := PLC_LD_Instruction new.				] 		ifFalse: [			instruction := PLC_AND_Instruction new.				].			PLC_CPU firstCheckFlag_BORRAME: false.	instruction modifiers add: self modifier.		instruction operands add: (self actualArgumentFor: aPLC_ConnectableBlock).					"Agrego los objetos generados, estos deben entende ilCompile y cCompile"	aProgramAccumulator add: instruction.	(aPLC_ConnectableBlock blockConnectedToOutput: 1) generateCodeIn: aProgramAccumulator.! !!PLC_Contact methodsFor: 'graphic element' stamp: 'EricPernia 5/1/2013 18:38'!graphicElementFor: aConnectableBlock	"Devuelve el Elemento grafico (Morph)."		"Esto esta feo, es casi igual a preguntar por al clase"	( self modifier isNullModifier )		ifTrue: [			^ PLC_NOContactMorph newFromConnectableBlock: aConnectableBlock.			] 		ifFalse: [			^ PLC_NCContactMorph newFromConnectableBlock: aConnectableBlock.			].		! !!PLC_Contact methodsFor: 'initialize-release' stamp: 'EricPernia 6/12/2013 01:51'!initialize	"Inicializaciones"	super initialize.		self addInput.	self addInput.	self addOutput.! !!PLC_Contact methodsFor: 'testing' stamp: 'EricPernia 11/6/2012 18:19'!isContact	"Devuelve true si el elemento es un Contacto."	^ true.! !!PLC_Contact methodsFor: 'accessing' stamp: 'EricPernia 9/1/2012 20:41'!modifier	^ modifier! !!PLC_Contact methodsFor: 'accessing' stamp: 'EricPernia 9/1/2012 20:41'!modifier: anObject	modifier := anObject! !!PLC_Contact methodsFor: 'accessing' stamp: 'EricPernia 10/18/2012 10:54'!morph	^ morph! !!PLC_Contact methodsFor: 'accessing' stamp: 'EricPernia 10/18/2012 10:54'!morph: anObject	morph := anObject! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 9/24/2012 16:24'!ActualArgumentReader	^ PLC_ActualArgumentReader new.! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 9/24/2012 16:24'!ActualArgumentWriter 	^ PLC_ActualArgumentWriter new.! !!PLC_Element class methodsFor: 'instance creation' stamp: 'CarlosLombardi 11/19/2016 18:33'!ActualRequiredArgumentReader	| newArg |	newArg := PLC_ActualArgumentReader new.	newArg actualArgument setAsRequired .	newArg rememberOriginalArgument .	^ newArg! !!PLC_Element class methodsFor: 'instance creation' stamp: 'CarlosLombardi 11/19/2016 18:34'!ActualRequiredArgumentWriter	| newArg |	newArg := PLC_ActualArgumentWriter new.	newArg actualArgument setAsRequired .	newArg rememberOriginalArgument .	^ newArg! !!PLC_Element class methodsFor: 'elements' stamp: 'EricPernia 5/31/2013 21:35'!AllLadderElementNamesStrings.	^ self Elements keys.! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 9/30/2012 20:36'!Coil	"Devuelve la nica instancia del elemento NOCoil"		ElementsCreated ifFalse: [self createElements].		^ Elements at: #Coil! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 10/9/2012 21:18'!LeftPowerRail	^ PLC_LeftPowerRail new.! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 19:57'!NCContact	"Devuelve la nica instancia del elemento NCContact"		ElementsCreated ifFalse: [self createElements].		^ Elements at: #NCContact! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 9/30/2012 20:35'!NCoil	"Devuelve la nica instancia del elemento NCCoil"		ElementsCreated ifFalse: [self createElements].		^ Elements at: #NCoil! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 19:54'!NOContact	"Devuelve la nica instancia del elemento NOContact"		ElementsCreated ifFalse: [self createElements].		^ Elements at: #NOContact! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 10/9/2012 21:43'!RightPowerRail	^ PLC_RightPowerRail new.! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 10/10/2012 01:47'!VerticalLink	^ PLC_VerticalLink new.! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 19:52'!clearElements	"Borra las instancias nicas creadas."	Elements := Dictionary new.	ElementsCreated := false.	! !!PLC_Element class methodsFor: 'instance creation' stamp: 'EricPernia 5/3/2015 06:13'!createElements	"Crea los elementos que son de instancia nica."	Elements := Dictionary new.		"Contactos"		Elements at: #NOContact put: PLC_Contact new.	(Elements at: #NOContact) modifier: PLC_IL_Modifiers NullModifier. 	(Elements at: #NOContact) morph: PLC_NOContactMorph. 		Elements at: #NCContact put: PLC_Contact new.	(Elements at: #NCContact) modifier: PLC_IL_Modifiers NModifier. 	(Elements at: #NCContact) morph: PLC_NCContactMorph. 		"Bobinas"		Elements at: #Coil put: PLC_Coil new.	(Elements at: #Coil) modifier: PLC_IL_Modifiers NullModifier. 	(Elements at: #Coil) morph: PLC_CoilMorph. 		Elements at: #NCoil put: PLC_Coil new.	(Elements at: #NCoil) modifier: PLC_IL_Modifiers NModifier.	(Elements at: #NCoil) morph: PLC_NCoilMorph.	ElementsCreated := true.! !!PLC_Element class methodsFor: 'class initialization' stamp: 'EricPernia 11/22/2013 16:54'!initialize	super initialize.		ElementsCreated ifNil: [		ElementsCreated := false		].	! !!PLC_Element class methodsFor: 'elements' stamp: 'EricPernia 2/21/2016 21:53'!ladderElements	"Devuelve el diccionario de Elementos Ladder para la library."	| dictionary |	dictionary := Dictionary new.		ElementsCreated 		ifFalse: [			self createElements.		].		"Contactos"	dictionary at: #'Contacto Normal Abierto' put: ( Elements at: #NOContact ).	dictionary at: #'Contacto Normal Cerrado' put: ( Elements at: #NCContact ).	dictionary at: #Bobina put: ( Elements at: #Coil ).	dictionary at: #'Bobina Negada' put: ( Elements at: #NCoil ).		^ dictionary.! !!PLC_Element methodsFor: 'parallel' stamp: 'EricPernia 9/13/2013 17:28'!acceptParallel	"Responde true si el elemento acepta estar conectado en una rama paralela en Ladder.		|	c1		 c2			b1	|-----|  |----------|  |-----+-----(  )------|	|				    |	|	c3			    |	|-----|  |---------==----+		|		Quiero agregar un elemento en la conexin ==		"	^ false.! !!PLC_Element methodsFor: 'connectableBlocks' stamp: 'EricPernia 10/5/2012 22:30'!actualArgumentFor: aPLC_ConnectableBlock atInput: anInputNumber	"Devuelve el actualArgument, es decir, la variable o literal que contiene el elemento"				^ (aPLC_ConnectableBlock blockConnectedToInput: anInputNumber) element actualArgument! !!PLC_Element methodsFor: 'connectableBlocks' stamp: 'EricPernia 10/5/2012 22:30'!actualArgumentFor: aPLC_ConnectableBlock atOutput: anOutputNumber	"Devuelve el actualArgument, es decir, la variable o literal que contiene el elemento"				^ (aPLC_ConnectableBlock blockConnectedToOutput: anOutputNumber) element actualArgument! !!PLC_Element methodsFor: 'connectableBlocks' stamp: 'EricPernia 11/5/2013 12:56'!addInput	"Agrega una entrada al elemento."	"| decl |		decl := PLC_SimpleSymbolicVarDecl 		newWithDataType: PLC_DataTypes Bool		andInitialValue: nil 		andIdentifier: 'IN' , ( self inputs size ) asString.	self inputs add: ( PLC_SimpleSymbolicVar newWithDeclaration: decl andDataValue: nil )."			self inputs add: ( PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Bool		andInitialValue: nil 		andIdentifier: 'IN' , ( self inputs size ) asString		).! !!PLC_Element methodsFor: 'connectableBlocks' stamp: 'EricPernia 11/5/2013 12:56'!addOutput	"Agrega una salida al elemento."	"| decl |		decl := PLC_SimpleSymbolicVarDecl 		newWithDataType: PLC_DataTypes Bool		andInitialValue: nil 		andIdentifier: 'OUT' , ( self outputs size ) asString.	self outputs add: ( PLC_SimpleSymbolicVar newWithDeclaration: decl andDataValue: nil )."		self outputs add: ( PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Bool		andInitialValue: nil 		andIdentifier: 'OUT' , ( self outputs size ) asString ).! !!PLC_Element methodsFor: 'connectableBlocks' stamp: 'EricPernia 6/12/2013 01:48'!connectableBlockInputs	"Cantidad de entradas para el bloque conectable."	^ self inputs size.! !!PLC_Element methodsFor: 'connectableBlocks' stamp: 'EricPernia 6/12/2013 01:49'!connectableBlockOutputs	"Cantidad de salidas para el bloque conectable."	^ self outputs size.! !!PLC_Element methodsFor: 'connectableBlocks' stamp: 'EricPernia 5/2/2013 17:00'!connectionToAddElement: aPLC_ElemenMorph inBlock: aPLC_ConnectableBlock	"Devuelve la conexion para aadirle un nuevo elemento."	^ aPLC_ConnectableBlock connectedAtOutput: 1.		"Hacer que compruebe aqu si puede conectar o no el elemento nuevo pidiendole a los bloques de sus extremos si lo permiten"		"SI NO PERMITEN DEVUELVEN NIL"		"PISO ESTE METODO EN RightPowerRail "! !!PLC_Element methodsFor: 'initialize-release' stamp: 'EricPernia 6/12/2013 01:47'!initialize	"Inicializaciones"	self inputs: OrderedCollection new.	self outputs: OrderedCollection new.! !!PLC_Element methodsFor: 'accessing' stamp: 'EricPernia 6/12/2013 01:44'!inputs		^ inputs! !!PLC_Element methodsFor: 'accessing' stamp: 'EricPernia 6/12/2013 01:44'!inputs: anObject		inputs := anObject! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 11/10/2012 03:37'!isActualArgumentReader	"Devuelve true si el elemento es una ActualArgumentReader."	^ false.! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 11/10/2012 03:37'!isActualArgumentWriter	"Devuelve true si el elemento es una ActualArgumentWriter."	^ false.! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 11/6/2012 18:59'!isCoil	"Devuelve true si el elemento es una Bobina."	^ false.! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 10/14/2012 04:52'!isConnection	"Devuelve siempre false. ESTE METODO ES UNA MUGRE PARA QUE FUNCIONE FACIL close branch"	^ false.! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 11/6/2012 18:19'!isContact	"Devuelve true si el elemento es un Contacto."	^ false.! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 11/15/2013 15:21'!isFunction	"Devuelve true si el elemento es un llamado grafico a Funcion."	^ false.! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 11/15/2013 15:21'!isFunctionBlock	"Devuelve true si el elemento es un llamado grafico a Bloque de Funcion."	^ false.	! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 10/9/2012 23:55'!isLeftPowerRail	"Devuelve true si el elemento es un Riel Izquierdo"	^ false.! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 10/9/2012 23:55'!isRightPowerRail	"Devuelve true si el elemento es un Riel Derecho"	^ false.! !!PLC_Element methodsFor: 'testing' stamp: 'EricPernia 10/10/2012 18:53'!isVerticalLink	"Devuelve true si el elemento es un Vertical Link."	^ false.! !!PLC_Element methodsFor: 'accessing' stamp: 'EricPernia 6/12/2013 01:44'!outputs		^ outputs! !!PLC_Element methodsFor: 'accessing' stamp: 'EricPernia 6/12/2013 01:44'!outputs: anObject		outputs := anObject! !!PLC_GraphicFunctionBlockCall class methodsFor: 'instance creation' stamp: 'EricPernia 11/22/2013 16:52'!initialize	"Inicializacion de la clase		numberOfInstances guarda el numero de instancias del llamado a FB 	para ponerle un numero distinto a cada instancia de llamado repetido."	numberOfInstances := 0.! !!PLC_GraphicFunctionBlockCall class methodsFor: 'instance creation' stamp: 'EricPernia 11/19/2013 03:13'!newWithDeclaration: pou andNetwork: aNet	"Crea una nueva instancia y le asigana la instancia pasada como parmetro."	| pouCall |		pouCall := self new.		"Asigno la declaracin."	pouCall declaration: pou.	pouCall network: aNet.					"Asigno la declaracin de instancia. La crea la Declaracin. 	En Funciones es nica en Programas y FB se crea una nueva."		pouCall instance: (		pou 			instanceDeclForForFBWithIdentifier:				pou typedIdentifier , 				'_VAR_' , 				numberOfInstances asString		). "Le pongo una PLC_SymbolicVariableDecl en lugar de una 		PLC_InstanceVariableDecl para que no agregue el static"		 	"AUMENTA EL NUMERO DE LLAMADOS A FB PARA NO PISAR EL NOMBRE DE INSTANCIA"		numberOfInstances := numberOfInstances + 1.				"AGREGO LA DECLARACION DE VARIABLE DE INSTANCIA A LAS DECLARACIONES VAR"	aNet pouBody pou varDecls add: 		pouCall instance.			"Construye sus entradas y salidas a partir de su declaracin."	pouCall buildElementInputs.	pouCall buildElementOutputs.		^ pouCall.! !!PLC_GraphicFunctionBlockCall class methodsFor: 'instance creation' stamp: 'EricPernia 11/19/2013 00:33'!numberOfInstances	"numberOfInstances guarda el numero de instancias del llamado a FB 	para ponerle un numero distinto a cada instancia de llamado repetido."	^ numberOfInstances.! !!PLC_GraphicFunctionBlockCall methodsFor: 'compilation' stamp: 'EricPernia 11/19/2013 05:17'!generateCodeIn: aProgramAccumulator for: aPLC_ConnectableBlock	"Agrega los objetos que genera a aObjectProgram.	Como es una instancia nica debo pasarle como parmetro el bloque para el cual quiero que compile	para que pueda leer sus entradas y salidas."		| instruction pouCall fluxVarDecl structItem |		PLC_CPU firstCheckFlag_BORRAME		ifTrue: [						"Genero: LD true - Para comenzar con el CR en 1 en el caso que la bobina 			o bloque de funcion este conectado directamente a la barra izquieda"						instruction := PLC_LD_Instruction new.				instruction modifiers add: PLC_IL_Modifiers NullModifier. 			instruction operands add: (PLC_Literal newWithDataType: PLC_DataType Bool andDataValue: true).								"Agrego los objetos generados, estos deben entende ilCompile y cCompile"			aProgramAccumulator add: instruction.					].	PLC_CPU firstCheckFlag_BORRAME: false.		"Creo la declaracin de variable FLUX que la usan los llamados graficos a F y FB"	fluxVarDecl := PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Bool		andInitialValue: nil 		andIdentifier: 'FLUX'. 	"Le asigno la categora temp asi no pone el pxPOU-> en C"	fluxVarDecl variableCategory: PLC_VariableCategoryDecl tempVarDecls.			"Creo un llamado textual a POU y le asigno la instancia"		pouCall := PLC_TextualFunctionBlockCall 		newFromDeclaration: self declaration 		andInstanceOperand: self instance operand.		"Instance debe ser un instance Operand"						"Asigno la primer salida del llamado a pou a la variable FLUX"	(pouCall outputAssignments at: 1) 		actualArgument: fluxVarDecl operand.					"Asigno las entradas del llamado a pou a partir de la 2da"	( 2 to: pouCall inputAssignments size ) do: [ :index |		(pouCall inputAssignments at: index) 			actualArgument: (				self actualArgumentFor: aPLC_ConnectableBlock 					atInput: index			).		].		"Asigno las salidas del llamado a pou a partir de la 2da"	( 2 to: pouCall outputAssignments size ) do: [ :index |		(pouCall outputAssignments at: index) 			actualArgument: (				self actualArgumentFor: aPLC_ConnectableBlock 					atOutput: index			).		].			"pouCall returnAssignment explore.""	Ver cual es la precedencia en:	pxPOU -> ADD_INT_VAR . IN		a - (pxPOU -> ADD_INT_VAR ) . IN	b - pxPOU -> (ADD_INT_VAR . IN )		es a Esta bien"	"Genero: ST EN"	structItem := PLC_StructureItem		newWithItem: self instance operand		andItem: (			PLC_SymbolicVariableDecl 				newWithDataType:  (pouCall inputAssignments at: 1) formalParameter dataType				andInitialValue: nil 				andIdentifier: (pouCall inputAssignments at: 1) formalParameter identifier 				andCategory: PLC_VariableCategoryDecl tempVarDecls			) operand.		instruction := PLC_ST_Instruction new.	instruction modifiers add: PLC_IL_Modifiers NullModifier.	instruction operands add: structItem.									"Agrego ST EN al Acumulador"	aProgramAccumulator add: instruction.		"Agrego el llamado textual al Acumulador"	aProgramAccumulator add: pouCall.										"Genero: LD FLUX - Restituyo el CR a partir de FLUX"	instruction := PLC_LD_Instruction new.		instruction modifiers add: PLC_IL_Modifiers NullModifier. 	instruction operands add: fluxVarDecl operand.								"Agrego LD FLUX al Acumulador"	aProgramAccumulator add: instruction.			"Le indico al siguiente elemento que genere cdigo"	(aPLC_ConnectableBlock blockConnectedToOutput: 1) generateCodeIn: aProgramAccumulator.! !!PLC_GraphicFunctionBlockCall methodsFor: 'testing' stamp: 'EricPernia 11/15/2013 15:19'!isFunctionBlock	"Devuelve true si el elemento es un llamado grafico a Bloque de Funcion."	^ true.! !!PLC_GraphicFunctionCall class methodsFor: 'instance creation' stamp: 'EricPernia 9/9/2015 21:26'!newWithDeclaration: decl andNetwork: aNet	"Crea una nueva instancia y le asigana la instancia pasada como parmetro."	| pouCall colec |		pouCall := self new.		"Asigno la declaracin."	pouCall declaration: decl.	pouCall network: aNet.		"Asigno la declaracin de instancia. La crea la Declaracin. 	En Funciones es nica en Programas y FB se crea una nueva."		pouCall instance: decl instanceDecl.				"AGREGO LA DECLARACION DE VARIABLE DE INSTANCIA A LAS DECLARACIONES 	VAR SI NO ESTABA AGREGADA, ESTO ES PARA QUE NO HAYA REPETIDAS"	colec := aNet pouBody pou funInstVarDecls declarations collect: [ :each | each identifier ].	colec detect: [ :each | 			each =  pouCall instance identifier 			] 		ifNone: [ 			aNet pouBody pou funInstVarDecls add: 				pouCall instance			].					"Construye sus entradas y salidas a partir de su declaracin."	pouCall buildElementInputs.	pouCall buildElementOutputs.		^ pouCall.! !!PLC_GraphicFunctionCall methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 05:03'!buildElementInputs	"Devuelve la Coleccion de Entradas del elemento la cual genera a partir su Declaracion.	Corresponden a los pines de Entrada del bloque conectable ordenados segn las 	categoras de variables."	inputs := self buildInputs. 	inputs addAll: self buildInOuts. 	^ inputs.! !!PLC_GraphicFunctionCall methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 05:02'!buildElementOutputs	"Devuelve la Coleccion de Salidas del elemento la cual genera a partir su Declaracion.	Corresponden a los pines de Entrada del bloque conectable ordenados segn las 	categoras de variables."	outputs := self buildOutputs. 	outputs addAll: self buildInOuts. 			^ outputs.! !!PLC_GraphicFunctionCall methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 04:51'!buildOutputs	"Devuelve la Coleccion de Entradas del elemento la cual genera a partir su Declaracion.	Corresponden a los pines de Entrada del bloque conectable ordenados segn las 	categoras de variables."	| firstOutputIdentifier outs |	outs := OrderedCollection new.	 ( self declaration outputVarDecls size > 0 )		ifTrue: [ 			firstOutputIdentifier := ( self declaration outputVarDecls at: 1 ) identifier.			( firstOutputIdentifier = 'ENO' )				ifTrue: [ 					outs add: ( self declaration outputVarDecls at: 1 ).					outs add: self declaration return.					( 2 to: self declaration outputVarDecls size ) do: [ :each |						outs add: ( self declaration outputVarDecls at: each ). 						].					^ outs.											] 				ifFalse: [ 					outs add: self declaration return.					outs addAll: self declaration outputVarDecls. 					^ outs.					].			] 				ifFalse: [ 			outs add: self declaration return.			^ outs.							].! !!PLC_GraphicFunctionCall methodsFor: 'declaration' stamp: 'EricPernia 6/12/2013 00:24'!dataType	^ self declaration return dataType.! !!PLC_GraphicFunctionCall methodsFor: 'compilation' stamp: 'EricPernia 11/17/2013 13:57'!generateCodeIn: aProgramAccumulator for: aPLC_ConnectableBlock	"Agrega los objetos que genera a aObjectProgram.	Como es una instancia nica debo pasarle como parmetro el bloque para el cual quiero que compile	para que pueda leer sus entradas y salidas."		| instruction pouCall fluxVarDecl structItem |		PLC_CPU firstCheckFlag_BORRAME		ifTrue: [						"Genero: LD true - Para comenzar con el CR en 1 en el caso que la bobina 			o bloque de funcion este conectado directamente a la barra izquieda"						instruction := PLC_LD_Instruction new.				instruction modifiers add: PLC_IL_Modifiers NullModifier. 			instruction operands add: (PLC_Literal newWithDataType: PLC_DataType Bool andDataValue: true).								"Agrego los objetos generados, estos deben entende ilCompile y cCompile"			aProgramAccumulator add: instruction.					].	PLC_CPU firstCheckFlag_BORRAME: false.		"Creo la declaracin de variable FLUX que la usan los llamados graficos a F y FB"	fluxVarDecl := PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Bool		andInitialValue: nil 		andIdentifier: 'FLUX'. 	"Le asigno la categora temp asi no pone el pxPOU-> en C"	fluxVarDecl variableCategory: PLC_VariableCategoryDecl tempVarDecls.		"Creo un llamado textual a POU y le asigno la instancia"		pouCall := PLC_TextualFunctionCall 		newFromDeclaration: self declaration 		andInstanceOperand: self instance operand.		"Instance debe ser un instance Operand"						"Asigno la primer salida del llamado a pou a la variable FLUX"	(pouCall outputAssignments at: 1) 		actualArgument: fluxVarDecl operand.					"Asigno las entradas del llamado a pou a partir de la 2da"	( 2 to: pouCall inputAssignments size ) do: [ :index |		(pouCall inputAssignments at: index) 			actualArgument: (				self actualArgumentFor: aPLC_ConnectableBlock 					atInput: index			).		].		"Asigno las salidas del llamado a pou a partir de la 2da"	( 2 to: pouCall outputAssignments size ) do: [ :index |		(pouCall outputAssignments at: index) 			actualArgument: (				self actualArgumentFor: aPLC_ConnectableBlock 					atOutput: index + 1			).		].		"Asigno la salida de RETURN del llamado a Funcion"	pouCall returnAssignment		actualArgument: (			self actualArgumentFor: aPLC_ConnectableBlock 				atOutput: 2			).			"pouCall returnAssignment explore.""	Ver cual es la precedencia en:	pxPOU -> ADD_INT_VAR . IN		a - (pxPOU -> ADD_INT_VAR ) . IN	b - pxPOU -> (ADD_INT_VAR . IN )		es a Esta bien"	"Genero: ST EN"	structItem := PLC_StructureItem		newWithItem: self instance operand		andItem: (			PLC_SymbolicVariableDecl 				newWithDataType:  (pouCall inputAssignments at: 1) formalParameter dataType				andInitialValue: nil 				andIdentifier: (pouCall inputAssignments at: 1) formalParameter identifier 				andCategory: PLC_VariableCategoryDecl tempVarDecls			) operand.		instruction := PLC_ST_Instruction new.	instruction modifiers add: PLC_IL_Modifiers NullModifier.	instruction operands add: structItem.									"Agrego ST EN al Acumulador"	aProgramAccumulator add: instruction.		"Agrego el llamado textual al Acumulador"	aProgramAccumulator add: pouCall.										"Genero: LD FLUX - Restituyo el CR a partir de FLUX"	instruction := PLC_LD_Instruction new.		instruction modifiers add: PLC_IL_Modifiers NullModifier. 	instruction operands add: fluxVarDecl operand.								"Agrego LD FLUX al Acumulador"	aProgramAccumulator add: instruction.			"Le indico al siguiente elemento que genere cdigo"	(aPLC_ConnectableBlock blockConnectedToOutput: 1) generateCodeIn: aProgramAccumulator.! !!PLC_GraphicFunctionCall methodsFor: 'testing' stamp: 'EricPernia 11/15/2013 15:20'!isFunction	"Devuelve true si el elemento es un llamado grafico a Funcion."	^ true.! !!PLC_GraphicPOUCall methodsFor: 'parallel' stamp: 'EricPernia 9/13/2013 17:34'!acceptParallel	"Responde true si la POU a la que llama este llamado a POU acepta estar conectada en una rama paralela en Ladder.			Quiero agregar un elemento llamado a POU en la conexin ==		|	c1		 c2			b1	|-----|  |----------|  |-----+-----(  )------|	|				    |	|	c3			    |	|-----|  |---------==----+		|	"	"Se lo delega a la declaraion de POU que conoce"	^ self declaration acceptParallel.! !!PLC_GraphicPOUCall methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 05:01'!buildElementInputs	"Devuelve la Coleccion de Entradas del elemento la cual genera a partir su Declaracion.	Corresponden a los pines de Entrada del bloque conectable ordenados segn las 	categoras de variables."	inputs := self buildInputs. 	inputs addAll: self buildInOuts. 	inputs add: self instance.			^ inputs.! !!PLC_GraphicPOUCall methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 05:02'!buildElementOutputs	"Devuelve la Coleccion de Salidas del elemento la cual genera a partir su Declaracion.	Corresponden a los pines de Entrada del bloque conectable ordenados segn las 	categoras de variables."	outputs := self buildOutputs. 	outputs addAll: self buildInOuts. 	outputs add: self instance.				^ outputs.! !!PLC_GraphicPOUCall methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 05:37'!buildInOuts	"Devuelve las Entrada-Salidas de su declaracin."	| decls |	decls := OrderedCollection new.	decls addAll: self declaration inOutVarDecls.		^ decls.! !!PLC_GraphicPOUCall methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 05:36'!buildInputs	"Devuelve las Entradas de su declaracin."	| decls |	decls := OrderedCollection new.	decls addAll: self declaration inputVarDecls.		^ decls.! !!PLC_GraphicPOUCall methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 05:35'!buildOutputs	"Devuelve las Salidas de su declaracin."	| decls |	decls := OrderedCollection new.	decls addAll: self declaration outputVarDecls.		^ decls.! !!PLC_GraphicPOUCall methodsFor: 'declaration' stamp: 'EricPernia 6/21/2013 16:21'!declaration	"Devuelve la declaracin asociada a su instancia"	^ declaration.! !!PLC_GraphicPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/21/2013 16:21'!declaration: anObject		declaration := anObject! !!PLC_GraphicPOUCall methodsFor: 'graphic element' stamp: 'EricPernia 6/22/2013 02:10'!graphicElementFor: aConnectableBlock	"Devuelve el Elemento grafico (Morph)."	^ PLC_BlockMorph newFromConnectableBlock: aConnectableBlock.! !!PLC_GraphicPOUCall methodsFor: 'initialize-release' stamp: 'EricPernia 6/21/2013 18:35'!initialize	"Inicializaciones"	"Inicio en 0 la variable que indica la cantidad de entradas cableadas compiladas"	self numberOfCompiledImputs: 0.! !!PLC_GraphicPOUCall methodsFor: 'accessing' stamp: 'EricPernia 9/3/2013 00:38'!instance		^ instance.! !!PLC_GraphicPOUCall methodsFor: 'accessing' stamp: 'EricPernia 9/3/2013 00:38'!instance: anObject		instance := anObject! !!PLC_GraphicPOUCall methodsFor: 'accessing' stamp: 'EricPernia 11/19/2013 00:27'!network		^ network.! !!PLC_GraphicPOUCall methodsFor: 'accessing' stamp: 'EricPernia 11/19/2013 00:28'!network: anObject		network := anObject! !!PLC_GraphicPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/12/2013 00:41'!numberOfCompiledImputs		^ numberOfCompiledImputs! !!PLC_GraphicPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/12/2013 00:41'!numberOfCompiledImputs: anObject		numberOfCompiledImputs := anObject! !!PLC_GraphicPOUCall methodsFor: 'compilation' stamp: 'EricPernia 11/10/2012 17:00'!numberOfWiredInputsFor: aPLC_ConnectableBlock	"Devuelve el numero de entradas cableadas sin contar la primera"	| cont |				cont := 0.	( 2 to: self inputs size ) do: [ :each |		(aPLC_ConnectableBlock blockConnectedToInput: each) element isActualArgumentReader			ifFalse: [				cont := cont + 1.				]. 				].			! !!PLC_LeftPowerRail methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 13:38'!generateCodeIn: aProgramAccumulator for: aPLC_ConnectableBlock	"Agrega los objetos que genera a aProgramAccumulator.	Como es una instancia nica debo pasarle como parmetro el bloque para el cual quiero que compile	para que pueda leer sus entradas y salidas."		PLC_CPU firstCheckFlag_BORRAME: true.		(1 to: self outputs size) do: [ :each | 			(aPLC_ConnectableBlock blockConnectedToOutput: each) generateCodeIn: aProgramAccumulator.				PLC_CPU firstCheckFlag_BORRAME: true.				].! !!PLC_LeftPowerRail methodsFor: 'graphic element' stamp: 'EricPernia 4/29/2013 16:06'!graphicElementFor: aConnectableBlock	"Devuelve el Elemento grafico (Morph)."		^ PLC_LeftPowerRailMorph newFromElement: self.! !!PLC_LeftPowerRail methodsFor: 'testing' stamp: 'EricPernia 10/9/2012 23:56'!isLeftPowerRail	"Devuelve true si el elemento es un Riel Izquierdo"	^ true.! !!PLC_LeftPowerRail methodsFor: 'library' stamp: 'EricPernia 5/31/2013 21:44'!keyword	"Devuelve el symbol del elemento"	^ #LeftPowerRail ! !!PLC_LeftPowerRail methodsFor: 'accessing' stamp: 'EricPernia 6/7/2012 16:05'!outputs	^ outputs! !!PLC_LeftPowerRail methodsFor: 'accessing' stamp: 'EricPernia 6/7/2012 16:05'!outputs: anObject	outputs := anObject! !!PLC_RightPowerRail methodsFor: 'connectableBlocks' stamp: 'EricPernia 11/5/2013 12:56'!addInput	"Agrega una entrada al elemento."	self inputs add: ( PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Bool		andInitialValue: nil 		andIdentifier: 'IN' ).! !!PLC_RightPowerRail methodsFor: 'connectableBlocks' stamp: 'EricPernia 5/2/2013 17:00'!connectionToAddElement: aPLC_ElemenMorph inBlock: aPLC_ConnectableBlock	"Devuelve la conexion para aadirle un nuevo elemento."	^ aPLC_ConnectableBlock connectedAtInput: 1.		"Hacer que compruebe aqu si puede conectar o no el elemento nuevo pidiendole a los bloques de sus extremos si lo permiten"		"SI NO PERMITEN DEVUELVEN NIL"! !!PLC_RightPowerRail methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 16:49'!generateCodeIn: aProgramAccumulator for: aPLC_ConnectableBlock	"Agrega los objetos que genera a aProgramAccumulator.	Como es una instancia nica debo pasarle como parmetro el bloque para el cual quiero que compile	para que pueda leer sus entradas y salidas."		"PLC_CPU firstCheckFlag_BORRAME: true."	! !!PLC_RightPowerRail methodsFor: 'graphic element' stamp: 'EricPernia 4/29/2013 16:06'!graphicElementFor: aConnectableBlock	"Devuelve el Elemento grafico (Morph)."		^ PLC_RightPowerRailMorph new.! !!PLC_RightPowerRail methodsFor: 'initialize-release' stamp: 'EricPernia 6/12/2013 02:38'!initialize	"Inicializaciones"	super initialize.		self addInput.! !!PLC_RightPowerRail methodsFor: 'testing' stamp: 'EricPernia 10/9/2012 23:56'!isRightPowerRail	"Devuelve true si el elemento es un Riel Derecho"	^ true.! !!PLC_RightPowerRail methodsFor: 'library' stamp: 'EricPernia 5/31/2013 21:43'!keyword	"Devuelve el symbol del elemento"	^ #RightPowerRail ! !!PLC_VerticalLink class methodsFor: 'class initialization' stamp: 'EricPernia 11/3/2012 20:38'!initialize	"Inicializacion de la clase"	numberOfInstances := 0.! !!PLC_VerticalLink class methodsFor: 'accesors' stamp: 'EricPernia 11/3/2012 20:40'!numberOfInstances	^ numberOfInstances! !!PLC_VerticalLink class methodsFor: 'accesors' stamp: 'EricPernia 11/3/2012 20:40'!numberOfInstances: aNumber	numberOfInstances := aNumber.! !!PLC_VerticalLink methodsFor: 'connectableBlocks' stamp: 'EricPernia 11/6/2013 15:48'!addInput	"Agrega una entrada al elemento."	self inputs add: ( PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Bool		andInitialValue: nil 		andIdentifier: 'IN' , ( self inputs size ) asString		andCategory: PLC_VariableCategoryDecl tempVarDecls		).	"PLC_VariableCategoryDecl tempVarDecls      Es un parche para que compile bien"! !!PLC_VerticalLink methodsFor: 'connectableBlocks' stamp: 'EricPernia 11/6/2013 15:50'!addOutput	"Agrega una salida al elemento Vertical Link."	self outputs add: ( PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Bool		andInitialValue: nil 		andIdentifier: 'OUT'		andCategory: PLC_VariableCategoryDecl tempVarDecls		).			"PLC_VariableCategoryDecl tempVarDecls      Es un parche para que compile bien"! !!PLC_VerticalLink methodsFor: 'compilation' stamp: 'EricPernia 6/17/2013 02:25'!createObjectTypeDec	"Devuelve el Objeto de programa Declaracion de tipos de datos que genera."		| typeDecl |		typeDecl := PLC_TypeDecl 		newWithDataType: self objectStructDec 		andIdentifier: ( self identifier , '_TYPE_STRUCT' ).		typeDecl description: 'Estructura de Enlace Vertical.'.	"Guarda y devuelve el Objeto de porgrama generado"	self objectTypeDecl: typeDecl.			^ typeDecl.! !!PLC_VerticalLink methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 17:02'!createObjectVarDec	"Devuelve el Objeto de programa Declaracion de Variable que genera."		| varDecl |		"Genero una nueva declaracion de variable de tipo de dato estructurado"	varDecl := PLC_SymbolicVariableDecl		newWithDataType: self objectTypeDec 		andInitialValue: nil 		andIdentifier: self identifier , '_VAR_STRUCT'.			" P A R C H E     le clavo una categoria para que haga bien lo de pxPOU->	no hace falta este parche se lo pone el acumulador despues"		"varDecl variableCategory: PLC_VariableCategoryDecl tempVarDecls.	"		"Guarda y devuelve el Objeto de porgrama generado"	self objectVarDecl: varDecl.		^ varDecl.! !!PLC_VerticalLink methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 16:40'!generateCodeIn: aProgramAccumulator for: aPLC_ConnectableBlock	"Agrega los objetos que genera a aProgramAccumulator.	Como es una instancia nica debo pasarle como parmetro el bloque para el cual quiero que compile	para que pueda leer sus entradas y salidas."		| instruction |		"Suma 1 a la cantidad de entradas que va guardando"	self numberOfCompiledImputs: self numberOfCompiledImputs + 1.			( self numberOfCompiledImputs = self inputs size )		ifTrue: [					"Creo las instrucciones:				OR NOMBREVL.VL_IN1				OR NOMBREVL.VL_IN2				...				OR NOMBREVL.VL_INn-1							NOTA: va ahasta n-1 pues el ultimo valor de entrada lo tiene almacenado en el CR"								( 1 to:  (self inputs size - 1 ) ) do: [ :index |								"Creo una nueva instruccin OR"				instruction := PLC_OR_Instruction new.					instruction modifiers add: PLC_IL_Modifiers NullModifier.										"Aqu le creo de operando a la instrucion OR un objeto que cuando este 				le pide que se compile da por ejemplo, NOMBREVARSTRUC.VARITEM"								instruction operands add: (					PLC_StructureItem 						newWithItem: self objectVarOperand  						andItem: ( self inputs at: index ) operand					).									"Agrego los objetos generados, estos deben entender ilCompile y cCompile"				"self halt.	instruction cCompile."								aProgramAccumulator add: instruction.							"aProgramAccumulator compiledBody cCompile."								].							"Si el VL tiene ms de una salida debe almacenar el valor de esta para repetirlo en las demas"					( self outputs size > 1)				ifTrue: [								"Creo la instruccion ST NOMBREVL.VL_OUT "													"Creo una nueva instruccin ST"					instruction := PLC_ST_Instruction new.					instruction modifiers add: PLC_IL_Modifiers NullModifier.									"Aqu le creo de operando a la instrucion ST un objeto que cuando este 					le pide que se compile da por ejemplo, NOMBREVARSTRUC.VARITEM"					instruction operands add: (						PLC_StructureItem 							newWithItem: self objectVarOperand  							andItem: self outputs first operand						).										"Agrego los objetos generados, estos deben entender ilCompile y cCompile"				"self halt.	instruction cCompile."					aProgramAccumulator add: instruction.							"aProgramAccumulator compiledBody cCompile."																			"Finalmente compilo todos los bloques conectables conectados a las salidas de este VL					intercalando instrucciones LD NOMBREVL.VLOUT para darle al circuito siguiente el					valor correcto de salida. Recordar que el VL repite su valor de salida en todas sus 					salidas"								"Creo la instruccion LD NOMBREVL.VL_OUT "													"Creo una nueva instruccin LD"					instruction := PLC_LD_Instruction new.					instruction modifiers add: PLC_IL_Modifiers NullModifier.									"Aqu le creo de operando a la instrucion ST un objeto que cuando este 					le pide que se compile da por ejemplo, NOMBREVARSTRUC.VARITEM"					instruction operands add: (						PLC_StructureItem 							newWithItem: self objectVarOperand  							andItem: self outputs first operand						).								"Compilo el bloque conectado a la primer salida"					(aPLC_ConnectableBlock blockConnectedToOutput: 1) generateCodeIn: aProgramAccumulator.								"Compilo los bloques conectados a partir de la segunda salida anteponiendo LD NOMBREVL.VL_OUT"					(2 to: self outputs size) do: [ :each | 											"Agrego la instruccion LD NOMBREVL.VL_OUT "				"self halt.	instruction cCompile."						aProgramAccumulator add: instruction.							"aProgramAccumulator compiledBody cCompile."													"Compilo el bloque conectado a la primer salida"						(aPLC_ConnectableBlock blockConnectedToOutput: each) generateCodeIn: aProgramAccumulator.												].					]				ifFalse: [										"Si solo tiene una sola salida simplemente le digo al bloque conectado a 					esa que genere sus objetos de porgrama"					(aPLC_ConnectableBlock blockConnectedToOutput: 1) generateCodeIn: aProgramAccumulator.										].			] 				ifFalse: [							"Creo una nueva instruccin ST"			instruction := PLC_ST_Instruction new.				instruction modifiers add: PLC_IL_Modifiers NullModifier.										"Aqu le creo de operando a la instrucion ST un objeto que cuando este 			le pide que se compile da por ejemplo, NOMBREVARSTRUC.VARITEM"			instruction  operands add: (				PLC_StructureItem 					newWithItem: self objectVarOperand  					andItem: ( self inputs at: self numberOfCompiledImputs ) operand				).							"Agrego los objetos generados, estos deben entender ilCompile y cCompile"				"self halt.	instruction cCompile."			aProgramAccumulator add: instruction.									"aProgramAccumulator compiledBody cCompile."			].! !!PLC_VerticalLink methodsFor: 'graphic element' stamp: 'EricPernia 4/29/2013 16:06'!graphicElementFor: aConnectableBlock	"Devuelve el Elemento grafico (Morph)."		^ PLC_VerticalLinkMorph newFromElement: self.! !!PLC_VerticalLink methodsFor: 'initialize-release' stamp: 'EricPernia 6/12/2013 03:33'!initialize	"Inicializaciones"		super initialize.		"Genera el nombre nico de cada VL"	self identifier: 'VL' , self class numberOfInstances asString.	self class numberOfInstances: self class numberOfInstances + 1.		"Inicio a flase el flag que indica si tiene todas sus entradas"	self numberOfCompiledImputs: 0.		! !!PLC_VerticalLink methodsFor: 'testing' stamp: 'EricPernia 10/10/2012 18:54'!isVerticalLink	"Devuelve true si el elemento es un Vertical Link."	^ true.! !!PLC_VerticalLink methodsFor: 'library' stamp: 'EricPernia 5/31/2013 21:43'!keyword	"Devuelve el symbol del elemento"	^ #VerticalLink ! !!PLC_VerticalLink methodsFor: 'accessing' stamp: 'EricPernia 11/3/2012 23:56'!numberOfCompiledImputs	^ numberOfCompiledImputs! !!PLC_VerticalLink methodsFor: 'accessing' stamp: 'EricPernia 11/3/2012 23:56'!numberOfCompiledImputs: anObject	numberOfCompiledImputs := anObject! !!PLC_VerticalLink methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 15:51'!objectStructDec	"Devuelve el Objeto de programa Declaracion de Variable que genera."		| structDecl outVarDecl |		"Genero una nueva declaracion de tipo de dato estructurado"	structDecl := PLC_StructureDecl newWithIdentifier: ( self identifier , '_STRUCT' ).	"Agrego al tipo las variables de entrada del VL. 	No necesita la ultima pues cuando compila su valor viene en el CR"	self inputs do: [ :each |				" P A R C H E     le clavo una categoria para que haga bien lo de pxPOU->"			"each variableCategory: PLC_VariableCategoryDecl tempVarDecls.	"				structDecl add: each. 		].		"Agrego al tipo la nica variable de salida del VL pues en todas las salidas va el mismo valor"		outVarDecl := self outputs first.		" P A R C H E     le clavo una categoria para que haga bien lo de pxPOU->"		"outVarDecl variableCategory: PLC_VariableCategoryDecl tempVarDecls.	"				structDecl add: outVarDecl.				^ structDecl.! !!PLC_VerticalLink methodsFor: 'compilation' stamp: 'EricPernia 11/4/2012 03:03'!objectTypeDec	"Devuelve el Objeto de programa Declaracion de tipos de datos que genera."		self objectTypeDecl		ifNil: [			^ self createObjectTypeDec.			]		ifNotNil:  [			^ self objectTypeDecl.			]! !!PLC_VerticalLink methodsFor: 'accessing' stamp: 'EricPernia 11/4/2012 02:58'!objectTypeDecl	^ objectTypeDecl! !!PLC_VerticalLink methodsFor: 'accessing' stamp: 'EricPernia 11/4/2012 02:58'!objectTypeDecl: anObject	objectTypeDecl := anObject! !!PLC_VerticalLink methodsFor: 'compilation' stamp: 'EricPernia 11/4/2012 03:03'!objectVarDec	"Devuelve el Objeto de programa Declaracion de Variable que genera."		self objectVarDecl		ifNil: [			^ self createObjectVarDec.			]		ifNotNil:  [			^ self objectVarDecl.			]! !!PLC_VerticalLink methodsFor: 'accessing' stamp: 'EricPernia 11/4/2012 02:58'!objectVarDecl	^ objectVarDecl! !!PLC_VerticalLink methodsFor: 'accessing' stamp: 'EricPernia 11/4/2012 02:58'!objectVarDecl: anObject	objectVarDecl := anObject! !!PLC_VerticalLink methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 15:55'!objectVarOperand	"Devuelve el Objeto de programa Operando de Variable."			^ self objectVarDec operand.! !!PLC_HardwareConfiguration class methodsFor: 'instance creation' stamp: 'EricPernia 11/8/2013 02:58'!newWithName: aString	"Crea una nueva isntancia con el nombre indicado"	| hardConfig |		hardConfig := self new.	hardConfig hardConfigName: aString.		^ hardConfig.! !!PLC_HardwareConfiguration methodsFor: 'devices' stamp: 'EricPernia 11/5/2013 02:06'!addDevice: aDevice	"Aade un dispositivo en un nuevo slot"	self devices add: aDevice.		aDevice hardwareConfiguration: self.		self devicesChange: true.! !!PLC_HardwareConfiguration methodsFor: 'devices' stamp: 'EricPernia 11/5/2013 02:12'!addDevice: aDevice at: index	"Aade el dispositivo aDevice en el slot de indice index"	self devices at: index + 1 put: aDevice.		aDevice hardwareConfiguration: self.		self devicesChange: true.! !!PLC_HardwareConfiguration methodsFor: 'devices' stamp: 'EricPernia 11/5/2013 02:07'!addSlot	"Aade un nuevo slot"	self devices add: nil.		self devicesChange: true.! !!PLC_HardwareConfiguration methodsFor: 'software configuration' stamp: 'EricPernia 11/8/2013 03:17'!createSoftwareConfiguration	"Crea la Configuracin de Software a partir de sus dispositivos"		"Si hubo un cambio de dispositivos, debe crear de nuevo la configuracin de software"	self devicesChange		ifTrue: [ 						"Crea la Configuracin de Software"			self softwareConfiguration: (				PLC_SoftwareConfiguration 					newFromHardwareConfiguration: self				).							"Avisa que ya no hay mas cambios"			self devicesChange: false.						].	^ self softwareConfiguration.		! !!PLC_HardwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 00:17'!devices		^ devices! !!PLC_HardwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 00:17'!devices: anObject		devices := anObject! !!PLC_HardwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 02:03'!devicesChange		^ devicesChange! !!PLC_HardwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 02:03'!devicesChange: anObject		devicesChange := anObject! !!PLC_HardwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 02:56'!hardConfigName	^ self identifier! !!PLC_HardwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 02:55'!hardConfigName: anObject		identifier := anObject! !!PLC_HardwareConfiguration methodsFor: 'initialize-release' stamp: 'EricPernia 11/8/2013 03:13'!initialize	"Inicializaciones de Recurso"	devices := OrderedCollection new.		"Creo la Ranura 0. Es un dispositivo vacio con ese nombre"	self addDevice: (PLC_DevicePLC voidDeviceWithNumber: 0). 		self devicesChange: false.! !!PLC_HardwareConfiguration methodsFor: 'software configuration' stamp: 'EricPernia 11/5/2013 03:19'!program	"Devuelve la Configuracin de Software, si no Exista, la Crea"	self softwareConfiguration		ifNil: [ 			self createSoftwareConfiguration.			].		^ self softwareConfiguration.! !!PLC_HardwareConfiguration methodsFor: 'devices' stamp: 'EricPernia 11/5/2013 02:11'!removeDeviceAt: index	"Remueve el dispositivo en el ndice indicado"	self devices removeAt: index + 1.		self devicesChange: true.! !!PLC_HardwareConfiguration methodsFor: 'devices' stamp: 'EricPernia 11/5/2013 02:12'!removeSlotAt: index	"Remueve el un nuevo slot en el ndice dado"	self devices removeAt: index + 1.		self devicesChange: true.! !!PLC_HardwareConfiguration methodsFor: 'software configuration' stamp: 'EricPernia 11/8/2013 02:46'!resources	"Devuelve una Ordered Collection de Recursos a partir de sus dispositivos"		^ self devices 		collect: [ :device | 			device resource 			].! !!PLC_HardwareConfiguration methodsFor: 'devices' stamp: 'EricPernia 11/5/2013 01:41'!slotFor: aDevice	"Devuelve el numero de slot a la direccin fisica pidiendoselo a la configuracin de hardware"	^ ( self devices indexOf: aDevice ifAbsent: [ ^ nil ] ) - 1.! !!PLC_HardwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 00:17'!softwareConfiguration		^ softwareConfiguration! !!PLC_HardwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 00:17'!softwareConfiguration: anObject		softwareConfiguration := anObject! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:37'!StdFunctions	"Devuelve el diccionario."			^ StdFunctions.! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:38'!UserFunctions	"Devuelve el diccionario."			^ UserFunctions.! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 6/22/2013 03:31'!addStdFunction: aFunctionDecl	"Aade una declaracin de Funcin."			StdFunctions at: aFunctionDecl typedIdentifier put: aFunctionDecl.! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 6/22/2013 03:31'!addUserFunction: aFunctionDecl	"Aade una declaracin de Funcin."			UserFunctions at: aFunctionDecl typedIdentifier put: aFunctionDecl.! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 11/22/2013 16:37'!clearFunctions	"Borra los diccionarios."			self clearStdFunctions.	self clearUserFunctions.! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:25'!clearStdFunctions	"Borra el diccionario."			StdFunctions := Dictionary new.		StdFunctionsCreated := false.! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:25'!clearUserFunctions	"Borra el diccionario."			UserFunctions := Dictionary new.! !!PLC_Function class methodsFor: 'Std Arithmetic' stamp: 'EricPernia 3/25/2016 17:12'!createAddFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar ADD_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'ADD'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).				"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			pxPOU->OUT = pxPOU->IN1 + pxPOU->IN2;			// Las POU Funcion copian su valor de rerotno al CR			CR.VALUE.INT = pxPOU->OUT;			CR.TYPE = ' , 			pouDecl return dataType ilCompile , ';		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Logical' stamp: 'EricPernia 3/25/2016 17:10'!createAndFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar AND_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'AND'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			pxPOU->OUT = pxPOU->IN1 & pxPOU->IN2;			// Las POU Funcion copian su valor de rerotno al CR			CR.VALUE.INT = pxPOU->OUT;			CR.TYPE = ' , 			self return dataType ilCompile , ';		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/15/2013 05:16'!createArithmeticFunctionDeclarations	"Crea y guarda en la biblioteca las funciones Aritmticas"		"ADD"	self createAddFunctionDeclarationWithType: PLC_DataType Int.	self createAddFunctionDeclarationWithType: PLC_DataType DInt.	self createAddFunctionDeclarationWithType: PLC_DataType USInt.	self createAddFunctionDeclarationWithType: PLC_DataType UInt.	self createAddFunctionDeclarationWithType: PLC_DataType SInt.	self createAddFunctionDeclarationWithType: PLC_DataType UDInt.	self createAddFunctionDeclarationWithType: PLC_DataType Real.	self createAddFunctionDeclarationWithType: PLC_DataType LReal.	self createAddFunctionDeclarationWithType: PLC_DataType Time.		"SUB"	self createSubFunctionDeclarationWithType: PLC_DataType Int.	self createSubFunctionDeclarationWithType: PLC_DataType DInt.	self createSubFunctionDeclarationWithType: PLC_DataType USInt.	self createSubFunctionDeclarationWithType: PLC_DataType UInt.	self createSubFunctionDeclarationWithType: PLC_DataType SInt.	self createSubFunctionDeclarationWithType: PLC_DataType UDInt.	self createSubFunctionDeclarationWithType: PLC_DataType Real.	self createSubFunctionDeclarationWithType: PLC_DataType LReal.	self createSubFunctionDeclarationWithType: PLC_DataType Time.		"MUL"	self createMulFunctionDeclarationWithType: PLC_DataType Int.	self createMulFunctionDeclarationWithType: PLC_DataType DInt.	self createMulFunctionDeclarationWithType: PLC_DataType USInt.	self createMulFunctionDeclarationWithType: PLC_DataType UInt.	self createMulFunctionDeclarationWithType: PLC_DataType SInt.	self createMulFunctionDeclarationWithType: PLC_DataType UDInt.	self createMulFunctionDeclarationWithType: PLC_DataType Real.	self createMulFunctionDeclarationWithType: PLC_DataType LReal.	self createMulFunctionDeclarationWithType: PLC_DataType Time.		"DIV"	self createDivFunctionDeclarationWithType: PLC_DataType Int.	self createDivFunctionDeclarationWithType: PLC_DataType DInt.	self createDivFunctionDeclarationWithType: PLC_DataType USInt.	self createDivFunctionDeclarationWithType: PLC_DataType UInt.	self createDivFunctionDeclarationWithType: PLC_DataType SInt.	self createDivFunctionDeclarationWithType: PLC_DataType UDInt.	self createDivFunctionDeclarationWithType: PLC_DataType Real.	self createDivFunctionDeclarationWithType: PLC_DataType LReal.	self createDivFunctionDeclarationWithType: PLC_DataType Time.		"MOD (No permite Reales)"	self createModFunctionDeclarationWithType: PLC_DataType Int.	self createModFunctionDeclarationWithType: PLC_DataType DInt.	self createModFunctionDeclarationWithType: PLC_DataType USInt.	self createModFunctionDeclarationWithType: PLC_DataType UInt.	self createModFunctionDeclarationWithType: PLC_DataType SInt.	self createModFunctionDeclarationWithType: PLC_DataType UDInt.	self createModFunctionDeclarationWithType: PLC_DataType Time.	! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/15/2013 05:23'!createComparisonFunctionDeclarations	"Crea y guarda en la biblioteca las funciones de Comparacin"		"EQ - No tiene sentido comparar por igual en reales"	self createEQFunctionDeclarationWithType: PLC_DataType Int.	self createEQFunctionDeclarationWithType: PLC_DataType DInt.	self createEQFunctionDeclarationWithType: PLC_DataType USInt.	self createEQFunctionDeclarationWithType: PLC_DataType UInt.	self createEQFunctionDeclarationWithType: PLC_DataType SInt.	self createEQFunctionDeclarationWithType: PLC_DataType UDInt.	self createEQFunctionDeclarationWithType: PLC_DataType Time.		"NE - No tiene sentido comparar por distinto en reales"	self createNEFunctionDeclarationWithType: PLC_DataType Int.	self createNEFunctionDeclarationWithType: PLC_DataType DInt.	self createNEFunctionDeclarationWithType: PLC_DataType USInt.	self createNEFunctionDeclarationWithType: PLC_DataType UInt.	self createNEFunctionDeclarationWithType: PLC_DataType SInt.	self createNEFunctionDeclarationWithType: PLC_DataType UDInt.	self createNEFunctionDeclarationWithType: PLC_DataType Time.		"GT"	self createGTFunctionDeclarationWithType: PLC_DataType Int.	self createGTFunctionDeclarationWithType: PLC_DataType DInt.	self createGTFunctionDeclarationWithType: PLC_DataType USInt.	self createGTFunctionDeclarationWithType: PLC_DataType UInt.	self createGTFunctionDeclarationWithType: PLC_DataType SInt.	self createGTFunctionDeclarationWithType: PLC_DataType UDInt.	self createGTFunctionDeclarationWithType: PLC_DataType Real.	self createGTFunctionDeclarationWithType: PLC_DataType LReal.	self createGTFunctionDeclarationWithType: PLC_DataType Time.		"GE - No tiene sentido comparar por mayor o igual en reales"	self createGEFunctionDeclarationWithType: PLC_DataType Int.	self createGEFunctionDeclarationWithType: PLC_DataType DInt.	self createGEFunctionDeclarationWithType: PLC_DataType USInt.	self createGEFunctionDeclarationWithType: PLC_DataType UInt.	self createGEFunctionDeclarationWithType: PLC_DataType SInt.	self createGEFunctionDeclarationWithType: PLC_DataType UDInt.	self createGEFunctionDeclarationWithType: PLC_DataType Time.		"LT"	self createLTFunctionDeclarationWithType: PLC_DataType Int.	self createLTFunctionDeclarationWithType: PLC_DataType DInt.	self createLTFunctionDeclarationWithType: PLC_DataType USInt.	self createLTFunctionDeclarationWithType: PLC_DataType UInt.	self createLTFunctionDeclarationWithType: PLC_DataType SInt.	self createLTFunctionDeclarationWithType: PLC_DataType UDInt.	self createLTFunctionDeclarationWithType: PLC_DataType Real.	self createLTFunctionDeclarationWithType: PLC_DataType LReal.	self createLTFunctionDeclarationWithType: PLC_DataType Time.		"LE - No tiene sentido comparar por menor o igual en reales"	self createLEFunctionDeclarationWithType: PLC_DataType Int.	self createLEFunctionDeclarationWithType: PLC_DataType DInt.	self createLEFunctionDeclarationWithType: PLC_DataType USInt.	self createLEFunctionDeclarationWithType: PLC_DataType UInt.	self createLEFunctionDeclarationWithType: PLC_DataType SInt.	self createLEFunctionDeclarationWithType: PLC_DataType UDInt.	self createLEFunctionDeclarationWithType: PLC_DataType Time.! !!PLC_Function class methodsFor: 'Std Arithmetic' stamp: 'EricPernia 3/25/2016 17:12'!createDivFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar DIV_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'DIV'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			pxPOU->OUT = pxPOU->IN1 / pxPOU->IN2;			// Las POU Funcion copian su valor de rerotno al CR			CR.VALUE.INT = pxPOU->OUT;			CR.TYPE = ' , 			pouDecl return dataType ilCompile , ';		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Comparison' stamp: 'EricPernia 3/25/2016 17:11'!createEQFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar EQ_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'EQ'		andDataType: aDataType		andFunctionResultType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			// Cargo el valor de IN1 al CR // LD IN1			PLC_IL_LD( &(pxPOU->IN1), sizeof(pxPOU->IN1), ' , pouDecl return dataType ilCompile , ', NullModifier);								// Hago la compracin de IN2 contra el CR el resultado se guara en el CR // EQ IN2			PLC_IL_EQ(&(pxPOU->IN2), ' , pouDecl return dataType ilCompile , ');									// Almaceno el CR en OUT // ST OUT  // Las POU Funcion copian su valor de rerotno al CR, en este caso es al reves			PLC_IL_ST( &(pxPOU->OUT), sizeof(pxPOU->OUT), NullModifier); 		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Comparison' stamp: 'EricPernia 3/25/2016 17:11'!createGEFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar GE_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'GE'		andDataType: aDataType		andFunctionResultType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			// Cargo el valor de IN1 al CR // LD IN1			PLC_IL_LD( &(pxPOU->IN1), sizeof(pxPOU->IN1), ' , pouDecl return dataType ilCompile , ', NullModifier);								// Hago la compracin de IN2 contra el CR el resultado se guara en el CR // EQ IN2			PLC_IL_GE(&(pxPOU->IN2), ' , pouDecl return dataType ilCompile , ');										// Almaceno el CR en OUT // ST OUT  // Las POU Funcion copian su valor de rerotno al CR, en este caso es al reves			PLC_IL_ST( &(pxPOU->OUT), sizeof(pxPOU->OUT), NullModifier); 		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Comparison' stamp: 'EricPernia 3/25/2016 17:11'!createGTFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar GT_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'GT'		andDataType: aDataType		andFunctionResultType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			// Cargo el valor de IN1 al CR // LD IN1			PLC_IL_LD( &(pxPOU->IN1), sizeof(pxPOU->IN1), ' , pouDecl return dataType ilCompile , ', NullModifier);								// Hago la compracin de IN2 contra el CR el resultado se guara en el CR // EQ IN2			PLC_IL_GT(&(pxPOU->IN2), ' , pouDecl return dataType ilCompile , ');										// Almaceno el CR en OUT // ST OUT  // Las POU Funcion copian su valor de rerotno al CR, en este caso es al reves			PLC_IL_ST( &(pxPOU->OUT), sizeof(pxPOU->OUT), NullModifier); 		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Comparison' stamp: 'EricPernia 3/25/2016 17:11'!createLEFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar LE_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'LE'		andDataType: aDataType		andFunctionResultType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			// Cargo el valor de IN1 al CR // LD IN1			PLC_IL_LD( &(pxPOU->IN1), sizeof(pxPOU->IN1), ' , pouDecl return dataType ilCompile , ', NullModifier);								// Hago la compracin de IN2 contra el CR el resultado se guara en el CR // EQ IN2			PLC_IL_LE(&(pxPOU->IN2), ' , pouDecl return dataType ilCompile , ');										// Almaceno el CR en OUT // ST OUT  // Las POU Funcion copian su valor de rerotno al CR, en este caso es al reves			PLC_IL_ST( &(pxPOU->OUT), sizeof(pxPOU->OUT), NullModifier); 		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Comparison' stamp: 'EricPernia 3/25/2016 17:10'!createLTFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar LT_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'LT'		andDataType: aDataType		andFunctionResultType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			// Cargo el valor de IN1 al CR // LD IN1			PLC_IL_LD( &(pxPOU->IN1), sizeof(pxPOU->IN1), ' , pouDecl return dataType ilCompile , ', NullModifier);								// Hago la compracin de IN2 contra el CR el resultado se guara en el CR // EQ IN2			PLC_IL_LT(&(pxPOU->IN2), ' , pouDecl return dataType ilCompile , ');										// Almaceno el CR en OUT // ST OUT  // Las POU Funcion copian su valor de rerotno al CR, en este caso es al reves			PLC_IL_ST( &(pxPOU->OUT), sizeof(pxPOU->OUT), NullModifier); 		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Arithmetic' stamp: 'EricPernia 3/25/2016 17:12'!createModFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar MOD_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'MOD'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			pxPOU->OUT = pxPOU->IN1 % pxPOU->IN2;			// Las POU Funcion copian su valor de rerotno al CR			CR.VALUE.INT = pxPOU->OUT;			CR.TYPE = ' , 			pouDecl return dataType ilCompile , ';		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Mov' stamp: 'EricPernia 3/25/2016 17:09'!createMovFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar MOV_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'MOV'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN' 		).									"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			pxPOU->OUT = pxPOU->IN;			// Las POU Funcion copian su valor de rerotno al CR			CR.VALUE.INT = pxPOU->OUT;			CR.TYPE = ' , 			pouDecl return dataType ilCompile , ';		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/15/2013 05:21'!createMovFunctionDeclarations	"Crea y guarda en la biblioteca las funciones Mov"		"MOV"	self createMovFunctionDeclarationWithType: PLC_DataType Int.	self createMovFunctionDeclarationWithType: PLC_DataType DInt.	self createMovFunctionDeclarationWithType: PLC_DataType USInt.	self createMovFunctionDeclarationWithType: PLC_DataType UInt.	self createMovFunctionDeclarationWithType: PLC_DataType SInt.	self createMovFunctionDeclarationWithType: PLC_DataType UDInt.	self createMovFunctionDeclarationWithType: PLC_DataType Real.	self createMovFunctionDeclarationWithType: PLC_DataType LReal.	self createMovFunctionDeclarationWithType: PLC_DataType Time.! !!PLC_Function class methodsFor: 'Std Arithmetic' stamp: 'EricPernia 3/25/2016 17:13'!createMulFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar MUL_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'MUL'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			pxPOU->OUT = pxPOU->IN1 * pxPOU->IN2;			// Las POU Funcion copian su valor de rerotno al CR			CR.VALUE.INT = pxPOU->OUT;			CR.TYPE = ' , 			pouDecl return dataType ilCompile , ';		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'Std Comparison' stamp: 'EricPernia 3/25/2016 17:10'!createNEFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar NE_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'NE'		andDataType: aDataType		andFunctionResultType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			// Cargo el valor de IN1 al CR // LD IN1			PLC_IL_LD( &(pxPOU->IN1), sizeof(pxPOU->IN1), ' , pouDecl return dataType ilCompile , ', NullModifier);								// Hago la compracin de IN2 contra el CR el resultado se guara en el CR // EQ IN2			PLC_IL_NE(&(pxPOU->IN2), ' , pouDecl return dataType ilCompile , ');										// Almaceno el CR en OUT // ST OUT  // Las POU Funcion copian su valor de rerotno al CR, en este caso es al reves			PLC_IL_ST( &(pxPOU->OUT), sizeof(pxPOU->OUT), NullModifier); 		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/18/2013 22:21'!createStandardFunctionDeclarations	"Crea y guarda en la biblioteca las funciones estandar"			"MOV"	self createMovFunctionDeclarations .		"Aritmticas"	self createArithmeticFunctionDeclarations.		"Comparacin"	self createComparisonFunctionDeclarations.	! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 11/22/2013 16:45'!createStdFunctions	"Crea los Bloques de Funcin Estndar."			StdFunctions := Dictionary new.		self createTFStandardFunctionDeclarations. "Si la saco TF a este metodo crea todas sino crea solo con tipos INT y TIME"		StdFunctionsCreated := true.	! !!PLC_Function class methodsFor: 'Std Arithmetic' stamp: 'EricPernia 3/25/2016 17:13'!createSubFunctionDeclarationWithType: aDataType	"Crea y devuelve una Declaracin de Funcin estndar SUB_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'SUB'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunction: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	pouDecl addENDeclaration.	pouDecl addENODeclaration.		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'IN2' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		extern PLC_SymbolicRegister CR;		// Chequeo EN / ENO		if( pxPOU->EN )		{			// Hacer chequeo de si se paso del rango y si se paso poner ENO a 0			// Si da bien el chequeo:			pxPOU->ENO = true;			pxPOU->OUT = pxPOU->IN1 - pxPOU->IN2;			// Las POU Funcion copian su valor de rerotno al CR			CR.VALUE.INT = pxPOU->OUT;			CR.TYPE = ' , 			pouDecl return dataType ilCompile , ';		}		else		{			pxPOU->ENO = 0;		}'.			^ pouDecl.! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/18/2013 22:22'!createTFArithmeticFunctionDeclarations	"Crea y guarda en la biblioteca las funciones Aritmticas"		"ADD"	self createAddFunctionDeclarationWithType: PLC_DataType Int.	"self createAddFunctionDeclarationWithType: PLC_DataType DInt.	self createAddFunctionDeclarationWithType: PLC_DataType USInt.	self createAddFunctionDeclarationWithType: PLC_DataType UInt.	self createAddFunctionDeclarationWithType: PLC_DataType SInt.	self createAddFunctionDeclarationWithType: PLC_DataType UDInt.	self createAddFunctionDeclarationWithType: PLC_DataType Real.	self createAddFunctionDeclarationWithType: PLC_DataType LReal."	self createAddFunctionDeclarationWithType: PLC_DataType Time.		"SUB"	self createSubFunctionDeclarationWithType: PLC_DataType Int.	"self createSubFunctionDeclarationWithType: PLC_DataType DInt.	self createSubFunctionDeclarationWithType: PLC_DataType USInt.	self createSubFunctionDeclarationWithType: PLC_DataType UInt.	self createSubFunctionDeclarationWithType: PLC_DataType SInt.	self createSubFunctionDeclarationWithType: PLC_DataType UDInt.	self createSubFunctionDeclarationWithType: PLC_DataType Real.	self createSubFunctionDeclarationWithType: PLC_DataType LReal."	self createSubFunctionDeclarationWithType: PLC_DataType Time.		"MUL"	self createMulFunctionDeclarationWithType: PLC_DataType Int.	"self createMulFunctionDeclarationWithType: PLC_DataType DInt.	self createMulFunctionDeclarationWithType: PLC_DataType USInt.	self createMulFunctionDeclarationWithType: PLC_DataType UInt.	self createMulFunctionDeclarationWithType: PLC_DataType SInt.	self createMulFunctionDeclarationWithType: PLC_DataType UDInt.	self createMulFunctionDeclarationWithType: PLC_DataType Real.	self createMulFunctionDeclarationWithType: PLC_DataType LReal."	self createMulFunctionDeclarationWithType: PLC_DataType Time.		"DIV"	self createDivFunctionDeclarationWithType: PLC_DataType Int.	"self createDivFunctionDeclarationWithType: PLC_DataType DInt.	self createDivFunctionDeclarationWithType: PLC_DataType USInt.	self createDivFunctionDeclarationWithType: PLC_DataType UInt.	self createDivFunctionDeclarationWithType: PLC_DataType SInt.	self createDivFunctionDeclarationWithType: PLC_DataType UDInt.	self createDivFunctionDeclarationWithType: PLC_DataType Real.	self createDivFunctionDeclarationWithType: PLC_DataType LReal."	self createDivFunctionDeclarationWithType: PLC_DataType Time.		"MOD (No permite Reales)"	self createModFunctionDeclarationWithType: PLC_DataType Int.	"self createModFunctionDeclarationWithType: PLC_DataType DInt.	self createModFunctionDeclarationWithType: PLC_DataType USInt.	self createModFunctionDeclarationWithType: PLC_DataType UInt.	self createModFunctionDeclarationWithType: PLC_DataType SInt.	self createModFunctionDeclarationWithType: PLC_DataType UDInt."	self createModFunctionDeclarationWithType: PLC_DataType Time.	! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/18/2013 22:20'!createTFComparisonFunctionDeclarations	"Crea y guarda en la biblioteca las funciones de Comparacin"		"EQ - No tiene sentido comparar por igual en reales"	self createEQFunctionDeclarationWithType: PLC_DataType Int.	"self createEQFunctionDeclarationWithType: PLC_DataType DInt.	self createEQFunctionDeclarationWithType: PLC_DataType USInt.	self createEQFunctionDeclarationWithType: PLC_DataType UInt.	self createEQFunctionDeclarationWithType: PLC_DataType SInt.	self createEQFunctionDeclarationWithType: PLC_DataType UDInt."	self createEQFunctionDeclarationWithType: PLC_DataType Time.		"NE - No tiene sentido comparar por distinto en reales"	self createNEFunctionDeclarationWithType: PLC_DataType Int.	"self createNEFunctionDeclarationWithType: PLC_DataType DInt.	self createNEFunctionDeclarationWithType: PLC_DataType USInt.	self createNEFunctionDeclarationWithType: PLC_DataType UInt.	self createNEFunctionDeclarationWithType: PLC_DataType SInt.	self createNEFunctionDeclarationWithType: PLC_DataType UDInt."	self createNEFunctionDeclarationWithType: PLC_DataType Time.		"GT"	self createGTFunctionDeclarationWithType: PLC_DataType Int.	"self createGTFunctionDeclarationWithType: PLC_DataType DInt.	self createGTFunctionDeclarationWithType: PLC_DataType USInt.	self createGTFunctionDeclarationWithType: PLC_DataType UInt.	self createGTFunctionDeclarationWithType: PLC_DataType SInt.	self createGTFunctionDeclarationWithType: PLC_DataType UDInt.	self createGTFunctionDeclarationWithType: PLC_DataType Real.	self createGTFunctionDeclarationWithType: PLC_DataType LReal."	self createGTFunctionDeclarationWithType: PLC_DataType Time.		"GE - No tiene sentido comparar por mayor o igual en reales"	self createGEFunctionDeclarationWithType: PLC_DataType Int.	"self createGEFunctionDeclarationWithType: PLC_DataType DInt.	self createGEFunctionDeclarationWithType: PLC_DataType USInt.	self createGEFunctionDeclarationWithType: PLC_DataType UInt.	self createGEFunctionDeclarationWithType: PLC_DataType SInt.	self createGEFunctionDeclarationWithType: PLC_DataType UDInt."	self createGEFunctionDeclarationWithType: PLC_DataType Time.		"LT"	self createLTFunctionDeclarationWithType: PLC_DataType Int.	"self createLTFunctionDeclarationWithType: PLC_DataType DInt.	self createLTFunctionDeclarationWithType: PLC_DataType USInt.	self createLTFunctionDeclarationWithType: PLC_DataType UInt.	self createLTFunctionDeclarationWithType: PLC_DataType SInt.	self createLTFunctionDeclarationWithType: PLC_DataType UDInt.	self createLTFunctionDeclarationWithType: PLC_DataType Real.	self createLTFunctionDeclarationWithType: PLC_DataType LReal."	self createLTFunctionDeclarationWithType: PLC_DataType Time.		"LE - No tiene sentido comparar por menor o igual en reales"	self createLEFunctionDeclarationWithType: PLC_DataType Int.	"self createLEFunctionDeclarationWithType: PLC_DataType DInt.	self createLEFunctionDeclarationWithType: PLC_DataType USInt.	self createLEFunctionDeclarationWithType: PLC_DataType UInt.	self createLEFunctionDeclarationWithType: PLC_DataType SInt.	self createLEFunctionDeclarationWithType: PLC_DataType UDInt."	self createLEFunctionDeclarationWithType: PLC_DataType Time.! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/18/2013 22:22'!createTFMovFunctionDeclarations	"Crea y guarda en la biblioteca las funciones Mov"		"MOV"	self createMovFunctionDeclarationWithType: PLC_DataType Int.	"self createMovFunctionDeclarationWithType: PLC_DataType DInt.	self createMovFunctionDeclarationWithType: PLC_DataType USInt.	self createMovFunctionDeclarationWithType: PLC_DataType UInt.	self createMovFunctionDeclarationWithType: PLC_DataType SInt.	self createMovFunctionDeclarationWithType: PLC_DataType UDInt.	self createMovFunctionDeclarationWithType: PLC_DataType Real.	self createMovFunctionDeclarationWithType: PLC_DataType LReal."	self createMovFunctionDeclarationWithType: PLC_DataType Time.! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/18/2013 22:21'!createTFStandardFunctionDeclarations	"Crea y guarda en la biblioteca las funciones estandar"			"MOV"	self createTFMovFunctionDeclarations .		"Aritmticas"	self createTFArithmeticFunctionDeclarations.		"Comparacin"	self createTFComparisonFunctionDeclarations.	! !!PLC_Function class methodsFor: 'std functions' stamp: 'EricPernia 11/5/2013 12:56'!createTestIntFunctionDeclaration	"Crea y devuelve una Declaracin de Funcin estndar TEST_INT"	| function |		"Declaracion de funcionTEST_INT"	function := PLC_Function		newWithName: 'TEST'		andDataType: PLC_DataType Int		andFunctionResultType: PLC_DataType Int.			PLC_Function addStdFunction: function.	"Agrego una declaracion de variable de entrada 	EN y una de salida ENO, ambas booleanas."	function addENDeclaration.	function addENODeclaration.		"Agrego una declaracion de variable de entrada"	function inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'IN1' 		).					"Agrego una declaracion de variable de entrada"	function inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'IN2' 		).				"Agrego una declaracion de variable de salida"	function outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'OUT1' 		).				"Agrego una declaracion de variable de salida"	function outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'OUT2' 		).				"Agrego una declaracion de variable de entrada-salida"	function inOutVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'IOc vcv v cvxc vcxv xcvx cv vcxv' 		).				"Agrego una declaracion de variable de entrada-salida"	function inOutVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'IO2 aaa sa asas aasasas asa' 		).			^ function.! !!PLC_Function class methodsFor: 'class initialization' stamp: 'EricPernia 11/22/2013 16:38'!initialize 	"comment stating purpose of message"	super initialize.		self clearFunctions.! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 11/16/2013 13:40'!newWithName: anIdentifier andDataType: aPLC_DataType	"Nuevo con nombre y tipo de datos"	| function |		function := self newWithName: anIdentifier.		function dataType: aPLC_DataType.		function declarations returnVarDecl add: ( PLC_SymbolicVariableDecl		newWithDataType: aPLC_DataType 		andInitialValue: nil 		andIdentifier: 'OUT' ).	"La variable de RETURN se llama OUT No Ret o Ret_Val"			function dataType: aPLC_DataType.			"Agregar a diccionario de Funciones"	"Hacerrrrrrrrrr de la forma :	PLC_FunctionDeclaration  add: function."			^ function.! !!PLC_Function class methodsFor: 'instance creation' stamp: 'EricPernia 11/16/2013 13:40'!newWithName: anIdentifier andDataType: aPLC_DataType andFunctionResultType: anotherPLC_DataType	"Nuevo con nombre y tipo de datos		ESTE METODO SIRVE PARA HACER LAS FUNCIONES DE COMPARACION POR EJEJMPLO. 		Sirve para que una funcin tenga un tipo de datos de Return distinto al tipo de datos de la POU (de sobrecarga)"	| function |		function := self newWithName: anIdentifier.			function dataType: aPLC_DataType.		function declarations returnVarDecl add: ( PLC_SymbolicVariableDecl		newWithDataType: anotherPLC_DataType 		andInitialValue: nil 		andIdentifier: 'OUT' ).			"Agregar a diccionario de Funciones"	"Hacerrrrrrrrrr de la forma :	PLC_FunctionDeclaration  add: function."			^ function.! !!PLC_Function methodsFor: 'compilation' stamp: 'EricPernia 3/25/2016 17:22'!cCompile	"Definicinn de Funcin en C que implementa la POU.		Ejemplo:	void ProgEj ( PLC_P_Struct_ProgEj * pxPOU )	{		// Cuerpo de POU				PLC_IL_LD ( &( pxPOU -> Ent1 ), sizeof (pxPOU -> Ent1 ), BOOL , NullModifier ); // LD Ent1				PLC_IL_AND ( &( pxPOU -> Ent2 ), BOOL , NullModifier ); // AND Ent2				PLC_IL_ST ( &( pxPOU ->Sal), sizeof (pxPOU ->Sal), NullModifier ); // ST Sal	}."		| progAcc cCode |		"Creo el acumulador de objetos de programa."	progAcc := PLC_ProgramAccumulator_POU new.			"	LAS POU NO ADMITEN VAR_GLOBAL	y las F no tienen VAR_EXTERN, ni VAR_TEMP y pisan antes del cuerpo de POU las VAR 		Dentro de la estructura de instancia:		self declarations inputVarDecls	self declarations outputVarDecls	self declarations inOutVarDecls	self declarations varDecls		Dentro de la funcion de la POU en C:		self declarations constantVarDecls 		progAcc compilerDataTypesDecls cCompile.	progAcc compilerVarDecls cCompile.	progAcc compiledBody	 cCompile.	"		"Le envio la peticin al Cuerpo de POU de que se compile en el acumulador"	self pouBody generateCodeIn: progAcc.		cCode := '	void ' , self cPOUName , '( ' , self declarations typeDeclarationIdentifier , ' *pxPOU )	{			// Declaraciones de Tipos de datos del compilador		'.			cCode := cCode , progAcc compilerDataTypesDecls cCompile , '			// Declaraciones de variables del compilador		'.			cCode := cCode , progAcc compilerVarDecls cCompile , '			// Declaraciones de variables del usuario		',		self declarations constantVarDecls cCompile.			"ACA FALTA QUE EN FUNCTION PISE CONCERO A LAS VAR INTERNAS PARAQUENOTENGA MEMORIA"		cCode := cCode , '			// Cuerpo de POU		',	progAcc compiledBody cCompile.			cCode := cCode, '		}'.		^ cCode.! !!PLC_Function methodsFor: 'compilation' stamp: 'EricPernia 11/16/2013 13:45'!ilCompile	"Definicin de POU en IL.		Ejemplo:	FUNCTION Fej : INT			(* Declaraciones de POU *)			VAR_INPUT				Ent1 : BOOL ;				Ent2 : BOOL ;			END_VAR						VAR_OUTPUT				Sal : BOOL ;			END_VAR					(* Cuerpo de POU *)					LD Ent1			AND Ent2			ST Sal				END_FUNCTION		"		| progAcc ilCode |		"Creo el acumulador de objetos de programa."	progAcc := PLC_ProgramAccumulator_POU new.			"	LAS POU NO ADMITEN VAR_GLOBAL		Dentro de la estructura de instancia:		self declarations inputVarDecls	self declarations outputVarDecls	self declarations inOutVarDecls	self declarations varDecls		Dentro de la funcion de la POU en C:		self declarations constantVarDecls 	self declarations tempVarDecls 	self declarations externVarDecls 		progAcc compilerDataTypesDecls cCompile.	progAcc compilerVarDecls cCompile.	progAcc compiledBody	 cCompile.	"		"Le envio la peticin al Cuerpo de POU de que se compile en el acumulador"	self pouBody generateCodeIn: progAcc.		ilCode := '	' , self pouType , ' ' , self identifier , ' : ' , self return dataType ilCompile , '			 (* Declaraciones de Tipos de datos del compilador *)		'.			ilCode := ilCode , progAcc compilerDataTypesDecls ilCompile , '				 (* Declaraciones de variables del compilador *)		'.			ilCode := ilCode , progAcc compilerVarDecls ilCompile , '			 (* Declaraciones de variables del usuario *)		',	self declarations inputVarDecls ilCompile ,	self declarations outputVarDecls ilCompile ,	self declarations inOutVarDecls ilCompile ,	self declarations varDecls ilCompile ,	self declarations constantVarDecls ilCompile .		ilCode := ilCode , '			 (* Cuerpo de POU *)		',	progAcc compiledBody ilCompile.			ilCode := ilCode, '				END_' , self pouType.		^ ilCode.! !!PLC_Function methodsFor: 'initialize-release' stamp: 'EricPernia 11/16/2013 13:50'!initialize.	"Inicializo la declaracin de Funcin."	super initialize.	"Declaraciones de Variables y Tipos de Datos"	self declarations: ( PLC_Function_Declarations functionDeclarationsWithPOUDeclaration: self ).! !!PLC_Function methodsFor: 'instance' stamp: 'EricPernia 11/15/2013 01:43'!instanceDecl	"Devuelve la variable de instancia nica de la declaracin de Funcin."	instance		ifNil: [ 			instance :=  self instanceDeclWithIdentifier: nil.			].			^ instance.! !!PLC_Function methodsFor: 'instance' stamp: 'EricPernia 11/15/2013 01:44'!instanceDeclWithIdentifier: anIdentifier	"Devuelve una nueva variable de instancia de la declaracin de Programa o Bloque de Funcin."		anIdentifier 		ifNil: [			instance := PLC_InstanceVariableDecl				newWithDataType: self typeDeclaration 				andInitialValue: nil				andIdentifier: self typedIdentifier , '_VAR'.			]		ifNotNil: [			instance := PLC_InstanceVariableDecl 				newWithDataType: self typeDeclaration 				andInitialValue: nil				andIdentifier: anIdentifier.			].	^ instance.! !!PLC_Function methodsFor: 'POU type' stamp: 'EricPernia 6/21/2013 04:41'!pouType	"Devuelve el tipo de POU que es."	^ 'FUNCTION'! !!PLC_Function methodsFor: 'POU type' stamp: 'EricPernia 6/21/2013 04:50'!pouTypeAcronym	"Devuelve las siglas del tipo de POU que es."	^ 'F'! !!PLC_Function methodsFor: 'instance' stamp: 'EricPernia 6/21/2013 05:38'!resetInstance	"Borra la variable de instancia en caso de modificacin de la Declaracin de Funcin."	instance := nil.! !!PLC_Function methodsFor: 'accessing' stamp: 'EricPernia 11/16/2013 13:41'!return	^ self declarations returnVarDecl first! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:43'!StdFunctionBlocks	"Devuelve el diccionario."		^ StdFunctionBlocks.! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:43'!UserFunctionBlocks	"Devuelve el diccionario."		^ UserFunctionBlocks.! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 6/22/2013 03:32'!addStdFunctionBlock: aFunctionBlockDecl	"Aade una declaracin de Bloque de Funcin."			StdFunctionBlocks at: aFunctionBlockDecl typedIdentifier put: aFunctionBlockDecl.! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 6/22/2013 03:31'!addUserFunctionBlock: aFunctionBlockDecl	"Aade una declaracin de Bloque de Funcin."			UserFunctionBlocks at: aFunctionBlockDecl typedIdentifier put: aFunctionBlockDecl.! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 11/22/2013 16:46'!clearFunctionBlocks	"Borra los diccionarios."			self clearStdFunctionBlocks.	self clearUserFunctionBlocks.! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 11/19/2013 00:04'!clearStdFunctionBlocks	"Borra el diccionario."			StdFunctionBlocks := Dictionary new.		StdFunctionBlocksCreated := false.! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:26'!clearUserFunctionBlocks	"Borra el diccionario."			UserFunctionBlocks := Dictionary new.! !!PLC_FunctionBlock class methodsFor: 'Std Function Blocks' stamp: 'EricPernia 11/18/2013 23:36'!createBiestableFunctionBlockDeclarations	"Crea y guarda en la biblioteca los bloques de funcion de temporizadores"		"SR"	self createSRFunctionBlockDeclaration.		"RS"	self createRSFunctionBlockDeclaration.! !!PLC_FunctionBlock class methodsFor: 'Std Counters' stamp: 'EricPernia 11/19/2013 07:06'!createCTDFunctionBlockDeclarationWithType: aDataType	"Crea y devuelve una Declaracin del Bloque de Funcin estndar CTD_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'CTD'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'CD' 		).		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LD' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'PV' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q' 		).				"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'CV' 		).							"Agrego una declaracion de variable interna persistente de instancia"	"( StdFunctionBlocks at: 'R_EDGE_BOOL' ) Obtengo la declaracin de REDGE desde la biblioteca"	pouDecl varDecls add: ( 		( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL')			instanceDeclForForFBWithIdentifier: 'R_TRIG_IN'		).	"CUERPO DE LA POU"	"Es un cuerpo estandar"	pouDecl pouBody: PLC_StandardBody new.		"Agrego la POU que llama esta pou estandar en su interior"	pouDecl pouBody calledPOUs: ( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL').		pouDecl pouBody cCode: '			const PLC_INT PVmin = -32768; // Ver esto que esta medio confuso en el estandar,									  // le puse el minimo de PLC Int												// Utilizacin del FB instancia R_TRIG_IN.		// Lo que sigue implementa: CAL R_TRIG_IN(CLK:=CD, Q=>CD)		(pxPOU->R_TRIG_IN).CLK = pxPOU->CD;	// Completo los parametros VAR_INPUT de REDGE		PLC_FB_R_TRIG_BOOL( &(pxPOU->R_TRIG_IN) );	// Llamo a la funcin pasandole la estructura por referencia		pxPOU->CD = (pxPOU->R_TRIG_IN).Q;	// Grabo los parametros VAR_OUTPUT de REDGE a las variables													// a las cuales estan igualadas las VAR_OUTPUT de REDGE		if( pxPOU->LD )		{			pxPOU->CV = pxPOU->PV;		}		else		{			if( pxPOU->CD && (pxPOU->CV > PVmin) )			{				(pxPOU->CV)--;			}		}		pxPOU->Q = (pxPOU->CV <= 0);'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Counters' stamp: 'EricPernia 11/19/2013 07:07'!createCTUDFunctionBlockDeclarationWithType: aDataType	"Crea y devuelve una Declaracin del Bloque de Funcin estndar CTUD_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'CTUD'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'CU' 		).		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'CD' 		).		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'R' 		).		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LD' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'PV' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'QU' 		).				"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'QD' 		).				"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'CV' 		).							"Agrego una declaracion de variable interna persistente de instancia"	"( StdFunctionBlocks at: 'R_EDGE_BOOL' ) Obtengo la declaracin de REDGE desde la biblioteca"	pouDecl varDecls add: ( 		( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL')			instanceDeclForForFBWithIdentifier: 'R_TRIG_IN1'		).							"Agrego una declaracion de variable interna persistente de instancia"	"( StdFunctionBlocks at: 'R_EDGE_BOOL' ) Obtengo la declaracin de REDGE desde la biblioteca"	pouDecl varDecls add: ( 		( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL')			instanceDeclForForFBWithIdentifier: 'R_TRIG_IN2'		).	"CUERPO DE LA POU"	"Es un cuerpo estandar"	pouDecl pouBody: PLC_StandardBody new.		"Agrego la POU que llama esta pou estandar en su interior"	pouDecl pouBody calledPOUs: ( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL').			pouDecl pouBody cCode: '		const PLC_INT PVmax = 32767; // Ver esto que esta medio confuso en el estandar,									 // le puse el maximo de PLC Int		const PLC_INT PVmin = -32768; // Ver esto que esta medio confuso en el estandar,									  // le puse el minimo de PLC Int		(pxPOU->R_TRIG_IN1).CLK = pxPOU->CU;			PLC_FB_R_TRIG_BOOL( &(pxPOU->R_TRIG_IN1) );			pxPOU->CU = (pxPOU->R_TRIG_IN1).Q;			(pxPOU->R_TRIG_IN2).CLK = pxPOU->CD;			PLC_FB_R_TRIG_BOOL( &(pxPOU->R_TRIG_IN2) );			pxPOU->CD = (pxPOU->R_TRIG_IN2).Q;			if( pxPOU->R )		{			pxPOU->CV = 0;		}		else		{			if( pxPOU->LD )			{				pxPOU->CV = pxPOU->PV;			}			if( !!(pxPOU->CU && pxPOU->CD) )			{				if( pxPOU->CU && ( pxPOU->CV < PVmax) )				{					(pxPOU->CV)++;				}				else				{					if( pxPOU->CD && ( pxPOU->CV > PVmin) )					{						(pxPOU->CV)--;					}				}			}		}		pxPOU->QU = (pxPOU->CV >= pxPOU->PV);		pxPOU->QD = (pxPOU->CV <= 0);'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Counters' stamp: 'EricPernia 11/19/2013 07:07'!createCTUFunctionBlockDeclarationWithType: aDataType	"Crea y devuelve una Declaracin del Bloque de Funcin estndar CTU_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'CTU'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'CU' 		).		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'R' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'PV' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q' 		).				"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'CV' 		).							"Agrego una declaracion de variable interna persistente de instancia"	"( StdFunctionBlocks at: 'R_EDGE_BOOL' ) Obtengo la declaracin de REDGE desde la biblioteca"	pouDecl varDecls add: ( 		( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL')			instanceDeclForForFBWithIdentifier: 'R_TRIG_IN'		).	"CUERPO DE LA POU"	"Es un cuerpo estandar"	pouDecl pouBody: PLC_StandardBody new.		"Agrego la POU que llama esta pou estandar en su interior"	pouDecl pouBody calledPOUs: ( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL').		pouDecl pouBody cCode: '			const PLC_INT PVmax = 32767;			// Utilizacin del FB instancia R_TRIG_IN.		// Lo que sigue implementa: CAL R_TRIG_IN(CLK:=CU, Q=>CU)		(pxPOU->R_TRIG_IN).CLK = pxPOU->CU;	// Completo los parametros VAR_INPUT de REDGE		PLC_FB_R_TRIG_BOOL( &(pxPOU->R_TRIG_IN) );	// Llamo a la funcin pasandole la estructura por referencia		pxPOU->CU = (pxPOU->R_TRIG_IN).Q;	// Grabo los parametros VAR_OUTPUT de REDGE a las variables													// a las cuales estan igualadas las VAR_OUTPUT de REDGE		if( pxPOU->R )		{			pxPOU->CV = 0;		}		else		{			if( pxPOU->CU && (pxPOU->CV < PVmax) )			{				(pxPOU->CV)++;			}		}		pxPOU->Q = (pxPOU->CV >= pxPOU->PV);		'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Function Blocks' stamp: 'EricPernia 11/19/2013 07:00'!createCounterFunctionBlockDeclarations	"Crea y guarda en la biblioteca los bloques de funcion Contadores"		"CTU"	self createCTUFunctionBlockDeclarationWithType: PLC_DataType Int.	"CTD"	self createCTDFunctionBlockDeclarationWithType:  PLC_DataType Int.		"CTUD"	self createCTUDFunctionBlockDeclarationWithType:  PLC_DataType Int.		! !!PLC_FunctionBlock class methodsFor: 'Std Function Blocks' stamp: 'EricPernia 11/18/2013 23:37'!createEdgeFunctionBlockDeclarations	"Crea y guarda en la biblioteca los bloques de funcion de temporizadores"		"R_TRIG"	self createR_TRIGFunctionBlockDeclaration.		"F_TRIG"	self createF_TRIGFunctionBlockDeclaration.! !!PLC_FunctionBlock class methodsFor: 'Std Edge' stamp: 'EricPernia 11/18/2013 23:31'!createF_TRIGFunctionBlockDeclaration	"Crea y devuelve una Declaracin del Bloque de Funcin estndar F_TRIG_BOOL"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'F_TRIG'		andDataType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'CLK' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'Q' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'M' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		pxPOU->Q = !!(pxPOU->CLK) && !!(pxPOU->M);		pxPOU->M = !!(pxPOU->CLK);'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Biestable' stamp: 'EricPernia 11/18/2013 23:25'!createRSFunctionBlockDeclaration	"Crea y devuelve una Declaracin del Bloque de Funcin estndar RS_BOOL"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'RS'		andDataType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'S' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'R1' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'Q1' 		).				"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		pxPOU->Q1 = !!(pxPOU->R1) && ( pxPOU->S || pxPOU->Q1 );'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Edge' stamp: 'EricPernia 11/18/2013 23:30'!createR_TRIGFunctionBlockDeclaration	"Crea y devuelve una Declaracin del Bloque de Funcin estndar R_TRIG_BOOL"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'R_TRIG'		andDataType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'CLK' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'Q' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'M' 		).					"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		pxPOU->Q = pxPOU->CLK && !!(pxPOU->M);		pxPOU->M = pxPOU->CLK;'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Biestable' stamp: 'EricPernia 11/18/2013 23:24'!createSRFunctionBlockDeclaration	"Crea y devuelve una Declaracin del Bloque de Funcin estndar SR_BOOL"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'SR'		andDataType: PLC_DataType Bool.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'S1' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'R' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'Q1' 		).				"CUERPO DE LA POU"	pouDecl pouBody: PLC_StandardBody new.	pouDecl pouBody cCode: '		pxPOU->Q1 = pxPOU->S1 || ( !!(pxPOU->R) && pxPOU->Q1 );		// Ver si va ~ o !! para negar una variable booleana. Si va !! implementar como las de abajo.'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Function Blocks' stamp: 'EricPernia 11/19/2013 07:02'!createStdFunctionBlockDeclarations	"Crea y guarda en la biblioteca los bloques de funcion de temporizadores"		"BIESTABLES"	self createBiestableFunctionBlockDeclarations.		"EDGE DETECTORS"	self createEdgeFunctionBlockDeclarations.		"TIMERS"	self createTimerFunctionBlockDeclarations.		"COUNTERS"	self createCounterFunctionBlockDeclarations.! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 11/22/2013 16:48'!createStdFunctionBlocks	"Crea los Bloques de Funcin Estndar."			StdFunctionBlocks := Dictionary new.		self createStdFunctionBlockDeclarations. 		StdFunctionBlocksCreated := true.! !!PLC_FunctionBlock class methodsFor: 'Std Timers' stamp: 'EricPernia 5/7/2015 08:40'!createTOFFunctionBlockDeclaration	"Crea y devuelve una Declaracin del Bloque de Funcin estndar TOF_Time"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'TOF'		andDataType: PLC_DataType Time.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.			"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'IN' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'PT' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q' 		).				"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'ET' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'PLC_START' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'PLC_RUNNING' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'EDGE' 		).				"Agrego una declaracion de variable interna persistente de instancia"	"( StdFunctionBlocks at: 'R_EDGE_BOOL' ) Obtengo la declaracin de REDGE desde la biblioteca"	pouDecl varDecls add: ( 		( PLC_FunctionBlock StdFunctionBlocks at: 'F_TRIG_BOOL')			instanceDeclForForFBWithIdentifier: 'F_TRIG_IN'		).	"CUERPO DE LA POU"	"Es un cuerpo estandar"	pouDecl pouBody: PLC_StandardBody new.		"Agrego la POU que llama esta pou estandar en su interior"	pouDecl pouBody calledPOUs: ( PLC_FunctionBlock StdFunctionBlocks at: 'F_TRIG_BOOL').			pouDecl pouBody cCode: '		// Utilizacin del FB instancia F_TRIG_IN.		// Lo que sigue implementa: CAL F_TRIG_IN(CLK:=IN, Q=>EDGE)		(pxPOU->F_TRIG_IN).CLK = pxPOU->IN;		// Completo los parametros VAR_INPUT de FEDGE		PLC_FB_F_TRIG_BOOL( &(pxPOU->F_TRIG_IN) );	// Llamo a la funcin pasandole la estructura por referencia		pxPOU->EDGE = (pxPOU->F_TRIG_IN).Q;	// Grabo los parametros VAR_OUTPUT de FEDGE a las variables														// a las cuales estan igualadas las VAR_OUTPUT de FEDGE		// Si la entrada IN es 1 , entonces Q = 1 y ET = 0		if ( pxPOU->IN ){			pxPOU->Q = true;			pxPOU->ET = 0;		}		// Si contando == 0 (no esta contando) y hay flanco descendente, arranca a contar		if ( pxPOU->EDGE && !!(pxPOU->PLC_RUNNING) ){			pxPOU->PLC_START = PLC_GetTimersTime();	// Obtiene el tiempo inicial de ticks			pxPOU->PLC_RUNNING = true; 					// Comienza a contar el tiempo de pulso		}		// Si est contando		if ( pxPOU->PLC_RUNNING ){			pxPOU->ET = PLC_GetTimersTime() - pxPOU->PLC_START; // Calcula el tiempo transcurrido ET			// Si ET >= PT entonces termina de contar y satura el valor de ET en PT			if ( (pxPOU->ET) >= (pxPOU->PT) ){				pxPOU->ET = pxPOU->PT;			// Satura el valor de ET en PT				pxPOU->PLC_RUNNING = false;			// Deja de Contar				pxPOU->Q = false; 					// Apaga la salida de pulso			}		}'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Timers' stamp: 'EricPernia 5/7/2015 08:39'!createTONFunctionBlockDeclaration	"Crea y devuelve una Declaracin del Bloque de Funcin estndar TON_Time"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'TON'		andDataType: PLC_DataType Time.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'IN' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'PT' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q' 		).				"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'ET' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'PLC_START' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'PLC_RUNNING' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'EDGE' 		).				"Agrego una declaracion de variable interna persistente de instancia"	"( StdFunctionBlocks at: 'R_EDGE_BOOL' ) Obtengo la declaracin de REDGE desde la biblioteca"	pouDecl varDecls add: ( 		( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL')			instanceDeclForForFBWithIdentifier: 'R_TRIG_IN'		).	"CUERPO DE LA POU"	"Es un cuerpo estandar"	pouDecl pouBody: PLC_StandardBody new.		"Agrego la POU que llama esta pou estandar en su interior"	pouDecl pouBody calledPOUs: ( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL').			pouDecl pouBody cCode: '		// Utilizacin del FB instancia R_TRIG_IN.		// Lo que sigue implementa: CAL R_TRIG_IN(CLK:=IN, Q=>EDGE)		(pxPOU->R_TRIG_IN).CLK = pxPOU->IN;	// Completo los parametros VAR_INPUT de REDGE		PLC_FB_R_TRIG_BOOL( &(pxPOU->R_TRIG_IN) );	// Llamo a la funcin pasandole la estructura por referencia		pxPOU->EDGE = (pxPOU->R_TRIG_IN).Q;	// Grabo los parametros VAR_OUTPUT de REDGE a las variables													// a las cuales estan igualadas las VAR_OUTPUT de REDGE		// Si hay flanco ascendente, arranca a contar		if ( pxPOU->EDGE ){			pxPOU->PLC_START = PLC_GetTimersTime();	// Obtiene el tiempo inicial de ticks			pxPOU->PLC_RUNNING = true; 					// Comienza a contar el tiempo de pulso		}		// Si est contando		if ( pxPOU->PLC_RUNNING ){			pxPOU->ET = PLC_GetTimersTime() - pxPOU->PLC_START; 	// Calcula el tiempo transcurrido ET			// Si ET >= PT entonces termina de contar y satura el valor de ET en PT			if ( (pxPOU->ET) >= (pxPOU->PT) ){				pxPOU->Q = true; 				// Enciende la salida de pulso				pxPOU->ET = pxPOU->PT;		// Satura el valor de ET en PT				pxPOU->PLC_RUNNING = false;		// Deja de Contar			}		}		// Si la entrada IN es 0 , entonces ET y Q quedan en 0		if ( !!(pxPOU->IN) ){			pxPOU->ET = 0;				// ET = 0			pxPOU->Q = false; 				// Apaga la salida de pulso			pxPOU->PLC_RUNNING = false;		// Deja de Contar		}'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Timers' stamp: 'EricPernia 5/7/2015 08:39'!createTPFunctionBlockDeclaration	"Crea y devuelve una Declaracin del Bloque de Funcin estndar TP_Time"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'TP'		andDataType: PLC_DataType Time.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'IN' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'PT' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q' 		).				"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'ET' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: pouDecl dataType			andInitialValue: nil 			andIdentifier: 'PLC_START' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'PLC_RUNNING' 		).				"Agrego una declaracion de variable interna persistente"	pouDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'EDGE' 		).				"Agrego una declaracion de variable interna persistente de instancia"	"( StdFunctionBlocks at: 'R_EDGE_BOOL' ) Obtengo la declaracin de REDGE desde la biblioteca"	pouDecl varDecls add: ( 		( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL')			instanceDeclForForFBWithIdentifier: 'R_TRIG_IN'		).	"CUERPO DE LA POU"	"Es un cuerpo estandar"	pouDecl pouBody: PLC_StandardBody new.		"Agrego la POU que llama esta pou estandar en su interior"	pouDecl pouBody calledPOUs: ( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL').		pouDecl pouBody cCode: '		// Utilizacin del FB instancia R_TRIG_IN.		// Lo que sigue implementa: CAL R_TRIG_IN(CLK:=IN, Q=>EDGE)		(pxPOU->R_TRIG_IN).CLK = pxPOU->IN;	// Completo los parametros VAR_INPUT de REDGE		PLC_FB_R_TRIG_BOOL( &(pxPOU->R_TRIG_IN) );	// Llamo a la funcin pasandole la estructura por referencia		pxPOU->EDGE = (pxPOU->R_TRIG_IN).Q;	// Grabo los parametros VAR_OUTPUT de REDGE a las variables													// a las cuales estan igualadas las VAR_OUTPUT de REDGE		// Si contando == 0 (no esta contando) y hay flanco ascendente, arranca a contar		if ( pxPOU->EDGE && !!(pxPOU->PLC_RUNNING) ){			pxPOU->PLC_START = PLC_GetTimersTime();	// Obtiene el tiempo inicial de ticks			pxPOU->PLC_RUNNING = true; 				// Comienza a contar el tiempo de pulso			pxPOU->Q = true; 					// Enciende la salida de pulso		}		// Si est contando		if ( pxPOU->PLC_RUNNING ){			pxPOU->ET = PLC_GetTimersTime() - pxPOU->PLC_START; 	// Calcula el tiempo transcurrido ET = t1 - t0			// Si ET >= PT entonces termina de contar y satura el valor de ET en PT			if ( pxPOU->ET >= pxPOU->PT ){				pxPOU->Q = false;				// Apaga la salida de pulso				pxPOU->ET = pxPOU->PT;			// Satura el valor de ET en PT				pxPOU->PLC_RUNNING = false;			// Deja de contar			}		}		// Si la entrada IN es 0 y No est contando		if ( !!(pxPOU->IN) && !!(pxPOU->PLC_RUNNING) ){			pxPOU->ET = 0;		}'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Function Blocks' stamp: 'EricPernia 11/15/2013 05:58'!createTimerFunctionBlockDeclarations	"Crea y guarda en la biblioteca los bloques de funcion de temporizadores"		"TP"	self createTPFunctionBlockDeclaration.		"TON"	self createTONFunctionBlockDeclaration.		"TOF"	self createTOFFunctionBlockDeclaration.! !!PLC_FunctionBlock class methodsFor: 'class initialization' stamp: 'EricPernia 6/21/2013 20:28'!initialize 	"comment stating purpose of message"	super initialize.	StdFunctionBlocksCreated := false.! !!PLC_FunctionBlock class methodsFor: 'instance creation' stamp: 'EricPernia 11/19/2013 00:03'!newWithName: anIdentifier andDataType: aPLC_DataType	"Nuevo con nombre y tipo de datos"	| pou |		pou := self newWithName: anIdentifier.			pou dataType: aPLC_DataType.			^ pou.! !!PLC_FunctionBlock methodsFor: 'compilation' stamp: 'EricPernia 11/18/2013 17:23'!cCompile	"Definicinn de Funcin en C que implementa la POU.		Ejemplo:	void ProgEj ( PLC_P_Struct_ProgEj * pxPOU )	{		// Cuerpo de POU				PLC_IL_LD ( &( pxPOU -> Ent1 ), sizeof (pxPOU -> Ent1 ), BOOL , NullModifier ); // LD Ent1				PLC_IL_AND ( &( pxPOU -> Ent2 ), BOOL , NullModifier ); // AND Ent2				PLC_IL_ST ( &( pxPOU ->Sal), sizeof (pxPOU ->Sal), NullModifier ); // ST Sal	}."		| progAcc cCode |		"Creo el acumulador de objetos de programa."	progAcc := PLC_ProgramAccumulator_POU new.			"	LAS POU NO ADMITEN VAR_GLOBAL	y las F no tienen VAR_EXTERN, ni VAR_TEMP y pisan antes del cuerpo de POU las VAR 		Dentro de la estructura de instancia:		self declarations inputVarDecls	self declarations outputVarDecls	self declarations inOutVarDecls	self declarations varDecls		Dentro de la funcion de la POU en C:		self declarations constantVarDecls 		progAcc compilerDataTypesDecls cCompile.	progAcc compilerVarDecls cCompile.	progAcc compiledBody	 cCompile.	"		"Le envio la peticin al Cuerpo de POU de que se compile en el acumulador"	self pouBody generateCodeIn: progAcc.		cCode := '	void ' , self cPOUName , '( ' , self declarations typeDeclarationIdentifier , ' *pxPOU )	{			// Declaraciones de Tipos de datos del compilador		'.			cCode := cCode , progAcc compilerDataTypesDecls cCompile , '			// Declaraciones de variables del compilador		'.			cCode := cCode , progAcc compilerVarDecls cCompile , '			// Declaraciones de variables del usuario		',		self declarations constantVarDecls cCompile ,	self declarations tempVarDecls cCompile.			"ACA FALTA QUE EN FUNCTION PISE CONCERO A LAS VAR INTERNAS PARAQUENOTENGA MEMORIA"		cCode := cCode , '			// Cuerpo de POU		',	progAcc compiledBody cCompile.			cCode := cCode, '		}'.		^ cCode.! !!PLC_FunctionBlock methodsFor: 'compilation' stamp: 'EricPernia 11/14/2013 15:43'!ilCompile	"Definicin de POU en IL.		Ejemplo:	FUNCTION_BLOCK FBej			(* Declaraciones de POU *)			VAR_INPUT				Ent1 : BOOL ;				Ent2 : BOOL ;			END_VAR						VAR_OUTPUT				Sal : BOOL ;			END_VAR					(* Cuerpo de POU *)					LD Ent1			AND Ent2			ST Sal				END_FUNCTION_BLOCK		"		| progAcc ilCode |		"Creo el acumulador de objetos de programa."	progAcc := PLC_ProgramAccumulator_POU new.			"	LAS POU NO ADMITEN VAR_GLOBAL		Dentro de la estructura de instancia:		self declarations inputVarDecls	self declarations outputVarDecls	self declarations inOutVarDecls	self declarations varDecls		Dentro de la funcion de la POU en C:		self declarations constantVarDecls 	self declarations tempVarDecls 	self declarations externVarDecls 		progAcc compilerDataTypesDecls cCompile.	progAcc compilerVarDecls cCompile.	progAcc compiledBody	 cCompile.	"		"Le envio la peticin al Cuerpo de POU de que se compile en el acumulador"	self pouBody generateCodeIn: progAcc.		ilCode := '	' , self pouType , ' ' , self identifier , '			 (* Declaraciones de Tipos de datos del compilador *)		'.			ilCode := ilCode , progAcc compilerDataTypesDecls ilCompile , '				 (* Declaraciones de variables del compilador *)		'.			ilCode := ilCode , progAcc compilerVarDecls ilCompile , '			 (* Declaraciones de variables del usuario *)		',	self declarations inputVarDecls ilCompile ,	self declarations outputVarDecls ilCompile ,	self declarations inOutVarDecls ilCompile ,	self declarations varDecls ilCompile ,	self declarations constantVarDecls ilCompile ,	self declarations tempVarDecls ilCompile .		ilCode := ilCode , '			 (* Cuerpo de POU *)		',	progAcc compiledBody ilCompile.			ilCode := ilCode, '				END_' , self pouType.		^ ilCode.! !!PLC_FunctionBlock methodsFor: 'initialize-release' stamp: 'EricPernia 6/21/2013 04:22'!initialize.	"Inicializo la declaracin de Bloque de Funcin."	super initialize.	"Declaraciones de Variables y Tipos de Datos"	self declarations: ( PLC_POU_Declarations functionBlockDeclarationsWithPOUDeclaration: self ).! !!PLC_FunctionBlock methodsFor: 'POU type' stamp: 'EricPernia 6/21/2013 04:41'!pouType	"Devuelve el tipo de POU que es."	^ 'FUNCTION_BLOCK'! !!PLC_FunctionBlock methodsFor: 'POU type' stamp: 'EricPernia 6/21/2013 04:50'!pouTypeAcronym	"Devuelve las siglas del tipo de POU que es."	^ 'FB'! !!PLC_FunctionBlock methodsFor: 'variable declarations' stamp: 'EricPernia 6/8/2013 17:01'!tempVarDecls	"Devuelve sus declaraciones de variables Internas Temporales"	^ self declarations tempVarDecls.! !!PLC_POU class methodsFor: 'instance creation' stamp: 'EricPernia 6/8/2013 04:15'!newWithName: anIdentifier 	"Nuevo con nombre"	| pou |		pou := self new.	pou identifier: anIdentifier.			^ pou.! !!PLC_POU class methodsFor: 'instance creation' stamp: 'EricPernia 6/22/2013 03:23'!newWithName: anIdentifier andDataType: aPLC_DataType	"Nuevo con nombre y tipo de datos"	| pou |		pou := self newWithName: anIdentifier.			pou dataType: aPLC_DataType.			^ pou.! !!PLC_POU methodsFor: 'parallel' stamp: 'EricPernia 9/13/2013 17:42'!acceptParallel	"Responde true si la POU acepta estar conectada en una rama paralela en Ladder.			Quiero agregar un elemento llamado a POU en la conexin ==		|	c1		 c2			b1	|-----|  |----------|  |-----+-----(  )------|	|				    |	|	c3			    |	|-----|  |---------==----+		|	"	"Se lo delega el llamado a esta declaraion de POU.	Responden True solo un par de Funciones (las de comparacin)"		^ false.! !!PLC_POU methodsFor: 'called POUs' stamp: 'EricPernia 11/15/2013 16:57'!addCalledPOUsIn: aCalledPOU	"Aade sus declaraciones de pou F y FB que llame en su cuerpo"	^ self pouBody addCalledPOUsIn: aCalledPOU.! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 12:56'!addENDeclaration	"Aade la declaracin de variable BOOLEANAde entrada EN"	self inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: true 			andIdentifier: 'EN' 		).			! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 12:56'!addENODeclaration	"Aade la declaracin de variable BOOLEANA de salida ENO"	self outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil			andIdentifier: 'ENO' 		).! !!PLC_POU methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 16:23'!cCompilePrototype	"Prototipo de Funcin en C que implementa la POU		Ejemplo:	void ProgEj ( PLC_P_Struct_ProgEj *);"		^ '	void ' , self cPOUName , '( ' , self declarations typeDeclarationIdentifier , ' * );'! !!PLC_POU methodsFor: 'compilation' stamp: 'EricPernia 6/22/2013 03:44'!cPOUName	"Devuelve el nombre en C de la POU"		"Ejemplo: 		PLC_F_ADD_INT"		^ 'PLC_' , self pouTypeAcronym , '_' , self typedIdentifier.! !!PLC_POU methodsFor: 'data types declarations' stamp: 'EricPernia 9/7/2013 04:31'!compilerDataTypesDecls	"Devuelve sus declaraciones de Tipos de datos declarados por el compilador	de lenguaje grafico.	Las conoce el object una vez que la POU fue compilada."	^ self object compilerDataTypesDecls.! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 9/7/2013 04:29'!compilerVarDecls	"Devuelve sus declaraciones de variables internas declaradas por el compilador. 	Las conoce el object una vez que la POU fue compilada."	^ self object compilerVarDecls.! !!PLC_POU methodsFor: 'connectableBlocks' stamp: 'EricPernia 6/8/2013 03:37'!connectableBlockInputs	"Cantidad de entradas para el bloque conectable."	^ self inputVarDecls size + self inOutVarDecls size.! !!PLC_POU methodsFor: 'connectableBlocks' stamp: 'EricPernia 6/5/2013 18:22'!connectableBlockOutputs	"Cantidad de salidas para el bloque conectable."	^ self outputVarDecls size + self inOutVarDecls size.! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 6/8/2013 17:00'!constantVarDecls	"Devuelve sus declaraciones de variables Internas de valor Constante"	^ self declarations constantVarDecls.! !!PLC_POU methodsFor: 'accessing' stamp: 'EricPernia 6/22/2013 03:22'!dataType		^ dataType! !!PLC_POU methodsFor: 'accessing' stamp: 'EricPernia 6/22/2013 03:22'!dataType: anObject		dataType := anObject! !!PLC_POU methodsFor: 'accessing' stamp: 'EricPernia 6/8/2013 04:07'!declarations	^ declarations! !!PLC_POU methodsFor: 'accessing' stamp: 'EricPernia 6/8/2013 04:07'!declarations: anObject	declarations := anObject! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 11/19/2013 04:55'!funInstVarDecls	"Devuelve sus declaraciones de variables Internas de instancias de Funciones. ES UN PARCHASOOO ESTA CATEGORIA"	^ self declarations funInstVarDecls.! !!PLC_POU methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 19:59'!generateCode	"Genera el acumulador de programa y se lo pasa a sus declaraciones de POU y Cuerpo de POU para que lo llenen"		| progAcc |		"Creo el acumulador de objetos de programa."	progAcc := PLC_ProgramAccumulator_POU new.	"Le envio la peticin al Cuerpo de POU de que se compile en el acumulador"	self pouBody generateCodeIn: progAcc.		^ progAcc.	! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 6/8/2013 17:00'!inOutVarDecls	"Devuelve sus declaraciones de variables de Entrada-Salida"	^ self declarations inOutVarDecls.! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 6/8/2013 17:00'!inputVarDecls	"Devuelve sus declaraciones de variables de Entrada"	^ self declarations inputVarDecls.! !!PLC_POU methodsFor: 'instance' stamp: 'EricPernia 11/6/2013 12:32'!instanceDecl	"Devuelve una nueva declaracion de variable de instancia de la declaracin de Programa o Bloque de Funcin."	^ self instanceDeclWithIdentifier: nil.! !!PLC_POU methodsFor: 'instance' stamp: 'EricPernia 11/19/2013 03:09'!instanceDeclForForFBWithIdentifier: anIdentifier	"Devuelve una nueva variable de instancia de la declaracin de Programa o Bloque de Funcin."	| instance |		anIdentifier 		ifNil: [			instance := PLC_SymbolicVariableDecl 				newWithDataType: self typeDeclaration 				andInitialValue: nil				andIdentifier: self typedIdentifier , '_VAR'.			]		ifNotNil: [			instance := PLC_SymbolicVariableDecl 				newWithDataType: self typeDeclaration 				andInitialValue: nil				andIdentifier: anIdentifier.			].	^ instance.! !!PLC_POU methodsFor: 'instance' stamp: 'EricPernia 11/7/2013 14:18'!instanceDeclWithIdentifier: anIdentifier	"Devuelve una nueva variable de instancia de la declaracin de Programa o Bloque de Funcin."	| instance |		anIdentifier 		ifNil: [			instance := PLC_InstanceVariableDecl				newWithDataType: self typeDeclaration 				andInitialValue: nil				andIdentifier: self typedIdentifier , '_VAR'.			]		ifNotNil: [			instance := PLC_InstanceVariableDecl 				newWithDataType: self typeDeclaration 				andInitialValue: nil				andIdentifier: anIdentifier.			].	^ instance.! !!PLC_POU methodsFor: 'test' stamp: 'EricPernia 11/15/2013 02:27'!isUserDefined	"Responde True si su cuerpo de pou definido por el usuario. si es estandar responde false"	^ self pouBody isUserDefined.! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 6/8/2013 17:00'!outputVarDecls	"Devuelve sus declaraciones de variables de Salida"	^ self declarations outputVarDecls.! !!PLC_POU methodsFor: 'accessing' stamp: 'EricPernia 6/5/2013 18:21'!pouBody	^ pouBody! !!PLC_POU methodsFor: 'accessing' stamp: 'EricPernia 6/5/2013 18:21'!pouBody: anObject	pouBody := anObject! !!PLC_POU methodsFor: 'instance' stamp: 'EricPernia 6/21/2013 04:01'!structureDeclaration	"Declaracion de tipo de dato estructurado."		^ self declarations structureDeclaration.! !!PLC_POU methodsFor: 'instance' stamp: 'EricPernia 6/21/2013 04:31'!typeDeclaration	"Declaracion de tipo de dato derivado."		^ self declarations typeDeclaration.! !!PLC_POU methodsFor: 'typed identifier' stamp: 'EricPernia 6/22/2013 03:29'!typedIdentifier	"Devuelve su identificador con tipo de datos.		Ejemplo: 			ADD_INT	"		self dataType 		ifNil: [ 			^ self identifier.			] 		ifNotNil: [ 			^ self identifier , '_' , self dataType ilCompile.			].! !!PLC_POU methodsFor: 'data types declarations' stamp: 'EricPernia 6/8/2013 17:01'!userDataTypesDecls	"Devuelve sus declaraciones de Tipos de datos declarados por el usuario"	^ self declarations userDataTypesDecls.! !!PLC_POU methodsFor: 'data types declarations' stamp: 'EricPernia 9/7/2013 05:14'!userVarDecls	"Devuelve sus declaraciones de Variables hechas por el usuario"	^ self declarations userVarDecls.! !!PLC_POU methodsFor: 'variable declarations' stamp: 'EricPernia 6/8/2013 17:00'!varDecls	"Devuelve sus declaraciones de variables Internas"	^ self declarations varDecls.! !!PLC_Program class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:44'!Programs	"Devuelve el diccionario."		^ Programs.! !!PLC_Program class methodsFor: 'instance creation' stamp: 'EricPernia 6/22/2013 03:31'!addProgram: aProgramDecl	"Aade una declaracin de Programa."			Programs at: aProgramDecl typedIdentifier put: aProgramDecl.! !!PLC_Program class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 20:30'!clearPrograms	"Borra el diccionario."			Programs := Dictionary new.! !!PLC_Program methodsFor: 'compilation' stamp: 'EricPernia 11/19/2013 05:06'!cCompile	"Definicinn de Funcin en C que implementa la POU.		Ejemplo:	void ProgEj ( PLC_P_Struct_ProgEj * pxPOU )	{		// Cuerpo de POU				PLC_IL_LD ( &( pxPOU -> Ent1 ), sizeof (pxPOU -> Ent1 ), BOOL , NullModifier ); // LD Ent1				PLC_IL_AND ( &( pxPOU -> Ent2 ), BOOL , NullModifier ); // AND Ent2				PLC_IL_ST ( &( pxPOU ->Sal), sizeof (pxPOU ->Sal), NullModifier ); // ST Sal	}."		| progAcc cCode |		"Creo el acumulador de objetos de programa."	progAcc := PLC_ProgramAccumulator_POU new.			"	LAS POU NO ADMITEN VAR_GLOBAL		Dentro de la estructura de instancia:		self declarations inputVarDecls	self declarations outputVarDecls	self declarations inOutVarDecls	self declarations varDecls		Dentro de la funcion de la POU en C:		self declarations constantVarDecls 	self declarations tempVarDecls 	self declarations externVarDecls 		progAcc compilerDataTypesDecls cCompile.	progAcc compilerVarDecls cCompile.	progAcc compiledBody	 cCompile.	"		"Le envio la peticin al Cuerpo de POU de que se compile en el acumulador"	self pouBody generateCodeIn: progAcc.		cCode := '	void ' , self cPOUName , '( ' , self declarations typeDeclarationIdentifier , ' *pxPOU )	{			// Declaraciones de Tipos de datos del compilador		'.			cCode := cCode , progAcc compilerDataTypesDecls cCompile , '			// Declaraciones de variables del compilador		'.			cCode := cCode , progAcc compilerVarDecls cCompile , '			// Declaraciones de variables del usuario		',		self declarations constantVarDecls cCompile ,	self declarations tempVarDecls cCompile ,	self declarations externVarDecls cCompile.			cCode := cCode , '			// Cuerpo de POU		',	progAcc compiledBody cCompile.			cCode := cCode, '		}'.		^ cCode.			! !!PLC_Program methodsFor: 'testing' stamp: 'CarlosLombardi 11/19/2016 14:48'!canBeCompiled	"whether I can be successfully compiled, i.e. whether I do not have any errors"		"2016.11.19 - at the moment, only errors in my body are considered"	^self pouBody canBeCompiled ! !!PLC_Program methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 22:47'!ilCompile	"Definicin de POU en IL.		Ejemplo:	PROGRAM ProgEj			(* Declaraciones de POU *)			VAR_INPUT				Ent1 : BOOL ;				Ent2 : BOOL ;			END_VAR						VAR_OUTPUT				Sal : BOOL ;			END_VAR					(* Cuerpo de POU *)					LD Ent1			AND Ent2			ST Sal				END_PROGRAM		"		| progAcc ilCode |		"Creo el acumulador de objetos de programa."	progAcc := PLC_ProgramAccumulator_POU new.			"	LAS POU NO ADMITEN VAR_GLOBAL		Dentro de la estructura de instancia:		self declarations inputVarDecls	self declarations outputVarDecls	self declarations inOutVarDecls	self declarations varDecls		Dentro de la funcion de la POU en C:		self declarations constantVarDecls 	self declarations tempVarDecls 	self declarations externVarDecls 		progAcc compilerDataTypesDecls cCompile.	progAcc compilerVarDecls cCompile.	progAcc compiledBody	 cCompile.	"		"Le envio la peticin al Cuerpo de POU de que se compile en el acumulador"	self pouBody generateCodeIn: progAcc.		ilCode := '	' , self pouType , ' ' , self identifier , '			 (* Declaraciones de Tipos de datos del compilador *)		'.			ilCode := ilCode , progAcc compilerDataTypesDecls ilCompile , '				 (* Declaraciones de variables del compilador *)		'.			ilCode := ilCode , progAcc compilerVarDecls ilCompile , '			 (* Declaraciones de variables del usuario *)		',	self declarations inputVarDecls ilCompile ,	self declarations outputVarDecls ilCompile ,	self declarations inOutVarDecls ilCompile ,	self declarations varDecls ilCompile ,	self declarations constantVarDecls ilCompile ,	self declarations tempVarDecls ilCompile ,	self declarations externVarDecls ilCompile.		ilCode := ilCode , '			 (* Cuerpo de POU *)		',	progAcc compiledBody ilCompile.			ilCode := ilCode, '				END_' , self pouType.		^ ilCode.! !!PLC_Program methodsFor: 'initialize-release' stamp: 'EricPernia 6/21/2013 04:23'!initialize.	"Inicializo la declaracin de Programa."	super initialize.	"Declaraciones de Variables y Tipos de Datos"	self declarations: ( PLC_POU_Declarations programDeclarationsWithPOUDeclaration: self ).! !!PLC_Program methodsFor: 'POU type' stamp: 'EricPernia 6/21/2013 04:41'!pouType	"Devuelve el tipo de POU que es."	^ 'PROGRAM'! !!PLC_Program methodsFor: 'POU type' stamp: 'EricPernia 6/21/2013 04:51'!pouTypeAcronym	"Devuelve las siglas del tipo de POU que es."	^ 'P'! !!PLC_Program methodsFor: 'variable declarations' stamp: 'EricPernia 6/8/2013 17:01'!tempVarDecls	"Devuelve sus declaraciones de variables Internas Temporales"	^ self declarations tempVarDecls.! !!PLC_Project class methodsFor: 'instance creation' stamp: 'EricPernia 5/31/2013 13:30'!newWithName: aString 	"Crea una nueva isntancia con el nombre indicado"	| project |		project := self new.	project projectName: aString.		^ project.! !!PLC_Project methodsFor: 'Hardware Configuration' stamp: 'EricPernia 11/3/2013 02:51'!addHardwareConfiguration	"Aade una nueva Configuracin de Hardware vaca"	| hardConfig |		hardConfig := PLC_HardwareConfiguration new.	hardwareConfigurations add: hardConfig.		^ hardConfig.! !!PLC_Project methodsFor: 'Hardware Configuration' stamp: 'EricPernia 11/2/2013 14:10'!addHardwareConfiguration: hardConfig	"Aade la Configuracin de Hardware que le llega como parmetro"	hardwareConfigurations add: hardConfig.		^ hardConfig.! !!PLC_Project methodsFor: 'accessing' stamp: 'EricPernia 11/2/2013 14:08'!hardwareConfigurations		^ hardwareConfigurations! !!PLC_Project methodsFor: 'accessing' stamp: 'EricPernia 11/2/2013 14:08'!hardwareConfigurations: anObject		hardwareConfigurations := anObject! !!PLC_Project methodsFor: 'initialize-release' stamp: 'EricPernia 11/5/2013 03:08'!initialize.	"Inicializo el Proyecto."	libraries := PLC_Libraries uniqueInstance.		hardwareConfigurations := OrderedCollection new.	! !!PLC_Project methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 13:39'!libraries	^ libraries! !!PLC_Project methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 13:39'!libraries: anObject	libraries := anObject! !!PLC_Project methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 03:10'!projectName	^ self identifier! !!PLC_Project methodsFor: 'accessing' stamp: 'EricPernia 11/2/2013 14:04'!projectName: anObject		self identifier: anObject.! !!PLC_Project methodsFor: 'Hardware Configuration' stamp: 'EricPernia 11/5/2013 02:16'!removeHardwareConfiguration: hardConfig	"Aade la Configuracin de Hardware que le llega como parmetro"	hardwareConfigurations remove: hardConfig.		^ hardConfig.! !!PLC_Resource class methodsFor: 'instance creation' stamp: 'EricPernia 11/8/2013 03:54'!newWithName: aString andSoftConfig: aSoftConfig andProcessor: aProcessor	"Crea una nueva isntancia con el nombre indicado"	| res |		res := self new.	res resourceName: aString.	res softwareConfiguration: aSoftConfig.	res processor: aProcessor.		^ res.! !!PLC_Resource methodsFor: 'program and task configurations' stamp: 'EricPernia 11/7/2013 18:14'!addProgConfig: aProgConfig	"Aade al Recurso la Configuracin de Programa aProgConfig que le llega como parmetro"	self programConfigurations add: aProgConfig.		^ aProgConfig.! !!PLC_Resource methodsFor: 'program and task configurations' stamp: 'EricPernia 11/7/2013 18:07'!addTaskConfig: aTaskConfig	"Aade al Recurso la Configuracin de Tarea aTaskConfig que le llega como parmetro"	self taskConfigurations add: aTaskConfig.		aTaskConfig resource: self.		^ aTaskConfig.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 07:03'!cAppLibH	"Devuelve un String con el Cdigo C que va en el archivo PLC_App_Lib.h "	| cCode |	cCode := '/*------------------------------------------------------------------------Copyright  2012-2015 Eric Nicols Pernia. All rights reserved.This file is part of IDE4PLC Firmware. http://ide4plc.wordpress.comRedistribution and use in source and binary forms, with or without modification,are permitted provided that the following conditions are met: * Redistributions of source code and project files must retain the above    copyright notice, this list of conditions and the following disclaimer.   * Redistributions in binary form must reproduce the above copyright notice,   this list of conditions and the following disclaimer in the documentation   and/or other materials provided with the distribution. * Neither the name of the copyright holders nor the names of its contributors   may be used to endorse or promote products derived from this product without   specific prior written permission.THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THEIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSEARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE FOR ANY DIRECT,INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORYOF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCEOR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISEDOF THE POSSIBILITY OF SUCH DAMAGE.------------------------------------------------------------------------*//* * PLC_App_Lib.h * *  Created on: 2014/09/11 *      Author: Eric Pernia */#ifndef PLC_APP_LIB_H_	#define PLC_APP_LIB_H_	/* PLC Services Includes */	#include "PLC_Services.h"	/* PLC Lib includes. */	#include "PLC_Lib.h"	/* PLC App includes. */	#include "PLC_CompilerDerivedDataTypes.h"	#include "PLC_UserDerivedDataTypes.h"	#include "PLC_StdFunctions.h"	#include "PLC_UserFunctions.h"	#include "PLC_StdFunctionBlocks.h"	#include "PLC_UserFunctionBlocks.h"	#include "PLC_UserPrograms.h"	#include "PLC_UserTasks.h"#endif /* PLC_APP_LIB_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 5/7/2015 07:17'!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2014, Mariano Cerdeiro * Copyright 2014, Pablo Ridolfi * Copyright 2014, Juan Cecconi * Copyright 2014, Gustavo Muro * Copyright 2015, Eric Nicols Pernia * Copyright 2015, Leandro Kollenberger * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source of the CIAA Firmware ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//* * Initials     Name * --------------------------- * MaCe         Mariano Cerdeiro * ErPe         Eric Pernia * LeKo         Leandro Kollenberger *//* * modification history (new versions first) * ----------------------------------------------------------- * 20150404 v0.0.1 MaCe initial version * 20150428 v0.0.1 ErPe & LeKo changes for plc_application run *//*==================[inclusions]=============================================*/#include "os.h"               /* <= operating system header */#include "ciaaPOSIX_stdio.h"  /* <= device handler header */#include "ciaaPOSIX_string.h" /* <= string header */#include "ciaak.h"            /* <= ciaa kernel header */#include "plc_application.h"  /* <= own header */#include "PLC_App_Lib.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main(void){   /* Starts the operating system in the Application Mode 1 */   /* This example has only one Application Mode */   StartOS(AppMode1);   /* StartOs shall never returns, but to avoid compiler warnings or errors    * 0 is returned */   return 0;}/** \brief Error Hook function * * This fucntion is called from the os if an os interface (API) returns an * error. Is for debugging proposes. If called this function triggers a * ShutdownOs which ends in a while(1). * * The values: *    OSErrorGetServiceId *    OSErrorGetParam1 *    OSErrorGetParam2 *    OSErrorGetParam3 *    OSErrorGetRet * * will provide you the interface, the input parameters and the returned value. * For more details see the OSEK specification: * http://portal.osek-vdx.org/files/pdf/specs/os223.pdf * */void ErrorHook(void){   ciaaPOSIX_printf("ErrorHook was called\n");   ciaaPOSIX_printf("Service: %d, P1: %d, P2: %d, P3: %d, RET: %d\n", OSErrorGetServiceId(), OSErrorGetParam1(), OSErrorGetParam2(), OSErrorGetParam3(), OSErrorGetRet());   ShutdownOS(0);}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 06:46'!cApplicationH	" Devuelve un String con el Cdigo C que va en el archivo plc_application.h"	| cCode |		cCode := '/* Copyright 2014, Mariano Cerdeiro * Copyright 2014, Pablo Ridolfi * Copyright 2014, Juan Cecconi * Copyright 2014, Gustavo Muro * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/#ifndef PLC_APPLICATION_H#define PLC_APPLICATION_H/** \brief PLC Application header file ** ** This is the PLC Application header of the CIAA Firmware ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//* * Initials     Name * --------------------------- * MaCe         Mariano Cerdeiro *//* * modification history (new versions first) * ----------------------------------------------------------- * 20150404 v0.0.1 MaCe initial version *//*==================[inclusions]=============================================*//*==================[macros]=================================================*//*==================[typedef]================================================*//*==================[external data declaration]==============================*//*==================[external functions declaration]=========================*//** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/#endif /* #ifndef PLC_APPLICATION_H */'.	^ cCode.! !!PLC_Resource methodsFor: 'compilation' stamp: 'EricPernia 11/1/2013 18:02'!cComplie	"Devuelve un String con el Recurso Compilado a cdigo C."	^ 'Recurso compliado en C.'! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 09:55'!cPCompilerDerivedDataTypesH	"Devuelve un String con el Cdigo C que va en el archivo PLC_CompilerDerivedDataTypes.h "	| cCode |	cCode := '/* ------------------------------------------------------------ * PLC_CompilerDerivedDataTypes.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//* PLC Derived data types * En este archivo se guardan los tipos de datos generados por el * compilador al generar codigo IL desde un lenguaje grafico  */#ifndef PLC_COMPILER_DATA_TYPES_H_	#define PLC_COMPILER_DATA_TYPES_H_#endif /* PLC_CompilerDerivedDataTypes.h */'.		^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 5/7/2015 10:08'!cStandardFunctionBlocksC	" Devuelve un String con el Cdigo C que va en el archivo PLC_StdFunctionBlocks.c "	| cCode |		cCode := '/*------------------------------------------------------------------------Copyright  2012-2015 Eric Nicols Pernia. All rights reserved.This file is part of IDE4PLC Firmware. http://ide4plc.wordpress.comRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: * Redistributions of source code and project files must retain the above     copyright notice, this list of conditions and the following disclaimer.    * Redistributions in binary form must reproduce the above copyright notice,    this list of conditions and the following disclaimer in the documentation    and/or other materials provided with the distribution. * Neither the name of the copyright holders nor the names of its contributors    may be used to endorse or promote products derived from this product without    specific prior written permission.THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCEOR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.------------------------------------------------------------------------*//* PLC Standard Functions - Functions Declarations *//* Los FB se implementan como funciones de C que no retornan valores * y que reciben como parametro un puntero a la estructura de la * FB instancia, que debe ser declarada como STATIC en la funcion * contenedora.*//* Includes */#include "PLC_App_Lib.h"'.		self calledPOUs standardFunctionBlocks do: [ :each |		cCode := cCode , each cCompile.		].		^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 09:19'!cStandardFunctionBlocksH	" Devuelve un String con el Cdigo C que va en el archivo PLC_StdFunctionBlocks.h "	| cCode |		cCode := '/* ------------------------------------------------------------ * PLC_StdFuncionBlocks.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//* En este archivo se guardan los prototipos de funciones * en C de los Bloques de Funcion (FUNCTION_BLOCK) del  * PLC estandar y los tipos de datos para sus instancias */#ifndef PLC_STDFB_H_	#define PLC_STDFB_H_		/* Declaraciones de typedef de estructura con las variables de los Bloques de Funcion  */			typedef struct Struct_R_TRIG_BOOL{			PLC_BOOL CLK;			PLC_BOOL Q;			PLC_BOOL M;		} PLC_FB_Struct_R_TRIG_BOOL;				typedef struct Struct_F_TRIG_BOOL{			PLC_BOOL CLK;			PLC_BOOL Q;			PLC_BOOL M;		} PLC_FB_Struct_F_TRIG_BOOL;			typedef struct Struct_CTD_INT{			PLC_BOOL CD;			PLC_BOOL LD;			PLC_INT PV;			PLC_BOOL Q;			PLC_INT CV;			PLC_FB_Struct_R_TRIG_BOOL R_TRIG_IN;		} PLC_FB_Struct_CTD_INT;		typedef struct Struct_TP_TIME{			PLC_BOOL IN;			PLC_TIME PT;			PLC_BOOL Q;			PLC_TIME ET;			PLC_TIME PLC_START;			PLC_BOOL PLC_RUNNING;			PLC_BOOL EDGE;			PLC_FB_Struct_R_TRIG_BOOL R_TRIG_IN;		} PLC_FB_Struct_TP_TIME;		typedef struct Struct_TOF_TIME{			PLC_BOOL IN;			PLC_TIME PT;			PLC_BOOL Q;			PLC_TIME ET;			PLC_TIME PLC_START;			PLC_BOOL PLC_RUNNING;			PLC_BOOL EDGE;			PLC_FB_Struct_F_TRIG_BOOL F_TRIG_IN;		} PLC_FB_Struct_TOF_TIME;		typedef struct Struct_RS_BOOL{			PLC_BOOL S;			PLC_BOOL R1;			PLC_BOOL Q1;		} PLC_FB_Struct_RS_BOOL;		typedef struct Struct_CTUD_INT{			PLC_BOOL CU;			PLC_BOOL CD;			PLC_BOOL R;			PLC_BOOL LD;			PLC_INT PV;			PLC_BOOL QU;			PLC_BOOL QD;			PLC_INT CV;			PLC_FB_Struct_R_TRIG_BOOL R_TRIG_IN1;			PLC_FB_Struct_R_TRIG_BOOL R_TRIG_IN2;		} PLC_FB_Struct_CTUD_INT;		typedef struct Struct_CTU_INT{			PLC_BOOL CU;			PLC_BOOL R;			PLC_INT PV;			PLC_BOOL Q;			PLC_INT CV;			PLC_FB_Struct_R_TRIG_BOOL R_TRIG_IN;		} PLC_FB_Struct_CTU_INT;		typedef struct Struct_SR_BOOL{			PLC_BOOL S1;			PLC_BOOL R;			PLC_BOOL Q1;		} PLC_FB_Struct_SR_BOOL;		typedef struct Struct_TON_TIME{			PLC_BOOL IN;			PLC_TIME PT;			PLC_BOOL Q;			PLC_TIME ET;			PLC_TIME PLC_START;			PLC_BOOL PLC_RUNNING;			PLC_BOOL EDGE;			PLC_FB_Struct_R_TRIG_BOOL R_TRIG_IN;		} PLC_FB_Struct_TON_TIME;	/* Prototipos de Funciones en C que implementan los Bloques de Funcion  */	void PLC_FB_R_TRIG_BOOL( PLC_FB_Struct_R_TRIG_BOOL * );	void PLC_FB_F_TRIG_BOOL( PLC_FB_Struct_F_TRIG_BOOL * );	void PLC_FB_CTD_INT( PLC_FB_Struct_CTD_INT * );	void PLC_FB_TP_TIME( PLC_FB_Struct_TP_TIME * );	void PLC_FB_TOF_TIME( PLC_FB_Struct_TOF_TIME * );	void PLC_FB_RS_BOOL( PLC_FB_Struct_RS_BOOL * );	void PLC_FB_CTUD_INT( PLC_FB_Struct_CTUD_INT * );	void PLC_FB_CTU_INT( PLC_FB_Struct_CTU_INT * );	void PLC_FB_SR_BOOL( PLC_FB_Struct_SR_BOOL * );	void PLC_FB_TON_TIME( PLC_FB_Struct_TON_TIME * );	#endif /* PLC_STDFB_H_ */'.		^ cCode."'	/* Declaraciones de typedef de estructura con las variables de los Bloques de Funcion  */'.		self calledPOUs standardFunctionBlocks do: [ :each |		cCode := cCode , each typeDeclaration cCompile , ''.		].		cCode := cCode , '	/* Prototipos de Funciones en C que implementan los Bloques de Funcion  */'.		self calledPOUs standardFunctionBlocks do: [ :each |		cCode := cCode , each cCompilePrototype.		].		cCode := cCode , '."! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 5/7/2015 10:12'!cStandardFunctionsC	"Devuelve un String con el Cdigo C que va en el archivo PLC_StdFunctions.c "	| cCode |		cCode := '/*------------------------------------------------------------------------Copyright  2012-2015 Eric Nicols Pernia. All rights reserved.This file is part of IDE4PLC Firmware. http://ide4plc.wordpress.comRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: * Redistributions of source code and project files must retain the above     copyright notice, this list of conditions and the following disclaimer.    * Redistributions in binary form must reproduce the above copyright notice,    this list of conditions and the following disclaimer in the documentation    and/or other materials provided with the distribution. * Neither the name of the copyright holders nor the names of its contributors    may be used to endorse or promote products derived from this product without    specific prior written permission.THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCEOR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.------------------------------------------------------------------------*//* PLC Standard Functions - Functions Declarations *//* Las F se implementan como funciones de C que no retornan valores * y que reciben como parametro un puntero a la estructura de la * F, esta variable estructura del tipo de la funcion es unica por * no como el caso de los FB que tienen una variable de su tipo de * estructura por  instancia.*//* Includes */#include "PLC_App_Lib.h"/*-------------------------------------------------------------*/// MOVE SOBRECARGADAvoid PLC_F_MOVE(void* sourceValue, void* destinationValue, uint16_t lenght){	// sourceValue y destinationValue DEBEN SER DEL MISMO TIPO	// VOLCADO DE MEMORIA	PLC_BYTE *source;	PLC_BYTE *destination;	uint16_t i = 0;	source = sourceValue;	destination = destinationValue;	for( i = 0; i < lenght; i++ )	{		*destination = *source;		destination++;		source++;	}}/*-------------------------------------------------------------*/'.		self calledPOUs standardFunctions do: [ :each |		cCode := cCode , each cCompile.		].		^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 06:49'!cStandardFunctionsH	" Devuelve un String con el Cdigo C que va en el archivo PLC_StdFunctions.h "	| cCode |	cCode := '/* ------------------------------------------------------------ * PLC_StdFuncions.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan los prototipos de funciones * en C de las Funciones (FUNCTION) del PLC estandar y * los tipos de datos para sus instaniancias */#ifndef PLC_STDF_H_	#define PLC_STDF_H_		/* Declaraciones de typedef de estructura con las variables de las Funciones */'.		self calledPOUs standardFunctions do: [ :each |		cCode := cCode , each typeDeclaration cCompile , ''.		].		cCode := cCode , '	/* Prototipos de Funciones en C que implementan las Funciones */'.		self calledPOUs standardFunctions do: [ :each |		cCode := cCode , each cCompilePrototype.		].		cCode := cCode , '	#endif /* PLC_STDF_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 07:07'!cUserDerivedDataTypesH	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserDerivedDataTypes.h "	| cCode |	cCode := '/* ------------------------------------------------------------ * PLC_UserDerivedDataTypes.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//* PLC Derived data types * En este archivo se guardan los tipos de datos creados * por el usuario */#ifndef PLC_USER_DATA_TYPES_H_	#define PLC_USER_DATA_TYPES_H_#endif /* PLC_USER_DATA_TYPES_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 5/7/2015 10:13'!cUserFunctionBlocksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserFunctionBlocks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserFunctionBlocks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de los Bloques de Funcin (FB) del PLC creadas por * el usuario *//* Includes */#include "PLC_App_Lib.h"'.		^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 07:00'!cUserFunctionBlocksH	" Devuelve un String con el Cdigo C que va en el archivo PLC_UserFunctionBlocks.h "	| cCode |	cCode := '/* ------------------------------------------------------------ * PLC_UserFunctionBlocks.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//* En este archivo se guardan los prototipos de funciones * en C de los Bloques de Funcin (FB) del PLC creadas por * el usuario */#ifndef PLC_USER_FUNCTIONBLOCKS_H_	#define PLC_USER_FUNCTIONBLOCKS_H_		#endif /* PLC_USER_FUNCTIONBLOCKS_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 5/7/2015 10:21'!cUserFunctionsC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserFunctions.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserFunctions.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//* En este archivo se guardan las declaraciones de funciones * en C de las Funciones (F) del PLC creadas por el usuario *//* Includes */#include "PLC_App_Lib.h"'.		^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 07:01'!cUserFunctionsH	" Devuelve un String con el Cdigo C que va en el archivo PLC_UserFunctions.h "	| cCode |	cCode := '/* ------------------------------------------------------------ * PLC_UserFunctions.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//* En este archivo se guardan los prototipos de funciones * en C de las Funciones (F) del PLC creadas por * el usuario */	#ifndef PLC_USER_FUNCTIONS_H_	#define PLC_USER_FUNCTIONS_H_#endif /* PLC_USER_FUNCTIONS_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 5/7/2015 07:24'!cUserProgramsC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserPrograms.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserPrograms.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//* Includes */#include "PLC_Hardware.h"#include "PLC_App_Lib.h"/* En este archivo se guardan las definiciones de funciones * en C de los Programas (PROGRAM) del PLC creadas por * el usuario */'.		self calledPOUs userPrograms do: [ :each |		cCode := cCode , each cCompile.		].		^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 06:50'!cUserProgramsH	" Devuelve un String con el Cdigo C que va en el archivo PLC_UserPrograms.h "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserPrograms.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan los prototipos de funciones * en C de los Programas (PROGRAM) del PLC creadas por * el usuario y los tipos de datos para sus instaniancias  */#ifndef PLC_USER_PROGRAMS_H_	#define PLC_USER_PROGRAMS_H_	/* Declaraciones de typedef de estructura con las variables del Programa */'.		self calledPOUs userPrograms do: [ :each |		cCode := cCode , each typeDeclaration cCompile , ''.		].		cCode := cCode , '	/* Prototipos de Funciones en C que implementan los Programas */'.		self calledPOUs userPrograms do: [ :each |		cCode := cCode , each cCompilePrototype.		].		cCode := cCode , '	#endif /* PLC_USER_PROGRAMS_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 2/17/2016 03:12'!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "os.h"               /* <= operating system header */#include "ciaaPOSIX_stdio.h"  /* <= device handler header */#include "ciaaPOSIX_string.h" /* <= string header */#include "ciaak.h"            /* <= ciaa kernel header */#include "PLC_App_Lib.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is started automatically in the application mode 1. */TASK(InitTask){       /* init CIAA kernel and devices */   ciaak_start();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;	   /* activate PLC_SystemTask task:    *  - for the first time after 1 ticks (1 ms)    *  - and then every 10 ticks (10 ms)    */   SetRelAlarm(ActivatePLC_SystemTask, 1, 10);	   /* activate periodic task:    *  - for the first time after 10 ticks (10 ms)    *  - and then every 20 ticks (20 ms)    */   SetRelAlarm(ActivatePeriodicTask, 10, 20);      /* terminate task */   TerminateTask();}/** \brief PLC_System Task * * This task is started automatically every time that the alarm * ActivatePLC_SystemTask expires. This tasks calles the code generated * in IDE4PLC. * */TASK(PLC_SystemTask){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;        /* terminate task */   TerminateTask();}/** \brief Periodic Task * * This task is started automatically every time that the alarm * ActivatePeriodicTask expires. This tasks calles the code generated * in IDE4PLC. * */TASK(PeriodicTask){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);      /* terminate task */   TerminateTask();}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 5/7/2015 06:55'!cUserTasksH	" Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.h "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan los prototipos de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*/#ifndef PLC_USER_TASKS_H_	#define PLC_USER_TASKS_H_	/* Prototipos de funciones de tareas de RTOS que implementan las Tareas del PLC. */'.		"self taskConfigurations do: [ :each |		cCode := cCode , each cCompilePrototype.		]."		cCode := cCode , '	#endif /* PLC_USER_TASKS_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'compilation' stamp: 'EricPernia 11/15/2013 15:52'!calledPOUs	"Devuelve un Set con las POU que llama cada Configuracin de Programa del Recurso 	y las declaraciones de programas de cada Configuracin de Programa."	| pouDecls |		pouDecls := PLC_CalledPOU new.		"Le paso una OC de llamados a programas"	pouDecls addUserPrograms: self programConfigurations.		"Le pido a cada declaracion de programa que usa cada 	configuracin de programa que agregue sus pou F y FB 	que llame en su cuerpo"	self programConfigurations do: [ :progConfig |		progConfig declaration addCalledPOUsIn: pouDecls.		 ].		^ pouDecls.! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!declarations		^ declarations! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!declarations: anObject		declarations := anObject! !!PLC_Resource methodsFor: 'declarations' stamp: 'EricPernia 11/7/2013 22:58'!externVarDecls	"Devuelve sis declaraciones de variables globales"	^ self declarations externVarDecls.! !!PLC_Resource methodsFor: 'declarations' stamp: 'EricPernia 11/7/2013 22:58'!globalVarDecls	"Devuelve sis declaraciones de variables globales"	^ self declarations globalVarDecls.! !!PLC_Resource methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 04:05'!ilCompile	"Devuelve un String con el Recurso Compilado a cdigo IL."	| res |		res := '			RESOURCE ' 	, self resourceName 	, ' ON ' 	, self processor identifier	, '				(* Declaraciones de Recurso *)'.	self globalVarDecls		ifNotNil: [ 			res := res ,			self globalVarDecls ilCompile , ''.			].			self externVarDecls		ifNotNil: [ 			res := res ,			self externVarDecls ilCompile , ''.			].	res := res ,'			(* Configuraciones de Tarea *)' .	self taskConfigurations		ifNotNil: [ 			self taskConfigurations do: [ :each | 				res := res , each ilCompile , ''.				].			].	res := res ,'								(* Configuraciones de Programa *)			'.	self programConfigurations		ifNotNil: [ 			self programConfigurations do: [ :each | 				res := res , each ilCompile , ''.				].			].	res := res ,'					END_RESOURCE'.			^ res.	! !!PLC_Resource methodsFor: 'initialize-release' stamp: 'EricPernia 11/8/2013 15:10'!initialize	"Inicializaciones de Recurso"	taskConfigurations := OrderedCollection new.	programConfigurations := OrderedCollection new.		declarations := PLC_Resource_Declarations newWithResourceDeclaration: self.		self addTaskConfig: (		PLC_CyclicTaskConfiguration 			newWithName: 'PLeriCScanCycle'		).! !!PLC_Resource methodsFor: 'c make and oil' stamp: 'EricPernia 5/7/2015 10:29'!makefile	"Devuelve un String con el Cdigo C que va en el archivo Makefile"	| cCode |		cCode := '################################################################################# Copyright 2015, Mariano Cerdeiro# Copyright 2015, Pablo Ridolfi# Copyright 2015, Juan Cecconi# Copyright 2015, Eric Nicols Pernia# Copyright 2015, Leandro Kollenberger# All rights reserved.## This file is part of CIAA Firmware.## Redistribution and use in source and binary forms, with or without# modification, are permitted provided that the following conditions are met:## 1. Redistributions of source code must retain the above copyright notice,#    this list of conditions and the following disclaimer.## 2. Redistributions in binary form must reproduce the above copyright notice,#    this list of conditions and the following disclaimer in the documentation#    and/or other materials provided with the distribution.## 3. Neither the name of the copyright holder nor the names of its#    contributors may be used to endorse or promote products derived from this#    software without specific prior written permission.## THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE# POSSIBILITY OF SUCH DAMAGE.################################################################################# Project Name: based on Project Path and used to define OSEK configuration filePROJECT_NAME               = $(lastword $(subst $(DS), , $(PROJECT_PATH)))# Project path# Defined $(PROJECT_PATH) in makefile.mine# source path$(PROJECT_NAME)_SRC_PATH  += $(PROJECT_PATH)$(DS)src# include pathINC_FILES            += $(PROJECT_PATH)$(DS)inc $(PROJECT_PATH)$(DS)..$(DS)inc# library source filesSRC_FILES            += $(wildcard $($(PROJECT_NAME)_SRC_PATH)$(DS)*.c)# configuration for OSEK-OSOIL_FILES            += $(PROJECT_PATH)$(DS)etc$(DS)$(PROJECT_NAME).oil# Modules needed for this exampleMODS ?= modules$(DS)posix           \        modules$(DS)ciaak           \        modules$(DS)drivers         \        modules$(DS)rtos            \        modules$(DS)libs            \        modules$(DS)plc'.	^ cCode.! !!PLC_Resource methodsFor: 'c make and oil' stamp: 'EricPernia 5/7/2015 10:28'!osekApplicationOil	"Devuelve un String con el Cdigo C que va en el archivo plc_application.oil"	| cCode |		cCode := '/* Copyright 2014, 2015 Mariano Cerdeiro                                     *//* Copyright 2014, 2015 Pablo Ridolfi                                        *//* Copyright 2014, Juan Cecconi                                              *//* Copyright 2014, Gustavo Muro                                              *//* Copyright 2015, Eric Nicols Pernia                                       *//* Copyright 2015, Leandro Kollenberger                                      *//*                                                                           *//* This file is part of CIAA Firmware.                                       *//*                                                                           *//* Redistribution and use in source and binary forms, with or without        *//* modification, are permitted provided that the following conditions are    *//* met:                                                                      *//*                                                                           *//* 1. Redistributions of source code must retain the above copyright notice, *//*    this list of conditions and the following disclaimer.                  *//*                                                                           *//* 2. Redistributions in binary form must reproduce the above copyright      *//*    notice, this list of conditions and the following disclaimer in the    *//*    documentation and/or other materials provided with the distribution.   *//*                                                                           *//* 3. Neither the name of the copyright holder nor the names of its          *//*    contributors may be used to endorse or promote products derived from   *//*    this software without specific prior written permission.               *//*                                                                           *//* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS       *//* "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED *//* TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A           *//* PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER *//* OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,  *//* EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,       *//* PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR        *//* PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF    *//* LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING      *//* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS        *//* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.              *//*                                                                           *//*****************************************************************************//*  PLC Application OIL configuration file                                   *//*                                                                           *//*  This file describes the current OSEK configuration.                      *//*  References:                                                              *//*  - OSEK OS standard: http://portal.osek-vdx.org/files/pdf/specs/os223.pdf *//*  - OSEK OIL standard: http://portal.osek-vdx.org/files/pdf/specs/oil25.pdf*//*****************************************************************************/OSEK OSEK {   OS	ExampleOS {      STATUS = EXTENDED;      ERRORHOOK = TRUE;      PRETASKHOOK = FALSE;      POSTTASKHOOK = FALSE;      STARTUPHOOK = FALSE;      SHUTDOWNHOOK = FALSE;      USERESSCHEDULER = FALSE;      MEMMAP = FALSE;   };   RESOURCE = POSIXR;   EVENT = POSIXE;   APPMODE = AppMode1;   TASK InitTask {      PRIORITY = 1;      ACTIVATION = 1;      AUTOSTART = TRUE {         APPMODE = AppMode1;      }      STACK = 512;      TYPE = EXTENDED;      SCHEDULE = NON;      RESOURCE = POSIXR;      EVENT = POSIXE;   }   TASK PeriodicTask {      PRIORITY = 2;      ACTIVATION = 1;      STACK = 512;      TYPE = EXTENDED;      SCHEDULE = FULL;      RESOURCE = POSIXR;      EVENT = POSIXE;   }   ALARM ActivatePeriodicTask {      COUNTER = HardwareCounter;      ACTION = ACTIVATETASK {         TASK = PeriodicTask;      }   }   TASK PLC_SystemTask {      PRIORITY = 10;      ACTIVATION = 1;      STACK = 512;      TYPE = EXTENDED;      SCHEDULE = NON;      RESOURCE = POSIXR;      EVENT = POSIXE;   }   ALARM ActivatePLC_SystemTask {      COUNTER = HardwareCounter;      ACTION = ACTIVATETASK {         TASK = PLC_SystemTask;      }   }   COUNTER HardwareCounter {      MAXALLOWEDVALUE = 1000;      TICKSPERBASE = 1;      MINCYCLE = 1;      TYPE = HARDWARE;      COUNTER = HWCOUNTER0;   };};'.	^ cCode.! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 20:31'!processor		^ processor! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 20:31'!processor: anObject		processor := anObject! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!programConfigurations		^ programConfigurations! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!programConfigurations: anObject		programConfigurations := anObject! !!PLC_Resource methodsFor: 'program and task configurations' stamp: 'EricPernia 11/7/2013 18:07'!removeProgConfig: aProgConfig	"Remueve del Recurso la Configuracin de Programa que le llega como parmetro"	self programConfigurations remove: aProgConfig.	^ aProgConfig.! !!PLC_Resource methodsFor: 'program and task configurations' stamp: 'EricPernia 11/7/2013 18:07'!removeTaskConfig: aTaskConfig	"Remueve del Recurso la Configuracin de Tarea que le llega como parmetro"	self taskConfigurations remove: aTaskConfig.		aTaskConfig resource: nil.	^ aTaskConfig.! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!resourceName		^ identifier! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!resourceName: anObject		identifier := anObject! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!softwareConfiguration		^ softwareConfiguration! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!softwareConfiguration: anObject		softwareConfiguration := anObject! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!taskConfigurations		^ taskConfigurations! !!PLC_Resource methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:57'!taskConfigurations: anObject		taskConfigurations := anObject! !!PLC_SoftwareConfiguration class methodsFor: 'instance creation' stamp: 'EricPernia 11/8/2013 03:10'!newFromHardwareConfiguration: aHardConfig	"Crea una nueva isntancia a partir de la Configuracin de Hardware recibida como parmetro"	| softConfig |		"Creo la Configuracin de Software"	softConfig := self new.		"Le asigno la Configuracin de Hardware a la de Software"	softConfig hardwareConfiguration: aHardConfig.		"Le agrego a  la Configuracin de Software los Recursos 	que me provea la Configuracin de Hardware"	aHardConfig resources do: [  :each |		softConfig addResource: each.		].		softConfig softConfigName: 		aHardConfig hardConfigName.		^ softConfig.	! !!PLC_SoftwareConfiguration methodsFor: 'resources' stamp: 'EricPernia 11/7/2013 17:52'!addResource: aResource	"Aade a la Configuracin de Software el recurso aResource que le llega como parmetro"	self resources add: aResource.		aResource softwareConfiguration: self.		^ aResource.! !!PLC_SoftwareConfiguration methodsFor: 'compilation' stamp: 'EricPernia 3/17/2016 02:12'!cCompile	"Llama al compilador y grabador para que genere los archivos C y H."	PLC_CompilerAndWriter current cCompile: self.! !!PLC_SoftwareConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/1/2013 18:09'!calledPOUs	"Devuelve un Set con las POU que llama cada Configuracin de 	Programa de cada uno de sus Recursos."	| pouSet |		pouSet := Set new.		self resources do: [ :each |		pouSet addAll: each calledPOUs.		].	^ pouSet.! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:49'!declarations		^ declarations! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:49'!declarations: anObject		declarations := anObject! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 04:36'!globalVarDecls		^ self declarations! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:49'!hardwareConfiguration		^ hardwareConfiguration! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:49'!hardwareConfiguration: anObject		hardwareConfiguration := anObject! !!PLC_SoftwareConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 04:41'!ilCompile	"Devuelve un String con el Configuracin de Software Compilada a cdigo IL."	| ilCode |		ilCode := 'CONFIGURATION ' 	, self softConfigName	, '		(* Declaraciones de Configuracion *)'.	self globalVarDecls		ifNotNil: [ 			ilCode := ilCode ,			self globalVarDecls ilCompile , ''.			].		ilCode := ilCode ,'		(* Recursos *)'.	self resources		ifNotNil: [ 			self resources do: [ :each | 				ilCode := ilCode , each ilCompile , ''.				].			].	ilCode := ilCode ,'		END_CONFIGURATION'.	^ ilCode.	! !!PLC_SoftwareConfiguration methodsFor: 'initialize-release' stamp: 'EricPernia 11/8/2013 02:15'!initialize	"Inicializaciones de Recurso"	self resources: OrderedCollection new.		"POR AHORA COMO SOLO HAGO QUE CONFIGURACION TENGA 	SOLO DECLARACIONES DE VARIABLES GLOBALES NO HACE FALTA EL 	OBJETO PLC_SOFT_CONFIG_DECLARATIONS"	self declarations: PLC_VariableCategoryDecl globalVarDecls.! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:49'!resources		^ resources! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:49'!resources: anObject		resources := anObject! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:50'!softConfigName		^ identifier! !!PLC_SoftwareConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/3/2013 02:49'!softConfigName: anObject		identifier := anObject! !!PLC_CyclicTaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 01:46'!cCompile	"Devuelve la definicion de funcin de Tarea de freeRTOS en lenguaje C.	Es la tarea cclica del Sistema que ejecuta todos los programas sin asociacin	con Tareas."			| task |		task := '	/*---------------------------------------------------------------------------------------------------------*/void vPLeriCScanCycleTask(void *pvParameters){		/* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */		'.	"Declaraciones de variables de instancia de Programa sin valor inicial"	 self programConfigurations do: [ :each |		task := task , each instanceOperand declaration cCompileWithoutInitialValue , '			'.		 ].		task := task , '	/* Cada tarea del S.O. freeRTOS contiene un bucle infinito */		for( ;; )	{			/* Lectura de las entradas fsicas */		entradas = Read_IN();		I0 = Convert_Uint8_t_2_PLC_1ByteRegister(entradas);						/* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */		' .			"Llamados a Programa compilados a C"	 self programConfigurations do: [ :each |		task := task , each cCompile , '		'.		 ].			task := task , 			'		/* Escritura de salidas fsicas */		salidas = Convert_PLC_1ByteRegister_2_Uint8_t( Q0 );		Write_OUT(salidas);			}}'.							^ task.			! !!PLC_CyclicTaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 19:17'!cCompilePrototype	"Devuelve la definicion de funcin de Tarea de freeRTOS en lenguaje C.	Es la tarea cclica del Sistema que ejecuta todos los programas sin asociacin	con Tareas."				^ '		void vPLeriCScanCycleTask(void *);'.! !!PLC_CyclicTaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 19:22'!cTaskCreate	"Devuelve la definicion de funcin de Tarea de freeRTOS en lenguaje C.	Es la tarea cclica del Sistema que ejecuta todos los programas sin asociacin	con Tareas."	"Tiene prioridad 0. En freeRTOS es la menor prioridad."			^ '		/* Crea una instancia de Tarea ciclica PLeriC Scan cycle. */	xTaskCreate( vPLeriCScanCycleTask, "PLeriC Scan cycle", 512, NULL, 0, NULL );'.! !!PLC_CyclicTaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 19:06'!ilCompile	"La tarea ciclica del sistema no genera codigo IL."		^ ''.	! !!PLC_CyclicTaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 19:22'!taskCPriority	"Devuelve el valor de prioridad de la Tarea c como String."	"Tiene prioridad 0. En freeRTOS es la menor prioridad."		^ '0'.! !!PLC_TaskConfiguration class methodsFor: 'instance creation' stamp: 'EricPernia 11/1/2013 21:22'!newWithName: aTaskName	"Crea una nueva Configuraccin de Tarea con nombre aTaskName."	| taskConfig |		taskConfig := self new.		taskConfig taskName: aTaskName.	^ taskConfig.! !!PLC_TaskConfiguration methodsFor: 'program configurations' stamp: 'EricPernia 11/8/2013 16:40'!addProgConfig: aProgConfig	"Aade a la Tarea la Configuracin de programa aProgConfig que le llega como parmetro"	| set |		"Con el set evito que una tarea tenga configuraciones de programas repetidas"	set := self programConfigurations asSet.	set add: aProgConfig.	self programConfigurations: set asOrderedCollection.		aProgConfig task: self.		^ aProgConfig.! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 16:34'!cCompile	"Devuelve la definicion de funcin de Tarea de freeRTOS en lenguaje C.		Ejemplo:/*-----------------------------------------------------------*/void vPeriodicTask_TareaEj(void *pvParameters){	portTickType xLastWakeTime;	/* La variable xLastWakeTime necesita ser inicializada con el conteo actual	de ticks. Ntese que este es el nico momento que se accede a esta variable.	De aqu en adelante xLastWakeTime es manejada automticamente por la funcin	API vTaskDelayUntil(). */	xLastWakeTime = xTaskGetTickCount(); 	// xTaskGetTickCount() es la funcin API del S.O.  	// freeRTOS para obtener el conteo de Ticks del Sistema.		/* DECLARACIN DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS	PLC_P_Struct_ProgEj es un tipo de datos estructurado	que contiene todas las declaraciones de variables de	ProgEj como miembros */	PLC_P_Struct_ProgEj ProgEj_Instance;	/* Cada tarea del S.O. contiene un bucle infinito */	for( ;; )	{			/* Leo las entradas fsicas */		entradas = Read_IN();		/* Convierto de Uint8_t a campo de bits*/		I = Convert_Uint8_t_2_PLC_1ByteRegister(entradas);						/* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */				// Lectura de parmetros de entrada		ProgEj_Instance.Ent1 = I0.b0;		ProgEj_Instance.Ent2 = I0.b1;				// Llamo al Programa		ProgEj(&ProgEj_Instance);				// Escritura de parmetros de salida		Q0.b0 = ProgEj_Instance.Sal;						/* Escritura de salidas fsicas */		salidas = Convert_PLC_Digital_PORT_8_2_Uint8_t(Q0);		Write_OUT(salidas);						/* Trarea peridica cada 20ms utilizando la API 		del S.O. freeRTOS de Dealay Peridico. 		Se pone el parmetro en ms / portTICK_RATE_MS. */		vTaskDelayUntil(&xLastWakeTime, (20/portTICK_RATE_MS));			}}"		| task |		task := '	/*---------------------------------------------------------------------------------------------------------*/void vPeriodicTask_', self taskName,'(void *pvParameters){	portTickType xLastWakeTime;	/* La variable xLastWakeTime necesita ser inicializada con el conteo actual	de ticks. Ntese que este es el nico momento que se accede a esta variable.	De aqu en adelante xLastWakeTime es manejada automticamente por la funcin	API vTaskDelayUntil(). */	xLastWakeTime = xTaskGetTickCount(); 	/* xTaskGetTickCount() es la funcin API del S.O. freeRTOS para obtener el conteo 	de Ticks del Sistema.*/		/* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */		'.	"Declaraciones de variables de instancia de Programa sin valor inicial"	 self programConfigurations do: [ :each |		task := task , each instanceOperand declaration cCompileWithoutInitialValue , ';			'.		 ].		task := task , '	/* Cada tarea del S.O. freeRTOS contiene un bucle infinito */		for( ;; )	{			/* Lectura de las entradas fsicas */		entradas = Read_IN();		I0 = Convert_Uint8_t_2_PLC_1ByteRegister(entradas);						/* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */		' .			"Llamados a Programa compilados a C"	 self programConfigurations do: [ :each |		task := task , each cCompile , '		'.		 ].			task := task , 			'		/* Escritura de salidas fsicas */		salidas = Convert_PLC_1ByteRegister_2_Uint8_t( Q0 );		Write_OUT(salidas);						/* Trarea peridica cada Xms utilizando la API del S.O. freeRTOS de Dealay 		Peridico. Se pone el parmetro en ms / portTICK_RATE_MS. */		vTaskDelayUntil( &xLastWakeTime, ( '			, self taskCInterval 		, ' / portTICK_RATE_MS ) );			}}'.							^ task.			! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/1/2013 20:41'!cCompilePrototype	"Devuelve el prototipo de funcin de Tarea de freeRTOS en lenguaje C.		Ejemplo:	void vPeriodicTask_TareaEj(void *);		"		| task |		task := '		void vPeriodicTask_'	, self taskName	, '(void *);'.			^ task.			! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/1/2013 20:00'!cPOUName	"Devuelve el nombre en C de la POU"		"Ejemplo: 		PLC_F_ADD_INT"		^ self declaration cPOUName.! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 16:31'!cTaskCreate	"Devuelve la API de creacin de esta Tarea de freeRTOS en lenguaje C.		Ejemplo:	void vPeriodicTask_TareaEj(void *);		"		| task |		task := '		/* Crea una instancia de la tarea periodica con prioridad X. */	xTaskCreate( vPeriodicTask_'	, self taskName	, ', "Tarea peridica '		, self taskName		, '", 512, NULL, '		, self taskCPriority 		, ', NULL );'.			^ task.			! !!PLC_TaskConfiguration methodsFor: 'initialize-release' stamp: 'EricPernia 11/5/2013 12:43'!createInitialInputAssignments	"Crea las asignaciones iniciales a las variables de entrada de la Tarea"	self inputAssignments: OrderedCollection new.		self inputAssignments add: 			( PLC_InputAssignment				newWithFormalParameter: 					( PLC_Variable 						newWithDeclaration: (self inputDecls at: 1)						andDataValue: nil )				andActtualArgument:					( PLC_Literal newWithDataType: PLC_DataType Bool andDataValue: false )			).			self inputAssignments add: 			( PLC_InputAssignment				newWithFormalParameter: 					( PLC_Variable 						newWithDeclaration: (self inputDecls at: 2)						andDataValue: nil )				andActtualArgument:					( PLC_Literal newWithDataType: PLC_DataType Time andDataValue: 0 )			).			self inputAssignments add: 			( PLC_InputAssignment				newWithFormalParameter: 					( PLC_Variable 						newWithDeclaration: (self inputDecls at: 3)						andDataValue: nil )				andActtualArgument:					( PLC_Literal newWithDataType: PLC_DataType UInt andDataValue: 0 )			).	! !!PLC_TaskConfiguration methodsFor: 'initialize-release' stamp: 'EricPernia 11/5/2013 12:56'!createInputVarDecls	"Crea las asignaciones iniciales a las variables de entrada de la Tarea"	self inputDecls: PLC_VariableCategoryDecl inputVarDecls.		self inputDecls add: ( 	PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Bool		andInitialValue: true 		andIdentifier: 'SINGLE' 	).		self inputDecls add: ( 	PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType Time		andInitialValue: 0 		andIdentifier: 'INTERVAL' 	).		self inputDecls add: ( 	PLC_SymbolicVariableDecl 		newWithDataType: PLC_DataType UInt		andInitialValue: 0 		andIdentifier: 'PRIORITY' 	).! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 23:31'!ilCompile	"Compila el elemento IL Configuracin de Tarea a IL."	"Por ejemplo:			TASK TareaEj ( 	INTERVAL := T#50 ms , PRIORITY := 1) ;'			"		^ '			TASK ' 		, self taskName , ' ( ' 		,  ( self inputAssignments at: 2 ) ilCompile , 'ms , ' 		,  ( self inputAssignments at: 3 ) ilCompile , ' ) ;'.			! !!PLC_TaskConfiguration methodsFor: 'initialize-release' stamp: 'EricPernia 11/1/2013 22:17'!initialize	"Inicializaciones"	self createInputVarDecls.		self createInitialInputAssignments.		self programConfigurations: OrderedCollection new.! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 20:04'!inputAssignments		^ inputAssignments! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 20:04'!inputAssignments: anObject		inputAssignments := anObject! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 20:04'!inputDecls		^ inputDecls! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 20:04'!inputDecls: anObject		inputDecls := anObject! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/1/2013 20:00'!instanceName	"Devuelve el nombre de la Instancia de la POU"		^ self instance identifier.! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/1/2013 20:00'!pouName	"Devuelve el identificador de la POU"		^ self declaration identifier.! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 20:52'!programConfigurations		^ programConfigurations! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 20:52'!programConfigurations: anObject		programConfigurations := anObject! !!PLC_TaskConfiguration methodsFor: 'program configurations' stamp: 'EricPernia 11/7/2013 17:58'!removeProgConfig: aProgConfig	"Remueve de la Tarea la Configuracin de programa aProgConfig que le llega como parmetro"	self programConfigurations remove: aProgConfig.		aProgConfig task: nil.	^ aProgConfig.! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 18:02'!resource		^ resource! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 18:02'!resource: anObject		resource := anObject.! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/1/2013 22:30'!taskCInterval	"Devuelve el valor de Periodicidad de la Tarea c como String."		| plcInterval |		plcInterval := (self inputAssignments at: 2) actualArgument dataValue.		^ plcInterval asString.! !!PLC_TaskConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 19:26'!taskCPriority	"Devuelve el valor de prioridad de la Tarea c como String."		"Las prioridades de TASK CONFIGURATION de PLC pueden ir de 0 (ms prioritaria)	a 9 (menor prioridad). Es al revs que en las Tareas freeRTOS. 	Guardo la Prioridad 0 (la menor prioridad en freeRTOS) para la tarea cclica.	Las demas pueden tener de 1 a 9.	Entonces: PrioridadFreeRTOS = 10 - PrioridadIEC para las tareas peridicas."		| plcPriority |		plcPriority := (self inputAssignments at: 3) actualArgument dataValue.		^ ( 10 - plcPriority ) asString.! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 20:32'!taskName		^ self identifier! !!PLC_TaskConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 20:33'!taskName: aString		self identifier: aString.! !!PLC_VC_Config methodsFor: 'formal parameter check' stamp: 'EricPernia 9/15/2013 19:11'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ true.! !!PLC_VC_Config methodsFor: 'formal parameter check' stamp: 'EricPernia 9/15/2013 19:11'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Config methodsFor: 'category name' stamp: 'EricPernia 9/15/2013 19:11'!varType		^ '_CONFIG'! !!PLC_VC_Constant methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:31'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ true.! !!PLC_VC_Constant methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:20'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Constant methodsFor: 'argument check' stamp: 'EricPernia 9/21/2013 19:54'!canBeWrite	"Devuelve true si acepta ser escrita. Esto es, si una declaracin de variable	en esta categora acpeta ser asignada como argumento a un parmetro 	formal del tipo VAR_OUTPUT o VAR_IN_OUT los cuales necesitan leer la 	variable asignada."		^ false.! !!PLC_VC_Constant methodsFor: 'category name' stamp: 'EricPernia 9/14/2013 01:20'!varType		^ '_CONSTANT'! !!PLC_VC_Extern methodsFor: 'formal parameter check' stamp: 'EricPernia 11/5/2013 20:09'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ true.! !!PLC_VC_Extern methodsFor: 'declarations check' stamp: 'EricPernia 11/5/2013 20:10'!acceptLocatedVarDecl	"Responde true si la ctegora de variables acepta Declaraciones de Variables Localizadas"	^ false.! !!PLC_VC_Extern methodsFor: 'formal parameter check' stamp: 'EricPernia 11/5/2013 20:09'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Extern methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 21:50'!cCompile	"Compila la declaracin de variable a C	Devuelve:		extern tipoDeDatos NombreVariable = ValorInicial ;		extern tipoDeDatos NombreVariable = ValorInicial ;		extern tipoDeDatos NombreVariable = ValorInicial ;	...		o un String vacio si no posee ninguna varDec		"	| decls |		decls := ''.				self declarations  do: [ :each |		decls := decls , '		extern ' , each cCompile , ';' .		].		^ decls.! !!PLC_VC_Extern methodsFor: 'category name' stamp: 'EricPernia 11/5/2013 20:09'!varType		^ '_EXTERN'! !!PLC_VC_FunInstVar methodsFor: 'formal parameter check' stamp: 'EricPernia 11/19/2013 05:02'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ true.! !!PLC_VC_FunInstVar methodsFor: 'declarations check' stamp: 'EricPernia 11/19/2013 05:02'!acceptLocatedVarDecl	"Responde true si la ctegora de variables acepta Declaraciones de Variables Localizadas"	^ true.! !!PLC_VC_FunInstVar methodsFor: 'formal parameter check' stamp: 'EricPernia 11/19/2013 05:02'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_FunInstVar methodsFor: 'initialize-release' stamp: 'EricPernia 9/9/2015 21:45'!initialize	"Inicializaciones. 	varType es el TIPO DE VARIABLE, es decir, la categora de variable, por ejemplo, _INPUT"	self declarations: Set new.	! !!PLC_VC_FunInstVar methodsFor: 'compilation' stamp: 'EricPernia 11/19/2013 05:02'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ 'pxPOU->'.! !!PLC_VC_Global methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:31'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ true.! !!PLC_VC_Global methodsFor: 'declarations check' stamp: 'EricPernia 9/22/2013 02:26'!acceptLocatedVarDecl	"Responde true si la ctegora de variables acepta Declaraciones de Variables Localizadas"	^ true.! !!PLC_VC_Global methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:27'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Global methodsFor: 'category name' stamp: 'EricPernia 9/14/2013 01:31'!varType		^ '_GLOBAL'! !!PLC_VC_InOut methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:27'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ false.! !!PLC_VC_InOut methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:27'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_InOut methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 11:17'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ 'pxPOU->'.! !!PLC_VC_InOut methodsFor: 'category name' stamp: 'EricPernia 9/14/2013 01:31'!varType		^ '_IN_OUT'! !!PLC_VC_Input methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:16'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ true.! !!PLC_VC_Input methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:16'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ true! !!PLC_VC_Input methodsFor: 'argument check' stamp: 'EricPernia 9/21/2013 19:55'!canBeWrite	"Devuelve true si acepta ser escrita. Esto es, si una declaracin de variable	en esta categora acpeta ser asignada como argumento a un parmetro 	formal del tipo VAR_OUTPUT o VAR_IN_OUT los cuales necesitan leer la 	variable asignada."		^ false.! !!PLC_VC_Input methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 11:17'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ 'pxPOU->'.! !!PLC_VC_Input methodsFor: 'category name' stamp: 'EricPernia 9/14/2013 01:14'!varType		^ '_INPUT'! !!PLC_VC_Instance methodsFor: 'formal parameter check' stamp: 'EricPernia 9/21/2013 18:27'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ false.! !!PLC_VC_Instance methodsFor: 'formal parameter check' stamp: 'EricPernia 9/21/2013 18:27'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Output methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:27'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ false.! !!PLC_VC_Output methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:27'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Output methodsFor: 'argument check' stamp: 'EricPernia 9/21/2013 19:51'!canBeRead	"Devuelve true si acepta ser leida. Esto es, si una declaracin de variable	en esta categora acpeta ser asignada como argumento a un parmetro 	formal del tipo VAR_INPUT o VAR_IN_OUT los cuales necesitan leer la 	variable asignada."		^ false.! !!PLC_VC_Output methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 11:17'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ 'pxPOU->'.! !!PLC_VC_Output methodsFor: 'category name' stamp: 'EricPernia 9/14/2013 01:31'!varType		^ '_OUTPUT'! !!PLC_VC_OutputWired methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:27'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ false.! !!PLC_VC_OutputWired methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:30'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ true! !!PLC_VC_OutputWired methodsFor: 'argument check' stamp: 'EricPernia 9/21/2013 19:50'!canBeRead	"Devuelve true si acepta ser leida. Esto es, si una declaracin de variable	en esta categora acpeta ser asignada como argumento a un parmetro 	formal del tipo VAR_INPUT o VAR_IN_OUT los cuales necesitan leer la 	variable asignada."		^ false.! !!PLC_VC_OutputWired methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 11:16'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ 'pxPOU->'.! !!PLC_VC_OutputWired methodsFor: 'category name' stamp: 'EricPernia 9/14/2013 01:30'!varType		^ '_OUTPUT'! !!PLC_VC_Return methodsFor: 'formal parameter check' stamp: 'EricPernia 11/16/2013 12:29'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ false.! !!PLC_VC_Return methodsFor: 'formal parameter check' stamp: 'EricPernia 11/16/2013 12:29'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Return methodsFor: 'declarations' stamp: 'EricPernia 11/16/2013 13:26'!add: aVarDecl	"Aade una declaracin de variable"	aVarDecl variableCategory: self.	( self declarations size < 1 )		ifTrue: [ 			^ self declarations add: aVarDecl.				].! !!PLC_VC_Return methodsFor: 'argument check' stamp: 'EricPernia 11/16/2013 12:29'!canBeRead	"Devuelve true si acepta ser leida. Esto es, si una declaracin de variable	en esta categora acpeta ser asignada como argumento a un parmetro 	formal del tipo VAR_INPUT o VAR_IN_OUT los cuales necesitan leer la 	variable asignada."		^ false.! !!PLC_VC_Return methodsFor: 'compilation' stamp: 'EricPernia 11/16/2013 12:29'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ 'pxPOU->'.! !!PLC_VC_Return methodsFor: 'category name' stamp: 'EricPernia 11/16/2013 12:29'!varType		^ '_OUTPUT'! !!PLC_VC_Temp methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:28'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ false.! !!PLC_VC_Temp methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:28'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Temp methodsFor: 'category name' stamp: 'EricPernia 9/14/2013 01:29'!varType		^ '_TEMP'! !!PLC_VC_Var methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:30'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ true.! !!PLC_VC_Var methodsFor: 'declarations check' stamp: 'EricPernia 9/22/2013 02:26'!acceptLocatedVarDecl	"Responde true si la ctegora de variables acepta Declaraciones de Variables Localizadas"	^ true.! !!PLC_VC_Var methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:28'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VC_Var methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 11:16'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ 'pxPOU->'.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/15/2013 19:15'!compilerVarDecls	"Devuelve una instancia de Declaraciones de variable internas declaradas 	por el compilador de lenguaje grfico. Se usa para VL_struct, 	FyFBcableada_struc que crea el compilador de Ladder.		VAR		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Var new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/14/2013 01:21'!constantVarDecls	"Devuelve una instancia de Declaraciones de variable de Salida		VAR CONSTANT		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Constant new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 11/5/2013 20:10'!externVarDecls	"Devuelve una instancia de Declaraciones de variable externas		VAR_EXTERN		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Extern new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/9/2015 21:36'!funInstVarDecls	"Devuelve una instancia de Declaraciones de variable internas		VAR		...	END_VAR		"		"CATEGORIA PARCHE"		^ PLC_VC_FunInstVar new.	! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/14/2013 01:38'!globalVarDecls	"Devuelve una instancia de Declaraciones de variable Globales		VAR_GLOBAL		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Global new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/14/2013 01:39'!inOutVarDecls	"Devuelve una instancia de Declaraciones de variable de Entrada-Salida		VAR_IN_OUT		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_InOut new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/14/2013 01:39'!inputVarDecls	"Devuelve una instancia de Declaraciones de variable de Entrada		VAR_INPUT		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Input new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/14/2013 01:40'!outputVarDecls	"Devuelve una instancia de Declaraciones de variable de Salida		VAR_OUTPUT		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Output new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/14/2013 01:40'!outputWiredVarDecl	"Devuelve una instancia de Declaraciones de variable de Salida que acepta cable 	(puede haber una nica salida que acepta cable por POU).		VAR_OUTPUT		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_OutputWired new.	^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 11/16/2013 13:27'!returnVarDecl	"Devuelve una instancia de Declaraciones de variable de Salida		VAR_OUTPUT		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Return new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/14/2013 01:40'!tempVarDecls	"Devuelve una instancia de Declaraciones de variable internas temporales		VAR_TEMP		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Temp new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'instance creation' stamp: 'EricPernia 9/14/2013 01:40'!varDecls	"Devuelve una instancia de Declaraciones de variable internas		VAR		...	END_VAR		"		| varDecls |		varDecls := PLC_VC_Var new.		^ varDecls.! !!PLC_VariableCategoryDecl class methodsFor: 'GUI information' stamp: 'EricPernia 5/3/2015 04:51'!variableCategoryFromString: aString	"Devuelve una categoria de variables a partir del string."	| varCategoryKey | 		varCategoryKey := aString asUppercase asSymbol.		"Si asigno alguno de estos se cuelga, buscar la causa."	( #(#VAR #VAR_TEMP) includes: varCategoryKey )		ifTrue: [ 			( varCategoryKey = #VAR )				ifTrue: [ 					^ self varDecls.				].			( varCategoryKey = #VAR )				ifTrue: [ 					^ self tempVarDecls.				].		].		"Si no encuentra devuelve nil"	^ nil.! !!PLC_VariableCategoryDecl methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:23'!acceptLiteral	"Devuelve true si acepta asignar literales."		^ true.! !!PLC_VariableCategoryDecl methodsFor: 'declarations check' stamp: 'EricPernia 9/22/2013 02:27'!acceptLocatedVarDecl	"Responde true si la ctegora de variables acepta Declaraciones de Variables Localizadas"	^ false.! !!PLC_VariableCategoryDecl methodsFor: 'formal parameter check' stamp: 'EricPernia 9/14/2013 01:24'!acceptWire	"Responde true si la categora de variables puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Esto se combina con el >>acceptWire de tipo de datos para definir si	un pin permite cable en una declaracion de variable.	No riene sentido en los lenguajes textuales. "	^ false! !!PLC_VariableCategoryDecl methodsFor: 'declarations' stamp: 'EricPernia 11/6/2013 15:35'!add: aVarDecl	"Aade una declaracin de variable"	aVarDecl variableCategory: self.	^ self declarations add: aVarDecl.	! !!PLC_VariableCategoryDecl methodsFor: 'declarations' stamp: 'EricPernia 6/5/2013 02:08'!at: index	"Devuelve una declaracin de variable en la posicion index"	^ self declarations at: index.! !!PLC_VariableCategoryDecl methodsFor: 'compilation' stamp: 'EricPernia 6/17/2013 15:32'!cCompile	"Compila la declaracin de variable a C	Devuelve:		tipoDeDatos NombreVariable = ValorInicial ;		tipoDeDatos NombreVariable = ValorInicial ;		tipoDeDatos NombreVariable = ValorInicial ;	...		o un String vacio si no posee ninguna varDec		"	| decls |		decls := ''.				self declarations  do: [ :each |		decls := decls , '		' , each cCompile , ';' .		].		^ decls.! !!PLC_VariableCategoryDecl methodsFor: 'compilation' stamp: 'EricPernia 9/7/2013 18:37'!cCompileWithoutInitialValue	"Compila la declaracin de variable a C sin valores iniciales de las variables	Devuelve:		tipoDeDatos NombreVariable ;		tipoDeDatos NombreVariable ;	tipoDeDatos NombreVariable ;	...		o un String vacio si no posee ninguna varDec		"	| decls |		decls := ''.				self declarations  do: [ :each |		decls := decls , '		' , each cCompileWithoutInitialValue , ';' .		].		^ decls.! !!PLC_VariableCategoryDecl methodsFor: 'argument check' stamp: 'EricPernia 9/21/2013 19:53'!canBeRead	"Devuelve true si acepta ser leida. Esto es, si una declaracin de variable	en esta categora acpeta ser asignada como argumento a un parmetro 	formal del tipo VAR_INPUT o VAR_IN_OUT los cuales necesitan leer la 	variable asignada."		^ true.! !!PLC_VariableCategoryDecl methodsFor: 'argument check' stamp: 'EricPernia 9/21/2013 19:53'!canBeWrite	"Devuelve true si acepta ser escrita. Esto es, si una declaracin de variable	en esta categora acpeta ser asignada como argumento a un parmetro 	formal del tipo VAR_OUTPUT o VAR_IN_OUT los cuales necesitan leer la 	variable asignada."		^ true.! !!PLC_VariableCategoryDecl methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 08:38'!declarations	"Declarations son declaraciones de variables, que pueden ser simbolicas o de estructura"	^ declarations! !!PLC_VariableCategoryDecl methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 08:38'!declarations: anObject	declarations := anObject! !!PLC_VariableCategoryDecl methodsFor: 'declarations' stamp: 'EricPernia 6/12/2013 00:04'!do: aBlock	"Envia do con el bloque aBlock a su coleccion interna"	self declarations do: aBlock.! !!PLC_VariableCategoryDecl methodsFor: 'declarations' stamp: 'EricPernia 11/7/2013 23:43'!first	"Devuelve una declaracin de variable en la posicion 1"	^ self at: 1! !!PLC_VariableCategoryDecl methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 23:10'!ilCompile	"Compila la declaracin de variable a IL	Devuelve:		VAR		varDec		varDec		...	END_VAR;		o un String vacio si no posee ninguna varDec		"	| varDecl |		( self declarations size = 0 )		ifTrue: [			^ ''.			] 		ifFalse: [			varDecl := '			VAR	', self varType , ''.			self declarations do: [ :each |				varDecl := varDecl , '				' , each ilCompile , ';' .				].					varDecl := varDecl , '			END_VAR'.			^ varDecl.			].	! !!PLC_VariableCategoryDecl methodsFor: 'compilation' stamp: 'EricPernia 6/19/2013 22:58'!ilCompileWithoutInitialValue	"Compila la declaracin de variable a IL sin valores iniciales de las variables	Devuelve:		VAR		varDec		varDec		...	END_VAR;		o un String vacio si no posee ninguna varDec		"	| varDecl |		( self declarations size = 0 )		ifTrue: [			^ ''.			] 		ifFalse: [			varDecl := '	VAR	', self varType , ''.			self declarations do: [ :each |				varDecl := varDecl , '		' , each ilCompileWithoutInitialValue , ';' .				].					varDecl := varDecl , '	END_VAR'.			^ varDecl.			].	! !!PLC_VariableCategoryDecl methodsFor: 'initialize-release' stamp: 'EricPernia 9/18/2013 18:33'!initialize	"Inicializaciones. 	varType es el TIPO DE VARIABLE, es decir, la categora de variable, por ejemplo, _INPUT"	self declarations: OrderedCollection new.		"self varType: ''."		"self acceptWire: false."! !!PLC_VariableCategoryDecl methodsFor: 'category name' stamp: 'EricPernia 5/2/2015 17:33'!keyword	^ ('VAR' , self varType) asSymbol.! !!PLC_VariableCategoryDecl methodsFor: 'declarations' stamp: 'EricPernia 11/7/2013 23:43'!last	"Devuelve una declaracin de variable en la posicion 1"	^ self at: self declarations size.! !!PLC_VariableCategoryDecl methodsFor: 'declarations' stamp: 'EricPernia 11/18/2013 07:03'!remove: aVarDecl	"Remueve una declaracin de variable"	^ self declarations remove: aVarDecl ifAbsent: [].! !!PLC_VariableCategoryDecl methodsFor: 'declarations' stamp: 'EricPernia 6/5/2013 02:08'!removeAt: index	"Remueve una declaracin de variable"	^ self declarations removeAt: index.! !!PLC_VariableCategoryDecl methodsFor: 'accessing' stamp: 'EricPernia 9/21/2013 20:10'!scope	"scope es la variable de instancia que se engancha con unas declaraciones de 	POU , declaraciones de Configuracin o declaraciones de Recurso. Cada una de	estas modela unmbito o scope en ingles."		^ scope! !!PLC_VariableCategoryDecl methodsFor: 'accessing' stamp: 'EricPernia 9/21/2013 19:59'!scope: anObject		scope := anObject! !!PLC_VariableCategoryDecl methodsFor: 'declarations' stamp: 'EricPernia 6/11/2013 23:53'!size	"Devuelve la cantidad de elementos que tiene en su OC"	^ self declarations size.! !!PLC_VariableCategoryDecl methodsFor: 'find' stamp: 'CarlosLombardi 10/2/2016 20:14'!varDeclWithIdentifierOrNIl: aVariableIdentifier	"La delaracion de variable con el identificador aVariableIdentifier.	 Si no hay, devuelve nil"	^ self declarations 		detect: [ :each |			each identifier = aVariableIdentifier			 ] 		ifNone: [			^ nil.				]. ! !!PLC_VariableCategoryDecl methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 11:15'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ ''.! !!PLC_VariableCategoryDecl methodsFor: 'category name' stamp: 'EricPernia 9/14/2013 01:23'!varType		^ ''! !!PLC_LocatedSymbolicVariableDecl class methodsFor: 'instance creation' stamp: 'EricPernia 11/5/2013 06:54'!newWithDataType: aDataType andInitialValue: anInitialValue andIdentifier: anIdentifier andPhysicalAddress: aPhysicalAddress	"Nueva instancia con tipo de datos, valor inicial e identificador seteados"	| var |		var := self newWithDataType: aDataType andInitialValue: anInitialValue andIdentifier: anIdentifier.		aPhysicalAddress		ifNotNil: [			var	physicalAddress: aPhysicalAddress.			]. 		^ var.! !!PLC_LocatedSymbolicVariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 06:46'!cCompile	"Compila la declaracin de variable a C"	"NO SE COMO PONERLE EL VALOR INICIAL A LA MACRO"	self cCompileWithoutInitialValue.! !!PLC_LocatedSymbolicVariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 06:24'!cCompileWithoutInitialValue	"Compila la declaracin de variable a C	HACER   COMO  MACRO !!!!!!	Ejemplos de macros en C:		#define PI 3.14	#define AREA_CIRCULO(x) PI * (x) * (x)		Devuelve:		#define NombreVariable %I0.X.x0		"	^ '#define ' , self identifier , ' ' , self physicalAddress cCompile.! !!PLC_LocatedSymbolicVariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 06:12'!ilCompileWithoutInitialValue	"Compila la declaracin de variable a IL	Devuelve:		NombreVariable :  tipoDeDatos		Ej: 		MyBit AT %I0.0  :  BOOL		"			^  self identifier , ' AT ' , self physicalAddress ilCompile , ' : ' ,  self dataType ilCompileDataType.	! !!PLC_LocatedSymbolicVariableDecl methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 05:34'!physicalAddress		^ physicalAddress! !!PLC_LocatedSymbolicVariableDecl methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 05:34'!physicalAddress: anObject		physicalAddress := anObject! !!PLC_LocatedVariableDecl class methodsFor: 'instance creation' stamp: 'EricPernia 11/5/2013 06:54'!newWithDataType: aDataType andInitialValue: anInitialValue andPhysicalAddress: aPhysicalAddress	"Nueva instancia con tipo de datos, valor inicial y direcccion seteados"	| var initVal |		var := self new.		var dataType: aDataType.		anInitialValue 		ifNil: [			"Por defecto"			var initialValue: aDataType initialValue.			] 		ifNotNil: [			"Por defecto, si no es ninguno de los sigueintes"			initVal := aDataType initialValue.						"Si es tipo Elemental"			( aDataType isElementaryDataType )				ifTrue: [					initVal := PLC_Literal 						newWithDataType: aDataType 						andDataValue: anInitialValue.					].							"Si es tipo Estructurado"			( aDataType isStructDataType )				ifTrue: [					aDataType initialValue: anInitialValue.					initVal := aDataType initialValue.					].							"Asigno el valor inicial"			var initialValue: initVal.			]. 			aPhysicalAddress		ifNotNil: [			var	physicalAddress: aPhysicalAddress.			]. 			^ var.! !!PLC_LocatedVariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 13:36'!cCompileWithoutInitialValue	"Compila la declaracin de variable a IL	"		"NO SIRVE PERO SI NO SECUELGA SI ALGUIEN LE DICE C COMPILE"		^ self physicalAddress cCompile.	! !!PLC_LocatedVariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 06:06'!ilCompileWithoutInitialValue	"Compila la declaracin de variable a IL	"			^ 'AT ' , self physicalAddress ilCompile , ' : ' ,  self dataType ilCompileDataType.	! !!PLC_LocatedVariableDecl methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 05:34'!physicalAddress		^ physicalAddress! !!PLC_LocatedVariableDecl methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 05:34'!physicalAddress: anObject		physicalAddress := anObject! !!PLC_InstanceVariableDecl methodsFor: 'compilation' stamp: 'EricPernia 9/10/2015 03:31'!cCompileWithoutInitialValue	"Compila la declaracin de variable a C	Devuelve:		static tipoDeDatos NombreVariable		Ej: 		static PLC_Bool MyBit		"		"PARCHE Saque el staric"	"^ 'static ' , super cCompileWithoutInitialValue."	^ super cCompileWithoutInitialValue.! !!PLC_SymbolicVariableDecl methodsFor: 'compilation' stamp: 'EricPernia 5/7/2015 08:28'!cCompileWithoutInitialValue	"Compila la declaracin de variable a C	Devuelve:		tipoDeDatos NombreVariable		Ej: 		PLC_Bool MyBit		"	^ self dataType cCompileDataType , ' ' , self identifier.! !!PLC_SymbolicVariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 05:36'!ilCompileWithoutInitialValue	"Compila la declaracin de variable a IL	Devuelve:		NombreVariable :  tipoDeDatos		Ej: 		MyBit  :  BOOL		"	^ self identifier , ' : ' ,  self dataType ilCompileDataType.! !!PLC_VariableDecl class methodsFor: 'instance creation' stamp: 'EricPernia 11/6/2013 15:33'!newWithDataType: aDataType andInitialValue: anInitialValue andIdentifier: anIdentifier	"Nueva instancia con tipo de datos, valor inicial e identificador seteados"	| var initVal |		var := self new.		var dataType: aDataType.		" P A R C H E   le clavo una categoria para que haga bien lo de pxPOU->"		var variableCategory: PLC_VariableCategoryDecl varDecls.			anInitialValue 		ifNil: [			"Por defecto"			var initialValue: aDataType initialValue.			] 		ifNotNil: [			"Por defecto, si no es ninguno de los sigueintes"			initVal := aDataType initialValue.						"Si es tipo Elemental"			( aDataType isElementaryDataType )				ifTrue: [					initVal := PLC_Literal 						newWithDataType: aDataType 						andDataValue: anInitialValue.					].							"Si es tipo Estructurado"			( aDataType isStructDataType )				ifTrue: [					aDataType initialValue: anInitialValue.					initVal := aDataType initialValue.					].							"Asigno el valor inicial"			var initialValue: initVal.			]. 			anIdentifier		ifNotNil: [			var	identifier: anIdentifier.			]. 					^ var.! !!PLC_VariableDecl class methodsFor: 'instance creation' stamp: 'EricPernia 11/6/2013 15:33'!newWithDataType: aDataType andInitialValue: anInitialValue andIdentifier: anIdentifier andCategory: aCategory	"Nueva instancia con tipo de datos, valor inicial e identificador seteados"	| var |		var := self newWithDataType: aDataType andInitialValue: anInitialValue andIdentifier: anIdentifier.		var variableCategory: aCategory.					^ var.! !!PLC_VariableDecl methodsFor: 'accept' stamp: 'CarlosLombardi 10/14/2016 14:59'!acceptLiteral: aLiteral	"Responde true si:		Su tipo de datos acepta el valor y		Su tipo de datos acepta el tipo y		Su categora  acepta literal"		^ ( self dataType acceptValue: aLiteral dataValue ) 		and: [ 			( self dataType acceptType: aLiteral dataType )				and: [					self variableCategory acceptLiteral					]			].! !!PLC_VariableDecl methodsFor: 'accept' stamp: 'EricPernia 9/14/2013 03:12'!acceptValue: aValue	"Responde true si su tipo de datos acepta el valor"	self dataType acceptValue: aValue.! !!PLC_VariableDecl methodsFor: 'accept' stamp: 'CarlosLombardi 10/14/2016 15:00'!acceptVariable: aVariableOperand	"Responde true si su tipo de datos acepta el tipo.			El chequeo de si aVariableOaVariableOperand est entre las declaraciones 		de la POU que contiene a esta declaracion se hace luego del parseo."		^ self dataType acceptType: aVariableOperand dataType.		! !!PLC_VariableDecl methodsFor: 'wired' stamp: 'EricPernia 9/14/2013 03:08'!acceptWire	"Responde true si la declaracin de variable puede cablear su variable 	en un lenguaje grfico si es utilizado como pin de una POU.	Le pregunta a su categora y a su tipo de datos para responder esto,	No riene sentido en los lenguajes textuales. "	^ self variableCategory acceptWire and: [ self dataType acceptWire ].	! !!PLC_VariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 06:09'!cCompile	"Compila la declaracin de variable a C	Devuelve:		tipoDeDatos NombreVariable = ValorInicial		Ej: 		PLC_Bool MyBit = 1;		"	| varDecl |		varDecl := self cCompileWithoutInitialValue.		initialValue		ifNil: [			^ varDecl.			]		ifNotNil: [			^ varDecl , ' = ' , self initialValue cCompile.			].! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 9/25/2012 21:02'!dataType	^ dataType! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 9/25/2012 21:02'!dataType: anObject	dataType := anObject! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 18:16'!description	^ description! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 18:16'!description: anObject	description := anObject! !!PLC_VariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 06:06'!ilCompile	"Compila la declaracin de variable a IL	Devuelve:		NombreVariable : tipoDeDatos  := ValorInicial		Ej: 		MyBit : BOOL  := 1		"	| varDecl |		varDecl := self ilCompileWithoutInitialValue.		initialValue		ifNil: [			^ varDecl.			]		ifNotNil: [			^ varDecl , ' := ' , self initialValue ilCompile.			].! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 6/16/2013 19:48'!initialValue	^ initialValue! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 6/16/2013 19:48'!initialValue: anObject	initialValue := anObject! !!PLC_VariableDecl methodsFor: 'initialize-release' stamp: 'EricPernia 9/13/2013 20:10'!initialize	"Inicializa la declaracion de variable"		description := ''.	! !!PLC_VariableDecl methodsFor: 'testing' stamp: 'EricPernia 8/12/2012 01:49'!isConstant	"Devuelve false pues es variable"	^ false.! !!PLC_VariableDecl methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:04'!isLiteral	"Devuelve true pues es variable"	^ false.! !!PLC_VariableDecl methodsFor: 'testing' stamp: 'EricPernia 8/12/2012 01:49'!isVaraible	"Devuelve true pues es variable"	^ true.! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 6/21/2013 21:01'!operand		operand ifNil: [ 		operand := PLC_Variable 			newWithDeclaration: self 			andDataValue: self initialValue.			].			^ operand.! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 6/16/2013 19:48'!operand: anObject		operand := anObject! !!PLC_VariableDecl methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 11:42'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ self variableCategory varScopePrefix.  "==> Va este el de abajo es un PARCHE"			"self variableCategory 		ifNil: [ 			^ 'pxPOU->'.			] 		ifNotNil: [  			^ self variableCategory varScopePrefix.			 ]."	"Este parche hace que si una declaracin de variable no pertenece a ninguna categora le sampe por las dudas el pxPOU->"! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 9/14/2013 03:08'!variableCategory		^ variableCategory! !!PLC_VariableDecl methodsFor: 'accessing' stamp: 'EricPernia 9/14/2013 03:08'!variableCategory: anObject		variableCategory := anObject! !!PLC_CompilerAndWriter class methodsFor: 'instance creation' stamp: 'EricPernia 11/1/2013 16:15'!clearInstance 	"Elimina la unica instancia de esta clase."	Instance ifNotNil: 		[		Instance := nil.		].! !!PLC_CompilerAndWriter class methodsFor: 'instance creation' stamp: 'EricPernia 5/18/2015 04:04'!current 	"Devuelve la unica instancia de esta clase."	Instance ifNil: 		[		Instance := PLC_CompilerAndWriter new.		].		^ Instance.! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 3/16/2016 20:14'!buildCProgram	"Hace el build del Proyecto en C que tiene el Programa Completo de 	usuario (Configuracin de Software implementada en C) + Entorno de 	Ejecucin."		buildEneable		ifTrue: [			OSProcess command: self fileSystem buildFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 3/17/2016 02:11'!buildDownloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	( buildEneable and: [downloadEneable] )		ifTrue: [						"make			make download"			OSProcess command: self fileSystem buildDownloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 03:05'!buildEneable		^ buildEneable! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 03:05'!buildEneable: anObject		buildEneable := anObject! !!PLC_CompilerAndWriter methodsFor: 'compile' stamp: 'EricPernia 5/18/2015 14:38'!cCompile: aSoftConfig	"Crea los archivos y hace el build del Proyecto en C que tiene el Programa Completo de usuario 	(Configuracin de Software implementada en C) + Entorno de Ejecucin."	"Clean de los archivos .C y .H"	"self cleanCProject."	"Crea los archivos .C y .H"	self createCProjectFor: aSoftConfig.	"Build de los archivos .C y .H"	"self buildCProject."	"Transcript open.	Transcript show: 'El Programa ha sido compilado a C, puede ver el resultado en la ruta /shared/IDE4PLC_LPC1769_WS/Para generar un ejecutable utilice un compilador de C externo.'"	! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 7/14/2016 00:30'!cleanCFolders	"Elimina las carpetas del proytecto y las crea vacias."		self fileSystem cleanCFolders.		! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 7/14/2016 00:44'!cleanCProgram: aSoftConfig	"make clean"		"self cleanCProjectFor: aSoftConfig."		cleanEneable		ifTrue: [			"make clean"			OSProcess command: self fileSystem cleanFile.		].! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 3/24/2016 22:24'!cleanCProjectFor: aSoftConfig	"Elimina los archivos .C y .H dejando la estructura de carpetas, makefile y .oil."		"Creo las carpetas plc_application "	self cleanCFolders.		"Copio el Makefile"	self createMakefileFor: aSoftConfig.	"Copio el archivo OIL"	self createEtcFilesFor: aSoftConfig.! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 3/17/2016 02:07'!cleanEneable		^ cleanEneable! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 3/17/2016 02:07'!cleanEneable: anObject		cleanEneable := anObject! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 03:05'!connectEneable		^ connectEneable! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 03:05'!connectEneable: anObject		connectEneable := anObject! !!PLC_CompilerAndWriter methodsFor: 'deprecated commands' stamp: 'EricPernia 5/18/2015 01:37'!connectToDevice	"Abre una sesion de Debug con openOCD"		OSProcess command: 			self fileSystem connectFile.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 5/18/2015 03:09'!createCFolders	"Creo las carpetas del protecto"		self fileSystem createCFolders.		! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/2/2015 19:53'!createCProjectFor: aSoftConfig	"Crea los archivos .C y .H Crea los archivos Proyecto en C que tiene el	 Programa Completo de usuario (Configuracin de Software implementada en C)."		"Copio las carpetas src e inc de OSEK generadas desde el .oil"	self createOsekGenFilesFor: aSoftConfig.		"Creo las carpetas plc_application "	self createCFolders.		"Copio el Makefile"	self createMakefileFor: aSoftConfig.	"Copio el archivo OIL"	self createEtcFilesFor: aSoftConfig.	"Creo los archivos C"	self createSrcFilesFor: aSoftConfig.	"Creo los archivos H"	self createIncFilesFor: aSoftConfig.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 5/18/2015 03:03'!createEtcFilesFor: aSoftConfig	"Grabo el archivo plc_application.oil"	| "resource" working |	"Obtengo el recurso actual. Por ahora tengo uno solo."		"resource := aSoftConfig resources first."	"Grabo el archivo plc_application.oil"	"self fileSystem		write: resource osekApplicationOil		in: self fileSystem etcPath 		in: 'plc_application.oil'."			"Directorio actual"	working := FileSystem disk workingDirectory.		"Copio y pego"	working / self fileSystem cCodePath / 'plc_application.oil'		copyTo: 			working / self fileSystem etcPath / 'plc_application.oil'.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 5/18/2015 03:34'!createIncFilesFor: aSoftConfig	"Creo los archivos H"	| resource |	"Obtengo el recurso actual. Por ahora tengo uno solo."		resource := aSoftConfig resources first.		"Grabo el archivo plc_application.h"	self fileSystem		write: resource cApplicationH 		in: self fileSystem incPath 		in: 'plc_application.h'.		"Grabo el archivo PLC_UserPrograms.h"	self fileSystem 		write: resource cUserProgramsH 		in: self fileSystem incPath 		in: 'PLC_UserPrograms.h'.		"Grabo el archivo PLC_StdFunctions.h"	self fileSystem 		write: resource cStandardFunctionsH 		in: self fileSystem incPath 		in: 'PLC_StdFunctions.h'.		"Grabo el archivo PLC_StdFunctionBlocks.h"	self fileSystem 		write: resource cStandardFunctionBlocksH 		in: self fileSystem incPath 		in: 'PLC_StdFunctionBlocks.h'.	"Grabo el archivo PLC_UserFunctions.h"	self fileSystem 		write: resource cUserFunctionsH		in: self fileSystem incPath 		in: 'PLC_UserFunctions.h'.		"Grabo el archivo PLC_UserFunctionBlocks.h"	self fileSystem 		write: resource cUserFunctionBlocksH 		in: self fileSystem incPath 		in: 'PLC_UserFunctionBlocks.h'.			"Grabo el archivo PLC_UserTasks.h"	self fileSystem 		write: resource cUserTasksH		in: self fileSystem incPath	   in: 'PLC_UserTasks.h'.			"Grabo el archivo PLC_CompilerDerivedDataTypes.h"	self fileSystem 		write: resource cPCompilerDerivedDataTypesH		in: self fileSystem incPath		in: 'PLC_CompilerDerivedDataTypes.h'.			"Grabo el archivo PLC_UserDerivedDataTypes.h"	self fileSystem 		write: resource cUserDerivedDataTypesH		in: self fileSystem incPath		in: 'PLC_UserDerivedDataTypes.h'.			"Grabo el archivo PLC_App_Lib.h"	self fileSystem 		write: resource cAppLibH		in: self fileSystem incPath		in: 'PLC_App_Lib.h'.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 5/18/2015 03:02'!createMakefileFor: aSoftConfig	"Grabo el archivo Makefile"		|  working |	"Obtengo el recurso actual. Por ahora tengo uno solo."		"resource := aSoftConfig resources first.			self fileSystem		write: resource makefile 		in: self fileSystem makPath 		in: 'Makefile'."			working := FileSystem disk workingDirectory.		"Copio y pego"	working / self fileSystem cCodePath / 'Makefile'		copyTo: 			working / self fileSystem makPath / 'Makefile'.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/2/2015 21:03'!createOsekGenFilesFor: aSoftConfig	"Grabo el archivo Makefile"		|  working |	working := FileSystem disk workingDirectory.	"Si no existe /out/gen/src, copio los archivos generados de OSEK"	( ( working / self fileSystem genPath / 'src' ) exists )		ifFalse: [			"Copio y pego la carpeta src generada por OSEK a partir de plc_application.oil"				working / self fileSystem osekGenPath / 'src' 				copyAllTo: 					working / self fileSystem genPath / 'src'.		].				"Si no existe /out/gen/inc, copio los archivos generados de OSEK"			( ( working / self fileSystem genPath / 'inc' ) exists )		ifFalse: [			"Copio y pego la carpeta inc generada por OSEK a partir de plc_application.oil"				working / self fileSystem osekGenPath / 'inc' 				copyAllTo: 					working / self fileSystem genPath / 'inc'.		].! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 5/7/2015 06:14'!createSrcFilesFor: aSoftConfig	"Creo los archivos C"	| resource |	"Obtengo el recurso actual. Por ahora tengo uno solo."		resource := aSoftConfig resources first.	"Grabo el archivo plc_application.c"	self fileSystem		write: resource cApplicationC 		in: self fileSystem srcPath 		in: 'plc_application.c'.				"Grabo el archivo PLC_UserPrograms.c"	self fileSystem 		write: resource cUserProgramsC 		in: self fileSystem srcPath 		in: 'PLC_UserPrograms.c'.			"Grabo el archivo PLC_StdFunctions.c"	self fileSystem 		write: resource cStandardFunctionsC		in: self fileSystem srcPath 		in: 'PLC_StdFunctions.c'.		"Grabo el archivo PLC_StdFunctionBlocks.c"	self fileSystem 		write: resource cStandardFunctionBlocksC 		in: self fileSystem srcPath 		in: 'PLC_StdFunctionBlocks.c'.			"Grabo el archivo PLC_UserFunctions.c"	self fileSystem 		write: resource cUserFunctionsC		in: self fileSystem srcPath 		in: 'PLC_UserFunctions.c'.		"Grabo el archivo PLC_UserFunctionBlocks.c"	self fileSystem 		write: resource cUserFunctionBlocksC 		in: self fileSystem srcPath 		in: 'PLC_UserFunctionBlocks.c'.			"Grabo el archivo PLC_UserTasks.c"	self fileSystem 		write: resource cUserTasksC 		in: self fileSystem srcPath 		in: 'PLC_UserTasks.c'.! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 03:05'!downloadEneable		^ downloadEneable! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 03:05'!downloadEneable: anObject		downloadEneable := anObject! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 3/17/2016 01:58'!downloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	downloadEneable		ifTrue: [			"make download"			OSProcess command: self fileSystem downloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'deprecated commands' stamp: 'EricPernia 3/16/2016 03:34'!downloadSoftwareConfig	"Genera el cdigo C, lo Compila y lo Descarga al dispositivo"	"TODO: HACER ALGUNA LOGICA ACA PARA QUE SI CAMBIO DE BOARD	FRENE TODO Y AVISE CON UN CARTEL QUE SE CAMBIO LA PLACA Y 	QUE PRIMERRO PRESIONE EL BOTON DE CLEAN"		"Crea los archivos .C y .H"	IDE4PLC generateProgramCCode.		"Internamente copia y pega los archivos generados por OSEK, 	por eso no requiere 'make generate'"		"Compila y lo Descarga al dispositivo"	downloadEneable		ifTrue: [			"make			make download"			OSProcess command: self fileSystem compileAndDownloadFile.					].		"Transcript open.	Transcript show: 'No implementado an, por favor descargue el programa manualmente desde un programador externo.'"! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 16:15'!fileSystem		^ fileSystem! !!PLC_CompilerAndWriter methodsFor: 'accessing' stamp: 'EricPernia 11/1/2013 16:15'!fileSystem: anObject		fileSystem := anObject! !!PLC_CompilerAndWriter methodsFor: 'compile' stamp: 'EricPernia 5/7/2015 06:34'!ilCompile: aSoftConfig	"Crea los archivos .il."		| resource |			"HACER"				resource := aSoftConfig resources first.					"Grabo el archivo PLC_UserPrograms.c"	self fileSystem 		writeInCLibrary: resource cUserProgramsC 		in: 'PLC_UserPrograms.c'.		"Grabo el archivo PLC_UserPrograms.h"	self fileSystem 		writeInHLibrary: resource cUserProgramsH 		in: 'PLC_UserPrograms.h'.					"Grabo el archivo PLC_StdFunctions.c"	self fileSystem 		writeInCLibrary: resource cStandardFunctionsC		in: 'PLC_StdFunctions.c'.		"Grabo el archivo PLC_StdFunctions.h"	self fileSystem 		writeInHLibrary: resource cStandardFunctionsH 		in: 'PLC_StdFunctions.h'.					"Grabo el archivo PLC_StdFunctionBlocks.c"	self fileSystem 		writeInCLibrary: resource cStandardFunctionBlocksC 		in: 'PLC_StdFunctionBlocks.c'.		"LO CANCELE PORQUE JODIA CON EL SET QUE ME MEZCLA LAS DECLARACIONESaSoftConfig DE TYPEDEF DE LOS FB ENTONCES LOS CONTADORES Y TEMPORIZADORES NO ENCUENTRAN R_TRIG O F_TRIG"	"Grabo el archivo PLC_StdFunctionBlocks.h"	"self fileSystem 		writeInHLibrary: resource cStandardFunctionBlocksH 		in: 'PLC_StdFunctionBlocks.h'."						"Grabo el archivo PLC_UserTasks.il"	self fileSystem writeInCLibrary: 		resource cUserTasksC 		in: 'PLC_UserTasks.il'.										"aSoftConfig ilCompile."! !!PLC_CompilerAndWriter methodsFor: 'initialize-release' stamp: 'EricPernia 3/17/2016 02:36'!initialize 	"Inicializo la instancia de Compilador y Grabador"		fileSystem := PLC_CIAA_FileSystem current.		buildEneable := true.	connectEneable := true.	downloadEneable := true.	cleanEneable := true.	! !!PLC_CompilerAndWriter methodsFor: 'compiler os configs' stamp: 'EricPernia 3/17/2016 02:05'!linuxConfig 	"Configuro los Paths para MAC"		buildEneable := true.	connectEneable := true.	downloadEneable := true.	cleanEneable := true.! !!PLC_CompilerAndWriter methodsFor: 'compiler os configs' stamp: 'EricPernia 3/17/2016 02:05'!macOsXConfig 	"Configuro los Paths para MAC"		buildEneable := false.	connectEneable := false.	downloadEneable := false.	cleanEneable := false.! !!PLC_CompilerAndWriter methodsFor: 'compiler os configs' stamp: 'EricPernia 3/17/2016 02:06'!windowsConfig 	"Configuro los Paths para windows"		buildEneable := true.	connectEneable := true.	downloadEneable := true.	cleanEneable := true.! !!PLC_ConnectableBlock class methodsFor: 'instance creation' stamp: 'EricPernia 5/9/2012 19:23'!newWithElement: aPLC_Element	| tempBlock |		tempBlock := self new.	tempBlock element: aPLC_Element.		tempBlock buildInputs;		buildOutputs.		^ tempBlock.! !!PLC_ConnectableBlock methodsFor: 'Element-building' stamp: 'EricPernia 10/9/2012 21:13'!addInput	"Aade un pin de entrada al Bloque Conectable y le aade una entrada a su elemento."		"VER SI LE TENGO QUE PASAR COSAS POR PARAMETRO AL ELEMENTO COMO SER LA CATEGORIA DE SALIDA DE ENTRADA"	self addInputPin.	self element addInput.! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:04'!addInputPin	inputs add: (PLC_ConnectableBlockPin InputFor: self).! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:04'!addInputPin: pinToAdd after: aPin	"Aade el pin de entrada pinToAdd al Bloque Conectable despues del pin de entrada aPin."	inputs 		add: pinToAdd		after: aPin.! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:04'!addInputPinAfter: aPin	"Aade un nuevo pin de salida al Bloque Conectable despues del pin de salida aPin."	inputs 		add: (PLC_ConnectableBlockPin InputFor: self)		after: aPin.! !!PLC_ConnectableBlock methodsFor: 'Element-building' stamp: 'EricPernia 7/16/2013 21:44'!addOutput	"Aade un pin de salida al Bloque Conectable y le aade una salida a su elemento."	self addOutputPin.	self element addOutput.! !!PLC_ConnectableBlock methodsFor: 'Element-building' stamp: 'EricPernia 7/16/2013 21:56'!addOutputAfter: aPin	"Aade un pin de salida al Bloque Conectable y le aade una salida a su elemento	despues del pin de salida aPin."	self addOutputPinAfter: aPin.	self element addOutput.! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:04'!addOutputPin	outputs add: (PLC_ConnectableBlockPin OutputFor: self).! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:04'!addOutputPin: pinToAdd after: aPin	"Aade el pin de salida pinToAdd al Bloque Conectable despues del pin de salida aPin."	outputs 		add: pinToAdd		after: aPin.! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:05'!addOutputPinAfter: aPin	"Aade un nuevo pin de salida al Bloque Conectable despues del pin de salida aPin."	outputs 		add: (PLC_ConnectableBlockPin OutputFor: self)		after: aPin.! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:07'!blockConnectedToInput: anInputNumber	"Devuelve el bloque conectado a la entrada anInputNumber."		| connection |		inputs size >= anInputNumber		ifTrue: [			connection := ( inputs at: anInputNumber) connection.			connection				ifNil: [					^ nil.					] 				ifNotNil: [					^ connection outputPin block.					].			]		ifFalse: [			^ nil.			].		! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:07'!blockConnectedToOutput: anOutputNumber	"Devuelve el bloque conectado a la salida anInputNumber."		| connection |		outputs size >= anOutputNumber		ifTrue: [			connection := ( outputs at: anOutputNumber) connection.			connection				ifNil: [					^ nil.					] 				ifNotNil: [					^ connection inputPin block.					].			]		ifFalse: [			^ nil.			].		! !!PLC_ConnectableBlock methodsFor: 'Element-building' stamp: 'EricPernia 4/7/2015 01:02'!buildInputs	"Construye las entradas del bloque conectable. Para lograrlo, aade todas las entradas preguntandole la cantidad a su Elemento."		self element connectableBlockInputs timesRepeat: [self addInputPin].	! !!PLC_ConnectableBlock methodsFor: 'Element-building' stamp: 'EricPernia 4/7/2015 01:02'!buildOutputs	"Construye las salidas del bloque conectable. Para lograrlo, aade todas las salidas preguntandole la cantidad a su Elemento."	self element connectableBlockOutputs timesRepeat: [self addOutputPin].! !!PLC_ConnectableBlock methodsFor: 'Element-Compilation' stamp: 'EricPernia 10/5/2012 23:55'!cCompile	"Compila el bloque pidiendoselo a su elemento."	| ilBlockCode |		self element cCompileFor: self.		! !!PLC_ConnectableBlock methodsFor: 'accessing' stamp: 'EricPernia 9/15/2013 17:33'!connectableBlocksNetwork		^ connectableBlocksNetwork! !!PLC_ConnectableBlock methodsFor: 'accessing' stamp: 'EricPernia 9/15/2013 17:33'!connectableBlocksNetwork: anObject		connectableBlocksNetwork := anObject! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:07'!connectedAtInput: anInputNumber	"Devuelve la conexion a la entrada anInputNumber."		inputs size >= anInputNumber		ifTrue: [			^ ( inputs at: anInputNumber) connection.			]		ifFalse: [			^ nil.			].		! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:07'!connectedAtOutput: anOutputNumber	"Devuelve la conexion a la salida anOutputNumber."		outputs size >= anOutputNumber		ifTrue: [			^ ( outputs at: anOutputNumber) connection.			]		ifFalse: [			^ nil.			].		! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:11'!connectionToAddElement: aPLC_ElemenMorph	"Devuelve la conexion para aadirle un nuevo elemento."	^ element connectionToAddElement: aPLC_ElemenMorph inBlock: self! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:08'!disconnectInput: anInputNumber	"Desconecta la entrada numero 'anInputNumber' del bloque al que le mando este mensaje."	(inputs at: anInputNumber) disconnect.! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:08'!disconnectOutput: anOutputNumber	"Desconecta la entrada del bloque al que estaba conectado."	(outputs at: anOutputNumber) disconnect.! !!PLC_ConnectableBlock methodsFor: 'accessing' stamp: 'EricPernia 5/9/2012 16:26'!element	^ element! !!PLC_ConnectableBlock methodsFor: 'accessing' stamp: 'EricPernia 5/9/2012 16:26'!element: anObject	element := anObject! !!PLC_ConnectableBlock methodsFor: 'Element-Compilation' stamp: 'EricPernia 11/5/2013 13:05'!generateCodeIn: aProgramAccumulator	"Compila su programa a objetos que lo forman. Estos pueden dar su cdigo C o IL."	"Compila el bloque pidiendoselo a su elemento. Se pasa como parmetro debido a	que algunos elementos son nicos"			self element generateCodeIn: aProgramAccumulator for: self.! !!PLC_ConnectableBlock methodsFor: 'GraphicElementMorph-drawing' stamp: 'EricPernia 4/29/2013 16:01'!graphicElement	"Devuelve el elemento grafico (morph) de su elemento."	^ self element graphicElementFor: self.! !!PLC_ConnectableBlock methodsFor: 'Element-Compilation' stamp: 'EricPernia 10/5/2012 23:55'!ilCompile	"Compila el bloque pidiendoselo a su elemento."	| ilBlockCode |		self element ilCompileFor: self.		! !!PLC_ConnectableBlock methodsFor: 'initailize-release' stamp: 'EricPernia 4/7/2015 03:03'!initialize	"At inizialization it creates their inputs and outputs ordered collections."	inputs := OrderedCollection new.	outputs := OrderedCollection new.! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 9/25/2012 19:40'!input: anInputNumber connectTo: aConnectableBlock output: anOutputNumber	"Conecta la entrada numero anInputNumber del bloque al que le mando este mensaje con la salida numero anOutputNumber de aConnectableBlock."		^ aConnectableBlock output: anOutputNumber connectTo: self input: anInputNumber.! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:09'!inputPinAfter: unPin	"Devuelve el pin de salida posterior a unPin."		^ inputs after: unPin ifAbsent: [ nil ] ! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:05'!inputPinAt: aNumberOfInput	^ inputs at: aNumberOfInput.! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:09'!inputPinNumberConnectedToOutput: anOutputNumber	"Devuelve el Numero de pin de entrada que esta conectado al pin de salida anOutputNumber."		| connection connectableBlock |		outputs size >= anOutputNumber		ifTrue: [			connection := ( outputs at: anOutputNumber) connection.			connection				ifNil: [					^ nil.					] 				ifNotNil: [					connectableBlock := connection inputPin block.					^ connectableBlock inputs indexOf: connection inputPin.					].			]		ifFalse: [			^ nil.			].! !!PLC_ConnectableBlock methodsFor: 'accessing' stamp: 'EricPernia 5/9/2012 22:34'!inputs	^ inputs! !!PLC_ConnectableBlock methodsFor: 'accessing' stamp: 'EricPernia 5/9/2012 22:34'!inputs: anObject	inputs := anObject! !!PLC_ConnectableBlock methodsFor: 'testing' stamp: 'EricPernia 9/22/2012 21:55'!isConnectableBlock	"Devuelve true si es una instancia de la clase PLC_ConnectableBlock"	^ true.! !!PLC_ConnectableBlock methodsFor: 'testing' stamp: 'EricPernia 10/14/2012 04:53'!isConnection	"Devuelve siempre false. ESTE METODO ES UNA MUGRE PARA QUE FUNCIONE FACIL close branch"	^ false.! !!PLC_ConnectableBlock methodsFor: 'testing' stamp: 'EricPernia 4/7/2015 03:03'!isInputBlock	"Responde true si no tiene ninguna entrada"	^ inputs size == 0.! !!PLC_ConnectableBlock methodsFor: 'testing' stamp: 'EricPernia 4/22/2015 03:10'!isInputPin	"Responde true si es un pin de entrada"	^ false.! !!PLC_ConnectableBlock methodsFor: 'testing' stamp: 'EricPernia 4/7/2015 03:03'!isOutputBlock	"Responde true si no tiene ninguna salida"	^ outputs size == 0.! !!PLC_ConnectableBlock methodsFor: 'testing' stamp: 'EricPernia 4/22/2015 03:10'!isOutputPin	"Responde true si es un pin de slida"	^ false.! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:09'!output: anOutputNumber connectTo: aConnectableBlock input: anInputNumber	"Conecta la salida numero anOutputNumber del bloque al que le mando este mensaje con la entrada numero anInputNumber de aConnectableBlock."		| outputPin inputPin |		outputPin := outputs at: anOutputNumber.	inputPin := aConnectableBlock inputs at: anInputNumber.				^ outputPin connectTo: inputPin.! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:09'!outputPinAfter: unPin	"Devuelve el pin de salida posterior a unPin."		^ outputs after: unPin ifAbsent: [ nil ] ! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:05'!outputPinAt: aNumberOfOutput	^ outputs at: aNumberOfOutput.! !!PLC_ConnectableBlock methodsFor: 'connections' stamp: 'EricPernia 4/7/2015 03:10'!outputPinNumberConnectedToInput: anInputNumber	"Devuelve el Numero de pin de salida que esta conectado al pin de entrada anInputNumber."		| connection connectableBlock |		inputs size >= anInputNumber		ifTrue: [			connection := ( inputs at: anInputNumber) connection.			connection				ifNil: [					^ nil.					] 				ifNotNil: [					connectableBlock := connection outputPin block.					^ connectableBlock outputs indexOf: connection outputPin.					].			]		ifFalse: [			^ nil.			].! !!PLC_ConnectableBlock methodsFor: 'accessing' stamp: 'EricPernia 3/5/2012 06:59'!outputs	^ outputs! !!PLC_ConnectableBlock methodsFor: 'accessing' stamp: 'EricPernia 3/5/2012 06:59'!outputs: anObject	outputs := anObject! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:05'!removeInputPin: anInputPin	inputs remove: anInputPin.! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:05'!removeInputPinAt: aNumberOfInput	inputs removeAt: aNumberOfInput.! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:05'!removeOutputPin: anOutputPin	outputs remove: anOutputPin.! !!PLC_ConnectableBlock methodsFor: 'building' stamp: 'EricPernia 4/7/2015 03:05'!removeOutputPinAt: aNumberOfInput	outputs removeAt: aNumberOfInput.! !!PLC_ConnectableBlockConnection class methodsFor: 'instance creation' stamp: 'EricPernia 5/10/2012 23:27'!newWithInput: anInputPin andOutput: anOutputPin	| tempConnection |		tempConnection := self new.	tempConnection inputPin: anInputPin;		outputPin: anOutputPin.	^ tempConnection.! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 10/2/2012 23:51'!blockConnectedToInput: anInputNumber	"Devuelve el bloque conectado a la entrada de la conexion."		^ self connectedAtInput: anInputNumber.! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 10/2/2012 23:51'!blockConnectedToOutput: anOutputNumber	"Devuelve el bloque conectado a la salida de la conexion."		^ self connectedAtOutput: anOutputNumber.! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'CL 11/18/2013 03:15'!checkAutoconnectionWithPin: aPLC_Pin1 andPin: aPLC_Pin2	"Chequea si el Bloque Conectable del OutputPin de la conexion y el 	Bloque Conectable del InputPin de la conexion son iguales."	(aPLC_Pin1 block = aPLC_Pin2 block) 		ifTrue: [			self error: 'No se puede conectar a si mismo.'.			]. ! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'CL 11/18/2013 03:16'!checkOutputPin: anOutputPin andInputPin: anInputPin.	"Chequea si el Bloque Conectable del OutputPin de la conexion y el 	Bloque Conectable del InputPin de la conexion son iguales."	( anOutputPin isOutputPin and: [ anInputPin isInputPin ] ) 		ifFalse: [			self error: 'Error de direccionamiento de conexin. Se debe conectar un Pin de salida con un Pin de entrada.'.			]. ! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 10/14/2012 03:43'!connect: anOutputPin To: anInputPin.	"Agrega los 2 elementos que forman la conexin, es decir un bloque conectable y el nmero de pin correspondiente."		( anOutputPin isNil or: [ anInputPin isNil ] )		ifFalse: [ 			self checkAutoconnectionWithPin: anOutputPin andPin: anInputPin.			self checkOutputPin: anOutputPin andInputPin: anInputPin.			].			self outputPin: anOutputPin.	self inputPin: anInputPin.! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 9/22/2012 22:25'!connectedAtInput: anInputNumber	"Devuelve el bloque a la entrada."		anInputNumber = 1		ifTrue: [			^ self outputPin block.			]		ifFalse: [			^ nil.			].! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 9/22/2012 22:25'!connectedAtOutput: anOutputNumber	"Devuelve el bloque a la salida."		anOutputNumber = 1		ifTrue: [			^ self inputPin block.			]		ifFalse: [			^ nil.			].! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 4/17/2015 00:38'!connectionToAddElement: aPLC_ElemenMorph	"Devuelve la conexion para aadirle un nuevo elemento.	Cuando le piden aadir elemento a una conexin se devuelve a si misma."	^ self.		"Hacer que compruebe aqu si puede conectar o no el elemento nuevo pidiendole a los bloques de sus extremos si lo permiten"! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 5/10/2012 18:08'!disconnect	"Borra  los 2 elementos que forman la conexin, es decir, ambos pines."	self inputPin disconnectPin.	self outputPin disconnectPin.		self connect: nil To: nil.! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 10/2/2012 23:58'!disconnectInput: anInputNumber	"Borra  los el pin de entrada de la conexion."	anInputNumber = 1		ifTrue: [			self outputPin disconnectPin.			self connect: nil To: self inputPin.			].! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 10/2/2012 23:57'!disconnectOutput: anOutputNumber	"Borra  los 2 elementos que forman la conexin, es decir, ambos pines."	anOutputNumber = 1		ifTrue: [			self inputPin disconnectPin.			self connect: self outputPin To: nil.			].! !!PLC_ConnectableBlockConnection methodsFor: 'accessing' stamp: 'EricPernia 5/10/2012 16:30'!inputPin	^ inputPin! !!PLC_ConnectableBlockConnection methodsFor: 'accessing' stamp: 'EricPernia 5/10/2012 16:30'!inputPin: anObject	inputPin := anObject! !!PLC_ConnectableBlockConnection methodsFor: 'testing' stamp: 'CL 11/18/2013 03:16'!isConnectableBlock	"Devuelve true si es una instancia de la clase PLC_ConnectableBlock"	^ false.! !!PLC_ConnectableBlockConnection methodsFor: 'testing' stamp: 'CL 11/18/2013 03:17'!isConnection	"Devuelve true si es una instancia de la clase PLC_ConnectableBlockConnection"	^ true.! !!PLC_ConnectableBlockConnection methodsFor: 'testing' stamp: 'EricPernia 4/22/2015 03:11'!isInputPin	"Responde true si es un pin de entrada"	^ false.! !!PLC_ConnectableBlockConnection methodsFor: 'testing' stamp: 'EricPernia 4/22/2015 03:10'!isOutputPin	"Responde true si es un pin de slida"	^ false.! !!PLC_ConnectableBlockConnection methodsFor: 'accessing' stamp: 'EricPernia 5/10/2012 16:30'!outputPin	^ outputPin! !!PLC_ConnectableBlockConnection methodsFor: 'accessing' stamp: 'EricPernia 5/10/2012 16:30'!outputPin: anObject	outputPin := anObject! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 10/13/2012 21:12'!outputPinNumberConnectedToInput: anInputNumber	"Devuelve el Numero de pin de salida que esta conectado al pin de entrada anInputNumber."		| connectableBlock |		anInputNumber = 1		ifTrue: [			connectableBlock := self outputPin block.			^ connectableBlock outputs indexOf: self outputPin.			]		ifFalse: [			^ nil.			].! !!PLC_ConnectableBlockConnection methodsFor: 'connection' stamp: 'EricPernia 6/5/2013 23:04'!replaceConnectionByConnectingToInputPin: anInputPin andOutputPin: anOutputPin	"Elimina la conexion que recibe el mensaje y conecta el pin de salida de esa conexion al pin anInputPin,	que puede un pin de un bloque conectado a un circuito complejo, y conecta el pin anOutputPin, que puede	ser un pin de salida de un bloque de un circuito complejo, al pin de entrada de la conexion.		self es:			connectionOutputPin -----------> connectionInputPin  		lo reemplazo por:												    -------------------		 connectionOutputPin -----------> anInputPin |    circuito   |  anOutputPin -----------> connectionInputPin  												    -------------------	 "		| connectionOutputPin connectionInputPin |		"Busco los pines de los Bloques Conectables a entrada y salida de la conexion."	connectionOutputPin := self outputPin.	connectionInputPin := self inputPin.		"Desconecto la conexion"	self disconnect.		connectionOutputPin connectTo: anInputPin.	anOutputPin connectTo: connectionInputPin.! !!PLC_ConnectableBlockInputPin methodsFor: 'connections' stamp: 'CL 11/18/2013 03:05'!connectTo: anOutputPin		"Conecta al pin que le envio este mensaje con anOutputPin si ambos estan libres. self es un input pin"	|  connec |		(anOutputPin isOutputPin and: [ self disconnected and: [ anOutputPin disconnected ] ] )		ifTrue: [			connec := PLC_ConnectableBlockConnection newWithInput: self andOutput: anOutputPin.						connec checkAutoconnectionWithPin: anOutputPin andPin: self.						self connection: connec.			anOutputPin connection: connection.						^ connec.			]				ifFalse: [			]! !!PLC_ConnectableBlockInputPin methodsFor: 'test' stamp: 'EricPernia 5/10/2012 15:55'!isInputPin	"Responde true si es un pin de entrada"	^ true.! !!PLC_ConnectableBlockOutputPin methodsFor: 'connections' stamp: 'EricPernia 5/9/2013 17:14'!connectTo: anInputPin	"Conecta al pin que le envio este mensaje con anInputPin si ambos estan libres. self es un output pin"	| connec |		(anInputPin isInputPin and:  [self disconnected and: [ anInputPin disconnected ] ] )		ifTrue: [			connec := PLC_ConnectableBlockConnection newWithInput: anInputPin andOutput: self.						connec checkAutoconnectionWithPin: self andPin: anInputPin.						self connection: connec.			anInputPin connection: connec.						^ connec.						]		ifFalse: [			].! !!PLC_ConnectableBlockOutputPin methodsFor: 'test' stamp: 'EricPernia 5/10/2012 15:55'!isOutputPin	"Responde true si es un pin de salida"	^ true.! !!PLC_ConnectableBlockPin class methodsFor: 'instance creation' stamp: 'EricPernia 5/10/2012 16:03'!InputFor: aConnectableBlock	"Devuelve un nuevo PLC_ConnectableBlockInputPin con bloque aConnectableBlock."	| inputPin |		inputPin := PLC_ConnectableBlockInputPin new.	inputPin block: aConnectableBlock.	^ inputPin.! !!PLC_ConnectableBlockPin class methodsFor: 'instance creation' stamp: 'EricPernia 5/10/2012 16:03'!OutputFor: aConnectableBlock	"Devuelve un nuevo PLC_ConnectableBlockOutputPin con bloque aConnectableBlock."	| outputPin |		outputPin := PLC_ConnectableBlockOutputPin new.	outputPin block: aConnectableBlock.	^ outputPin.! !!PLC_ConnectableBlockPin methodsFor: 'accessing' stamp: 'EricPernia 5/10/2012 15:37'!block	^ block! !!PLC_ConnectableBlockPin methodsFor: 'accessing' stamp: 'EricPernia 5/10/2012 15:37'!block: anObject	block := anObject! !!PLC_ConnectableBlockPin methodsFor: 'connection' stamp: 'EricPernia 5/10/2012 17:56'!connected	"Responde true si el pin esta conectado."		^ self connection isNil not.! !!PLC_ConnectableBlockPin methodsFor: 'accessing' stamp: 'EricPernia 5/10/2012 15:05'!connection	^ connection! !!PLC_ConnectableBlockPin methodsFor: 'accessing' stamp: 'EricPernia 5/10/2012 15:05'!connection: anObject	connection := anObject! !!PLC_ConnectableBlockPin methodsFor: 'connection' stamp: 'EricPernia 4/17/2015 00:36'!connectionToAddElement: aPLC_ElemenMorph	"Devuelve la conexion para aadirle un nuevo elemento.	El pin le pasa la responsabilidad a su bloque conectable."	^ self block connectionToAddElement: aPLC_ElemenMorph.! !!PLC_ConnectableBlockPin methodsFor: 'connection' stamp: 'EricPernia 5/10/2012 18:04'!disconnect	"Desconecta al pin que le envio este mensaje."	| connect |		(self connected)		ifTrue: [			self connection disconnect.			]! !!PLC_ConnectableBlockPin methodsFor: 'connection' stamp: 'EricPernia 5/10/2012 18:08'!disconnectPin	"Borra la conexion del pin."	self connection: nil.! !!PLC_ConnectableBlockPin methodsFor: 'connection' stamp: 'EricPernia 5/10/2012 17:56'!disconnected	"Responde true si el pin esta desconectado."		^ self connection isNil.! !!PLC_ConnectableBlockPin methodsFor: 'test' stamp: 'EricPernia 4/22/2015 03:09'!isConnectableBlock	"Responde true si es un bloque conectable"	^ false.! !!PLC_ConnectableBlockPin methodsFor: 'test' stamp: 'EricPernia 4/22/2015 03:09'!isConnection	"Devuelve true si es una instancia de la clase PLC_ConnectableBlockConnection"	^ false.! !!PLC_ConnectableBlockPin methodsFor: 'test' stamp: 'EricPernia 5/10/2012 15:53'!isInputPin	"Responde true si es un pin de entrada"	^ false.! !!PLC_ConnectableBlockPin methodsFor: 'test' stamp: 'EricPernia 5/10/2012 15:53'!isOutputPin	"Responde true si es un pin de salida"	^ false.! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 5/2/2015 01:12'!addBlock:  aConnectableBlock	"Aade un bloque conectable a la red de bloques conectables"	"Aade un bloque conectable a la Ordered Collection blocks"	self blocks add:  aConnectableBlock.		"Le asocia al bloque quien es su red de bloques conectables"		aConnectableBlock connectableBlocksNetwork: self.	! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 5/29/2012 12:14'!blocks	^ blocks! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 5/29/2012 12:14'!blocks: anObject	blocks := anObject! !!PLC_ConnectableBlocksNetwork methodsFor: 'called POUs' stamp: 'EricPernia 11/19/2013 04:41'!calledStandardFunctionBlocks	"Retorna una coleccion de declaraciones de Bloques de Funcion estandar."	| collection collectionChild |	"En collection estan las declaraciones de los bloques de funcion usados en la network"	collection := self standardFunctionBlockConnectableBlocks collect: [ : each | each element declaration ].		collectionChild := collection.		"En collectionChild estan las declaraciones que puedan tener a su vez en su cuerpo estas declaraciones"	collectionChild do:  [ :each |		(each pouBody calledPOUs) 			ifNotNil: [ 				collection add: 					each pouBody calledPOUs 				] 		].	^ collection! !!PLC_ConnectableBlocksNetwork methodsFor: 'called POUs' stamp: 'EricPernia 11/15/2013 16:18'!calledStandardFunctions	"Retorna una coleccion de declaraciones de Funciones estandar."	^ self standardFunctionConnectableBlocks collect: [ : each | each element declaration ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'called POUs' stamp: 'EricPernia 11/15/2013 16:19'!calledUserFunctionBlocks	"Retorna una coleccion de declaraciones de Bloques Funcion definidos por el usuario."	^ self userFunctionBlockConnectableBlocks collect: [ : each | each element declaration ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'called POUs' stamp: 'EricPernia 11/15/2013 16:18'!calledUserFunctions	"Retorna una coleccion de declaraciones de Funciones definidas por el usuario."	^ self userFunctionConnectableBlocks collect: [ : each | each element declaration ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'commands add-remove Elements' stamp: 'CarlosLombardi 11/19/2016 18:26'!changeActualArgumentFor: aPLC_ConnectableBlock by: aString	"Cambia el Actual Argument. "	"HACER: 		1 - le pase el string a su pou para que lo convierta en un objeto operando ( PARSEO )		| operand |		Devuelve un objeto que puede ser operando: variable, item de estructura, literal, o void;	o devolver nil si el string es cualquier otra cosa.		operand := self pouBody pou convertStringToOperand: aString		2a - Si es operando, le pido al elemento actual argument del bc que le llega como parametro	que cheque si le cabe que le asignen el operando. 	Este operando seguro entiende dataType y dataValue. 	Si es variable o item de estructura adems se puede buscar su declaracin 		Si le cabe se pone el flag de 'valorInvalido' a False en el actual argument 		Si no le cabe se pone el flag de 'valorInvalido' a True en el actual argument 			Siempre se lo asigna (cambia el texto auque se ingrese cualquier verdura), 			con el flag se determina si se dibuja en rojo o negro para indicar que se 			va a poder compilar o no.		2b - Si es nil le guarda un operando void al elemento actual argument.						LO DE ABAJO ES UN PARCHE PARA QUE SIGA ANDANDO, DESPUES HAY QUE SACAR TODO....	"			| argument cleanString |		cleanString := aString trimmed .		"si el String es vaco, lo que hay que hacer es volver al valor original"	cleanString ifEmpty: [ 		aPLC_ConnectableBlock element restoreOriginalArgument.		^true.	] .		"UPDATE 22/09/2016 - nuevo parser ms bonito, que usa PetitParser."	argument := self parse: cleanString.						"new, october 2016 - operand check that can result in a different operand, or an error operand"	argument := aPLC_ConnectableBlock element check: argument in: aPLC_ConnectableBlock.	argument isError ifTrue: [ 		"Aviso en pantalla que no encontre la variable. 		 ESTA MUY MAL ACA ESTO, DEBERIA HACERLO LA VISTA"		GrowlMorph openWithLabel: 'Error' contents: argument errorText .			] .	"Cambia el argumento actual"	aPLC_ConnectableBlock element actualArgument: argument.	"este true quiere decir 'si, cambie' para que se refresque la vista.	 Se puede evaluar que devuelva false si no cambio nada, por eficiencia"	^ true.! !!PLC_ConnectableBlocksNetwork methodsFor: 'commands for checks' stamp: 'EricPernia 9/14/2013 16:15'!checkActualArgumentReader	"comment stating purpose of message"		"HACERRRRRRRRRRRR"		self pouBody.! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 01:45'!controller	^ self networkController! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/15/2013 16:18'!functionBlockConnectableBlocks	"Retorna una coleccion de bloques conectables cuyo elemento sea un llamado grafico a Bloque de Funcion."	^ self blocks select: [ : each | each element isFunctionBlock ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/15/2013 16:18'!functionConnectableBlocks	"Retorna una coleccion de bloques conectables cuyo elemento sea un llamado grafico a Funcion."	^ self blocks select: [ : each | each element isFunction ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'initialize-release' stamp: 'EricPernia 11/5/2013 12:52'!initialize	"Inicializacion de la Network de Bloques Conectables"		"creo la OC de bloques"	self blocks: OrderedCollection new.	! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 10/9/2012 20:55'!inputBlocks	"Retorna una coleccion de bloques conectables de entrada.	Estos son los que no tienen entradas."	^ self blocks select: [ : each | each isInputBlock ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'checks' stamp: 'EricPernia 11/10/2012 06:01'!moreWiredInputFor: aConnectableBlock	"Devuelve la mayor entrada cableada (conectada a algo que no sea Actual Argument Reader) buscando desde la primera hasta anInputNumber - 1."	| maxInput |		maxInput := 1.	( 1 to: aConnectableBlock element inputs size ) do: [ :each |		( self blockConnectedToInput: each) isActualArgumentReader not			ifTrue: [				maxInput := each.				]. 		].			^ maxInput.! !!PLC_ConnectableBlocksNetwork methodsFor: 'checks' stamp: 'EricPernia 11/10/2012 06:46'!moreWiredInputFor: aConnectableBlock until: anInputNumber	"Devuelve la mayor entrada cableada (conectada a algo que no sea Actual Argument Reader) buscando desde la primera hasta anInputNumber - 1."	| maxInput |		maxInput := 1.	( 1 to: anInputNumber - 1) do: [ :each |		( aConnectableBlock blockConnectedToInput: each) element isActualArgumentReader not			ifTrue: [				maxInput := each.				]. 		].			^ maxInput.! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 5/29/2012 12:14'!networkController	^ networkController! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 5/29/2012 12:14'!networkController: anObject	networkController := anObject! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 10/9/2012 20:57'!networkLabel	^ networkLabel! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 10/9/2012 20:57'!networkLabel: anObject	networkLabel := anObject! !!PLC_ConnectableBlocksNetwork methodsFor: 'PARSER' stamp: 'CarlosLombardi 10/2/2016 20:09'!oldParse: aString	"PARSEO LO QUE LLEGUE ASI BUSCO LA VARIABLE CORRECTA"	"aString Parseado pedorramente - Es true, false o numero 	(entero o time)"		| pouDecls decl  argument |		pouDecls := self pouBody pou declarations.			decl := pouDecls varDeclWithIdentifierOrNIl: aString.		decl 		ifNil: [			"No encontro declaracion. Chequeo si puedo convertir aString 			a un literal, sino creo una nueva variable de la galera con ese			identifier."						"Parseo de Literales barato"							"Pruebo si el string es TRUE"				( aString asLowercase = 'true' )				ifTrue: [					"Si era true creo un Literal true"					argument := ( PLC_Literal 						newWithDataType: PLC_DataType Bool						andDataValue: true	).				]				ifFalse: [					"Pruebo si el string es FALSE"					( aString asLowercase = 'false' )						ifTrue: [ 							"Si era false creo un Literal false"							argument := ( PLC_Literal 								newWithDataType: PLC_DataType Bool								andDataValue: false ).						]						ifFalse: [ 							"Pruebo si es numerico ENTERO"							aString isAllDigits								ifTrue: [ 									"Si era numero creo un Literal INT"									argument := ( PLC_Literal 										newWithDataType: PLC_DataType Int										andDataValue: aString asNumber ).								]								ifFalse: [									"Chequea si empieza con T# o TIME# para parsear el numero como TIME"									( ( aString asUppercase beginsWith: 'T#' ) or: 									[ aString asUppercase beginsWith: 'TIME#'  ] )										ifTrue: [ 											"Si era numero creo un Literal TIME"											argument := ( PLC_Literal 												newWithDataType: PLC_DataType Time												andDataValue: aString extractNumber ).										] 										ifFalse: [ 											"NO PUDE PARSEARLO" 																						"INVENTO UNA DECLARACION DE VARIABLE"											"varDecl := PLC_SymbolicVariableDecl 												newWithDataType: PLC_DataType Void												andInitialValue: nil 												andIdentifier: aString."																			"Creo el Operando Variable a partir de la Declaracin de Variable"											"argument := PLC_Variable 												newWithDeclaration: varDecl 												andDataValue: nil."											"Creo un VoidOperand"												argument := PLC_ErrorOperand new.											argument dataValue: aString.																						"Aviso en pantalla que no encontre la variable. 											ESTA MUY MAL ACA ESTO, DEBERIA HACERLO 											LA VISTA"											GrowlMorph 												openWithLabel: 'Error' 												contents: 'Variable no encontrada entre las declaraciones o valor invlido'.																					].								]. 						]. 				].		]		ifNotNil: [			"Encontro declaracion, creo un nuevo Operando variable 			con la declaracin hallada"			argument := PLC_Variable 				newWithDeclaration: decl 				andDataValue: decl initialValue.		].			^ argument.! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 10/9/2012 20:55'!outputBlocks	"Retorna una coleccion de bloques conectables de salida.	Estos son los que no tienen salidas."	^ self blocks select: [ : each | each isOutputBlock ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'PARSER' stamp: 'CarlosLombardi 10/14/2016 20:56'!parse: aString	"parse an operand into a PLC_Literal or PLC_Variable.	 If aString is an invalid operand, then a PLC_ErrorOpenad is returned. 	 In this case, an error message is also shown (shame!! for not delegating the message display to GUI components). "		| pouDecls variableParser operandParser result errorText |		pouDecls := self pouBody pou declarations.		variableParser := IDE4PLCParsers idParser ==> [ :idString |		| decl |		decl := pouDecls varDeclWithIdentifierOrNIl: aString.		decl ifNil: [				PLC_ErrorOperand new dataValue: idString ; yourself			] ifNotNil: [ 				"A declaration is found, I create a new Variable operand for the found declaration"				PLC_Variable 					newWithDeclaration: decl 					andDataValue: decl initialValue.			]	] .		operandParser := 		IDE4PLCParsers literalBOOLParser /			IDE4PLCParsers unspecifiedIntegerParser /		IDE4PLCParsers literalREALParser /		IDE4PLCParsers literalINTParser /		IDE4PLCParsers literalTIMEParser /		variableParser .		result := operandParser parse: aString.		errorText := nil .	result isPetitFailure ifTrue: [ 		"lexing error, I give different message but return similar error operand"			result := PLC_ErrorOperand new 			dataValue: aString ; 			errorText: 'Valor invlido' ;			yourself .	] ifFalse: [ 		"lexing OK, unknown identifier"			result isError ifTrue: [ 			result errorText: 'Variable no encontrada entre las declaraciones'.		] .	] .		^result! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 9/14/2013 16:15'!pouBody	^ pouBody! !!PLC_ConnectableBlocksNetwork methodsFor: 'accessing' stamp: 'EricPernia 9/14/2013 16:15'!pouBody: anObject	pouBody := anObject! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 5/2/2015 01:12'!removeBlock:  aConnectableBlock	"Remueve un bloque conectable de la red de bloques conectables"	"Le borra al bloque conectable su red de bloques conectables"		aConnectableBlock connectableBlocksNetwork: nil.	"Remueve el bloque conectable de la Ordered Collection blocks"	self blocks remove: aConnectableBlock.	! !!PLC_ConnectableBlocksNetwork methodsFor: 'commands add-remove Elements' stamp: 'CL 11/18/2013 02:21'!removeContact: aPLC_ConnectableBlockContact	"Remueve un Contacto."	| connectableBlockActualArgumentReader connectableBlockOutputPin connectableBlockInputPin |	"Busco los pines de los bloques conectables conectados a la primer entrada y salida de la bobina"		connectableBlockOutputPin := ( aPLC_ConnectableBlockContact connectedAtInput: 1) outputPin.	connectableBlockInputPin := ( aPLC_ConnectableBlockContact connectedAtOutput: 1) inputPin.		"Busco el Actual Argument  Writer de la bobina"		connectableBlockActualArgumentReader := aPLC_ConnectableBlockContact blockConnectedToInput: 2.		"Desconecto el Actual Argument  Writer de la bobina"	( connectableBlockActualArgumentReader connectedAtOutput: 1 ) disconnect.		"Desconecto la bobina"	( aPLC_ConnectableBlockContact connectedAtInput: 1) disconnect.	( aPLC_ConnectableBlockContact connectedAtOutput: 1) disconnect.		"Remuevo los bloques conectables de la Network de bloques conectables"	self removeBlock: aPLC_ConnectableBlockContact.	self removeBlock: connectableBlockActualArgumentReader.		"Conecto los pines obtenidos y realizo los chequeos pertinentes a LPR y VL"	^ self checkShortCircuitIfConnect: connectableBlockOutputPin To: connectableBlockInputPin.! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/15/2013 16:18'!standardFunctionBlockConnectableBlocks	"Retorna una coleccion de bloques conectables cuyo elemento sea un llamado grafico a Bloque de Funcion estandar."	^ self functionBlockConnectableBlocks select: [ : each | ( each element declaration isUserDefined ) not ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/15/2013 16:18'!standardFunctionConnectableBlocks	"Retorna una coleccion de bloques conectables cuyo elemento sea un llamado grafico a Funcion estandar."	^ self functionConnectableBlocks select: [ : each | ( each element declaration isUserDefined ) not ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/15/2013 16:18'!userFunctionBlockConnectableBlocks	"Retorna una coleccion de bloques conectables cuyo elemento sea un 	llamado grafico a Bloque de Funcion definida por el usuario."	^ self functionBlockConnectableBlocks select: [ : each | each element declaration isUserDefined ].! !!PLC_ConnectableBlocksNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/15/2013 16:18'!userFunctionConnectableBlocks	"Retorna una coleccion de bloques conectables cuyo elemento sea un 	llamado grafico a Funcion definida por el usuario."	^ self functionConnectableBlocks select: [ : each | each element declaration isUserDefined ].! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'CarlosLombardi 11/19/2016 18:01'!addCoil: aPLC_ElementCoil onConnection: aPLC_Connection	"Crea y aade una Bobina."	| connectableBlockActualArgumentWriter connectableBlockCoil |	"Creo los Bloques Conectables"		connectableBlockCoil := PLC_ConnectableBlock newWithElement: aPLC_ElementCoil.	connectableBlockActualArgumentWriter := 			PLC_ConnectableBlock newWithElement: PLC_Element ActualRequiredArgumentWriter.	"Conecto los 2 bloques conectables que forman el Elemento. 	Esta conexion no est representada por ningun Morph."	connectableBlockCoil output: 2 connectTo: connectableBlockActualArgumentWriter input: 1.		"Agrego los Bloques Conectables a la Network de Bloques Conectables"	self addBlock: connectableBlockCoil.	self addBlock: connectableBlockActualArgumentWriter.			connectableBlockCoil connectableBlocksNetwork == connectableBlockActualArgumentWriter connectableBlocksNetwork.		"Conecto el nuevo elemento a los Bloques Conectables entre los cuales estaba la conexion donde agrego el nuevo elemento."	aPLC_Connection replaceConnectionByConnectingToInputPin: connectableBlockCoil inputs first andOutputPin:  connectableBlockCoil outputs first.			^ connectableBlockCoil.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'CarlosLombardi 11/19/2016 17:20'!addContact: aPLC_ElementContact onConnection: aPLC_Connection	"Crea y aade un Contacto."	| connectableBlockActualArgumentReader connectableBlockContact |	"Creo los Bloques Conectables"		connectableBlockContact := PLC_ConnectableBlock newWithElement: aPLC_ElementContact.	connectableBlockActualArgumentReader := 		PLC_ConnectableBlock newWithElement: PLC_Element ActualRequiredArgumentReader.	"Conecto los 2 bloques conectables que forman el Elemento. 	Esta conexion no est representada por ningun Morph."	connectableBlockActualArgumentReader output: 1 connectTo: connectableBlockContact input: 2.		"Agrego los Bloques Conectables a la Network de Bloques Conectables"	self addBlock: connectableBlockContact.	self addBlock: connectableBlockActualArgumentReader.			"Conecto el nuevo elemento a los Bloques Conectables entre los cuales estaba la conexion donde agrego el nuevo elemento."	aPLC_Connection replaceConnectionByConnectingToInputPin: (connectableBlockContact inputPinAt: 1) andOutputPin:  (connectableBlockContact outputPinAt: 1).		^ connectableBlockContact.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 11/29/2016 20:20'!addFunctionBlockCall: aPLC_Element onConnection: aPLC_Connection	"Crea y aade un Llamado a Instancia de Bloque de Funcin."	| connectableBlockActualArgumentReader connectableBlockActualArgumentWriter connectableBlockFunction |	"Creo el Bloque Conectables del Bloque de Funcin"		connectableBlockFunction := PLC_ConnectableBlock newWithElement: aPLC_Element.	"Agrego el Bloque Conectable del LLamado a Funcin a la Network de Bloques Conectables"	self addBlock: connectableBlockFunction.		"Creo y conecto los bloques conectables de los Acrual Argument Reader	de sus salidas y entrada-salidas y agrego los Actual Argument Reader a	la Network de Bloques Conectables.	el primero es el cable: no lleva operando.	el ultimo es la instancia: no es requerido porque no se asigna, y por el momento	(29/11/2016) no es necesario asignarlo.	OJO!!!! para funciones no se agrega el ultimo input correspondiente a la instancia,	por eso no se hace esta salvedad de que el argumento del ultimo input no sea requerido"	(2 to: aPLC_Element inputs size) do: [ :index | | newArgument |		"aca se maneja que el ultimo input no es requerido, el resto si"		newArgument := (index = aPLC_Element inputs size)			ifTrue: [ PLC_Element ActualArgumentReader ]			ifFalse: [ PLC_Element ActualRequiredArgumentReader ].		connectableBlockActualArgumentReader := PLC_ConnectableBlock newWithElement: newArgument.		connectableBlockActualArgumentReader 			output: 1 			connectTo: connectableBlockFunction 			input: index.			self addBlock: connectableBlockActualArgumentReader.		].		"Creo y conecto los bloques conectables de los Acrual Argument Writer 	de sus salidas y entrada-salidas y agrego los Actual Argument Writer a	la Network de Bloques Conectables.	primer y ultimo outputs: va la misma explicacion que para los inputs.	Como ningun output es requerido, para los output no es necesario tratar	en forma separada el ultimo "	(2 to: aPLC_Element outputs size) do: [ :index |		connectableBlockActualArgumentWriter := PLC_ConnectableBlock 			newWithElement: PLC_Element ActualArgumentWriter.		connectableBlockFunction 			output: index 			connectTo: connectableBlockActualArgumentWriter 			input: 1.			self addBlock: connectableBlockActualArgumentWriter.			].		"Conecto el nuevo elemento a los Bloques Conectables entre los 	cuales estaba la conexion donde agrego el nuevo elemento."	aPLC_Connection 		replaceConnectionByConnectingToInputPin: connectableBlockFunction inputs first 		andOutputPin: connectableBlockFunction outputs first.		^ connectableBlockFunction.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'CarlosLombardi 11/19/2016 18:04'!addFunctionCall: aPLC_Element onConnection: aPLC_Connection	"Crea y aade un Llamado a Funcin."	| connectableBlockActualArgumentReader connectableBlockActualArgumentWriter connectableBlockFunction |	"Creo el Bloques Conectables de la Funcin"		connectableBlockFunction := PLC_ConnectableBlock newWithElement: aPLC_Element.	"Agrego el Bloque Conectable del LLamado a Funcin a la Network de Bloques Conectables"	self addBlock: connectableBlockFunction.		"Creo y conecto los bloques conectables de los Acrual Argument Reader	de sus salidas y entrada-salidas y agrego los Actual Argument Reader a	la Network de Bloques Conectables."	(2 to: aPLC_Element inputs size ) do: [ :index |		connectableBlockActualArgumentReader := PLC_ConnectableBlock 			newWithElement: PLC_Element ActualRequiredArgumentReader.		connectableBlockActualArgumentReader 			output: 1 			connectTo: connectableBlockFunction 			input: index.			self addBlock: connectableBlockActualArgumentReader.		].		"Creo y conecto los bloques conectables de los Acrual Argument Writer 	de sus salidas y entrada-salidas y agrego los Actual Argument Writer a	la Network de Bloques Conectables."	(2 to: aPLC_Element outputs size ) do: [ :index |		connectableBlockActualArgumentWriter := PLC_ConnectableBlock 			newWithElement: PLC_Element ActualArgumentWriter.		connectableBlockFunction 			output: index 			connectTo: connectableBlockActualArgumentWriter 			input: 1.			self addBlock: connectableBlockActualArgumentWriter.			].		"Conecto el nuevo elemento a los Bloques Conectables entre los 	cuales estaba la conexion donde agrego el nuevo elemento."	aPLC_Connection 		replaceConnectionByConnectingToInputPin: connectableBlockFunction inputs first 		andOutputPin: connectableBlockFunction outputs first.		^ connectableBlockFunction.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 5/3/2015 06:40'!addLadderComponent: aPLC_ElementContactOrCoil onConnection: aPLC_Connection	"Crea y aade un Contacto o Bobina."		( aPLC_ElementContactOrCoil isContact )		ifTrue: [			^ self addContact: aPLC_ElementContactOrCoil onConnection: aPLC_Connection.		]		ifFalse:  [			^ self addCoil: aPLC_ElementContactOrCoil onConnection: aPLC_Connection.		].		! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 11/5/2013 12:51'!addLeftPowerRail	"Crea y aade el Riel de Potencia Izquiedo. Solo debe existir uno por Network."	| connectableBlockLeftPowerRail |	"Creo el Bloque Conectable"		connectableBlockLeftPowerRail := PLC_ConnectableBlock newWithElement: PLC_Element LeftPowerRail.	"Agrego el Bloque Conectable a la Network de Bloques Conectables"	self addBlock: connectableBlockLeftPowerRail.	 "Le agrego el primer pin de salida"	connectableBlockLeftPowerRail addOutput.		^ connectableBlockLeftPowerRail.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 11/5/2013 12:51'!addRightPowerRailConnectedTo: aPLC_ConnectableBlock output: anOutputNumber	"Crea y aade un Riel Derecho y lo conecta a la salida numero anOutputNumber 	del Bloque Conectable aPLC_ConnectableBlock."	| connectableBlockRightPowerRail |	"Creo el Bloque Conectable"		connectableBlockRightPowerRail := PLC_ConnectableBlock newWithElement: PLC_Element RightPowerRail.	"Agrego el Bloque Conectable a la Network de Bloques Conectables"	self addBlock: connectableBlockRightPowerRail.		"Conecto el Bloque Conectable en la Network de Bloques Conectables."		aPLC_ConnectableBlock output: anOutputNumber connectTo: connectableBlockRightPowerRail input: 1.		^ connectableBlockRightPowerRail.! !!PLC_LadderNetwork methodsFor: 'checks' stamp: 'EricPernia 11/5/2013 12:51'!checkIfFunctionAreInAParallelBranch: aPLC_ConnectableBlockF	"Chequeo si se encuentra en una rama paralela"	| connectableBlockOutputPinNumber lprOrVl |			lprOrVl := aPLC_ConnectableBlockF.		"Busco a travs de la Funcion hacia su entrada hasta encontrar un elemento que sea un Vertical Link o	Left Power Rail  y tambin guardo por cual nmero de pin de salida llego."	[ lprOrVl element isVerticalLink or: [  lprOrVl element isLeftPowerRail ] ]		whileFalse: 			[ connectableBlockOutputPinNumber := lprOrVl outputPinNumberConnectedToInput: 1.			lprOrVl := lprOrVl blockConnectedToInput: 1. ].		^ lprOrVl element isVerticalLink and: [ connectableBlockOutputPinNumber > 1 ].! !!PLC_LadderNetwork methodsFor: 'checks' stamp: 'EricPernia 5/7/2015 18:11'!checkShortCircuitIfConnect: connectableBlockOutputPin To: connectableBlockInputPin	"Chequeo que no se forme un cortocircuito si conecto connectableBlockOutputPin 	con connectableBlockInputPin. Si no hay problema los conecto. Si se forma un corto	Borro los pines de los VL o LPR que lo forman y no conecto los pines. Cuando Borro 	pines debo ver que queden VL o LPR validos.		AGREGAR CHEQUEO DE QUE NO HAYA SOLO BOBINAS O BLOQUES EN LAS RAMAS SERIES DE LA RAMA PARALELA 	EN BOBINA Y BLOQUE		Evita el caso al eliminar un contacto por ejejmplo:		          	c1	  			   	             	c1 			      NO PUEDE QUEDAR ASI 	-----+-----|  |----+-----		 -----+-----|  |-----+-----	DEBE REEMPLAZAR LOS 2 	     |	      c2	    |		  ==>	      |		         |		VL POR HORIZONTAL LINKS	     +-----|  |----+		            +--------------+														"	| connectableBlockInput connectableBlockOutput  	 VLorLPRinput VLOutput 	 adequateInputPin locationForNewOutputPin outputToDisappear newOutputPin inputPinToConnect   	 adequateOutputPin locationForNewInputPin inputToDisappear newInputPin outputPinToConnect | 		connectableBlockInput := connectableBlockOutputPin block.	connectableBlockOutput := connectableBlockInputPin block.		VLorLPRinput := connectableBlockInput.	VLOutput := connectableBlockOutput.			adequateInputPin := connectableBlockInputPin.		"Si da true entonces se formaria un cortocircuito y hay que evitarlo"		connectableBlockOutput element isVerticalLink		ifTrue: [			connectableBlockInput element isLeftPowerRail				ifTrue: [															"Chequeo si el VL no tiene pines de entrada. Si esto es asi el LPR debe 'absorver' al VLOutput										Ejemplo:															| p1	     p2    p3			|								|-----|  |-----+----			|-----   p3							|		         |		 ==>	|							|		         +----			|-----   p4 						|		          p4 			|																	LPR          	VL 		     LPR													"						( VLOutput inputs size = 1 )						ifTrue: [							"Agrego los pines de salida del VLOutput al Left Power Rail."							"VLorLPRinput outputs addAll: VLOutput outputs."								"el input que hay que enchufarle al output es otro, 							  porque el VLOutput va a desaparecer"							adequateInputPin := (VLOutput outputPinAt: 1) connection inputPin.							adequateInputPin disconnect.							"reconecto cada uno de los conectados con el VLOutput a nuevos pines en el LPRinput"							locationForNewOutputPin := connectableBlockOutputPin.							(2 to: VLOutput outputs size) do: [ :n |								outputToDisappear := (VLOutput outputPinAt: n).								VLorLPRinput addOutputPinAfter: locationForNewOutputPin.								newOutputPin := VLorLPRinput outputPinAfter: locationForNewOutputPin.								VLorLPRinput element addOutput.   "no se para que es esto!!!!"								inputPinToConnect := outputToDisappear connection inputPin.								inputPinToConnect disconnect.								newOutputPin connectTo: inputPinToConnect.								locationForNewOutputPin := newOutputPin.							 ].							"version de Eric"							"outputPin := connectableBlockOutputPin.							VLOutput outputs do: [ :each | 								each block: VLorLPRinput.								VLorLPRinput addOutputPin: each after: outputPin.								outputPin := each.																							]."							"Remuevo el VLOutput de la network de bloques conectables."							self removeBlock: VLOutput.										"esto lo repito porque hay un return abajo que no entiendo, pero que dejo por las dudas. Ufa."							connectableBlockOutputPin connectTo: adequateInputPin.						] 						ifFalse: [ 							"Remuevo la salida del elemento del VL o LPR - NO ANDABA ANTES PORQUE NO HACIA ESTO"							VLOutput element inputs removeAt: ( VLOutput inputs indexOf: connectableBlockInputPin ).							"Remuevo el pin obtenido del Bloque Conectable LPR o VL"							VLOutput inputs remove: connectableBlockInputPin.							"Remuevo la salida del elemento del VL o LPR - NO ANDABA ANTES PORQUE NO HACIA ESTO"							VLorLPRinput element outputs removeAt: ( VLorLPRinput outputs indexOf: connectableBlockOutputPin ).							"Remuevo el pin obtenido del Bloque Conectable LPR o VL"							VLorLPRinput outputs remove: connectableBlockOutputPin.												].											].							VLorLPRinput element isVerticalLink				ifTrue: [										"Chequeo si el VLorLPRinput tiene un solo pin de salida. Si esto es asi debe 'absorver' al VLOutput											Ejemplo 1:												       Ejemplo 2:									    p5        p6	 								                 p5       p6					p1 ---+----|  |----+--- p3 			p1 ---+--- p3			p1 ---+----|  |----+--- p4 			p1 ---+--- p4						   |		       |			 ==>		   |						   |		       | 			==>		      |					p2 ---+		       +--- p4			p2 ---+--- p4			p2 ---+		       |					p2 ---+																						                      |						   |						  VL1        	VL2 				    	VL1							        p3---+ 				   p3 ---+																			             	VL1 	        VL2 					    VL1					p = Pin "																( VLOutput inputs size = 1 )						ifTrue: [							" esto es lo mismo - lo mismo que esta en el caso 							  VLOutput isVerticalLink -- VLorLPRinput isLeftPowerRail - VLorLPRinput output size = 1.							  Refactorizar si este proyecto sigue vivo."							"el input que hay que enchufarle al output es otro, 							  porque el VLOutput va a desaparecer"							adequateInputPin := VLOutput outputs first connection inputPin.							adequateInputPin disconnect.							"reconecto cada uno de los conectados con el VLOutput a nuevos pines en el LPRinput"							locationForNewOutputPin := connectableBlockOutputPin.							(2 to: VLOutput outputs size) do: [ :n |								outputToDisappear := VLOutput outputs at: n.								VLorLPRinput addOutputPinAfter: locationForNewOutputPin.								VLorLPRinput element addOutput.   "no se para que es esto!!!!"								newOutputPin := VLorLPRinput outputPinAfter: locationForNewOutputPin.								inputPinToConnect := outputToDisappear connection inputPin.								inputPinToConnect disconnect.								newOutputPin connectTo: inputPinToConnect.								locationForNewOutputPin := newOutputPin.							 ].							"aca se termina la parte copiada de otro caso "							"version de Eric"							"Agrego los pines de entrada y salida del VLOutput al VLorLPRinput"							"VLorLPRinput inputs addAll: VLOutput inputs.							VLorLPRinput outputs addAll: VLOutput outputs."																		"Remuevo el VLOutput de la network de bloques conectables."							self removeBlock: VLOutput.												"esto lo repito porque hay un return abajo que no entiendo, pero que dejo por las dudas. Ufa."							connectableBlockOutputPin connectTo: adequateInputPin.						]						ifFalse: [ 											( VLorLPRinput outputs size = 1 )							ifTrue: [  								" esto es dual a los casos con codigo repetido, cambiando input por output.								  Refactorizar si este proyecto sigue vivo."								"el output que hay que enchufarle al input es otro, 								  porque el VLorLPRinput va a desaparecer"								adequateOutputPin := VLorLPRinput inputs first connection outputPin.								adequateOutputPin disconnect.								"reconecto cada uno de los conectados con el VLOutput a nuevos pines en el LPRinput"								locationForNewInputPin := connectableBlockInputPin.								(2 to: VLorLPRinput inputs size) do: [ :n |									inputToDisappear := VLorLPRinput inputs at: n.									VLOutput addInputPinAfter: locationForNewInputPin.									VLOutput element addInput.   "no se para que es esto!!!!"									newInputPin := VLOutput inputPinAfter: locationForNewInputPin.									outputPinToConnect := inputToDisappear connection outputPin.									outputPinToConnect disconnect.									newInputPin connectTo: outputPinToConnect.									locationForNewInputPin := newInputPin.								 ].								"aca se termina la parte copiada de otro caso "																			"Remuevo el VLOutput de la network de bloques conectables."								self removeBlock: VLorLPRinput.								"esto lo repito porque hay un return abajo que no entiendo, pero que dejo por las dudas. Ufa."								adequateOutputPin connectTo: connectableBlockInputPin.							]							ifFalse: [ 								"Remuevo la salida del elemento del VL o LPR - NO ANDABA ANTES PORQUE NO HACIA ESTO"								VLOutput element inputs removeAt: ( VLOutput inputs indexOf: connectableBlockInputPin ).								"Remuevo el pin obtenido del Bloque Conectable LPR o VL"								VLOutput inputs remove: connectableBlockInputPin.								"Remuevo la salida del elemento del VL o LPR - NO ANDABA ANTES PORQUE NO HACIA ESTO"								VLorLPRinput element outputs removeAt: ( VLorLPRinput outputs indexOf: connectableBlockOutputPin ).								"Remuevo el pin obtenido del Bloque Conectable LPR o VL"								VLorLPRinput outputs remove: connectableBlockOutputPin.							 ]						].											"Chequeo si el aConnectableBlockVL tiene una sola entrada y una sola salida.					Si esto es asi entonces lo reemplazo por un Horizontal Link."								self checkValidVerticalLink: VLorLPRinput.						]				ifFalse:[					"Si entro aca entonces connectableBlockInput no es ni VL ni LPR, entonces 					simplemente conecta, no tiene que absorber nada"										"Conecto los pines que obtuve al principio para cerrar el circuito y retorno la nueva conexion"					^ connectableBlockOutputPin connectTo: adequateInputPin.										].							"Chequeo si el aConnectableBlockVL tiene una sola entrada y una sola salida.			Si esto es asi entonces lo reemplazo por un Horizontal Link."						^ self checkValidVerticalLink: VLOutput.						].				"Conecto los pines que obtuve al principio para cerrar el circuito y retorno la nueva conexion"	^ connectableBlockOutputPin connectTo: adequateInputPin.! !!PLC_LadderNetwork methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 12:51'!checkValidRightPowerRailConnections	"Cheuquea que los RPR no esten conectados a contactos o VL si esto es as devuelve true."	"LO PARCHIE"		^ true.	"^ self rightRailsBlocks allSatisfy: [:each | 		((each blockConnectedToInput: 1) isContact or: [ (each blockConnectedToInput: 1) isVerticalLink ]) not.		]	"! !!PLC_LadderNetwork methodsFor: 'checks' stamp: 'EricPernia 11/5/2013 12:51'!checkValidVerticalLink: aConnectableBlockVL	"Chequeo si el aConnectableBlockVL tiene una sola entrada y una sola salida.	Si esto es asi entonces lo reemplazo por un Horizontal Link.						Ejemplo, Borro c1:						|	 c1					|							 c2	|------|   |----+-->>		|-		  -+-->>			|------|   |------->>		|	 c2     |		==>	|	 c2	    |		==>	|------|   |----+				|------|   |----+	|						|						"						| connectableBlockOutputPin connectableBlockInputPin |						( aConnectableBlockVL inputs size = 1 and: [ aConnectableBlockVL outputs size = 1 ] )		ifTrue: [			"Busco los pines conectados a entrada y salida del VL"			connectableBlockOutputPin := ( aConnectableBlockVL connectedAtInput: 1) outputPin.			connectableBlockInputPin := ( aConnectableBlockVL connectedAtOutput: 1) inputPin. 						"Desconecto los pines obtenidos"			connectableBlockOutputPin disconnect.			connectableBlockInputPin disconnect.						"Remuevo el bloque conectable VL de la Network de bloques conectables"			self removeBlock: aConnectableBlockVL.								"Conecto los pines que obtuve y retorno dicha conexion."			^ connectableBlockOutputPin connectTo: connectableBlockInputPin.					]		ifFalse: [			^ aConnectableBlockVL.			]! !!PLC_LadderNetwork methodsFor: 'commands copen-close Branch' stamp: 'EricPernia 11/5/2013 12:52'!closeBranchFrom: aPLC_ConnectableBlockOrConnection to: aPLC_Connection	"Cierra una rama si se puede."		( aPLC_ConnectableBlockOrConnection isConnectableBlock )		ifTrue: [			( aPLC_ConnectableBlockOrConnection element isRightPowerRail and: [ aPLC_Connection isConnection ] )				ifTrue: [					^ self closeBranchFromRPR: aPLC_ConnectableBlockOrConnection toHL: aPLC_Connection.				].		].				( aPLC_ConnectableBlockOrConnection isConnection and: [ aPLC_Connection isConnection ] )		ifTrue: [			^ self closeBranchFromHL: aPLC_ConnectableBlockOrConnection toHL: aPLC_Connection.			]			ifFalse: [			^ 'No se puede Cerrar Rama.'.			]! !!PLC_LadderNetwork methodsFor: 'commands copen-close Branch' stamp: 'EricPernia 4/7/2015 03:27'!closeBranchFromHL: aPLC_Connection1 toHL: aPLC_Connection2	"Cierra una Rama desde una Conexion hasta otra conexion, es decir, un Horizontal Link.		---+----|  |-----==-----|  |--------           	 		---+----|  |------+-----|  |----------   	    |		       				 	    ==>		    |		     	  |		   +----|  |-----==-----|  |---->>				  	   +----|  |------+-----|  |---->>		"	| connectableBlock1 connectableBlockOutputPinNumber1 connectableBlock2 connectableBlockOutputPinNumber2 connectableBlockVL  |		" 1 -  Chequeo que los bloques conectables conectados a ambas conexiones no sean LPR o VL.	Si son VL o LPR, entonces no puedo Cerrar la Rama."		"Busco los Bloques Conectables conectados a la entrada y salida de aPLC_Connection1"	connectableBlock1 := aPLC_Connection1 connectedAtInput: 1.	connectableBlock2 := aPLC_Connection1 connectedAtOutput: 1.		"Analizo si son VL o LPR"	( connectableBlock1 element isLeftPowerRail 		or: [ connectableBlock1 element isVerticalLink 			or: [ connectableBlock2 element isLeftPowerRail 				or: [ connectableBlock2 element isVerticalLink ] 				]			 ] )		ifTrue:  [			^ 'No se puede Cerrar Rama.'			].			"Busco los Bloques Conectables conectados a la entrada y salida de aPLC_Connection2"	connectableBlock1 := aPLC_Connection2 connectedAtInput: 1.	connectableBlock2 := aPLC_Connection2 connectedAtOutput: 1.		"Analizo si son VL o LPR"	( connectableBlock1 element isLeftPowerRail 		or: [ connectableBlock1 element isVerticalLink 			or: [ connectableBlock2 element isLeftPowerRail 				or: [ connectableBlock2 element isVerticalLink ] 				]			 ] )		ifTrue:  [			^ 'No se puede Cerrar Rama.'			].			" 2 -   Busco a travs de la Conexion ( == ) aPLC_Connection1  hacia su entrada hasta 	encontrar un elemento que sea un Vertical Link o Left Power Rail y tambin guardo por 	cual nmero de pin de salida llego."	connectableBlock1 := aPLC_Connection1 connectedAtInput: 1.	[ ( connectableBlock1 element isLeftPowerRail or: [ connectableBlock1 element isVerticalLink ] ) ]		whileFalse: 			[ connectableBlockOutputPinNumber1 := connectableBlock1 outputPinNumberConnectedToInput: 1.			connectableBlock1 := connectableBlock1 blockConnectedToInput: 1. ] .			" 3 -   Busco a travs de la Conexion ( == ) aPLC_Connection2 hacia su entrada hasta 	encontrar un elemento que sea un Vertical Link o Left Power Rail y tambin guardo por 	cual nmero de pin de salida llego."	connectableBlock2 := aPLC_Connection2 connectedAtInput: 1.	[ ( connectableBlock2 element isLeftPowerRail or: [ connectableBlock2 element isVerticalLink ] ) ]		whileFalse: 			[ connectableBlockOutputPinNumber2 := connectableBlock2 outputPinNumberConnectedToInput: 1.			connectableBlock2 := connectableBlock2 blockConnectedToInput: 1. ] .	" 4 -  Chequeo si los 2 bloques conectables a los cuales llego recorriendo hacia al entrada de	de la Conexion aPLC_Connection1 y de la Conexion aPLC_Connection2 son el mismo Vertical 	Link o Left Power Rail y tambin que el Numero de Pin al que llego por aPLC_Connection1 	sea mayor en 1 al Numero de Pin al que llego por aPLC_Connection2. Si esto se cumple 	entonces puedo Cerrar la rama creando asi una conexion en Paralelo.					    3 	-----+----|  |------==----|  |------->>		 		 -----+----|  |-------+-------|  |------->>		      |		    2 								 |		      |	     +----|  |------==----|  |------->>		==>		+----|  |-------+-------|  |------->>	      |		    1 								 |	     +----|  |------==----|  |------->>					+----|  |----------------|  |------->>				Puedo Cerrar Rama en los casos:		aPLC_Connection1 = 1 y aPLC_Connection2 = 2		aPLC_Connection1 = 2 y aPLC_Connection2 = 3	"		( connectableBlock1= connectableBlock2 and: [ (connectableBlockOutputPinNumber1 - connectableBlockOutputPinNumber2) = 1 ] )		ifTrue: [						"Si llego a este punto entonces puedo Cerrar la rama creando as una conexion en paralelo.						5 -  Reemplazo ambas conexiones por un nuevo Vertical Link."						"Creo lel Vertical Link y le agrego 2 entradas y 2 salidas."			connectableBlockVL := PLC_ConnectableBlock newWithElement: PLC_Element VerticalLink.			connectableBlockVL 						addOutput;						addOutput;						addInput;						addInput.									"Agrego el Bloque Conectable a la Network de Bloques Conectables"			self addBlock: connectableBlockVL.								"Conecto el Vertical Link donde estaban las conexiones."			aPLC_Connection2 replaceConnectionByConnectingToInputPin: connectableBlockVL inputs first andOutputPin:  connectableBlockVL outputs first.			aPLC_Connection1 replaceConnectionByConnectingToInputPin: connectableBlockVL inputs last andOutputPin:  connectableBlockVL outputs last.						]				ifFalse: [			^ 'No se puede Cerrar Rama.'			].! !!PLC_LadderNetwork methodsFor: 'commands copen-close Branch' stamp: 'EricPernia 11/5/2013 12:52'!closeBranchFromRPR: aPLC_ConnectableBlockRightPowerRail toHL: aPLC_Connection	"Cierra una Rama desde un Riel de Potencia Derecho hacia una conexion, es decir, un Horizontal Link.		|----|  |---------(  )----|            	|----|  |----+----(  )----|        	|					==>	|	       |	|----|  |---->>					|----|  |----+			VER SI HACE FLATA DETECTAR QUE EL RPR NO ESTE CONECTADO A BOBINA		"	| connectableBlock1 connectableBlockOutputPinNumber1 connectableBlock2 connectableBlockOutputPinNumber2 connectableBlockLPRorVL connectableBlockOutputPin |		" 1 -  Chequeo si el primer bloque conectado a la entrada del Right Power Rail ( -->> ) es un Vertical Link	o Left Power Rail, si esto es as entonces no puedo Cerrar la Rama pues genero un cortocircuito.		---+----|  |----==  			     -----+----|  |----+-----      NO SE PUEDE, CORTOCIRCUITO.	    |				   ==>		     |		      |	   +->>						    +-----------+ 		debe haber un elemento entre el VL y el RPR.	( == ) es el Horizontal Link hacia el cual quiero Cerrar la Rama."		"Busco el Bloque Conectable conectado a la entrada 1 del Right Power Rail."	connectableBlock2 := aPLC_ConnectableBlockRightPowerRail blockConnectedToInput: 1.		"Analizo si es un VL o LPR"	( connectableBlock2 element isLeftPowerRail or: [ connectableBlock2 element isVerticalLink ] )		ifTrue: [			^ '1 - No se puede hacer cortocircuitos.'			].			" 2 -  Busco a travs del Right Power Rail ( -->> ) hacia su entrada hasta encontrar un	 elemento que sea un Vertical Link o Left Power Rail y tambin guardo por cual nmero 	de pin de salida llego."	[ ( connectableBlock2 element isLeftPowerRail or: [ connectableBlock2 element isVerticalLink ] ) ]		whileFalse: 			[ connectableBlockOutputPinNumber2 := connectableBlock2 outputPinNumberConnectedToInput: 1.			connectableBlock2 := connectableBlock2 blockConnectedToInput: 1. ] .				" 3 -   Chequeo si el primer bloque conectado a la entrada del Horizontal Link ( == ) es el mismo bloque	que obtuve en 2. Si esto es as entonces no puedo Cerrar la Rama pues genero un cortocircuito.		     a	 	     b 					   a		 		     b	----|  |----+==----|  |-------  			     ----|  |----+-----------+----|  |-------     NO SE PUEDE, CORTOCIRCUITO.		      |	c			   ==>		    	     |	     c	 |		     +----|  |----->>					    +----|  |----+ 		debe haber un elemento entre los VL.	( == ) es el Horizontal Link hacia el cual quiero Cerrar la Rama desde el Right Power Rail."		"Busco el Bloque Conectable conectado a la entrada 1 de la Conexion."	connectableBlock1 := aPLC_Connection blockConnectedToInput: 1.		"Analizo si los bloques conectables obtenidos son iguales"	( connectableBlock1 = connectableBlock2 )		ifTrue: [			^ '3 - No se puede hacer cortocircuitos.'			].			" 4 -   Busco a travs de la Conexion ( == ) hacia su entrada hasta encontrar un	 elemento que sea un Vertical Link o Left Power Rail y tambin guardo por cual nmero 	de pin de salida llego."	[ ( connectableBlock1 element isLeftPowerRail or: [ connectableBlock1 element isVerticalLink ] ) ]		whileFalse: 			[ connectableBlockOutputPinNumber1 := connectableBlock1 outputPinNumberConnectedToInput: 1.			connectableBlock1 := connectableBlock1 blockConnectedToInput: 1. ] .	" 5 -  Chequeo si los 2 bloques conectables a los cuales llego recorriendo hacia al entrada de	de la Conexion ( == ) y del Right Power Rail ( -->> ) son el mismo Vertical Link o Left Power Rail 	y tambin que el Numero de Pin al que llego por el RPR sea mayor al Numero de Pin al que llego 	por la Conexion. Si esto se cumple entonces puedo Cerrar la rama creando asi una conexion 	en Paralelo.										           1	Output Pin N 1  -----+----|  |-----------------------==-------------|  |-----            	 	 						 |				   2	Output Pin N 2 	+----|  |----------|  |----==-->>	3						 |		Output Pin N3 		+----|  |---------------->> 4				Puedo Cerrar Rama en los casos:		3 con 1		4 con 1		4 con 2	"	( connectableBlock1= connectableBlock2 and: [ connectableBlockOutputPinNumber2 > connectableBlockOutputPinNumber1 ] )		ifTrue: [						"Si llego a este punto entonces puedo Cerrar la rama creando as una conexion en paralelo.						6 -  Elimino el Right Power Rail."						"Busco el Pin de salida conectado al  Conectable"			connectableBlockOutputPin := (aPLC_ConnectableBlockRightPowerRail connectedAtInput: 1) outputPin.								"Desconecto el Right Power Rail"			(aPLC_ConnectableBlockRightPowerRail connectedAtInput: 1) disconnect.						"Elimino el Right Power Rail de la Network de Bloques Conectables "			self blocks remove: aPLC_ConnectableBlockRightPowerRail.									"7 -  Chequeo si primer elemento conectado a entrada de la conexion ( == ) es un Vertical 			Link. Si esto se cumple entonces en lugar de crear un nuevo Vertical Link le agrego un 			Pin  de entrada a dicho Vertical Link. CREO QUE ESTE CHEQUEO ME LO FILTRA MAS ARRIBA.					 	 -----+----|  |-----+--==----      	 	 -----+----|  |-----+-----    ASI SI 	 				 |		   |						 |		   |		 			+----|  |-----+			==>		+----|  |-----+					 |								 |		   |					+----|  |-------->> 					+----|  |-----+			 	 -----+----|  |-----+--==----      	 	 -----+----|  |-----+------+-----     ASI NO	 	 				 |		   |						 |		    |	      |	 			+----|  |-----+			==>		+----|  |-----+	      |				 |								 |		   	      |				+----|  |-------->> 					+----|  |-------------+			"						"Busco el Bloque Conectable a la Entrada del la Conexion."			connectableBlockLPRorVL := aPLC_Connection connectedAtInput: 1.						"Analizo si es un VL. Si es verdadero le agrego una Entrada."			( connectableBlockLPRorVL element isVerticalLink )				ifTrue: [					 connectableBlockLPRorVL addInput.					].							"8 -  Chequeo si primer elemento conectado a Salida de la conexion ( == ) es un Vertical 			Link. Si esto se cumple entonces en lugar de crear un nuevo Vertical Link le agrego un 			Pin  de entrada a dicho Vertical Link.					 	 -----+----|  |------==------+----|  |-----+-----   		 	 -----+----|  |-----+----|  |-----+-----     ASI SI							 |		 		   |		      |					 |		   |		      |		 			+----|  |----->> 	  +----|  |-----+		  ==>		+----|  |-----+----|  |-----+								   |		      |							   |		      |									  +----|  |-----+							  +----|  |-----+			 	 -----+----|  |------==------+----|  |-----+-----   		 	 -----+-----|  |------+-----+-----|  |-----+-----     ASI NO							 |		 		   |		      |					 |		     |       |	 	     |		 			+----|  |----->> 	  +----|  |-----+		  ==>		+-----|  |------+     +-----|  |-----+								   |		      |								       |		     |									  +----|  |-----+								      +-----|  |-----+				"						"Busco el Bloque Conectable a la Salida del la Conexion."			connectableBlockLPRorVL := aPLC_Connection connectedAtOutput: 1.						"Analizo si es un VL. Si es verdadero le agrego una Entrada."			( connectableBlockLPRorVL element isVerticalLink )				ifTrue: [					 connectableBlockLPRorVL addInput.					]				ifFalse: [										"9 -  Creo un nuevo Vertical Link y conecto sus primeras entradas y 					salidas donde se encontraba la Conexion."															"Creo lel Vertical Link y le agrego 2 entradas y 1 salida."					connectableBlockLPRorVL := PLC_ConnectableBlock newWithElement: PLC_Element VerticalLink.					connectableBlockLPRorVL addOutput;						addInput;						addInput.											"Agrego el Bloque Conectable a la Network de Bloques Conectables"					self addBlock: connectableBlockLPRorVL.										"Conecto el nuevo elemento a los Bloques Conectables entre los cuales 					estaba la conexion donde agrego el nuevo elemento."					aPLC_Connection replaceConnectionByConnectingToInputPin: connectableBlockLPRorVL inputs first andOutputPin:  connectableBlockLPRorVL outputs first.										].							"10 -  Conecto el pin de salida del Bloque Conectable que estaba conectado el 			Right Power Rail al ultimo pin de Entrada del connectableBlockLPRorVL."						connectableBlockOutputPin connectTo: connectableBlockLPRorVL inputs last.						^ connectableBlockLPRorVL.						]		ifFalse: [			^ 'No se puede Cerrar Rama.'			].! !!PLC_LadderNetwork methodsFor: 'compilation' stamp: 'EricPernia 11/15/2013 13:51'!generateCodeIn: aProgramAccumulator	"Compila su programa a objetos que lo forman. Estos pueden dar su cdigo C o IL."	| varDecl |	self checkValidRightPowerRailConnections 		ifTrue: [						"Reseteo los objetos generados por los elementos"			self resetCompiledObjectsInElements.													"Creo la declaracin de variable FLUX que la usan los llamados graficos a F y FB"			varDecl := PLC_SymbolicVariableDecl 				newWithDataType: PLC_DataType Bool				andInitialValue: nil 				andIdentifier: 'FLUX'. 						"La agrego a las variables declaradas por el compilador"					aProgramAccumulator addVarDecl: varDecl.						"Le asigno la categora temp asi no pone el pxPOU-> en C"			varDecl variableCategory: PLC_VariableCategoryDecl tempVarDecls.									"Comienzo la compilacion en el bloque conectable left power rail"			self leftPowerRailBlock generateCodeIn: aProgramAccumulator.									"Guardo los objetos generados por los Vertical Links"			self veriticalLinkBlocks do: [ :block |				aProgramAccumulator addVarDecl: block element objectVarDec.				aProgramAccumulator addDataTypeDecl: block element objectTypeDec.				].					]		ifFalse:[						self error: 'No se puede compilar'.						]				! !!PLC_LadderNetwork methodsFor: 'initialize-release' stamp: 'EricPernia 11/5/2013 12:53'!initialize	"Inicializacion de la Network de Bloques Conectables"		super initialize.		"Agrego el Left Power Rail y el Right Power Rail en la Network de Bloques Conectables quedando el modelo inicial:		|	|-------------------------------------------------------------|	|		"	self addRightPowerRailConnectedTo: self addLeftPowerRail output: 1.	! !!PLC_LadderNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/5/2013 12:50'!leftPowerRailBlock	"Retorna una coleccion de bloques conectables cuyo elemento sea un riel derecho."	^ (self blocks select: [ : each | each element isLeftPowerRail ]) first.! !!PLC_LadderNetwork methodsFor: 'commands copen-close Branch' stamp: 'EricPernia 4/5/2014 03:42'!openBranchOnConnection: aPLC_Connection	"Abre una rama sobre una conexion (==).		|----|  |----==---(  )----|             	|----|  |----+----(  )----|        	|							|	       |	|							|            +->>				CASOS:		1 -  Si abro rama sobre el horizontal link cuya entrada esta conectada a un 	VL o LPR entonces debe agregarle un pin de salida al VL o LPR y ahi 	conectarle el RPR.		|----|  |-----+==--(  )----|			|----|  |-----+----(  )----|	|		  |						|		  |		|		 +------(  )----|   			|		 +->>									|		  |									|		 +----(  )----|  			 			2 -  Si abro rama sobre el horizontal link cuya salida esta conectada a un 	VL entonces debe agregarle un pin de salida al VL y ahi 	conectarle el RPR.								Si quiero abrir rama sobre el HL entre el contacto y el VL entonces tiene 	que agregarle un pin de salida al VL y agregarle ahi el RPR.		|----|  |----==-+----(  )----|			|----|  |-----+----(  )----|	|	 	      |					|		  |		|		     +----(  )----|   			|		 +----(  )----|  									|		  |									|	 	 +->>														3 -  Si abro rama sobre en un horizontal link NO conectado a un VL o LPR 	entonces debo agregarle en su lugar un nuevo Vertical Link y conectarle 	en su segunda salida un Right Power Rail..		|----|  |----==---(  )----|             	|----|  |----+----(  )----|        	|							|	       |	|							|            +->>			"		| connectableBlockLPRorVLInput connectableBlockVLOutput	connectableBlockLPRorVL outputPin connectableBlockRightPowerRail |	"Busco el Bloque Conectable a la Entrada del la conexion, puede ser un LPR, VL u otro."	connectableBlockLPRorVLInput := aPLC_Connection connectedAtInput: 1.		"Busco el Bloque Conectable a la Salida del la conexion, nunca va a poder ser un LPR."	connectableBlockVLOutput := aPLC_Connection connectedAtOutput: 1.				"Chequeo si la conexion ya estaba conectada a un Left Power Rail o 	Vertical Link a su entrada o salida. Si esto es verdadero, le agrego al 	LPR o VL una salida y le conecto un Right Power Rail. Nunca se va a dar 	el caso simultaneo que la conexin est conectada a izquierda y	derecha a VLs o LPRs en simultaneo ya que sino deberan haber sido 	absorbidos durante un borrado.		Si es falso Debo crear Primero un Vertical Link y luego agregar 	una salida conectada a un RPR."			"Prueba si el bloque conectable de entrada de la conexion es LPR o VL"	( connectableBlockLPRorVLInput element isLeftPowerRail 	or: [ connectableBlockLPRorVLInput element isVerticalLink ] )		ifTrue: [			connectableBlockLPRorVL := connectableBlockLPRorVLInput.			"Seteo el pin luego del cual debe agregarse el nuevo pin"			outputPin := aPLC_Connection outputPin.				].			"Prueba si el bloque conectable de salida de la conexion es VL"		( connectableBlockVLOutput element isVerticalLink )		ifTrue: [			connectableBlockLPRorVL := connectableBlockVLOutput.			"Seteo el pin luego del cual debe agregarse el nuevo pin"			outputPin := connectableBlockLPRorVL outputs last.				].		"Si ni el bloque conectable a la entrada de la conexion, ni el de salida 	son LPR oVL, entonces tiene que crear un VL"		connectableBlockLPRorVL		ifNil: [			"Creo lel Vertical Link y le agrego una entrada y una salida."			connectableBlockLPRorVL := PLC_ConnectableBlock 				newWithElement: PLC_Element VerticalLink.			connectableBlockLPRorVL 				addInput;				addOutput.							"Agrego el Bloque Conectable a la Network de Bloques Conectables"			self addBlock: connectableBlockLPRorVL.						"Conecto el nuevo elemento a los Bloques Conectables entre los 			cuales estaba la conexion donde agrego el nuevo elemento."			aPLC_Connection 				replaceConnectionByConnectingToInputPin: connectableBlockLPRorVL inputs first 				andOutputPin:  connectableBlockLPRorVL outputs first.							"Seteo el pin luego del cual debe agregarse el nuevo pin"			outputPin := connectableBlockLPRorVL outputs first.			].					"Le agrego una salida al Left Power Rail o Vertical Linkl"	connectableBlockLPRorVL addOutputAfter: outputPin.			"Le conecto un nuevo Right Power Rail"	connectableBlockRightPowerRail := self 		addRightPowerRailConnectedTo: connectableBlockLPRorVL 		output: ( connectableBlockLPRorVL outputs indexOf: outputPin ) + 1.		"Agrego el Right Power Rail a la Network de Bloques Conectables"	self addBlock: connectableBlockRightPowerRail.		^ connectableBlockLPRorVL.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 11/5/2013 12:51'!removeCloseBranch: aPLC_ConnectableBlockVerticalLink	"Remueve en un Vertical Link solo la parte que cierrar rama paralela."	| connectableBlockOutputPin inputConnectableBlock |		"Solo puedo borrar el Close Branch si tiene mas de un pin de entrada"	( aPLC_ConnectableBlockVerticalLink inputs size > 1 )		ifTrue: [						( 2 to: aPLC_ConnectableBlockVerticalLink inputs size ) 				do: [ :index |										"Busco el bloque conectable conectado a la entrada numero index del VL"					inputConnectableBlock := aPLC_ConnectableBlockVerticalLink blockConnectedToInput: index.												"Busco el pin del bloque conectable conectado a la entrada numero index del VL"						connectableBlockOutputPin := ( aPLC_ConnectableBlockVerticalLink connectedAtInput: index) outputPin.										"Desconecto el Pin obtenido"					connectableBlockOutputPin disconnect.										"Le agrego un RPR conectado al pin"					self addRightPowerRailConnectedTo: inputConnectableBlock output: index.										"Borro el pin de entrada numero index del VL"					aPLC_ConnectableBlockVerticalLink inputs removeAt: index.										].						"Chequeo que al final del borrado de pines de entrada resulte un VL valido."				^ self checkValidVerticalLink: aPLC_ConnectableBlockVerticalLink.						].! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 11/5/2013 12:51'!removeCoil: aPLC_ConnectableBlockCoil	"Remueve una Bobina."	| connectableBlockActualArgumentWriter connectableBlockOutputPin connectableBlockInputPin |	"Busco los pines de los bloques conectables conectados a la primer entrada y salida de la bobina"		connectableBlockOutputPin := ( aPLC_ConnectableBlockCoil connectedAtInput: 1) outputPin.	connectableBlockInputPin := ( aPLC_ConnectableBlockCoil connectedAtOutput: 1) inputPin.		"Busco el Actual Argument  Writer de la bobina"		connectableBlockActualArgumentWriter := aPLC_ConnectableBlockCoil blockConnectedToOutput: 2.		"Desconecto el Actual Argument  Writer de la bobina"	( connectableBlockActualArgumentWriter connectedAtInput: 1 ) disconnect.		"Desconecto la bobina"	( aPLC_ConnectableBlockCoil connectedAtInput: 1) disconnect.	( aPLC_ConnectableBlockCoil connectedAtOutput: 1) disconnect.		"Remuevo los bloques conectables de la Network de bloques conectables"	self removeBlock: aPLC_ConnectableBlockCoil.	self removeBlock: connectableBlockActualArgumentWriter.		"Conecto los pines obtenidos y realizo los chequeos pertinentes a LPR y VL"	^ self checkShortCircuitIfConnect: connectableBlockOutputPin To: connectableBlockInputPin.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 4/5/2014 01:51'!removeContact: aPLC_ConnectableBlockContact	"Remueve un Contacto."	| connectableBlockActualArgumentReader connectableBlockOutputPin connectableBlockInputPin VLInput VLOutput |	"Busco los pines de los bloques conectables conectados a la primer entrada y salida del Contacto"		connectableBlockOutputPin := ( aPLC_ConnectableBlockContact connectedAtInput: 1) outputPin.	connectableBlockInputPin := ( aPLC_ConnectableBlockContact connectedAtOutput: 1) inputPin.		"Busco el Actual Argument  Writer del Contacto"		connectableBlockActualArgumentReader := aPLC_ConnectableBlockContact blockConnectedToInput: 2.		"Desconecto el Actual Argument  Writer del Contacto"	( connectableBlockActualArgumentReader connectedAtOutput: 1 ) disconnect.		"Desconecto el Contacto"	( aPLC_ConnectableBlockContact connectedAtInput: 1) disconnect.	( aPLC_ConnectableBlockContact connectedAtOutput: 1) disconnect.		"Remuevo los bloques conectables de la Network de bloques conectables"	self removeBlock: aPLC_ConnectableBlockContact.	self removeBlock: connectableBlockActualArgumentReader.		"Conecto los pines obtenidos y realizo los chequeos pertinentes a LPR y VL"	^ self checkShortCircuitIfConnect: connectableBlockOutputPin To: connectableBlockInputPin.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 9/9/2015 21:46'!removeFunctionCall: aPLC_ConnectableBlockFunctionCall	"Elimina un Llamado a Funcin."		| connectableBlock connectableBlockOutputPin connectableBlockInputPin pou instance |			"PARCHE: ELIMINO LA INSTANCIA AL ELIMINAR EL F O FB"	pou := aPLC_ConnectableBlockFunctionCall element network pouBody pou.	instance := aPLC_ConnectableBlockFunctionCall element instance. 		"Si es F tener cuidado porque cada vez que agrego alguna me agrega una sola variable por tipo de F"	( pou funInstVarDecls declarations includes: instance)		ifTrue: [			"Chequeo si hay una o ms funciones de ese tipo"			(( self functionConnectableBlocks select: [ :e | e element instance = instance ] ) size = 1)				ifTrue: [					"Si no hay ms de una funcin de ese tipo remuevo la instancia"					pou funInstVarDecls declarations remove: instance 				].		].			"Si es FB Borro su declaracion correspondiente"	(pou varDecls declarations includes: instance)		ifTrue: [			pou varDecls declarations remove: instance. 		].					"BORRO LOS BLOQUES CONECTABLES"	"Busco los pines de los bloques conectables conectados a la primer entrada y salida del Llamado a Funcin"		connectableBlockOutputPin := ( aPLC_ConnectableBlockFunctionCall connectedAtInput: 1) outputPin.	connectableBlockInputPin := ( aPLC_ConnectableBlockFunctionCall connectedAtOutput: 1) inputPin.		"Desconecto y borro las entradas segn que tenga conectado"	(2 to: aPLC_ConnectableBlockFunctionCall inputs size ) do: [ :index |			"Busco el Bloque Conectable conectado a la entrada nmero index"			connectableBlock := aPLC_ConnectableBlockFunctionCall blockConnectedToInput: index.			"Chequeo si es un Actual Argument Reader"		connectableBlock element isActualArgumentReader			ifTrue: [				"Si es Actual Argument lo desconecta y lo remueve"								"Desconecto el Actual Argument Reader"				( connectableBlock connectedAtOutput: 1 ) disconnect.						"Remuevo bloques conectable de la Network de bloques conectables"				self removeBlock: connectableBlock.				] 			ifFalse: [				"Si No es Actual Argument le crea y conecta un RPR"								"Desconecto el Elemento"				( connectableBlock connectedAtOutput: 1 ) disconnect.								"Creo y conecto un RPR"				self addRightPowerRailConnectedTo: connectableBlock output: 1.								].		].	"Siempre es un Actual Argument Writer a la salida. Se descoenectan y borran."		(2 to: aPLC_ConnectableBlockFunctionCall outputs size ) do: [ :index |					"Busco el Actual Argument Writer a la salida nmero index"			connectableBlock := aPLC_ConnectableBlockFunctionCall blockConnectedToOutput: index.						"Desconecto el Actual Argument Writer"		( connectableBlock connectedAtInput: 1 ) disconnect.				"Remuevo bloques conectable de la Network de bloques conectables"		self removeBlock: connectableBlock.		].					"Desconecto el bloque conectable Llamado a Funcin"	( aPLC_ConnectableBlockFunctionCall connectedAtInput: 1) disconnect.	( aPLC_ConnectableBlockFunctionCall connectedAtOutput: 1) disconnect.				"Remuevo el bloque conectable Llamado a Funcin de la Network de bloques conectables"	self removeBlock: aPLC_ConnectableBlockFunctionCall.		"Conecto los pines obtenidos y realizo los chequeos pertinentes a LPR y VL"	^ self checkShortCircuitIfConnect: connectableBlockOutputPin To: connectableBlockInputPin.! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 11/5/2013 12:51'!removeRightPowerRail: aPLC_ConnectableBlockRPR	"Remueve un Right Power Rail."	| connectableBlockOutputPin VLorLPRInput |		"Busco el bloque conectable conectado a la entrada del RPR"	VLorLPRInput := aPLC_ConnectableBlockRPR blockConnectedToInput: 1.		"Solo puedo borrar el RPR si esta conectado a un VL o LPR sino lo retorno"	( VLorLPRInput element isLeftPowerRail or: [ VLorLPRInput element isVerticalLink ] )		ifTrue: [						"Solo puedo borrar el RPR si el LPR o VL tiene mas de una salida."			( VLorLPRInput outputs size > 1 )				ifTrue: [											"Busco el pin del bloque conectable conectado a la primer entrada del RPR"						connectableBlockOutputPin := ( aPLC_ConnectableBlockRPR connectedAtInput: 1) outputPin.																			"Remuevo la salida del elemento del VL o LPR - NO ANDABA ANTES PORQUE NO HACIA ESTO"					VLorLPRInput element outputs removeAt: ( VLorLPRInput outputs indexOf: connectableBlockOutputPin ).					"Remuevo el pin obtenido del Bloque Conectable LPR o VL"					VLorLPRInput outputs remove: connectableBlockOutputPin.												"Desconecto el RPR"					( aPLC_ConnectableBlockRPR connectedAtInput: 1) disconnect.						"Remuevo el bloque conectable de la Network de bloques conectables"					self removeBlock: aPLC_ConnectableBlockRPR.										"Si el LPR o VL es un VL entonces debo chuequear que quede un VL valido"					VLorLPRInput element isVerticalLink						ifTrue: [							^ self checkValidVerticalLink: VLorLPRInput.							].											^ VLorLPRInput.												] 			] .! !!PLC_LadderNetwork methodsFor: 'commands add-remove Elements' stamp: 'EricPernia 1/25/2014 22:40'!replaceAcrualArgumentReaderFor: aPLC_Element inFunction: aPLC_ConnectableBlockF input: anInputNumber	"Reemplaza un Lector de Argumento Real por un contacto en la entrada  anInputNumber de la funcion aPLC_ConnectableBlockF."	| connectableBlockOutputPinNumber lpr maxInput oc connection connectableBlockActualArgument |		"Chequeo que tenga un actual argument reader en esa entrada"	( ( aPLC_ConnectableBlockF blockConnectedToInput: anInputNumber ) element isActualArgumentReader and: [ aPLC_Element isCoil or: aPLC_Element isContact] )		ifTrue: [				"Chequeo si se encuentra en una rama paralela. Si es verdadero no puedo agregar contacto."			(self checkIfFunctionAreInAParallelBranch: aPLC_ConnectableBlockF)				ifFalse: [					"Chequeo que la entrada anInputNumber sea INPUT y BOOL y sea una entrada mayor a 1"					( ( aPLC_ConnectableBlockF element inputs size >= anInputNumber and: [ anInputNumber > 1 ] )						and: [ (aPLC_ConnectableBlockF element inputs at: anInputNumber) dataType acceptType:  PLC_DataType Bool ] ) 												ifTrue: [							"Si se cumple todo entonces reemplazo el Actual Argument Reader por un contacto"														"1 - Busco el mayor numero de  entrada cableada por arriba de anInputNumber"							maxInput := self moreWiredInputFor: aPLC_ConnectableBlockF until: anInputNumber.														"2 - Busco el primer VL o LPR a la derecha yendo por maxInput"							lpr := aPLC_ConnectableBlockF blockConnectedToInput: maxInput.							connectableBlockOutputPinNumber := aPLC_ConnectableBlockF outputPinNumberConnectedToInput: maxInput.														"Busco a travs de la Funcion hacia su entrada hasta encontrar un elemento que sea un Vertical Link o							Left Power Rail  y tambin guardo por cual nmero de pin de salida llego."							[ lpr element isLeftPowerRail ]								whileFalse: 									[ maxInput :=self moreWiredInputFor: lpr.									connectableBlockOutputPinNumber := lpr outputPinNumberConnectedToInput: maxInput.									lpr := lpr blockConnectedToInput: maxInput. ].								"Si llego aca es porque seguro llegue al LPR. Me fijo si tengo que agregar el pin o hacer lugar y agregar"							lpr outputs size > connectableBlockOutputPinNumber								ifTrue: [									oc :=  lpr outputs copyFrom: connectableBlockOutputPinNumber + 1 to: lpr outputs size.									lpr outputs: (lpr outputs copyFrom: 1 to: connectableBlockOutputPinNumber).									lpr addOutput.									lpr outputs: lpr outputs , oc.									]								ifFalse:[									lpr addOutput.									].								"Busco el Actual Argument "									connectableBlockActualArgument := aPLC_ConnectableBlockF blockConnectedToInput: anInputNumber.								"Desconecto el Actual Argument"								( connectableBlockActualArgument connectedAtOutput: 1 ) disconnect.								"Lo borro de la Network de bloques conectables"								self removeBlock: connectableBlockActualArgument.																								"Conecto entre el nuevo pin y el bloque"								lpr disconnectOutput:  connectableBlockOutputPinNumber + 1.								lpr output: connectableBlockOutputPinNumber + 1 connectTo: aPLC_ConnectableBlockF input: anInputNumber.								connection := lpr connectedAtOutput: connectableBlockOutputPinNumber + 1.																						"Agrego el contacto o bobina"								aPLC_Element isContact									ifTrue: [ self addContact: aPLC_Element onConnection: connection ]. 								aPLC_Element isCoil									ifTrue: [ self addCoil: aPLC_Element onConnection: connection ]. 																					].					].			].			^ 'No se puede agregar contacto.'.! !!PLC_LadderNetwork methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 12:52'!resetCompiledObjectsInElements.	"Reseteo todo para la proxima compilacion"	"Reseteo los objetos de compilacion generados por los Vertical Links"	self veriticalLinkBlocks do: [ :block |		block element objectVarDecl: nil.		block element objectTypeDecl: nil.		block element numberOfCompiledImputs: 0.		].! !!PLC_LadderNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/5/2013 12:50'!rightRailsBlocks	"Retorna una coleccion de bloques conectables cuyo elemento sea un riel derecho."	^ self blocks select: [ : each | each element isRightPowerRail ].	"VER SI VA SELECT O COLLECT"! !!PLC_LadderNetwork methodsFor: 'blocks' stamp: 'EricPernia 11/5/2013 12:50'!veriticalLinkBlocks	"Retorna una coleccion de bloques conectables cuyo elemento sea un vertical link."	^ self blocks select: [ : each | each element isVerticalLink ].	"VER SI VA SELECT O COLLECT"! !!PLC_Controller class methodsFor: 'instance creation' stamp: 'EricPernia 5/17/2015 07:57'!newWithModel: aModel andView: aView	"Crea una nueva instancia de controlador de MVC con el modelo y vista asociados"	| controller |		"Creo un controlador Ladder"	controller := self new.		"Le agrego el modelo"	controller model: aModel.		"Le agrego la vista"	controller view: aView.		^ controller.	! !!PLC_Controller methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:28'!model		^ model! !!PLC_Controller methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:28'!model: anObject		model := anObject! !!PLC_Controller methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:28'!view		^ view! !!PLC_Controller methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:28'!view: anObject		view := anObject! !!PLC_Controller methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:28'!window		^ self view! !!PLC_Controller methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:29'!window: anObject		self view: anObject! !!PLC_EditorCProject class methodsFor: 'instance creation' stamp: 'EricPernia 4/23/2016 01:42'!newWithPOU: aPOU andColor: aColor andBorderColor: aBorderColor andTitleColor: aTitleColor andTitleName: aTitleName	"Nueva instancia con cierto modelo de pou y colores"	| editor |		"pouDeclsEditor es un Controlador"		editor := self new.		"Seteo su Modelo"	editor pou: aPOU.		"Seteo los colores de su Vista"	editor color: aColor.	editor borderColor: aBorderColor.	editor titleColor: aTitleColor.	"Seteo el titulo de la vista"	editor titleName: aTitleName.			^ editor! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!addPOUToLibrary 	"Aade su POU a la biblioteca de POUs"		IDE4PLC savePou.! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!borderColor		^ borderColor! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!borderColor: anObject		borderColor := anObject! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!buildCProgram	IDE4PLC buildCProgram! !!PLC_EditorCProject methodsFor: 'pou editor' stamp: 'EricPernia 4/23/2016 01:30'!buildPOUView	"Construye la vista y se la asigna a su variable de instancia pouBodyView para recordarla"		| controls pouView | 			"Creo la coleccin de controls que despues se pasa a la columna morph como array"	controls := OrderedCollection new.		"Agrego la barra de herramientas"	controls add: self toolbar.		"Creo la columna morph"	pouView := self builder newColumn: controls asArray.	"hResizing: #spaceFill;	vResizing: #shrinkWrap;	cellSpacing: 10"		pouView 		cellInset: 0";		extent: 720 @ 450".										^ pouView.	! !!PLC_EditorCProject methodsFor: 'commands-varDecls' stamp: 'EricPernia 4/23/2016 01:30'!buildVarDeclsEditor	varDeclsEditor := PLC_EditorPOUDeclarations 		newWithPOUDeclarations: self pou declarations		andColor: ( Color r: 1 g: 1 b: 1 alpha: 0.5 )  		andBorderColor: Color black 		andTitleColor:  PLC_GraphicElementProperties uniqueInstance programHeaderColor 		andTitleName: 'Editor POU Var Decls -> Title' translated.		^ varDeclsEditor.! !!PLC_EditorCProject methodsFor: 'open/close' stamp: 'EricPernia 4/23/2016 03:33'!buildWindow	"Crea la ventana del Editor y agrega los controles"	| textMorph |	view 		ifNil: [ 			"Creo la ventana"			view := ( SystemWindow labelled: self titleName ) model: nil.						"Agrego La cabecera del Editor de POU"			view addMorph: self buildPOUView fullFrame: (				LayoutFrame 					fractions: ( 0@0 corner: 1@0.085 )					offsets: ( 0@0 corner: 1@0 )				).							"Agrego el editor de texto"						textMorph := PluggableTextMorph new.						view addMorph: textMorph fullFrame: (				LayoutFrame 					fractions: ( 0@0.085 corner: 1@1 )					offsets: ( 0@0 corner: 1@0 )				).		].	^ view.! !!PLC_EditorCProject methodsFor: 'view' stamp: 'EricPernia 4/23/2016 01:30'!builder	"Devuelve el builder"	^ UITheme builder.! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!cleanCProgram 	IDE4PLC cleanCProgram! !!PLC_EditorCProject methodsFor: 'open/close' stamp: 'EricPernia 4/23/2016 01:30'!close	"Cierra la ventana del  Editor."	self closeWindow.! !!PLC_EditorCProject methodsFor: 'commands-varDecls' stamp: 'EricPernia 4/23/2016 01:30'!closeVarDeclsEditor 	"Cierra el editor de variables"	varDeclsEditor ifNotNil: [ 			varDeclsEditor close.		varDeclsEditor := nil.			].		^ varDeclsEditor.! !!PLC_EditorCProject methodsFor: 'open/close' stamp: 'EricPernia 4/23/2016 01:30'!closeWindow	"Cierra la ventana del  Editor."	view 		ifNotNil: [ 			view close.		].	^ view.		! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!color		^ color! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!color: anObject		color := anObject! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!downloadCProgram 	IDE4PLC downloadCProgram! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!downloadProgram 	IDE4PLC downloadProgram! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!generateBuildDownloadCProgram 	IDE4PLC generateBuildDownloadCProgram! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!generateCBuildDownloadProgram 	IDE4PLC generateCBuildDownloadProgram! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!generateCode	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph generateCode 			]! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!generateProgramCCode 	IDE4PLC generateProgramCCode! !!PLC_EditorCProject methodsFor: 'open/close' stamp: 'EricPernia 4/23/2016 01:30'!imageFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	^ 'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , '/GUI_Images/EditorPOU/'. ! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!keyboardFocusMorph		^ keyboardFocusMorph! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!keyboardFocusMorph: anObject		keyboardFocusMorph := anObject! !!PLC_EditorCProject methodsFor: 'pou editor' stamp: 'EricPernia 4/23/2016 01:30'!ladderPouBodyMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: self titleColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: self titleName.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorCProject methodsFor: 'open/close' stamp: 'EricPernia 4/23/2016 01:30'!open	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	^ self openWindow.! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!openConsole! !!PLC_EditorCProject methodsFor: 'commands-varDecls' stamp: 'EricPernia 4/23/2016 01:30'!openVarDeclsEditor 	self closeVarDeclsEditor.	varDeclsEditor ifNil: [ 		self buildVarDeclsEditor 	].			varDeclsEditor open.		^ varDeclsEditor.! !!PLC_EditorCProject methodsFor: 'open/close' stamp: 'EricPernia 4/23/2016 03:36'!openWindow	"Abre la ventana del  Editor. "		view 		ifNil: [ 			self buildWindow.		].		self resizeAndShowWindow.	"PARCHE: Si no hago esto queda mal el tamao del texto"	view collapse.	view expand.! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!pou		^ pou! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!pou: anObject		pou := anObject! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!pouBodyEditor		^ pouBodyEditor! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!pouBodyEditor: anObject		pouBodyEditor := anObject! !!PLC_EditorCProject methodsFor: 'pou editor' stamp: 'EricPernia 4/23/2016 01:36'!pouNameMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 240@40.	titleMorph backgroundColor: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0) .	titleMorph backgroundBorderWidth: 0.	titleMorph leftMargin: 5.	titleMorph emphasis: 0.	titleMorph textColor: Color black.	titleMorph text: 'hola2'.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorCProject methodsFor: 'open/close' stamp: 'EricPernia 4/23/2016 01:30'!projectFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ 'D:/Proyecto/Pharo-1.3-13315-OneClick.app/Contents/Resources/PLeriC'."	^ ''.! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!resetPOU 	"Resetea la POU"		IDE4PLC resetPou.	self window close.! !!PLC_EditorCProject methodsFor: 'open/close' stamp: 'EricPernia 4/23/2016 03:33'!resizeAndShowWindow	"Crea la ventana del Editor y agrega los controles"	| aWorld |		view 		ifNotNil: [ 										aWorld := Morph new currentWorld. "Esta feo pero funciona"			aWorld addMorph: view.			view updatePaneColors.			view position: 5@5.			view extent: 770@490.			view activate.			aWorld startSteppingSubmorphsOf: view.					].	^ view.! !!PLC_EditorCProject methodsFor: 'commands' stamp: 'EricPernia 4/23/2016 01:30'!showPOUCode 	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	| configSoft |	configSoft := IDE4PLC createConfigSoftWithPOU: pou.		configSoft cCompile.! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!titleColor		^ titleColor! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!titleColor: anObject		titleColor := anObject! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!titleName		^ titleName! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!titleName: anObject		titleName := anObject! !!PLC_EditorCProject methodsFor: 'pou editor' stamp: 'EricPernia 4/23/2016 01:30'!toolbar 	"Genera la fila - Es la barra de herramientas que tiene el tipo de POU y mas botones"		| row |	row := self builder newRow: {					self builder			newButtonFor: self  "if we had a model it would go here"			getState: nil			action: nil			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'POUToolbar/program.png')			help: 'Editor POU -> Toolbar help -> POU Type' translated , 'PROGRAM'.			(self pouNameMorph )			"hResizing: #spaceFill".					self builder			newButtonFor: self 			getState: nil			action: #openVarDeclsEditor			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CommonToolbar/varDeclsEditor.png')			help: 'Editor POU -> Toolbar help -> VAR' translated.		"Pongo un Moprph para que ocupe el lugar de un boton"		( Morph new ) 			extent: 48@40;			color:  (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0).					"self builder			newButtonFor: self 			getState: nil			action: #openConsole			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'console.png')			help: 'Abrir Consola.'."								self builder			newButtonFor: self  			getState: nil			action: #generateProgramCCode			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/genc.png')			help: 'Editor POU -> Toolbar help -> Generate C' translated.					self builder			newButtonFor: self  			getState: nil			action: #buildCProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/build.png')			help: 'Editor POU -> Toolbar help -> Build C' translated.					"self builder			newButtonFor: self  			getState: nil			action: #connectToDevice 			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'connectToDevice.png')			help: 'Conectarse al Dispositivo.'.	"					self builder			newButtonFor: self  			getState: nil			action: #downloadProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/download.png')			help: 'Editor POU -> Toolbar help -> Download' translated.					self builder			newButtonFor: self  			getState: nil			action: #generateCBuildDownloadProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/gencBuildDownload.png')			help: 'Editor POU -> Toolbar help -> Gen Build Download' translated.					self builder			newButtonFor: self  			getState: nil			action: #cleanCProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/clean.png')			help: 'Editor POU -> Toolbar help -> Clean C' translated.					"Pongo un Moprph para que ocupe el lugar de un boton"		( Morph new ) 			extent: 48@40;			color:  (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0).		self builder			newButtonFor: self			getState: nil			action: #addPOUToLibrary			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'FilesToolbar/save.png')			help: 'Editor POU -> Toolbar help -> Save' translated.		self builder			newButtonFor: self  			getState: nil			action: #resetPOU			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'FilesToolbar/delete.png')			help: 'Editor POU -> Toolbar help -> Reset' translated.					}.			row cellInset: 0.		^ row.! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!varDeclsEditor		^ varDeclsEditor! !!PLC_EditorCProject methodsFor: 'accessing' stamp: 'EricPernia 4/23/2016 01:30'!varDeclsEditor: anObject		varDeclsEditor := anObject! !!PLC_EditorDevices class methodsFor: 'instance creation' stamp: 'EricPernia 3/20/2016 19:40'!newWithDevice: aDevice andColor: aColor andBorderColor: aBorderColor andTitleColor: aTitleColor andTitleName: aTitleName	"Nueva instancia con cierto modelo de cuerpo de pou y colores"	| deviceGui |	"pouDeclsEditor es un Controlador"		deviceGui := self new.		"Seteo su Modelo"	deviceGui model: aDevice.		"Seteo los colores de su Vista"	deviceGui color: aColor.	deviceGui borderColor: aBorderColor.	deviceGui titleColor: aTitleColor.	"Seteo el titulo de la vista"	deviceGui titleName: aTitleName.		^ deviceGui! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!borderColor		^ borderColor! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!borderColor: anObject		borderColor := anObject! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 3/20/2016 20:56'!buildView	"Construye la vista y se la asigna a su variable de instancia pouDeclarationsView para recordarla"		| scroller exp1 exp2 eg1 | 		"scroller := ( self builder newScrollPaneFor: ladderView ) 		hResizing: #spaceFill; 		vResizing: #spaceFill."	"morph1 := (PanelMorph new fillStyle: (SolidFillStyle color: Color red))		hResizing: #spaceFill;		vResizing: #spaceFill."					scroller := ( self builder newScrollPaneFor: self deviceMorph ) 		hResizing: #spaceFill; 		vResizing: #spaceFill.	exp1 := ( self builder newExpander: 'Editor Device -> Picture' translated for: scroller ) 		spaceFillWeight: ProportionalSplitterMorph splitterWidth;		expanded: true.		eg1 := EdgeGripMorph new		target: exp1;		edgeName: #bottom;		vResizing: #rigid;		extent: 24 @ 1;		on: #mouseDown send: #expandedSizingRigid to: exp1.	"gridMorph := self boardDescriptionGridMorph.	gridMorph editor: self.	gridMorph controller: self.	gridMorph identifier: 'description'."			scroller := ( self builder newScrollPaneFor: self deviceDescriptionMorph ) 		hResizing: #spaceFill; 		vResizing: #spaceFill.	exp2 := ( self builder newExpander: 'Editor Device -> Description' translated for: scroller ) 		spaceFillWeight: ProportionalSplitterMorph splitterWidth;		expanded: true.		view := self builder 		newColumn: { 			self toolbar.			exp1. 			eg1. 			exp2.			}.		view cellInset: 0;		extent: 732 @ 60.			^ view.						! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 5/18/2015 04:54'!builder	"Devuelve el builder"	^ UITheme builder.! !!PLC_EditorDevices methodsFor: 'actions' stamp: 'EricPernia 3/20/2016 19:41'!changeCurrentDevice: aPLC_DevicePLCName	"Accion al presionar una opcion en el list tras presionar el boton para cambiar de device"	| lasPosition |	"Cambio el device actual"	PLC_DevicePLC changeCurrentDevice: aPLC_DevicePLCName.		"Actualizo la GUI"	lasPosition := self window position.	self close.		IDE4PLC clearAllInstances.				"Cambio el device actual"	PLC_DevicePLC changeCurrentDevice: aPLC_DevicePLCName.			IDE4PLC initializeGUI.		"IDE4PLC openBoardEditorInPosition: lasPosition."	IDE4PLC openDeviceEditor.	! !!PLC_EditorDevices methodsFor: 'actions' stamp: 'EricPernia 2/15/2016 01:14'!changeDevicePressed	"Abro el list al presionar el boton para cambiar de device"		| devList |		"Obtengo el controlador de la lista de funciones"	devList := PLC_Libraries uniqueInstance deviceList.		"Le seteo al list que el resultado me lo mande a mi (self = EditorBoard)"	devList target: self.		"Le seteo al list que mensaje me tiene que mandar a mi con el resultado como parametro"	devList targetMessage: #changeCurrentDevice:.			"Le mando al controlador de la lista de funciones contenido en su	 biblioteca que muestre su vista de Lista"	devList openAt: self window positionInWorld + ( 0 @ 40 ). ! !!PLC_EditorDevices methodsFor: 'open/close' stamp: 'EricPernia 5/18/2015 04:54'!close	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	window 		ifNotNil: [ 			window close.			window := nil.		].! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!color		^ color! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!color: anObject		color := anObject! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 3/19/2016 01:48'!device		^ model! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 3/19/2016 01:49'!device: anObject		model := anObject! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 3/19/2016 01:50'!deviceDescriptionGridMorph	"Devuelve el morph grid con sus rows"	^ PLC_EditableGrid newWithRows: self deviceDescriptionGridMorphRows.! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 3/19/2016 01:51'!deviceDescriptionGridMorphRows	"Devuelve  el contenido del grid morph"		| rows |		rows := OrderedCollection new.	rows add: (OrderedCollection new add: 	'    2 puertos micro-USB (uno para aplicaciones y debugging, otro para alimentacin).').rows add: (OrderedCollection new add: 	'    4 salidas digitales implementadas con leds RGB.').rows add: (OrderedCollection new add: 	'    4 entradas digitales con pulsadores.').rows add: (OrderedCollection new add: 	'    1 puerto de comunicaciones RS 485 con bornera.').rows add: (OrderedCollection new add: 	'        CON0:').rows add: (OrderedCollection new add: 	'            3 entradas analgicas (ADC02),').rows add: (OrderedCollection new add: 	'            1 salida analgica (DAC0),').rows add: (OrderedCollection new add: 	'            1 conexin para un teclado de 34,').rows add: (OrderedCollection new add: 	'            12 pines genricos de I/O.').rows add: (OrderedCollection new add: 	'        CON1:').rows add: (OrderedCollection new add: 	'            1 puerto Ethernet,').rows add: (OrderedCollection new add: 	'            1 puerto CAN,').rows add: (OrderedCollection new add: 	'            1 puerto SPI,').rows add: (OrderedCollection new add: 	'            1 puerto I2C,').rows add: (OrderedCollection new add: 	'            12 pines genricos de I/O.').	^ rows.! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 3/19/2016 01:51'!deviceDescriptionMorph	"Devuelve la imagen de la placa"	^ (ImageMorph new) 		image: ( Form fromFileNamed:			'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , 			'/GUI_Images/EditorDevice/', self device deviceName , '/' , 			'description.png'		).! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 3/19/2016 01:52'!deviceMorph	"Devuelve la imagen de la placa"	^ (ImageMorph new) 		image: ( Form fromFileNamed:			'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , 			'/GUI_Images/EditorDevice/', self device deviceName , '/' , 			'device.png'		).! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 3/19/2016 01:52'!deviceNameMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 190@40.	titleMorph backgroundColor: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0) .	titleMorph backgroundBorderWidth: 0.	titleMorph leftMargin: 5.	titleMorph emphasis: 1.	titleMorph textColor: Color black.	titleMorph text: self device deviceName.	titleMorph centerAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorDevices methodsFor: 'open/close' stamp: 'EricPernia 3/20/2016 19:29'!imageFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	^ 'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , 		'/GUI_Images/EditorDevice/'! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!keyboardFocusMorph		^ keyboardFocusMorph! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!keyboardFocusMorph: anObject		keyboardFocusMorph := anObject! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 3/24/2016 23:56'!nameMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 232@40.	titleMorph backgroundColor: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0) .	titleMorph backgroundBorderWidth: 0.	titleMorph leftMargin: 5.	titleMorph emphasis: 2.	titleMorph textColor: Color black.	titleMorph text: 'Editor Device -> Toolbar help -> Choose a device' translated.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorDevices methodsFor: 'view' stamp: 'EricPernia 2/18/2016 22:14'!nameMorph2	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 300@40.	titleMorph backgroundColor: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0) .	titleMorph backgroundBorderWidth: 0.	titleMorph leftMargin: 5.	titleMorph emphasis: 0.	titleMorph textColor: Color black.	titleMorph text: ''.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorDevices methodsFor: 'open/close' stamp: 'EricPernia 5/18/2015 04:54'!open	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	self openWindow.	" VAR DECLS ES UNA COLUMNA		varDecls := self builder newColumn: {		self variableToolBar. 				self globalVarTitle.		self globalVarTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.		varDecls cellInset: 0;		minHeight: 10;		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10	(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."	"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."! !!PLC_EditorDevices methodsFor: 'open/close' stamp: 'EricPernia 5/18/2015 05:05'!openWindow	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| aWorld |	"Creo la ventana"	window := ( SystemWindow labelled: self titleName ) model: nil.		"Agrego el editor de variables"	window addMorph: self buildView fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@1 )			offsets: ( 0@0 corner: 0@0 )		).					window updatePaneColors.	window extent: 780@490.	window position: 10@10.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.! !!PLC_EditorDevices methodsFor: 'variable editor - style' stamp: 'EricPernia 5/18/2015 04:54'!pouVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self pouVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.	! !!PLC_EditorDevices methodsFor: 'open/close' stamp: 'EricPernia 5/18/2015 04:54'!projectFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ 'D:/Proyecto/Pharo-1.3-13315-OneClick.app/Contents/Resources/PLeriC'."	^ ''.! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!titleColor		^ titleColor! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!titleColor: anObject		titleColor := anObject! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!titleName		^ titleName! !!PLC_EditorDevices methodsFor: 'accessing' stamp: 'EricPernia 5/18/2015 04:53'!titleName: anObject		titleName := anObject! !!PLC_EditorDevices methodsFor: 'open/close' stamp: 'EricPernia 3/20/2016 20:50'!toolbar 	"Genera la fila - Es la barra de herramientas que tiene el tipo de POU y mas botones"		| row |	row := self builder newRow: {		self builder			newButtonFor: self  "if we had a model it would go here"			getState: nil			action: #changeDevicePressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'deviceIcon.png')			help: 'Editor Device -> Toolbar help -> Choose a device' translated.			(self nameMorph )			"hResizing: #spaceFill".					(self deviceNameMorph )			"hResizing: #spaceFill".					(self nameMorph2 )			"hResizing: #spaceFill".		"Pongo un Moprph para que ocupe el lugar del boton up"		"( Morph new ) 			extent: 44@40;			color: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0)."		}.			row cellInset: 0.		^ row.! !!PLC_EditorDevices methodsFor: 'variable editor - style' stamp: 'EricPernia 5/18/2015 04:54'!varTitleColor	"Genera la fila"		^ Color gray.! !!PLC_EditorDevices methodsFor: 'variable editor - style' stamp: 'EricPernia 5/18/2015 04:54'!varTitleEmphasis	""		^ 0.! !!PLC_EditorDevices methodsFor: 'variable editor - style' stamp: 'EricPernia 5/18/2015 04:54'!varTitlesColor	"Color"		^ PLC_GraphicElementProperties uniqueInstance rowColorHeader.! !!PLC_EditorDevices methodsFor: 'variable editor - style' stamp: 'EricPernia 5/18/2015 04:54'!varTitlesEmphasis	""		^ 1.! !!PLC_EditorPOU class methodsFor: 'instance creation' stamp: 'EricPernia 5/2/2015 03:31'!newWithPOU: aPOU andColor: aColor andBorderColor: aBorderColor andTitleColor: aTitleColor andTitleName: aTitleName	"Nueva instancia con cierto modelo de pou y colores"	| pouEditor |		"pouDeclsEditor es un Controlador"		pouEditor := self new.		"Seteo su Modelo"	pouEditor pou: aPOU.		"Seteo los colores de su Vista"	pouEditor color: aColor.	pouEditor borderColor: aBorderColor.	pouEditor titleColor: aTitleColor.	"Seteo el titulo de la vista"	pouEditor titleName: aTitleName.		pouEditor pouBodyEditor: ( PLC_EditorPOUBody 		newWithPOUBody: aPOU pouBody		andColor: ( Color r: 1 g: 1 b: 1 alpha: 0.5 )  		andBorderColor: Color black 		andTitleColor:  PLC_GraphicElementProperties uniqueInstance programHeaderColor 		andTitleName: 'Cuerpo de POU en lenguaje Ladder'		).			^ pouEditor! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'EricPernia 5/17/2015 19:45'!addPOUToLibrary 	"Aade su POU a la biblioteca de POUs"		IDE4PLC savePou.! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!borderColor		^ borderColor! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!borderColor: anObject		borderColor := anObject! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'CarlosLombardi 11/19/2016 15:04'!buildCProgram	self doIfPouCanBeCompiled: [ IDE4PLC buildCProgram ] .	! !!PLC_EditorPOU methodsFor: 'pou editor' stamp: 'EricPernia 2/16/2016 01:26'!buildPOUView	"Construye la vista y se la asigna a su variable de instancia pouBodyView para recordarla"		| controls pouView | 			"Creo la coleccin de controls que despues se pasa a la columna morph como array"	controls := OrderedCollection new.		"Agrego la barra de herramientas"	controls add: self toolbar.		"Creo la columna morph"	pouView := self builder newColumn: controls asArray.	"hResizing: #spaceFill;	vResizing: #shrinkWrap;	cellSpacing: 10"		pouView 		cellInset: 0";		extent: 720 @ 450".										^ pouView.	! !!PLC_EditorPOU methodsFor: 'commands-varDecls' stamp: 'EricPernia 2/16/2016 01:30'!buildVarDeclsEditor	varDeclsEditor := PLC_EditorPOUDeclarations 		newWithPOUDeclarations: self pou declarations		andColor: ( Color r: 1 g: 1 b: 1 alpha: 0.5 )  		andBorderColor: Color black 		andTitleColor:  PLC_GraphicElementProperties uniqueInstance programHeaderColor 		andTitleName: 'Editor POU Var Decls -> Title' translated.		^ varDeclsEditor.! !!PLC_EditorPOU methodsFor: 'open/close' stamp: 'EricPernia 5/17/2015 19:55'!buildWindow	"Crea la ventana del Editor y agrega los controles"	view 		ifNil: [ 			"Creo la ventana"			view := ( SystemWindow labelled: self titleName ) model: nil.						"Agrego La cabecera del Editor de POU"			view addMorph: self buildPOUView fullFrame: (				LayoutFrame 					fractions: ( 0@0 corner: 1@0.085 )					offsets: ( 0@0 corner: 1@0 )				).							"Agrego el editor de ladder"			view addMorph: pouBodyEditor buildLadderView fullFrame: (				LayoutFrame 					fractions: ( 0@0.085 corner: 1@1 )					offsets: ( 0@0 corner: 1@0 )				).								self resizeAndShowWindow.		].	^ view.! !!PLC_EditorPOU methodsFor: 'view' stamp: 'EricPernia 11/18/2013 14:09'!builder	"Devuelve el builder"	^ UITheme builder.! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'EricPernia 3/16/2016 03:24'!cleanCProgram 	IDE4PLC cleanCProgram! !!PLC_EditorPOU methodsFor: 'open/close' stamp: 'EricPernia 5/2/2015 04:05'!close	"Cierra la ventana del  Editor."	self closeWindow.! !!PLC_EditorPOU methodsFor: 'commands-varDecls' stamp: 'EricPernia 5/17/2015 20:50'!closeVarDeclsEditor 	"Cierra el editor de variables"	varDeclsEditor ifNotNil: [ 			varDeclsEditor close.		varDeclsEditor := nil.			].		^ varDeclsEditor.! !!PLC_EditorPOU methodsFor: 'open/close' stamp: 'EricPernia 5/2/2015 05:34'!closeWindow	"Cierra la ventana del  Editor."	view 		ifNotNil: [ 			view close.		].	^ view.		! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!color		^ color! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!color: anObject		color := anObject! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'CarlosLombardi 11/19/2016 15:04'!doIfPouCanBeCompiled: aBlock	"evaluate the given block if the pou I am editing can be compiled.	 Otherwise, do nothing"	self pou canBeCompiled ifFalse: [ 		GrowlMorph openWithLabel: 'Error' contents: 'El programa tiene errores.'.				^self .	] .	^aBlock value .! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'EricPernia 3/16/2016 03:29'!downloadCProgram 	IDE4PLC downloadCProgram! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'CarlosLombardi 11/19/2016 15:04'!downloadProgram 	self doIfPouCanBeCompiled: [ IDE4PLC downloadProgram ] .! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'CarlosLombardi 11/19/2016 14:57'!generateCBuildDownloadProgram 	self doIfPouCanBeCompiled: [ IDE4PLC generateCBuildDownloadProgram ] .! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'EricPernia 11/18/2013 14:09'!generateCode	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph generateCode 			]! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'CarlosLombardi 11/19/2016 14:56'!generateProgramCCode 	self doIfPouCanBeCompiled: [ IDE4PLC generateProgramCCode ] .! !!PLC_EditorPOU methodsFor: 'open/close' stamp: 'EricPernia 3/20/2016 19:20'!imageFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	^ 'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , '/GUI_Images/EditorPOU/'. ! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!keyboardFocusMorph		^ keyboardFocusMorph! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!keyboardFocusMorph: anObject		keyboardFocusMorph := anObject! !!PLC_EditorPOU methodsFor: 'pou editor' stamp: 'EricPernia 11/18/2013 14:09'!ladderPouBodyMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: self titleColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: self titleName.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorPOU methodsFor: 'open/close' stamp: 'EricPernia 5/17/2015 19:50'!open	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	^ self openWindow.! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'EricPernia 5/3/2015 05:43'!openConsole! !!PLC_EditorPOU methodsFor: 'commands-varDecls' stamp: 'EricPernia 5/17/2015 20:39'!openVarDeclsEditor 	self closeVarDeclsEditor.	varDeclsEditor ifNil: [ 		self buildVarDeclsEditor 	].			varDeclsEditor open.		^ varDeclsEditor.! !!PLC_EditorPOU methodsFor: 'open/close' stamp: 'EricPernia 5/17/2015 19:56'!openWindow	"Abre la ventana del  Editor. "		view 		ifNil: [ 			^ self buildWindow.		].	^ self resizeAndShowWindow.! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!pou		^ pou! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!pou: anObject		pou := anObject! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 02:57'!pouBodyEditor		^ pouBodyEditor! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!pouBodyEditor: anObject		pouBodyEditor := anObject! !!PLC_EditorPOU methodsFor: 'pou editor' stamp: 'EricPernia 3/16/2016 02:52'!pouNameMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 240@40.	titleMorph backgroundColor: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0) .	titleMorph backgroundBorderWidth: 0.	titleMorph leftMargin: 5.	titleMorph emphasis: 0.	titleMorph textColor: Color black.	titleMorph text: "self pou pouType , ': ' , " self pou identifier.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorPOU methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 23:48'!projectFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ 'D:/Proyecto/Pharo-1.3-13315-OneClick.app/Contents/Resources/PLeriC'."	^ ''.! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'EricPernia 5/17/2015 19:20'!resetPOU 	"Resetea la POU"		IDE4PLC resetPou.	self window close.! !!PLC_EditorPOU methodsFor: 'open/close' stamp: 'EricPernia 5/17/2015 19:55'!resizeAndShowWindow	"Crea la ventana del Editor y agrega los controles"	| aWorld |		view 		ifNotNil: [ 							view updatePaneColors.			view extent: 770@490.			view position: 5@5.						aWorld := Morph new currentWorld. "Esta feo pero funciona"			aWorld addMorph: view.						view activate.						aWorld startSteppingSubmorphsOf: view.		].	^ view.! !!PLC_EditorPOU methodsFor: 'commands' stamp: 'EricPernia 5/7/2015 23:58'!showPOUCode 	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	| configSoft |	configSoft := IDE4PLC createConfigSoftWithPOU: pou.		configSoft cCompile.! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!titleColor		^ titleColor! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!titleColor: anObject		titleColor := anObject! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!titleName		^ titleName! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 14:13'!titleName: anObject		titleName := anObject! !!PLC_EditorPOU methodsFor: 'pou editor' stamp: 'EricPernia 3/20/2016 19:17'!toolbar 	"Genera la fila - Es la barra de herramientas que tiene el tipo de POU y mas botones"		| row |	row := self builder newRow: {					self builder			newButtonFor: self  "if we had a model it would go here"			getState: nil			action: nil			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'POUToolbar/program.png')			help: 'Editor POU -> Toolbar help -> POU Type' translated , 'PROGRAM'.			(self pouNameMorph )			"hResizing: #spaceFill".					self builder			newButtonFor: self 			getState: nil			action: #openVarDeclsEditor			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CommonToolbar/varDeclsEditor.png')			help: 'Editor POU -> Toolbar help -> VAR' translated.		"Pongo un Moprph para que ocupe el lugar de un boton"		( Morph new ) 			extent: 48@40;			color:  (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0).					"self builder			newButtonFor: self 			getState: nil			action: #openConsole			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'console.png')			help: 'Abrir Consola.'."								self builder			newButtonFor: self  			getState: nil			action: #generateProgramCCode			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/genc.png')			help: 'Editor POU -> Toolbar help -> Generate C' translated.					self builder			newButtonFor: self  			getState: nil			action: #buildCProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/build.png')			help: 'Editor POU -> Toolbar help -> Build C' translated.					"self builder			newButtonFor: self  			getState: nil			action: #connectToDevice 			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'connectToDevice.png')			help: 'Conectarse al Dispositivo.'.	"					self builder			newButtonFor: self  			getState: nil			action: #downloadProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/download.png')			help: 'Editor POU -> Toolbar help -> Download' translated.					self builder			newButtonFor: self  			getState: nil			action: #generateCBuildDownloadProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/gencBuildDownload.png')			help: 'Editor POU -> Toolbar help -> Gen Build Download' translated.					self builder			newButtonFor: self  			getState: nil			action: #cleanCProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/clean.png')			help: 'Editor POU -> Toolbar help -> Clean C' translated.					"Pongo un Moprph para que ocupe el lugar de un boton"		( Morph new ) 			extent: 48@40;			color:  (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0).		self builder			newButtonFor: self			getState: nil			action: #addPOUToLibrary			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'FilesToolbar/save.png')			help: 'Editor POU -> Toolbar help -> Save' translated.		self builder			newButtonFor: self  			getState: nil			action: #resetPOU			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'FilesToolbar/delete.png')			help: 'Editor POU -> Toolbar help -> Reset' translated.					}.			row cellInset: 0.		^ row.! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 03:21'!varDeclsEditor		^ varDeclsEditor! !!PLC_EditorPOU methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 03:21'!varDeclsEditor: anObject		varDeclsEditor := anObject! !!PLC_EditorPOUBody class methodsFor: 'instance creation' stamp: 'EricPernia 5/2/2015 05:57'!newWithPOUBody: aPOUBody andColor: aColor andBorderColor: aBorderColor andTitleColor: aTitleColor andTitleName: aTitleName	"Nueva instancia con cierto modelo de cuerpo de pou y colores"	| pouBodyEditor |	"pouBodyEditor es un Controlador"		pouBodyEditor := self new.		"Seteo su Modelo"	pouBodyEditor model: aPOUBody.		"Seteo los colores de su Vista"	pouBodyEditor color: aColor.	pouBodyEditor borderColor: aBorderColor.	pouBodyEditor titleColor: aTitleColor.	"Seteo el titulo de la vista"	pouBodyEditor titleName: aTitleName.		^ pouBodyEditor! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:44'!addCoilPressed	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph keyBPressed			 ]! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:44'!addFunctionBlockPressed	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph keyGPressed			 ]! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:44'!addFunctionPressed	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph keyFPressed			 ]! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 5/3/2015 05:50'!addLadderComponentPressed	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph keyDPressed			 ]	 ! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:44'!addNOContactPressed	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph keyCPressed			]! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/17/2013 17:11'!addNetwork	"Este comando modifica el modelo eliminando la network con el foco del teclado"	pouBody addNetwork		"Falta, tiene que redibujar todo el editor"! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 15:08'!borderColor		^ borderColor! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 15:08'!borderColor: anObject		borderColor := anObject! !!PLC_EditorPOUBody methodsFor: 'ladder editor' stamp: 'EricPernia 3/20/2016 19:22'!buildLadderView	"Construye la vista y se la asigna a su variable de instancia pouBodyView para recordarla"		| controller networkModel ladderView scroller expander controls | 		"Creo la coleccin de controls que despues se pasa a la columna morph como array"	controls := OrderedCollection new.		"Agrego la barra de herramientas"	"controls add: self pouLadderTitle."	controls add: self ladderToolbar.		"Crequeo que haya al menos una network"	( self pouBody networks size > 0 )		ifTrue: [ 			"networkModel es el modelo de network ladder"			networkModel := self pouBody networks at: 1.				"Controlador de la network Ladder"			controller := PLC_LadderController newWithModel: networkModel. 					"Vista de la network Ladder"			ladderView := controller openLadderView.				"Le agrego a la vista de network ladder una referencia a 			este controlador editor de cuerpod e pou"			ladderView editor: self.				"A la primera network le doy el foco del teclado"			self keyboardFocusMorph: ladderView.				"Le creo los scroller al ladderView"			scroller := ( self builder newScrollPaneFor: ladderView ) 				hResizing: #spaceFill; 				vResizing: #spaceFill.			"Le creo el expander sobre los scroller al ladderView"			expander := ( self builder newExpander: 'Editor POU -> Network' translated , ' 1'  for: scroller ) 				spaceFillWeight: 1; 				expanded: true.					"Agrego el expander a la coleccin que forma la columna"			controls add: expander.						]. 			"Repito todos los pasos anteriores para als demas networks salvo que no 	les agrego el foco del teclado ni expando sus expanders"	(2 to: self pouBody networks size) do: [ :index |				"networkModel es el modelo de network ladder"		networkModel := self pouBody networks at: index.				"Controlador de la network Ladder"		controller := PLC_LadderController newWithModel: networkModel. 				"Vista de la network Ladder"		ladderView := controller openLadderView.			"Le agrego a la vista de network ladder una referencia a 		este controlador editor de cuerpod e pou"		ladderView editor: self.				"Le creo los scroller al ladderView"		scroller := ( self builder newScrollPaneFor: ladderView ) 			hResizing: #spaceFill; 			vResizing: #spaceFill.		"Le creo el expander sobre los scroller al ladderView"		expander := ( self builder newExpander: 'Editor POU -> Network' , ' ' , index asString for: scroller ) 			spaceFillWeight: 1; 			expanded: false.							"Agrego el expander a la coleccin que forma la columna"		controls add: expander.		 ].	"Creo la columna morph"	view := self builder newColumn: controls asArray.	"hResizing: #spaceFill;	vResizing: #shrinkWrap;	cellSpacing: 10"		view 		cellInset: 0";		extent: 720 @ 450".								^ view.	! !!PLC_EditorPOUBody methodsFor: 'view' stamp: 'EricPernia 11/17/2013 14:50'!builder	"Devuelve el builder"	^ UITheme builder.! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:44'!closeBranchPressed	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph keyPPressed			]! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 15:08'!color		^ color! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 15:08'!color: anObject		color := anObject! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:44'!deletePressed	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph keyDeletePressed 			]! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:44'!drawGroups	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph drawGroups 			]! !!PLC_EditorPOUBody methodsFor: 'fbd editor' stamp: 'EricPernia 11/17/2013 14:50'!fbdPouBodyEditor	"Devuelve la columna con el editor de lenguaje FBD"		"HACER"! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:45'!generateCode	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph generateCode 			]! !!PLC_EditorPOUBody methodsFor: 'il editor' stamp: 'EricPernia 11/17/2013 14:50'!ilPouBodyEditor	"Devuelve la columna con el editor de lenguaje IL"		"HACER"! !!PLC_EditorPOUBody methodsFor: 'open/close' stamp: 'EricPernia 3/20/2016 19:37'!imageFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	^ 'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , '/GUI_Images/EditorPOU/'. ! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 04:38'!keyboardFocusMorph	"EN ESTE CASO ES UNA NETWORK"		^ keyboardFocusMorph! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 04:37'!keyboardFocusMorph: anObject	keyboardFocusMorph := anObject! !!PLC_EditorPOUBody methodsFor: 'ladder editor' stamp: 'EricPernia 11/17/2013 15:17'!ladderPouBodyMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: self titleColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: self titleName.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorPOUBody methodsFor: 'ladder editor' stamp: 'EricPernia 3/20/2016 19:38'!ladderToolbar 	"Devuelve la barra de herramientas superior de la ventana de edicin de Ladder"	| row |	row := self builder newRow: {					"self builder			newButtonFor: self 			getState: nil			action: #addNetwork			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addNetwork.png')			help: 'Aadir Segmento.'.					self builder			newButtonFor: self			getState: nil			action: #removeNetwork			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'removeNetwork.png')			help: 'Remover Segmento seleccionado.'.	"			self builder			newButtonFor: self "if we had a model it would go here"			getState: nil			action: #addNOContactPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'LadderToolbar/contact.png') 			help: 'Editor POU -> Toolbar help -> Contact' translated.					self builder			newButtonFor: self 			getState: nil			action: #addCoilPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'LadderToolbar/coil.png') 			help: 'Editor POU -> Toolbar help -> Coil C' translated.					self builder			newButtonFor: self 			getState: nil			action: #openBranchPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'LadderToolbar/openBranch.png') 			help: 'Editor POU -> Toolbar help -> Open Branch' translated.					self builder			newButtonFor: self			getState: nil			action: #closeBranchPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'LadderToolbar/closeBranch.png') 			help: 'Editor POU -> Toolbar help -> Close Branch' translated.							self builder			newButtonFor: self			getState: nil			action: #addLadderComponentPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'LadderToolbar/ladderComponent.png') 			help: 'Editor POU -> Toolbar help -> Add Ladder component' translated.					self builder			newButtonFor: self			getState: nil			action: #addFunctionPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'POUToolbar/function.png') 			help: 'Editor POU -> Toolbar help -> Add Function call' translated.					self builder			newButtonFor: self			getState: nil			action: #addFunctionBlockPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'POUToolbar/functionBlock.png') 			help: 'Editor POU -> Toolbar help -> Add Function Block call' translated.					self builder			newButtonFor: self			getState: nil			action: #generateCode			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CompileToolbar/programControl.png') 			help: 'Editor POU -> Toolbar help -> Generate and view Network C code' translated.					self builder			newButtonFor: self			getState: nil			action: #deletePressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CommonToolbar/remove.png') 			help: 'Editor POU -> Toolbar help -> Delete' translated.				}.			row cellInset: 0.		^ row.! !!PLC_EditorPOUBody methodsFor: 'open/close' stamp: 'EricPernia 2/16/2016 01:25'!open	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| window aWorld   |	"Creo la ventana"	window := ( SystemWindow labelled: 'POU Body' ) model: nil.		"Agrego el editor de ladder"	window addMorph: self pouBodyView fullFrame: (		LayoutFrame 			fractions: ( 0@0.4 corner: 1@1 )			offsets: ( 0@0 corner: 1@0 )		).					window updatePaneColors.	window extent: 800@600.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.		"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		" VAR DECLS ES UNA COLUMNA		varDecls := self builder newColumn: {		self variableToolBar. 				self globalVarTitle.		self globalVarTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.		varDecls cellInset: 0;		minHeight: 10;		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10	(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."	"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:45'!openBranchPressed 	"Reenvia el comando correspondiente al boton de la ladderToolBar 	pulsado a la network con foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			self keyboardFocusMorph keyOPressed			] ! !!PLC_EditorPOUBody methodsFor: 'open/close' stamp: 'EricPernia 2/16/2016 01:25'!openWindow	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| window aWorld   |	"Creo la ventana"	window := ( SystemWindow labelled: 'POU Editor' ) model: nil.		"Agrego el editor de variables"	"Agrego el editor de ladder"	window addMorph: self buildLadderView fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@1 )			offsets: ( 0@0 corner: 0@0 )		).					window updatePaneColors.	window extent: 780@490.	window position: 10@10.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 06:04'!pouBody		^ self model! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 05:56'!pouBodyView	"Devuelve una vista de pouBody si no existia la crea"	view ifNil: [ 		( model language = 'LADDER DIAGRAM' )			ifTrue: [ self buildLadderView  ].		"( pouBody language = 'INSTRUCTION LIST' )			ifTrue: [ self buildILView  ].		( pouBody language = '' )			ifTrue: [ self buildStandardView  ]."		].			^view! !!PLC_EditorPOUBody methodsFor: 'ladder editor' stamp: 'EricPernia 11/18/2013 14:51'!pouLadderTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self ladderPouBodyMorph )			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_EditorPOUBody methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 23:48'!projectFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ 'D:/Proyecto/Pharo-1.3-13315-OneClick.app/Contents/Resources/PLeriC'."	^ ''.! !!PLC_EditorPOUBody methodsFor: 'ladder Commands' stamp: 'EricPernia 11/18/2013 04:45'!removeNetwork	"Este comando modifica el modelo eliminando la network con el foco del teclado"	self keyboardFocusMorph 		ifNotNil: [ 			pouBody removeNetwork: self keyboardFocusMorph.			]		"Falta, tiene que redibujar todo el editor"! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 14:59'!titleColor		^ titleColor! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 14:59'!titleColor: anObject		titleColor := anObject! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 14:59'!titleName		^ titleName! !!PLC_EditorPOUBody methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 14:59'!titleName: anObject		titleName := anObject! !!PLC_EditorPOUDeclarations class methodsFor: 'instance creation' stamp: 'EricPernia 11/17/2013 17:58'!newWithPOUDeclarations: aPOUDecls andColor: aColor andBorderColor: aBorderColor andTitleColor: aTitleColor andTitleName: aTitleName	"Nueva instancia con cierto modelo de cuerpo de pou y colores"	| pouDeclsEditor |	"pouDeclsEditor es un Controlador"		pouDeclsEditor := self new.		"Seteo su Modelo"	pouDeclsEditor pouDeclarations: aPOUDecls.		"Seteo los colores de su Vista"	pouDeclsEditor color: aColor.	pouDeclsEditor borderColor: aBorderColor.	pouDeclsEditor titleColor: aTitleColor.	"Seteo el titulo de la vista"	pouDeclsEditor titleName: aTitleName.		^ pouDeclsEditor! !!PLC_EditorPOUDeclarations methodsFor: 'toolbar commands' stamp: 'EricPernia 5/15/2015 21:13'!addButtonPressed	"comment stating purpose of message"	self addDeclaration.! !!PLC_EditorPOUDeclarations methodsFor: 'declarations Commands' stamp: 'EricPernia 5/17/2015 08:55'!addDeclaration	"Este comando modifica el modelo aadiendo una nueva declaracion de variable"	( PLC_VariableDeclController 		newWithModel: pouDeclarations 		andEditor: self ) 			open.! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:50'!borderColor		^ borderColor! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:50'!borderColor: anObject		borderColor := anObject! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor' stamp: 'EricPernia 7/15/2017 18:00'!buildDeclsView	"Construye la vista y se la asigna a su variable de instancia pouDeclarationsView para recordarla"		| scroller gridMorph exp1 exp2 eg1 | 		"scroller := ( self builder newScrollPaneFor: ladderView ) 		hResizing: #spaceFill; 		vResizing: #spaceFill."	"morph1 := (PanelMorph new fillStyle: (SolidFillStyle color: Color red))		hResizing: #spaceFill;		vResizing: #spaceFill."			gridMorph := self interfaceVarsGridMorph.	gridMorph editable: false.	"Hago que no se puedan editar las variables de interfaz"	gridMorph editor: self.	gridMorph controller: self.	gridMorph identifier: 'interfaceVarsGridMorph'.					scroller := ( self builder newScrollPaneFor: gridMorph ) 		hResizing: #spaceFill; 		vResizing: #spaceFill.	exp1 := ( self builder newExpander: 'Editor POU Var Decls -> Expander -> Interface Vars' translated for: scroller ) 		spaceFillWeight: ProportionalSplitterMorph splitterWidth;		expanded: true.		eg1 := EdgeGripMorph new		target: exp1;		edgeName: #bottom;		vResizing: #rigid;		extent: 24 @ 1;		on: #mouseDown send: #expandedSizingRigid to: exp1.					gridMorph := self nonIinterfaceVarsGridMorph.	gridMorph editor: self.	gridMorph controller: self.	gridMorph identifier: 'nonIinterfaceVarsGridMorph'.	self keyboardFocusMorph: gridMorph.			scroller := ( self builder newScrollPaneFor: gridMorph ) 		hResizing: #spaceFill; 		vResizing: #spaceFill.	exp2 := ( self builder newExpander: 'Editor POU Var Decls -> Expander -> Internal and External Vars' translated for: scroller ) 		spaceFillWeight: ProportionalSplitterMorph splitterWidth;		expanded: true.		pouDeclarationsView := self builder 		newColumn: { 			self toolbar.			"self variableToolBar."			exp1. 			eg1. 			exp2.			}.		pouDeclarationsView cellInset: 0;		extent: 732 @ 60.			^ pouDeclarationsView.! !!PLC_EditorPOUDeclarations methodsFor: 'view' stamp: 'EricPernia 11/17/2013 17:50'!builder	"Devuelve el builder"	^ UITheme builder.! !!PLC_EditorPOUDeclarations methodsFor: 'grid controller commands' stamp: 'EricPernia 5/2/2015 16:26'!changeDataTypeIn: varDecl by: aString	"Modifica el tipo de datos de una declaracion de variable del modelo"	"Busco si existe un tipo con el string recibido"	(PLC_DataType dataTypeFromString: aString) 		ifNil: [			^ nil.		]		ifNotNil: [				"Cambio el tipo de datos"			varDecl dataType: (PLC_DataType dataTypeFromString: aString). 				"Refresco el valor inicial"				varDecl initialValue: varDecl dataType initialValue.		].				"Refresco la Vista, primero le cambio su rows por el nuevo contenido"	self refreshKeyboardFocusMorph.! !!PLC_EditorPOUDeclarations methodsFor: 'grid controller commands' stamp: 'EricPernia 5/2/2015 16:27'!changeDescriptionIn: varDecl by: aString	"Modifica la descripcion de una declaracion de variable del modelo"	varDecl description: aString.				"Refresco la Vista, primero le cambio su rows por el nuevo contenido"	self refreshKeyboardFocusMorph.! !!PLC_EditorPOUDeclarations methodsFor: 'grid controller commands' stamp: 'EricPernia 5/2/2015 17:40'!changeIdentifierIn: varDecl by: aString	"Modifica el identifier de una declaracion de variable del modelo"	"Chequea que aString sea un identifier valido y luego lo cambia"	(PLC_Identifier identifierFromString: aString)		ifNil: [			^ nil.				]		ifNotNil: [			varDecl identifier: aString.					].			"Refresco la Vista, primero le cambio su rows por el nuevo contenido"	self refreshKeyboardFocusMorph.! !!PLC_EditorPOUDeclarations methodsFor: 'grid controller commands' stamp: 'EricPernia 5/2/2015 16:24'!changeInitialValueIn: varDecl by: aString	"Modifica el valor inicial de una declaracion de variable del modelo"	"aString Parseado pedorramente - Es true, false o numero"	( varDecl dataType = PLC_DataType Bool )		ifTrue: [			varDecl initialValue: ( 				PLC_Literal 					newWithDataType: varDecl dataType 					andDataValue: 						( ( aString asLowercase = 'true' ) 							or: [ aString asLowercase = '1' ] ) 			).		]		ifFalse: [			(aString isAllDigits)				ifTrue: [					varDecl initialValue: ( 						PLC_Literal 							newWithDataType: varDecl dataType 							andDataValue: aString asNumber					).				].		].				"Refresco la Vista, primero le cambio su rows por el nuevo contenido"	self refreshKeyboardFocusMorph.! !!PLC_EditorPOUDeclarations methodsFor: 'grid controller commands' stamp: 'EricPernia 5/3/2015 04:40'!changeVariableCategoryIn: varDecl by: aString	"Modifica la categoria de variables de una declaracion de variable del modelo"	"aString Parseado pedorramente - Es VAR o VAR_TEMP"	| varCategory |		varCategory := PLC_VariableCategoryDecl	variableCategoryFromString: aString.			"Si no encontro, no hace nada"	varCategory		ifNil: [			^ nil		].		"Si encontro cambia la categoria"	^ nil			"Refresco la Vista, primero le cambio su rows por el nuevo contenido"	"self refreshKeyboardFocusMorph."! !!PLC_EditorPOUDeclarations methodsFor: 'view' stamp: 'EricPernia 11/18/2013 04:56'!clearView	"Elimina la Vista"	pouDeclarationsView := nil.! !!PLC_EditorPOUDeclarations methodsFor: 'open/close' stamp: 'EricPernia 5/17/2015 20:53'!close	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	window 		ifNotNil: [ 			window close.			window := nil.		].! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:50'!color		^ color! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:50'!color: anObject		color := anObject! !!PLC_EditorPOUDeclarations methodsFor: 'toolbar commands' stamp: 'EricPernia 5/15/2015 16:33'!downButtonPressed	"comment stating purpose of message"! !!PLC_EditorPOUDeclarations methodsFor: 'open/close' stamp: 'EricPernia 3/20/2016 19:37'!imageFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	^ 'IDE4PLC_files/Locale/' , 'LanguageImagePath' translated , '/GUI_Images/EditorPOU/'. ! !!PLC_EditorPOUDeclarations methodsFor: 'view' stamp: 'EricPernia 5/2/2015 05:13'!interfaceVarsGridMorph	"Devuelve el morph grid con sus rows"	^ PLC_EditableGrid newWithRows: self interfaceVarsGridMorphRows.! !!PLC_EditorPOUDeclarations methodsFor: 'view' stamp: 'EricPernia 11/18/2013 06:44'!interfaceVarsGridMorphRows	"Devuelve el contenido del gridMorph"		| decls rows col |		rows := OrderedCollection new.	col := OrderedCollection new.		decls := pouDeclarations inputVarDecls.	decls do: [ :decl |		"Junto los valores de columnas de una fila"		col add:  'VAR' , decls varType.		col add: decl identifier.		col add: decl dataType ilCompile.		col add: decl initialValue ilCompile.		col add: decl description.				"Las agrego a la fila"		rows add: col.				"Reseteo la Columna antes de la proxima iteracion"		col := OrderedCollection new.		].		decls := pouDeclarations inOutVarDecls.	decls do: [ :decl |		"Junto los valores de columnas de una fila"		col add:  'VAR' , decls varType.		col add: decl identifier.		col add: decl dataType ilCompile.		col add: decl initialValue ilCompile.		col add: decl description.				"Las agrego a la fila"		rows add: col.				"Reseteo la Columna antes de la proxima iteracion"		col := OrderedCollection new.		].		decls := pouDeclarations outputVarDecls.	decls do: [ :decl |		"Junto los valores de columnas de una fila"		col add:  'VAR' , decls varType.		col add: decl identifier.		col add: decl dataType ilCompile.		col add: decl initialValue ilCompile.		col add: decl description.				"Las agrego a la fila"		rows add: col.				"Reseteo la Columna antes de la proxima iteracion"		col := OrderedCollection new.		].	^ rows.! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 04:36'!keyboardFocusMorph		^ keyboardFocusMorph! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 04:36'!keyboardFocusMorph: anObject		keyboardFocusMorph := anObject! !!PLC_EditorPOUDeclarations methodsFor: 'view' stamp: 'EricPernia 5/2/2015 05:13'!nonIinterfaceVarsGridMorph	"Devuelve el morph grid con sus rows"	^ PLC_EditableGrid newWithRows: self nonIinterfaceVarsGridMorphRows.! !!PLC_EditorPOUDeclarations methodsFor: 'view' stamp: 'EricPernia 8/31/2015 16:15'!nonIinterfaceVarsGridMorphRows	"Devuelve  el contenido del grid morph"		| decls rows col |		rows := OrderedCollection new.	col := OrderedCollection new.		decls := pouDeclarations varDecls.	decls do: [ :decl |		"Junto los valores de columnas de una fila"		"Parche para que no muestre las variables instancia de los FB por ahora"		(decl dataType class = PLC_TypeDecl)			ifFalse: [				col add:  'VAR' , decls varType.				col add: decl identifier.				col add: decl dataType ilCompile.				col add: decl initialValue ilCompile.				col add: decl description.						"Las agrego a la fila"				rows add: col.								"Reseteo la Columna antes de la proxima iteracion"				col := OrderedCollection new.							].				].		decls := pouDeclarations tempVarDecls.	decls do: [ :decl |		"Junto los valores de columnas de una fila"		col add:  'VAR' , decls varType.		col add: decl identifier.		col add: decl dataType ilCompile.		col add: decl initialValue ilCompile.		col add: decl description.				"Las agrego a la fila"		rows add: col.				"Reseteo la Columna antes de la proxima iteracion"		col := OrderedCollection new.		].		decls := pouDeclarations constantVarDecls.	decls do: [ :decl |		"Junto los valores de columnas de una fila"		col add:  'VAR' , decls varType.		col add: decl identifier.		col add: decl dataType ilCompile.		col add: decl initialValue ilCompile.		col add: decl description.				"Las agrego a la fila"		rows add: col.				"Reseteo la Columna antes de la proxima iteracion"		col := OrderedCollection new.		].		decls := pouDeclarations externVarDecls.	decls do: [ :decl |		"Junto los valores de columnas de una fila"		col add:  'VAR' , decls varType.		col add: decl identifier.		col add: decl dataType ilCompile.		col add: decl initialValue ilCompile.		col add: decl description.				"Las agrego a la fila"		rows add: col.				"Reseteo la Columna antes de la proxima iteracion"		col := OrderedCollection new.		].	^ rows.! !!PLC_EditorPOUDeclarations methodsFor: 'open/close' stamp: 'EricPernia 5/2/2015 03:33'!open	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	self openWindow.	" VAR DECLS ES UNA COLUMNA		varDecls := self builder newColumn: {		self variableToolBar. 				self globalVarTitle.		self globalVarTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.		varDecls cellInset: 0;		minHeight: 10;		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10	(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."	"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."! !!PLC_EditorPOUDeclarations methodsFor: 'open/close' stamp: 'EricPernia 5/17/2015 20:53'!openWindow	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| aWorld |	"Creo la ventana"	window := ( SystemWindow labelled: self titleName ) model: nil.		"Agrego el editor de variables"	window addMorph: self buildDeclsView fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@1 )			offsets: ( 0@0 corner: 0@0 )		).					window updatePaneColors.	window extent: 780@490.	window position: 10@10.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:55'!pouDeclarations		^ pouDeclarations! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:54'!pouDeclarations: anObject		pouDeclarations := anObject! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:53'!pouDeclarationsView	"Devuelve una vista de pouBody si no existia la crea"	pouDeclarationsView ifNil: [ 		self buildDeclsView		].			^pouDeclarationsView! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor - style' stamp: 'EricPernia 2/16/2016 23:41'!pouVarMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: PLC_GraphicElementProperties uniqueInstance programHeaderColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: 'Editor POU Var Decls -> Title' translated.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor - style' stamp: 'EricPernia 11/18/2013 04:48'!pouVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self pouVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.	! !!PLC_EditorPOUDeclarations methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 23:48'!projectFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ 'D:/Proyecto/Pharo-1.3-13315-OneClick.app/Contents/Resources/PLeriC'."	^ ''.! !!PLC_EditorPOUDeclarations methodsFor: 'declarations Commands' stamp: 'EricPernia 5/17/2015 08:56'!refresh	"Refresco la grilla"		self refreshKeyboardFocusMorph.! !!PLC_EditorPOUDeclarations methodsFor: 'declarations Commands' stamp: 'EricPernia 11/18/2013 07:11'!refreshKeyboardFocusMorph	"Refresco la Vista, primero le cambio su rows por el nuevo contenido"	(self keyboardFocusMorph identifier = 'interfaceVarsGridMorph')			ifTrue: [ 			self keyboardFocusMorph  rows: self interfaceVarsGridMorphRows.			]		ifFalse: [ 			self keyboardFocusMorph  rows: self nonIinterfaceVarsGridMorphRows.				].		self keyboardFocusMorph refresh.! !!PLC_EditorPOUDeclarations methodsFor: 'toolbar commands' stamp: 'EricPernia 5/15/2015 21:33'!removeButtonPressed	"comment stating purpose of message"		self removeDeclaration! !!PLC_EditorPOUDeclarations methodsFor: 'declarations Commands' stamp: 'CarlosLombardi 10/2/2016 20:15'!removeDeclaration	"Este comando modifica el modelo eliminando la declaracion de variable seleccionada"	| decl identfier row |	 ( self keyboardFocusMorph selectedIndex > 0 )		ifTrue: [ 					row := self keyboardFocusMorph morphsAt:  				self keyboardFocusMorph selectedIndex.							row 				ifNil: [ 					self keyboardFocusMorph selectedIndex: 0.				] 				ifNotNil: [ 					identfier := ( row at: 2) text.				] .							decl := pouDeclarations varDeclWithIdentifierOrNIl: identfier.			decl				ifNil: [					GrowlMorph 						openWithLabel: 'Editor POU Var Decls -> GrowlMorph -> Remove err1' translated						contents: 'Editor POU Var Decls -> GrowlMorph -> Remove err1 help' translated.							]				ifNotNil: [					"Remueve una declaracion de variable."					( (pouDeclarations varDecls remove: decl) isNil 						and: [ (pouDeclarations tempVarDecls remove: decl) isNil ] 					) 						ifTrue: [							GrowlMorph 								openWithLabel: 'Editor POU Var Decls -> GrowlMorph -> Remove err2' translated								contents: decl identifier.									]						ifFalse: [							"Refresco la grilla"							self refreshKeyboardFocusMorph.							GrowlMorph 								openWithLabel: 'Editor POU Var Decls -> GrowlMorph -> Remove err3' translated								contents: decl identifier.									].					].		]		ifFalse: [ 					self keyboardFocusMorph selectedIndex: 0.		].	! !!PLC_EditorPOUDeclarations methodsFor: 'grid controller commands' stamp: 'EricPernia 5/2/2015 16:24'!textChangedInView: aPoint by: aString	"Recivo de la vista (gridMorph) un punto (fila@columna) y el texto para  modificar el modelo"	| gridRowNumber gridColNumber decls |	gridRowNumber := aPoint x.	gridColNumber := aPoint y.		decls := OrderedCollection new.		"Aca decido si es el grid de las variables de interfaz o el otro.	Y agrego a la OC decls todas las declaraciones de variables en 	el mismo orden que estan en los grid."	(self keyboardFocusMorph identifier = 'interfaceVarsGridMorph')			ifTrue: [ 			decls addAll: pouDeclarations inputVarDecls.			decls addAll: pouDeclarations inOutVarDecls.			decls addAll: pouDeclarations outputVarDecls.			]		ifFalse: [ 			decls addAll: pouDeclarations varDecls.			decls addAll: pouDeclarations tempVarDecls.			decls addAll: pouDeclarations constantVarDecls.				decls addAll: pouDeclarations externVarDecls.						].		"Aca habra que cambiar la categora"	(gridColNumber = 1)		ifTrue: [ 			self changeVariableCategoryIn: ( decls at: gridRowNumber ) by: aString.		].		"Aca habra que cambiar el nombre"	(gridColNumber = 2)		ifTrue: [ 			self changeIdentifierIn: ( decls at: gridRowNumber ) by: aString.		].	"Aca habra que cambiar el Tipo"	(gridColNumber = 3)		ifTrue: [ 			self changeDataTypeIn: ( decls at: gridRowNumber ) by: aString.		].	"Aca habra que cambiar el Valor Inicial"	(gridColNumber = 4)		ifTrue: [ 			self changeInitialValueIn: ( decls at: gridRowNumber ) by: aString.		].		"Aca habra que cambiar la Descripcin"	(gridColNumber = 5)		ifTrue: [ 			self changeDescriptionIn: ( decls at: gridRowNumber ) by: aString.		].! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:50'!titleColor		^ titleColor! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:50'!titleColor: anObject		titleColor := anObject! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:50'!titleName		^ titleName! !!PLC_EditorPOUDeclarations methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 17:50'!titleName: anObject		titleName := anObject! !!PLC_EditorPOUDeclarations methodsFor: 'open/close' stamp: 'EricPernia 3/20/2016 19:17'!toolbar 	"Genera la fila - Es la barra de herramientas que tiene el tipo de POU y mas botones"		| row |	row := self builder newRow: {					self builder			newButtonFor: self  "if we had a model it would go here"			getState: nil			action: nil			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'POUToolbar/program.png')			help: 'Editor POU Var Decls -> Toolbar help -> POU Type' translated , 'PROGRAM'.			(self varDeclsNameMorph )			"hResizing: #spaceFill".		"Pongo un Moprph para que ocupe el lugar del boton up"		( Morph new ) 			extent: 44@40;			color: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0).					"Pongo un Moprph para que ocupe el lugar del boton down"		( Morph new ) 			extent: 44@40;			color: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0).			"		self builder			newButtonFor: self 			getState: nil			action: #upButtonPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'up.png')			help: 'Mover declaracin hacia arriba.'.					self builder			newButtonFor: self 			getState: nil			action: #downButtonPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'down.png')			help: 'Mover declaracin hacia abajo.'."								self builder			newButtonFor: self  			getState: nil			action: #addButtonPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CommonToolbar/add.png')			help: 'Editor POU Var Decls -> Toolbar help -> Add' translated.					self builder			newButtonFor: self  			getState: nil			action: #removeButtonPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'CommonToolbar/remove.png')			help: 'Editor POU Var Decls -> Toolbar help -> Remove' translated.		}.			row cellInset: 0.		^ row.! !!PLC_EditorPOUDeclarations methodsFor: 'toolbar commands' stamp: 'EricPernia 5/15/2015 16:33'!upButtonPressed	"comment stating purpose of message"! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor' stamp: 'EricPernia 5/15/2015 15:26'!varDeclsNameMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 510@40.	titleMorph backgroundColor: (Color r: 187 / 255 g: 189 / 255 b: 191 / 255 alpha: 1.0) .	titleMorph backgroundBorderWidth: 0.	titleMorph leftMargin: 5.	titleMorph emphasis: 0.	titleMorph textColor: Color black.	titleMorph text: "'MAIN_PROG'.  "     self pouDeclarations pouDecl identifier.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor - style' stamp: 'EricPernia 11/17/2013 17:59'!varTitleColor	"Genera la fila"		^ Color gray.! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor - style' stamp: 'EricPernia 11/17/2013 17:59'!varTitleEmphasis	""		^ 0.! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor - style' stamp: 'EricPernia 11/17/2013 17:59'!varTitlesColor	"Color"		^ PLC_GraphicElementProperties uniqueInstance rowColorHeader.! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor - style' stamp: 'EricPernia 11/17/2013 17:59'!varTitlesEmphasis	""		^ 1.! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor - events' stamp: 'EricPernia 11/17/2013 17:59'!variableSelectedIndex	^ selectedVariableIndex ifNil: [selectedVariableIndex := 0]! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor - events' stamp: 'EricPernia 11/17/2013 17:59'!variableSelectedIndex: aSmallInteger 	selectedVariableIndex := aSmallInteger.	self 		changed: #variableSelectedIndex;  		changed: #hasSelectedVariable		! !!PLC_EditorPOUDeclarations methodsFor: 'variable editor' stamp: 'EricPernia 2/16/2016 23:52'!variableToolBar	"Genera la fila"	^ self builder newRow: {		self builder newButtonFor: self 			action: #addDeclaration			label: 'Editor POU Var Decls -> Toolbar -> Add' translated			help: 'Editor POU Var Decls -> Toolbar help2 -> Add' translated.						self builder newButtonFor: self 			action: #removeDeclaration				label: 'Editor POU Var Decls -> Toolbar -> Remove' translated			help: 'Editor POU Var Decls -> Toolbar help2 -> Remove' translated.		}.! !!PLC_LadderController class methodsFor: 'instance creation' stamp: 'EricPernia 5/2/2015 02:12'!newWithModel: aLadderNetwork	"Crea una nueva instancia de controlador de MVC con 	el modelo de bloques conectables asociado"	| controller |		"Creo un controlador Ladder"	controller := self new.		"Le agrego el modelo"	controller ladderNetwork: ( aLadderNetwork ifNil: [ PLC_LadderNetwork new. ] ) .		"Le agrego el controlador al modelo"	controller ladderNetwork networkController: controller.		^ controller.	! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:20'!addCoilOn: aConnectableBlockOrConnection	"Agrega una Bobina sobre el elemento que tenga el foco del teclado."		| connection element |		"Creo el elemento"	element := PLC_Element Coil.		"Busco la conexion donde voy a aadir el elemento"	connection := aConnectableBlockOrConnection connectionToAddElement: element.	"Crea y aade una Bobina en el modelo." 		self ladderNetwork addCoil: element onConnection: connection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/19/2013 00:30'!addFunctionBlockCallWithDeclaration: functionBlockDeclaration on: aConnectableBlockOrConnection	"Agrega una Llamada a Funcin sobre el elemento que tenga el foco del teclado."		| connection element |		"Creo el elemento"	element := PLC_GraphicFunctionBlockCall		newWithDeclaration: functionBlockDeclaration 		andNetwork: self ladderNetwork.		"Busco la conexion donde voy a aadir el elemento"	connection := aConnectableBlockOrConnection connectionToAddElement: element.	"Crea y aade una Llamada a Funcin en el modelo." 		self ladderNetwork addFunctionBlockCall: element onConnection: connection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/19/2013 00:30'!addFunctionCallWithDeclaration: functionDeclaration on: aConnectableBlockOrConnection	"Agrega una Llamada a Funcin sobre el elemento que tenga el foco del teclado."		| connection element |		"Creo el elemento"	element := PLC_GraphicFunctionCall		newWithDeclaration: functionDeclaration 		andNetwork: self ladderNetwork.				"Busco la conexion donde voy a aadir el elemento"	connection := aConnectableBlockOrConnection connectionToAddElement: element.	"Crea y aade una Llamada a Funcin en el modelo." 		self ladderNetwork addFunctionCall: element onConnection: connection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 5/3/2015 06:48'!addLadderComponent: aPLC_ElementContactOrCoil on: aConnectableBlockOrConnection	"Agrega un Contacto o Bobina sobre el elemento que tenga el foco del teclado."			| connection element |		element := aPLC_ElementContactOrCoil.				"Busco la conexion donde voy a aadir el elemento"	connection := aConnectableBlockOrConnection connectionToAddElement: element.	"Crea y aade un Contacto o Bobina en el modelo." 		self ladderNetwork addLadderComponent: element onConnection: connection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:20'!addNCContactOn: aConnectableBlockOrConnection	"Agrega un Contacto normal cerrado sobre el elemento que tenga el foco del teclado."		| connection element |		"Creo el elemento"	element := PLC_Element NCContact.		"Busco la conexion donde voy a aadir el elemento"	connection := aConnectableBlockOrConnection connectionToAddElement: element.	"Crea y aade un Contacto en el modelo." 		self ladderNetwork addContact: element onConnection: connection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:20'!addNCoilOn: aConnectableBlockOrConnection	"Agrega una Bobina negada sobre el elemento que tenga el foco del teclado."		| connection element |		"Creo el elemento"	element := PLC_Element NCoil.		"Busco la conexion donde voy a aadir el elemento"	connection := aConnectableBlockOrConnection connectionToAddElement: element.	"Crea y aade una Bobina en el modelo." 		self ladderNetwork addCoil: element onConnection: connection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:20'!addNOContactOn: aConnectableBlockOrConnection	"Agrega un Contacto normal abierto sobre el elemento que tenga el foco del teclado."		| connection element |		"Creo el elemento"	element := PLC_Element NOContact.		"Busco la conexion donde voy a aadir el elemento"	connection := aConnectableBlockOrConnection connectionToAddElement: element.	"Crea y aade un Contacto en el modelo." 		self ladderNetwork addContact: element onConnection: connection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/18/2013 18:27'!changeActualArgumentFor: aPLC_ConnectableBlock by: aString	"Cambia el Actual Argument. "			( self ladderNetwork changeActualArgumentFor: aPLC_ConnectableBlock by: aString )		ifTrue: [			"Refresca la vista"			self ladderView refresh.			].	! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:21'!closeBranchFrom: aPLC_ConnectableBlockOrConnection to: aPLC_Connection	"Cierra una rama entre una conexion o bloque y otra conexion si se puede."	"Abre una rama sobre la conexion aConnection en el modelo." 		self ladderNetwork closeBranchFrom: aPLC_ConnectableBlockOrConnection to: aPLC_Connection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 01:43'!controller	^ self ladderController! !!PLC_LadderController methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 13:54'!generateCodeIn: aProgramAccumulator	"Compila su programa a objetos que lo forman. Estos pueden dar su cdigo C o IL."	self ladderNetwork generateCodeIn: aProgramAccumulator.! !!PLC_LadderController methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:44'!ladderNetwork	^ self model! !!PLC_LadderController methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:44'!ladderNetwork: anObject	self model: anObject! !!PLC_LadderController methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:43'!ladderView	^ self view! !!PLC_LadderController methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:43'!ladderView: anObject	self view: anObject! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:21'!openBranchOnConnection: aConnection	"Abre una rama sobre una conexion (==)."	"Abre una rama sobre la conexion aConnection en el modelo." 		self ladderNetwork openBranchOnConnection: aConnection.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'ladderView' stamp: 'EricPernia 5/2/2015 01:01'!openLadderView	"comment stating purpose of message"	"Creo una vista ladder y se la agrego al controlador"	self ladderView: (		PLC_LadderView newWithController: self	).	"Retorna el ladderView"	^ self ladderView.! !!PLC_LadderController methodsFor: 'ladderView' stamp: 'EricPernia 3/29/2013 04:54'!refreshView	"comment stating purpose of message"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:21'!removeCoil: aCoil	"Remueve un Bobina."	"Remueve una Bobina en el modelo." 		self ladderNetwork removeCoil: aCoil.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:21'!removeContact: aContact	"Remueve un Contacto."	"Remueve un Contacto en el modelo." 		self ladderNetwork removeContact: aContact.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:21'!removeFunctionCall: aFunctionCallConnectableBlock	"Remueve un llamado a Funcin."	"Remueve un llamado a Funcin en el modelo." 		self ladderNetwork removeFunctionCall: aFunctionCallConnectableBlock.		"Refresca la vista"	self ladderView refresh.! !!PLC_LadderController methodsFor: 'commands recive from View' stamp: 'EricPernia 11/5/2013 13:22'!removeRightPowerRail: aPLC_ConnectableBlockRPR	"Remueve un Right Power Rail."	"Remueve si es posible el Right Power Rail aPLC_ConnectableBlockRPR en el modelo." 		self ladderNetwork removeRightPowerRail: aPLC_ConnectableBlockRPR.		"Refresca la vista"	self ladderView refresh.! !!PLC_ListSelector class methodsFor: 'example' stamp: 'EricPernia 11/17/2013 02:02'!example	"an example"	| selector |	selector := self new.	selector openAt: 100@200.		^ selector.		"Con estas dos lineas abris una ventanita para elegir la funcion. Ya se, esta muy feo, 	 fijate si te sale rapido ponerlo mas bonito, si no ya fue"		"En el metodo buildView tenes los detalles de que Morph son: fijate que es un morph externo que incluye	 dos morphs internos. Las posiciones de los internos estan puestas a mano respecto del de afuera.	  Fijate que poniendole la posicion al morph de afuera, los de adentro se acomodan solitos.	 Tal vez haya algo mas cheto, pero yo no lo conozco."		"fijate en el metodo processFunctionSelection, ahi tenes que reemplazar el mensaje 	  por lo que tengas que hacer para agregar una funcion en el segmento actual.	  El metodo selectedFunction devuelve la instancia de PLC_Function correspondiente 	a la funcion elegida"! !!PLC_ListSelector class methodsFor: 'instance creation' stamp: 'EricPernia 11/17/2013 02:08'!newWithLibrary: aDictionary	"Nueva instancia con cierta biblioteca"	| listSelector |		listSelector := self new.		listSelector borderColor: Color green.	listSelector color: Color green twiceLighter.		listSelector library: aDictionary.			listSelector openAt: 100@200.			^ listSelector! !!PLC_ListSelector class methodsFor: 'instance creation' stamp: 'EricPernia 11/17/2013 04:07'!newWithLibrary: aDictionary andColor: aColor andBorderColor: aBorderColor	"Nueva instancia con cierta biblioteca"	| listSelector |		listSelector := self new.		listSelector color: aColor.	listSelector borderColor: aBorderColor.		listSelector library: aDictionary.		^ listSelector! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 02:02'!borderColor		^ borderColor! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 02:02'!borderColor: anObject		borderColor := anObject! !!PLC_ListSelector methodsFor: 'list' stamp: 'EricPernia 2/15/2016 02:42'!buildView	"build and remenber my internal view"	| builder lista boton1 boton2 | 	builder := UITheme builder.	view := BorderedMorph new.	view 		borderWidth: 2;		position: 100@300;		color: self color;		borderColor: self borderColor."list : (PLC_Function StdFunctions keys asArray))"	"lista := builder 			newListFor: (ListModel new list: self library keys asArray)			list: #list			selected: #selectionIndex			changeSelected: #selectionIndex:			getEnabled: nil			help: 'Elegir el elemento a insetar'."	"Esto era para Pharo 2.0, eb Pharo 3.0 cambian los nombres de los mtodos de ListModel"				lista := builder 			newListFor: (ListModel new items: self library keys asArray) "Podria pasarle un ListModel guardado en una var"			list: #getList			selected: #getIndex			changeSelected: #setSelectedIndex:			getEnabled: nil			help: 'List Selector -> Select an element' translated.					lista 		position: (view position+(5@5));		name: 'functionList';		height: 200;		width: 180.	boton1 := builder			newButtonFor: self 			action: #processFunctionSelection			label: 'List Selector -> Select' translated			help: 'List Selector -> Select help' translated.				boton1 		position: (view position + (-5 @ lista height + 20));		setNameTo: #selectButton.	" (48@listinha height + 20));"	boton2 := builder			newButtonFor: self 			action: #cancel			label: 'List Selector -> Cancel' translated			help: 'List Selector -> Cancel help' translated.	boton2 		position: (view position + (78@lista height + 20));		setNameTo: #selectButton.	view extent: ((lista width + 10)@(lista height + boton1 height + 30)).	view addMorphBack: lista.	view addMorphBack: boton1.	view addMorphBack: boton2.! !!PLC_ListSelector methodsFor: 'list' stamp: 'EricPernia 11/17/2013 02:02'!cancel	"Cierra la ventana"	self view delete.! !!PLC_ListSelector methodsFor: 'list' stamp: 'EricPernia 11/17/2013 02:02'!clearView	"Elimina la Vista"	view := nil.! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 02:02'!color		^ color! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 02:02'!color: anObject		color := anObject! !!PLC_ListSelector methodsFor: 'list' stamp: 'EricPernia 11/17/2013 02:02'!functionListPanel	"the morph rendering the function list"	^self view submorphs detect: [ :morph | morph externalName = 'functionList' ].! !!PLC_ListSelector methodsFor: 'initialize-release' stamp: 'EricPernia 11/17/2013 02:04'!initialize	"Inicializa"	"view := nil."! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:40'!library		^ self model! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 5/2/2015 04:40'!library: anObject		self model: anObject! !!PLC_ListSelector methodsFor: 'list' stamp: 'EricPernia 1/11/2015 06:02'!openAt: somePosition	"my view"	self functionListPanel model setSelectedIndex: 1. 	"self functionListPanel model selectionIndex: 1."   "Pharo 2.0, en Pharo 3.0 cambiaron el ListModel"	self view 		position: somePosition;		openInWorld.	self functionListPanel takeKeyboardFocus.! !!PLC_ListSelector methodsFor: 'list' stamp: 'EricPernia 2/15/2016 02:25'!processFunctionSelection	"process the fac that the user has made a selection on the function list"	self selectedFunction 		ifNil: [ 			UITheme builder message: 'List Selector -> Not selected accept' translated.			]		ifNotNil: [ 			"UITheme builder message: 				('El elemento seleccionado es ', self selectedFunction cPOUName , '.' ).				  self view delete. "							"Target es el objeto al que le mando el resultado de la seleccion en el 			list, por ejemplo, un ladderView que le mando una funcion elegida para 			que se inserte"				self target 				perform: self targetMessage 				with: self selectedFunction.							self cancel.			]! !!PLC_ListSelector methodsFor: 'list' stamp: 'EricPernia 11/17/2013 02:14'!selectedFunction	"the function currently selected, an instance of PLC_Function"	^self functionListPanel model selectedItem		ifNil: [ nil ]		ifNotNil: [ self library at: (self functionListPanel model selectedItem) ]! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:40'!target	"Aca guarda el objeto destino a quien tiene que devolverle el item seleccionado"		^ target! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:39'!target: anObject		target := anObject! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:41'!targetMessage	"Aca guarda el lemsaje que le tiene que mandar objeto destino a quien tiene que devolverle el item seleccionado"		^ targetMessage! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:39'!targetMessage: anObject		targetMessage := anObject! !!PLC_ListSelector methodsFor: 'list' stamp: 'EricPernia 11/17/2013 02:02'!view	"my view"	view ifNil: [ self buildView ].	^view! !!PLC_ListSelector methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 02:02'!view: anObject		view := anObject! !!PLC_VariableDeclController class methodsFor: 'instance creation' stamp: 'EricPernia 5/17/2015 08:54'!newWithModel: aModel andEditor: anEditor	"Crea una nueva instancia de controlador de MVC con el modelo y vista asociados"	| controller |		"Creo un controlador Ladder"	controller := self new.		"Le agrego el modelo"	controller model: aModel.		"Le agrego el editor"	controller editor: anEditor.		^ controller.	! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 5/17/2015 07:52'!buildButtons	"Crea los botones aceptar y cancelar"	self dialog buttons: {		self okButton.		self cancelButton.	}.! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 5/17/2015 07:52'!buildVarDeclContent	"Crea el contenido del dialogo var decls"	self dialog contentMorph: (( self dialog newRow: {		self dialog newLabelGroup: {			self varDeclsCategory.				self varDeclsIdentifier.				self varDeclsDataType.				"self varDeclsAddress."			"self varDeclsInitialValue.			self varDeclsDescription."			}		}	)	vResizing: #spaceFill).! !!PLC_VariableDeclController methodsFor: 'commands recived from dialog' stamp: 'EricPernia 5/17/2015 07:31'!cancel	"llega cuando apretan Cancelar en el dialog"	self close.! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/16/2016 02:01'!cancelButton	"Devuelve el boton Cancelar"		^ self dialog 		newButtonFor: self 		action: #cancel 		label: 'Editor POU Var Decls -> Cancel Button' translated		help: 'Editor POU Var Decls -> Cancel Button help' translated.! !!PLC_VariableDeclController methodsFor: 'open/close' stamp: 'EricPernia 5/17/2015 07:53'!close	"llega cuando apretan Cancelar en el dialog"	self dialog model: nil.		self dialog close.		self dialog: nil.! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 5/17/2015 07:54'!createDialogWithTitle: aTitle	"Crea el dialogo y le asigna un titulo"		| builder | 	builder := UITheme builder.	self dialog: ( builder newPluggableDialogWindow: aTitle ).	! !!PLC_VariableDeclController methodsFor: 'accessing' stamp: 'EricPernia 5/17/2015 07:51'!dialog		^ self view! !!PLC_VariableDeclController methodsFor: 'accessing' stamp: 'EricPernia 5/17/2015 07:52'!dialog: anObject		view := anObject! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 5/17/2015 09:12'!dictionary	| dic |		dic := Dictionary new.	dic at: 'VAR' put: #varDecls.	dic at: 'VAR_TEMP' put: #tempVarDecls.	dic  at: 'BOOL' put: PLC_DataType Bool.	dic  at: 'INT' put: PLC_DataType Int.	dic  at: 'TIME' put: PLC_DataType Time.	^ dic.! !!PLC_VariableDeclController methodsFor: 'accessing' stamp: 'EricPernia 5/17/2015 08:52'!editor		^ editor! !!PLC_VariableDeclController methodsFor: 'accessing' stamp: 'EricPernia 5/17/2015 08:52'!editor: anObject		editor := anObject! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 5/17/2015 09:27'!getCategorySelector	"Devuelve el nombre del metodo a ser ejecutado por perform"	^ self dictionary at: category selectedItem.! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 5/17/2015 09:28'!getDataType	^ self dictionary at: dataType selectedItem.! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/16/2016 02:04'!getIdentifier	( PLC_Identifier identifierFromString: identifier contents )		ifNil: [			GrowlMorph 				openWithLabel: 'Editor POU Var Decls -> GrowlMorph -> Identifier error -> title' translated				contents: 'Editor POU Var Decls -> GrowlMorph -> Identifier error' translated.			^ nil.				]		ifNotNil: [			^ identifier contents.			].! !!PLC_VariableDeclController methodsFor: 'commands recived from dialog' stamp: 'CarlosLombardi 10/2/2016 20:16'!ok	"llega cuando apretan Aceptar en el dialog""	Transcript open.		Transcript show: category selectedItem.	Transcript show: ''.	Transcript show: identifier contents.	Transcript show: ''.	Transcript show: dataType selectedItem."		"Chequeo que tenga un modelo"	( self varDecls ) 		ifNotNil: [									(self varDecls varDeclWithIdentifierOrNIl: self getIdentifier)				ifNil: [					"Agrego una declaracion de variable 					Cuando hace add le agrega su categora automaticamente"					( self varDecls perform: self getCategorySelector )						add: ( 							PLC_SymbolicVariableDecl 								newWithDataType: self getDataType								andInitialValue: nil 								andIdentifier: self getIdentifier						).						"Refresco la grilla"					self editor refreshKeyboardFocusMorph.				]				ifNotNil: [					GrowlMorph 						openWithLabel: 'Editor POU Var Decls -> GrowlMorph -> Identifier error 2 -> title' translated						contents: 'Editor POU Var Decls -> GrowlMorph -> Identifier error 2' translated.				].								].		self close.! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/16/2016 02:02'!okButton	"Devuelve el boton Aceptar"		^ self dialog 		newButtonFor: self 		action: #ok 		label: 'Editor POU Var Decls -> Ok Button' translated		help: 'Editor POU Var Decls -> Ok Button help' translated.! !!PLC_VariableDeclController methodsFor: 'open/close' stamp: 'EricPernia 5/17/2015 06:23'!open	"Abre la ventana"	^ self openWindow.! !!PLC_VariableDeclController methodsFor: 'open/close' stamp: 'EricPernia 2/16/2016 02:07'!openWindow	"DIALOGO DE DECLARACION DE VARIABLE"	| builder |	builder := UITheme builder.		self createDialogWithTitle: 'Editor POU Var Decls -> Dialog -> Title' translated.	self buildButtons.	self buildVarDeclContent.		self dialog model: self.		builder openModal: self dialog.! !!PLC_VariableDeclController methodsFor: 'accessing' stamp: 'EricPernia 5/17/2015 08:25'!varDecls		^ self model! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/16/2016 02:09'!varDeclsAddress	"Crea el campo Direccion del dialogo"	address := ValueHolder new contents: ''.	^ 'Editor POU Var Decls -> Dialog -> Address' translated -> ( self dialog 		newTextEntryFor: address 		getText: #contents 		setText: #contents: 		help: 'Editor POU Var Decls -> Dialog -> Address help' translated	).! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/17/2016 00:10'!varDeclsCategory	"Crea el campo Categoria de variables del dialogo"	category := ( ListModel new 		items: #(			'VAR' 			'VAR_TEMP'		);		setSelectedIndex: 1	).	^ 'Editor POU Var Decls -> Dialog -> Category' translated -> ( self dialog newDropListFor: category				list: #getList		getSelected: #getIndex 		setSelected: #setSelectedIndex:		"list: #list		getSelected: #selectionIndex 		setSelected: #selectionIndex: "		help: 'Editor POU Var Decls -> Dialog -> Category help' translated	).! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/16/2016 02:12'!varDeclsDataType	"Crea el campo Tipo de Datos del dialogo"	dataType := ( ListModel new 		items: #(			'BOOL' 			'INT'			'TIME' 		);		setSelectedIndex: 1	).	^ 'Editor POU Var Decls -> Dialog -> Datatype' translated -> ( self dialog newDropListFor: dataType		list: #getList		getSelected: #getIndex		setSelected: #setSelectedIndex:		help: 'Editor POU Var Decls -> Dialog -> Datatype help' translated	).	! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/16/2016 01:55'!varDeclsDescription	"Crea el campo Descripcion del dialogo"	description := ValueHolder new contents: ''.	^ 'Editor POU Var Decls -> Dialog -> Description' translated -> ( self dialog 		newTextEntryFor: description 		getText: #contents 		setText: #contents: 		help: 'Editor POU Var Decls -> Dialog -> Description help' translated	).! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/17/2016 00:12'!varDeclsIdentifier	"Crea el campo Nombre del dialogo"	| pluggableTextFieldMorph |	identifier := ValueHolder new contents: 'Editor POU Var Decls -> Dialog -> id' translated.	pluggableTextFieldMorph := self dialog 		newTextEntryFor: identifier 		getText: #contents 		setText: #contents:		help: 'Editor POU Var Decls -> Dialog -> Identifier help' translated.	pluggableTextFieldMorph autoAccept: true.	^ 'Editor POU Var Decls -> Dialog -> Identifier' translated -> ( pluggableTextFieldMorph ).! !!PLC_VariableDeclController methodsFor: 'var decls dialog' stamp: 'EricPernia 2/16/2016 02:15'!varDeclsInitialValue	"Crea el campo Valor inicial del dialogo"	initialValue := ValueHolder new contents: ''.	^ 'Editor POU Var Decls -> Dialog -> Initial Value' translated -> ( self dialog 		newTextEntryFor: initialValue 		getText: #contents 		setText: #contents: 		help: 'Editor POU Var Decls -> Dialog -> Initial Value help' translated	).	! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/14/2016 23:29'!allDevices	"Returns a device Dictionary"	| dic dev |		dic := Dictionary new.		"EDU-CIAA-NXP"	dev := self eduCiaaNxp.	dic at: dev deviceName put: dev.		"CIAA-NXP"	dev := self ciaaNxp.	dic at: dev deviceName put: dev.		^ dic.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/19/2016 01:00'!cCodeForCiaaNxpProgDeclInputs	"PARCHE - Devuelve el codigo C para las IO de la placa"		| code |	code := '   MAIN_PROG_BOOL_VAR.I0 = I0.X.x0;   MAIN_PROG_BOOL_VAR.I1 = I0.X.x1;   MAIN_PROG_BOOL_VAR.I2 = I0.X.x2;   MAIN_PROG_BOOL_VAR.I3 = I0.X.x3;   MAIN_PROG_BOOL_VAR.I4 = I0.X.x4;   MAIN_PROG_BOOL_VAR.I5 = I0.X.x5;   MAIN_PROG_BOOL_VAR.I6 = I0.X.x6;   MAIN_PROG_BOOL_VAR.I7 = I0.X.x7;'.	^ code.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/19/2016 01:00'!cCodeForCiaaNxpProgDeclOutputs	"PARCHE - Devuelve el codigo C para las IO de la placa"		| code |	code := '   Q0.X.x0 = MAIN_PROG_BOOL_VAR.Q0;   Q0.X.x1 = MAIN_PROG_BOOL_VAR.Q1;   Q0.X.x2 = MAIN_PROG_BOOL_VAR.Q2;   Q0.X.x3 = MAIN_PROG_BOOL_VAR.Q3;   Q0.X.x4 = MAIN_PROG_BOOL_VAR.Q4;   Q0.X.x5 = MAIN_PROG_BOOL_VAR.Q5;   Q0.X.x6 = MAIN_PROG_BOOL_VAR.Q6;   Q0.X.x7 = MAIN_PROG_BOOL_VAR.Q7;'.	^ code.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/19/2016 01:01'!cCodeForEduCiaaNxpProgDeclInputs	"PARCHE - Devuelve el codigo C para las IO de la placa"		| code |	code := '   MAIN_PROG_BOOL_VAR.TEC1 = !!I0.X.x0;   MAIN_PROG_BOOL_VAR.TEC2 = !!I0.X.x1;   MAIN_PROG_BOOL_VAR.TEC3 = !!I0.X.x2;   MAIN_PROG_BOOL_VAR.TEC4 = !!I0.X.x3;'.	^ code.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/17/2016 03:09'!cCodeForEduCiaaNxpProgDeclOutputs	"PARCHE - Devuelve el codigo C para las IO de la placa"		| code |	code := '   Q0.X.x0 = MAIN_PROG_BOOL_VAR.LEDR;   Q0.X.x1 = MAIN_PROG_BOOL_VAR.LEDG;   Q0.X.x2 = MAIN_PROG_BOOL_VAR.LEDB;   Q0.X.x3 = MAIN_PROG_BOOL_VAR.LED1;   Q0.X.x4 = MAIN_PROG_BOOL_VAR.LED2;   Q0.X.x5 = MAIN_PROG_BOOL_VAR.LED3;'.	^ code.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/17/2016 02:48'!changeCurrentDevice: aPLC_DevicePLC	"Returns current selected board"		current := aPLC_DevicePLC.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 9/2/2015 01:58'!ciaaNxp	"Devuelve una instancia de dispositivo CIAA-NXP"	| devicePLC |		devicePLC := self new.		devicePLC deviceName: 'CIAA-NXP'.	devicePLC cpu: PLC_CPU nxpLpc4337.			"Entradas Digitales"		devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 0 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 1 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 2 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 3 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 4 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 5 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 6 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 7 ).	"devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'B' index: 0 )."					"Entradas Analgicas"						devicePLC analogInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: nil locationPrefix: 'I' sizePrefix: 'W' index: 4 ) ilCompile. 			"Salidas Digitales"		devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 0 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 1 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 2 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 3 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 4 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 5 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 6 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 7 ).			"devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'B' index: 0 )."		^ devicePLC.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/19/2016 01:03'!createCiaaNxpProgDecl	| programitaDecl |	"Ac hago de cuenta que toque el cono 'Nueva POU'  y eleg PROGRAMA" 	programitaDecl := PLC_Program		newWithName: 'MAIN_PROG' 		andDataType: PLC_DataType Bool.	"y cuerpo en lenguaje Ladder. El cuerpo aade una network automaticamente"	programitaDecl pouBody: (PLC_LadderBody newWithPOU: programitaDecl).	"Agrego una declaracion de variable de entrada. 	Cuando hace add le agrega su categora automaticamente"	programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'I0' 		).		programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Input' translated ,' 0 CIAA-NXP.'.					"Agrego una declaracion de variable de entrada. Cuando hace add le agrega su categora automaticamente"	programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'I1' 		).		programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Input' translated ,' 1 CIAA-NXP.'.		"Agrego una declaracion de variable de entrada. Cuando hace add le agrega su categora automaticamente"	programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'I2' 		).		programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Input' translated ,' 2 CIAA-NXP.'.				"Agrego una declaracion de variable de entrada. Cuando hace add le agrega su categora automaticamente"	programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'I3' 		).	programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Input' translated ,' 3 CIAA-NXP.'.					programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'I4' 		).	programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Input' translated ,' 4 CIAA-NXP.'.			programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'I5' 		).	programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Input' translated ,' 5 CIAA-NXP.'.			programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'I6' 		).	programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Input' translated ,' 6 CIAA-NXP.'.			programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'I7' 		).	programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Input' translated ,' 7 CIAA-NXP.'.						"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q0' 		).		programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Output' translated ,' 0 CIAA-NXP.'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q1' 		).	programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Output' translated ,' 1 CIAA-NXP.'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q2' 		).		programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Output' translated ,' 2 CIAA-NXP.'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q3' 		).		programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Output' translated ,' 3 CIAA-NXP.'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q4' 		).		programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Output' translated ,' 4 CIAA-NXP.'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q5' 		).			programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Output' translated ,' 5 CIAA-NXP.'.			programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q6' 		).			programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Output' translated ,' 6 CIAA-NXP.'.		programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q7' 		).			programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Output' translated ,' 7 CIAA-NXP.'.	"Agrego una declaracion de variable temporal"	programitaDecl tempVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'temp0' 		).			"Agrego una declaracion de variable temporal"	programitaDecl tempVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'temp1' 		).			"Agrego una declaracion de variable temporal"	programitaDecl tempVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Time			andInitialValue: nil 			andIdentifier: 'temp2' 		).	"Agrego una declaracion de variable temporal"	programitaDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'var0' 		).			"Agrego una declaracion de variable temporal"	programitaDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'var1' 		).			"Agrego una declaracion de variable temporal"	programitaDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Time			andInitialValue: nil 			andIdentifier: 'var2' 		).	^ programitaDecl.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/17/2016 02:40'!createEduCiaaNxpProgDecl	| programitaDecl |	"Ac hago de cuenta que toque el cono 'Nueva POU'  y eleg PROGRAMA" 	programitaDecl := PLC_Program		newWithName: 'MAIN_PROG' 		andDataType: PLC_DataType Bool.	"y cuerpo en lenguaje Ladder. El cuerpo aade una network automaticamente"	programitaDecl pouBody: (PLC_LadderBody newWithPOU: programitaDecl).	"Agrego una declaracion de variable de entrada. 	Cuando hace add le agrega su categora automaticamente"	programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'TEC1' 		).		programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Touchswitch' translated , ' 1 EDU-CIAA-NXP'.					"Agrego una declaracion de variable de entrada. Cuando hace add le agrega su categora automaticamente"	programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'TEC2' 		).		programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Touchswitch' translated , ' 2 EDU-CIAA-NXP'.			"Agrego una declaracion de variable de entrada. Cuando hace add le agrega su categora automaticamente"	programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'TEC3' 		).		programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Touchswitch' translated , ' 3 EDU-CIAA-NXP'.					"Agrego una declaracion de variable de entrada. Cuando hace add le agrega su categora automaticamente"	programitaDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'TEC4' 		).	programitaDecl inputVarDecls last description: 'CIAA Program Declaration -> Touchswitch' translated , ' 4 EDU-CIAA-NXP'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LEDR' 		).		programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Red Led' translated , ' EDU-CIAA-NXP'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LEDG' 		).	programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Green Led' translated , ' EDU-CIAA-NXP'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LEDB' 		).		programitaDecl outputVarDecls last description: 'CIAA Program Declaration -> Blue Led' translated , ' EDU-CIAA-NXP'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LED1' 		).		programitaDecl outputVarDecls last description: 'Led 1 EDU-CIAA-NXP'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LED2' 		).		programitaDecl outputVarDecls last description: 'Led 2 EDU-CIAA-NXP'.		"Agrego una declaracion de variable de salida"	programitaDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LED3' 		).			programitaDecl outputVarDecls last description: 'Led 3 EDU-CIAA-NXP'.	"Agrego una declaracion de variable temporal"	programitaDecl tempVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'temp0' 		).			"Agrego una declaracion de variable temporal"	programitaDecl tempVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'temp1' 		).			"Agrego una declaracion de variable temporal"	programitaDecl tempVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Time			andInitialValue: nil 			andIdentifier: 'temp2' 		).	"Agrego una declaracion de variable temporal"	programitaDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'var0' 		).			"Agrego una declaracion de variable temporal"	programitaDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Int			andInitialValue: nil 			andIdentifier: 'var1' 		).			"Agrego una declaracion de variable temporal"	programitaDecl varDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Time			andInitialValue: nil 			andIdentifier: 'var2' 		).	^ programitaDecl.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 2/15/2016 01:10'!current	"Returns current selected board"		current ifNil: [ current := self eduCiaaNxp ].		^ current.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 9/2/2015 00:12'!eduCiaaNxp	"Devuelve una instancia de dispositivo EDU-CIAA-NXP"	| devicePLC |		devicePLC := self new.		devicePLC deviceName: 'EDU-CIAA-NXP'.	devicePLC cpu: PLC_CPU nxpLpc4337.		"Entradas Digitales"		devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 0 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 1 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 2 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 3 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 4 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 5 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 6 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 7 ).			"devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'B' index: 0 )."			"Salidas Digitales"		devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 0 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 1 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 2 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 3 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 4 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 5 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 6 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 7 ).			"devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'B' index: 0 )."		^ devicePLC.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 11/8/2013 04:09'!plericLPC1769	"Devuelve una instancia de PLC PLeriC"	| devicePLC |		devicePLC := self new.		devicePLC deviceName: 'PLeriC_LPC1769'.	devicePLC cpu: PLC_CPU lpc1769.		"Entradas Digitales"		devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 0 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 1 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 2 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 3 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 4 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 5 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 6 ).	devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'X' index: 7 ).			"devicePLC digitalInputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'I' sizePrefix: 'B' index: 0 )."			"Salidas Digitales"		devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 0 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 1 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 2 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 3 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 4 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 5 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 6 ).	devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'X' index: 7 ).			"devicePLC digitalOutputs add: 		( PLC_DevicePhysicalAddress newWithDevice: devicePLC locationPrefix: 'Q' sizePrefix: 'B' index: 0 )."		^ devicePLC.! !!PLC_DevicePLC class methodsFor: 'instance creation' stamp: 'EricPernia 11/8/2013 02:51'!voidDeviceWithNumber: aNumber	"Devuelve un dispositivo vacio para crear la ranura vacia con el numero que le llega como parametro"	| devicePLC |		devicePLC := self new.		devicePLC deviceName: 'Ranura_' , aNumber asString.		^ devicePLC.! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!analogInputs	^ analogInputs! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!analogInputs: anObject	analogInputs := anObject! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!analogOutputs	^ analogOutputs! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!analogOutputs: anObject	analogOutputs := anObject! !!PLC_DevicePLC methodsFor: 'service for compilation' stamp: 'EricPernia 2/17/2016 03:07'!cCodeForDInputs	"PARCHE - Devuelve el codigo C para las IO de la placa"		(self deviceName = 'EDU-CIAA-NXP') 		ifTrue: [			^ self class cCodeForEduCiaaNxpProgDeclInputs.		].		(self deviceName = 'CIAA-NXP') 		ifTrue: [			^ self class cCodeForCiaaNxpProgDeclInputs.		].! !!PLC_DevicePLC methodsFor: 'service for compilation' stamp: 'EricPernia 2/17/2016 03:08'!cCodeForDOutputs	"PARCHE - Devuelve el codigo C para las IO de la placa"		(self deviceName = 'EDU-CIAA-NXP') 		ifTrue: [			^ self class cCodeForEduCiaaNxpProgDeclOutputs.		].		(self deviceName = 'CIAA-NXP') 		ifTrue: [			^ self class cCodeForCiaaNxpProgDeclOutputs.		].! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!cpu	^ cpu! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!cpu: anObject	cpu := anObject! !!PLC_DevicePLC methodsFor: 'service for POU Declaration' stamp: 'EricPernia 2/17/2016 02:45'!createProgDecl	"Crea la declaracin de POU"		(self deviceName = 'EDU-CIAA-NXP') 		ifTrue: [			^ self class createEduCiaaNxpProgDecl.		].		(self deviceName = 'CIAA-NXP') 		ifTrue: [			^ self class createCiaaNxpProgDecl.		].! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!deviceName	^ deviceName! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!deviceName: anObject	deviceName := anObject! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!digitalInputs	^ digitalInputs! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!digitalInputs: anObject	digitalInputs := anObject! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!digitalOutputs	^ digitalOutputs! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 5/31/2013 01:32'!digitalOutputs: anObject	digitalOutputs := anObject! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 00:43'!hardwareConfiguration	^ hardwareConfiguration! !!PLC_DevicePLC methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 00:44'!hardwareConfiguration: anObject	hardwareConfiguration := anObject! !!PLC_DevicePLC methodsFor: 'collections' stamp: 'EricPernia 11/5/2013 00:42'!includesDigitalInput: aString.	"Devuelve true si contiene la entrada digital que recibe como parametro.	Este metodo se utiliza para validar los actualArguments"	^ self digitalInputs anySatisfy: [ :each |		each ilCompile = aString.		].! !!PLC_DevicePLC methodsFor: 'collections' stamp: 'EricPernia 11/5/2013 00:42'!includesDigitalOutput: aString.	"Devuelve true si contiene la salida digital que recibe como parametro	Este metodo se utiliza para validar los actualArguments"	^ self digitalOutputs anySatisfy: [ :each |		each ilCompile = aString.		].! !!PLC_DevicePLC methodsFor: 'initialize-release' stamp: 'EricPernia 5/31/2013 01:41'!initialize	"comment stating purpose of message"	| temporary variable names |		deviceName  := ''.		digitalInputs := OrderedCollection new.	digitalOutputs := OrderedCollection new.		analogInputs := OrderedCollection new.	analogOutputs := OrderedCollection new.! !!PLC_DevicePLC methodsFor: 'resource' stamp: 'EricPernia 11/8/2013 04:03'!resource	"Devuelve el recurso que crea si tiene CPU"	| res |		self cpu 		ifNil: [ 			^ nil.			]		ifNotNil: [ 						"Creo el recurso y le asigno el porcesador y nombre, 			la config de soft se la agrega la config cuando hace add"			res := PLC_Resource 				newWithName: self deviceName 				andSoftConfig: nil 				andProcessor: self cpu.				"res := PLC_Resource 	newWithName: 'RecursoEj' 	andSoftConfig: nil 	andProcessor: PLC_CPU lpc1769."							"Agrego las Declaraciones de las variables Globales de 			Entradas digitales (%I0) del PLC al RECURSO"			self digitalInputs do: [ :each |				res globalVarDecls add: ( 					PLC_LocatedVariableDecl 						newWithDataType: PLC_DataType Bool 						andInitialValue: nil 						andPhysicalAddress: each					).					].							"Agrego las Declaraciones de las variables Globales de 			Salidas digitales (%Q0) del PLC al RECURSO"			self digitalOutputs do: [ :each |				res globalVarDecls add: ( 					PLC_LocatedVariableDecl 						newWithDataType: PLC_DataType Bool 						andInitialValue: nil 						andPhysicalAddress: each					).					].							^ res.			]. ! !!PLC_DevicePLC methodsFor: 'physical address' stamp: 'EricPernia 11/5/2013 00:47'!slot	"Devuelve el numero de slot a la direccin fisica pidiendoselo a la configuracin de hardware"	self hardwareConfiguration		ifNil: [			^ 0.			]		ifNotNil: [			^ self hardwareConfiguration slotFor: self.			].		 	! !!PLC_DevicePhysicalAddress class methodsFor: 'instance creation' stamp: 'EricPernia 11/4/2013 18:13'!newWithDevice: aDevice locationPrefix: aLocation sizePrefix: aSize index: anIndex	"Crea una nueva instancia con los parametros indicados"	| physicalAddress |		physicalAddress := self new.		physicalAddress device: aDevice.	physicalAddress locationPrefix: aLocation.	physicalAddress sizePrefix: aSize.	physicalAddress index: anIndex.		^ physicalAddress.! !!PLC_DevicePhysicalAddress methodsFor: 'compilation' stamp: 'EricPernia 11/4/2013 18:27'!cCompile 	"Devuelve el string de cdigo C de este Objeto de Programa"	"Ejemplo: I0.X.x6"	| sizePref |	self sizePrefix		ifNil: [ 			sizePref := 'X'.			] 		ifNotNil:[ 			sizePref := self sizePrefix.			 ] .		^ self locationPrefix, self slot asString , '.' , sizePref , '.' , sizePref asLowercase , self index asString.! !!PLC_DevicePhysicalAddress methodsFor: 'accessing' stamp: 'EricPernia 11/4/2013 18:19'!device	"Es el dispositivo que contiene a esta direccion fisica"		^ device! !!PLC_DevicePhysicalAddress methodsFor: 'accessing' stamp: 'EricPernia 11/4/2013 18:00'!device: anObject		device := anObject! !!PLC_DevicePhysicalAddress methodsFor: 'compilation' stamp: 'EricPernia 11/4/2013 18:30'!ilCompile 	"Devuelve el string de cdigo IL de este Objeto de Programa"	"Ejemplo: %IX0.6"	| sizePref |	self sizePrefix		ifNil: [ 			sizePref := ''.			] 		ifNotNil:[ 			sizePref := self sizePrefix.			 ] .		^ '%' , self locationPrefix , sizePref , self slot asString , '.' , self index asString.! !!PLC_DevicePhysicalAddress methodsFor: 'accessing' stamp: 'EricPernia 11/4/2013 18:23'!index	"El ultimo numero que da el numero de Io O por ejemplo"		index		ifNil: [ 			^ 0.			] 		ifNotNil:[ 			^ index.			 ] .! !!PLC_DevicePhysicalAddress methodsFor: 'accessing' stamp: 'EricPernia 11/4/2013 18:00'!index: anObject		index := anObject! !!PLC_DevicePhysicalAddress methodsFor: 'initialize-release' stamp: 'EricPernia 11/4/2013 18:05'!initialize	"Inicializa el pin del PLC"! !!PLC_DevicePhysicalAddress methodsFor: 'accessing' stamp: 'EricPernia 11/4/2013 18:23'!locationPrefix	"I, Q o M"		locationPrefix		ifNil: [ 			^ 'M'.			] 		ifNotNil:[ 			^ locationPrefix.			 ] .! !!PLC_DevicePhysicalAddress methodsFor: 'accessing' stamp: 'EricPernia 11/4/2013 18:17'!locationPrefix: anObject		locationPrefix := anObject! !!PLC_DevicePhysicalAddress methodsFor: 'accessing' stamp: 'EricPernia 11/4/2013 18:28'!sizePrefix	"nil, X, B, W, D o L"		^ sizePrefix! !!PLC_DevicePhysicalAddress methodsFor: 'accessing' stamp: 'EricPernia 11/4/2013 18:16'!sizePrefix: anObject		sizePrefix := anObject! !!PLC_DevicePhysicalAddress methodsFor: 'device' stamp: 'EricPernia 11/4/2013 18:22'!slot	"Devuelve su numero de Slot o RANURA pidiendoselo a su Dispositivo"	"^ self device slot."		self device 		ifNil: [ 			^ 0.			] 		ifNotNil:[ 			^ self device slot.			 ] .	! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 04:50'!chooseColor	self drawingArea paintingColor: (self window chooseColor: self drawingArea paintingColor)! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 04:50'!draw	self window alert: 'Fool!! You are already painting. '! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 04:48'!drawingArea	^ drawingArea ifNil: [		drawingArea := PaintCanvas new]! !!PLC_EditorProgram methodsFor: 'initialize-release' stamp: 'EricPernia 2/29/2012 23:51'!initialize	self initialize1.	self initialize2.! !!PLC_EditorProgram methodsFor: 'initialize-release' stamp: 'EricPernia 2/29/2012 22:35'!initialize1	super initialize.	self installMenubar.	self installToolbar.	self installDrawingArea.	self window openInWorld.	self window  extent: 800@600.! !!PLC_EditorProgram methodsFor: 'initialize-release' stamp: 'EricPernia 4/24/2013 02:38'!initialize2		|win projectMenu tools dock text holder editMenu |	super initialize.		win := StandardWindow new.	projectMenu := win newMenu.	projectMenu		addToggle: 'Nuevo...ACAAAA'		target: self "would be model"		selector: #projectMenuNewProject.	projectMenu lastItem		font: win theme menuFont;		icon: win theme smallNewIcon;		keyText: 'Ctrl+N'.	projectMenu		addToggle: 'Abrir...' "'Open' translated"		target: self 		selector: #projectMenuOpenProject.	projectMenu lastItem		font: win theme menuFont;		icon: win theme smallOpenIcon;		keyText: 'Ctrl+O'.		projectMenu		addToggle: 'Guardar'		target: self		selector: #projectMenuSaveProject		getStateSelector: nil		enablementSelector: nil.	projectMenu lastItem		font: win theme menuFont;		icon: win theme smallSaveIcon;		keyText: 'Ctrl+S'.	projectMenu		addToggle: 'Guardar como...'		target: self		selector: #projectMenuSaveProjectAs		getStateSelector: nil		enablementSelector: nil.	projectMenu lastItem		font: win theme menuFont;		icon: win theme smallSaveAsIcon;		keyText: 'Ctrl+Mayus+S'.	projectMenu		addToggle: 'Imprimir...'		target: nil		selector: #projectMenuPrintProject.	projectMenu lastItem		font: win theme menuFont;		icon: win theme smallPrintIcon;		keyText: 'Ctrl+P'.	editMenu := win newMenu.	editMenu		addToggle: 'Cortar'		target: self 		selector: #editMenuCut.	editMenu lastItem		font: win theme menuFont;		icon: win theme smallCutIcon;		keyText: 'Ctrl+X'.			editMenu		addToggle: 'Copiar'		target: self 		selector: #editMenuCopy.	editMenu lastItem		font: win theme menuFont;		icon: win theme smallCopyIcon;		keyText: 'Ctrl+C'.	editMenu		addToggle: 'Pegar'		target: self 		selector: #editMenuPaste.	editMenu lastItem		font: win theme menuFont;		icon: win theme smallPasteIcon;		keyText: 'Ctrl+V'.	editMenu		addToggle: 'Borrar'		target: self 		selector: #editMenuDelete.	editMenu lastItem		font: win theme menuFont;		icon: win theme smallDeleteIcon;		keyText: 'Supr'.	editMenu		addToggle: 'Cambiar nombre'		target: self 		selector: #editMenuChangeName.	editMenu lastItem		font: win theme menuFont;		icon: nil;		keyText: 'F2'.			editMenu		addToggle: 'Compilar'		target: self 		selector: #editMenuCompile.	editMenu lastItem		font: win theme menuFont;		icon: win theme smallDoItIcon;		keyText: 'Ctrl+B'.	tools := win newToolbar: {		win			newButtonFor: nil "if we had a model it would go here"			getState: nil			action: #openFile			arguments: nil			getEnabled: nil			labelForm: win theme smallNewIcon			help: 'Nuevo'.		win			newButtonFor: nil			getState: nil			action: #openFile			arguments: nil			getEnabled: nil			labelForm: win theme smallOpenIcon			help: 'Abrir'.		win			newButtonFor: nil			getState: nil			action: #saveFile			arguments: nil			getEnabled: nil			labelForm: win theme smallSaveIcon			help: 'Guardar'.		win			newButtonFor: nil			getState: nil			action: #print			arguments: nil			getEnabled: nil			labelForm: win theme smallPrintIcon			help: 'Imprimir'}.		holder := StringHolder new.		text := win			newTextEditorFor: holder			getText:  #contents			setText: #contents:			getEnabled: nil.		dock := win newToolDockingBar.		dock			add: 'Proyecto' "'File' translated"			font: win theme menuBarFont			icon: nil "win theme smallOpenIcon"			help: 'Operaciones de proyecto' "'File operations' translated"			subMenu: projectMenu;			addMorphBack: tools;			add: 'Proyecto' "'File' translated"			font: win theme menuBarFont			icon: nil "win theme smallOpenIcon"			help: 'Operaciones de proyecto' "'File operations' translated"			subMenu: projectMenu;			addMorphBack: tools;						add: 'Proyecto' "'File' translated"			font: win theme menuBarFont			icon: nil "win theme smallOpenIcon"			help: 'Operaciones de proyecto' "'File operations' translated"			subMenu: projectMenu;			addMorphBack: tools;						add: 'Edicin'			font: win theme menuBarFont			icon: nil			help: 'Operaciones de proyecto'			subMenu: editMenu;			addMorphBack: tools.					win			addMorph: dock			fullFrame: (LayoutFrame fractions: (0@0 corner: 1@0) offsets: (0@0 corner: 0 @ dock minExtent y));			addMorph: text			fullFrame: (LayoutFrame fractions: (0@0 corner: 1@1) offsets: (0@dock minExtent y corner: 0 @ 0)).		win			themeChanged;			openInWorld.! !!PLC_EditorProgram methodsFor: 'initialize-release' stamp: 'EricPernia 2/24/2012 20:26'!installDrawingArea	self window 		addMorph: self drawingArea		fullFrame: (			LayoutFrame				fractions: (0@0 corner: 1@1)				offsets: (0@(self menubar minExtent y "+ self toolbar minExtent y") corner:  0@0)).	self drawingArea color: Color red! !!PLC_EditorProgram methodsFor: 'initialize-release' stamp: 'EricPernia 2/24/2012 04:25'!installMenubar	self window 		addMorph: self menubar		fullFrame: (			LayoutFrame				fractions: (0@0 corner: 1@0)				offsets: (0@0 corner:  0@ self menubar minExtent y))! !!PLC_EditorProgram methodsFor: 'initialize-release' stamp: 'EricPernia 2/24/2012 05:14'!installToolbar| buttonPanel |buttonPanel := PluggablePanelMorph new.self window addMorph: buttonPanel fullFrame: (     LayoutFrame        fractions: (0@0.99 corner: 1@1)        offsets: (0@50 negated corner: 0@0)).buttonPanel  color: (Color gray).#(uno dos tres) do: [:label| |aButton|    aButton := PluggableButtonMorph new label: label; yourself.   buttonPanel addMorph: aButton fullFrame: nil.].	"self window 		addMorph: self toolbar		fullFrame: (			LayoutFrame				fractions: (0@0 corner: 1@0)				offsets: (0@self menubar minExtent y corner:  0@ self menubar minExtent y + self toolbar minExtent y))"! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 04:51'!load	self window fileOpen: 'Seleccione un mapa de bits a cargar' extensions: #('png'  'jpg').	self window deny: 'It is only a demo, you cannot load bitmap yet'! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 05:23'!menubar	^ menubar ifNil: [ | menuProyecto menuConfiguracion |		menuProyecto := self window newMenu.		menuProyecto 			addToggle: 'Abrir'			target: self			selector: #load.		menuProyecto 			addToggle: 'Guardar'			target: self			selector: #save.		menuProyecto 			addToggle: 'Imprimir'			target: self			selector: #print.		menuConfiguracion := self window newMenu.		menuConfiguracion 			addToggle: 'Abrir'			target: self			selector: #load.		menuConfiguracion 			addToggle: 'Guardar'			target: self			selector: #save.		menuConfiguracion 			addToggle: 'Imprimir'			target: self			selector: #print.		menubar := self window newToolDockingBar.		menubar 			add: 'Proyecto'			font: self window theme menuBarFont			icon: nil			help: 'Operaciones de proyecto'			subMenu: menuProyecto.		menubar			add: 'Configuracion'			font: self window theme menuBarFont			icon: nil			help: 'Configuraciones'			subMenu: menuConfiguracion.		menubar		]! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 04:45'!messageSelecsave	self window fileSave: 'Select a bitmap to load' extensions: #('png'  'jpg').	self window deny: 'It is only a demo, you cannot save bitmap yet'! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 04:56'!save	self window fileSave: 'Escriba un nombre para la imagen a guardar' extensions: #('png'  'jpg').	self window deny: 'It is only a demo, you cannot save bitmap yet'! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 20:26'!toolbar	"^ toolbar ifNil: [ | tools |		tools := self window newToolbar: {			self window		}.		toolbar := self window newToolDockingBar addMorph: tools]"! !!PLC_EditorProgram methodsFor: 'varios' stamp: 'EricPernia 2/24/2012 20:21'!window 	^ window ifNil: [		window := StandardWindow labelled: 'PLeriC Project Manager'.		window announcer			on: WindowResizing 			do: [:ann | self drawingArea extent: ann newSize].		window]! !!PLC_ErrorOperand methodsFor: 'displaying' stamp: 'CarlosLombardi 10/14/2016 15:30'!asSimpleString	"a String representing myself"	^self dataValue asString! !!PLC_ErrorOperand methodsFor: 'compilation' stamp: 'EricPernia 4/23/2015 04:45'!cCompile	"Este objeto representa al operando vacio."	^ self identifier.! !!PLC_ErrorOperand methodsFor: 'coercion' stamp: 'CarlosLombardi 10/14/2016 19:10'!canBeCoercedTo: aDataType	"whether it is possible for this operand to be coerced to the given type.	 Only literals can be coerced"	^false	! !!PLC_ErrorOperand methodsFor: 'compilation' stamp: 'EricPernia 4/23/2015 04:45'!dataType	"Devuelve el tipo de datos."	^ PLC_DataType Void.! !!PLC_ErrorOperand methodsFor: 'compilation' stamp: 'EricPernia 4/23/2015 04:50'!dataValue		^ PLC_Literal newWithDataType: self dataType andDataValue: dataValue.! !!PLC_ErrorOperand methodsFor: 'compilation' stamp: 'EricPernia 4/23/2015 04:52'!dataValue: aValue		dataValue := aValue asString.! !!PLC_ErrorOperand methodsFor: 'accessing' stamp: 'CarlosLombardi 10/14/2016 12:23'!errorText	^ errorText! !!PLC_ErrorOperand methodsFor: 'accessing' stamp: 'CarlosLombardi 10/14/2016 12:23'!errorText: anObject	errorText := anObject! !!PLC_ErrorOperand methodsFor: 'compilation' stamp: 'EricPernia 4/23/2015 04:51'!identifier	"Devuelve el identificador de su declaration"	^ dataValue.! !!PLC_ErrorOperand methodsFor: 'compilation' stamp: 'EricPernia 4/23/2015 04:45'!ilCompile	"Este objeto representa al operando vacio."	^ self identifier.! !!PLC_ErrorOperand methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:47'!isError	"Devuelve true si es error"	^ true.! !!PLC_ErrorOperand methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:45'!isPLCLiteral	"Devuelve true si es literal"	^ false.! !!PLC_ErrorOperand methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:45'!isStructItem	"Devuelve true si es StructItem"	^ false.! !!PLC_ErrorOperand methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:45'!isVaraible	"Devuelve true pues es variable"	^ false.! !!PLC_ErrorOperand methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:49'!isVoid	"Devuelve true si es void"	^ false.! !!PLC_GraphicElementGroup methodsFor: 'elements' stamp: 'EricPernia 4/21/2013 13:36'!add: anElementOrGroup	"Aade un elemento o grupo al grupo. 	Si el grupo  a aadir es el mismo produce un error.	Si se intenta agregar repetidos produce error."		( ( anElementOrGroup == self ) or: [ self includes: anElementOrGroup ] )		ifTrue: [			self error: 'No se puede aadir un grupo a si mismo, ni se permiten repetidos dentro del grupo'.			] 		ifFalse: [			self elements add: anElementOrGroup.			].! !!PLC_GraphicElementGroup methodsFor: 'position' stamp: 'EricPernia 7/7/2013 19:58'!bottom	"Devuelve su posicion inferior en Y."	^ self layoutRectangle bottom.! !!PLC_GraphicElementGroup methodsFor: 'position' stamp: 'EricPernia 3/31/2013 05:23'!bottom: aDistance	"Setea su posicion inferior en Y."	self elements do: [ :elem |		elem bottom: aDistance.		].! !!PLC_GraphicElementGroup methodsFor: 'accessing' stamp: 'EricPernia 3/31/2013 00:53'!elements	^ elements! !!PLC_GraphicElementGroup methodsFor: 'accessing' stamp: 'EricPernia 3/31/2013 00:53'!elements: anObject	elements := anObject! !!PLC_GraphicElementGroup methodsFor: 'elements' stamp: 'EricPernia 7/13/2013 03:50'!elementsDependentsUnderGroupLayoutRectangle	"Devuelve una Ordered Collection con los elementos dependientes 	de cada uno de los elementos del grupo  que estn dentro del 	layoutRectangle de cada elemento. Esto se utiliza para poder 	borrar elementos bajo 	el layout Rectangle del grupo cuando hago 	el alyout Vertical."	| collection |		collection := OrderedCollection new.	self elements do: [ :each |		collection addAll: each dependentsUnderLayoutRectangle.		].		^collection.! !!PLC_GraphicElementGroup methodsFor: 'elements' stamp: 'EricPernia 4/4/2013 01:37'!includes: anElementOrGroup	"Devuelve True si el Grupo incluye al elemento grafico."	^ self elements includes: anElementOrGroup.! !!PLC_GraphicElementGroup methodsFor: 'initialize-release' stamp: 'EricPernia 3/31/2013 00:53'!initialize	"Inicializa la Ordered Collection elements que contiene elementos graficos"	self elements: OrderedCollection new.			! !!PLC_GraphicElementGroup methodsFor: 'elements' stamp: 'EricPernia 4/14/2013 07:53'!last	^ self elements last. ! !!PLC_GraphicElementGroup methodsFor: 'elements' stamp: 'EricPernia 4/28/2013 17:13'!layoutFirstPinsYDistance	"Devuelve la distancia minima en pantalla en Y del primer pin de entrada 	y salida relativa a la posicion vertical de self .	Es la distancia vertical entre la parte de arriba del elemento y sus sub elementos y el primer pin."	^ self maxFirstPinYDistance.! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 20:35'!layoutHorizontallyLeft: aDistanceX	"Dispone en pantalla todos los elementos internos del grupo de elementos Horizontalmente.	Este junto con el metodo del mismo nombre en Elemento hace que se pueda crear un composite. 	Es decir, Grupos que contengan Elementos u oros Grupos."                        	self elements first xPositioned 		ifFalse: [ 			self elements first layoutHorizontallyLeft: aDistanceX.			].					(2 to: self elements size) do: [ :ind |		( self  elements at: ind ) xPositioned 			ifFalse: [ 				( self  elements at: ind ) layoutHorizontallyLeft: ( self  elements at: ind - 1 ) layoutRectangle right.				].		]. ! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 4/27/2013 00:56'!layoutPosition: aPoint	"Dispone en pantalla todos los elementos internos del grupo de elementos."	"Layout horizontal de los elementos interiores."	self layoutHorizontallyLeft: aPoint x.		"Layout vertical de los elementos interiores"	self layoutVerticallyTop: aPoint y.! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 20:09'!layoutRectangle	"Devuelve el layoutRectangle mayor de la coleccion elements	que contiene una rama serie de elementos."	^ self layoutRectangleForGroup.! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 3/13/2016 20:04'!layoutRectangleForGroup	"Devuelve el layoutRectangle mayor de la coleccion elements	que contiene una rama serie de elementos."	| layoutRectangle elementConnectedToGroup |	layoutRectangle := self elements inject: self elements first layoutRectangleForGroup		into: [ :layoutRectangleForGroup :element | 			layoutRectangleForGroup merge: element layoutRectangleForGroup			].		"Extiendo layoutRectangle del grupo a derecha. Esto es para que el layoutRectangle del 	grupo sea el mximo posible a derecha para que acomode bien Contactos y Bloques."		"Chequeo si el ultimo del grupo es un RightPowerRail. Si no es modifico el layoutRectangle	del grupo. "	self elements last isRightPowerRail		ifFalse: [ 			"Busco el elemento conectado al ultimo elementos del grupo"			elementConnectedToGroup := self elements last blockConnectedToOutput: 1.			"Extiendo el layoutRectangle del grupo a derecha hasta la izquierda del elemento hallado."			layoutRectangle := 	Rectangle 				origin: layoutRectangle origin 				corner: ( elementConnectedToGroup layoutRectangle left @ layoutRectangle bottom).			].			"Extiendo layoutRectangle del grupo a izquierda. Esto es para que el layoutRectangle del 	grupo sea el mximo posible a izquierda para que acomode bien bobinas."				"Busco el elemento conectado al primer elemento del grupo"	elementConnectedToGroup := self elements first blockConnectedToInput: 1.	"Extiendo el layoutRectangle del grupo a izquierda hasta la derecha del elemento hallado."	layoutRectangle := 	Rectangle 		origin: ( elementConnectedToGroup layoutRectangle right @ layoutRectangle top)		corner: layoutRectangle corner.					^ layoutRectangle.! !!PLC_GraphicElementGroup methodsFor: 'position' stamp: 'EricPernia 3/31/2013 02:13'!layoutRectanglePosition	"Devuelve la posicion del layoutRectangle.	Este mensaje es para tener polimorfismo con los elementos graficos."	^ self layoutRectangle position.! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 4/2/2013 01:17'!layoutRectangleRelativePosition	"Posicion relativa entre el layoutRectangle y el position del elemento"	^ self elements first topLeft - self layoutRectangle topLeft.! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 3/13/2016 15:02'!layoutVerticallyTop: aDistanceY	"Dispone en pantalla todos los elementos internos del grupo de elementos Verticalmente."	| firstPinsYPosition |	"Busco la mayor altura del primer pin"	firstPinsYPosition := self maxFirstPinYDistance.				"Asigno la altura hallada a todos los morphs de la misma linea"			self elements do: [ :aGraphicElement |		aGraphicElement layoutVerticallyTop: 			aDistanceY + firstPinsYPosition - ( aGraphicElement layoutFirstPinsYDistance ).		].! !!PLC_GraphicElementGroup methodsFor: 'position' stamp: 'EricPernia 3/31/2013 05:43'!left	"Devuelve su posicion izquierda en X."	^ self layoutRectangle left.! !!PLC_GraphicElementGroup methodsFor: 'elements' stamp: 'EricPernia 4/1/2013 06:32'!left: aDistanceX	"Cambia la posicion horizontal de sus elementos internos."		self elements do: [ :aGraphicElement | 		aGraphicElement left: aDistanceX.		].! !!PLC_GraphicElementGroup methodsFor: 'elements' stamp: 'EricPernia 4/28/2013 17:12'!maxFirstPinYDistance	"Devuelve la maxima distancia minima de sus subelementos."	"Busco la mayor altura del primer pin"	^ self elements 		inject: 0 		into: [:maxY :aGraphicElement | maxY max: aGraphicElement layoutFirstPinsYDistance ].! !!PLC_GraphicElementGroup methodsFor: 'position' stamp: 'EricPernia 3/31/2013 05:43'!right	"Devuelve su posicion derecha en X."	^ self layoutRectangle right.! !!PLC_GraphicElementGroup methodsFor: 'position' stamp: 'EricPernia 3/31/2013 06:35'!right: aDistance	"Setea su posicion derecha en X."	self elements do: [ :elem |		elem right: aDistance.		].! !!PLC_GraphicElementGroup methodsFor: 'position' stamp: 'EricPernia 3/31/2013 05:43'!top	"Devuelve su posicion superior en Y."	^ self layoutRectangle top.! !!PLC_GraphicElementGroup methodsFor: 'elements' stamp: 'EricPernia 4/2/2013 02:21'!topLeft	"Posiciondel primer elemento del grupo."	^ self elements first topLeft.! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 4/14/2013 20:16'!xPositioned	"Devuelve true si el flag de xPositioned de cada uno de sus elementos es true."		^ self elements allSatisfy: [ :elem |		elem xPositioned.		].! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 4/14/2013 20:17'!xPositioned: aBoolean	"Setea a aBoolean el flag de xPositioned de cada uno de sus elementos."		self elements do: [ :elem |		elem xPositioned: aBoolean.		].! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 4/14/2013 20:17'!yPositioned	"Devuelve true si el flag de yPositioned de cada uno de sus elementos es true."		^ self elements allSatisfy: [ :elem |		elem yPositioned.		].! !!PLC_GraphicElementGroup methodsFor: 'layout' stamp: 'EricPernia 4/14/2013 20:17'!yPositioned: aBoolean	"Setea a aBoolean el flag de yPositioned de cada uno de sus elementos."		self elements do: [ :elem |		elem yPositioned: aBoolean.		].! !!PLC_GraphicElementProperties class methodsFor: 'instance creation' stamp: 'EricPernia 4/21/2012 03:31'!clearInstance 	"Devuelve la unica instancia de esta clase."	Instance ifNotNil: 		[		Instance := nil.		].! !!PLC_GraphicElementProperties class methodsFor: 'instance creation' stamp: 'EricPernia 4/11/2012 21:55'!uniqueInstance 	"Devuelve la unica instancia de esta clase."	Instance ifNil: 		[		Instance := PLC_GraphicElementProperties new.		].		^ Instance.! !!PLC_GraphicElementProperties methodsFor: 'textColors' stamp: 'EricPernia 4/22/2012 04:37'!actualValueAddressColor	"Color de la direccin de memoria de las variables no simblicas."	^Color r: 0 g: 153/255 b: 153/255. " (Color r: 0.0 g: 0.6 b: 0.6)"! !!PLC_GraphicElementProperties methodsFor: 'textColors' stamp: 'EricPernia 4/22/2012 02:59'!actualValueErrorColor	"Color de variable (actual value) con error."	^Color red.! !!PLC_GraphicElementProperties methodsFor: 'textColors' stamp: 'EricPernia 4/22/2012 04:44'!actualValueLiteralColor	"Color de variable (actual value) cuando se le ingresa un literal"	^Color r: 51/255 g: 102/255 b: 211/255. " (Color r: 0.2 g: 0.4 b: 0.827)"! !!PLC_GraphicElementProperties methodsFor: 'textColors' stamp: 'EricPernia 4/22/2012 02:57'!actualValueNotDefinedColor	"Color de variable (actual value) no definida"	^Color r: 1 g: 37/255 b: 87/255. " (Color r: 1.0 g: 0.145 b: 0.341)"! !!PLC_GraphicElementProperties methodsFor: 'otherColors' stamp: 'EricPernia 7/15/2012 03:45'!booleanVariablePinColor	 "Es el pin que solo acepta variables booleanas."	^Color black.! !!PLC_GraphicElementProperties methodsFor: 'styles' stamp: 'EricPernia 6/14/2012 05:14'!centerUnderlineStyleWithColor: aColor andOrigin: anOrigin andDirection: aDirection	"Estilo del Morph subrrayado de la etiqueta. Tiene un color degradado."		^ (GradientFillStyle 	ramp: { 		0.0 -> aColor.		0.5 -> Color white.		1.0 -> aColor. })			origin: anOrigin;			direction: aDirection;			normal: 0@400;			radial: false.	! !!PLC_GraphicElementProperties methodsFor: 'otherColors' stamp: 'EricPernia 4/21/2012 19:26'!changeFunctionColor	"Color del triangulito para cambiar la funcion o tipo de dato."	^Color yellow. ! !!PLC_GraphicElementProperties methodsFor: 'otherColors' stamp: 'EricPernia 4/18/2012 09:26'!dashBorderColor1	 "Color dash oscuro"	^Color r: 128/255 g: 128/255 b: 128/255. "Color r: 0.502 g: 0.502 b: 0.502"! !!PLC_GraphicElementProperties methodsFor: 'otherColors' stamp: 'EricPernia 4/18/2012 09:27'!dashBorderColor2	 "Color dash claro"	^Color r: 61/255 g: 69/255 b: 89/255. "Color r: 0.239 g: 0.271 b: 0.349)"! !!PLC_GraphicElementProperties methodsFor: 'styles' stamp: 'EricPernia 4/18/2012 09:33'!dashBorderSize	"Espesor del borde de linea guionada"		^ 1.! !!PLC_GraphicElementProperties methodsFor: 'styles' stamp: 'EricPernia 4/20/2012 00:52'!dashColors	"Colores de la linea guionada"		^ {	self dashBorderColor1. 		self dashBorderColor2.}! !!PLC_GraphicElementProperties methodsFor: 'styles' stamp: 'EricPernia 4/18/2012 09:32'!dashLengths	"Longitudes de los guiones de la linea guionada"		^ #(1 1). ! !!PLC_GraphicElementProperties methodsFor: 'draggingAnotherColors' stamp: 'EricPernia 4/21/2012 19:07'!draggingAnotherBackgroundColor	"Color de fondo de contactos, bobinas y de variables (actual value).	Se aplica cuando estaba seleccionado y el mouse est arrastrando a otro elemento."	^Color r: 136/255 g: 143/255 b: 158/255. "Color r: 0.534 g: 0.561 b: 0.62"! !!PLC_GraphicElementProperties methodsFor: 'draggingAnotherColors' stamp: 'EricPernia 4/21/2012 19:09'!draggingAnotherBlockBodyColor	"Color de cuerpo del bloque.	Se aplica cuando estaba seleccionado y el mouse est arrastrando a otro elemento."		^Color r: 136/255 g: 143/255 b: 158/255. "Color r: 0.534 g: 0.561 b: 0.62"! !!PLC_GraphicElementProperties methodsFor: 'draggingAnotherColors' stamp: 'EricPernia 4/21/2012 19:10'!draggingAnotherBlockFootAndHeaderColor	"Color de cabecera y pie del bloque.		Se aplica cuando estaba seleccionado y el mouse est arrastrando a otro elemento."			^Color r: 202/255 g: 204/255 b: 217/255. "(Color r: 0.792 g: 0.8 b: 0.851)"! !!PLC_GraphicElementProperties methodsFor: 'draggingAnotherColors' stamp: 'EricPernia 5/15/2012 14:30'!draggingAnotherElementColor	"Color de los contactos, bobinas y del texto (actual value).	Se aplica cuando estaba seleccionado y el mouse est arrastrando a otro elemento."		^Color white.! !!PLC_GraphicElementProperties methodsFor: 'draggingSelfColors' stamp: 'EricPernia 5/22/2012 01:38'!draggingSelfBackgroundColor	"Color de fondo de contactos, bobinas y de variables (actual value).	Se aplica cuando el mouse est arrastrando al elemento.	Idem unselected pero agrega transparencia del 50% (alpha:0.5)"				^ self unselectedBackgroundColor alpha: 0.5.! !!PLC_GraphicElementProperties methodsFor: 'draggingSelfColors' stamp: 'EricPernia 5/22/2012 01:40'!draggingSelfBlockBodyColor	"Color de cuerpo del bloque.	Se aplica cuando el mouse est arrastrando al elemento.	Idem unselected pero agrega transparencia del 50% (alpha:0.5)"			^ self unselectedBlockBodyColor alpha: 0.5.! !!PLC_GraphicElementProperties methodsFor: 'draggingSelfColors' stamp: 'EricPernia 5/22/2012 01:40'!draggingSelfBlockFootAndHeaderColor	"Color de cabecera y pie del bloque.	Se aplica cuando el mouse est arrastrando al elemento.	Idem unselected pero agrega transparencia del 50% (alpha:0.5)"				^ self unselectedBlockFootAndHeaderColor alpha: 0.5.! !!PLC_GraphicElementProperties methodsFor: 'draggingSelfColors' stamp: 'EricPernia 5/22/2012 01:40'!draggingSelfElementColor	"Color de los contactos, bobinas y del texto (actual value).	Se aplica cuando el mouse est arrastrando al elemento.	Idem unselected pero agrega transparencia del 50% (alpha:0.5)"		^ self unselectedElementColor alpha: 0.5.! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 4/22/2013 00:55'!drawBounds	^ drawBounds! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 4/22/2013 00:55'!drawBounds: anObject	drawBounds := anObject! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 9/2/2012 19:24'!drawGrid	^ drawGrid! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 9/2/2012 19:24'!drawGrid: anObject	drawGrid := anObject! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 4/22/2013 01:00'!drawLayoutRectangle	^ drawLayoutRectangle! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 4/22/2013 01:01'!drawLayoutRectangle: anObject	drawLayoutRectangle := anObject! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 7/10/2012 00:18'!drawTextLineBorder	^ drawTextLineBorder! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 7/10/2012 00:18'!drawTextLineBorder: anObject	drawTextLineBorder := anObject! !!PLC_GraphicElementProperties methodsFor: 'textColors' stamp: 'EricPernia 4/22/2012 03:07'!formalArgumentBackgroundColor	"Color de fondo de la variable (formal argument). Color transparente."	^Color white alpha: 1.0.! !!PLC_GraphicElementProperties methodsFor: 'POU colors' stamp: 'EricPernia 9/9/2015 03:17'!functionBlockColor	 "Es color cian de la caja de bloque de funcion."	^ Color r: 0 g: 175/255 b: 239/255! !!PLC_GraphicElementProperties methodsFor: 'POU colors' stamp: 'EricPernia 9/9/2015 03:17'!functionBlockHeaderColor	 "Es color cian claro de la cabecera de la caja de bloque de funcion."	^ Color r: 82/255 g: 201/255 b: 244/255! !!PLC_GraphicElementProperties methodsFor: 'POU colors' stamp: 'EricPernia 11/17/2013 04:09'!functionColor	 "Es color verde oscuro de la caja de funcion."	^ Color r: 0 g: 168/255 b: 89/255! !!PLC_GraphicElementProperties methodsFor: 'POU colors' stamp: 'EricPernia 11/17/2013 04:09'!functionHeaderColor	 "Es color verde claro de la cabecera de la caja de funcion."	^ Color r: 121/255 g: 193/255 b: 78/255! !!PLC_GraphicElementProperties methodsFor: 'grid' stamp: 'EricPernia 4/21/2013 11:47'!gridExtent	"Devuelve el tamao en pixeles de una celda de la grilla gris."		^ ( 96 @ 18 ).! !!PLC_GraphicElementProperties methodsFor: 'grid' stamp: 'EricPernia 4/21/2013 11:47'!gridOrigin	"Devuelve la posicion 0@0 de la grilla"	^ ( 20 @ 20 ).! !!PLC_GraphicElementProperties methodsFor: 'Project colors' stamp: 'EricPernia 1/30/2014 00:22'!hardConfigColor	 "Es color Azul claro de la barra de titulo de Configuracion	 de Hardware la ventada de proyecto."	^ Color r: 89/255 g: 131/255 b: 219/255! !!PLC_GraphicElementProperties methodsFor: 'informativeBlockColors' stamp: 'EricPernia 4/18/2012 09:40'!informativeBlockBorderColor	"Color de borde de cuadro informativo "	^Color r: 1 g: 248/255 b:161 /255. "Color r: 1.0 g: 0.973 b: 0.631"! !!PLC_GraphicElementProperties methodsFor: 'informativeBlockColors' stamp: 'EricPernia 4/22/2012 03:28'!informativeBlockColor	"Color del cuadro informativo. " 	^Color r: 224/255 g: 219/255 b: 80/255. "Color r: 0.879 g: 0.859 b: 0.314"! !!PLC_GraphicElementProperties methodsFor: 'initialize-release' stamp: 'EricPernia 4/22/2013 01:02'!initialize	"Inicializa las propiedades"	self scale: (1@1).	self drawBounds: false.	self drawGrid: false.	self drawTextLineBorder: false.	self drawLayoutRectangle: false.! !!PLC_GraphicElementProperties methodsFor: 'styles' stamp: 'EricPernia 6/14/2012 05:06'!leftUnderlineStyleWithColor: aColor andOrigin: anOrigin andDirection: aDirection	"Estilo del Morph subrrayado de la etiqueta. Tiene un color degradado."		^ (GradientFillStyle 	ramp: { 		0.0 -> Color white.		1.0 -> aColor})			origin: anOrigin;			direction: aDirection;			normal: 0@1300;			radial: false.	! !!PLC_GraphicElementProperties methodsFor: 'otherColors' stamp: 'EricPernia 4/21/2012 19:27'!mouseOverColor	  "Color que se aplica cuando el mouse se posa sobre el elemento"	^Color r: 195/255 g: 215/255 b: 235/255 alpha: 0.5. "TranslucentColor r: 0.764 g: 0.844 b: 0.922 alpha: 0.498"! !!PLC_GraphicElementProperties methodsFor: 'otherColors' stamp: 'EricPernia 7/15/2012 03:45'!nonBooleanVariablePinColor	 "Es el pin que solo acepta variables no booleanas."	^Color r: 1 g: 164/255 b: 0.  "Color dorado  (Color r: 1.0 g: 0.643 b: 0.0)"! !!PLC_GraphicElementProperties methodsFor: 'insertionPointColors' stamp: 'EricPernia 5/16/2012 00:32'!overDropAreaInsertionPointBackgroundColor	 "Color de fondo del area de drop que se encuentra tras el cuadradito 	que representa el punto de insercin."	^Color red alpha: 0.5.! !!PLC_GraphicElementProperties methodsFor: 'insertionPointColors' stamp: 'EricPernia 5/15/2012 16:08'!overDropAreaInsertionPointBorderColor	 "Color de borde del cuadradito que representa el punto de insercin. Se aplica cuando el 	mouse viene arrastrando un elemento y pasa sobre el rea de drop, que es un rea 	alrededor del cuadradito que simboliza el punto de insercin."	^Color black.! !!PLC_GraphicElementProperties methodsFor: 'insertionPointColors' stamp: 'EricPernia 5/15/2012 16:09'!overDropAreaInsertionPointColor	 "Color del cuadradito que representa el punto de insercin. Se aplica cuando el mouse 	viene arrastrando un elemento y pasa sobre el rea de drop, que es un rea al rededor 	del cuadradito que simboliza el punto de insercin."	^Color green.! !!PLC_GraphicElementProperties methodsFor: 'POU colors' stamp: 'EricPernia 11/17/2013 04:10'!programColor	 "Es color dorado oscuro de la caja de funcion."	^ Color r: 210/255 g: 174/255 b: 109/255! !!PLC_GraphicElementProperties methodsFor: 'POU colors' stamp: 'EricPernia 11/17/2013 04:10'!programHeaderColor	 "Es color dorado claro de la cabecera de la caja de bloque de funcion."	^ Color r: 223/255 g: 190/255 b: 98/255! !!PLC_GraphicElementProperties methodsFor: 'Project colors' stamp: 'EricPernia 1/30/2014 00:24'!projectColor	 "Es color Azul oscuro de la barra de titulo de Proyecto de 	Automatizacion de la ventada de proyecto."	^ Color r: 51/255 g: 102/255 b: 211/255! !!PLC_GraphicElementProperties methodsFor: 'styles' stamp: 'EricPernia 6/14/2012 05:11'!rightUnderlineStyleWithColor: aColor andOrigin: anOrigin andDirection: aDirection	"Estilo del Morph subrrayado de la etiqueta. Tiene un color degradado."		^ (GradientFillStyle 	ramp: { 		0.0 -> aColor.		1.0 -> Color white})			origin: anOrigin;			direction: aDirection;			normal: 0@400;			radial: false.	! !!PLC_GraphicElementProperties methodsFor: 'EditableGridColors' stamp: 'EricPernia 4/29/2015 03:33'!rowColorEven	 "Es color de fondo de fila par en la EditableGrid."	^ Color r: 240/255 g: 240/255 b: 240/255! !!PLC_GraphicElementProperties methodsFor: 'EditableGridColors' stamp: 'EricPernia 11/17/2013 04:27'!rowColorHeader	 "Es color verde claro de la cabecera de la caja de funcion."	^ Color r: 96/255 g: 96/255 b: 98/255! !!PLC_GraphicElementProperties methodsFor: 'EditableGridColors' stamp: 'EricPernia 11/17/2013 04:19'!rowColorOdd	 "Es color de fondo de fila impar en la EditableGrid."	^ Color white! !!PLC_GraphicElementProperties methodsFor: 'EditableGridColors' stamp: 'EricPernia 11/17/2013 04:17'!rowColorSelected	 "Es color de fondo de fila cuando esta seleccionada en la EditableGrid."	^ Color r: 175/255 g: 213/255 b: 250/255! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 4/11/2012 21:46'!scale	^ scale! !!PLC_GraphicElementProperties methodsFor: 'accessing' stamp: 'EricPernia 4/11/2012 21:46'!scale: anObject	scale := anObject! !!PLC_GraphicElementProperties methodsFor: 'selectedColors' stamp: 'EricPernia 4/21/2012 19:06'!selectedBackgroundColor	"Color de fondo de contactos, bobinas y de variables (actual value).	Se aplica cuando est seleccionado."		^Color r: 51/255 g: 102/255 b: 211/255.  " (Color r: 0.2 g: 0.4 b: 0.827)"! !!PLC_GraphicElementProperties methodsFor: 'selectedColors' stamp: 'EricPernia 9/9/2015 03:21'!selectedBlockBodyColor	"Color de cuerpo del bloque.	Se aplica cuando est seleccionado."	^Color r: 51/255 g: 102/255 b: 211/255.  " (Color r: 0.2 g: 0.4 b: 0.827)"! !!PLC_GraphicElementProperties methodsFor: 'selectedColors' stamp: 'EricPernia 4/21/2012 19:06'!selectedBlockFootAndHeaderColor	"Color de cabecera y pie del bloque.	Se aplica cuando est seleccionado."	^Color r: 134/255 g: 164/255 b: 229/255. " (Color r: 0.526 g: 0.643 b: 0.898)" ! !!PLC_GraphicElementProperties methodsFor: 'selectedColors' stamp: 'EricPernia 5/15/2012 14:30'!selectedElementColor	"Color de los contactos, bobinas y del texto (actual value).	Se aplica cuando est seleccionado."		^Color white.! !!PLC_GraphicElementProperties methodsFor: 'insertionPointColors' stamp: 'EricPernia 5/16/2012 00:33'!underDragAreaInsertionPointBackgroundColor	 "Color de fondo del area de drop que se encuentra tras el cuadradito 	que representa el punto de insercin."	^Color green alpha: 0.5.! !!PLC_GraphicElementProperties methodsFor: 'insertionPointColors' stamp: 'EricPernia 5/22/2012 20:44'!underDragAreaInsertionPointBorderColor	"Color de borde del cuadradito que representa el punto de insercin. Se aplica cuando est bajo 	el rea de Dragg al rededor del mouse mientras el mouse viene arrastrando un elemento"	^Color r: 119/255 g: 136/255 b: 153/255." (Color r: 0.466 g: 0.534 b: 0.6)"! !!PLC_GraphicElementProperties methodsFor: 'insertionPointColors' stamp: 'EricPernia 5/22/2012 20:44'!underDragAreaInsertionPointColor	"Color del cuadradito que representa el punto de insercin. Se aplica cuando est bajo 	el rea de Dragg al rededor del mouse mientras el mouse viene arrastrando un elemento"	^ Color r: 218/255 g: 233/255 b: 254/255." (Color r: 0.855 g: 0.534 b: 0.996)"! !!PLC_GraphicElementProperties methodsFor: 'unselectedColors' stamp: 'EricPernia 4/22/2012 02:41'!unselectedBackgroundColor	"Color de fondo de contactos, bobinas y de variables (actual value).	Se aplica cuando est deseleccionado. Es el color por defecto del elemento."			^Color white.! !!PLC_GraphicElementProperties methodsFor: 'unselectedColors' stamp: 'EricPernia 4/22/2012 02:41'!unselectedBlockBodyColor	"Color de cuerpo del bloque.	Se aplica cuando est deseleccionado. Es el color por defecto del elemento."		^Color r: 223/255 g: 224/255 b: 232/255. "Color r: 0.875 g: 0.879 b: 0.91"! !!PLC_GraphicElementProperties methodsFor: 'unselectedColors' stamp: 'EricPernia 4/22/2012 02:40'!unselectedBlockFootAndHeaderColor	"Color de cabecera y pie del bloque.		Se aplica cuando est deseleccionado. Es el color por defecto del elemento."		^Color r: 202/255 g: 204/255 b: 217/255. "Color r: 0.792 g: 0.8 b: 0.851" "Color de bloque gris oscuro"! !!PLC_GraphicElementProperties methodsFor: 'unselectedColors' stamp: 'EricPernia 5/15/2012 14:31'!unselectedElementColor	"Color de los contactos, bobinas y del texto (actual value).	Se aplica cuando est deseleccionado. Es el color por defecto del elemento."		^Color black.! !!PLC_GraphicElementProperties methodsFor: 'otherColors' stamp: 'EricPernia 5/16/2012 00:25'!voidStateColor	  "Color que se aplica en el estado vacio. Color transparente"	^Color r: 1 g: 1 b: 1 alpha: 0.! !!PLC_CSL1_ConnectedToBlock methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 05:45'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de conexion."		aPLC_GraphicElementMorph connectedToBlockDrawElementOn: aCanvas.! !!PLC_CSL1_ConnectedToBlock methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 04:58'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph layoutRectangleExtentNotConnectedToLeftPowerRailOutput1.! !!PLC_CSL1_ConnectedToBlock methodsFor: 'position' stamp: 'EricPernia 7/7/2013 05:42'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Posicion del LayoutRectangle en este estado."		^ aPLC_GraphicElementMorph layoutRectanglePositionConnectedToBlock.! !!PLC_CSL1_ConnectedToCoil methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 05:47'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de conexion."		aPLC_GraphicElementMorph connectedToCoilDrawElementOn: aCanvas.! !!PLC_CSL1_ConnectedToCoil methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 05:04'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph layoutRectangleExtentNotConnectedToLeftPowerRailOutput1.! !!PLC_CSL1_ConnectedToCoil methodsFor: 'position' stamp: 'EricPernia 7/7/2013 05:05'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Posicion del LayoutRectangle en este estado."		^ aPLC_GraphicElementMorph layoutRectanglePositionConnectedToContactOrCoil.! !!PLC_CSL1_ConnectedToContact methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 05:48'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de conexion."		aPLC_GraphicElementMorph connectedToContactDrawElementOn: aCanvas.! !!PLC_CSL1_ConnectedToContact methodsFor: 'extent' stamp: 'EricPernia 7/14/2013 22:38'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph layoutRectangleExtentNotConnectedToLeftPowerRailOutput1.! !!PLC_CSL1_ConnectedToContact methodsFor: 'position' stamp: 'EricPernia 7/14/2013 22:38'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Posicion del LayoutRectangle en este estado."		^ aPLC_GraphicElementMorph layoutRectanglePositionConnectedToContactOrCoil.! !!PLC_CSL1_ConnectedToLeftPowerRail methodsFor: 'drawing' stamp: 'EricPernia 4/26/2013 15:02'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al estado de conexion 2 que le pida al elemento grfico que dibuje este estado de connection drawin layer.	Esto es para que cambie segun si esta en el primer pin o a partir del segundo. Ya que el segundo estado conoce por	cual numero de pin esta conectado"		aPLC_GraphicElementMorph connectionStateLayer2 drawElementOn: aCanvas for: aPLC_GraphicElementMorph.! !!PLC_CSL1_ConnectedToLeftPowerRail methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 05:06'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph connectionStateLayer2 layoutRectangleExtentFor: aPLC_GraphicElementMorph.! !!PLC_CSL1_ConnectedToLeftPowerRail methodsFor: 'position' stamp: 'EricPernia 7/7/2013 05:06'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Posicion del LayoutRectangle en este estado."	^ aPLC_GraphicElementMorph connectionStateLayer2 layoutRectanglePositionFor: aPLC_GraphicElementMorph.! !!PLC_CSL1_ConnectedToRightPowerRail methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 04:40'!layoutHorizontallyLeft: aDistanceX for: aPLC_GraphicElementMorph.	"Como esta conectado a un RPR lo alineo a izquierda de este"	aPLC_GraphicElementMorph connectedToRightPowerRailLayoutHorizontallyLeft: aDistanceX.! !!PLC_CSL1_ConnectedToRightPowerRail methodsFor: 'extent' stamp: 'EricPernia 7/14/2013 22:38'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph layoutRectangleExtentNotConnectedToLeftPowerRailOutput1.! !!PLC_CSL1_ConnectedToRightPowerRail methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 04:48'!layoutRectangleFor: aGraphicElement	"Devuelve el layout Rectangle del elemento en este estado. Se usa para cambiar el 	layoutRecgatngle de la bobina segun a que esta conectada, si a RPR u otra cosa"		^ aGraphicElement connectedToRightPowerRailLayoutRectangle.! !!PLC_CSL1_ConnectedToRightPowerRail methodsFor: 'position' stamp: 'EricPernia 7/14/2013 22:37'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Posicion del LayoutRectangle en este estado."		^ aPLC_GraphicElementMorph layoutRectanglePositionConnectedToContactOrCoil.! !!PLC_CSL1_LeftAndRightConnectedToVerticalLink methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 04:34'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph leftAndRightConnectedToVerticalLinkLayoutRectangleExtent.! !!PLC_CSL1_LeftAndRightConnectedToVerticalLink methodsFor: 'position' stamp: 'EricPernia 7/7/2013 18:53'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px] en este estado."		^ aPLC_GraphicElementMorph leftAndRightConnectedToVerticalLinkLayoutRectanglePosition.! !!PLC_CSL1_LeftAndRightConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 22:51'!leftConnectedToVerticalLinkFor: aPLC_GraphicElementMorph	"No cambia nada pues ya est en el estado de conexion"! !!PLC_CSL1_LeftAndRightConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 22:51'!rightConnectedToVerticalLinkFor: aPLC_GraphicElementMorph	"No cambia nada pues ya est en el estado de conexion"! !!PLC_CSL1_LeftConnectedToVerticalLink methodsFor: 'drawing' stamp: 'EricPernia 7/6/2013 02:24'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer."		aPLC_GraphicElementMorph drawDoubleArrowOn: aCanvas.! !!PLC_CSL1_LeftConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 23:11'!layoutHorizontallyLeft: aDistanceX for: aPLC_GraphicElementMorph.	"Como NO esta conectado a un RPR solo alineo el elemento a aDistanceX como si fuese un contacto."		aPLC_GraphicElementMorph layoutLeft: aDistanceX.! !!PLC_CSL1_LeftConnectedToVerticalLink methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 04:34'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph leftConnectedToVerticalLinkLayoutRectangleExtent.! !!PLC_CSL1_LeftConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 23:12'!layoutRectangleFor: aPLC_GraphicElementMorph	"Devuelve el layout Rectangle del elemento en este estado. Se usa para cambiar el 	layoutRecgatngle de la bobina segun a que esta conectada, si a RPR u otra cosa"		^ aPLC_GraphicElementMorph defaultLayoutRectangle.! !!PLC_CSL1_LeftConnectedToVerticalLink methodsFor: 'position' stamp: 'EricPernia 7/7/2013 18:53'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px] en este estado."		^ aPLC_GraphicElementMorph leftConnectedToVerticalLinkLayoutRectanglePosition.! !!PLC_CSL1_LeftConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 23:13'!leftConnectedToVerticalLinkFor: aPLC_GraphicElementMorph	"No cambia nada pues ya est en el estado de conexion"	! !!PLC_CSL1_LeftConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 23:13'!rightConnectedToVerticalLinkFor: aPLC_GraphicElementMorph	"Cambia el estado de conexion"	aPLC_GraphicElementMorph leftAndRightConnectedToVerticalLink.! !!PLC_CSL1_PinFromBooleanFormalParameter methodsFor: 'drawing' stamp: 'EricPernia 7/15/2012 04:07'!elementColor	"Color del elemento"	^ PLC_GraphicElementProperties uniqueInstance booleanVariablePinColor.! !!PLC_CSL1_PinFromNotBooleanFormalParameter methodsFor: 'drawing' stamp: 'EricPernia 7/15/2012 04:08'!elementColor	"Color del elemento"	^ PLC_GraphicElementProperties uniqueInstance nonBooleanVariablePinColor.! !!PLC_CSL1_RightConnectedToVerticalLink methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 04:27'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer.	NO HACE NADA PARA COMPATIBILIDAD CON ESTADO DE RPR"! !!PLC_CSL1_RightConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 05:06'!layoutHorizontallyLeft: aDistanceX for: aPLC_GraphicElementMorph.	"Como NO esta conectado a un RPR solo alineo el elemento a aDistanceX como si fuese un contacto."		aPLC_GraphicElementMorph layoutLeft: aDistanceX.! !!PLC_CSL1_RightConnectedToVerticalLink methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 04:36'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph rightConnectedToVerticalLinkLayoutRectangleExtent.! !!PLC_CSL1_RightConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 05:07'!layoutRectangleFor: aPLC_GraphicElementMorph	"Devuelve el layout Rectangle del elemento en este estado. Se usa para cambiar el 	layoutRecgatngle de la bobina segun a que esta conectada, si a RPR u otra cosa"		^ aPLC_GraphicElementMorph defaultLayoutRectangle.! !!PLC_CSL1_RightConnectedToVerticalLink methodsFor: 'position' stamp: 'EricPernia 7/7/2013 18:52'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px] en este estado."		^ aPLC_GraphicElementMorph rightConnectedToVerticalLinkLayoutRectanglePosition.! !!PLC_CSL1_RightConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 18:34'!leftConnectedToVerticalLinkFor: aPLC_GraphicElementMorph	"Cambia el estado de conexion"	aPLC_GraphicElementMorph leftAndRightConnectedToVerticalLink.	! !!PLC_CSL1_RightConnectedToVerticalLink methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 18:35'!rightConnectedToVerticalLinkFor: aPLC_GraphicElementMorph	"No cambia nada pues ya est en el estado de conexion"! !!PLC_CSL1_Void methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 06:02'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer.	NO HACE NADA PARA COMPATIBILIDAD CON ESTADO DE RPR"! !!PLC_CSL1_Void methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 04:44'!layoutHorizontallyLeft: aDistanceX for: aPLC_GraphicElementMorph.	"Como NO esta conectado a un RPR solo alineo el elemento a aDistanceX como si fuese un contacto."	aPLC_GraphicElementMorph voidLayoutHorizontallyLeft: aDistanceX.! !!PLC_CSL1_Void methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 17:27'!layoutRectangleExtentFor: aPLC_GraphicElementMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_GraphicElementMorph voidLayoutRectangleExtent.! !!PLC_CSL1_Void methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 04:49'!layoutRectangleFor: aGraphicElement	"Devuelve el layout Rectangle del elemento en este estado. Se usa para cambiar el 	layoutRecgatngle de la bobina segun a que esta conectada, si a RPR u otra cosa"		^ aGraphicElement voidLayoutRectangle.! !!PLC_CSL1_Void methodsFor: 'position' stamp: 'EricPernia 7/7/2013 18:52'!layoutRectanglePositionFor: aPLC_GraphicElementMorph	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px] en este estado."		^ aPLC_GraphicElementMorph voidLayoutRectanglePosition.! !!PLC_CSL1_Void methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 18:32'!leftConnectedToVerticalLinkFor: aPLC_GraphicElementMorph	"Cambia el estado de conexion"	aPLC_GraphicElementMorph connectionStateLayer1: PLC_GraphicElementState leftConnectedToVerticalLink.	aPLC_GraphicElementMorph changed.! !!PLC_CSL1_Void methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 17:40'!rightConnectedToVerticalLinkFor: aPLC_GraphicElementMorph	"Cambia el estado de conexion"	aPLC_GraphicElementMorph connectionStateLayer1: PLC_GraphicElementState rightConnectedToVerticalLink.	aPLC_GraphicElementMorph changed.! !!PLC_CSL2_ConnectedToLeftPowerRailTroughFirstOutputPin methodsFor: 'drawing' stamp: 'EricPernia 7/16/2013 14:32'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer."		aPLC_GraphicElementMorph connectedToLeftPowerRailTroughFirstOutputPinDrawElementOn: aCanvas.! !!PLC_CSL2_ConnectedToLeftPowerRailTroughFirstOutputPin methodsFor: 'layout' stamp: 'EricPernia 4/27/2013 03:49'!layoutHorizontallyLeft: aDistanceX for: aGraphicElement.	"aGraphicElement se posiciona  de alguna manera con respecto a aDistanceX. 	aGraphicElement solo se mueve horizontalmente."		"Alineo el elemento a aDistanceX"	aGraphicElement layoutLeft: aDistanceX.		"Si esta posicion en X es menor que estar a la derecha de 5 anchos de grilla entonces la fuerzo a ese valor"	( aGraphicElement layoutRectangle left < ( (aGraphicElement gridExtent x * 5) + aGraphicElement gridOrigin x ) )		ifTrue: [ 			aGraphicElement layoutLeft: ( (aGraphicElement gridExtent x * 5) + aGraphicElement gridOrigin x). 			].! !!PLC_CSL2_ConnectedToLeftPowerRailTroughFirstOutputPin methodsFor: 'extent' stamp: 'EricPernia 4/29/2013 00:02'!layoutRectangleExtentFor: aPLC_RightRailMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_RightRailMorph layoutRectangleExtentConnectedToLeftPowerRailOutput1.! !!PLC_CSL2_ConnectedToLeftPowerRailTroughFirstOutputPin methodsFor: 'position' stamp: 'EricPernia 4/28/2013 23:22'!layoutRectanglePositionFor: aPLC_RightRailMorph	"Posicion del LayoutRectangle en este estado."		^ aPLC_RightRailMorph layoutRectanglePositionConnectedToLeftPowerRailOutput1.! !!PLC_CSL2_NotConnectedToLeftPowerRailTroughFirstOutputPin methodsFor: 'drawing' stamp: 'EricPernia 7/16/2013 14:32'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer."		aPLC_GraphicElementMorph notConnectedToLeftPowerRailTroughFirstOutputPinDrawElementOn: aCanvas.! !!PLC_CSL2_NotConnectedToLeftPowerRailTroughFirstOutputPin methodsFor: 'layout' stamp: 'EricPernia 4/27/2013 03:48'!layoutHorizontallyLeft: aDistanceX for: aGraphicElement.	"aGraphicElement se posiciona  de alguna manera con respecto a aDistanceX. 	aGraphicElement solo se mueve horizontalmente."		"Alineo el elemento a aDistanceX"	aGraphicElement layoutLeft: aDistanceX.! !!PLC_CSL2_NotConnectedToLeftPowerRailTroughFirstOutputPin methodsFor: 'extent' stamp: 'EricPernia 7/14/2013 22:40'!layoutRectangleExtentFor: aPLC_RightRailMorph	"Tamao del LayoutRectangle en este estado"		^ aPLC_RightRailMorph layoutRectangleExtentNotConnectedToLeftPowerRailOutput1.! !!PLC_CSL2_NotConnectedToLeftPowerRailTroughFirstOutputPin methodsFor: 'position' stamp: 'EricPernia 7/7/2013 04:21'!layoutRectanglePositionFor: aPLC_RightRailMorph	"Posicion del LayoutRectangle en este estado."		^ aPLC_RightRailMorph layoutRectanglePositionConnectedToLeftPowerRail.! !!PLC_CSL2_PinFallingEdge methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 04:21'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer."		aPLC_GraphicElementMorph drawDoubleArrowOn: aCanvas.! !!PLC_CSL2_PinNegated methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 04:22'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer."		aPLC_GraphicElementMorph drawDoubleArrowOn: aCanvas.! !!PLC_CSL2_PinNormal methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 04:22'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer."		aPLC_GraphicElementMorph drawDoubleArrowOn: aCanvas.! !!PLC_CSL2_PinRisingEdge methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 04:22'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer."		aPLC_GraphicElementMorph drawDoubleArrowOn: aCanvas.! !!PLC_GraphicElementState class methodsFor: 'instance creation' stamp: 'EricPernia 4/12/2012 06:46'!clearStates	"Borra las instancias creadas"	States := Dictionary new.	StatesCreated := false.	! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 02:26'!connectedToBlock	"Devuelve la nica instancia del estado connectedToBlock"		StatesCreated ifFalse: [self createStates].		^ States at: #connectedToBlock.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 02:26'!connectedToCoil	"Devuelve la nica instancia del estado rightRailConnectedToCoil"		StatesCreated ifFalse: [self createStates].		^ States at: #connectedToCoil.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 02:24'!connectedToContact	"Devuelve la nica instancia del estado connectedToContact"		StatesCreated ifFalse: [self createStates].		^ States at: #connectedToContact.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 02:23'!connectedToLeftPowerRail	"Devuelve la nica instancia del estado connectedToLeftPowerRail"		StatesCreated ifFalse: [self createStates].		^ States at: #connectedToLeftPowerRail! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL2' stamp: 'EricPernia 7/7/2013 02:22'!connectedToLeftPowerRailTroughFirstOutputPin 	"Devuelve la nica instancia del estado connectedToLeftPowerRailTroughFirstOutputPin"		StatesCreated ifFalse: [self createStates].		^ States at: #connectedToLeftPowerRailTroughFirstOutputPin! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 04:08'!connectedToRightPowerRail	"Devuelve la nica instancia del estado connectedToRightPowerRail"		StatesCreated ifFalse: [self createStates].		^ States at: #connectedToRightPowerRail.! !!PLC_GraphicElementState class methodsFor: 'instance creation' stamp: 'EricPernia 4/29/2015 03:21'!createStates	"Crea las instancias nicas de los estados"	States := Dictionary new.					"User Interaction State"		States at: #voidState 		put: PLC_UIS_VoidState new.		"User Interaction State Layer 1"		States at: #selected 		put: PLC_UISL1_Selected new.	States at: #unselected 		put: PLC_UISL1_Unselected new.	States at: #draggingAnother 		put: PLC_UISL1_DraggingAnother new.	States at: #draggingSelf 		put: PLC_UISL1_DraggingSelf new.		"User Interaction State Layer 2"		States at: #keyboardFocus 		put: PLC_UISL2_KeyboardFocus new.	States at: #underDragArea 		put: PLC_UISL2_UnderDragArea new.	States at: #overDropArea 		put: PLC_UISL2_OverDropArea new.		"User Interaction State Layer 3"		States at: #mouseOver put: PLC_UISL3_MouseOver new.		" Connection State Layer 1"		States at: #voidCSL1 		put: PLC_CSL1_Void new.	States at: #connectedToLeftPowerRail 		put: PLC_CSL1_ConnectedToLeftPowerRail new.	States at: #connectedToRightPowerRail 		put: PLC_CSL1_ConnectedToRightPowerRail new.	States at: #connectedToContact 		put: PLC_CSL1_ConnectedToContact new.	States at: #connectedToCoil 		put: PLC_CSL1_ConnectedToCoil new.	States at: #connectedToBlock 		put: PLC_CSL1_ConnectedToBlock new.	States at: #leftConnectedToVerticalLink 		put: PLC_CSL1_LeftConnectedToVerticalLink new.	States at: #rightConnectedToVerticalLink 		put: PLC_CSL1_RightConnectedToVerticalLink new.	States at: #leftAndRightConnectedToVerticalLink 		put: PLC_CSL1_LeftAndRightConnectedToVerticalLink new.			States at: #pinFromBooleanFormalParameter		put: PLC_CSL1_PinFromBooleanFormalParameter new.	States at: #pinFromNotBooleanFormalParameter		put: PLC_CSL1_PinFromNotBooleanFormalParameter new.			"Connection State Layer 2"		States at: #connectedToLeftPowerRailTroughFirstOutputPin 		put: PLC_CSL2_ConnectedToLeftPowerRailTroughFirstOutputPin new.	States at: #notConnectedToLeftPowerRailTroughFirstOutputPin 		put: PLC_CSL2_NotConnectedToLeftPowerRailTroughFirstOutputPin new.			States at: #pinNormal 		put: PLC_CSL2_PinNormal new.	States at: #pinNegated 		put: PLC_CSL2_PinNegated new.	States at: #pinRisingEdge 		put: PLC_CSL2_PinRisingEdge new.	States at: #pinFallingEdge 		put: PLC_CSL2_PinFallingEdge new.					StatesCreated := true.! !!PLC_GraphicElementState class methodsFor: 'instance creation UISL1' stamp: 'EricPernia 4/12/2012 07:13'!draggingAnother 	"Devuelve la nica instancia del estado arrastrando otro morph"		StatesCreated ifFalse: [self createStates].		^ States at: #draggingAnother."	^ PLC_DraggingAnother new."! !!PLC_GraphicElementState class methodsFor: 'instance creation UISL1' stamp: 'EricPernia 4/12/2012 07:14'!draggingSelf 	"Devuelve la nica instancia del estado arrastrando a el mismo"		StatesCreated ifFalse: [self createStates].		^ States at: #draggingSelf."	^ PLC_DraggingSelf new."! !!PLC_GraphicElementState class methodsFor: 'class initialization' stamp: 'EricPernia 7/15/2013 02:23'!initialize	super initialize.	StatesCreated ifNil: [		StatesCreated := false		].! !!PLC_GraphicElementState class methodsFor: 'instance creation UISL2' stamp: 'EricPernia 4/12/2012 07:08'!keyboardFocus	"Devuelve la nica instancia del estado con foco del teclado"		StatesCreated ifFalse: [self createStates].		^ States at: #keyboardFocus.			"^ PLC_keyboardFocus new."! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 04:09'!leftAndRightConnectedToVerticalLink	"Devuelve la nica instancia del estado leftAndRightConnectedToVerticalLink"		StatesCreated ifFalse: [self createStates].		^ States at: #leftAndRightConnectedToVerticalLink.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 04:09'!leftConnectedToVerticalLink	"Devuelve la nica instancia del estado leftConnectedToVerticalLink"		StatesCreated ifFalse: [self createStates].		^ States at: #leftConnectedToVerticalLink.! !!PLC_GraphicElementState class methodsFor: 'instance creation UISL3' stamp: 'EricPernia 4/12/2012 07:08'!mouseOver	"Devuelve la nica instancia del sub estado cuando el mouse esta sobre el elemento"		StatesCreated ifFalse: [self createStates].		^ States at: #mouseOver.		"^ PLC_MouseOver new."! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL2' stamp: 'EricPernia 7/7/2013 02:21'!notConnectedToLeftPowerRailTroughFirstOutputPin	"Devuelve la nica instancia del estado notConnectedToLeftPowerRailTroughFirstOutputPin"		StatesCreated ifFalse: [self createStates].		^ States at: #notConnectedToLeftPowerRailTroughFirstOutputPin! !!PLC_GraphicElementState class methodsFor: 'instance creation UISL1' stamp: 'EricPernia 5/14/2012 18:28'!overDropArea 	"Devuelve la nica instancia del estado"		StatesCreated ifFalse: [self createStates].		^ States at: #overDropArea.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL2' stamp: 'EricPernia 7/7/2013 04:05'!pinFallingEdge	"Devuelve la nica instancia del estado pinFallingEdge"		StatesCreated ifFalse: [self createStates].		^ States at: #pinFallingEdge.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 04:17'!pinFromBooleanFormalParameter	"Devuelve la nica instancia del estado pinFromBooleanFormalParameter"		StatesCreated ifFalse: [self createStates].		^ States at: #pinFromBooleanFormalParameter.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 04:17'!pinFromNotBooleanFormalParameter	"Devuelve la nica instancia del estado pinFromNotBooleanFormalParameter"		StatesCreated ifFalse: [self createStates].		^ States at: #pinFromNotBooleanFormalParameter.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL2' stamp: 'EricPernia 7/7/2013 04:04'!pinNegated	"Devuelve la nica instancia del estado pinNegated"		StatesCreated ifFalse: [self createStates].		^ States at: #pinNegated.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL2' stamp: 'EricPernia 7/7/2013 04:04'!pinNormal	"Devuelve la nica instancia del estado pinNormal"		StatesCreated ifFalse: [self createStates].		^ States at: #pinNormal.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL2' stamp: 'EricPernia 7/7/2013 04:05'!pinRisingEdge	"Devuelve la nica instancia del estado pinRisingEdge"		StatesCreated ifFalse: [self createStates].		^ States at: #pinRisingEdge.! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 02:28'!rightConnectedToVerticalLink	"Devuelve la nica instancia del estado rightConnectedToVerticalLink"		StatesCreated ifFalse: [self createStates].		^ States at: #rightConnectedToVerticalLink.! !!PLC_GraphicElementState class methodsFor: 'instance creation UISL1' stamp: 'EricPernia 4/12/2012 06:48'!selected	"Devuelve la nica instancia del estado seleccionado"		StatesCreated ifFalse: [self createStates].		^ States at: #selected.	"^ PLC_Selected new."		! !!PLC_GraphicElementState class methodsFor: 'instance creation UISL1' stamp: 'EricPernia 5/14/2012 18:28'!underDragArea 	"Devuelve la nica instancia del estado"		StatesCreated ifFalse: [self createStates].		^ States at: #underDragArea.! !!PLC_GraphicElementState class methodsFor: 'instance creation UISL1' stamp: 'EricPernia 4/12/2012 07:05'!unselected	"Devuelve la nica instancia del estado desseleccionado"		StatesCreated ifFalse: [self createStates].		^ States at: #unselected."	^ PLC_Unselected new."! !!PLC_GraphicElementState class methodsFor: 'instance creation CSL1' stamp: 'EricPernia 7/7/2013 04:17'!voidCSL1	"Devuelve la nica instancia del estado voidCSL1"		StatesCreated ifFalse: [self createStates].		^ States at: #voidCSL1.! !!PLC_GraphicElementState class methodsFor: 'instance creation UIS' stamp: 'EricPernia 5/16/2012 01:18'!voidState	"Devuelve la nica instancia del estado seleccionado"		StatesCreated ifFalse: [self createStates].		^ States at: #voidState.	"^ PLC_VoidState new."! !!PLC_GraphicElementState methodsFor: 'drawing' stamp: 'EricPernia 7/7/2013 04:51'!drawElementOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que dibuje este estado de connection drawin layer."! !!PLC_GraphicElementState methodsFor: 'drawing' stamp: 'EricPernia 5/14/2012 17:48'!drawOn: aCanvas from: aPLC_GraphicElementMorph.	"No dibuja nada. Para no tener que repetirlo en las subclases."	! !!PLC_GraphicElementState methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 21:25'!layoutHorizontallyLeft: aDistanceX for: aPLC_GraphicElementMorph.	"Como NO esta conectado a un RPR solo alineo el elemento a aDistanceX como si fuese un contacto."	aPLC_GraphicElementMorph voidLayoutHorizontallyLeft: aDistanceX.! !!PLC_GraphicElementState methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 04:31'!layoutRectangleExtentFor: aPLC_RightRailMorph	"Tamao del LayoutRectangle en este estado"! !!PLC_GraphicElementState methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 04:31'!layoutRectangleFor: aGraphicElement	"Devuelve el layout Rectangle del elemento en este estado. Se usa para cambiar el 	layoutRecgatngle de la bobina segun a que esta conectada, si a RPR u otra cosa"! !!PLC_GraphicElementState methodsFor: 'position' stamp: 'EricPernia 7/7/2013 04:31'!layoutRectanglePositionFor: aPLC_RightRailMorph	"Posicion del LayoutRectangle en este estado."! !!PLC_UISL1_DraggingAnother methodsFor: 'drawing' stamp: 'EricPernia 4/29/2015 03:27'!backgroundColor	"Color de fondo del elemento"	^ PLC_GraphicElementProperties uniqueInstance draggingAnotherBackgroundColor.! !!PLC_UISL1_DraggingAnother methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:30'!blockBodyColor 	"Color de cuerpo del bloque"	^ PLC_GraphicElementProperties uniqueInstance draggingAnotherBlockBodyColor.! !!PLC_UISL1_DraggingAnother methodsFor: 'drawing' stamp: 'EricPernia 6/13/2012 21:02'!blockFootAndHeaderColor	"Color de cabecera y pie del bloque"	^ PLC_GraphicElementProperties uniqueInstance draggingAnotherBlockFootAndHeaderColor.! !!PLC_UISL1_DraggingAnother methodsFor: 'states' stamp: 'EricPernia 4/27/2013 03:35'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que se dibuje, este estado de drawin layer 1conoce los colores."		aPLC_GraphicElementMorph drawBackgroundOn: aCanvas;		drawElementOn: aCanvas.! !!PLC_UISL1_DraggingAnother methodsFor: 'states' stamp: 'EricPernia 6/25/2013 02:02'!elementColor	"Color del elemento"	^ PLC_GraphicElementProperties uniqueInstance draggingAnotherElementColor.! !!PLC_UISL1_DraggingAnother methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:15'!keyboardFocus	"Devuelve un estado keyboard focusr solo si le llega este mensaje a 	un estado de drawingLayer1 y es selected o unselected."	^ PLC_GraphicElementState voidState.! !!PLC_UISL1_DraggingAnother methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:06'!mouseOver	"Devuelve un estado mouse over solo si le llega este mensaje a 	un estado de drawingLayer1 y es unselected."	^ PLC_GraphicElementState voidState.! !!PLC_UISL1_DraggingAnother methodsFor: 'drawing' stamp: 'EricPernia 5/28/2012 17:42'!textColor	"Color de texto del elemento"	^ self elementColor.! !!PLC_UISL1_DraggingAnother2 methodsFor: 'drawing' stamp: 'EricPernia 4/29/2015 03:28'!backgroundColor	"Color de fondo del elemento"	^ PLC_GraphicElementProperties uniqueInstance draggingAnotherBackgroundColor2.! !!PLC_UISL1_DraggingSelf methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:29'!backgroundColor	"Color de fondo del elemento"	^ PLC_GraphicElementProperties uniqueInstance draggingSelfBackgroundColor.! !!PLC_UISL1_DraggingSelf methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:28'!blockBodyColor 	"Color de cuerpo del bloque"	^ PLC_GraphicElementProperties uniqueInstance draggingSelfBlockBodyColor.! !!PLC_UISL1_DraggingSelf methodsFor: 'drawing' stamp: 'EricPernia 6/13/2012 21:02'!blockFootAndHeaderColor	"Color de cabecera y pie del bloque"	^ PLC_GraphicElementProperties uniqueInstance draggingSelfBlockFootAndHeaderColor.! !!PLC_UISL1_DraggingSelf methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:35'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que se dibuje, este estado de drawin layer 1conoce los colores."		aPLC_GraphicElementMorph drawBackgroundOn: aCanvas;		drawElementOn: aCanvas.! !!PLC_UISL1_DraggingSelf methodsFor: 'drawing' stamp: 'EricPernia 6/25/2013 02:03'!elementColor	"Color del elemento"	^ PLC_GraphicElementProperties uniqueInstance draggingSelfElementColor.! !!PLC_UISL1_DraggingSelf methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:15'!keyboardFocus	"Devuelve un estado keyboard focusr solo si le llega este mensaje a 	un estado de drawingLayer1 y es selected o unselected."	^ PLC_GraphicElementState voidState.! !!PLC_UISL1_DraggingSelf methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:06'!mouseOver	"Devuelve un estado mouse over solo si le llega este mensaje a 	un estado de drawingLayer1 y es unselected."	^ PLC_GraphicElementState voidState.! !!PLC_UISL1_DraggingSelf methodsFor: 'states' stamp: 'EricPernia 5/28/2012 17:42'!textColor	"Color de texto del elemento"	^ self elementColor.! !!PLC_UISL1_Selected methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:27'!backgroundColor	"Color de fondo del elemento"	^ PLC_GraphicElementProperties uniqueInstance selectedBackgroundColor.! !!PLC_UISL1_Selected methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:27'!blockBodyColor 	"Color de cuerpo del bloque"	^ PLC_GraphicElementProperties uniqueInstance selectedBlockBodyColor.! !!PLC_UISL1_Selected methodsFor: 'drawing' stamp: 'EricPernia 6/13/2012 21:01'!blockFootAndHeaderColor	"Color de cabecera y pie del bloque"	^ PLC_GraphicElementProperties uniqueInstance selectedBlockFootAndHeaderColor.! !!PLC_UISL1_Selected methodsFor: 'states' stamp: 'EricPernia 4/27/2013 03:35'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que se dibuje, este estado de drawin layer 1conoce los colores."		aPLC_GraphicElementMorph drawBackgroundOn: aCanvas;		drawElementOn: aCanvas.! !!PLC_UISL1_Selected methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:27'!elementColor	"Color del elemento"	^ PLC_GraphicElementProperties uniqueInstance selectedElementColor.! !!PLC_UISL1_Selected methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:14'!keyboardFocus	"Devuelve un estado keyboard focusr solo si le llega este mensaje a 	un estado de drawingLayer1 y es selected o unselected."	^ PLC_GraphicElementState keyboardFocus.! !!PLC_UISL1_Selected methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:06'!mouseOver	"Devuelve un estado mouse over solo si le llega este mensaje a 	un estado de drawingLayer1 y es unselected."	^ PLC_GraphicElementState voidState.! !!PLC_UISL1_Selected methodsFor: 'states' stamp: 'EricPernia 5/28/2012 17:42'!textColor	"Color de texto del elemento"	^ self elementColor.! !!PLC_UISL1_Unselected methodsFor: 'drawing' stamp: 'EricPernia 4/29/2015 03:26'!backgroundColor	"Color de fondo del elemento"	^ PLC_GraphicElementProperties uniqueInstance unselectedBackgroundColor.! !!PLC_UISL1_Unselected methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:01'!blockBodyColor 	"Color de cuerpo del bloque"	^ PLC_GraphicElementProperties uniqueInstance unselectedBlockBodyColor.! !!PLC_UISL1_Unselected methodsFor: 'drawing' stamp: 'EricPernia 6/13/2012 21:01'!blockFootAndHeaderColor	"Color de cabecera y pie del bloque"	^ PLC_GraphicElementProperties uniqueInstance unselectedBlockFootAndHeaderColor.! !!PLC_UISL1_Unselected methodsFor: 'states' stamp: 'EricPernia 4/27/2013 03:34'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que se dibuje, este estado de drawin layer 1conoce los colores."		aPLC_GraphicElementMorph drawBackgroundOn: aCanvas;		drawElementOn: aCanvas.! !!PLC_UISL1_Unselected methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 22:57'!elementColor	"Color del elemento"	^ PLC_GraphicElementProperties uniqueInstance unselectedElementColor.! !!PLC_UISL1_Unselected methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:14'!keyboardFocus	"Devuelve un estado keyboard focusr solo si le llega este mensaje a 	un estado de drawingLayer1 y es selected o unselected."	^ PLC_GraphicElementState keyboardFocus.! !!PLC_UISL1_Unselected methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:06'!mouseOver	"Devuelve un estado mouse over solo si le llega este mensaje a 	un estado de drawingLayer1 y es unselected."	^ PLC_GraphicElementState mouseOver.! !!PLC_UISL1_Unselected methodsFor: 'states' stamp: 'EricPernia 5/28/2012 17:41'!textColor	"Color de texto del elemento"	^ self elementColor.! !!PLC_UISL1_Unselected2 methodsFor: 'drawing' stamp: 'EricPernia 4/29/2015 03:28'!backgroundColor	"Color de fondo del elemento"	^ PLC_GraphicElementProperties uniqueInstance unselectedBackgroundColor2.! !!PLC_UISL2_KeyboardFocus methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:34'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"El borde de linea punteada al rededor del elemento que tiene el foco del teclado."		"NOTA: Como siempre tiene como elemento al ultimo que le dieron el foco del teclado	en su variable interna graphicElementMorph entonces cada vez que creo un elemento	nuevo solo se va a poder dibujar la linea punteada en este ultimo ya que cambia como	el estado es nico le cambia su variable graphicElementMorph. Graficamente solo 1 	elemento va a tener el foco del teclado. Aunque en internamente lo pueda tener. Esto	de que exista un nico objeto con el foco del teclado lo maneja la Network."		aCanvas		frameRectangle: aPLC_GraphicElementMorph backgroundRectangle		width: PLC_GraphicElementProperties uniqueInstance dashBorderSize		colors:PLC_GraphicElementProperties uniqueInstance dashColors		dashes: PLC_GraphicElementProperties uniqueInstance dashLengths.! !!PLC_UISL2_OverDropArea methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:34'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que se dibuje, este estado de drawin layer 1conoce los colores."		aPLC_GraphicElementMorph drawBackgroundOn: aCanvas;		drawElementOn: aCanvas.! !!PLC_UISL2_OverDropArea methodsFor: 'drawing' stamp: 'EricPernia 5/21/2012 18:20'!insertionPointBackgroundColor	"Color del rea de drop del punto de insercin. Se aplica al fondo del punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance overDropAreaInsertionPointBackgroundColor.! !!PLC_UISL2_OverDropArea methodsFor: 'drawing' stamp: 'EricPernia 5/16/2012 00:01'!insertionPointBorderColor	"Color de borde del cuadradito que representa el punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance overDropAreaInsertionPointBorderColor.! !!PLC_UISL2_OverDropArea methodsFor: 'drawing' stamp: 'EricPernia 5/16/2012 00:01'!insertionPointColor	"Color del cuadradito que representa el punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance overDropAreaInsertionPointColor.! !!PLC_UISL2_UnderDragArea methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:33'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que se dibuje, este estado de drawin layer 1conoce los colores."		aPLC_GraphicElementMorph drawBackgroundOn: aCanvas;		drawElementOn: aCanvas.! !!PLC_UISL2_UnderDragArea methodsFor: 'drawing' stamp: 'EricPernia 5/21/2012 18:21'!insertionPointBackgroundColor	"Color del rea de drop del punto de insercin. Se aplica al fondo del punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance underDragAreaInsertionPointBackgroundColor.! !!PLC_UISL2_UnderDragArea methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:36'!insertionPointBorderColor	"Color de borde del cuadradito que representa el punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance underDragAreaInsertionPointBorderColor.! !!PLC_UISL2_UnderDragArea methodsFor: 'drawing' stamp: 'EricPernia 5/15/2012 23:36'!insertionPointColor	"Color del cuadradito que representa el punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance underDragAreaInsertionPointColor.! !!PLC_UISL3_MouseOver methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:32'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"Dibujo el color celeste con transparencia para indicar que el mouse esta sobre el elemento."		aCanvas 		fillRectangle: aPLC_GraphicElementMorph backgroundRectangle 		color: (Color r: 0.75 g: 0.75 b: 1.0 alpha: 0.4).! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 5/16/2012 00:48'!backgroundColor	"Color del rea de drop del punto de insercin. Se aplica al fondo del punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance voidStateColor.! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 5/16/2012 00:48'!blockBodyColor 	"Color de cuerpo del bloque"	^ PLC_GraphicElementProperties uniqueInstance voidStateColor.! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 6/13/2012 21:01'!blockFootAndHeaderColor	"Color de cabecera y pie del bloque"	^ PLC_GraphicElementProperties uniqueInstance voidStateColor.! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:37'!drawOn: aCanvas for: aPLC_GraphicElementMorph	"Le pide al elemento grfico que se dibuje, este estado de drawin layer 1conoce los colores."		"aPLC_GraphicElementMorph drawBackgroundOn: aCanvas;		drawElementOn: aCanvas."! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 5/16/2012 00:48'!elementColor	"Color del elemento"	^ PLC_GraphicElementProperties uniqueInstance voidStateColor.! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 5/16/2012 00:48'!insertionPointBackgroundColor	"Color del cuadradito que representa el punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance voidStateColor.! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 5/16/2012 00:48'!insertionPointBorderColor	"Color de borde del cuadradito que representa el punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance voidStateColor.! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 5/16/2012 00:48'!insertionPointColor	"Color del cuadradito que representa el punto de insercin."	^ PLC_GraphicElementProperties uniqueInstance voidStateColor.! !!PLC_UIS_VoidState methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:14'!keyboardFocus	"Devuelve un estado keyboard focusr solo si le llega este mensaje a 	un estado de drawingLayer1 y es selected o unselected."	^ PLC_GraphicElementState voidState.! !!PLC_UIS_VoidState methodsFor: 'states' stamp: 'EricPernia 5/16/2012 01:08'!mouseOver	"Devuelve un estado mouse over solo si le llega este mensaje a 	un estado de drawingLayer1 y es unselected."	^ PLC_GraphicElementState voidState.! !!PLC_UIS_VoidState methodsFor: 'drawing' stamp: 'EricPernia 5/28/2012 17:41'!textColor	"Color de texto del elemento"	^ PLC_GraphicElementProperties uniqueInstance actualValueNotDefinedColor.! !!PLC_ADD_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:05'!operator	"Operador de la instruccin"		^ 'ADD'.! !!PLC_ADD_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:05'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin aritmtica: 	currentResult := currentResult + operand'.! !!PLC_ArithmeticAndComparisonInstructions methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 16:52'!cCompile	"Devuelve el string del cdigo C de la instruccin"		| cCode operand operandDataType |		self operands ifNotEmpty: [		operand := (self operands first cCompile).		operandDataType := (self operands first dataType cCompileDataType).		].		cCode := '		PLC_IL_' ,		self operator ,		 '( &(' , 		operand , 		'), ', 		operandDataType , 		');		// ', 		self ilCompile.	^ cCode.! !!PLC_ArithmeticAndComparisonInstructions methodsFor: 'simulation' stamp: 'EricPernia 6/13/2013 00:41'!executeOn: aPLC_CPU	"Ejecuta la instruccion en la CPU aPLC_CPU"		aPLC_CPU currentResult: self operator. ! !!PLC_DIV_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:06'!operator	"Operador de la instruccin"		^ 'DIV'.! !!PLC_DIV_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:07'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin aritmtica: 	currentResult := currentResult / operand'.! !!PLC_EQ_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 00:56'!operator	"Operador de la instruccin"		^ 'EQ'.! !!PLC_EQ_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 00:56'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin de comparacin: 	currentResult := currentResult == operand'.! !!PLC_GE_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:03'!operator	"Operador de la instruccin"		^ 'GE'.! !!PLC_GE_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:03'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin de comparacin: 	currentResult := currentResult >= operand'.! !!PLC_GT_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:02'!operator	"Operador de la instruccin"		^ 'GT'.! !!PLC_GT_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:02'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin de comparacin: 	currentResult := currentResult > operand'.! !!PLC_LE_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:04'!operator	"Operador de la instruccin"		^ 'LE'.! !!PLC_LE_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:04'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin de comparacin: 	currentResult := currentResult <= operand'.! !!PLC_LT_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:03'!operator	"Operador de la instruccin"		^ 'LT'.! !!PLC_LT_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:03'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin de comparacin: 	currentResult := currentResult < operand'.! !!PLC_MOD_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:07'!operator	"Operador de la instruccin"		^ 'MOD'.! !!PLC_MOD_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:08'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin aritmtica: 	currentResult := resto de la division entera ( currentResult / operand )'.! !!PLC_MUL_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:06'!operator	"Operador de la instruccin"		^ 'MUL'.! !!PLC_MUL_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:06'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin aritmtica: 	currentResult := currentResult * operand'.! !!PLC_NE_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:01'!operator	"Operador de la instruccin"		^ 'NE'.! !!PLC_NE_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:01'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin de comparacin: 	currentResult := currentResult <> operand'.! !!PLC_SUB_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:05'!operator	"Operador de la instruccin"		^ 'SUB'.! !!PLC_SUB_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:05'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin aritmtica: 	currentResult := currentResult - operand'.! !!PLC_CAL_Instruction methodsFor: 'compilation' stamp: 'EricPernia 6/13/2013 15:52'!ilCompile	"Compila el elemento IL Instruccion CAL (llamado a Bloque de Funcin) a IL	Devuelve:			CAL FB_InstanceName ( 			inputAssignment , 			inOutAssignment , 			outputAssignment , 			) 		Por ejemplo:			CAL CMD_TMR ( 			IN :=  ENT1 , 			PT := T#300ms ,			ENO => ERR , 			Q => OUT , 			ET => ELAPSED , 			) 	"		| pouCall |	pouCall := 'CAL	' , self instanceName , ' ( '.		self inputAssignments do: [ :each |		pouCall := pouCall , '		' , each ilCompile , ','.		].					self inOutAssignments do: [ :each |		pouCall := pouCall , '		' , each ilCompile , ','.		].					self outputAssignments do: [ :each |		pouCall := pouCall , '		' , each ilCompile , ','.		].		pouCall := pouCall , '		)'.		^ pouCall.! !!PLC_IL_Instruction methodsFor: 'simulation' stamp: 'EricPernia 7/28/2012 02:43'!executeOn: aPLC_CPU	"Ejecuta la instruccion en la CPU aPLC_CPU"		! !!PLC_IL_Instruction methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 23:18'!ilCompile	"Devuelve el string del cdigo IL de la instruccin"		| ilCode |		self label = '' 		ifTrue:[			ilCode := '			' , self operator.			"Ej: 		 LD"			]		ifFalse: [			 ilCode := '		' , self label , ' ' , self operator.	"Ej: 		LABEL: LD"			]. 		self modifiers do: [ :each|		ilCode := ilCode , each ilCompile.		].									"Ej: 		LABEL: LDN"		self operands ifNotEmpty: [		ilCode := ilCode , ' ' , (self operands first ilCompile).				(2 to: operands size) do: [ :each|			ilCode := ilCode , ', ' , (self operands at: each) ilCompile.			].		]..									"Ej: 		LABEL: LDN %I0.0"		"ilCode := ilCode , ' ' , self comment."		"Ej: 		LABEL: LDN %I0.0    (* Comentario *)"		ilCode := ilCode , ''.		^ ilCode.! !!PLC_IL_Instruction methodsFor: 'initialize-release' stamp: 'EricPernia 7/28/2012 01:29'!initialize	"Inicializaciones"		self label: ''.	self modifiers: OrderedCollection new.	self operands: OrderedCollection new.	! !!PLC_IL_Instruction methodsFor: 'accessing' stamp: 'EricPernia 3/14/2012 18:20'!label	^ label! !!PLC_IL_Instruction methodsFor: 'accessing' stamp: 'EricPernia 3/14/2012 18:20'!label: anObject	label := anObject! !!PLC_IL_Instruction methodsFor: 'accessing' stamp: 'EricPernia 3/14/2012 18:20'!modifiers	^ modifiers! !!PLC_IL_Instruction methodsFor: 'accessing' stamp: 'EricPernia 3/14/2012 18:20'!modifiers: anObject	modifiers := anObject! !!PLC_IL_Instruction methodsFor: 'accessing' stamp: 'EricPernia 3/14/2012 18:20'!operands	^ operands! !!PLC_IL_Instruction methodsFor: 'accessing' stamp: 'EricPernia 3/14/2012 18:20'!operands: anObject	operands := anObject! !!PLC_LD_Instruction methodsFor: 'compilation' stamp: 'EricPernia 11/17/2013 07:28'!cCompile	"Devuelve el string del cdigo C de la instruccin"		| cCode operand operandDataType compiledModifiers |		compiledModifiers := ''.	self modifiers do: [ :each|		compiledModifiers := compiledModifiers , each cCompile.		].		self operands ifNotEmpty: [		operand := (self operands first cCompile).				operandDataType := (self operands first dataType ilCompileDataType). "ACA VA ilCompileDataType SI NO COMPILA MAL POR LO QUE REQUIERE LA INSTRUCCION"		].		"Compila en C segun si es literal u otra cosa"	self operands first isPLCLiteral 		ifTrue: [ 			"void PLC_IL_LD_BOOL_Literal( PLC_BOOL, PLC_EnumModifiers);			void PLC_IL_LD_INT_Literal( PLC_INT, PLC_EnumModifiers);"			cCode := '		PLC_IL_' ,				self operator ,				'_' ,				operandDataType, 				'_Literal( ', 				operand , 				', ', 				compiledModifiers , 				');		// ', 				self ilCompile.			]		ifFalse: [			"PLC_IL_LD( &varName, sizeof(varName), varType, modifier);			Ejemplo:			PLC_IL_LD( &sint1, sizeof(sint1), SINT, NullModifier);			"						cCode := '		PLC_IL_' ,				self operator ,				 '( &(' , 				operand , 				'), sizeof(', 				operand , 				'), ' , 				operandDataType , 				', ' , 				compiledModifiers , 				');		// ', 				self ilCompile.			].	^ cCode.! !!PLC_LD_Instruction methodsFor: 'simulation' stamp: 'EricPernia 7/28/2012 02:45'!executeOn: aPLC_CPU	"Ejecuta la instruccion en la CPU aPLC_CPU"		aPLC_CPU currentResult: self operator. ! !!PLC_LD_Instruction methodsFor: 'compilation' stamp: 'EricPernia 7/28/2012 02:29'!operator	"Operador de la instruccin"		^ 'LD'.! !!PLC_LD_Instruction methodsFor: 'compilation' stamp: 'EricPernia 7/28/2012 02:34'!semantics	"Semantica de la instruccin"		^ 'Almacena el operando en el acumulador resultado actual: 			currentResult := operand'.! !!PLC_AND_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/7/2012 15:33'!operator	"Operador de la instruccin"		^ 'AND'.! !!PLC_AND_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 00:52'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin Y (AND) lgica: 	currentResult := currentResult AND operand'.! !!PLC_LogicalInstructions methodsFor: 'as yet unclassified' stamp: 'EricPernia 11/5/2013 16:52'!cCompile	"Devuelve el string del cdigo C de la instruccin"		| cCode operand operandDataType compiledModifiers |		compiledModifiers := ''.	self modifiers do: [ :each|		compiledModifiers := compiledModifiers , each cCompile.		].		self operands ifNotEmpty: [		operand := (self operands first cCompile).		operandDataType := (self operands first dataType ilCompileDataType).		].	cCode := '		PLC_IL_' ,		self operator ,		 '( &(' , 		operand , 		'), ', 		operandDataType , 		', ' , 		compiledModifiers , 		');		// ', 		self ilCompile.	^ cCode.! !!PLC_LogicalInstructions methodsFor: 'simulation' stamp: 'EricPernia 2/19/2014 00:04'!executeOn: aPLC_CPU	"Ejecuta la instruccion en la CPU aPLC_CPU"		aPLC_CPU currentResult: ( aPLC_CPU currentResult operateWith: self operator). ! !!PLC_OR_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/7/2012 16:24'!operator	"Operador de la instruccin"		^ 'OR'.! !!PLC_OR_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 00:52'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin O (OR) lgica: 	currentResult := currentResult OR operand'.! !!PLC_XOR_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 00:57'!operator	"Operador de la instruccin"		^ 'XOR'.! !!PLC_XOR_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 00:57'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin O exclusiva (XOR) lgica: 	currentResult := currentResult XOR operand'.! !!PLC_NOT_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 11/5/2013 16:53'!cCompile	"Devuelve el string del cdigo C de la instruccin"		| cCode operandDataType |		self operands ifNotEmpty: [		operandDataType := (self operands first dataType ilCompileDataType).		].	cCode := '		PLC_IL_' ,		self operator ,		 '( ' , 		operandDataType , 		');		// ', 		self ilCompile.	^ cCode.! !!PLC_NOT_Instruction methodsFor: 'simulation' stamp: 'EricPernia 6/13/2013 00:58'!executeOn: aPLC_CPU	"Ejecuta la instruccion en la CPU aPLC_CPU"		aPLC_CPU currentResult: self operator. ! !!PLC_NOT_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:00'!operator	"Operador de la instruccin"		^ 'NOT'.! !!PLC_NOT_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:00'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin de negacion bit a bit: 	currentResult := NOT currentResult'.! !!PLC_ST_Instruction methodsFor: 'simulation' stamp: 'EricPernia 11/5/2013 16:53'!cCompile	"Devuelve el string del cdigo C de la instruccin"		| cCode operand compiledModifiers |		compiledModifiers := ''.	self modifiers do: [ :each|		compiledModifiers := compiledModifiers , each cCompile.		].		self operands ifNotEmpty: [		operand := (self operands first cCompile).		].		cCode := '		PLC_IL_' ,		self operator ,		 '( &(' , 		operand , 		'), sizeof(', 		operand , 		'), ' , 		compiledModifiers , 		');		// ', 		self ilCompile.	^ cCode.! !!PLC_ST_Instruction methodsFor: 'simulation' stamp: 'EricPernia 7/28/2012 03:07'!executeOn: aPLC_CPU	"Ejecuta la instruccion en la CPU aPLC_CPU"		self operator: aPLC_CPU currentResult.! !!PLC_ST_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 7/28/2012 01:30'!operator	"Operador de la instruccin"		^ 'ST'.! !!PLC_ST_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 7/28/2012 02:30'!semantics	"Semantica de la instruccin"		^ 'Almacena el resultado actual en la ubicacin operando: 			operand := currentResult'.! !!PLC_R_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:11'!operator	"Operador de la instruccin"		^ 'R'.! !!PLC_R_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:11'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin RESET: 	currentResult := FALSE'.! !!PLC_S_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:10'!operator	"Operador de la instruccin"		^ 'S'.! !!PLC_S_Instruction methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/13/2013 01:10'!semantics	"Semantica de la instruccin"		^ 'Realiza la operacin SET: 	currentResult := TRUE'.! !!PLC_SetAndReset methodsFor: 'as yet unclassified' stamp: 'EricPernia 11/5/2013 16:53'!cCompile	"Devuelve el string del cdigo C de la instruccin"		| cCode operand |		self operands ifNotEmpty: [		operand := (self operands first cCompile).		].		cCode := '		PLC_IL_' ,		self operator ,		 '( &(' , 		operand , 		') );		// ', 		self ilCompile.	^ cCode.! !!PLC_SetAndReset methodsFor: 'simulation' stamp: 'EricPernia 6/13/2013 01:09'!executeOn: aPLC_CPU	"Ejecuta la instruccion en la CPU aPLC_CPU"		aPLC_CPU currentResult: self operator. ! !!PLC_StandarBody_Instruction methodsFor: 'accessing' stamp: 'EricPernia 11/14/2013 14:44'!cCode		^ cCode! !!PLC_StandarBody_Instruction methodsFor: 'accessing' stamp: 'EricPernia 11/14/2013 14:44'!cCode: anObject		cCode := anObject! !!PLC_StandarBody_Instruction methodsFor: 'compilation' stamp: 'EricPernia 11/14/2013 14:45'!cCompile	"Devuelve el string del cdigo C de la instruccin"		^ self cCode.	! !!PLC_StandarBody_Instruction methodsFor: 'compilation' stamp: 'EricPernia 11/14/2013 14:43'!operator	"Operador de la instruccin"		^ 'POU estandar, no se muestra su cdigo.'.! !!PLC_StandarBody_Instruction methodsFor: 'compilation' stamp: 'EricPernia 11/14/2013 14:42'!semantics	"Semantica de la instruccin"		^ 'Instruccin que indica que es una POU estndar y por eso no se muestra su cdigo.'.! !!PLC_IL_CModifier methodsFor: 'as yet unclassified' stamp: 'EricPernia 9/18/2013 02:44'!cCompile	"Devuelve el string del cdigo C del modificador"	^ 'C'.! !!PLC_IL_CModifier methodsFor: 'as yet unclassified' stamp: 'EricPernia 9/1/2012 17:58'!ilCompile	"Devuelve el string del cdigo IL del modificador"	^ 'C'.! !!PLC_IL_Modifiers class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 20:34'!CModifier	"Devuelve la nica instancia de CModifier"		InstancesCreated ifFalse: [self createInstances].		^ Instances at: #CModifier! !!PLC_IL_Modifiers class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 20:34'!NModifier	"Devuelve la nica instancia de NModifier"		InstancesCreated ifFalse: [self createInstances].		^ Instances at: #NModifier! !!PLC_IL_Modifiers class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 20:32'!NullModifier	"Devuelve la nica instancia de NullModifier"		InstancesCreated ifFalse: [self createInstances].		^ Instances at: #NullModifier! !!PLC_IL_Modifiers class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 20:34'!ParenthesisModifier	"Devuelve la nica instancia de ParenthesisModifier"		InstancesCreated ifFalse: [self createInstances].		^ Instances at: #ParenthesisModifier! !!PLC_IL_Modifiers class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 20:31'!clearInstances	"Borra las instancias nicas creadas."	Instances := Dictionary new.	InstancesCreated := false.	! !!PLC_IL_Modifiers class methodsFor: 'instance creation' stamp: 'EricPernia 9/1/2012 20:33'!createInstances	"Crea las instancias nicas."	Instances := Dictionary new.		Instances at: #NullModifier put: PLC_IL_NullModifier new.	Instances at: #NModifier put: PLC_IL_NModifier new.	Instances at: #CModifier put: PLC_IL_CModifier new.	Instances at: #ParenthesisModifier put: PLC_IL_ParenthesisModifier new.	InstancesCreated := true.! !!PLC_IL_Modifiers class methodsFor: 'class initialization' stamp: 'EricPernia 7/15/2013 02:19'!initialize	super initialize.	InstancesCreated ifNil: [		InstancesCreated := false		].! !!PLC_IL_Modifiers methodsFor: 'testing' stamp: 'EricPernia 5/1/2013 18:37'!isNullModifier	"Devuelve True si es un modificador Nulo "	^ false.! !!PLC_IL_NModifier methodsFor: 'compile' stamp: 'EricPernia 9/10/2012 00:27'!cCompile	"Devuelve el string del cdigo IL del modificador"	^ 'N'.! !!PLC_IL_NModifier methodsFor: 'compile' stamp: 'EricPernia 9/1/2012 17:58'!ilCompile	"Devuelve el string del cdigo IL del modificador"	^ 'N'.! !!PLC_IL_NullModifier methodsFor: 'compile' stamp: 'EricPernia 11/4/2012 01:05'!cCompile	"Devuelve el string del cdigo IL del modificador"	^ 'NullModifier'.! !!PLC_IL_NullModifier methodsFor: 'compile' stamp: 'EricPernia 9/1/2012 20:23'!ilCompile	"Devuelve el string del cdigo IL del modificador"	^ ''.! !!PLC_IL_NullModifier methodsFor: 'testing' stamp: 'EricPernia 5/1/2013 18:45'!isNullModifier	"Devuelve True si es un modificador Nulo "	^ true.! !!PLC_Identifier class methodsFor: 'GUI Information' stamp: 'EricPernia 5/2/2015 17:38'!identifierFromString: aString	"Verifica si el string aString es un nombre de identificador valido, si lo es, lo retorna, si no, devuelve nil."	| identifier |		identifier := self new.		( identifier isValidStringForIdentifier: aString )		ifTrue: [			^ aString.		] 		ifFalse: [			^ nil.		]! !!PLC_Identifier class methodsFor: 'as yet unclassified' stamp: 'EricPernia 10/31/2012 00:43'!validatePLCIdentifier: aString	"Valida si el string aString es un nombre de identificador, si es as lo devuelve, si no, lanza un error."	| identifier |		identifier := self new.		( identifier isValidStringForIdentifier: aString )		ifTrue: [			^ aString.			] 		ifFalse: [			self error: 'Identificador no vlido. Cierre esta ventana y asigne un identificador segn IEC 61131-3 : 2002.'.			]! !!PLC_Identifier methodsFor: 'testing' stamp: 'EricPernia 10/31/2012 00:38'!doNotContainALastUnderlineCharacter: aString	"Responde true si NO contiene un guion bajo como ultimo caracter."	aString ifEmpty: [^false].		^( aString last = $_) not.	"Si da flase deberia mostrar este mensaje de error"		"'Entidad de PLC no vlida. No puede terminar con guion bajo.'"! !!PLC_Identifier methodsFor: 'testing' stamp: 'EricPernia 10/31/2012 00:37'!doNotContainConsecutiveUnderlines: aString	"Responde true si NO contiene guiones bajos consecutivos en el string"	aString size > 1		ifTrue: [			^(1 to: aString size - 1) allSatisfy: [ :idx | 				( ((aString at: idx) = $_) and:					((aString at: (idx +1)) = $_) ) not 				]. 			]		ifFalse: [ 			^ true.			]! !!PLC_Identifier methodsFor: 'accessing' stamp: 'EricPernia 10/31/2012 00:17'!identifier	^ identifier! !!PLC_Identifier methodsFor: 'accessing' stamp: 'EricPernia 10/31/2012 00:17'!identifier: anObject	identifier := anObject! !!PLC_Identifier methodsFor: 'initialize-release' stamp: 'EricPernia 10/31/2012 00:18'!initialize	"Inicializaciones del identificador"	self identifier: 'id'	! !!PLC_Identifier methodsFor: 'testing' stamp: 'EricPernia 5/10/2013 12:26'!isValidStringContentForIdentifier: aString	"Responde si el string contiene solo letras, dgitos y guiones bajos. 	Adems chequea que no contenga 2 o mas guiones bajos 	consecutivos para utilizarse como nombre de identificador."	^ ( aString allSatisfy: [ :each | each isLetter or: [ each isDigit or: [ each = $_ ] ] ] )  	and: [		( self underlineCorrectsForIdentifier: aString )		and: [			self isValidStringFirstCharacterForIdentifier: aString.			].		].						"Si da flase deberia mostrar este mensaje de error"	"'Identificador No vlido. Debe comenzar con una letra o guion bajo y luego puede contener letras, digitos o guiones bajos no consecutivos.'"! !!PLC_Identifier methodsFor: 'testing' stamp: 'EricPernia 10/31/2012 00:30'!isValidStringFirstCharacterForIdentifier: aString	"Responde si el string contiene una letra o guion bajo como primer caracter para utilizarse como nombre de identificador."	^ aString first isLetter or: [ aString first = $_ ].	"Si da flase deberia mostrar este mensaje de error"		"'Identificador No vlido. Debe comenzar con una letra o guion bajo y luego puede contener letras, digitos o guiones bajos.'"! !!PLC_Identifier methodsFor: 'testing' stamp: 'EricPernia 10/31/2012 00:29'!isValidStringForIdentifier: aString	"Responde si el string es un nombre de identificador vlido."	^ (self isValidStringSizeForIdentifier: aString) and: 		(self isValidStringContentForIdentifier: aString)! !!PLC_Identifier methodsFor: 'testing' stamp: 'EricPernia 10/31/2012 00:28'!isValidStringSizeForIdentifier: aString	"Responde si el string tiene el largo valido para utilizarse como nombre de identificador."	^ aString size <= 31.	"Si da flase deberia mostrar este mensaje de error"	" 'Identificador No vlido. Puede tener como mximo 31 caracteres.'"! !!PLC_Identifier methodsFor: 'testing' stamp: 'EricPernia 10/31/2012 00:28'!underlineCorrectsForIdentifier: aString	"Responde true si el string no contiene caracteres guiones bajos consecutivos y	NO contiene un guion bajo como ultimo caracter."	^ (self doNotContainConsecutiveUnderlines: aString) and:		[self doNotContainALastUnderlineCharacter: aString ].! !!PLC_Language class methodsFor: 'as yet unclassified' stamp: 'EricPernia 3/20/2016 20:35'!c	"English - United States - UTF-8"	| lang |		lang := self new.			"Image path"		lang dictionary at: 'LanguageImagePath' put: 'C'.		"List Selector"		lang dictionary at: 'List Selector -> Not selected accept' put: 'Must select any element'.	lang dictionary at: 'List Selector -> Select an element' put: 'Select an element'.	lang dictionary at: 'List Selector -> Select' put: 'Select'.	lang dictionary at: 'List Selector -> Select help' put: 'Accept selection'.	lang dictionary at: 'List Selector -> Cancel' put: 'Cancel'.	lang dictionary at: 'List Selector -> Cancel help' put: 'Cancel selection'.		"Editor Device"		lang dictionary at: 'Editor Device -> Title' put: 'Device'.	lang dictionary at: 'Editor Device -> Toolbar help -> Choose a device' put: 'Choose a device'.	lang dictionary at: 'Editor Device -> Picture' put: 'Picture'.	lang dictionary at: 'Editor Device -> Description' put: 'Description'.		"Editor POUs"		lang dictionary at: 'Editor POU -> Title' put: 'Program Organization Units (POU) editor'.	lang dictionary at: 'Editor POU -> Network' put: 'Network'.		lang dictionary at: 'Editor POU -> Toolbar help -> POU Type' put: 'POU Type: '.		lang dictionary at: 'Editor POU -> Toolbar help -> VAR' put: 'Open variable declarations'.		lang dictionary at: 'Editor POU -> Toolbar help -> Clean C' put: 'Clean C code'.	lang dictionary at: 'Editor POU -> Toolbar help -> Generate C' put: 'Generate C code'.	lang dictionary at: 'Editor POU -> Toolbar help -> Build C' put: 'Build C code'.	lang dictionary at: 'Editor POU -> Toolbar help -> Download' put: 'Download program'.	lang dictionary at: 'Editor POU -> Toolbar help -> Gen Build Download' put: 'Generate C code, build and download'.	lang dictionary at: 'Editor POU -> Toolbar help -> Save' put: 'Save POU'.	lang dictionary at: 'Editor POU -> Toolbar help -> Reset' put: 'Delete POU'.		lang dictionary at: 'Editor POU -> Toolbar help -> Contact' put: 'Add contact'.	lang dictionary at: 'Editor POU -> Toolbar help -> Coil C' put: 'Add Coil'.	lang dictionary at: 'Editor POU -> Toolbar help -> Open Branch' put: 'Open Branch'.	lang dictionary at: 'Editor POU -> Toolbar help -> Close Branch' put: 'Close Branch'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Ladder component' put: 'Add Ladder component'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Function call' put: 'Add Function call'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Function Block call' put: 'Add Function Block call'.	lang dictionary at: 'Editor POU -> Toolbar help -> Generate and view Network C code' put: 'Generate and view Network C code'.		lang dictionary at: 'Editor POU -> Toolbar help -> Delete' put: 'Delete selected'.			"Editor POU Var Decls"		lang dictionary at: 'Editor POU Var Decls -> Title' put: 'POU Variable Declarations Editor'.		lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> POU Type' put: 'POU Type: '.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> Add' put: 'Add Variable Declaration'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> Remove' put: 'Remove Variable Declaration'.		lang dictionary at: 'Editor POU Var Decls -> Toolbar -> Add' put: 'Add Variable Declaration'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar -> Remove' put: 'Remove Variable Declaration'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help2 -> Add' put: 'Open add variable declaration dialog'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help2 -> Remove' put: 'Remove selected variable declaration'.		lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err1' put: 'Select a variable'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err1 help' put: 'Select a row'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err2' put: 'Not remove:'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err2 help' put: ''.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err3' put: 'Variable declararion eliminated'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err3 help' put: ''.		lang dictionary at: 'Editor POU Var Decls -> Expander -> Interface Vars' put: 'Interface Variables'.	lang dictionary at: 'Editor POU Var Decls -> Expander -> Internal and External Vars' put: 'Internal and External Variables'.		lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Category' put: 'Category'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Name' put: 'Name'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Datatype' put: 'Datatype'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Initial value' put: 'Initial value'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Description' put: 'Description'.		lang dictionary at: 'Editor POU Var Decls -> Dialog -> Title' put: '           New Variable Declarattion             '.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Description' put: 'Description:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Description help' put: 'Write a description'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Address' put: 'Address:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Address help' put: 'Write variable Address'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Datatype' put: 'Datatype:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Datatype help' put: 'Choose a Datatype'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Identifier' put: 'Name:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Identifier help' put: 'Write a name'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Initial Value' put: 'Initial Value:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Initial Value help' put: 'Write an Initial Value'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Category' put: 'Category:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Category help' put: 'Choose a category'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> id' put: 'newVariable'.		lang dictionary at: 'Editor POU Var Decls -> Ok Button' put: 'Accept'.	lang dictionary at: 'Editor POU Var Decls -> Ok Button help' put: 'Accept changes'.	lang dictionary at: 'Editor POU Var Decls -> Cancel Button' put: 'Cancel'.	lang dictionary at: 'Editor POU Var Decls -> Cancel Button help' put: 'Close without changes'.		lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error -> title' put: 'Invalid Identifier'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error' put: 'Write another. It can`t cointain spaces or begin in digit'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error 2 -> title' put: 'Repeated Identifier'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error 2' put: 'Write another Identifier'.		"CIAA FileSystem"		lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 label' put: 'Successful compilation'.	lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents1' put: 'Overwirte previous compilation.'.	lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents2' put: 'Generated in '.		"CIAA Program Declaration"		lang dictionary at: 'CIAA Program Declaration -> Input' put: 'Input'.	lang dictionary at: 'CIAA Program Declaration -> Output' put: 'Output'.	lang dictionary at: 'CIAA Program Declaration -> Touchswitch' put: 'Touchswitch'.	lang dictionary at: 'CIAA Program Declaration -> Red Led' put: 'Red Led'.	lang dictionary at: 'CIAA Program Declaration -> Green Led' put: 'Green Led'.	lang dictionary at: 'CIAA Program Declaration -> Blue Led' put: 'Blue Led'.		"Editable Grid"		lang dictionary at: 'Editable Grid -> Category' put: 'Category'.	lang dictionary at: 'Editable Grid -> Name' put: 'Name'.	lang dictionary at: 'Editable Grid -> Datatype' put: 'Datatype'.	lang dictionary at: 'Editable Grid -> Initial value' put: 'Initial value'.	lang dictionary at: 'Editable Grid -> Description' put: 'Description'.	lang dictionary at: 'Editable Grid -> Address' put: 'Address'.	^ lang.! !!PLC_Language class methodsFor: 'as yet unclassified' stamp: 'EricPernia 3/20/2016 20:36'!enUsUtf8	"English - United States - UTF-8"	| lang |		lang := self new.			"Image path"		lang dictionary at: 'LanguageImagePath' put: 'en_US.UTF-8'.		"List Selector"		lang dictionary at: 'List Selector -> Not selected accept' put: 'Must select any element'.	lang dictionary at: 'List Selector -> Select an element' put: 'Select an element'.	lang dictionary at: 'List Selector -> Select' put: 'Select'.	lang dictionary at: 'List Selector -> Select help' put: 'Accept selection'.	lang dictionary at: 'List Selector -> Cancel' put: 'Cancel'.	lang dictionary at: 'List Selector -> Cancel help' put: 'Cancel selection'.		"Editor Device"		lang dictionary at: 'Editor Device -> Title' put: 'Device'.	lang dictionary at: 'Editor Device -> Toolbar help -> Choose a device' put: 'Choose a device'.	lang dictionary at: 'Editor Device -> Picture' put: 'Picture'.	lang dictionary at: 'Editor Device -> Description' put: 'Description'.		"Editor POUs"		lang dictionary at: 'Editor POU -> Title' put: 'Program Organization Units (POU) editor'.	lang dictionary at: 'Editor POU -> Network' put: 'Network'.		lang dictionary at: 'Editor POU -> Toolbar help -> POU Type' put: 'POU Type: '.		lang dictionary at: 'Editor POU -> Toolbar help -> VAR' put: 'Open variable declarations'.		lang dictionary at: 'Editor POU -> Toolbar help -> Clean C' put: 'Clean C code'.	lang dictionary at: 'Editor POU -> Toolbar help -> Generate C' put: 'Generate C code'.	lang dictionary at: 'Editor POU -> Toolbar help -> Build C' put: 'Build C code'.	lang dictionary at: 'Editor POU -> Toolbar help -> Download' put: 'Download program'.	lang dictionary at: 'Editor POU -> Toolbar help -> Gen Build Download' put: 'Generate C code, build and download'.	lang dictionary at: 'Editor POU -> Toolbar help -> Save' put: 'Save POU'.	lang dictionary at: 'Editor POU -> Toolbar help -> Reset' put: 'Delete POU'.		lang dictionary at: 'Editor POU -> Toolbar help -> Contact' put: 'Add contact'.	lang dictionary at: 'Editor POU -> Toolbar help -> Coil C' put: 'Add Coil'.	lang dictionary at: 'Editor POU -> Toolbar help -> Open Branch' put: 'Open Branch'.	lang dictionary at: 'Editor POU -> Toolbar help -> Close Branch' put: 'Close Branch'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Ladder component' put: 'Add Ladder component'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Function call' put: 'Add Function call'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Function Block call' put: 'Add Function Block call'.	lang dictionary at: 'Editor POU -> Toolbar help -> Generate and view Network C code' put: 'Generate and view Network C code'.		lang dictionary at: 'Editor POU -> Toolbar help -> Delete' put: 'Delete selected'.			"Editor POU Var Decls"		lang dictionary at: 'Editor POU Var Decls -> Title' put: 'POU Variable Declarations Editor'.		lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> POU Type' put: 'POU Type: '.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> Add' put: 'Add Variable Declaration'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> Remove' put: 'Remove Variable Declaration'.		lang dictionary at: 'Editor POU Var Decls -> Toolbar -> Add' put: 'Add Variable Declaration'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar -> Remove' put: 'Remove Variable Declaration'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help2 -> Add' put: 'Open add variable declaration dialog'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help2 -> Remove' put: 'Remove selected variable declaration'.		lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err1' put: 'Select a variable'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err1 help' put: 'Select a row'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err2' put: 'Not remove:'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err2 help' put: ''.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err3' put: 'Variable declararion eliminated'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err3 help' put: ''.		lang dictionary at: 'Editor POU Var Decls -> Expander -> Interface Vars' put: 'Interface Variables'.	lang dictionary at: 'Editor POU Var Decls -> Expander -> Internal and External Vars' put: 'Internal and External Variables'.		lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Category' put: 'Category'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Name' put: 'Name'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Datatype' put: 'Datatype'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Initial value' put: 'Initial value'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Description' put: 'Description'.		lang dictionary at: 'Editor POU Var Decls -> Dialog -> Title' put: '           New Variable Declarattion             '.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Description' put: 'Description:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Description help' put: 'Write a description'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Address' put: 'Address:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Address help' put: 'Write variable Address'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Datatype' put: 'Datatype:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Datatype help' put: 'Choose a Datatype'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Identifier' put: 'Name:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Identifier help' put: 'Write a name'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Initial Value' put: 'Initial Value:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Initial Value help' put: 'Write an Initial Value'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Category' put: 'Category:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Category help' put: 'Choose a category'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> id' put: 'newVariable'.		lang dictionary at: 'Editor POU Var Decls -> Ok Button' put: 'Accept'.	lang dictionary at: 'Editor POU Var Decls -> Ok Button help' put: 'Accept changes'.	lang dictionary at: 'Editor POU Var Decls -> Cancel Button' put: 'Cancel'.	lang dictionary at: 'Editor POU Var Decls -> Cancel Button help' put: 'Close without changes'.		lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error -> title' put: 'Invalid Identifier'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error' put: 'Write another. It can`t cointain spaces or begin in digit'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error 2 -> title' put: 'Repeated Identifier'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error 2' put: 'Write another Identifier'.		"CIAA FileSystem"		lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 label' put: 'Successful compilation'.	lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents1' put: 'Overwirte previous compilation.'.	lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents2' put: 'Generated in '.		"CIAA Program Declaration"		lang dictionary at: 'CIAA Program Declaration -> Input' put: 'Input'.	lang dictionary at: 'CIAA Program Declaration -> Output' put: 'Output'.	lang dictionary at: 'CIAA Program Declaration -> Touchswitch' put: 'Touchswitch'.	lang dictionary at: 'CIAA Program Declaration -> Red Led' put: 'Red Led'.	lang dictionary at: 'CIAA Program Declaration -> Green Led' put: 'Green Led'.	lang dictionary at: 'CIAA Program Declaration -> Blue Led' put: 'Blue Led'.		"Editable Grid"		lang dictionary at: 'Editable Grid -> Category' put: 'Category'.	lang dictionary at: 'Editable Grid -> Name' put: 'Name'.	lang dictionary at: 'Editable Grid -> Datatype' put: 'Datatype'.	lang dictionary at: 'Editable Grid -> Initial value' put: 'Initial value'.	lang dictionary at: 'Editable Grid -> Description' put: 'Description'.	lang dictionary at: 'Editable Grid -> Address' put: 'Address'.	^ lang.! !!PLC_Language class methodsFor: 'as yet unclassified' stamp: 'EricPernia 3/20/2016 20:56'!esArUtf8	"Espaol - Argentina - UTF-8"	| lang |		lang := self new.		"Image path"		lang dictionary at: 'LanguageImagePath' put: 'es_AR.UTF-8'.		"List Selector"		lang dictionary at: 'List Selector -> Not selected accept' put: 'Debe seleccionar algun elemento'.	lang dictionary at: 'List Selector -> Select an element' put: 'Seleccionar elemento'.	lang dictionary at: 'List Selector -> Select' put: 'Seleccionar'.	lang dictionary at: 'List Selector -> Select help' put: 'Aceptar seleccin'.	lang dictionary at: 'List Selector -> Cancel' put: 'Cancelar'.	lang dictionary at: 'List Selector -> Cancel help' put: 'Cancelar seleccin'.		"Editor Devices"		lang dictionary at: 'Editor Device -> Title' put: 'Dispositivo'.	lang dictionary at: 'Editor Device -> Toolbar help -> Choose a device' put: 'Seleccionar un dispositivo'.	lang dictionary at: 'Editor Device -> Picture' put: 'Imagen'.	lang dictionary at: 'Editor Device -> Description' put: 'Descripcin'.		"Editor POU"		lang dictionary at: 'Editor POU -> Title' put: 'Editor de Unidad de Organizacin de Programa (POU)'.	lang dictionary at: 'Editor POU -> Network' put: 'Segmento'.		lang dictionary at: 'Editor POU -> Toolbar help -> POU Type' put: 'Tipo de POU: '.		lang dictionary at: 'Editor POU -> Toolbar help -> VAR' put: 'Abrir editor de declaraciones de variables'.		lang dictionary at: 'Editor POU -> Toolbar help -> Clean C' put: 'Limpiar compilacin de cdigo C'.	lang dictionary at: 'Editor POU -> Toolbar help -> Generate C' put: 'Genearar cdigo C'.	lang dictionary at: 'Editor POU -> Toolbar help -> Build C' put: 'Compilar cdigo C'.	lang dictionary at: 'Editor POU -> Toolbar help -> Download' put: 'Descargar programa'.	lang dictionary at: 'Editor POU -> Toolbar help -> Gen Build Download' put: 'Generar cdigo C, compilar y descargar'.		lang dictionary at: 'Editor POU -> Toolbar help -> Save' put: 'Grabar POU'.	lang dictionary at: 'Editor POU -> Toolbar help -> Reset' put: 'Eliminar POU'.		lang dictionary at: 'Editor POU -> Toolbar help -> Contact' put: 'Aadir contacto'.	lang dictionary at: 'Editor POU -> Toolbar help -> Coil C' put: 'Aadir bobina'.	lang dictionary at: 'Editor POU -> Toolbar help -> Open Branch' put: 'Abrir rama'.	lang dictionary at: 'Editor POU -> Toolbar help -> Close Branch' put: 'Cerrar rama'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Ladder component' put: 'Aadir componente Ladder'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Function call' put: 'Aadir llamado a Funcin'.	lang dictionary at: 'Editor POU -> Toolbar help -> Add Function Block call' put: 'Aadir llamado a Bloque de Funcin'.	lang dictionary at: 'Editor POU -> Toolbar help -> Generate and view Network C code' put: 'Generar y ver cdigo C e IL del segmento'.		lang dictionary at: 'Editor POU -> Toolbar help -> Delete' put: 'Eliminar seleccionado'.				"Editor POU Var Decls"		lang dictionary at: 'Editor POU Var Decls -> Title' put: 'Editor de Declaraciones de Variables de POU'.		lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> POU Type' put: 'Tipo de POU: '.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> Add' put: 'Aadir declaracin de variable'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help -> Remove' put: 'Remover declaracin de variable'.		lang dictionary at: 'Editor POU Var Decls -> Toolbar -> Add' put: 'Aadir declaracin de variable'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar -> Remove' put: 'Remover declaracin de variable'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help2 -> Add' put: 'Abre el dialogo para aadir una Declaracin de Variable'.	lang dictionary at: 'Editor POU Var Decls -> Toolbar help2 -> Remove' put: 'Remueve la Declaracin de Variable seleccionada'.		lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err1' put: 'No selecciono ninguna declaracin'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err1 help' put: 'Seleccione una fila'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err2' put: 'No se puede eliminar:'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err2 help' put: ''.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err3' put: 'Declaracin de variable eliminada'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Remove err3 help' put: ''.		lang dictionary at: 'Editor POU Var Decls -> Expander -> Interface Vars' put: 'Variables de interfaz'.	lang dictionary at: 'Editor POU Var Decls -> Expander -> Internal and External Vars' put: 'Variables Internas y Externas'.		lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Category' put: 'Categora'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Name' put: 'Nombre'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Datatype' put: 'Tipo'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Initial value' put: 'Valor inicial'.	lang dictionary at: 'Editor POU Var Decls -> Declarations grid -> Description' put: 'Descripcin'.		lang dictionary at: 'Editor POU Var Decls -> Dialog -> Title' put: '        Nueva Declaracin de Variable         '.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Description' put: 'Descripcin:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Description help' put: 'Escriba una descripcin'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Address' put: 'Direccin:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Address help' put: 'Escriba la direccin de la variable'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Datatype' put: 'Tipo de datos:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Datatype help' put: 'Elija un tipo de datos' .	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Identifier' put: 'Nombre:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Identifier help' put: 'Escriba un identificador'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Initial Value' put: 'Valor inicial:'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Initial Value help' put: 'Escriba un valor inicial'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Category' put: 'Categora'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> Category help' put: 'Elija una categora'.	lang dictionary at: 'Editor POU Var Decls -> Dialog -> id' put: 'nuevaVariable'.		lang dictionary at: 'Editor POU Var Decls -> Ok Button' put: 'Aceptar'.	lang dictionary at: 'Editor POU Var Decls -> Ok Button help' put: 'Acepta crear nueva declaracin de variable con los parmetros elegidos'.	lang dictionary at: 'Editor POU Var Decls -> Cancel Button' put: 'Cancelar'.	lang dictionary at: 'Editor POU Var Decls -> Cancel Button help' put: 'Cierra sin hacer ningn cambio'.		lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error -> title' put: 'Identificador no vlido'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error' put: 'Ingrese otro identificador, no puede tener espacios o comenzar en nmero'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error 2 -> title' put: 'Identificador de Variable repetido'.	lang dictionary at: 'Editor POU Var Decls -> GrowlMorph -> Identifier error 2' put: 'Ingrese otro identificador'.		"CIAA FileSystem"		lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 label' put: 'Compilacin exitosa'.	lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents1' put: 'Se pis la compilacin previa.'.	lang dictionary at: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents2' put: 'Generado en '.		"CIAA Program Declaration"		lang dictionary at: 'CIAA Program Declaration -> Input' put: 'Entrada'.	lang dictionary at: 'CIAA Program Declaration -> Output' put: 'Salida'.	lang dictionary at: 'CIAA Program Declaration -> Touchswitch' put: 'Botn'.	lang dictionary at: 'CIAA Program Declaration -> Red Led' put: 'Led Rojo'.	lang dictionary at: 'CIAA Program Declaration -> Green Led' put: 'Led Verde'.	lang dictionary at: 'CIAA Program Declaration -> Blue Led' put: 'Led Azul'.		"Editable Grid"		lang dictionary at: 'Editable Grid -> Category' put: 'Categora'.	lang dictionary at: 'Editable Grid -> Name' put: 'Nombre'.	lang dictionary at: 'Editable Grid -> Datatype' put: 'Tipo'.	lang dictionary at: 'Editable Grid -> Initial value' put: 'Valor inicial'.	lang dictionary at: 'Editable Grid -> Description' put: 'Descripcin'.	lang dictionary at: 'Editable Grid -> Address' put: 'Direccin'.	^ lang.! !!PLC_Language class methodsFor: 'as yet unclassified' stamp: 'EricPernia 2/11/2016 01:01'!translate: aString	"^ aString"		"Dispatch to a registered translator to translate the given string or (if there is no translator) return the untranslated string."		Current ifNotNil: [ ^Current translate: aString ].	^ aString! !!PLC_Language methodsFor: 'accessing' stamp: 'EricPernia 2/14/2016 22:17'!dictionary		^ dictionary! !!PLC_Language methodsFor: 'initialize-release' stamp: 'EricPernia 2/14/2016 20:49'!initialize	"Initialize the dictionary for translation"	dictionary := Dictionary new.! !!PLC_Language methodsFor: 'translating' stamp: 'EricPernia 2/11/2016 01:54'!translate: aString	^ dictionary at: aString ifAbsent: [ aString ]! !!PLC_Libraries class methodsFor: 'instance creation' stamp: 'EricPernia 5/31/2013 13:16'!clearInstance 	"Devuelve la unica instancia de esta clase."	Instance ifNotNil: 		[		Instance := nil.		].! !!PLC_Libraries class methodsFor: 'instance creation' stamp: 'EricPernia 5/31/2013 13:16'!uniqueInstance 	"Devuelve la unica instancia de esta clase."	Instance ifNil: 		[		Instance := self new.		].		^ Instance.! !!PLC_Libraries methodsFor: 'lists' stamp: 'EricPernia 11/17/2013 05:24'!clearLists		functionList := nil.	functionBlockList := nil.	programList := nil.	ladderElementList := nil.! !!PLC_Libraries methodsFor: 'library' stamp: 'EricPernia 11/5/2013 12:43'!dataTypeLibrary	"Devuelve biblioteca de todos los tipos de datos.	Esto es un array con todos los identificadores de los tipos de datos."	^ PLC_DataType AllDataTypeNameStrings.! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!dataTypes		^ dataTypes! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!dataTypes: anObject		dataTypes := anObject! !!PLC_Libraries methodsFor: 'lists' stamp: 'EricPernia 2/14/2016 23:30'!deviceList	"Devuelve el controlador de la lista de funciones"	deviceList ifNil: [		deviceList := PLC_ListSelector 			newWithLibrary: PLC_DevicePLC allDevices "aDictionary"			andColor: Color gray twiceLighter			andBorderColor: Color gray twiceDarker.		].		^ deviceList! !!PLC_Libraries methodsFor: 'lists' stamp: 'EricPernia 2/14/2016 23:16'!deviceList: anObject		deviceList := anObject! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!funcionBlockDecls		^ funcionBlockDecls! !!PLC_Libraries methodsFor: 'lists' stamp: 'EricPernia 11/18/2013 23:55'!functionBlockList		functionBlockList ifNil: [		functionBlockList :=	PLC_ListSelector			newWithLibrary: PLC_FunctionBlock StdFunctionBlocks			andColor: PLC_GraphicElementProperties uniqueInstance functionBlockHeaderColor			andBorderColor: PLC_GraphicElementProperties uniqueInstance functionBlockColor.		].		^ functionBlockList! !!PLC_Libraries methodsFor: 'lists' stamp: 'EricPernia 11/18/2013 22:33'!functionBlockList: anObject		functionBlockList := anObject! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!functionDecls		^ functionDecls! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!functionDecls: anObject		functionDecls := anObject! !!PLC_Libraries methodsFor: 'lists' stamp: 'EricPernia 11/17/2013 05:21'!functionList	"Devuelve el controlador de la lista de funciones"	functionList ifNil: [		functionList := PLC_ListSelector 			newWithLibrary: PLC_Function StdFunctions			andColor: PLC_GraphicElementProperties uniqueInstance functionHeaderColor			andBorderColor: PLC_GraphicElementProperties uniqueInstance functionColor.		].		^ functionList! !!PLC_Libraries methodsFor: 'lists' stamp: 'EricPernia 11/17/2013 05:16'!functionList: anObject		functionList := anObject! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!ilInstructions		^ ilInstructions! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!ilInstructions: anObject		ilInstructions := anObject! !!PLC_Libraries methodsFor: 'library' stamp: 'EricPernia 11/5/2013 12:43'!ilInstructionsLibrary 	"Devuelve la biblioteca de todos las Instrucciones del lenguaje IL.	Esto es un array con todos los identificadores de los tipos de datos."	^ PLC_DataType AllDataTypeNameStrings.! !!PLC_Libraries methodsFor: 'initialize-release' stamp: 'EricPernia 11/17/2013 05:17'!initialize 	"Inicializo las librerias"			"	programDecls 		funcionBlockDecls 		functionDecls 	stdFuncionBlocks 	stdFuncions 		ilInstructions 	ladderElements	dataTypes	variableDeclarations	variableTypes	plcDevices	literals	"! !!PLC_Libraries methodsFor: 'library' stamp: 'EricPernia 5/3/2015 06:19'!ladderElementLibrary 	"Devuelve la biblioteca de todos los Elementos Ladder ( ej: contacto, bobina, VL)	Esto es un array con todos los identificadores de los tipos de datos."			^ PLC_Element ladderElements.	! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 5/3/2015 06:03'!ladderElementList		ladderElementList ifNil: [		ladderElementList := PLC_ListSelector			newWithLibrary: self ladderElementLibrary			andColor:  Color lightGray twiceLighter "PLC_GraphicElementProperties uniqueInstance functionBlockHeaderColor"			andBorderColor: Color lightGray"PLC_GraphicElementProperties uniqueInstance functionBlockColor".		].		^ ladderElementList! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!ladderElements		^ ladderElements! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!ladderElements: anObject		ladderElements := anObject! !!PLC_Libraries methodsFor: 'library' stamp: 'EricPernia 11/5/2013 12:43'!programDeclationLibrary 	"Devuelve la biblioteca de todos los Programas declarados	Esto es un array con todos los identificadores de los tipos de datos."	^ PLC_DataType AllDataTypeNameStrings.	" Posibles bibliotecas:	------------------------------		funcionBlockDeclationLibrary	functionDeclationLibrary	standardFuncionBlockLibrary 	standardFuncionLibrary 		ilInstructionsLibrary 	ladderElementLibrary 	dataTypeLibrary 		variableDeclarationLibrary 	variableTypesLibrary 	plcDevices	literals"! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!programDecls		^ programDecls! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!programDecls: anObject		programDecls := anObject! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:23'!programList	programList ifNil: [		programList :=	PLC_ListSelector			newWithLibrary: PLC_Function StdFunctions			andColor: PLC_GraphicElementProperties uniqueInstance programHeaderColor			andBorderColor: PLC_GraphicElementProperties uniqueInstance programColor.		].		^ programList! !!PLC_Libraries methodsFor: 'library' stamp: 'EricPernia 11/5/2013 12:43'!standardFuncionBlockLibrary 	"Devuelve la biblioteca de todos los Bloques de Funcin estndar.	Esto es un array con todos los identificadores de los tipos de datos."	^ PLC_DataType AllDataTypeNameStrings.! !!PLC_Libraries methodsFor: 'library' stamp: 'EricPernia 11/18/2013 22:29'!standardFuncionLibrary 	"Devuelve la biblioteca de todos las Funciones  estndar.	Esto es un array con todos los identificadores de los tipos de datos."	^ PLC_Function StdFunctions.! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!stdFuncionBlocks		^ stdFuncionBlocks! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!stdFuncionBlocks: anObject		stdFuncionBlocks := anObject! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!stdFuncions		^ stdFuncions! !!PLC_Libraries methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 05:16'!stdFuncions: anObject		stdFuncions := anObject! !!PLC_Literal class methodsFor: 'instance creation' stamp: 'EricPernia 6/16/2013 21:48'!newWithDataType: aType andDataValue: aValue	"Crea una nueva instancia"		| literal |		literal := self new.		literal dataType: aType.		"ACA SI NO ACEPTA EL VALOR DEBERIA TIRAR ERROR O PONERLE 	EL VALOR POR DEFECTO. ELEGI PONERLE EL VALOR POR DEFECTO"		( aType acceptValue: aValue )		ifTrue: [ 			literal dataValue: aValue.			]		ifFalse: [ 			"self error: 'Valor no admitido para el tipo de datos'."			literal dataValue: aType initialValue dataValue.			].		^ literal.! !!PLC_Literal methodsFor: 'displaying' stamp: 'CarlosLombardi 10/14/2016 15:25'!asSimpleString	"a String representing myself"	^self dataValue	 asString! !!PLC_Literal methodsFor: 'compilation' stamp: 'EricPernia 6/2/2013 07:13'!cCompile	"Devuelve el string:			valor				ejemplo:				10	"	^ self dataValue asString.! !!PLC_Literal methodsFor: 'coercion' stamp: 'CarlosLombardi 10/14/2016 21:28'!canBeCoercedTo: aDataType	"whether it is possible for this operand to be coerced to the given type.	 Only literals can be coerced"	^self dataType canCoerce: self dataValue to: aDataType	! !!PLC_Literal methodsFor: 'coercion' stamp: 'CarlosLombardi 10/15/2016 11:02'!coercedTo: aDataType	"the result of my coercion to the given type.	 An error is raised if the coercion is not possible.	 Recall: only literals can be coerced"	(self canBeCoercedTo: aDataType) ifFalse: [ 		self error: ('This operand cannot be coerced to ', aDataType description)	] .	^PLC_Literal new 		dataValue: self dataValue ;		dataType: (self dataType typeToCoerce: self dataValue to: aDataType) ;		yourself	! !!PLC_Literal methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 06:14'!dataType	^ dataType! !!PLC_Literal methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 06:14'!dataType: anObject	dataType := anObject! !!PLC_Literal methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 06:14'!dataValue	^ dataValue! !!PLC_Literal methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 06:14'!dataValue: anObject	dataValue := anObject! !!PLC_Literal methodsFor: 'actual argument' stamp: 'EricPernia 11/18/2013 21:25'!identifier	"NO BORRAR, este mensaje se lo pide el actual argument para dibujarse"	^ self ilCompile.! !!PLC_Literal methodsFor: 'compilation' stamp: 'EricPernia 6/3/2013 00:39'!ilCompile	"Devuelve el string:			keywordTipoDeDatoValor				ejemplo:				INT#10	"	^ self dataType keyword asString , '#' , self dataValue asString.! !!PLC_Literal methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:48'!isError	"Devuelve true si es error"	^ false.! !!PLC_Literal methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:08'!isPLCLiteral	"Devuelve true si es literal"	^ true.! !!PLC_Literal methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:11'!isStructItem	"Devuelve true si es StructItem"	^ false.! !!PLC_Literal methodsFor: 'testingSubclass' stamp: 'EricPernia 5/6/2012 15:50'!isTimeLiteral	"Devuelve true si es un PLC_TimeLiteral"	^ false.! !!PLC_Literal methodsFor: 'testing' stamp: 'EricPernia 4/28/2012 22:07'!isVariable	"Devuelve false pues es constantee"	^ false.! !!PLC_Literal methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:10'!isVoid	"Devuelve true si es void"	^ false.! !!PLC_Location class methodsFor: 'instance creation' stamp: 'EricPernia 11/8/2013 00:10'!newWithDeclaration: varDecl andDataValue: aValue	"Crea un nuevo operando Variable Simbolica Simple"	| var |		var := self new.		var declaration: varDecl.				aValue 		ifNil: [			var	dataValue: varDecl initialValue.			] 		ifNotNil: [			var	dataValue: aValue.			]. 			^ var.	! !!PLC_Location methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 01:10'!cCompile	"Este objeto representa a una ubicacion en memoria como operando."	^ self declaration physicalAddress cCompile.	! !!PLC_Location methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 00:10'!dataType	"Devuelve el tipo de datos de la variable.	Este lo conoce su Declaracion"	^ self declaration dataType.! !!PLC_Location methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 00:10'!dataValue	^ dataValue! !!PLC_Location methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 00:10'!dataValue: anObject	dataValue := anObject	"AGREGAR CHEQUEO DE LITERAL O CONSTANTE CONTRA EL TIPO DE LA VARIABLE."	"( self dataType acceptValue: anObject dataValue )		ifTrue: [			dataValue := anObject			] 		ifFalse:[			self error: 'Valor no valido para el tipo de datos' , (self dataType keyword asString).			] 	"! !!PLC_Location methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 00:10'!declaration	"Es un objeto PLC_SimpleSymbolicVarDecl"	^ declaration! !!PLC_Location methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 00:10'!declaration: anObject	declaration := anObject! !!PLC_Location methodsFor: 'accessing' stamp: 'EricPernia 11/8/2013 00:10'!identifier	"Devuelve el identificador de su declaration"	^ self declaration identifier.! !!PLC_Location methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 00:12'!ilCompile	"Este objeto representa a la variable simbolica simple como operando."		^ self declaration physicalAddress ilCompile.! !!PLC_Location methodsFor: 'initialize-release' stamp: 'EricPernia 11/8/2013 00:10'!initialize	"Este objeto representa a la variable simbolica simple como operando."	super initialize.! !!PLC_Location methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:48'!isError	"Devuelve true si es error"	^ false.! !!PLC_Location methodsFor: 'testing' stamp: 'EricPernia 11/8/2013 00:10'!isPLCLiteral	"Devuelve true si es literal"	^ false.	! !!PLC_Location methodsFor: 'testing' stamp: 'EricPernia 11/8/2013 00:10'!isStructItem	"Devuelve true si es StructItem"	^ false.! !!PLC_Location methodsFor: 'testing' stamp: 'EricPernia 11/8/2013 00:10'!isVaraible	"Devuelve true pues es variable"	^ true.! !!PLC_Location methodsFor: 'testing' stamp: 'EricPernia 11/8/2013 00:10'!isVoid	"Devuelve true si es void"	^ false.! !!PLC_Location methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 00:10'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ self declaration varScopePrefix.! !!PLC_ObjGuardable methodsFor: 'accessing' stamp: 'EricPernia 4/9/2015 11:31'!val		^ val! !!PLC_ObjGuardable methodsFor: 'accessing' stamp: 'EricPernia 4/9/2015 11:31'!val: anObject		val := anObject! !!PLC_Objects methodsFor: 'add-remove objects' stamp: 'EricPernia 11/5/2013 14:08'!add: anObject	"Agrega a su OC objects un objeto"	self objects add: anObject.! !!PLC_Objects methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 14:08'!cCompile	"Devuelve el string del cdigo C del objectProgram"		| string |		string := ''.		self objects do: [ :each |		string := string ,  each cCompile.		].		^ string.! !!PLC_Objects methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 14:08'!ilCompile	"Devuelve el string del cdigo IL del objectProgram"		| string |		string := ''.		self objects do: [ :each |		string := string ,  each ilCompile.		].		^ string.! !!PLC_Objects methodsFor: 'initialize-release' stamp: 'EricPernia 11/5/2013 14:07'!initialize	"Inicializaciones de ObjectProgram"	self objects: OrderedCollection new.! !!PLC_Objects methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 14:07'!objects		^ objects! !!PLC_Objects methodsFor: 'accessing' stamp: 'EricPernia 11/5/2013 14:07'!objects: anObject		objects := anObject! !!PLC_InstructionListBody methodsFor: 'compilation' stamp: 'EricPernia 9/7/2013 05:03'!addNetwork	"Aade un nuevo Network de Bloques Conectables programa Ladder."	"HACERRRRRRRRRRRRRRRRRRRRRRRR"	self networks add: 1.! !!PLC_InstructionListBody methodsFor: 'test' stamp: 'EricPernia 11/17/2013 16:14'!language	"Devuelve el lenguaje del cuerpo de POU"	^ 'INSTRUCTION LIST'! !!PLC_InstructionListBody methodsFor: 'compilation' stamp: 'EricPernia 10/31/2012 14:17'!objectCompileIn: aObjectProgram	"Compila su programa a objetos que lo forman. Estos pueden dar su cdigo C o IL."	"DEBE CONVERTIR UN STRING DE INSTRUCCIONES IL EN OBJETOS IL"! !!PLC_LadderBody methodsFor: 'called POUs' stamp: 'EricPernia 11/15/2013 16:47'!addCalledPOUsIn: aCalledPOU	"Aade sus declaraciones de pou F y FB que llame en sus networks."		self networks do: [ :each |				"Aado las declaraciones de Funciones definidas por el usuario"		aCalledPOU addUserFunctions:  each calledUserFunctions.				"Aado las declaraciones de Funciones estandar"		aCalledPOU addStandardFunctions:  each calledStandardFunctions.				"Aado las declaraciones de Bloques de Funcion definidos por el usuario"		aCalledPOU addUserFunctionBlocks:  each calledUserFunctionBlocks.						"Aado las declaraciones de Bloques de Funcion estandar"		aCalledPOU addStandardFunctionBlocks:  each calledStandardFunctionBlocks.		 ].		^ aCalledPOU.! !!PLC_LadderBody methodsFor: 'add-remove Networks' stamp: 'EricPernia 11/18/2013 17:34'!addNetwork	"Aade un nuevo Network de Bloques Conectables."	| net |		net := PLC_LadderNetwork new.	net pouBody: self.	self networks 		add: net.			! !!PLC_LadderBody methodsFor: 'program structure' stamp: 'CarlosLombardi 11/19/2016 14:25'!argumentAccessors	"a collection with all the argument accessors (i.e. argument readers or writers) 	 included in this program body"	^self programElements select: [ :elem | 		elem isActualArgumentReader | elem isActualArgumentWriter 	] .! !!PLC_LadderBody methodsFor: 'test' stamp: 'CarlosLombardi 11/19/2016 14:43'!canBeCompiled	"whether I can be successfully compiled, i.e. whether I do not have any errors"	"2016.11.19 - at the moment, the only checked errors are wrong values 	              attached to argument accessors"	^(self argumentAccessors select: [:arg | arg actualArgument isError]) isEmpty.! !!PLC_LadderBody methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 15:02'!generateCodeIn: aProgramAccumulator	"Compila su programa a objetos que lo forman. Estos pueden dar su cdigo C o IL."	self networks do: [ :each | 		each generateCodeIn: aProgramAccumulator.		].! !!PLC_LadderBody methodsFor: 'test' stamp: 'EricPernia 11/17/2013 16:13'!language	"Devuelve el lenguaje del cuerpo de POU"	^ 'LADDER DIAGRAM'! !!PLC_LadderBody methodsFor: 'program structure' stamp: 'CarlosLombardi 11/19/2016 14:25'!programElements	"a collection with all the program elements that this body includes"	^self networks 		inject: Set new		into: [ :set :network | set union: ((network blocks collect: #element) asSet) ] .! !!PLC_POUBody class methodsFor: 'instance creation' stamp: 'EricPernia 11/18/2013 17:36'!newWithPOU: aPOU	"comment stating purpose of message"	| body |		body := self new.		body pou: aPOU.		^ body.! !!PLC_POUBody methodsFor: 'initialize-release' stamp: 'EricPernia 9/3/2013 16:19'!initialize.	"Inicializo el programa Ladder."	self networks: OrderedCollection new.	self addNetwork.! !!PLC_POUBody methodsFor: 'test' stamp: 'EricPernia 11/15/2013 02:26'!isUserDefined	"Responde True si es un cuerpo de pou definido por el usuario. si es estandar responde false"	^ true! !!PLC_POUBody methodsFor: 'test' stamp: 'EricPernia 11/17/2013 16:14'!language	"Devuelve el lenguaje del cuerpo de POU"	^ ''! !!PLC_POUBody methodsFor: 'accessing' stamp: 'EricPernia 9/3/2013 16:19'!networks	^ networks! !!PLC_POUBody methodsFor: 'accessing' stamp: 'EricPernia 9/3/2013 16:19'!networks: anObject	networks := anObject! !!PLC_POUBody methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 17:42'!pou	^ pou! !!PLC_POUBody methodsFor: 'accessing' stamp: 'EricPernia 11/18/2013 17:42'!pou: anObject	pou := anObject! !!PLC_POUBody methodsFor: 'add-remove Networks' stamp: 'EricPernia 11/17/2013 17:27'!removeNetwork: aNetworkView	"Remueve un nuevo Network de Bloques Conectables."	self networks 		remove: aNetworkView ladderController ladderNetwork.! !!PLC_StandardBody methodsFor: 'called POUs' stamp: 'EricPernia 11/15/2013 16:56'!addCalledPOUsIn: aCalledPOU	"Aade sus declaraciones de pou F y FB que llame en sus networks.		LO USAN LOS TIMERS Y CONTADORES PARA AGREGAR SU DETECCIN DE FLANCO"		"Aado las declaraciones de Bloques de Funcion estandar"	aCalledPOU addStandardFunctionBlocks: self calledPOUs.		^ aCalledPOU.! !!PLC_StandardBody methodsFor: 'accessing' stamp: 'EricPernia 11/15/2013 01:27'!addNetwork	"Aade un nuevo Network de Bloques Conectables programa Ladder."	"No hace nada al ser estandar"! !!PLC_StandardBody methodsFor: 'accessing' stamp: 'EricPernia 11/14/2013 15:38'!cCode		^ cCode! !!PLC_StandardBody methodsFor: 'accessing' stamp: 'EricPernia 11/14/2013 15:38'!cCode: anObject		cCode := anObject! !!PLC_StandardBody methodsFor: 'accessing' stamp: 'EricPernia 11/15/2013 16:55'!calledPOUs		^ calledPOUs! !!PLC_StandardBody methodsFor: 'accessing' stamp: 'EricPernia 11/15/2013 16:55'!calledPOUs: anObject		calledPOUs := anObject! !!PLC_StandardBody methodsFor: 'compilation' stamp: 'EricPernia 11/15/2013 01:34'!generateCodeIn: aProgramAccumulator	"Compila su programa a objetos que lo forman. Estos pueden dar su cdigo C o IL."	"Este cuerpo de POU representa el Cuerpo de POU de las funciones estndar que ya vienen compiladas.	Agrega una instruccin IL que en IL genera, ''Cdigo no mostrado'' y en C devuelve todo el codigo"	| instruction |		instruction := PLC_StandarBody_Instruction new.		instruction cCode: self cCode.			instruction modifiers add: PLC_IL_Modifiers NullModifier. 	aProgramAccumulator add: instruction.		! !!PLC_StandardBody methodsFor: 'test' stamp: 'EricPernia 11/15/2013 02:21'!isUserDefined	"Responde True si es un cuerpo de pou definido por el usuario. si es estandar responde false"	^ false! !!PLC_Function_Declarations methodsFor: 'instance' stamp: 'EricPernia 11/16/2013 13:48'!structureDeclaration	"Declaracion de tipo de dato estructurado."	| struct |	struct := PLC_StructureDecl 		newWithIdentifier: self structureDeclarationIdentifier.	"AADO LAS VARIABLES A LA ESTRUCTURA"	"Variables de Entrada"	self inputVarDecls do: [ :each |		struct add: each.		].		"Variables de Entrada-Salida"	self inOutVarDecls do: [ :each |		struct add: each.		].		"Variables de Salida"	self outputVarDecls do: [ :each |		struct add: each.		].		"Variables Internas"	self varDecls do: [ :each |		struct add: each.		].		"Variable de Return"	self returnVarDecl do: [ :each |		struct add: each.		].	 		^ struct.! !!PLC_POU_Declarations class methodsFor: 'instance creation' stamp: 'EricPernia 6/20/2013 17:13'!functionBlockDeclarationsWithPOUDeclaration: aPOUDecl	"Devuelve una nueva instancia con declaraciones de Bloque de Funcion"	| decls |	decls := self newWithUserVarDecls.		"Declaraciones de Tipos de Datos"	"decls compilerDataTypesDecls.	decls userDataTypesDecls."		"Declaraciones de Variables"	"decls compilerVarDecls."	decls userVarDecls add: PLC_VariableCategoryDecl tempVarDecls.		decls pouDecl: aPOUDecl.		^ decls.! !!PLC_POU_Declarations class methodsFor: 'instance creation' stamp: 'EricPernia 11/16/2013 13:30'!functionDeclarationsWithPOUDeclaration: aPOUDecl	"Devuelve una nueva instancia con declaraciones de Funcion"	| decls |	decls := self newWithUserVarDecls.		"Declaraciones de Variables"	decls userVarDecls add: PLC_VariableCategoryDecl returnVarDecl.		decls pouDecl: aPOUDecl.		^ decls.! !!PLC_POU_Declarations class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 04:21'!newWithUserVarDecls	"Devuelve una nueva instancia con declaraciones"		| decls |	decls := self new.		"Declaraciones de Tipos de Datos"	"decls compilerDataTypesDecls.	decls userDataTypesDecls."		"Declaraciones de Variables"		decls userVarDecls add: PLC_VariableCategoryDecl inputVarDecls.	decls userVarDecls add: PLC_VariableCategoryDecl outputVarDecls.	decls userVarDecls add: PLC_VariableCategoryDecl inOutVarDecls.	decls userVarDecls add: PLC_VariableCategoryDecl varDecls.	decls userVarDecls add: PLC_VariableCategoryDecl constantVarDecls.	^ decls.! !!PLC_POU_Declarations class methodsFor: 'instance creation' stamp: 'EricPernia 11/5/2013 20:11'!programDeclarationsWithPOUDeclaration: aPOUDecl	"Devuelve una nueva instancia con declaraciones de programa"	| decls |	decls := self newWithUserVarDecls.		"Declaraciones de Tipos de Datos"	"decls userDataTypesDecls."		"Declaraciones de Variables"	decls userVarDecls add: PLC_VariableCategoryDecl tempVarDecls.	decls userVarDecls add: PLC_VariableCategoryDecl externVarDecls.		decls pouDecl: aPOUDecl.		^ decls.! !!PLC_POU_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 20:07'!constantVarDecls	"Devuelve sus declaraciones de variables Internas de valor Constante"	^ self userVarDecls at: 5.	"inputVarDeclsoutputVarDeclsinOutVarDeclsvarDeclsconstantVarDeclstempVarDeclsexternVarDecls"! !!PLC_POU_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 20:15'!externVarDecls	"Devuelve sus declaraciones de variables Internas"	^ self userVarDecls at: 7.	"inputVarDeclsoutputVarDeclsinOutVarDeclsvarDeclsconstantVarDeclstempVarDeclsexternVarDecls"! !!PLC_POU_Declarations methodsFor: 'accessing' stamp: 'EricPernia 11/19/2013 04:57'!funInstVarDecls		^ funInstVarDecls! !!PLC_POU_Declarations methodsFor: 'accessing' stamp: 'EricPernia 11/19/2013 04:57'!funInstVarDecls: anObject		funInstVarDecls := anObject! !!PLC_POU_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 20:07'!inOutVarDecls	"Devuelve sus declaraciones de variables de Entrada-Salida"	^ self userVarDecls at: 3.	"inputVarDeclsoutputVarDeclsinOutVarDeclsvarDeclsconstantVarDeclstempVarDeclsexternVarDecls"! !!PLC_POU_Declarations methodsFor: 'initialize-release' stamp: 'EricPernia 11/19/2013 05:01'!initialize	"Inicializa las Colecciones de declaraciones de una POU"	"Declaraciones de Tipos de Datos"	userDataTypesDecls := OrderedCollection new.		"Declaraciones de Variables"	userVarDecls := OrderedCollection new.		"PARCHEEEE DECLARCIONES OCULTAS DE INSTANCIAS DE F"	funInstVarDecls := PLC_VariableCategoryDecl funInstVarDecls.! !!PLC_POU_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 20:07'!inputVarDecls	"Devuelve sus declaraciones de variables de Entrada"	^ self userVarDecls at: 1.	"inputVarDeclsoutputVarDeclsinOutVarDeclsvarDeclsconstantVarDeclstempVarDeclsexternVarDecls"! !!PLC_POU_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 20:07'!outputVarDecls	"Devuelve sus declaraciones de variables de Salida"	^ self userVarDecls at: 2.	"inputVarDeclsoutputVarDeclsinOutVarDeclsvarDeclsconstantVarDeclstempVarDeclsexternVarDecls"! !!PLC_POU_Declarations methodsFor: 'accessing' stamp: 'EricPernia 6/20/2013 17:06'!pouDecl		^ pouDecl! !!PLC_POU_Declarations methodsFor: 'accessing' stamp: 'EricPernia 6/20/2013 17:06'!pouDecl: anObject		pouDecl := anObject! !!PLC_POU_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/16/2013 13:29'!returnVarDecl	"Devuelve su declaracion de variables de Return"	^ self userVarDecls at: 6.	"inputVarDeclsoutputVarDeclsinOutVarDeclsvarDeclsconstantVarDeclsreturnVarDecl"! !!PLC_POU_Declarations methodsFor: 'instance' stamp: 'EricPernia 11/19/2013 04:58'!structureDeclaration	"Declaracion de tipo de dato estructurado."	| struct |	struct := PLC_StructureDecl 		newWithIdentifier: self structureDeclarationIdentifier.	"AADO LAS VARIABLES A LA ESTRUCTURA"	"Variables de Entrada"	self inputVarDecls do: [ :each |		struct add: each.		].		"Variables de Entrada-Salida"	self inOutVarDecls do: [ :each |		struct add: each.		].		"Variables de Salida"	self outputVarDecls do: [ :each |		struct add: each.		].		"Variables Internas"	self varDecls do: [ :each |		struct add: each.		].		self funInstVarDecls do: [ :each |		struct add: each.		].	 		^ struct.! !!PLC_POU_Declarations methodsFor: 'instance' stamp: 'EricPernia 6/22/2013 03:27'!structureDeclarationIdentifier	"Identificador de tipo de dato estructurado."	^ 'Struct_' , self pouDecl typedIdentifier.! !!PLC_POU_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 20:07'!tempVarDecls	"Devuelve sus declaraciones de variables Internas Temporales"	^ self userVarDecls at: 6.	"inputVarDeclsoutputVarDeclsinOutVarDeclsvarDeclsconstantVarDeclstempVarDeclsexternVarDecls"! !!PLC_POU_Declarations methodsFor: 'instance' stamp: 'EricPernia 6/21/2013 04:52'!typeDeclaration	"Declaracion de tipo de dato derivado."	| type |	type := PLC_TypeDecl 		newWithDataType: self structureDeclaration		andIdentifier: self typeDeclarationIdentifier.	^ type.! !!PLC_POU_Declarations methodsFor: 'instance' stamp: 'EricPernia 6/21/2013 04:52'!typeDeclarationIdentifier	"Identificador de tipo de dato estructurado."	^ 'PLC_' , self pouDecl pouTypeAcronym , '_' , self structureDeclarationIdentifier.! !!PLC_POU_Declarations methodsFor: 'accessing' stamp: 'EricPernia 6/8/2013 15:21'!userDataTypesDecls	^ userDataTypesDecls! !!PLC_POU_Declarations methodsFor: 'accessing' stamp: 'EricPernia 6/8/2013 15:21'!userDataTypesDecls: anObject	userDataTypesDecls := anObject! !!PLC_POU_Declarations methodsFor: 'accessing' stamp: 'EricPernia 6/8/2013 14:40'!userVarDecls		^ userVarDecls! !!PLC_POU_Declarations methodsFor: 'accessing' stamp: 'EricPernia 6/8/2013 14:40'!userVarDecls: anObject		userVarDecls := anObject! !!PLC_POU_Declarations methodsFor: 'find' stamp: 'CarlosLombardi 10/14/2016 12:49'!varDeclWithIdentifierOrNIl: aVariableIdentifier	"La delaracion de variable con el identificador aVariableIdentifier.	 Si no hay, devuelve nil"	self userVarDecls do: [ :each |		( each varDeclWithIdentifierOrNIl: aVariableIdentifier )			ifNotNil: [ ^ each varDeclWithIdentifierOrNIl: aVariableIdentifier ].		 ].		^ nil.! !!PLC_POU_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/5/2013 20:07'!varDecls	"Devuelve sus declaraciones de variables Internas"	^ self userVarDecls at: 4.	"inputVarDeclsoutputVarDeclsinOutVarDeclsvarDeclsconstantVarDeclstempVarDeclsexternVarDecls"! !!PLC_POU_Editor_Backup methodsFor: 'add-remove' stamp: 'EricPernia 11/17/2013 16:41'!addNetwork	"Aade un nuevo segmento a la ventana"		^ 'Se agrego segmento.'! !!PLC_POU_Editor_Backup methodsFor: 'open/close' stamp: 'EricPernia 11/17/2013 16:41'!builder	"Devuelve el builder"	^ UITheme builder.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!descriptionMorph	"devuelve un PLC_TitleMorph"	| descriptionMorph |	descriptionMorph := PLC_TitleMorph new.	descriptionMorph extent: 400@20.	descriptionMorph backgroundColor: self varTitlesColor.	descriptionMorph backgroundBorderWidth: 1.	descriptionMorph emphasis: self varTitleEmphasis.	descriptionMorph text: 'Descripcin'.	descriptionMorph changed.		^ descriptionMorph.! !!PLC_POU_Editor_Backup methodsFor: 'fbd editor' stamp: 'EricPernia 11/17/2013 16:41'!fbdPouBodyEditor	"Devuelve la columna con el editor de lenguaje FBD"		"HACER"! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!globalVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!globalVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self globalVarsMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!globalVarsMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@30.	globalVarsMorph backgroundColor: Color black twiceLighter.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: 1.	globalVarsMorph text: 'Globales'. "Declaraciones de variables globales"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - events' stamp: 'EricPernia 11/17/2013 16:41'!hasSelectedVariable	^selectedVariableIndex > 0! !!PLC_POU_Editor_Backup methodsFor: 'il editor' stamp: 'EricPernia 11/17/2013 16:41'!ilPouBodyEditor	"Devuelve la columna con el editor de lenguaje IL"		"HACER"! !!PLC_POU_Editor_Backup methodsFor: 'open/close' stamp: 'EricPernia 11/17/2013 16:41'!imageFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ self proyectFilesPath , 'imagenes/'."	^ ''.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/17/2013 16:41'!inOutVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!inOutVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Entrada-Salida'. "Declaraciones de variables de Entrada-Salida"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!inOutVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self inOutVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/17/2013 16:41'!inputVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!inputVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Entrada'. "Declaraciones de variables de Entrada"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!inputVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self inputVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor' stamp: 'EricPernia 11/17/2013 16:41'!interfaceVarsColumn	"Devuelve la columna con el editor de lenguaje Ladder"		| interfaceVarsColumn |		interfaceVarsColumn := self builder newColumn: { 		self varTitles.				self inputVarTitle.		self inputVarLists. 						self outputVarTitle.		self outputVarLists. 						self inOutVarTitle.		self inOutVarLists. 		}.		interfaceVarsColumn cellInset: 0;		extent: 720 @ 20.			^ interfaceVarsColumn.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor' stamp: 'EricPernia 11/17/2013 16:41'!internalVarsColumn	"Devuelve la columna con el editor de lenguaje Ladder"	| internalVarsColumn |		internalVarsColumn := self builder newColumn: { 				self varTitles.				self varVarTitle.		self varVarLists. 				self tempVarTitle.		self tempVarLists. 		}.		internalVarsColumn cellInset: 0;		extent: 720 @ 20.			^ internalVarsColumn.! !!PLC_POU_Editor_Backup methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 16:41'!keyboardFocusNetwork	^ keyboardFocusNetwork! !!PLC_POU_Editor_Backup methodsFor: 'accessing' stamp: 'EricPernia 11/17/2013 16:41'!keyboardFocusNetwork: anObject	keyboardFocusNetwork := anObject! !!PLC_POU_Editor_Backup methodsFor: 'ladder editor' stamp: 'EricPernia 11/17/2013 16:41'!ladderPouBodyEditor	"Devuelve la columna con el editor de lenguaje Ladder"		| ladderPouBodyEditor controller ladderView scroller expander |	controller := PLC_LadderController newWithModel: nil.		ladderView := controller openLadderView.	self keyboardFocusNetwork: ladderView.			scroller := ( self builder newScrollPaneFor: ladderView ) 		hResizing: #spaceFill; 		vResizing: #spaceFill.	expander := ( self builder newExpander: 'Segmento 1'  for: scroller ) 		spaceFillWeight: 1; 		expanded: true.	ladderPouBodyEditor := self builder newColumn: {   		self ladderPouBodyMorph.		self ladderToolbar.		expander.	}.	"hResizing: #spaceFill;	vResizing: #shrinkWrap;	cellSpacing: 10"			ladderPouBodyEditor 		cellInset: 0";		extent: 720 @ 450".							^ ladderPouBodyEditor.					! !!PLC_POU_Editor_Backup methodsFor: 'ladder editor' stamp: 'EricPernia 11/17/2013 16:41'!ladderPouBodyMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: PLC_GraphicElementProperties uniqueInstance programHeaderColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: 'Cuerpo de POU en lenguaje Ladder'.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_POU_Editor_Backup methodsFor: 'ladder editor' stamp: 'EricPernia 3/16/2016 03:37'!ladderToolbar 	"Devuelve la barra de herramientas superior de la ventana de edicin de Ladder"		| builder |		"^PLC_LadderToolBarMorph new."	builder := UITheme builder.		^ builder newToolbar: {		"		builder			newButtonFor: self keyboardFocusNetwork ""if we had a model it would go here""			getState: nil			action: #drawGroups			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addNetwork.png')			help: 'Aadir Segmento.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #dfdff			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'removeNetwork.png')			help: 'Remover Segmento seleccionado.'.		"								"builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #ilExport			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'ilExport.png')			help: 'Exportar Configuracion en IL.'."					builder			newButtonFor: self keyboardFocusNetwork "if we had a model it would go here"			getState: nil			action: #compile			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'compile.png')			help: 'Compilar.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #connectToDevice			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'connectToDevice.png')			help: 'Conectarse al PLC.'.						builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #downloadProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'downloadProgram.png')			help: 'Descargar Programa al PLC.'.																	builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyCPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addContact.png') 			help: 'Aadir Contacto.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyBPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addCoil.png') 			help: 'Aadir Bobina.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyOPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'openBranch.png') 			help: 'Abrir Rama.'.					builder			newButtonFor: self keyboardFocusNetwork			getState: nil			action: #keyPPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'closeBranch.png') 			help: 'Cerrar Rama.'.								builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyFPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addFunction.png') 			help: 'Aadir llamado a Funcin.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyGPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addFunctionBlock.png') 			help: 'Aadir llamado a Bloque de Funcin.'.					builder			newButtonFor: self keyboardFocusNetwork			getState: nil			action: #generateCode			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addProgramControl.png') 			help: 'Aadir componente de Control de Ejecucin.'.					builder			newButtonFor: self keyboardFocusNetwork			getState: nil			action: #keyDeletePressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'removeSelected.png') 			help: 'Remover componente(s) seleccionado(s).'.											"		builder			newButtonFor: nil ""if we had a model it would go here""			getState: nil			action: #openFile			arguments: nil			getEnabled: nil			labelForm: builder theme smallNewIcon			help: 'Nuevo'.		builder			newButtonFor: nil			getState: nil			action: #openFile			arguments: nil			getEnabled: nil			labelForm: builder theme smallOpenIcon			help: 'Abrir'.		builder			newButtonFor: nil			getState: nil			action: #saveFile			arguments: nil			getEnabled: nil			labelForm: builder theme smallSaveIcon			help: 'Guardar'.		builder			newButtonFor: nil			getState: nil			action: #print			arguments: nil			getEnabled: nil			labelForm: builder theme smallPrintIcon			help: 'Imprimir' 		" 	}.! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!locatedMorph	"devuelve un PLC_TitleMorph"	| addressMorph |	addressMorph := PLC_TitleMorph new.	addressMorph extent: 90@25.	addressMorph backgroundColor: Color black twiceLighter lighter.	addressMorph backgroundBorderWidth: 1.	addressMorph emphasis: 1.	addressMorph text: 'Ubicacin'.	addressMorph changed.		^ addressMorph.! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!locatedVarLists	"Genera la fila"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varAddress			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Ubicacin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!locatedVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self locatedVarsMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!locatedVarTitles	"Genera la fila"	| row |	row := self builder newRow: {		(self nameMorph)			hResizing: #spaceFill;			minWidth: 200.		(self typeMorph)			hResizing: #spaceFill;			minWidth: 90.		(self locatedMorph)			hResizing: #spaceFill;			minWidth: 90.		(self descriptionMorph)			hResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!locatedVarsMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@30.	globalVarsMorph backgroundColor: Color black twiceLighter.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: 1.	globalVarsMorph text: 'Ubicadas'. "Declaraciones de variables ubicadas 	Variables representadas directamente"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!nameMorph	"devuelve un PLC_TitleMorph"	| nameMorph |	nameMorph := PLC_TitleMorph new.	nameMorph extent: 200@20.	nameMorph backgroundColor: self varTitlesColor.	nameMorph backgroundBorderWidth: 1.	nameMorph emphasis: self varTitlesEmphasis.	nameMorph text: 'Nombre'.	nameMorph changed.		^ nameMorph.! !!PLC_POU_Editor_Backup methodsFor: 'open/close' stamp: 'EricPernia 11/17/2013 16:41'!open	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| window windowExtent aWorld   |	"Creo la ventana"	window := ( SystemWindow labelled: 'Editor de Unidad de Organizacin de Programa (POU)' ) model: nil.		"Agrego el editor de variables"	window addMorph: self pouVarDeclEditor fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@0.4 )			offsets: ( 0@0 corner: 1@0 )		).	"Agrego el editor de ladder"	window addMorph: self ladderPouBodyEditor fullFrame: (		LayoutFrame 			fractions: ( 0@0.4 corner: 1@1 )			offsets: ( 0@0 corner: 1@0 )		).					window updatePaneColors.	window extent: 800@600.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.		"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		" VAR DECLS ES UNA COLUMNA		varDecls := self builder newColumn: {		self variableToolBar. 				self globalVarTitle.		self globalVarTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.		varDecls cellInset: 0;		minHeight: 10;		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10	(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."	"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."! !!PLC_POU_Editor_Backup methodsFor: 'Eric' stamp: 'EricPernia 11/17/2013 16:41'!openEric	"Abre la ventana"	| content |				"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		content := self builder newColumn: {		self varMenu. 				self globalVarTitle.		self varTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.	content cellInset: 0.		"hResizing: #spaceFill;		vResizing: #spaceFill;		cellSpacing: 10."	"(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."		 (content openInWindowLabeled: 'Contactos') 		extent: 800@600.! !!PLC_POU_Editor_Backup methodsFor: 'Eric' stamp: 'EricPernia 11/17/2013 16:41'!openEric2	"Abre la ventana"	|builder content variablesRow menu varTitles1 varTitles2 |	builder := UITheme builder.		menu := builder newRow: {		builder newButtonFor: self 			action: #addButtonClick 			label: 'Aadir' 			help: 'Crear un contacto nuevo'.						builder newButtonFor: self 			action: #removeButtonClick 					label: 'Remover' 			help: 'Remover contacto selecccionado'.		builder newButtonFor: self 			action: #editButtonClick 					label: 'Editar' 			help: 'Editar contacto selecccionado' 		}.			varTitles1 := builder newRow: {		(self globalVarsMorph)			hResizing: #spaceFill.		}.			varTitles2 := builder newRow: {		(self nameMorph)			hResizing: #spaceFill;			minWidth: 200.		(self typeMorph)			hResizing: #spaceFill;			minWidth: 90.		(self descriptionMorph)			hResizing: #spaceFill;			minWidth: 400.		}.				variablesRow := builder newRow: {		(builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		(builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		(builder 			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.				"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"			varTitles1 cellInset: 0.		varTitles2 cellInset: 0.		variablesRow cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"	content := builder newColumn: {		menu.		varTitles1.		varTitles2.		variablesRow.	}.	content cellInset: 0.		"hResizing: #spaceFill;		vResizing: #spaceFill;		cellSpacing: 10."	"(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."		 (content openInWindowLabeled: 'Contactos') 		extent: 800@600.! !!PLC_POU_Editor_Backup methodsFor: 'Eric' stamp: 'EricPernia 11/17/2013 16:41'!openEric3	"Abre la ventana"	| window windowExtent aWorld varDeclsContainer varDecls pouBody pouBodyContainer |				"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		varDecls := self builder newColumn: {		self varMenu. 				self globalVarTitle.		self varTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.	varDecls cellInset: 0;		minHeight: 10";		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10".	"(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."		"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."	varDeclsContainer := varDecls.		pouBody := Morph new.	pouBodyContainer := pouBody.	"Creo la ventana y agrego los controles"	window := ( SystemWindow labelled: 'Ventana' ) model: nil.			window addMorph: varDeclsContainer fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@0.4 )			offsets: ( 0@0 corner: 1@0 )		).	window addMorph: pouBodyContainer fullFrame: (		LayoutFrame 			fractions: ( 0@0.4 corner: 1@1 )			offsets: ( 0@0 corner: 1@0 )		).					"window updatePaneColors."	window extent: 800@600.		aWorld := Morph new currentWorld.		aWorld addMorph: window.	window activate.	aWorld startSteppingSubmorphsOf: window.	^ window.! !!PLC_POU_Editor_Backup methodsFor: 'Eric' stamp: 'EricPernia 11/17/2013 16:41'!openEric4	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| window windowExtent aWorld   |	"Creo la ventana"	window := ( SystemWindow labelled: 'Editor de Unidad de Organizacin de Programa (POU)' ) model: nil.		"Agrego el editor de variables"	window addMorph: self pouVarDeclEditor fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@0.4 )			offsets: ( 0@0 corner: 1@0 )		).	"Agrego el editor de ladder"	window addMorph: self ladderPouBodyEditor fullFrame: (		LayoutFrame 			fractions: ( 0@0.4 corner: 1@1 )			offsets: ( 0@0 corner: 1@0 )		).					window updatePaneColors.	window extent: 800@600.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.		"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		" VAR DECLS ES UNA COLUMNA		varDecls := self builder newColumn: {		self variableToolBar. 				self globalVarTitle.		self globalVarTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.		varDecls cellInset: 0;		minHeight: 10;		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10	(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."	"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/17/2013 16:41'!outputVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!outputVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Salida'. "Declaraciones de variables de Salida"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!outputVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self outputVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor' stamp: 'EricPernia 11/17/2013 16:41'!pouVarDeclEditor	"Devuelve la columna con el editor de lenguaje Ladder"		| pouVarDeclEditor exp1 exp2 eg1 |			"scroller := ( self builder newScrollPaneFor: ladderView ) 		hResizing: #spaceFill; 		vResizing: #spaceFill."	"morph1 := (PanelMorph new fillStyle: (SolidFillStyle color: Color red))		hResizing: #spaceFill;		vResizing: #spaceFill."			exp1 := ( self builder newExpander: 'Variables de interfaz' for: self interfaceVarsColumn )		spaceFillWeight: ProportionalSplitterMorph splitterWidth;		expanded: true.		eg1 := EdgeGripMorph new		target: exp1;		edgeName: #bottom;		vResizing: #rigid;		extent: 24 @ 1;		on: #mouseDown send: #expandedSizingRigid to: exp1.		exp2 := ( self builder newExpander: 'Variables internas'  for: self internalVarsColumn )		spaceFillWeight: ProportionalSplitterMorph splitterWidth;		expanded: false.		pouVarDeclEditor := self builder 		newColumn: { 			self pouVarTitle.			self variableToolBar.			exp1. 			eg1. 			exp2.			}.		pouVarDeclEditor cellInset: 0;		extent: 720 @ 20.			^ pouVarDeclEditor.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!pouVarMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: PLC_GraphicElementProperties uniqueInstance programHeaderColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: 'Declaraciones de variables de POU'.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!pouVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self pouVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 23:48'!projectFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ 'D:/Proyecto/Pharo-1.3-13315-OneClick.app/Contents/Resources/PLeriC'."	^ ''.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/17/2013 16:41'!tempVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!tempVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Temporales'. "Declaraciones de variables Temporales"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!tempVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self tempVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!typeMorph	"devuelve un PLC_TitleMorph"	| typeMorph |	typeMorph := PLC_TitleMorph new.	typeMorph extent: 90@20.	typeMorph backgroundColor: self varTitlesColor.	typeMorph backgroundBorderWidth: 1.	typeMorph emphasis: self varTitlesEmphasis.	typeMorph text: 'Tipo'.	typeMorph changed.		^ typeMorph.! !!PLC_POU_Editor_Backup methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/17/2013 16:41'!varAddress		| col |	col := OrderedCollection new.		col add: '%I0.0'.	col add: ''.	col add: ''.	col add: ''.		^ col.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor' stamp: 'EricPernia 11/17/2013 16:41'!varDescription		| col |	col := OrderedCollection new.		col add: 'Variable 1, representa el cambio en la corriente nominal.'.	col add: 'Variable 2, representa el cambio en la corriente nominal.'.	col add: 'Variable 3, representa el cambio en la corriente nominal.'.	col add: 'Variable 4, representa el cambio en la corriente nominal.'.		^ col.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor' stamp: 'EricPernia 11/17/2013 16:41'!varInitialValue		| col |	col := OrderedCollection new.		col add: '0'.	col add: '1'.	col add: '15'.	col add: '50'.		^ col.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor' stamp: 'EricPernia 11/17/2013 16:41'!varName		| col |	col := OrderedCollection new.		col add: 'variable1'.	col add: 'var_2_laaaaarga'.	col add: 'var3'.	col add: 'mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm'.	^ col.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - style' stamp: 'EricPernia 11/17/2013 16:41'!varTitleColor	"Genera la fila"		^ Color gray.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - style' stamp: 'EricPernia 11/17/2013 16:41'!varTitleEmphasis	""		^ 0.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!varTitles	"Genera la fila"	| row |	row := self builder newRow: {		(self nameMorph)			hResizing: #spaceFill;			minWidth: 200.		(self typeMorph)			hResizing: #spaceFill;			minWidth: 90.		(self descriptionMorph)			hResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - style' stamp: 'EricPernia 11/17/2013 16:41'!varTitlesColor	"Color"		^ PLC_GraphicElementProperties uniqueInstance rowColorHeader.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - style' stamp: 'EricPernia 11/17/2013 16:41'!varTitlesEmphasis	""		^ 1.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor' stamp: 'EricPernia 11/17/2013 16:41'!varType		| col |	col := OrderedCollection new.		col add: 'Bool'.	col add: 'Bool'.	col add: 'Int'.	col add: 'Int'.		^ col.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/17/2013 16:41'!varVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!varVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Internas'. "Declaraciones de variables Internas"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/17/2013 16:41'!varVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self varVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - events' stamp: 'EricPernia 11/17/2013 16:41'!variableSelectedIndex	^ selectedVariableIndex ifNil: [selectedVariableIndex := 0]! !!PLC_POU_Editor_Backup methodsFor: 'variable editor - events' stamp: 'EricPernia 11/17/2013 16:41'!variableSelectedIndex: aSmallInteger 	selectedVariableIndex := aSmallInteger.	self 		changed: #variableSelectedIndex;  		changed: #hasSelectedVariable		! !!PLC_POU_Editor_Backup methodsFor: 'variable editor' stamp: 'EricPernia 11/17/2013 16:41'!variableToolBar	"Genera la fila"	^ self builder newRow: {		self builder newButtonFor: self 			action: #addButtonClick 			label: 'Aadir Variable' 			help: 'Abre el dialogo para aadir una variable.'.						self builder newButtonFor: self 			action: #removeButtonClick 					label: 'Remover Variable' 			help: 'Remueve la Variable seleccionada.'.		self builder newButtonFor: self 			action: #editButtonClick 					label: 'Editar Variable' 			help: 'Abre el dialogo para editar la Variable seleccionada.'.			}.! !!PLC_ProgramAccumulator_POU methodsFor: 'add' stamp: 'EricPernia 9/7/2013 04:50'!add: anObject	"Agrega a su OC compiledBody un objeto.	Este mensaje lo usan los elementos de programa grfico 	para insetar su lista de elementos IL generados."	self compiledBody add: anObject.! !!PLC_ProgramAccumulator_POU methodsFor: 'add' stamp: 'EricPernia 9/7/2013 06:55'!addDataTypeDecl: anObject 	"Agrega a su OC compilcompilerDataTypesDecls un objeto.	Este mensaje lo usan los elementos de programa grfico 	VL y llamado a F o FB para insetar sus declaraciones de 	tipos de datos generados, por ejemplo para variables cableadas."	self compilerDataTypesDecls add: anObject.! !!PLC_ProgramAccumulator_POU methodsFor: 'add' stamp: 'EricPernia 9/7/2013 06:55'!addVarDecl: anObject 	"Agrega a su OC compilcompilerVarDecls un objeto.	Este mensaje lo usan los elementos de programa grfico 	VL y llamado a F o FB para insetar sus declaraciones de 	variables generadas, por ejemplo para variables struct 	cableadas."	self compilerVarDecls add: anObject.! !!PLC_ProgramAccumulator_POU methodsFor: 'accessing' stamp: 'EricPernia 9/7/2013 04:41'!compiledBody		^ compiledBody! !!PLC_ProgramAccumulator_POU methodsFor: 'accessing' stamp: 'EricPernia 9/7/2013 04:41'!compiledBody: anObject		compiledBody := anObject! !!PLC_ProgramAccumulator_POU methodsFor: 'accessing' stamp: 'EricPernia 5/30/2013 18:53'!compilerDataTypesDecls	^ compilerDataTypesDecls! !!PLC_ProgramAccumulator_POU methodsFor: 'accessing' stamp: 'EricPernia 5/30/2013 18:53'!compilerDataTypesDecls: anObject	compilerDataTypesDecls := anObject! !!PLC_ProgramAccumulator_POU methodsFor: 'accessing' stamp: 'EricPernia 5/30/2013 18:53'!compilerVarDecls	^ compilerVarDecls! !!PLC_ProgramAccumulator_POU methodsFor: 'accessing' stamp: 'EricPernia 5/30/2013 18:53'!compilerVarDecls: anObject	compilerVarDecls := anObject! !!PLC_ProgramAccumulator_POU methodsFor: 'initialize-release' stamp: 'EricPernia 11/6/2013 16:54'!initialize	"Inicializo las colecciones de objetos de programa"	"Declaraciones de tipos de datos typeDef"	self compilerDataTypesDecls: PLC_Objects new.		"Declaraciones de variables"	self compilerVarDecls: PLC_VariableCategoryDecl tempVarDecls.		"Cuerpo de programa"	self compiledBody: PLC_Objects new.	! !!PLC_Project_Editor class methodsFor: 'instance creation' stamp: 'EricPernia 1/30/2014 01:01'!newWithProject: aProject andColor: aColor andBorderColor: aBorderColor andTitleColor: aTitleColor andTitleName: aTitleName	"Nueva instancia con cierto modelo de pou y colores"	| projectEditor |		"projectEditor es un Controlador"		projectEditor := self new.		"Seteo su Modelo"	projectEditor project: aProject. 		"Seteo los colores de su Vista"	projectEditor color: aColor.	projectEditor borderColor: aBorderColor.	projectEditor titleColor: aTitleColor.	"Seteo el titulo de la vista"	projectEditor titleName: aTitleName.		"hardConfigEditor es un Controlador"		"projectEditor hardConfigEditor: ( PLC_POU_Body_Editor 		newWithPOUBody: aProject pouBody		andColor: ( Color r: 1 g: 1 b: 1 alpha: 0.5 )  		andBorderColor: Color black 		andTitleColor:  PLC_GraphicElementProperties uniqueInstance hardConfigColor 		andTitleName: 'Configuraciones de Hardware'		)."			^ projectEditor! !!PLC_Project_Editor methodsFor: 'Commands' stamp: 'EricPernia 1/29/2014 23:43'!addProjectToLibrary 	"Aade su POU a la biblioteca de POUs"		project.! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!borderColor		^ borderColor! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!borderColor: anObject		borderColor := anObject! !!PLC_Project_Editor methodsFor: 'hardware configurations editor' stamp: 'EricPernia 1/29/2014 23:46'!buildProjectView	"Construye la vista y se la asigna a su variable de instancia pouBodyView para recordarla"		| controls projectView | 			"Creo la coleccin de controls que despues se pasa a la columna morph como array"	controls := OrderedCollection new.		"Agrego la barra de herramientas"	controls add: self titleControl.	controls add: self nameControl. "Me trae tambien los botones"	"controls add: self pouToolbar."		"Creo la columna morph"	projectView := self builder newColumn: controls asArray.	"hResizing: #spaceFill;	vResizing: #shrinkWrap;	cellSpacing: 10"		projectView 		cellInset: 0";		extent: 720 @ 450".										^ projectView.			! !!PLC_Project_Editor methodsFor: 'view' stamp: 'EricPernia 1/29/2014 21:47'!builder	"Devuelve el builder"	^ UITheme builder.! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!color		^ color! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!color: anObject		color := anObject! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 22:39'!hardConfigEditor		^ hardConfigEditor! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 22:39'!hardConfigEditor: anObject		hardConfigEditor := anObject! !!PLC_Project_Editor methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 21:47'!imageFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ self proyectFilesPath , 'imagenes/'."	^ ''.! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!keyboardFocusMorph		^ keyboardFocusMorph! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!keyboardFocusMorph: anObject		keyboardFocusMorph := anObject! !!PLC_Project_Editor methodsFor: 'hardware configurations editor' stamp: 'EricPernia 1/29/2014 21:47'!ladderPouBodyMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: self titleColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: self titleName.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_Project_Editor methodsFor: 'hardware configurations editor' stamp: 'EricPernia 1/29/2014 23:41'!nameControl	"Genera la fila"		| row |	row := self builder newRow: {		(self nameMorph )			"hResizing: #spaceFill".					self builder			newButtonFor: self			getState: nil			action: #addProjectToLibrary			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addToLibrary.png')			help: 'Aadir Proyecto a la Biblioteca.'.			}.			row cellInset: 0.		^ row.! !!PLC_Project_Editor methodsFor: 'hardware configurations editor' stamp: 'EricPernia 1/30/2014 00:45'!nameMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 693@56.	titleMorph backgroundColor: (Color r:1 g: 1 b: 1 alpha: 0.1) .	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 30.	titleMorph emphasis: 0.	titleMorph textColor: Color black.	titleMorph text: 'Nombre: ' , self project identifier.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_Project_Editor methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 21:47'!open	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	self openWindow.! !!PLC_Project_Editor methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 23:49'!openWindow	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| window aWorld   |	"Creo la ventana"	window := ( SystemWindow labelled: 'Editor de Proyecto de Automatizacin' ) model: nil.		"Agrego La cabecera del Editor de POU"	window addMorph: self buildProjectView fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@0.16 )			offsets: ( 0@0 corner: 1@0 )		).					"Agrego el editor de Configuraciones de Hardware"	"window addMorph: hardConfigEditor buildView fullFrame: (		LayoutFrame 			fractions: ( 0@0.4 corner: 1@1 )			offsets: ( 0@0 corner: 1@0 )		)."					window updatePaneColors.	window extent: 770@580.	window position: 10@10.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.		"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		" VAR DECLS ES UNA COLUMNA		varDecls := self builder newColumn: {		self variableToolBar. 				self globalVarTitle.		self globalVarTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.		varDecls cellInset: 0;		minHeight: 10;		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10	(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."	"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."! !!PLC_Project_Editor methodsFor: 'hardware configurations editor' stamp: 'EricPernia 3/16/2016 03:37'!pouName	"Genera la fila"		| row |	row := self builder newRow: {		(self pouNameMorph )			"hResizing: #spaceFill".					self builder			newButtonFor: self  "if we had a model it would go here"			getState: nil			action: #compile			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'compile.png')			help: 'Compilar.'.					self builder			newButtonFor: self  			getState: nil			action: #connectToDevice 			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'connectToDevice.png')			help: 'Conectarse al PLC.'.						self builder			newButtonFor: self  			getState: nil			action: #downloadProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'downloadProgram.png')			help: 'Descargar Programa al PLC.'.						self builder			newButtonFor: self			getState: nil			action: #addPOUToLibrary			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'toLibrary.png')			help: 'Aadir POU a la Biblioteca.'.			}.			row cellInset: 0.		^ row.! !!PLC_Project_Editor methodsFor: 'hardware configurations editor' stamp: 'EricPernia 1/29/2014 21:47'!pouToolbar 	"Devuelve la barra de herramientas superior de la ventana de edicin de Ladder"		| builder |		"^PLC_LadderToolBarMorph new."	builder := UITheme builder.		^ builder newToolbar: {				builder			newButtonFor: self "if we had a model it would go here"			getState: nil			action: #showPOUCode			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'compile.png')			help: 'Compilar POU.'.					builder			newButtonFor: self			getState: nil			action: #addPOUToLibrary			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addToLibrary.png')			help: 'Aadir POU a la Biblioteca.'.		}.! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 22:39'!project		^ project! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 22:39'!project: anObject		project := anObject! !!PLC_Project_Editor methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 23:48'!projectFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ 'D:/Proyecto/Pharo-1.3-13315-OneClick.app/Contents/Resources/PLeriC'."	^ ''.! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!titleColor		^ titleColor! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!titleColor: anObject		titleColor := anObject! !!PLC_Project_Editor methodsFor: 'hardware configurations editor' stamp: 'EricPernia 1/29/2014 23:39'!titleControl	"Genera la fila"		| row |	row := self builder newRow: {		(self titleMorph )			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Project_Editor methodsFor: 'hardware configurations editor' stamp: 'EricPernia 1/29/2014 23:37'!titleMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: self titleColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: self titleName.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!titleName		^ titleName! !!PLC_Project_Editor methodsFor: 'accessing' stamp: 'EricPernia 1/29/2014 21:47'!titleName: anObject		titleName := anObject! !!PLC_Proyect_Editor_OLD methodsFor: 'add-remove' stamp: 'EricPernia 11/19/2013 16:37'!addNetwork	"Aade un nuevo segmento a la ventana"		^ 'Se agrego segmento.'! !!PLC_Proyect_Editor_OLD methodsFor: 'open/close' stamp: 'EricPernia 11/19/2013 16:37'!builder	"Devuelve el builder"	^ UITheme builder.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!descriptionMorph	"devuelve un PLC_TitleMorph"	| descriptionMorph |	descriptionMorph := PLC_TitleMorph new.	descriptionMorph extent: 400@20.	descriptionMorph backgroundColor: self varTitlesColor.	descriptionMorph backgroundBorderWidth: 1.	descriptionMorph emphasis: self varTitleEmphasis.	descriptionMorph text: 'Descripcin'.	descriptionMorph changed.		^ descriptionMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'fbd editor' stamp: 'EricPernia 11/19/2013 16:37'!fbdPouBodyEditor	"Devuelve la columna con el editor de lenguaje FBD"		"HACER"! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!globalVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!globalVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self globalVarsMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!globalVarsMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@30.	globalVarsMorph backgroundColor: Color black twiceLighter.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: 1.	globalVarsMorph text: 'Globales'. "Declaraciones de variables globales"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - events' stamp: 'EricPernia 11/19/2013 16:37'!hasSelectedVariable	^selectedVariableIndex > 0! !!PLC_Proyect_Editor_OLD methodsFor: 'il editor' stamp: 'EricPernia 11/19/2013 16:37'!ilPouBodyEditor	"Devuelve la columna con el editor de lenguaje IL"		"HACER"! !!PLC_Proyect_Editor_OLD methodsFor: 'open/close' stamp: 'EricPernia 11/19/2013 16:37'!imageFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ self proyectFilesPath , 'imagenes/'."	^ ''.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/19/2013 16:38'!inOutVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!inOutVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Entrada-Salida'. "Declaraciones de variables de Entrada-Salida"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!inOutVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self inOutVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/19/2013 16:38'!inputVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!inputVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Entrada'. "Declaraciones de variables de Entrada"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!inputVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self inputVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor' stamp: 'EricPernia 11/19/2013 16:37'!interfaceVarsColumn	"Devuelve la columna con el editor de lenguaje Ladder"		| interfaceVarsColumn |		interfaceVarsColumn := self builder newColumn: { 		self varTitles.				self inputVarTitle.		self inputVarLists. 						self outputVarTitle.		self outputVarLists. 						self inOutVarTitle.		self inOutVarLists. 		}.		interfaceVarsColumn cellInset: 0;		extent: 720 @ 20.			^ interfaceVarsColumn.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor' stamp: 'EricPernia 11/19/2013 16:37'!internalVarsColumn	"Devuelve la columna con el editor de lenguaje Ladder"	| internalVarsColumn |		internalVarsColumn := self builder newColumn: { 				self varTitles.				self varVarTitle.		self varVarLists. 				self tempVarTitle.		self tempVarLists. 		}.		internalVarsColumn cellInset: 0;		extent: 720 @ 20.			^ internalVarsColumn.! !!PLC_Proyect_Editor_OLD methodsFor: 'accessing' stamp: 'EricPernia 11/19/2013 16:37'!keyboardFocusNetwork	^ keyboardFocusNetwork! !!PLC_Proyect_Editor_OLD methodsFor: 'accessing' stamp: 'EricPernia 11/19/2013 16:37'!keyboardFocusNetwork: anObject	keyboardFocusNetwork := anObject! !!PLC_Proyect_Editor_OLD methodsFor: 'ladder editor' stamp: 'EricPernia 11/19/2013 16:37'!ladderPouBodyEditor	"Devuelve la columna con el editor de lenguaje Ladder"		| ladderPouBodyEditor controller ladderView scroller expander |	controller := PLC_LadderController newWithModel: nil.		ladderView := controller openLadderView.	self keyboardFocusNetwork: ladderView.			scroller := ( self builder newScrollPaneFor: ladderView ) 		hResizing: #spaceFill; 		vResizing: #spaceFill.	expander := ( self builder newExpander: 'Segmento 1'  for: scroller ) 		spaceFillWeight: 1; 		expanded: true.	ladderPouBodyEditor := self builder newColumn: {   		self ladderPouBodyMorph.		self ladderToolbar.		expander.	}.	"hResizing: #spaceFill;	vResizing: #shrinkWrap;	cellSpacing: 10"			ladderPouBodyEditor 		cellInset: 0";		extent: 720 @ 450".							^ ladderPouBodyEditor.					! !!PLC_Proyect_Editor_OLD methodsFor: 'ladder editor' stamp: 'EricPernia 11/19/2013 16:37'!ladderPouBodyMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: PLC_GraphicElementProperties uniqueInstance programHeaderColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: 'Cuerpo de POU en lenguaje Ladder'.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'ladder editor' stamp: 'EricPernia 3/16/2016 03:38'!ladderToolbar 	"Devuelve la barra de herramientas superior de la ventana de edicin de Ladder"		| builder |		"^PLC_LadderToolBarMorph new."	builder := UITheme builder.		^ builder newToolbar: {		"		builder			newButtonFor: self keyboardFocusNetwork ""if we had a model it would go here""			getState: nil			action: #drawGroups			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addNetwork.png')			help: 'Aadir Segmento.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #dfdff			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'removeNetwork.png')			help: 'Remover Segmento seleccionado.'.		"								"builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #ilExport			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'ilExport.png')			help: 'Exportar Configuracion en IL.'."					builder			newButtonFor: self keyboardFocusNetwork "if we had a model it would go here"			getState: nil			action: #compile			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'compile.png')			help: 'Compilar.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #connectToDevice			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'connectToDevice.png')			help: 'Conectarse al PLC.'.						builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #downloadProgram			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'downloadProgram.png')			help: 'Descargar Programa al PLC.'.																	builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyCPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addContact.png') 			help: 'Aadir Contacto.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyBPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addCoil.png') 			help: 'Aadir Bobina.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyOPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'openBranch.png') 			help: 'Abrir Rama.'.					builder			newButtonFor: self keyboardFocusNetwork			getState: nil			action: #keyPPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'closeBranch.png') 			help: 'Cerrar Rama.'.								builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyFPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addFunction.png') 			help: 'Aadir llamado a Funcin.'.					builder			newButtonFor: self keyboardFocusNetwork 			getState: nil			action: #keyGPressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addFunctionBlock.png') 			help: 'Aadir llamado a Bloque de Funcin.'.					builder			newButtonFor: self keyboardFocusNetwork			getState: nil			action: #generateCode			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'addProgramControl.png') 			help: 'Aadir componente de Control de Ejecucin.'.					builder			newButtonFor: self keyboardFocusNetwork			getState: nil			action: #keyDeletePressed			arguments: nil			getEnabled: nil			labelForm: (Form fromFileNamed: self imageFilesPath , 'removeSelected.png') 			help: 'Remover componente(s) seleccionado(s).'.											"		builder			newButtonFor: nil ""if we had a model it would go here""			getState: nil			action: #openFile			arguments: nil			getEnabled: nil			labelForm: builder theme smallNewIcon			help: 'Nuevo'.		builder			newButtonFor: nil			getState: nil			action: #openFile			arguments: nil			getEnabled: nil			labelForm: builder theme smallOpenIcon			help: 'Abrir'.		builder			newButtonFor: nil			getState: nil			action: #saveFile			arguments: nil			getEnabled: nil			labelForm: builder theme smallSaveIcon			help: 'Guardar'.		builder			newButtonFor: nil			getState: nil			action: #print			arguments: nil			getEnabled: nil			labelForm: builder theme smallPrintIcon			help: 'Imprimir' 		" 	}.! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!locatedMorph	"devuelve un PLC_TitleMorph"	| addressMorph |	addressMorph := PLC_TitleMorph new.	addressMorph extent: 90@25.	addressMorph backgroundColor: Color black twiceLighter lighter.	addressMorph backgroundBorderWidth: 1.	addressMorph emphasis: 1.	addressMorph text: 'Ubicacin'.	addressMorph changed.		^ addressMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!locatedVarLists	"Genera la fila"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varAddress			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Ubicacin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!locatedVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self locatedVarsMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!locatedVarTitles	"Genera la fila"	| row |	row := self builder newRow: {		(self nameMorph)			hResizing: #spaceFill;			minWidth: 200.		(self typeMorph)			hResizing: #spaceFill;			minWidth: 90.		(self locatedMorph)			hResizing: #spaceFill;			minWidth: 90.		(self descriptionMorph)			hResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!locatedVarsMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@30.	globalVarsMorph backgroundColor: Color black twiceLighter.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: 1.	globalVarsMorph text: 'Ubicadas'. "Declaraciones de variables ubicadas 	Variables representadas directamente"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!nameMorph	"devuelve un PLC_TitleMorph"	| nameMorph |	nameMorph := PLC_TitleMorph new.	nameMorph extent: 200@20.	nameMorph backgroundColor: self varTitlesColor.	nameMorph backgroundBorderWidth: 1.	nameMorph emphasis: self varTitlesEmphasis.	nameMorph text: 'Nombre'.	nameMorph changed.		^ nameMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'open/close' stamp: 'EricPernia 11/19/2013 16:37'!open	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| window windowExtent aWorld   |	"Creo la ventana"	window := ( SystemWindow labelled: 'Editor de Unidad de Organizacin de Programa (POU)' ) model: nil.		"Agrego el editor de variables"	window addMorph: self pouVarDeclEditor fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@0.4 )			offsets: ( 0@0 corner: 1@0 )		).	"Agrego el editor de ladder"	window addMorph: self ladderPouBodyEditor fullFrame: (		LayoutFrame 			fractions: ( 0@0.4 corner: 1@1 )			offsets: ( 0@0 corner: 1@0 )		).					window updatePaneColors.	window extent: 800@600.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.		"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		" VAR DECLS ES UNA COLUMNA		varDecls := self builder newColumn: {		self variableToolBar. 				self globalVarTitle.		self globalVarTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.		varDecls cellInset: 0;		minHeight: 10;		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10	(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."	"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."! !!PLC_Proyect_Editor_OLD methodsFor: 'Eric' stamp: 'EricPernia 11/19/2013 16:37'!openEric	"Abre la ventana"	| content |				"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		content := self builder newColumn: {		self varMenu. 				self globalVarTitle.		self varTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.	content cellInset: 0.		"hResizing: #spaceFill;		vResizing: #spaceFill;		cellSpacing: 10."	"(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."		 (content openInWindowLabeled: 'Contactos') 		extent: 800@600.! !!PLC_Proyect_Editor_OLD methodsFor: 'Eric' stamp: 'EricPernia 11/19/2013 16:37'!openEric2	"Abre la ventana"	|builder content variablesRow menu varTitles1 varTitles2 |	builder := UITheme builder.		menu := builder newRow: {		builder newButtonFor: self 			action: #addButtonClick 			label: 'Aadir' 			help: 'Crear un contacto nuevo'.						builder newButtonFor: self 			action: #removeButtonClick 					label: 'Remover' 			help: 'Remover contacto selecccionado'.		builder newButtonFor: self 			action: #editButtonClick 					label: 'Editar' 			help: 'Editar contacto selecccionado' 		}.			varTitles1 := builder newRow: {		(self globalVarsMorph)			hResizing: #spaceFill.		}.			varTitles2 := builder newRow: {		(self nameMorph)			hResizing: #spaceFill;			minWidth: 200.		(self typeMorph)			hResizing: #spaceFill;			minWidth: 90.		(self descriptionMorph)			hResizing: #spaceFill;			minWidth: 400.		}.				variablesRow := builder newRow: {		(builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		(builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		(builder 			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.				"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"			varTitles1 cellInset: 0.		varTitles2 cellInset: 0.		variablesRow cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"	content := builder newColumn: {		menu.		varTitles1.		varTitles2.		variablesRow.	}.	content cellInset: 0.		"hResizing: #spaceFill;		vResizing: #spaceFill;		cellSpacing: 10."	"(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."		 (content openInWindowLabeled: 'Contactos') 		extent: 800@600.! !!PLC_Proyect_Editor_OLD methodsFor: 'Eric' stamp: 'EricPernia 11/19/2013 16:37'!openEric3	"Abre la ventana"	| window windowExtent aWorld varDeclsContainer varDecls pouBody pouBodyContainer |				"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		varDecls := self builder newColumn: {		self varMenu. 				self globalVarTitle.		self varTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.	varDecls cellInset: 0;		minHeight: 10";		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10".	"(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."		"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."	varDeclsContainer := varDecls.		pouBody := Morph new.	pouBodyContainer := pouBody.	"Creo la ventana y agrego los controles"	window := ( SystemWindow labelled: 'Ventana' ) model: nil.			window addMorph: varDeclsContainer fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@0.4 )			offsets: ( 0@0 corner: 1@0 )		).	window addMorph: pouBodyContainer fullFrame: (		LayoutFrame 			fractions: ( 0@0.4 corner: 1@1 )			offsets: ( 0@0 corner: 1@0 )		).					"window updatePaneColors."	window extent: 800@600.		aWorld := Morph new currentWorld.		aWorld addMorph: window.	window activate.	aWorld startSteppingSubmorphsOf: window.	^ window.! !!PLC_Proyect_Editor_OLD methodsFor: 'Eric' stamp: 'EricPernia 11/19/2013 16:37'!openEric4	"Abre la ventana del  Editor. Para esto creo la ventana y agrego los controles"	| window windowExtent aWorld   |	"Creo la ventana"	window := ( SystemWindow labelled: 'Editor de Unidad de Organizacin de Programa (POU)' ) model: nil.		"Agrego el editor de variables"	window addMorph: self pouVarDeclEditor fullFrame: (		LayoutFrame 			fractions: ( 0@0 corner: 1@0.4 )			offsets: ( 0@0 corner: 1@0 )		).	"Agrego el editor de ladder"	window addMorph: self ladderPouBodyEditor fullFrame: (		LayoutFrame 			fractions: ( 0@0.4 corner: 1@1 )			offsets: ( 0@0 corner: 1@0 )		).					window updatePaneColors.	window extent: 800@600.		aWorld := Morph new currentWorld.	aWorld addMorph: window.		window activate.		aWorld startSteppingSubmorphsOf: window.	^ window.		"(builder newLabel: 'Nombre')			hResizing: #spaceFill;			vResizing: #spaceFill;			color: Color white; 			minHeight: 50;			minWidth: 200.	"		" VAR DECLS ES UNA COLUMNA		varDecls := self builder newColumn: {		self variableToolBar. 				self globalVarTitle.		self globalVarTitles.		self globalVarLists. 				self locatedVarTitle.		self locatedVarTitles.		self locatedVarLists.	}.		varDecls cellInset: 0;		minHeight: 10;		hResizing: #spaceFill;		vResizing: #shrinkWrap;		cellSpacing: 10	(builder newPluggableDialogWindow: 'Titulo' for: content)		extent: 800@600; 		 openInWorld."	"(varDecls openInWindowLabeled: 'Contactos') 		extent: 800@600."		"varDeclsContainer := PluggablePanelMorph new.	varDeclsContainer addMorph: varDecls."! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/19/2013 16:38'!outputVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!outputVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Salida'. "Declaraciones de variables de Salida"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!outputVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self outputVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor' stamp: 'EricPernia 11/19/2013 16:37'!pouVarDeclEditor	"Devuelve la columna con el editor de lenguaje Ladder"		| pouVarDeclEditor exp1 exp2 eg1 |			"scroller := ( self builder newScrollPaneFor: ladderView ) 		hResizing: #spaceFill; 		vResizing: #spaceFill."	"morph1 := (PanelMorph new fillStyle: (SolidFillStyle color: Color red))		hResizing: #spaceFill;		vResizing: #spaceFill."			exp1 := ( self builder newExpander: 'Variables de interfaz' for: self interfaceVarsColumn )		spaceFillWeight: ProportionalSplitterMorph splitterWidth;		expanded: true.		eg1 := EdgeGripMorph new		target: exp1;		edgeName: #bottom;		vResizing: #rigid;		extent: 24 @ 1;		on: #mouseDown send: #expandedSizingRigid to: exp1.		exp2 := ( self builder newExpander: 'Variables internas'  for: self internalVarsColumn )		spaceFillWeight: ProportionalSplitterMorph splitterWidth;		expanded: false.		pouVarDeclEditor := self builder 		newColumn: { 			self pouVarTitle.			self variableToolBar.			exp1. 			eg1. 			exp2.			}.		pouVarDeclEditor cellInset: 0;		extent: 720 @ 20.			^ pouVarDeclEditor.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!pouVarMorph	"devuelve un PLC_TitleMorph"	| titleMorph |	titleMorph := PLC_TitleMorph new.	titleMorph extent: 780@30.	titleMorph backgroundColor: PLC_GraphicElementProperties uniqueInstance programHeaderColor.	titleMorph backgroundBorderWidth: 1.	titleMorph leftMargin: 10.	titleMorph emphasis: 1.	titleMorph text: 'Declaraciones de variables de POU'.	titleMorph leftAlign.	titleMorph changed.		^ titleMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!pouVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self pouVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'open/close' stamp: 'EricPernia 1/29/2014 23:48'!projectFilesPath	"Devuelve el string de la ruta de los archivos del proyecto"	"^ 'D:/Proyecto/Pharo-1.3-13315-OneClick.app/Contents/Resources/PLeriC'."	^ ''.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/19/2013 16:38'!tempVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!tempVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Temporales'. "Declaraciones de variables Temporales"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!tempVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self tempVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!typeMorph	"devuelve un PLC_TitleMorph"	| typeMorph |	typeMorph := PLC_TitleMorph new.	typeMorph extent: 90@20.	typeMorph backgroundColor: self varTitlesColor.	typeMorph backgroundBorderWidth: 1.	typeMorph emphasis: self varTitlesEmphasis.	typeMorph text: 'Tipo'.	typeMorph changed.		^ typeMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'PARA EDITOR DE RESOURCE' stamp: 'EricPernia 11/19/2013 16:37'!varAddress		| col |	col := OrderedCollection new.		col add: '%I0.0'.	col add: ''.	col add: ''.	col add: ''.		^ col.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor' stamp: 'EricPernia 11/19/2013 16:37'!varDescription		| col |	col := OrderedCollection new.		col add: 'Variable 1, representa el cambio en la corriente nominal.'.	col add: 'Variable 2, representa el cambio en la corriente nominal.'.	col add: 'Variable 3, representa el cambio en la corriente nominal.'.	col add: 'Variable 4, representa el cambio en la corriente nominal.'.		^ col.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor' stamp: 'EricPernia 11/19/2013 16:37'!varInitialValue		| col |	col := OrderedCollection new.		col add: '0'.	col add: '1'.	col add: '15'.	col add: '50'.		^ col.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor' stamp: 'EricPernia 11/19/2013 16:37'!varName		| col |	col := OrderedCollection new.		col add: 'variable1'.	col add: 'var_2_laaaaarga'.	col add: 'var3'.	col add: 'mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm'.	^ col.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - style' stamp: 'EricPernia 11/19/2013 16:38'!varTitleColor	"Genera la fila"		^ Color gray.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - style' stamp: 'EricPernia 11/19/2013 16:38'!varTitleEmphasis	""		^ 0.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!varTitles	"Genera la fila"	| row |	row := self builder newRow: {		(self nameMorph)			hResizing: #spaceFill;			minWidth: 200.		(self typeMorph)			hResizing: #spaceFill;			minWidth: 90.		(self descriptionMorph)			hResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - style' stamp: 'EricPernia 11/19/2013 16:38'!varTitlesColor	"Color"		^ PLC_GraphicElementProperties uniqueInstance rowColorHeader.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - style' stamp: 'EricPernia 11/19/2013 16:38'!varTitlesEmphasis	""		^ 1.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor' stamp: 'EricPernia 11/19/2013 16:37'!varType		| col |	col := OrderedCollection new.		col add: 'Bool'.	col add: 'Bool'.	col add: 'Int'.	col add: 'Int'.		^ col.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - lists' stamp: 'EricPernia 11/19/2013 16:38'!varVarLists	"Genera la fila de Lists de variables"	| row |	row := self builder newRow: {		( self builder 			newListFor: self   			list: #varName			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Nombre de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 200.		( self builder 			newListFor: self   			list: #varType			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Tipo de datos de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 90.		( self builder			newListFor: self   			list: #varDescription			selected: #variableSelectedIndex			changeSelected: #variableSelectedIndex:			help: 'Descripcin de la Variable')			hResizing: #spaceFill;			vResizing: #spaceFill;			minWidth: 400.		}.			row cellInset: 0;		hResizing: #spaceFill;		vResizing: #spaceFill.		"shrinkWrap"		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!varVarMorph	"devuelve un PLC_TitleMorph"	| globalVarsMorph |	globalVarsMorph := PLC_TitleMorph new.	globalVarsMorph extent: 780@25.	globalVarsMorph backgroundColor: self varTitleColor.	globalVarsMorph backgroundBorderWidth: 1.	globalVarsMorph emphasis: self varTitleEmphasis.	globalVarsMorph text: 'Internas'. "Declaraciones de variables Internas"	globalVarsMorph changed.		^ globalVarsMorph.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - titles' stamp: 'EricPernia 11/19/2013 16:37'!varVarTitle	"Genera la fila"		| row |	row := self builder newRow: {		(self varVarMorph)			hResizing: #spaceFill.		}.			row cellInset: 0.		^ row.! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - events' stamp: 'EricPernia 11/19/2013 16:38'!variableSelectedIndex	^ selectedVariableIndex ifNil: [selectedVariableIndex := 0]! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor - events' stamp: 'EricPernia 11/19/2013 16:38'!variableSelectedIndex: aSmallInteger 	selectedVariableIndex := aSmallInteger.	self 		changed: #variableSelectedIndex;  		changed: #hasSelectedVariable		! !!PLC_Proyect_Editor_OLD methodsFor: 'variable editor' stamp: 'EricPernia 11/19/2013 16:40'!variableToolBar	"Genera la fila"	^ self builder newRow: {		self builder newButtonFor: self 			action: #nada 			label: 'Nueva'			help: ''.									}.! !!PLC_Resource_Declarations class methodsFor: 'instance creation' stamp: 'EricPernia 11/7/2013 20:29'!newWithResourceDeclaration: aResourceDecl	"Devuelve una nueva instancia con el recurso que le llega como parametro"	| decls |	decls := self new.		"Categoras de Declaraciones de Variables"	decls userVarDecls add: PLC_VariableCategoryDecl globalVarDecls.	decls userVarDecls add: PLC_VariableCategoryDecl externVarDecls.		"Le agrego el Recurso"	decls resourceDecl: aResourceDecl.		^ decls.! !!PLC_Resource_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/7/2013 20:18'!externVarDecls	"Devuelve sus declaraciones de variables VAR_EXTERN"	^ self userVarDecls at: 2.	"globalVarDeclsexternalVarDecls"! !!PLC_Resource_Declarations methodsFor: 'variable declarations' stamp: 'EricPernia 11/7/2013 20:17'!globalVarDecls	"Devuelve sus declaraciones de variables VAR_GLOBAL"	^ self userVarDecls at: 1.	"globalVarDeclsexternalVarDecls"! !!PLC_Resource_Declarations methodsFor: 'initialize-release' stamp: 'EricPernia 11/7/2013 20:16'!initialize	"Inicializa las Colecciones de declaraciones de una POU"	"Declaraciones de Tipos de Datos"	userDataTypesDecls := OrderedCollection new.		"Declaraciones de Variables"	userVarDecls := OrderedCollection new.! !!PLC_Resource_Declarations methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 20:19'!resourceDecl		^ resourceDecl! !!PLC_Resource_Declarations methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 20:19'!resourceDecl: anObject		resourceDecl := anObject! !!PLC_Resource_Declarations methodsFor: 'instance' stamp: 'EricPernia 11/7/2013 20:22'!structureDeclaration	"Declaracion de tipo de dato estructurado."	| struct |	struct := PLC_StructureDecl 		newWithIdentifier: self structureDeclarationIdentifier.	"AADO LAS VARIABLES A LA ESTRUCTURA"	"Variables Globales"	self globalVarDecls do: [ :each |		struct add: each.		].		"Variables Externas"	self externVarDecls do: [ :each |		struct add: each.		].	 		^ struct.! !!PLC_Resource_Declarations methodsFor: 'instance' stamp: 'EricPernia 11/7/2013 20:22'!structureDeclarationIdentifier	"Identificador de tipo de dato estructurado."	^ 'Struct_' , self resourceDecl identifier.! !!PLC_Resource_Declarations methodsFor: 'instance' stamp: 'EricPernia 11/7/2013 20:16'!typeDeclaration	"Declaracion de tipo de dato derivado."	| type |	type := PLC_TypeDecl 		newWithDataType: self structureDeclaration		andIdentifier: self typeDeclarationIdentifier.	^ type.! !!PLC_Resource_Declarations methodsFor: 'instance' stamp: 'EricPernia 11/8/2013 02:17'!typeDeclarationIdentifier	"Identificador de tipo de dato estructurado."	^ 'PLC_' , self resourceDecl pouTypeAcronym , '_' , self structureDeclarationIdentifier.! !!PLC_Resource_Declarations methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 20:16'!userDataTypesDecls	^ userDataTypesDecls! !!PLC_Resource_Declarations methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 20:16'!userDataTypesDecls: anObject	userDataTypesDecls := anObject! !!PLC_Resource_Declarations methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 20:16'!userVarDecls		^ userVarDecls! !!PLC_Resource_Declarations methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 20:16'!userVarDecls: anObject		userVarDecls := anObject! !!PLC_Resource_Declarations methodsFor: 'find' stamp: 'CarlosLombardi 10/2/2016 20:14'!varDeclWithIdentifierOrNIl: aVariableIdentifier	"La delaracion de variable con el identificador aVariableIdentifier.	 Si no hay, devuelve nil"	^ self userVarDecls varDeclWithIdentifierOrNIl: aVariableIdentifier.	! !!PLC_StPersistence class methodsFor: 'as yet unclassified' stamp: 'EricPernia 4/12/2015 16:52'!AddProgram: aProgram	"Add a Program in the Programs Dictionary"	Programs at: aProgram val put: aProgram.		"ProgramsCreated := false."! !!PLC_StPersistence class methodsFor: 'as yet unclassified' stamp: 'EricPernia 4/12/2015 16:51'!ClearPrograms	"Reset the Programs Dictionary"	Programs := Dictionary new.		"ProgramsCreated := false."! !!PLC_StPersistence class methodsFor: 'as yet unclassified' stamp: 'EricPernia 4/12/2015 16:47'!Programs	"comment stating purpose of message"	^ Programs! !!PLC_StPersistence class methodsFor: 'initialize-release' stamp: 'EricPernia 5/3/2015 08:06'!initialize	"Creates the Programs Dictionary"	"self clearPrograms."! !!PLC_StructureInitialization class methodsFor: 'instance creation' stamp: 'EricPernia 6/16/2013 23:24'!newWithStructDecl: aStructDecl	"Crea una nueva instancia con aSaStructDecl."	| structInit |		structInit := self new.		structInit structDecl: aStructDecl.		structInit structDecl declarations do: [ :each |		structInit values add: each initialValue.		].		^ structInit.! !!PLC_StructureInitialization methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 22:57'!cCompile	"Compila a codigo C"	| value |		value := '{'.		self values do: [ :each |		value := value , '			' ,		each cCompile , ','.		].		value := value copyFrom: 1 to: ( value size ) - 1. "BORRO LA ULTIMA COMA DE MAS"			value := value , '		}'.		^ value! !!PLC_StructureInitialization methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 14:02'!dataValue		"PARCHEEEEEEEEEEEEEEEE"		^ PLC_Literal newWithDataType: PLC_DataType Int andDataValue: 0.! !!PLC_StructureInitialization methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 23:15'!ilCompile	"Compila a codigo C"	| value |		value := '('.		self values do: [ :each |		value := value , '					' ,		each ilCompile , ','.		].		value := value copyFrom: 1 to: ( value size ) - 1. "BORRO LA ULTIMA COMA DE MAS"			value := value , '				)'.		^ value! !!PLC_StructureInitialization methodsFor: 'initialize-release' stamp: 'EricPernia 6/16/2013 23:16'!initialize	"Inicializa la coleccion values"	values := OrderedCollection new.! !!PLC_StructureInitialization methodsFor: 'accessing' stamp: 'EricPernia 6/16/2013 21:10'!structDecl		^ structDecl! !!PLC_StructureInitialization methodsFor: 'accessing' stamp: 'EricPernia 6/16/2013 21:10'!structDecl: anObject		structDecl := anObject! !!PLC_StructureInitialization methodsFor: 'accessing' stamp: 'EricPernia 6/16/2013 23:15'!values		^ values! !!PLC_StructureInitialization methodsFor: 'accessing' stamp: 'EricPernia 6/16/2013 23:15'!values: anObject		values := anObject! !!PLC_StructureItem class methodsFor: 'instance creation' stamp: 'EricPernia 11/6/2013 16:00'!newWithItem: item1 andItem: item2	"Nueva instancia con 2 items cada uno deve ser un operando variable, 	el primero de estructura y el otro de una var de un campo interno de esta estructura.	"	| structItem |		structItem := self new.		structItem add: item1.	structItem add: item2.			^ structItem.		! !!PLC_StructureItem methodsFor: 'add-remove' stamp: 'EricPernia 6/12/2013 02:28'!add: anObject	"Agrega anObject a su coleccion items"	self items add: anObject.! !!PLC_StructureItem methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 14:09'!cCompile	"Este representa al Objeto de programa que representa un acceso a una variable de una estructura.		Devuelve el string:   item1.item2.item3 ... itemn	ej:	StructName.VarName	"		| string |	string := ''.	self items do: [ :each |		string := string , each cCompile , '.' 		].		^ string copyFrom: 1 to: (string size ) - 1.! !!PLC_StructureItem methodsFor: 'compilation' stamp: 'EricPernia 1/23/2014 00:04'!dataType 	"Devuelve el tipo de datos del objeto despues del ltimo punto.	Este puede ser una variable u otra estructura		Este mtodo lo utilizan los Actual Argument.	"		^ self items last dataType.	! !!PLC_StructureItem methodsFor: 'compilation' stamp: 'EricPernia 1/23/2014 00:04'!dataValue 	"Devuelve el valor del objeto despues del ltimo punto.	Este puede ser una variable u otra estructura		Este mtodo lo utilizan los Actual Argument.	"		^ self  items last dataValue.	! !!PLC_StructureItem methodsFor: 'compilation' stamp: 'EricPernia 9/14/2015 05:32'!ilCompile	"Este representa al Objeto de programa que representa un acceso a una variable de una estructura.		Devuelve el string:   item1.item2.item3 ... itemn	ej:	StructName.VarName	"		| string |	string := ''.	self items do: [ :each |		string := string , each ilCompile , '.' 		].		^ string copyFrom: 1 to: (string size ) - 1.! !!PLC_StructureItem methodsFor: 'initialize-release' stamp: 'EricPernia 6/9/2013 05:30'!initialize	"comment stating purpose of message"	items := OrderedCollection new.! !!PLC_StructureItem methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:48'!isError	"Devuelve true si es error"	^ false.! !!PLC_StructureItem methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:08'!isPLCLiteral	"Devuelve true si es literal"	^ false.! !!PLC_StructureItem methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:11'!isStructItem	"Devuelve true si es StructItem"	^ true.! !!PLC_StructureItem methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:25'!isVaraible	"Devuelve true si es variable"	^ false.! !!PLC_StructureItem methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:10'!isVoid	"Devuelve true si es void"	^ false.! !!PLC_StructureItem methodsFor: 'accessing' stamp: 'EricPernia 6/9/2013 05:17'!items	^ items! !!PLC_StructureItem methodsFor: 'accessing' stamp: 'EricPernia 6/9/2013 05:17'!items: anObject	items := anObject! !!PLC_StructureItem methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 12:55'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ self declaration varScopePrefix.! !!PLC_ProgramConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/16/2013 17:05'!cCompile	"Compila el elemento IL llamado a funcin a lenguaje C.	Devuelve:			inputAssignment;		inOutAssignment;		cPOUName( &instanceName ); 					outputAssignment; 		Por ejemplo:			// Cargo los parametros VAR_INPUT y VAR_IN_OUT del 		// CTU_INT contador1 con sus variables conectadas		// en su estructura.				contador1.CU = varBool1 ;		contador1.R = varBool2 ;		contador1.PV = varInt1 ;								// Llamo a la funcin pasandole la estructura por referencia				PLC_FB_CTU_INT( &contador1 );									// Cargo las variables conectadas con los parametros VAR_OUTPUT del CTU_INT contador1		// de en su estructura.			varBool3 = contador1.Q;			varInt2 = contador1.CV;		"		| cCode |		cCode := '			'.	self inputAssignments do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		' , each cCompile , ';'.				].		].				self inOutAssignments do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		' , each cCompile , ';'.				].		].		cCode := cCode , '			' , self cPOUName , 		'( &',		 self instanceName ,		 ' );				'.				self outputAssignments do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		' , each cCompile , ';'.				].		].					cCode := cCode , ''.				^ cCode.			! !!PLC_ProgramConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/8/2013 02:01'!ilCompile	"Compila el elemento IL Configuracin de Programa a IL.	Este elemento IL es una instanciacin y llamado a la vez de 	una POU Programa.	Devuelve (sin asociacin con Tarea. Es la Tarea FreeRTOS de menor prioridad):			PROGRAM ProgramInstanceName : ProgramName ( 			inputAssignment , 			inOutAssignment , 			outputAssignment 			) ;		Por ejemplo:			PROGRAM G : GRAVEL ( 			IN :=  ENT1 , 			PT := T#300ms ,			ENO => ERR , 			Q => OUT , 			ET => ELAPSED 			) ;							Devuelve (con asociacin con Tarea):			PROGRAM ProgramInstanceName WITH TaskName : ProgramName ( 			inputAssignment , 			outputAssignment , 			inOutAssignment 			) ;		Por ejemplo:			PROGRAM G WITH TAREA1 : GRAVEL ( 			IN :=  ENT1 , 			PT := T#300ms ,			ENO => ERR , 			Q => OUT , 			ET => ELAPSED 			) ;				"		| pouCall |	pouCall := '			PROGRAM ' , 		self pouName , ' ' ,		self withTaskName , 		' : ' , 		self instanceName , ' ( '.		self inputAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].						self inOutAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].						self outputAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].					"Borro la ltima coma de ms"		pouCall := pouCall copyFrom: 1 to: ( pouCall size ) - 1.		pouCall := pouCall , '				) ;'.		^ pouCall.			! !!PLC_ProgramConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/6/2013 10:51'!task		^ task! !!PLC_ProgramConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/6/2013 10:51'!task: anObject		task := anObject! !!PLC_ProgramConfiguration methodsFor: 'accessing' stamp: 'EricPernia 11/6/2013 10:52'!taskName		^ self task taskName! !!PLC_ProgramConfiguration methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 22:26'!withTaskName	"Devuelve el nombre de la Tarea anteponiendo WITH"		self task 		ifNil: [ 			^ ''.			 ] 		ifNotNil: [			^ 'WITH ' , self taskName.			].! !!PLC_TextualFunctionBlockCall methodsFor: 'compilation' stamp: 'EricPernia 11/18/2013 17:20'!cCompile	"Compila el elemento IL llamado a funcin a lenguaje C.	Devuelve:			inputAssignment;		inOutAssignment;		cPOUName( &instanceName ); 					outputAssignment; 		Por ejemplo:			// Cargo los parametros VAR_INPUT y VAR_IN_OUT del 		// CTU_INT contador1 con sus variables conectadas		// en su estructura.				contador1.CU = varBool1 ;		contador1.R = varBool2 ;		contador1.PV = varInt1 ;								// Llamo a la funcin pasandole la estructura por referencia				PLC_FB_CTU_INT( &contador1 );									// Cargo las variables conectadas con los parametros VAR_OUTPUT del CTU_INT contador1		// de en su estructura.			varBool3 = contador1.Q;			varInt2 = contador1.CV;		"		| cCode |		cCode := '			'.	self inputAssignments do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		' , each cCompile , ';'.				].		].				self inOutAssignments do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		' , each cCompile , ';'.				].		].		cCode := cCode , '			' , self cPOUName , 		'( &pxPOU->',		 self instanceName ,		 ' );				'.				self outputAssignments do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		' , each cCompile , ';'.				].		].				cCode := cCode , ''.				^ cCode.			! !!PLC_TextualFunctionBlockCall methodsFor: 'compilation' stamp: 'EricPernia 9/14/2015 05:25'!ilCompile	"Compila el elemento IL Instruccion CAL (llamado a Bloque de Funcin) a IL	Devuelve:			CAL FB_InstanceName ( 			inputAssignment , 			inOutAssignment , 			outputAssignment , 			) 		Por ejemplo:			CAL CMD_TMR ( 			IN :=  ENT1 , 			PT := T#300ms ,			ENO => ERR , 			Q => OUT , 			ET => ELAPSED , 			) 	"		| pouCall |	pouCall := '		CAL ' , self instanceName , ' ( '.			self inputAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].				self inOutAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].				self outputAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].			pouCall := pouCall , '		)'.		^ pouCall.			! !!PLC_TextualFunctionCall class methodsFor: 'instance creation' stamp: 'CarlosLombardi 11/19/2016 15:44'!newFromDeclaration: pouDeclaration andInstanceOperand: inst	"Crea un nuevo llamado IL a partir de la declaracin pouDeclaration."	| pouCall |		pouCall := self new.		pouCall declaration: pouDeclaration.	pouCall instanceOperand: inst.	pouDeclaration inputVarDecls do: [ :each | 		pouCall inputAssignments add: 			( PLC_InputAssignment				newWithFormalParameter: each				andActtualArgument: PLC_VoidOperand new				andPouCall: pouCall			).		].	pouDeclaration inOutVarDecls do: [ :each | 		pouCall inOutAssignments add: 			( PLC_InOutAssignment				newWithFormalParameter: each				andActtualArgument: PLC_VoidOperand new				andPouCall: pouCall			).		].	pouDeclaration outputVarDecls do: [ :each | 		pouCall outputAssignments add: 			( PLC_OutputAssignment				newWithFormalParameter: each				andActtualArgument: PLC_VoidOperand new				andPouCall: pouCall			).		].	pouCall returnAssignment: ( 		PLC_OutputAssignment			newWithFormalParameter: pouDeclaration return			andActtualArgument: PLC_VoidOperand new			andPouCall: pouCall		).		^ pouCall.! !!PLC_TextualFunctionCall methodsFor: 'compilation' stamp: 'EricPernia 3/25/2016 18:19'!cCompile	"Compila el elemento IL llamado a funcin a lenguaje C.	Devuelve:			inputAssignment;		inOutAssignment;		cPOUName( &instanceName ); 				ENOoutputAssignment; 				if(instName.ENO){			outputAssignment; 		}			Por ejemplo:				PLC_IL_ST( &(pxPOU->EQ_INT_VAR.EN), sizeof(pxPOU->EQ_INT_VAR.EN), NullModifier); // ST EQ_INT_VAR.EN									pxPOU->EQ_INT_VAR.IN1 = temp1;		pxPOU->EQ_INT_VAR.IN2 = 7;			PLC_F_EQ_INT( &pxPOU->EQ_INT_VAR );						FLUX = pxPOU->EQ_INT_VAR.ENO;      if(pxPOU->EQ_INT_VAR.ENO){		   pxPOU->LED2 = pxPOU->EQ_INT_VAR.OUT;      }	"		| cCode |		cCode := '			'.	"Agrego las asignaciones de inputs"	self inputAssignments do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		' , each cCompile , ';'.				].		].			"Agrego las asignaciones de InOuts"	self inOutAssignments do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		' , each cCompile , ';'.				].		].		"Llamado a funcion"	cCode := cCode , '			' , self cPOUName , 		'( &pxPOU->',		 self instanceName ,		 ' );				'.		"Compile first output ENO"	(self outputAssignments first formalParameter cCompile ~= '' )		ifTrue: [ 			cCode := cCode , '		' , self outputAssignments first cCompile , ';'.		].	"Agrego el IF que si ENO = 0 no asigne las dems salidas"	cCode := cCode , '      if('.	"nombreInst.ENO"	cCode := cCode , self outputAssignments first cCompileFormalParameter.		"cierro condicion del if y abri llave de bloque if"	cCode := cCode , '){'.	"Agrego las asignaciones de outputs despues de ENO"	(2 to: outputAssignments size) do: [ :each |		( each cCompile ~= '' )			ifTrue: [ 				cCode := cCode , '		   ' , each cCompile , ';'.				].		].		"Agrego la asignacion de Return"	( self returnAssignment cCompile ~= '' )		ifTrue: [ 			cCode := cCode , '		   ' , self returnAssignment cCompile , ';'.		].		"Cierro llave del if"	cCode := cCode , '      }'. 				^ cCode.			! !!PLC_TextualFunctionCall methodsFor: 'compilation' stamp: 'EricPernia 9/14/2015 05:34'!ilCompile	"Compila el elemento IL llamado a funcin a lenguaje C.		Devuelve:			functionName ( 			inputAssignment , 			inOutAssignment , 			outputAssignment , 			) 		Por ejemplo:			ADD_INT ( 			EN := CR , 			IN1 := 10 ,			IN2 := 2 , 			ENO => FLUX , 			) 		Nota: el RetVal se asigna al Current Result de la forma		RetVal => CR.tipoDeRetValDeLaF			"		| pouCall |	pouCall := '	' , self pouName , '( '.		self inputAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].				self inOutAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].				self outputAssignments do: [ :each |		( each ilCompile ~= '' )			ifTrue: [ 				pouCall := pouCall , '				' , each ilCompile , ','.				].		].		pouCall := pouCall , '		)'.		^ pouCall.			! !!PLC_TextualFunctionCall methodsFor: 'accessing' stamp: 'EricPernia 11/16/2013 15:46'!returnAssignment		^ returnAssignment! !!PLC_TextualFunctionCall methodsFor: 'accessing' stamp: 'EricPernia 11/16/2013 15:46'!returnAssignment: anObject		returnAssignment := anObject! !!PLC_TextualPOUCall class methodsFor: 'instance creation' stamp: 'CarlosLombardi 11/19/2016 15:44'!newFromDeclaration: pouDeclaration andInstanceOperand: inst	"Crea un nuevo llamado IL a partir de la declaracin pouDeclaration."	| pouCall |		pouCall := self new.		pouCall declaration: pouDeclaration.	pouCall instanceOperand: inst.	pouDeclaration inputVarDecls do: [ :each | 		pouCall inputAssignments add: 			( PLC_InputAssignment				newWithFormalParameter: each				andActtualArgument: PLC_VoidOperand new				andPouCall: pouCall			).		].	pouDeclaration inOutVarDecls do: [ :each | 		pouCall inOutAssignments add: 			( PLC_InOutAssignment				newWithFormalParameter: each				andActtualArgument: PLC_VoidOperand new				andPouCall: pouCall			).		].	pouDeclaration outputVarDecls do: [ :each | 		pouCall outputAssignments add: 			( PLC_OutputAssignment				newWithFormalParameter: each				andActtualArgument: PLC_VoidOperand new				andPouCall: pouCall			).		].		^ pouCall.! !!PLC_TextualPOUCall methodsFor: 'compilation' stamp: 'EricPernia 6/22/2013 03:44'!cPOUName	"Devuelve el nombre en C de la POU"		"Ejemplo: 		PLC_F_ADD_INT"		^ self declaration cPOUName.! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/11/2013 01:50'!declaration		^ declaration! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/11/2013 01:50'!declaration: anObject		declaration := anObject! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/11/2013 01:50'!inOutAssignments		^ inOutAssignments! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/11/2013 01:50'!inOutAssignments: anObject		inOutAssignments := anObject! !!PLC_TextualPOUCall methodsFor: 'initialize-release' stamp: 'EricPernia 6/11/2013 01:47'!initialize	"Inicializaciones"	self inputAssignments: OrderedCollection new.	self inOutAssignments: OrderedCollection new.	self outputAssignments: OrderedCollection new.! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/11/2013 01:50'!inputAssignments		^ inputAssignments! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/11/2013 01:50'!inputAssignments: anObject		inputAssignments := anObject! !!PLC_TextualPOUCall methodsFor: 'compilation' stamp: 'EricPernia 11/7/2013 12:50'!instanceName	"Devuelve el nombre de la Instancia de la POU"		^ self instanceOperand identifier.! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 11:44'!instanceOperand		^ instanceOperand! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 11/7/2013 11:44'!instanceOperand: anObject		instanceOperand := anObject! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/11/2013 01:50'!outputAssignments		^ outputAssignments! !!PLC_TextualPOUCall methodsFor: 'accessing' stamp: 'EricPernia 6/11/2013 01:50'!outputAssignments: anObject		outputAssignments := anObject! !!PLC_TextualPOUCall methodsFor: 'compilation' stamp: 'EricPernia 6/22/2013 03:41'!pouName	"Devuelve el identificador de la POU"		^ self declaration identifier.! !!PLC_Variable class methodsFor: 'instance creation' stamp: 'EricPernia 6/21/2013 21:25'!newWithDeclaration: varDecl andDataValue: aValue	"Crea un nuevo operando Variable Simbolica Simple"	| var |		var := self new.		var declaration: varDecl.				aValue 		ifNil: [			var	dataValue: varDecl initialValue.			] 		ifNotNil: [			var	dataValue: aValue.			]. 			^ var.	! !!PLC_Variable methodsFor: 'displaying' stamp: 'CarlosLombardi 10/14/2016 15:27'!asSimpleString	"a String representing myself"	^self declaration identifier asString! !!PLC_Variable methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 11:10'!cCompile	"Este objeto representa a la variable simbolica simple como operando."	^ self varScopePrefix , self identifier.		"	Debe haber una lgica aca que decida si pone el pxPOU o no:		^ 'pxPOU->' , self identifier."! !!PLC_Variable methodsFor: 'coercion' stamp: 'CarlosLombardi 10/14/2016 19:10'!canBeCoercedTo: aDataType	"whether it is possible for this operand to be coerced to the given type.	 Only literals can be coerced"	^false! !!PLC_Variable methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 08:18'!dataType	"Devuelve el tipo de datos de la variable.	Este lo conoce su Declaracion"	^ self declaration dataType.! !!PLC_Variable methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 07:19'!dataValue	^ dataValue! !!PLC_Variable methodsFor: 'accessing' stamp: 'EricPernia 11/6/2013 14:07'!dataValue: anObject	dataValue := anObject	"AGREGAR CHEQUEO DE LITERAL O CONSTANTE CONTRA EL TIPO DE LA VARIABLE."	"( self dataType acceptValue: anObject dataValue )		ifTrue: [			dataValue := anObject			] 		ifFalse:[			self error: 'Valor no valido para el tipo de datos' , (self dataType keyword asString).			] 	"! !!PLC_Variable methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 08:19'!declaration	"Es un objeto PLC_SimpleSymbolicVarDecl"	^ declaration! !!PLC_Variable methodsFor: 'accessing' stamp: 'EricPernia 6/2/2013 08:20'!declaration: anObject	declaration := anObject! !!PLC_Variable methodsFor: 'accessing' stamp: 'EricPernia 6/12/2013 19:22'!identifier	"Devuelve el identificador de su declaration"	^ self declaration identifier.! !!PLC_Variable methodsFor: 'compilation' stamp: 'EricPernia 6/12/2013 19:23'!ilCompile	"Este objeto representa a la variable simbolica simple como operando."		^ self identifier.! !!PLC_Variable methodsFor: 'initialize-release' stamp: 'EricPernia 6/2/2013 07:18'!initialize	"Este objeto representa a la variable simbolica simple como operando."	super initialize.! !!PLC_Variable methodsFor: 'testing' stamp: 'EricPernia 4/23/2015 04:48'!isError	"Devuelve true si es error"	^ false.! !!PLC_Variable methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:08'!isPLCLiteral	"Devuelve true si es literal"	^ false.	! !!PLC_Variable methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:11'!isStructItem	"Devuelve true si es StructItem"	^ false.! !!PLC_Variable methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:06'!isVaraible	"Devuelve true pues es variable"	^ true.! !!PLC_Variable methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:10'!isVoid	"Devuelve true si es void"	^ false.! !!PLC_Variable methodsFor: 'compilation' stamp: 'EricPernia 11/6/2013 11:11'!varScopePrefix	"Devuelve el prefijo que tiene que ver con el alcance de la variable.	Las variables que se declaran dentro de la instancia usan pxPOU->	mientras las que se declaran en el cuerpo de la funcion que 	implementa la pou van sin prefijo."	^ self declaration varScopePrefix.! !!PLC_VoidOperand class methodsFor: 'instance creation' stamp: 'CarlosLombardi 11/19/2016 17:08'!newRequired	"create and answer a new void operand for a required argument"	^self new setAsRequired ; yourself ! !!PLC_VoidOperand methodsFor: 'compilation' stamp: 'EricPernia 6/14/2013 01:59'!cCompile	"Este objeto representa al operando vacio."	^ self identifier.! !!PLC_VoidOperand methodsFor: 'compilation' stamp: 'EricPernia 11/5/2013 12:43'!dataType	"Devuelve el tipo de datos."	^ PLC_DataType Void.! !!PLC_VoidOperand methodsFor: 'compilation' stamp: 'EricPernia 6/22/2013 01:21'!dataValue		^ PLC_Literal newWithDataType: self dataType andDataValue: '???'.! !!PLC_VoidOperand methodsFor: 'compilation' stamp: 'EricPernia 6/22/2013 01:32'!identifier	"Devuelve el identificador de su declaration"	^ '<???>'.! !!PLC_VoidOperand methodsFor: 'compilation' stamp: 'EricPernia 6/14/2013 01:59'!ilCompile	"Este objeto representa al operando vacio."	^ self identifier.! !!PLC_VoidOperand methodsFor: 'initialization-release' stamp: 'CarlosLombardi 11/19/2016 17:11'!initialize	"I prepare myself for life"	super initialize .	isRequired := false .! !!PLC_VoidOperand methodsFor: 'testing' stamp: 'CarlosLombardi 11/19/2016 17:03'!isError	"Devuelve true si es error"	^ self isRequired! !!PLC_VoidOperand methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:08'!isPLCLiteral	"Devuelve true si es literal"	^ false.! !!PLC_VoidOperand methodsFor: 'accessing' stamp: 'CarlosLombardi 11/19/2016 17:02'!isRequired	"whether I am a required operand"	^isRequired! !!PLC_VoidOperand methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:11'!isStructItem	"Devuelve true si es StructItem"	^ false.! !!PLC_VoidOperand methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:06'!isVaraible	"Devuelve true pues es variable"	^ false.! !!PLC_VoidOperand methodsFor: 'testing' stamp: 'EricPernia 9/14/2013 02:10'!isVoid	"Devuelve true si es void"	^ true.! !!PLC_VoidOperand methodsFor: 'accessing' stamp: 'CarlosLombardi 11/19/2016 17:03'!setAsNotRequired	"I set myself as a not required operand"	isRequired := false! !!PLC_VoidOperand methodsFor: 'accessing' stamp: 'CarlosLombardi 11/19/2016 17:03'!setAsRequired	"I set myself as a required operand"	isRequired := true ! !!SalidaActiva class methodsFor: 'instance creation' stamp: 'EricPernia 12/5/2010 19:02'!unico	Instancia isNil ifTrue: [ Instancia:= self new].	^Instancia.! !!SalidaActiva methodsFor: 'accessing' stamp: 'EricPernia 12/8/2010 08:05'!apagarPinSiTiene.	self hacerSiTienePinSalidaMorph: [self pinSalidaMorph apagar].! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 12/8/2010 08:07'!bloque	^ self pinSalidaMorph bloqueMorph bloque! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 12/8/2010 08:05'!clickeoPinEntradaMorph: unPinDeEntradaMorph	self  hacerSiTienePinSalidaMorph: [		self conectarBloquesInternos: unPinDeEntradaMorph.		self crearConexion: unPinDeEntradaMorph. 		self pinSalidaMorph apagar	]. ! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 12/8/2010 07:52'!clickeoPinSalidaMorph: unPinDeSalidaMorph	"self  pinSalidaMorph isNil 		ifTrue: [] 		ifFalse: [			self conectarBloquesInternos: unPinDeEntradaMorph.			self crearConexion: unPinDeEntradaMorph. 			self pinSalidaMorph apagar.			]. "! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 12/8/2010 08:12'!conectarBloquesInternos: unPinDeEntradaMorph	self bloque		salida: self salida 		conectateCon: (self otroBloque: unPinDeEntradaMorph)		entrada: (self entrada: unPinDeEntradaMorph).! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 8/8/2015 07:31'!crearConexion: unPinDeEntradaMorph	| conMorph |	conMorph := ConexionMorph newConPinEntrada: unPinDeEntradaMorph yPinSalida: (self pinSalidaMorph).	self modelo morphs add: conMorph.				! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 12/8/2010 08:12'!entrada: unPinDeEntradaMorph	^unPinDeEntradaMorph bloqueMorph pinesEntrada indexOf: unPinDeEntradaMorph! !!SalidaActiva methodsFor: 'accessing' stamp: 'EricPernia 12/8/2010 08:04'!hacerSiTienePinSalidaMorph: unBloque	self  pinSalidaMorph isNil 		ifTrue: [] 		ifFalse: [unBloque value].! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 8/8/2015 07:30'!modelo	^ self pinSalidaMorph bloqueMorph modelo! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 12/8/2010 08:10'!otroBloque: unPinDeEntradaMorph			^unPinDeEntradaMorph bloqueMorph bloque! !!SalidaActiva methodsFor: 'accessing' stamp: 'EricPernia 12/5/2010 19:07'!pinSalidaMorph	^ pinSalidaMorph! !!SalidaActiva methodsFor: 'accessing' stamp: 'EricPernia 12/5/2010 19:07'!pinSalidaMorph: anObject	pinSalidaMorph := anObject! !!SalidaActiva methodsFor: 'event' stamp: 'EricPernia 12/8/2010 08:08'!salida 			^self pinSalidaMorph bloqueMorph pinesSalida indexOf: (self pinSalidaMorph).! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:52'!aboveAndToTheLeft: aMorphOrRectangle	"Se posiciona por la izquierda de aMorphOrRectangle y alinea su borde inferior al borde superior de aMorphOrRectangle.	Self is positioned as shown below:	        ---------        |  self  |        --------- -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------	     "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.		self position: rectangle topLeft - self extent.		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:52'!aboveAndToTheRight: aMorphOrRectangle	"Se posiciona por la izquierda de aMorphOrRectangle y alineado al borde inferior de aMorphOrRectangle.	Self is positioned as shown below:	    					       ---------					       |  self  |		     ------------------- --------- 		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------	  	      "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self position: rectangle topLeft + ( rectangle extent x @ self extent y negated ).		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'commands recive from view' stamp: 'EricPernia 7/3/2013 11:01'!addDependentsOnLadderView: aLadderView from: aConnectableBlock	"Agrega sus elementos graficos morphs dependientes al ladder view.	Estos pueden ser Actual Arguments o Pines."	! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 4/22/2013 00:32'!alignAbove: aMorphOrRectangle	"Se posiciona arriba de aMorphOrRectangle. Solo mueve a self verticalmente.NUEVOOOOOOOOOO	Self is positioned as shown below:			   	    ---------			    	    |  self  |		     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------				"	self bottom: ( aMorphOrRectangle bottom - aMorphOrRectangle extent y ).! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 4/22/2013 00:32'!alignBeneath: aMorphOrRectangle	"Se posiciona por debajo de aMorphOrRectangle. Solo mueve a self verticalmente.NUEVOOOOOOOOOO	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------						    	    |  self  |		   	    ---------			    "	self top: ( aMorphOrRectangle top + aMorphOrRectangle extent y ).! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 4/22/2013 00:32'!alignCenteredAbove: aMorphOrRectangle	"Se posiciona debajo y centrado de aMorphOrRectangle.NUEVOOOOOOOOOO	Self is positioned as shown below:		   	    ---------		    	    |  self  |			     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------							    "	self center: aMorphOrRectangle center.	self alignAbove: aMorphOrRectangle.! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 4/22/2013 00:33'!alignCenteredBeneath: aMorphOrRectangle	"Se posiciona debajo y centrado de aMorphOrRectangle.NUEVOOOOOOOOOO	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------						    	    |  self  |		   	    ---------			    "	self center: aMorphOrRectangle center.	self alignBeneath: aMorphOrRectangle.! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 4/22/2013 00:33'!alignToTheLeft: aMorphOrRectangle	"self se posiciona a la izquierda de aMorphOrRectangle. No se cambia la posicion vertical de self.NUEVOOOOOOOOOO	Self is positioned as shown below:					     -------------------				     |      aMorph    |		        --------- |      (fixed       |		        |  self  | |    position)    |		        --------- -------------------	    "	self right: ( aMorphOrRectangle right - aMorphOrRectangle extent x ).! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 4/22/2013 00:33'!alignToTheRight: aMorphOrRectangle	"self se posiciona a la derecha de aMorphOrRectangle. No se cambia la posicion vertical de self.NUEVOOOOOOOOOO	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       | ---------		     |    position)    | |  self  |		     -------------------	---------	     "	self left: ( aMorphOrRectangle left + aMorphOrRectangle extent x ).! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:52'!alignedAtBottomLeft: aMorphOrRectangle	"Se posiciona por la izquierda de aMorphOrRectangle y alineado al borde inferior de aMorphOrRectangle.	Self is positioned as shown below:			     -------------------		     |      aMorph    |	--------- |      (fixed       |	|  self  | |    position)    |	--------- -------------------		      "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self bottom: rectangle bottom. 	self position: (rectangle topLeft - self extent) x @ self position y.		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:52'!alignedAtBottomRight: aMorphOrRectangle	"Se posiciona a la derecha de aMorphOrRectangle y alineado al borde inferior de aMorphOrRectangle.	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       | ---------		     |    position)    | |  self  |		     -------------------	---------	     "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self position: rectangle topLeft + ( rectangle extent x @ 0 ).	self bottom: rectangle bottom.		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:52'!alignedAtLeftAbove: aMorphOrRectangle	"Se posiciona por arriba de aMorphOrRectangle y alineado a la izquierda de aMorphOrRectangle.	Self is positioned as shown below:			     ---------		     |  self  |		     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------		      "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self position: rectangle topLeft - ( 0 @ self extent y ).		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:52'!alignedAtLeftBeneath: aMorphOrRectangle	"Se posiciona por debajo de aMorphOrRectangle y alineado a la izquierda de aMorphOrRectangle.	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------						     |  self  |		     ---------			      "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self position: rectangle topLeft + ( 0 @ rectangle extent y ).		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/22/2012 17:01'!alignedAtRight: aMorphOrRectangle	"Se posiciona a la derecha de aMorphOrRectangle. No se cambia la posicion vertical de self.	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       | ---------		     |    position)    | |  self  |		     -------------------	---------	     "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self position: ( rectangle origin x + rectangle extent x @ self position y ).		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:53'!alignedAtRightAbove: aMorphOrRectangle	"Se posiciona por arriba de aMorphOrRectangle y alineado a la derecha de aMorphOrRectangle.	Self is positioned as shown below:			   		  ---------		    		  |  self  |		     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------			      "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self position: rectangle topLeft + ( rectangle extent x @ 0 ) - self extent.		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:53'!alignedAtRigthBeneath: aMorphOrRectangle	"Se posiciona por debajo de aMorphOrRectangle y alineado a la derecha de aMorphOrRectangle.	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------						    		  |  self  |			   		  ---------		      "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.		self position: rectangle topLeft + rectangle extent -  ( self extent x @ 0 ).		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:53'!alignedAtTopLeft: aMorphOrRectangle	"Se posiciona por la izquierda de aMorphOrRectangle y alineado al borde superior de aMorphOrRectangle.	Self is positioned as shown below:		--------- -------------------	|  self  | |      aMorph    |	--------- |      (fixed       |		     |    position)    |		     -------------------		      "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.		self position: rectangle topLeft - ( self extent x @ 0 ).		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:53'!alignedAtTopRight: aMorphOrRectangle	"Se posiciona a la derecha de aMorphOrRectangle y alineado al borde superior de aMorphOrRectangle.	Self is positioned as shown below:			     ------------------- ---------		     |      aMorph    | |  self  |		     |      (fixed       | ---------		     |    position)    |		     -------------------	      "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.		self position: rectangle topLeft + ( rectangle extent x @ 0 ).		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 4/22/2013 15:56'!backgroundRectangle	"Devuelve el rectngulo que se sombrea al pasar el mouse por el elemento."		| rectangle |		rectangle := Rectangle 		origin: self backgroundRectanglePosition 		corner: self backgroundRectanglePosition + self backgroundRectangleExtent.			^ rectangle translateBy: self position.! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 15:38'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self defaultExtent.! !!PLC_GraphicElementMorph methodsFor: 'position' stamp: 'EricPernia 4/25/2013 01:27'!backgroundRectanglePosition	"Devuelve la posicin en pantalla del backgroundRectangle relativa a position del elemento [px]."		^ self properties scale * ( 0 @ 2 ).! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/22/2012 16:35'!beneath: aMorphOrRectangle	"Se posiciona por debajo de aMorphOrRectangle. Solo mueve a self verticalmente.	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------						    	    |  self  |		   	    ---------			    "		| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self bottom: rectangle bottom + self extent y.		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:53'!beneathAndToTheLeft: aMorphOrRectangle	"Se posiciona por la izquierda de aMorphOrRectangle y alinea su borde superior al borde inferior de aMorphOrRectangle.	Self is positioned as shown below:			     -------------------					     |      aMorph    |		     |      (fixed       |		     |    position)    |        --------- -------------------        |  self  |        ---------		    "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.		self position: rectangle topLeft+ ( 0 @ rectangle extent y ) - ( self extent x @ 0 ).		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:53'!beneathAndToTheRight: aMorphOrRectangle	"Se posiciona a la derecha de aMorphOrRectangle y alinea su borde superior al borde inferior de aMorphOrRectangle.	Self is positioned as shown below:			     -------------------					     |      aMorph    |		     |      (fixed       |		     |    position)    |			     ------------------- ---------	    					       |  self  |				  					       ---------			    "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self position: rectangle topLeft + rectangle extent.		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 01:12'!blockConnectedToInput: anInputNumber	"Devuelve el bloque conectado a la entrada anInputNumber."	^ self owner blockConnectedToInput: anInputNumber for: self.! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 01:12'!blockConnectedToOutput: anOutputNumber	"Devuelve el bloque conectado a la salida anInputNumber."	^ self owner blockConnectedToOutput: anOutputNumber for: self.! !!PLC_GraphicElementMorph methodsFor: 'align strates' stamp: 'EricPernia 7/9/2013 18:09'!centerAlign	"Estado s de alineacin. Los implementan los Tag Morph"! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:53'!centeredAbove: aMorphOrRectangle	"Se posiciona por arriba de aMorphOrRectangle y alinea centrado horizontalmente con aMorphOrRectangle.	Self is positioned as shown below:			   	    ---------		    	    |  self  |		     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------			    "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self center: rectangle center.	self top: rectangle top - self extent y.		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 6/22/2013 04:08'!centeredBeneath: aMorph	"Se posiciona por debajo de aMorphy alinea centrado horizontalmente con aMorph.	Self is positioned as shown below:			     -------------------		     |      aMorph    |		     |      (fixed       |		     |    position)    |		     -------------------						    	    |  self  |		   	    ---------			    "	self center: aMorph center.	self bottom: aMorph bottom + self extent y.! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 10/6/2012 18:53'!centeredToTheLeft: aMorphOrRectangle	"Se posiciona por la izquierda de aMorphOrRectangle y alinea centrado verticalmente con aMorphOrRectangle.	Self is positioned as shown below:			     -------------------	--------- |      aMorph    |	|  self  | |      (fixed       |	--------- |    position)    |					     ------------------- 					    "	| rectangle |		rectangle := self morphOrRectangleToRectangle: aMorphOrRectangle.	self center: rectangle center.	self position: ( rectangle topLeft - self extent ) x @ self position y.		self positionYourLayoutAreaInYourself! !!PLC_GraphicElementMorph methodsFor: 'alignment' stamp: 'EricPernia 4/30/2013 01:51'!centeredToTheRight: aMorph	"Se posiciona a la derecha de aMorph y alinea centrado verticalmente con aMorph.	Self is positioned as shown below:			     -------------------		     |      aMorph    | ---------		     |      (fixed       | |  self  |		     |    position)    | ---------		     ------------------- 						    "	| rectangle |		rectangle := aMorph bounds.	self center: rectangle center.	self position: ( rectangle topLeft + rectangle extent ) x @ self position y.! !!PLC_GraphicElementMorph methodsFor: 'other events' stamp: 'EricPernia 9/6/2012 00:49'!changeFunction	"Estado changeFunction."	"self drawingLayer1: PLC_GraphicElementState unselected.	self changed."! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 11/18/2013 15:23'!changeFunction: anEvent	"Estado changeFunction."! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/17/2013 01:52'!connectableBlock	"Devuelve el bloque conectable del Elemento Grafico Morph pidiendoselo a su ladder view."		^ self owner modelElementForGraphicElement: self.! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 01:13'!connectedAtInput: aNumber	"Devuelve la conexion o bloque conectado a la entrada aNumber del elemento"	^ self owner connectedAtInput: aNumber for: self.! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 01:13'!connectedAtOutput: aNumber	"Devuelve la conexion o bloque conectado a la salida aNumber del elemento"	^ self owner connectedAtOutput: aNumber for: self.! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 4/27/2013 04:20'!connectedToBlock 	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Bloque.	Lo implementa PLC_RightPowerRailMorph "	! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 4/27/2013 04:20'!connectedToCoil 	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Bobina.	Lo implementa PLC_RightPowerRailMorph "! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 4/27/2013 04:20'!connectedToContact	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Contacto.	Lo implementa PLC_RightPowerRailMorph "! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 4/27/2013 04:20'!connectedToLeftPowerRail	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Barra Izquierda.	Lo implementa PLC_RightPowerRailMorph "! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 2' stamp: 'EricPernia 7/6/2013 16:11'!connectedToLeftPowerRailTroughFirstOutputPin 	"Define algoritmo de layout que cambia si 	esta conectado a primer rama o bobina.	En el caso de la Barra Izquierda cambia el dibujo si es pirmer pin u otro."	self connectionStateLayer2: PLC_GraphicElementState connectedToLeftPowerRailTroughFirstOutputPin.	self changed.! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 4/27/2013 06:19'!connectedToRightPowerRail	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Barra Derecha"! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2013 03:05'!connectionStateLayer1	^ connectionStateLayer1! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2013 03:05'!connectionStateLayer1: anObject	connectionStateLayer1 := anObject! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2013 03:05'!connectionStateLayer2	^ connectionStateLayer2! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2013 03:05'!connectionStateLayer2: anObject	connectionStateLayer2 := anObject! !!PLC_GraphicElementMorph methodsFor: 'event handling' stamp: 'EricPernia 5/22/2012 19:32'!containsPoint: aPoint	"Para setear el area sensitiva del mouse dentro de la caja delimitadora del Morph"	^ (self backgroundRectangle containsPoint: aPoint).! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 01:08'!defaultExtent	"Tamao por defecto del elemento."		^ self gridExtent.! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 7/13/2013 03:54'!dependentsUnderLayoutRectangle	"Devuelve una Ordered Collection con los elementos dependientes 	de este elemento que se encuentren bajo su layoutRectangle. 	Esto se utiliza para poder borrar elementos bajo el layout Rectangle 	del grupo cuando hago el layout Vertical."	| collection |		collection := OrderedCollection new.	self elementDependents do: [ :each | 		( each layoutRectangle intersects: self layoutRectangle )			ifTrue: [ collection add: each.]		].			^collection.! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 10/18/2012 15:10'!diagonalLine1Rectangle	"Linea diagonal que forma parte de la flecha del Riel Derecho cuando esta conectado a Contacto."	| width height diagonalLine |	width := self properties scale x * 4.	height := self properties scale y * 4.		diagonalLine := Rectangle origin: (0@0) corner: ( width @ height ).		^ diagonalLine align: diagonalLine topRight with: self bounds topRight + (self properties scale * (-2 @ 4)).! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 10/18/2012 15:10'!diagonalLine2Rectangle	"Linea diagonal que forma parte de la flecha del Riel Derecho cuando esta conectado a Contacto."	| width height diagonalLine |	width := self properties scale x * 4.	height := self properties scale y * 4.		diagonalLine := Rectangle origin: (0@0) corner: ( width @ height ).		^ diagonalLine align: diagonalLine topRight with: self bounds topRight + (self properties scale * (-8 @ 4)).! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 10/18/2012 15:10'!diagonalLine3Rectangle	"Linea diagonal que forma parte de la flecha del Riel Derecho cuando esta conectado a Contacto."	| width height diagonalLine |	width := self properties scale x * 4.	height := self properties scale y * 4.		diagonalLine := Rectangle origin: (0@0) corner: ( width @ height ).		^ diagonalLine align: diagonalLine bottomRight with: self bounds bottomRight - (self properties scale * (2 @ 4)).! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 10/18/2012 15:10'!diagonalLine4Rectangle	"Linea diagonal que forma parte de la flecha del Riel Derecho cuando esta conectado a Contacto."	| width height diagonalLine |	width := self properties scale x * 4.	height := self properties scale y * 4.		diagonalLine := Rectangle origin: (0@0) corner: ( width @ height ).		^ diagonalLine align: diagonalLine bottomRight with: self bounds bottomRight - (self properties scale * (8 @ 4)).! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 02:08'!doubleWidth	"Cambia el ancho del elemento al doble"	self extent: ( self elementDoubleWidth @ self extent y ).	self extentChanged.	self submorphs do: [ :each |		each doubleWidth.		].! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 4/27/2013 01:50'!draggingAnother	"Estado cuando estaba seleccionado y arrastran otro elemento desde fuera de la network."	self userInteractionStateLayer1: PLC_GraphicElementState draggingAnother.	self changed.		self submorphsPerform: #draggingAnother.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 4/27/2013 01:50'!draggingSelf	"Estado cuando el elemento esta siendo arrastrado por el mouse."	self userInteractionStateLayer1: PLC_GraphicElementState draggingSelf.	self changed.		self submorphsPerform: #draggingSelf.! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 02:05'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		aCanvas 		fillRectangle: self backgroundRectangle 		color: self userInteractionStateLayer1 backgroundColor.! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 4/22/2013 00:50'!drawBoundsOn: aCanvas	"Dibujo el borde del margen del elemento. Tamao total"		aCanvas		frameRectangle: self bounds		width: 1		colors: {Color blue. Color white alpha: 0}		dashes: {2. 1}..! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 02:09'!drawDoubleArrowOn: aCanvas.	"Dibuja la flecha doble del Riel Derecho conectado a contacto."	aCanvas line: self diagonalLine1Rectangle origin		to: self diagonalLine1Rectangle corner		width: self properties scale x * 2		color: self userInteractionStateLayer1 elementColor.	"Parche blanco sobre la linea diagonal"	aCanvas line: self diagonalLine1Rectangle origin - (1@0)		to: self diagonalLine1Rectangle origin - (1@1)		width: self properties scale x * 1		color: Color white.	aCanvas line: self diagonalLine2Rectangle origin		to: self diagonalLine2Rectangle corner		width: self properties scale x * 2		color: self userInteractionStateLayer1 elementColor.	"Parche blanco sobre la linea diagonal"	aCanvas line: self diagonalLine2Rectangle origin - (1@0)		to: self diagonalLine2Rectangle origin - (1@1)		width: self properties scale x * 1		color: Color white.	aCanvas line: self diagonalLine3Rectangle bottomLeft		to: self diagonalLine3Rectangle topRight		width: self properties scale x * 2		color: self userInteractionStateLayer1 elementColor.	"Parche blanco sobre la linea diagonal"	aCanvas line: self diagonalLine3Rectangle bottomLeft - (1@0 negated)		to: self diagonalLine3Rectangle bottomLeft - (1@1)		width: self properties scale x * 1		color: Color white.	aCanvas line: self diagonalLine4Rectangle bottomLeft		to: self diagonalLine4Rectangle topRight		width: self properties scale x * 2		color: self userInteractionStateLayer1 elementColor.	"Parche blanco sobre la linea diagonal"	aCanvas line: self diagonalLine4Rectangle bottomLeft - (1@0 negated)		to: self diagonalLine4Rectangle bottomLeft - (1@1)		width: self properties scale x * 1		color: Color white.! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 4/22/2013 16:21'!drawElementOn: aCanvas	"Dibujo el elemento grafico"		aCanvas 		fillRectangle: self defaultExtent 		color: Color red.! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 4/22/2013 01:04'!drawLayoutRectangleOn: aCanvas	"Dibujo el borde del LayoutRectangle del elemento."		aCanvas		frameRectangle: self layoutRectangle		width: 1		color: Color green.! !!PLC_GraphicElementMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:33'!drawOn: aCanvas	"Dibujo el elemento grafico"		self userInteractionStateLayer1 drawOn: aCanvas for: self.	self userInteractionStateLayer2 drawOn: aCanvas for: self.	self userInteractionStateLayer3 drawOn: aCanvas for: self.		self properties drawBounds ifTrue: [		self drawBoundsOn: aCanvas		].		self properties drawLayoutRectangle ifTrue: [		self drawLayoutRectangleOn: aCanvas		].! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/4/2013 02:16'!element	"Devuelve el elemento del bloque conectable del Elemento Grafico Morph pidiendoselo a su ladder view."		^ self connectableBlock element.! !!PLC_GraphicElementMorph methodsFor: 'dependents' stamp: 'EricPernia 7/13/2013 04:08'!elementDependents	"Devuelve una OrderedCollection con sus elementos graficos morphs 	dependientes que agreg al LadderView. En los que no tienen este 	metodo reescrito es porque no poseen dependientes entonces 	devuelve una coleccion vacia."	^ OrderedCollection new.! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:52'!elementDoubleWidth	"Doble ancho del elemento"	^ self defaultExtent x.! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:52'!elementWidth	"Ancho estandar del elemento"	^ self defaultExtent x.! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 01:08'!extentChanged	"Cambia el tamao del elemento"		self extent: self totalExtent.! !!PLC_GraphicElementMorph methodsFor: 'pins' stamp: 'EricPernia 7/14/2013 20:39'!firstPinYDistance	"Devuelve la distancia  en pantalla en Y del primer pin de entrada 	y salida relativa a la posicion vertical de self .	Es la distancia vertical entre la parte de arriba del elemento y el primer pin."		^ 0.! !!PLC_GraphicElementMorph methodsFor: 'grid' stamp: 'EricPernia 4/22/2013 01:08'!gridExtent	"Devuelve el tamao en pixeles de una celda de la grilla gris."		^ self properties gridExtent.! !!PLC_GraphicElementMorph methodsFor: 'grid' stamp: 'EricPernia 4/22/2013 01:09'!gridOrigin	"Devuelve la posicion 0@0 de la grilla"	^ self owner gridOrigin.! !!PLC_GraphicElementMorph methodsFor: 'event handling' stamp: 'EricPernia 4/22/2013 02:54'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^true.	"^false. "! !!PLC_GraphicElementMorph methodsFor: 'initialize-release' stamp: 'EricPernia 7/14/2013 05:21'!initialize	"Inicializo el elemento grafico"		"Siempre debe hacer esto al inicializarse un Morph"	super initialize.								"Inicializo el morph a su tamao por defecto"	self extent: self defaultExtent.		"Inicializo sus estados de Interfaz de Usuario"	PLC_GraphicElementState initialize.	self unselected;		mouseOut;		notKeyboardFocus;		notConnectedToLeftPowerRailTroughFirstOutputPin;		voidCSL1.		"Indican si el elemento esta terminado deposicionarse en X e Y. Inicializan en false"	self xPositioned: false;		yPositioned: false.								"Muestro en pantalla"	self openInWorld.! !!PLC_GraphicElementMorph methodsFor: 'ladderView' stamp: 'EricPernia 6/30/2013 04:06'!instanceVariable	"Devuelve la variable de instancia si el elemento contiene. 	Esto sucede en Contacto, Bobina o FB, en los otros devuelve nil"	^ nil.! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/14/2013 20:52'!isActualArgument	"Devuelve true si es un RightPowerRail Morph"	^ false.! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 6/30/2013 04:08'!isCoil	"Devuelve true si el elemento grafico es una bobina."	^ false! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 6/30/2013 04:07'!isContact	"Devuelve true si el elemento grafico es un Contacto."	^ false! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 01:13'!isLeftPowerRail	"Devuelve true si el elemento grafico es una Barra derecha."	^ false! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 6/30/2013 04:10'!isPLCBlock	"Devuelve true si el elemento grafico es un Bloque."	^ false! !!PLC_GraphicElementMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/14/2013 20:51'!isRightPowerRail	"Devuelve true si es un RightPowerRail Morph"	^ false.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 4/27/2013 01:48'!keyboardFocus	"Estado con el foco del teclado en el elemento."	self userInteractionStateLayer3: self userInteractionStateLayer1 keyboardFocus.	self changed.! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 3/12/2016 23:33'!layoutFirstPinsYDistance	"Devuelve la distancia minima en pantalla en Y del primer pin de entrada 	y salida relativa a layoutRectangle top de self .	Es la distancia vertical entre la parte de arriba del elemento y sus sub elementos y el primer pin."			^ self layoutRectangleRelativePosition y + self firstPinYDistance.! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 3/12/2016 23:33'!layoutGroupVerticallyOn: aLadderView from: aGraphicElement output: anOutputNumber	"Alineo Verticalmnete su grupo de primer pin."	| previousOutputElement group groupPrev |		"Si ya se encontraba posicionado en Y no lo posiciono."	( self yPositioned )		ifFalse: [			"Obtengo el grupo del elemento"			group := aLadderView groupFor: self.							"Chequea si esta conectado a la primer salida del elemento anterior. 			En base a esto se acomoda de una manera u otra."			( anOutputNumber = 1 )				ifTrue: [					"Posiciono su group a partir del topRight del layoutRectangle del elemento 					conectado a su entrada"							group layoutVerticallyTop: aGraphicElement layoutRectangle top.					] 				ifFalse: [										"ACA DEBE CHEQUEAR QUE ADEMAS YA LO HAYA ACOMODADO EN X					AL ELEMENTO DEL PIN ANTERIOR PARA QUE NO SE ARME BARDO CON					LOS BLOQUES, VER 2 PRIMA EN LAS HOJAS "										"Obtengo el elemento conectado a la salida anterior de la que esta 					conectado self en el elemento  inputGraphicElement."					previousOutputElement := aGraphicElement blockConnectedToOutput: anOutputNumber - 1.					"Obtengo el grupo azul en el que se encuentra el previousOutputElement"					groupPrev := aLadderView groupFor: previousOutputElement.								"Posiciono su firstPinGroup Verticalmente a partir del bottom del layoutRectangle de groupPrev."					group layoutVerticallyTop: groupPrev layoutRectangle bottom.					].			"Chequeo si su grupo pisa otro elemento previamente posicionado. Si pisa lo muevo otra vez. 			As en un loop hasta que no pise a nadie verticalmente."			[ aLadderView gotAnElementVerticallyUnderGroup: group ] 				whileTrue: [										group layoutVerticallyTop: 						( aLadderView maxBottomElementUnderGroup: group ) layoutRectangle bottom.					].						"Seteo a true el flag de que se encuentra posicionado en Y en cada elemento de grupo serie."			group yPositioned: true						].! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 4/27/2013 01:08'!layoutHorizontallyLeft: aDistanceX	"Este metodo usa el metodo layoutLeft: y le pasa aDistanceX y otro valor	segun ciertas consideraciones de conexiones y demas."	"Mensaje para compatibilidad con grupos. Para que funcione el composite Gupos - Elementos."		"Alineo el elemento a aDistanceX"	self layoutLeft: aDistanceX.! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 04:44'!layoutHorizontallyOn: aLadderView from: aGraphicElement output: anOutputNumber	"Alineo Horizontalmente su grupo serie."		| group |		"Si ya se encontraba posicionado en X no lo posiciono."	( self xPositioned )		ifFalse: [					"Posiciono el elemento grafico Horizontalmente a la derecha del 			layoutRectangle del elemento conectado a su entrada"			"self layoutHorizontallyLeft: aGraphicElement layoutRectangle right."						"Obtengo el grupo del elemento"			group := aLadderView groupFor: self.						"Posiciono su grupo Horizontalmente a la derecha del layoutRectangle 			del elemento conectado a su entrada"			group layoutHorizontallyLeft: aGraphicElement layoutRectangle right.									"Seteo a true el flag de que se encuentra posicionado en X el grupo."			group xPositioned: true.			].! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 4/22/2013 01:11'!layoutLeft: aNumber	"self posiciona horizontalmente su layoutRectangle en aNumber."		self layoutPosition: ( aNumber @ (self position y - self layoutRectangleRelativePosition y ) ).! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 7/9/2013 17:01'!layoutOutputsOn: aLadderView from: aGraphicElement output: anOutputNumber	"Alineo el elemento conectado a la salida de su grupo serie."		| nextGraphicElement |		"Obtengo el elemento conectado a su nica salida"	nextGraphicElement := self blockConnectedToOutput: 1.				"Posiciona en pantalla el elemento obtenido."	nextGraphicElement layoutOn: aLadderView from: self output: 1.! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 4/22/2013 01:12'!layoutPosition: aPoint	"self posiciona su layoutRectangle en el punto aPoint."		self position: aPoint + self layoutRectangleRelativePosition.! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 19:54'!layoutRectangle	"Devuelve el rectngulo para acomodar en pantalla los elementos entre si."	| rectangle |		rectangle := Rectangle 		origin: self layoutRectanglePosition 		corner: self layoutRectanglePosition + self layoutRectangleExtent.			^ rectangle translateBy: self position.! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 7/6/2013 01:53'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self connectionStateLayer1 layoutRectangleExtentFor: self.! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 19:55'!layoutRectangleForGroup	"Devuelve el rectngulo para acomodar en pantalla los elementos 	entre si que usan los grupos azules."	^ self layoutRectangle.! !!PLC_GraphicElementMorph methodsFor: 'position' stamp: 'EricPernia 7/7/2013 20:59'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self connectionStateLayer1 layoutRectanglePositionFor: self.! !!PLC_GraphicElementMorph methodsFor: 'position' stamp: 'EricPernia 4/22/2013 01:12'!layoutRectangleRelativePosition	"Posicion relativa entre el layoutRectangle y el position del elemento"	^ self topLeft - self layoutRectangle topLeft.! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 3/12/2016 23:22'!layoutTop: aDistanceY	"self posiciona verticalmente su layoutRectangle en aNumber."		self layoutPosition: ( (self position x - self layoutRectangleRelativePosition x ) @ aDistanceY ).! !!PLC_GraphicElementMorph methodsFor: 'layout' stamp: 'EricPernia 4/26/2013 15:46'!layoutVerticallyTop: aDistanceY	"self se posiciona a partir de la distancia vertical aDistanceY. 	Self solo se mueve verticalmente, anElement queda fijo."		self layoutTop: aDistanceY! !!PLC_GraphicElementMorph methodsFor: 'align strates' stamp: 'EricPernia 7/9/2013 18:09'!leftAlign	"Estado s de alineacin. Los implementan los Tag Morph"! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 17:22'!leftAndRightConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 17:22'!leftConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"! !!PLC_GraphicElementMorph methodsFor: 'other events' stamp: 'EricPernia 9/9/2012 21:02'!lostKeyboardFocus	"Evento que ejecuta el Morph cuando pierde el foco del teclado"! !!PLC_GraphicElementMorph methodsFor: 'event handling' stamp: 'EricPernia 4/12/2012 16:38'!mouseEnter: anEvent	"Manejador del evento mouse enter. Este mensaje se le envia al 	morph cuando el puntero del mouse empieza a pasar por el."	self mouseOver.	! !!PLC_GraphicElementMorph methodsFor: 'event handling' stamp: 'EricPernia 4/12/2012 16:38'!mouseLeave: anEvent	"Manejador del evento mouse leave. Este mensaje se le envia al 	morph cuando el puntero del mouse deja de pasarpor el."	self mouseOut.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 5/1/2013 15:03'!mouseOut	"Estado cuando el puntero del mouse esta fuera del elemento."	self userInteractionStateLayer2: PLC_GraphicElementState voidState.	self changed.		self submorphsPerform: #mouseOut.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 6/23/2013 06:08'!mouseOver	"Estado cuando el puntero del mouse esta sobre elemento."	self userInteractionStateLayer2: self userInteractionStateLayer1 mouseOver.	self changed.		"self submorphsPerform: #mouseOver."! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 2' stamp: 'EricPernia 7/6/2013 16:11'!notConnectedToLeftPowerRailTroughFirstOutputPin	"Define algoritmo de layout que cambia si 	esta conectado a primer rama o bobina.	En el caso de la Barra Izquierda cambia el dibujo si es pirmer pin u otro."	self connectionStateLayer2: PLC_GraphicElementState notConnectedToLeftPowerRailTroughFirstOutputPin.	self changed.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 5/15/2012 17:16'!notDragging	"Estado cuando el mouse no trae nada arrastrando."	self changed.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 4/27/2013 01:50'!notKeyboardFocus	"Estado sin el foco del teclado en el elemento."	self userInteractionStateLayer3: PLC_GraphicElementState voidState.	self changed.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 5/14/2012 18:09'!notOverDroppArea 	"Estado desseleccionado.""	self state1: PLC_GraphicElementState unselected.	self changed."! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 5/14/2012 18:10'!notUnderDraggArea 	"Estado desseleccionado.""	self state1: PLC_GraphicElementState unselected.	self changed."! !!PLC_GraphicElementMorph methodsFor: 'commands recive from view' stamp: 'EricPernia 5/1/2013 23:32'!openBranchOnConnectionFrom: aLadderView	"Si el elemento grafico es un Horizontal Link abre una rama en la conexion. Si no, no hace nada"! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 5/15/2012 17:16'!overDropArea	"Estado cuando el mouse trae arrastrando un elemento y entra en el area	ddonde un elemento permite el drop del elemento que trae arrastrando 	el mouse."	self changed.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 5/14/2012 18:10'!overDroppArea 	"Estado desseleccionado.""	self state1: PLC_GraphicElementState unselected.	self changed."! !!PLC_GraphicElementMorph methodsFor: 'properties' stamp: 'EricPernia 6/18/2012 12:58'!properties	"Devuelve la unica instancia de la clase PLC_GraphicElementProperties"	^ PLC_GraphicElementProperties uniqueInstance.! !!PLC_GraphicElementMorph methodsFor: 'commands recive from view' stamp: 'EricPernia 5/1/2013 23:32'!removeElementFrom: aLadderView	"Remueve el elemento pidiendoselo a su ladder view. Hace un double dispatching con este"! !!PLC_GraphicElementMorph methodsFor: 'commands recive from view' stamp: 'EricPernia 5/1/2013 23:57'!removeRightPowerRailFrom: aLadderView	"Si es un RPR le envia el mensaje de nuevo al ladder View"		aLadderView removeRightPowerRail: self! !!PLC_GraphicElementMorph methodsFor: 'align strates' stamp: 'EricPernia 7/9/2013 18:09'!rightAlign	"Estado s de alineacin. Los implementan los Tag Morph"! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 17:21'!rightConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 6/23/2013 23:36'!selected	"Estado seleccionado."	self userInteractionStateLayer1: PLC_GraphicElementState selected.	self changed.		self submorphsPerform: #selected.! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 02:07'!standardWidth	"Cambia el ancho del elemento a ancho estandar."	self extent: ( self elementWidth @ self extent y ).	self extentChanged.	self submorphs do: [ :each |		each standardWidth.		].! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 6/24/2012 21:10'!submorphsPerform: aSelector	"Actualiza el estado de los submorphs."		self submorphs do: [ :subMorph |		subMorph perform: aSelector.		]! !!PLC_GraphicElementMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 15:38'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self defaultExtent.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 7/14/2012 19:22'!underDragArea	"Estado cuando el mouse trae arrastrando un elemento. Estro genera un area 	grande alreddedor del mouse moviendose y los elementos bajo dicha area	reciben este estado si aceptan el objeto que el mouse trae arrastrando."	self changed.! !!PLC_GraphicElementMorph methodsFor: 'user interaction states' stamp: 'EricPernia 4/27/2013 01:49'!unselected	"Estado desseleccionado."	self userInteractionStateLayer1: PLC_GraphicElementState unselected.	self changed.		self submorphsPerform: #unselected.! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/25/2013 15:44'!userInteractionStateLayer1	^ userInteractionStateLayer1! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/25/2013 15:44'!userInteractionStateLayer1: anObject	userInteractionStateLayer1 := anObject! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/25/2013 15:44'!userInteractionStateLayer2	^ userInteractionStateLayer2! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/25/2013 15:44'!userInteractionStateLayer2: anObject	userInteractionStateLayer2 := anObject! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/25/2013 15:44'!userInteractionStateLayer3	^ userInteractionStateLayer3! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/25/2013 15:44'!userInteractionStateLayer3: anObject	userInteractionStateLayer3 := anObject! !!PLC_GraphicElementMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 05:27'!voidCSL1	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Void que es el estado de capa 1 por defecto"	self connectionStateLayer1: PLC_GraphicElementState voidCSL1.	self changed.! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/21/2013 11:45'!xPositioned	^ xPositioned! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/21/2013 11:45'!xPositioned: anObject	xPositioned := anObject! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/21/2013 11:45'!yPositioned	^ yPositioned! !!PLC_GraphicElementMorph methodsFor: 'accessing' stamp: 'EricPernia 4/21/2013 11:45'!yPositioned: anObject	yPositioned := anObject! !!PLC_BlockMorph class methodsFor: 'instance creation' stamp: 'EricPernia 7/14/2013 05:20'!newFromConnectableBlock: aConnectableBlock	"Nueva isntancia a partir de un elemento de un bloque conectable"	| blockMorph  |	"Creo el elemento grafico"		blockMorph := self new.	blockMorph modelElement: aConnectableBlock element.	blockMorph position: 40@40.	blockMorph build.		"Lo posiciono fuera del ladderView para que no moleste cuando	hago layout"	blockMorph position: blockMorph position - blockMorph layoutRectangle extent.		"Busco la variable del modelo y le pido su grafico"	"graphicVar := ( blockMorph instanceVariableFor: aConnectableBlock ).		graphicVar 		ifNotNil: [ 						graphicVar := graphicVar graphicElement."	"ARREGLAR, TA FEO QUE SE LLAMEN GRAFIC VAR las 2"							"Asigno al elemento grafico su variable morph"			"bloqueMorph instanceVariable: graphicVar."			"Asigno a la variable morph el elemento grafico"			"graphicVar graphicElement: bloqueMorph."						"Alineo la variable grafica al elemento grafico centrada sobre este"			"graphicVar alignAbove: bloqueMorph."			"graphicVar alignCenteredAbove: graphicElem."		"]."		^ blockMorph.! !!PLC_BlockMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 7/11/2013 01:55'!addDependentsOnLadderView: aLadderView from: aConnectableBlock	"Agrega sus elementos graficos morphs dependientes al ladder view.	Estos pueden ser Actual Arguments o Pines. aConnectableBlock es el 	bloque conectable asociado a este morph."	"Aado el Actual Argument Morph de variable de instancia si su elemento es llamado a Function Block"	"self addInstanceOnLadderView: aLadderView from: aConnectableBlock."		"Aado los pines de Entrada."	self addInputPinsOnLadderView: aLadderView from: aConnectableBlock.		"Aado los Actual Argument Morph conectados a sus Entrada."	self addInputActualArgumentsOnLadderView: aLadderView from: aConnectableBlock.		"Aado los pines de Salida."	self addOutputPinsOnLadderView: aLadderView from: aConnectableBlock.! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 7/4/2013 02:54'!addFirstInputPin	"Aade el primer pin de entrada al elemento. Este es submorph."	| pinMorph |	pinMorph := PLC_PinBlockMorph new.		"Posiciono el pin"	pinMorph topLeft: 		self topLeft + ( pinMorph extent x negated @ self firstPinYDistance ).		"Lo agrego de submorph"		self addMorph: pinMorph.	"Lo agrego a su lista de pines de entrada"	self inputPins add: pinMorph.		^ pinMorph.! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 7/4/2013 02:55'!addFirstOutputPin	"Aade el primer pin de salida al elemento. Este es submorph."	| pinMorph |	pinMorph := PLC_PinBlockMorph new.		"Posiciono el pin"	pinMorph topRight: 	self topRight + ( pinMorph extent x @ self firstPinYDistance ).		"Lo agrego de submorph"		self addMorph: pinMorph.	"Lo agrego a su lista de pines de salida"	self outputPins add: pinMorph.		^ pinMorph.! !!PLC_BlockMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 7/11/2013 02:08'!addInputActualArgumentsOnLadderView: aLadderView from: aConnectableBlock	"Agrega sus Actual Arguments de entrada al ladder view. aConnectableBlock es el 	bloque conectable asociado a este morph."	| actualArgumentConnectableBlock actualArgumentGraphicElementMorph |	"Aados sus Actual Arguments de Entrada. Es a partir del 2 pues a la primer 	entrada siempre tiene otro elemento"		( 2 to: self inputPins size ) do: [ :index |				"Busco el bloque conectable del Actual Argument de entrada"		actualArgumentConnectableBlock := aConnectableBlock blockConnectedToInput: index.				"Creo el elemento grafico."		actualArgumentGraphicElementMorph := actualArgumentConnectableBlock graphicElement.			"Lo agrego de submorph"		aLadderView addMorph: actualArgumentGraphicElementMorph.			"Lo agrego al diccionario elementos"		aLadderView elements at: actualArgumentGraphicElementMorph put: actualArgumentConnectableBlock.					"Lo agrego a la lista de seleccionados y le doy el foco del teclado"		aLadderView selectedAndKeyboardFocus: actualArgumentGraphicElementMorph.		].	! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 7/10/2013 00:02'!addInputPin	"Aade un pin de entrada al elemento."	| pinMorph |	pinMorph := PLC_PinBlockMorph new.	self inputPins add: pinMorph.		^ pinMorph.! !!PLC_BlockMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 7/11/2013 01:57'!addInputPinsOnLadderView: aLadderView from: aConnectableBlock	"Agrega sus pines de entrada dependientes al ladder view. 	aConnectableBlock es el bloque conectable asociado a este morph."	| dependenGraficElementMorph dependentConnectableBlockPin |		"Aado los pines de Entrada."		( 1 to: self inputPins size ) do: [ :index |				"Busco el morph dependiente"		dependenGraficElementMorph := self inputPins at: index.								"Obtengo el pin correspondiente del bloque conectable de dependenGraficElementMorph."		dependentConnectableBlockPin := aConnectableBlock inputs at: index.			"Agrego el dependenGraficElementMorph de submorph al ladderView"		aLadderView addMorph: dependenGraficElementMorph.			"Agrego el dependenGraficElementMorph al diccionario elements"		aLadderView elements at: dependenGraficElementMorph put: dependentConnectableBlockPin.			"Lo agrego a la lista de seleccionados y le doy el foco del teclado"		aLadderView selectedAndKeyboardFocus: dependenGraficElementMorph.		].! !!PLC_BlockMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 7/10/2013 02:16'!addInstanceOnLadderView: aLadderView from: aConnectableBlock	"Agrega sus elementos graficos morphs dependientes al ladder view.	Estos pueden ser Actual Arguments o Pines."	| variableConnectableBlock variableGraficElement |		"Aado el Actual Argument Morph de variable de instancia si su elemento es llamado a Function Block"	"Busco la variable del modelo"	variableConnectableBlock := aConnectableBlock element connectableBlockActualArgumentFor: aConnectableBlock.		"Busco la variable grafica del elemento"	variableGraficElement := self instanceVariable.		"La agrego de submorph al ladderView"	aLadderView addMorph: variableGraficElement.		"Agrego la variable al diccionario elements"	aLadderView elements at: variableGraficElement put: variableConnectableBlock.		"Lo agrego a la lista de seleccionados y le doy el foco del teclado"	aLadderView selectedAndKeyboardFocus: variableGraficElement.! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 7/10/2013 00:02'!addOutputPin	"Aade un pin de salida al elemento."	| pinMorph |	pinMorph := PLC_PinBlockMorph new.	self outputPins add: pinMorph.		^ pinMorph.! !!PLC_BlockMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 4/7/2015 03:17'!addOutputPinsOnLadderView: aLadderView from: aConnectableBlock	"Agrega sus pines de salida dependientes al ladder view. 	aConnectableBlock es el bloque conectable asociado a este morph."	| dependenGraficElementMorph dependentConnectableBlockPin |		"Aado los pines de Salida."		( 1 to: self outputPins size ) do: [ :index |				"Busco el morph dependiente"		dependenGraficElementMorph := self outputPinAt: index.								"Obtengo el pin correspondiente del bloque conectable de dependenGraficElementMorph."		dependentConnectableBlockPin := aConnectableBlock outputPinAt: index.			"Agrego el dependenGraficElementMorph de submorph al ladderView"		aLadderView addMorph: dependenGraficElementMorph.			"Agregoel dependenGraficElementMorph al diccionario elements"		aLadderView elements at: dependenGraficElementMorph put: dependentConnectableBlockPin.			"Lo agrego a la lista de seleccionados y le doy el foco del teclado"		aLadderView selectedAndKeyboardFocus: dependenGraficElementMorph.		].! !!PLC_BlockMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/9/2013 20:58'!addToGroup: aGroup	"El elemento Bloque se aade al grupo pasado como parmetro.	Luego le enva este mismo mensaje al elemento conectado a su	primer salida."	"Aado el elemento al grupo."	aGroup add: self.		"Le envo este mismo mensaje al elemento conectado a su 	primer salida."	( self blockConnectedToOutput: 1 ) addToGroup: aGroup. ! !!PLC_BlockMorph methodsFor: 'extent' stamp: 'EricPernia 6/23/2013 06:01'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self totalExtent - ( 0 @ ((self properties scale y) * 12) )! !!PLC_BlockMorph methodsFor: 'position' stamp: 'EricPernia 6/23/2013 16:29'!backgroundRectanglePosition	"Devuelve la posicin en pantalla del backgroundRectangle relativa a position del elemento [px]."		^ self properties scale * ( 0 @ 0 ).! !!PLC_BlockMorph methodsFor: 'drawing' stamp: 'EricPernia 6/23/2013 21:48'!blockHeadRectangle	"Rectangulo de la cabecera de bloque."	| width height blockHead |		width := self backgroundRectangle extent x - ( self properties scale x * 2 ).	height := self headHeight - ( self properties scale y ).			blockHead := Rectangle origin: (0@0) corner: ( width @ height ).		^ blockHead align: blockHead topLeft with: self bounds topLeft + self properties scale.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/9/2013 19:43'!bodyExtent	"Tamao calculado a partir de sus submorphs."		^( self extent x ) @		( (self inputFormalParameters last bottom max: self outputFormalParameters last bottom ) 			- self inputFormalParameters first top				+ self headHeight + super defaultExtent y ).! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 04:37'!bodyTop	"Construye la cabecera del bloque."		^ self headHeight + self top.! !!PLC_BlockMorph methodsFor: 'drawing' stamp: 'EricPernia 6/22/2013 01:49'!bottomHBar	"Rectangulo horizontal para tapar el error grafico inferior."	| width height bottomHBar |		width := self properties scale x * 22.	height := self properties scale y * 3.			bottomHBar := Rectangle origin: (0@0) corner: ( width @ height ).		bottomHBar align: bottomHBar bottomCenter with: self bounds bottomCenter.		^ bottomHBar centeredBeneath: self backgroundRectangle.		"^ bottomHBar translateBy: (0 @ 2)."! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/9/2013 19:41'!build	"Construye el bloque."		"self buildInstance."	self buildHead;		buildBody.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/9/2013 19:42'!buildBody	"Construye el cuerpo del bloque."			"Creo sus Formal Parameters"			self buildInputs;		buildOutputs;		buildInOuts.			"Posiciono sus Formal Parameters"	self positionHorizontallyFormalParameters;	 	positionVerticallyFormalParameters.			"Actualizo su tamao"	self extent: self bodyExtent.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 05:46'!buildHead	"Construye la cabecera del bloque."		self buildName;		buildOverloaded.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/10/2013 01:15'!buildInOuts	"Construye las entrada-salidas del cuerpo del bloque."	| inputInOutFP outputInOutFP |	( 1 to: self element buildInOuts size ) do: [ :idx |				"Creo el inOutFP de entrada y le agrego su pin"		inputInOutFP := PLC_InOutFormalParameterMorph new.		self addMorph: inputInOutFP.			self inputFormalParameters add: inputInOutFP.				inputInOutFP text: ( self element buildInOuts at: idx ) identifier.		inputInOutFP leftAlign.						self addInputPin.						"Creo el inOutFP de salida y le agrego su pin"				outputInOutFP := PLC_InOutFormalParameterMorph new.				self addMorph: outputInOutFP.			self outputFormalParameters add: outputInOutFP.				outputInOutFP text: ( self element buildInOuts at: idx ) identifier.		outputInOutFP rightAlign.					self addOutputPin.				"Asocio los inOutFP"		inputInOutFP inOutFPAssociated: outputInOutFP.		outputInOutFP inOutFPAssociated: inputInOutFP.						].! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/9/2013 19:18'!buildInputs	"Construye las entradas del cuerpo del bloque."		| formalParameter |	( 1 to: self element buildInputs size ) do: [ :idx |				formalParameter := PLC_FormalParameterMorph new.				self addMorph: formalParameter.		self inputFormalParameters add: formalParameter.				formalParameter text: ( self element buildInputs at: idx ) identifier.		formalParameter leftAlign.						self addInputPin.		].! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 06:16'!buildName	"Construye el Nombre de la cabecera del bloque."		| blockName |		blockName := self nameMorph.		self addMorph: blockName.		^ blockName.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/9/2013 19:21'!buildOutputs	"Construye las salidas del cuerpo del bloque."	| formalParameter |	( 1 to: self element buildOutputs size ) do: [ :idx |				formalParameter := PLC_FormalParameterMorph new.				self addMorph: formalParameter.		self outputFormalParameters add: formalParameter.				formalParameter text: ( self element buildOutputs at: idx ) identifier.		formalParameter rightAlign.									self addOutputPin.				].! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 06:16'!buildOverloaded	"Construye el tag de Overloaded de la cabecera del bloque."		| overloaded |		self overloadedType		ifNil:[			^ nil			]			ifNotNil: [ 			overloaded := self overloadedMorph.			self addMorph: overloaded.			^ overloaded.			].		! !!PLC_BlockMorph methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 04:14'!declaration		^ self element declaration.! !!PLC_BlockMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:08'!defaultExtent	"Tamao por defecto"		^ self elementWidth @ ( self properties scale y * super defaultExtent y * 3 ).! !!PLC_BlockMorph methodsFor: 'user interaction states' stamp: 'EricPernia 6/25/2013 02:17'!draggingAnother	"Estado cuando estaba seleccionado y arrastran otro elemento desde fuera de la network."	self userInteractionStateLayer1: PLC_GraphicElementState draggingAnother.	self changed.		self submorphsPerform: #draggingAnother.		self inputPins do: [ :each |		each unselected.		].		self outputPins do: [ :each |		each unselected.		].		self changed.! !!PLC_BlockMorph methodsFor: 'user interaction states' stamp: 'EricPernia 6/25/2013 02:17'!draggingSelf	"Estado cuando el elemento esta siendo arrastrado por el mouse."	self userInteractionStateLayer1: PLC_GraphicElementState draggingSelf.	self changed.		self submorphsPerform: #draggingSelf.		self inputPins do: [ :each |		each unselected.		].		self outputPins do: [ :each |		each unselected.		].		self changed.! !!PLC_BlockMorph methodsFor: 'drawing' stamp: 'EricPernia 6/22/2013 02:09'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		aCanvas 		fillRectangle: self backgroundRectangle 		color: self userInteractionStateLayer1 blockBodyColor.! !!PLC_BlockMorph methodsFor: 'drawing' stamp: 'EricPernia 6/23/2013 16:47'!drawElementOn: aCanvas	"Dibujo el cuadro de la cabecera de bloque."	aCanvas fillRectangle: self blockHeadRectangle color: self userInteractionStateLayer1 blockFootAndHeaderColor.! !!PLC_BlockMorph methodsFor: 'draw elements' stamp: 'EricPernia 7/17/2013 01:53'!drawHorizontalLinksFrom: aLadderView	"Dibuja el Horizontal Links de la primer salida del Bloque. 	Lo agrega al diccionario elements de aLadderView. 	Por ltimo le dice al elementos graficos conectados 	a su primer salida que dibuje sus horizontal links."	| connectableBlock horizontalLink connection outputGraphicElement |		connectableBlock := aLadderView modelElementForGraphicElement: self.			"Creo el Horizontal Link corespondiente a la salida numero 1."	horizontalLink := PLC_HorizontalLinkMorph new.			"Lo agrego de submorph"	aLadderView addMorphBack: horizontalLink.			"Busco la conexion a la salida numero 1 de connectableBlock"	connection := connectableBlock connectedAtOutput: 1.		"Lo agrego al diccionario elementos"	aLadderView elements at: horizontalLink put: connection.				"Lo selecciono y le doy el foco del teclado"	aLadderView selectedAndKeyboardFocus: horizontalLink.			"Posiciono el Horizontal Link"	horizontalLink top: ( self outputPins at: 1 ) top.	horizontalLink left: self right.			"Actualizo su tamao"	horizontalLink extentChanged.					"Busco el bloque conectable conectado a la salida numero 1"	outputGraphicElement := self blockConnectedToOutput: 1.			"Dibujo los horizontal links de los elementos conectados a sus salidas"	outputGraphicElement drawHorizontalLinksFrom: aLadderView.! !!PLC_BlockMorph methodsFor: 'drawing' stamp: 'EricPernia 6/22/2013 01:49'!drawPatchOn: aCanvas	"Parche cuando esta submorph. Hace un error grfico que se dibuja fuera del canvas.	Si no es submorph de nadie nunca se dibuja fuera del canvas"			aCanvas fillRectangle: self topHBar color: self owner color;		fillRectangle: self bottomHBar color: self owner color.! !!PLC_BlockMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/4/2013 02:34'!element	"Devuelve el elemento seteado cuando se crea el Elemento Grafico Morph"	^ self modelElement.! !!PLC_BlockMorph methodsFor: 'dependents' stamp: 'EricPernia 7/13/2013 04:04'!elementDependents	"Devuelve una OrderedCollection con sus elementos graficos morphs 	dependientes que agreg al LadderView. Estos pueden ser 	Actual Arguments o Pines."	| collection |		collection := OrderedCollection new.		collection addAll: self inputPins; 		addAll: self outputPins.		"addAll: self inputActualArguments ."				^ collection.! !!PLC_BlockMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:57'!elementDoubleWidth	"Doble ancho del elemento"	^ self properties scale x * 180.! !!PLC_BlockMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:07'!elementWidth	"Ancho estandar del elemento"	^ self properties scale x * 84.! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 6/30/2013 06:06'!firstPinYDistance	"Devuelve la distancia  en pantalla en Y del primer pin de entrada 	y salida relativa a la posicion vertical de self .	Es la distancia vertical entre la parte de arriba del elemento y el primer pin."		"^ self headHeight."	^ 36	"layoutFirstPinsYDistance	""Devuelve la distancia minima en pantalla en Y del primer pin de entrada 	y salida relativa a layoutRectangle top de self .	Es la distancia vertical entre la parte de arriba del elemento y sus sub elementos y el primer pin."		"^ self layoutRectangleRelativePosition y - self firstPinYDistance.distanceBetweenPins"	"Devuelve la distancia en pantalla en Y ente pines del elemento."		"^ self minYDistanceBetweenPins.	"! !!PLC_BlockMorph methodsFor: 'commands recive from formal parameters' stamp: 'EricPernia 7/9/2013 19:47'!formalParameterWithDoubleWidth	"Mensaje que se ejecuta cuando algn Formal Parameter Morph 	necesita el doble del ancho de bloque."	self doubleWidth.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 18:37'!headHeight	"Construye la cabecera del bloque."		^ 36.	"^ self nameMorph extent y + self overloadedMorph extent y."! !!PLC_BlockMorph methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 03:57'!identifier		^ self declaration identifier.! !!PLC_BlockMorph methodsFor: 'initialize-release' stamp: 'EricPernia 7/9/2013 19:04'!initialize	"Inicializaciones"	super initialize.	inputFormalParameters := OrderedCollection new.	outputFormalParameters := OrderedCollection new.		"self addFirstInputPin;		addFirstOutputPin."! !!PLC_BlockMorph methodsFor: 'accessing' stamp: 'EricPernia 7/9/2013 18:41'!inputFormalParameters		^ inputFormalParameters! !!PLC_BlockMorph methodsFor: 'accessing' stamp: 'EricPernia 7/9/2013 18:41'!inputFormalParameters: anObject		inputFormalParameters := anObject! !!PLC_BlockMorph methodsFor: 'commands recive from formal parameters' stamp: 'EricPernia 7/11/2013 02:43'!inputInOutFPVerticallyChanged: inOutFP	"Mensaje que se ejecuta cuando algn In Out Formal Parameter Morph 	cambia su posicion vertical y notifica al bloque."	| index actualArgumentMorph |	"Obtengo el indice de inOutFP"	index := self inputFormalParameters indexOf: inOutFP.! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 4/22/2015 03:04'!inputPinAt: aNumberOfInput	^ inputPins at: aNumberOfInput.! !!PLC_BlockMorph methodsFor: 'accessing' stamp: 'EricPernia 6/22/2013 03:17'!instanceVariable	"Es el morph Acrual Argument sobre el bloque"	^ instanceVariable! !!PLC_BlockMorph methodsFor: 'accessing' stamp: 'EricPernia 6/22/2013 02:12'!instanceVariable: anObject	instanceVariable := anObject! !!PLC_BlockMorph methodsFor: 'instance variable' stamp: 'EricPernia 6/30/2013 05:47'!instanceVariableFor: aConnectableBlock	"Devuelve el bloque conectable de la variable instancia, (si tiene) desde el bloque conectable del elemento."	self element isFunction		ifTrue: [ 			^ nil.			] 		ifFalse: [ 			^ aConnectableBlock blockConnectedToInput: aConnectableBlock inputs size.			].! !!PLC_BlockMorph methodsFor: 'model exploration' stamp: 'EricPernia 6/30/2013 04:10'!isPLCBlock	"Devuelve true si el elemento grafico es un Bloque."	^ true! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 7/9/2013 20:25'!layoutHorizontallyInputPins	"Posiciona horizontalmente los pines de entrada del bloque."	self inputPins do: [ :each |		each left: self left - each extent x.		].! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 7/9/2013 20:26'!layoutHorizontallyOutputPins	"Posiciona horizontalmente los pines de salida del bloque."	self outputPins do: [ :each |		each right: self right + each extent x.		].! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 7/9/2013 16:50'!layoutHorizontallyPins	"Posiciona horizontalmente todos los pines del bloque."	self layoutHorizontallyInputPins;		layoutHorizontallyOutputPins.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/9/2013 18:40'!layoutInput	"Construye las entradas del cuerpo del bloque."		| formalParameter formalParameterTop pinMorph |	formalParameterTop := self bodyTop.	( 1 to: self element buildInputs size ) do: [ :idx |				formalParameter := PLC_FormalParameterMorph new.				self addMorph: formalParameter.		self inputFormalParameters add: formalParameter.				formalParameter text: ( self element buildInputs at: idx ) identifier.		formalParameter top: formalParameterTop. 				formalParameterTop := formalParameter bottom.		formalParameter left: self left.		formalParameter leftAlign.						pinMorph := self addInputPin.		pinMorph bottom: formalParameter bottom.				].		^ formalParameterTop.! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 7/11/2013 02:34'!layoutInputActualArguments	"Posiciono los Actual Arguments conectados a sus entradas.	Este mtodo es vlido para cuando el bloque tiene slamente 	Actual arguments conectados a sus entradas a partir de la 	segunda. No si tiene Contactos o Bobinas."		| inputFormalParameter nextInputFormalParameter inputPin inputActualArgument |		"Alineo los Actual Arguments de salidas a partir de la segunda"	( 2 to: self inputPins size ) do: [ :index |				"Obtengo el Formal Parameter a su salida numero index"		inputFormalParameter := self inputFormalParameters at: index.				"Obtengo el Pin a su entrada numero index"		inputPin := self inputPins at: index.				"Obtengo el Actual Argument conectado a su entrada numero index"		inputActualArgument := self blockConnectedToInput: index.					"Posiciono en pantalla Horizontal y Verticalmente el Actual Argument obtenido."		inputActualArgument layoutTop: inputFormalParameter top.		inputActualArgument layoutLeft: inputPin left - inputActualArgument layoutRectangle extent x.				"Actualizo la posicin Vertical del Formal Parameter de dicha entrada. 		Esto es para cuando el texto del Actual Argument es de ms de una lnea."		inputActualArgument bottom: ( inputActualArgument bottom max: inputFormalParameter bottom ).		inputFormalParameter bottom: inputActualArgument bottom.				"En caso de ser un inOutFP Actualizo su inputInOutFP asociada."		( inputFormalParameter inOutFPAssociated )			ifNotNil: [ 				inputFormalParameter inOutFPAssociated 					updateOutputInOutFPAssociatedVerticalPosition.				] .				"Actualizo la posicion Vertical del Formal Parameter siguiente si existe"		( index < self inputPins size )			ifTrue: [ 				nextInputFormalParameter := self inputFormalParameters at: index + 1. 				nextInputFormalParameter top: inputFormalParameter bottom. 				].					].! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 7/11/2013 02:38'!layoutOn: aLadderView from: aGraphicElement output: anOutputNumber	"El elemento se posiciona dentro del ladderView."	"Actualizo los estados de alineacion de los elementos conectados a sus entradas y salidas"	self updateConnectedMorphsAlignStates.		"Alineo Horizontalmente a este elemento grfico."	self layoutHorizontallyOn: aLadderView from: aGraphicElement output: anOutputNumber.	"Alineo Horizontalmente sus pines."	self layoutHorizontallyPins.			"Alineo Verticalmente su grupo."	self layoutGroupVerticallyOn: aLadderView from: aGraphicElement output: anOutputNumber.		"Posiciono sus Actual Arguments de entrada a partir de la segunda"	self layoutInputActualArguments.	"Posiciono los Actual Arguments de salidas a partir de la segunda"	self layoutOutputActualArguments.		"Actualizo el tamao del bloque"	self extent: self bodyExtent.	"Actualizo la posicion Vertical de los pines"	self layoutVerticallyPins.			"Posiciono el elemento conectado a su primer salida."	self layoutOutputsOn: aLadderView from: aGraphicElement output: anOutputNumber.		! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 7/11/2013 02:25'!layoutOutputActualArguments	"Posiciono los Actual Arguments conectados a sus salidas."		| outputFormalParameter nextOutputFormalParameter outputPin outputActualArgument |		"Alineo los Actual Arguments de salidas a partir de la segunda"	( 2 to: self outputPins size ) do: [ :index |				"Obtengo el Formal Parameter a su salida numero index"		outputFormalParameter := self outputFormalParameters at: index.				"Obtengo el Pin a su salida numero index"		outputPin := self outputPins at: index.				"Obtengo el Actual Argument conectado a su salida numero index"		outputActualArgument := self blockConnectedToOutput: index.					"Posiciono en pantalla Horizontal y Verticalmente el Actual Argument obtenido."		outputActualArgument layoutTop: outputFormalParameter top.		outputActualArgument layoutLeft: outputPin right.				"Actualizo la posicin Vertical del Formal Parameter de dicha salida. 		Esto es para cuando el texto del Actual Argument es de ms de una lnea."		outputActualArgument bottom: ( outputActualArgument bottom max: outputFormalParameter bottom ).		outputFormalParameter bottom: outputActualArgument bottom.				"En caso de ser un inOutFP Actualizo su inputInOutFP asociada."		( outputFormalParameter inOutFPAssociated )			ifNotNil: [ 				outputFormalParameter inOutFPAssociated 					updateInputInOutFPAssociatedVerticalPosition.				] .				"Actualizo la posicion Vertical del Formal Parameter siguiente si existe"		( index < self outputPins size )			ifTrue: [ 				nextOutputFormalParameter := self outputFormalParameters at: index + 1. 				nextOutputFormalParameter top: outputFormalParameter bottom. 				].					].! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 7/11/2013 02:34'!layoutOutputsOn: aLadderView from: aGraphicElement output: anOutputNumber	"Posiciono el elemento conectado a su primer salida."		"Posiciono el elemento conectado a la primer salida"	super layoutOutputsOn: aLadderView from: aGraphicElement output: anOutputNumber.! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 6/30/2013 05:36'!layoutRectangle	"Devuelve el rectngulo para acomodar en pantalla los elementos entre si."	| blockLayoutRectangle variableLayoutRectangle |		blockLayoutRectangle := Rectangle 		origin: ( 0 @ 0 )		corner: self layoutRectangleExtent.			blockLayoutRectangle := blockLayoutRectangle translateBy: self position + self layoutRectanglePosition.		self instanceVariable		ifNil: [ 			^ blockLayoutRectangle.			]		ifNotNil: [ 			variableLayoutRectangle := self instanceVariable layoutRectangle.			^ blockLayoutRectangle merge: variableLayoutRectangle.			].			! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/14/2013 22:43'!layoutRectangleExtentConnectedToLeftPowerRailOutput1	"Devuelve el tamao en pixeles del layoutRectangle."		^ self voidLayoutRectangleExtent.! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/14/2013 22:44'!layoutRectangleExtentNotConnectedToLeftPowerRailOutput1	"Devuelve el tamao en pixeles del layoutRectangle."		^ self voidLayoutRectangleExtent.! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 3/13/2016 20:50'!layoutRectangleForGroup	"Devuelve el rectngulo para acomodar en pantalla los elementos 	entre si que usan los grupos azules."		| rect pt1 pt2 |		pt1	:= self layoutRectangle topLeft.			"Opcin 1 - Funciona seguro porque no entra al whileTrue en	PLC_LadderView>>maxBottomElementUnderGroup:"	"pt2	:= self layoutRectangle bottomRight." 		"Opcin 2 - Dibuja ms apretado verticalmente"	pt2	:= self layoutRectangle topRight +		 ( 0 @ self headHeight). 			"Old implementation. In Pharo 4.0 Rectangle>>origin:corner: method change"	"	pt2	:= self layoutRectangle right		@ ( self headHeight			+ 			self gridExtent y			).	"	rect := Rectangle origin: pt1 corner: pt2.	^ rect.! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 7/9/2013 20:31'!layoutVerticallyInputPins	"Posiciona verticalmente los Pines de entrada."		| formalParameter inputPin |	( 1 to: self inputPins size ) do: [ :idx |				"Obtengo el inputFormalParameter"		formalParameter := self inputFormalParameters at: idx.				"Obtengo el inputPin"		inputPin := self inputPins at: idx.				"Establezco su posicion Vertical"		inputPin bottom: formalParameter bottom. 				].! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 7/9/2013 20:30'!layoutVerticallyOutputPins	"Posiciona verticalmente los Pines de salida."		| formalParameter outputPin |	( 1 to: self outputPins size ) do: [ :idx |				"Obtengo el inputFormalParameter"		formalParameter := self outputFormalParameters at: idx.				"Obtengo el outputPin"		outputPin := self outputPins at: idx.				"Establezco su posicion Vertical"		outputPin bottom: formalParameter bottom. 				].! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 7/9/2013 20:32'!layoutVerticallyPins	"Posiciona verticalmente los Pines."		self layoutVerticallyInputPins;		layoutVerticallyOutputPins.! !!PLC_BlockMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 20:37'!leftAndRightConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"	self connectionStateLayer1: PLC_GraphicElementState leftAndRightConnectedToVerticalLink.	self changed.! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/9/2013 21:21'!leftAndRightConnectedToVerticalLinkLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent + (self properties scale * ( 196 @ 0 ) ). " 196 = (self gridExtent x * 2) + 4 "! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/9/2013 21:23'!leftAndRightConnectedToVerticalLinkLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -98 @ 0 ). " -98 = -self gridExtent x - 2 "! !!PLC_BlockMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 20:37'!leftConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"	self connectionStateLayer1 leftConnectedToVerticalLinkFor: self.! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/9/2013 21:21'!leftConnectedToVerticalLinkLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent + (self properties scale * ( 200 @ 0 ) ). " 200 = (self gridExtent x * 2) + 8 "! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/9/2013 21:22'!leftConnectedToVerticalLinkLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."	^ self properties scale * ( -98 @ 0 ). " -98 = -self gridExtent x - 2 "! !!PLC_BlockMorph methodsFor: 'accessing' stamp: 'EricPernia 7/4/2013 02:32'!modelElement		^ modelElement! !!PLC_BlockMorph methodsFor: 'accessing' stamp: 'EricPernia 7/4/2013 02:32'!modelElement: anObject		modelElement := anObject! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 06:15'!nameExtent	"Tamao del nombre."		^ self nameMorph extent.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 06:13'!nameMorph	"Construye el Nombre de la cabecera del bloque."		| blockName |		blockName := PLC_BlockNameMorph new.	blockName text: self identifier.	"blockName useMaxWidth ifTrue: [ self useMaxWidth: true. ]. "	blockName center: self center.	blockName top: self top.		^ blockName.! !!PLC_BlockMorph methodsFor: 'accessing' stamp: 'EricPernia 7/9/2013 18:41'!outputFormalParameters		^ outputFormalParameters! !!PLC_BlockMorph methodsFor: 'accessing' stamp: 'EricPernia 7/9/2013 18:41'!outputFormalParameters: anObject		outputFormalParameters := anObject! !!PLC_BlockMorph methodsFor: 'commands recive from formal parameters' stamp: 'EricPernia 7/10/2013 01:59'!outputInOutFPVerticallyChanged: inOutFP	"Mensaje que se ejecuta cuando algn In Out Formal Parameter Morph 	cambia su posicion vertical y notifica al bloque."	| index actualArgumentMorph |	"Obtengo el indice de inOutFP"	index := self outputFormalParameters indexOf: inOutFP.		"Obtengo el Actual Argument conectado a la salida numero index"	"actualArgumentMorph := self blockConnectedToOutput: index."		"Posiciono verticalmente el Actual Argument"		"HACERRRRRRRRRRRRRRRRRRRRRR"	! !!PLC_BlockMorph methodsFor: 'pins' stamp: 'EricPernia 4/22/2015 03:04'!outputPinAt: aNumberOfOutput	^ outputPins at: aNumberOfOutput.! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 06:14'!overloadedExtent	"Tamao del overloaded tag."		self overloadedMorph 		ifNil: [			^ 0@0			]		ifNotNil: [			^ self overloadedMorph extent.			]! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 6/22/2013 18:43'!overloadedMorph	"Construye el tag de Overloaded de la cabecera del bloque."		| overloaded |		self overloadedType		ifNil: [ 			^ nil.			]		ifNotNil: [ 			overloaded := PLC_OverloadedMorph new.				overloaded text: self overloadedType.			"overloaded useMaxWidth ifTrue: [ self useMaxWidth: true. ]. "			overloaded center: self center.			overloaded top: self top +18.			"overloaded centeredBeneath: self nameMorph."				^ overloaded.			].		! !!PLC_BlockMorph methodsFor: 'declaration' stamp: 'EricPernia 6/22/2013 05:57'!overloadedType		self declaration dataType 		ifNil: [ 			^ nil.			] 		ifNotNil: [ 			^ self declaration dataType ilCompile.			]		! !!PLC_BlockMorph methodsFor: 'position' stamp: 'EricPernia 7/9/2013 20:54'!position: aPoint	"Establece la posicion en pantalla del elemento. 	En el caso de los contactos y bobinas adems reacomoda su variable asociada."		super position: aPoint.			"Actualizo la posicion en pantalla de sus dependientes"		self instanceVariable		ifNotNil: [			self instanceVariable alignCenteredAbove: self.			].! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/9/2013 19:34'!positionHorizontallyFormalParameters	"Posiciona horizontalmente los Formal Parameters del bloque."	"Posiciono horizontalmente los Formal Parameter de entradas"	self inputFormalParameters do: [ :formalParameter |		formalParameter left: self left.		].	"Posiciono horizontalmente los Formal Parameter de salidas"		self outputFormalParameters do: [ :formalParameter |		formalParameter right: self right.		].! !!PLC_BlockMorph methodsFor: 'building' stamp: 'EricPernia 7/10/2013 02:02'!positionVerticallyFormalParameters	"Posiciona verticalmente los Formal Parameters. 	Es la posicin inicial cuando se crea el bloque."		| formalParameter formalParameterTop |		"Posiciono verticalmente los Formal Parameter de entradas"		formalParameterTop := self bodyTop.	( 1 to: self inputFormalParameters size ) do: [ :idx |				"Obtengo el inputFormalParameter"		formalParameter := self inputFormalParameters at: idx.				"Establezco su posicion Vertical"		formalParameter top: formalParameterTop. 				"Guardo la prxima posicion Vertical"		formalParameterTop := formalParameter bottom.				].		"Posiciono verticalmente los Formal Parameter de salidas"		formalParameterTop := self bodyTop.	( 1 to: self outputFormalParameters size ) do: [ :idx |				"Obtengo el inputFormalParameter"		formalParameter := self outputFormalParameters at: idx.				"Establezco su posicion Vertical"		formalParameter top: formalParameterTop. 				( formalParameter inOutFPAssociated )			ifNotNil: [ 				formalParameter inOutFPAssociated updateInputInOutFPAssociatedVerticalPosition.				] .				"Guardo la prxima posicion Vertical"		formalParameterTop := formalParameter bottom.				].! !!PLC_BlockMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 7/16/2013 18:51'!removeElementFrom: aLadderView	"Remueve el elemento pidiendoselo a su ladder view. Hace un double dispatching con este"		aLadderView removeFunctionCall: self.! !!PLC_BlockMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 20:36'!rightConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"	self connectionStateLayer1 rightConnectedToVerticalLinkFor: self.! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/9/2013 21:21'!rightConnectedToVerticalLinkLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent + (self properties scale * ( 200 @ 0 ) ). " 200 = (self gridExtent x * 2) + 8 "! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/9/2013 21:22'!rightConnectedToVerticalLinkLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."	^ self properties scale * ( -102 @ 0 ). " -102 = -self gridExtent x - 6 "! !!PLC_BlockMorph methodsFor: 'user interaction states' stamp: 'EricPernia 6/23/2013 23:39'!selected	"Estado seleccionado."	self userInteractionStateLayer1: PLC_GraphicElementState selected.		self submorphsPerform: #selected.		self inputPins do: [ :each |		each unselected.		].		self outputPins do: [ :each |		each unselected.		].		self changed.! !!PLC_BlockMorph methodsFor: 'extent' stamp: 'EricPernia 6/23/2013 05:59'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self extent.! !!PLC_BlockMorph methodsFor: 'layout' stamp: 'EricPernia 7/11/2013 02:20'!updateConnectedMorphsAlignStates	"Actualiza los estados de alineacin de sus Actual Arguments."		| inputGraphicElement outputGraphicElement |		( 2 to: self inputPins size ) do: [ :index | 				"Busco el elemento conectado a la entrada nmero index"				inputGraphicElement := self blockConnectedToInput: index.				"Cambio su estado a alineado a derecha"		inputGraphicElement rightAlign.				].		( 2 to: self outputPins size ) do: [ :index | 				"Busco el elemento conectado a la entrada nmero index"				outputGraphicElement := self blockConnectedToOutput: index.				"Cambio su estado a alineado a izquierda"		outputGraphicElement leftAlign.				].! !!PLC_BlockMorph methodsFor: 'connection states' stamp: 'EricPernia 7/6/2013 16:49'!updateOutputsConnectonStates	"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."		| outputGraphicElement |			"Busco el elemento grafico conectado a la salida numero 1"	outputGraphicElement := self blockConnectedToOutput: 1.		"Cambio el estado de conexion de capa 2 al que traiga el elemento actual"	outputGraphicElement connectionStateLayer2: self connectionStateLayer2.	outputGraphicElement changed.			"El estado de conexion de capa 1 es conectado a self"	outputGraphicElement connectedToBlock.		"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."	outputGraphicElement updateOutputsConnectonStates.! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/9/2013 20:19'!voidLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent + (self properties scale * ( 204 @ 0 ) ). " 204 = (self gridExtent x * 2) + 12 "! !!PLC_BlockMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/9/2013 20:20'!voidLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -102 @ 0 ). " -102 = -self gridExtent x - 6 "! !!PLC_CoilMorph methodsFor: 'drawing' stamp: 'EricPernia 4/21/2012 04:00'!centralCircle	"Circulo centra para dibujar la bobina, se ve como ( ) debido a que se corta."	| width height rectangle origin corner |		width := (self properties scale x * 20) rounded.	height := (self properties scale y * 20) rounded.		rectangle := Rectangle origin: (0@0) corner: ( width @ height ).	^ rectangle align: rectangle center with: self bounds center.			"origin := self position + (self extent / 2.0) rounded - (width /2.0) rounded.	corner := origin + (width @ height).	^ Rectangle origin: origin corner: corner."! !!PLC_CoilMorph methodsFor: 'accessing' stamp: 'EricPernia 7/8/2013 00:25'!connectedToRightPowerRail		self isConnectedToRightPowerRail: true.! !!PLC_CoilMorph methodsFor: 'layout' stamp: 'EricPernia 7/8/2013 02:40'!connectedToRightPowerRailLayoutHorizontallyLeft: aDistanceX	"Como esta conectado a un RPR lo alineo a izquierda de este"		"Alineo el elemento a aDistanceX como si fuese un contacto."	"Alineando a derecha incicialemente me aseguro que la Bobina no pise ningun morph pues reserva el lugar."		self layoutLeft: aDistanceX.	"Alineo el RightPowerRail a derecha de la bobina"	(self blockConnectedToOutput: 1) layoutHorizontallyLeft: super layoutRectangle right.	"Alineo la Bobina a izquierda del RightPowerRail"				self layoutLeft: (self blockConnectedToOutput: 1) layoutRectangle left - super layoutRectangle extent x.	"	Transcript show: ( (self blockConnectedToOutput: 1) layoutRectangle left - super layoutRectangle extent x ) asString , ''."! !!PLC_CoilMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 02:12'!drawElementOn: aCanvas	"Dibuja el elemento"	aCanvas fillRectangle: self leftHBar color: self userInteractionStateLayer1 elementColor;		fillRectangle: self rightHBar color: self userInteractionStateLayer1 elementColor;		fillOval: self centralCircle 			color: self userInteractionStateLayer1 backgroundColor 			borderWidth: self leftHBar extent y 			borderColor: self userInteractionStateLayer1 elementColor.	self drawPatchOn: aCanvas.! !!PLC_CoilMorph methodsFor: 'drawing' stamp: 'EricPernia 4/22/2013 13:25'!hBar	"Barra horizontal que representa el cable de la bobina"	| width height hBar|		width := (self properties scale x * 28) rounded. "Redondeo explicitamente para que se dibuje bien."	 "28"	height := (self properties scale y * 2) rounded.	"2"		hBar := Rectangle origin: (0@0) corner: ( width @ height ).		^ hBar align: hBar center with: self bounds center.! !!PLC_CoilMorph methodsFor: 'initialize-release' stamp: 'EricPernia 7/8/2013 00:27'!initialize	"Inicializo el elemento grafico"	super initialize.		isConnectedToRightPowerRail := false.! !!PLC_CoilMorph methodsFor: 'instance variable' stamp: 'EricPernia 6/22/2013 01:55'!instanceVariableFor: aConnectableBlock	"Devuelve el bloque conectable de la variable desde el bloque conectable del elemento"	^ aConnectableBlock blockConnectedToOutput: 2! !!PLC_CoilMorph methodsFor: 'model exploration' stamp: 'EricPernia 6/30/2013 04:08'!isCoil	"Devuelve true si el elemento grafico es una bobina."	^ true! !!PLC_CoilMorph methodsFor: 'accessing' stamp: 'EricPernia 7/8/2013 00:25'!isConnectedToRightPowerRail		^ isConnectedToRightPowerRail! !!PLC_CoilMorph methodsFor: 'accessing' stamp: 'EricPernia 7/8/2013 00:26'!isConnectedToRightPowerRail: anObject		isConnectedToRightPowerRail := anObject! !!PLC_CoilMorph methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 21:32'!layoutHorizontallyLeft: aDistanceX	"self se posiciona  de alguna manera con respecto a aDistanceX. 	self solo se mueve horizontalmente."	self isConnectedToRightPowerRail		ifTrue: [ 			self connectedToRightPowerRailLayoutHorizontallyLeft: aDistanceX			] 		ifFalse: [ 			self notConnectedToRightPowerRailLayoutHorizontallyLeft: aDistanceX			].! !!PLC_CoilMorph methodsFor: 'position' stamp: 'EricPernia 7/8/2013 02:41'!layoutRectangleRelativePosition	"Posicion relativa entre el layoutRectangle y el position del elemento	MODIFICADO para que no genere errores con respecto al 	layoutRectangle calculado al acomodar bobinas en pantalla.		SI SACO ESTE METODO NO ACOMODA BIEN LAS BOBINAS"	^ self topLeft - super layoutRectangle topLeft.! !!PLC_CoilMorph methodsFor: 'layout' stamp: 'EricPernia 7/8/2013 00:15'!notConnectedToRightPowerRailLayoutHorizontallyLeft: aDistanceX	"Como NO esta conectado a un RPR solo alineo el elemento a aDistanceX como si fuese un contacto."		self layoutLeft: aDistanceX.! !!PLC_CoilMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 5/1/2013 22:44'!removeElementFrom: aLadderView	"Remueve el elemento pidiendoselo a su ladder view. Hace un double dispatching con este"		aLadderView removeCoil: self.! !!PLC_CoilMorph methodsFor: 'connection states' stamp: 'EricPernia 7/6/2013 16:12'!updateOutputsConnectonStates	"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."		| outputGraphicElement |			"Busco el elemento grafico conectado a la salida numero 1"	outputGraphicElement := self blockConnectedToOutput: 1.		"Cambio el estado de conexion de capa 2 al que traiga el elemento actual"	outputGraphicElement connectedToLeftPowerRailTroughFirstOutputPin.			"El estado de conexion de capa 1 es conectado a self"	outputGraphicElement connectedToCoil.		"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."	outputGraphicElement updateOutputsConnectonStates.! !!PLC_NCoilMorph methodsFor: 'drawing' stamp: 'EricPernia 5/1/2013 18:43'!drawElementOn: aCanvas	"Dibujo la linea diagonal del centro"	| rectangleReduction |	super drawElementOn: aCanvas.		rectangleReduction := (self properties scale x * 4.0) rounded.		aCanvas 		line: self centralCircle bottomLeft + (rectangleReduction @ rectangleReduction negated)		to: self centralCircle topRight + (rectangleReduction negated @ rectangleReduction)		width: self leftHBar extent y 		color: self userInteractionStateLayer1 elementColor.! !!PLC_ContactsAndCoils class methodsFor: 'instance creation' stamp: 'EricPernia 7/14/2013 05:27'!newFromConnectableBlock: aConnectableBlock	"Nueva isntancia a partir de un elemento de un bloque conectable"	| graphicElem graphicVar |	"Creo el elemento grafico"		graphicElem := self new.	"Busco la variable del modelo y le pido su grafico"	graphicVar := ( graphicElem instanceVariableFor: aConnectableBlock ) graphicElement.		"Asigno al elemento grafico su variable morph"	graphicElem instanceVariable: graphicVar.	"Asigno a la variable morph el elemento grafico"	graphicVar graphicElement: graphicElem.		"Alineo la variable grafica al elemento grafico centrada sobre este"	graphicVar alignAbove: graphicElem.	"graphicVar alignCenteredAbove: graphicElem."		"Lo posiciono fuera del ladderView para que no moleste cuando	hago layout"	graphicElem position: graphicElem position - graphicElem layoutRectangle extent.		^ graphicElem.! !!PLC_ContactsAndCoils methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 7/3/2013 11:03'!addDependentsOnLadderView: aLadderView from: aConnectableBlock	"Agrega sus elementos graficos morphs dependientes al ladder view.	Estos pueden ser Actual Arguments o Pines."	| variableConnectableBlock variableGraficElement |	"Busco la variable del modelo"	variableConnectableBlock := aConnectableBlock element connectableBlockActualArgumentFor: aConnectableBlock.		"Busco la variable grafica del elemento"	variableGraficElement := self instanceVariable.		"La agrego de submorph al ladderView"	aLadderView addMorph: variableGraficElement.		"Agrego la variable al diccionario elements"	aLadderView elements at: variableGraficElement put: variableConnectableBlock.		"Lo agrego a la lista de seleccionados y le doy el foco del teclado"	aLadderView selectedAndKeyboardFocus: variableGraficElement.	! !!PLC_ContactsAndCoils methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 02:12'!addToGroup: aGroup	"El elemento Contacto o Bobina se aade al grupo pasado como parmetro.	Luego le enva este mismo mensaje al elemento conectado a su salida."	"Aado el elemento al grupo."	aGroup add: self.		"Le envo este mismo mensaje al elemento conectado a su salida."	( self blockConnectedToOutput: 1 ) addToGroup: aGroup. ! !!PLC_ContactsAndCoils methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 02:10'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self properties scale * ( 72 @ 14 ).! !!PLC_ContactsAndCoils methodsFor: 'drawing' stamp: 'EricPernia 5/22/2012 19:59'!bottomHBar	"Rectangulo horizontal para tapar el error grafico inferior."	| width height bottomHBar |		width := self properties scale x * 22.	height := self properties scale y * 3.			bottomHBar := Rectangle origin: (0@0) corner: ( width @ height ).		bottomHBar align: bottomHBar bottomCenter with: self bounds bottomCenter.		^ bottomHBar centeredBeneath: self backgroundRectangle.		"^ bottomHBar translateBy: (0 @ 2)."! !!PLC_ContactsAndCoils methodsFor: 'extent' stamp: 'EricPernia 4/25/2013 00:34'!defaultExtent	"Tamao por defecto"		^ self properties scale * ( 72 @ super defaultExtent y ).! !!PLC_ContactsAndCoils methodsFor: 'drawing' stamp: 'EricPernia 4/21/2012 22:50'!drawPatchOn: aCanvas	"Parche cuando esta submorph. Hace un error grfico que se dibuja fuera del canvas.	Si no es submorph de nadie nunca se dibuja fuera del canvas"			aCanvas fillRectangle: self topHBar color: self owner color;		fillRectangle: self bottomHBar color: self owner color.! !!PLC_ContactsAndCoils methodsFor: 'dependents' stamp: 'EricPernia 7/13/2013 04:08'!elementDependents	"Devuelve una OrderedCollection con sus elementos graficos morphs 	dependientes que agreg al LadderView. En Contactos y Bobinas es	su Actual Argument de instancia."	| collection |		collection := OrderedCollection new.		collection add: self instanceVariable.				^ collection.! !!PLC_ContactsAndCoils methodsFor: 'initialize-release' stamp: 'EricPernia 5/1/2013 15:04'!initialize	"Inicializo el elemento grafico"	super initialize.		self extentChanged.	"Aado los pines"	self addInputPin;		addOutputPin.			"Los hago invisibles"	self submorphs do: [ :morph |		morph visible: false.		].! !!PLC_ContactsAndCoils methodsFor: 'accessing' stamp: 'EricPernia 6/22/2013 02:15'!instanceVariable	^ instanceVariable! !!PLC_ContactsAndCoils methodsFor: 'accessing' stamp: 'EricPernia 6/22/2013 02:16'!instanceVariable: anObject	instanceVariable := anObject! !!PLC_ContactsAndCoils methodsFor: 'layout' stamp: 'EricPernia 7/9/2013 03:23'!layoutOn: aLadderView from: aGraphicElement output: anOutputNumber	"El elemento se posiciona dentro del ladderView."	"Alineo Horizontalmente a este elemento grfico."	self layoutHorizontallyOn: aLadderView from: aGraphicElement output: anOutputNumber.		"Alineo Verticalmnete su grupo."	self layoutGroupVerticallyOn: aLadderView from: aGraphicElement output: anOutputNumber.		"Posiciono el elemento conectado a la su salida."	self layoutOutputsOn: aLadderView from: aGraphicElement output: anOutputNumber.! !!PLC_ContactsAndCoils methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 18:10'!layoutRectangle	"Devuelve el rectngulo para acomodar en pantalla los elementos entre si."	| contactLayoutRectangle variableLayoutRectangle |		contactLayoutRectangle := Rectangle 		origin: ( 0 @ 0 )		corner: self layoutRectangleExtent.			contactLayoutRectangle := contactLayoutRectangle translateBy: self position + self layoutRectanglePosition.		self instanceVariable 		ifNil: [			variableLayoutRectangle := self instanceVariable layoutRectangle.			^ contactLayoutRectangle.			]		ifNotNil: [			variableLayoutRectangle := self instanceVariable layoutRectangle.			^ contactLayoutRectangle merge: variableLayoutRectangle.			].! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/14/2013 22:42'!layoutRectangleExtentConnectedToLeftPowerRailOutput1	"Devuelve el tamao en pixeles del layoutRectangle."		^ self voidLayoutRectangleExtent.! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/14/2013 22:42'!layoutRectangleExtentNotConnectedToLeftPowerRailOutput1	"Devuelve el tamao en pixeles del layoutRectangle."		^ self voidLayoutRectangleExtent.! !!PLC_ContactsAndCoils methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 17:20'!leftAndRightConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"	self connectionStateLayer1: PLC_GraphicElementState leftAndRightConnectedToVerticalLink.	self changed.! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 19:30'!leftAndRightConnectedToVerticalLinkLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ ( super defaultExtent x - ( self properties scale x * 8 ) ) @ ( self defaultExtent y * 2 ).! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 18:47'!leftAndRightConnectedToVerticalLinkLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -8 @ 0 ).! !!PLC_ContactsAndCoils methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 18:31'!leftConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"	self connectionStateLayer1 leftConnectedToVerticalLinkFor: self.! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 19:30'!leftConnectedToVerticalLinkLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ ( super defaultExtent x - ( self properties scale x * 4 ) ) @ ( self defaultExtent y * 2 ).! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 18:48'!leftConnectedToVerticalLinkLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -8 @ 0 ).! !!PLC_ContactsAndCoils methodsFor: 'drawing' stamp: 'EricPernia 4/21/2012 04:03'!leftHBar	"Cable izquierdo del elemento."	^ self hBar align: self hBar leftCenter with: self bounds leftCenter.! !!PLC_ContactsAndCoils methodsFor: 'position' stamp: 'EricPernia 7/7/2013 18:07'!position: aPoint	"Establece la posicion en pantalla del elemento. 	En el caso de los contactos y bobinas adems reacomoda su variable asociada."		super position: aPoint.		self instanceVariable 		ifNotNil: [			self instanceVariable alignCenteredAbove: self			].! !!PLC_ContactsAndCoils methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/7/2013 17:21'!rightConnectedToVerticalLink	"Cambia su estado de conexion capa 1al estado conectado a Enlace Vertical a derecha.	Lo implementan Contactos, Bobinas y Bloques"	self connectionStateLayer1 rightConnectedToVerticalLinkFor: self.! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 19:30'!rightConnectedToVerticalLinkLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ ( super defaultExtent x - ( self properties scale x * 4 ) ) @ ( self defaultExtent y * 2 ).! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 18:48'!rightConnectedToVerticalLinkLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -12 @ 0 ).! !!PLC_ContactsAndCoils methodsFor: 'drawing' stamp: 'EricPernia 4/21/2012 04:03'!rightHBar	"Cable derecho del elemento."	^ self hBar align: self hBar rightCenter with: self bounds rightCenter.! !!PLC_ContactsAndCoils methodsFor: 'drawing' stamp: 'EricPernia 5/22/2012 20:06'!topHBar	"Rectangulo horizontal para tapar el error grafico superior."	| width height topHBar |		width := self properties scale x * 22.	height := self properties scale y * 3.			topHBar := Rectangle origin: (0@0) corner: ( width @ height ).		^ topHBar align: topHBar topCenter with: self bounds topCenter - ( 0 @ 1).		"^ topHBar translateBy: (0 @ 2)."! !!PLC_ContactsAndCoils methodsFor: 'extent' stamp: 'EricPernia 4/25/2013 00:33'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self defaultExtent.! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 05:36'!voidLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ super defaultExtent x @ ( self defaultExtent y * 2 ).! !!PLC_ContactsAndCoils methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 18:48'!voidLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -12 @ 0 ).! !!PLC_NCContactMorph methodsFor: 'drawing' stamp: 'EricPernia 5/1/2013 18:42'!drawElementOn: aCanvas	"Dibujo la linea diagonal del centro"	| rectangleReduction |	super drawElementOn: aCanvas.		rectangleReduction := (self properties scale x * 1) rounded.	aCanvas 		line: self leftVBar bottomRight - (0 @ rectangleReduction)		to: self rightVBar topLeft + (0 @ rectangleReduction)		width: self leftHBar extent y 		color: self userInteractionStateLayer1 elementColor.	! !!PLC_NOContactMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 02:06'!drawElementOn: aCanvas	"Comentario"	aCanvas fillRectangle: self leftHBar color: self userInteractionStateLayer1 elementColor;		fillRectangle: self leftVBar color: self userInteractionStateLayer1 elementColor;		fillRectangle: self rightHBar color: self userInteractionStateLayer1 elementColor;		fillRectangle: self rightVBar color: self userInteractionStateLayer1 elementColor.			self drawPatchOn: aCanvas.	! !!PLC_NOContactMorph methodsFor: 'drawing' stamp: 'EricPernia 4/21/2012 04:02'!hBar	"Barra horizontal que representa el cable del contacto"	| width height|		width := (self properties scale x * 30) rounded. "Redondeo explicitamente para que se dibuje bien."	 "30"	height := (self properties scale y * 2) rounded.	"2"		^ Rectangle origin: (0@0) corner: ( width @ height ).! !!PLC_NOContactMorph methodsFor: 'instance variable' stamp: 'EricPernia 6/22/2013 01:55'!instanceVariableFor: aConnectableBlock	"Devuelve el bloque conectable de la variable desde el bloque conectable del elemento"	^ aConnectableBlock blockConnectedToInput: 2! !!PLC_NOContactMorph methodsFor: 'model exploration' stamp: 'EricPernia 6/30/2013 04:07'!isContact	"Devuelve true si el elemento grafico es un Contacto."	^ false! !!PLC_NOContactMorph methodsFor: 'drawing' stamp: 'EricPernia 5/22/2012 20:04'!leftVBar	"Barra vertical  izquierda del contacto."	^ self vBar translateBy: self backgroundRectangle origin + (self leftHBar extent x @ 0).! !!PLC_NOContactMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 6/22/2013 01:51'!removeElementFrom: aLadderView	"Remueve el elemento pidiendoselo a su ladder view. Hace un double dispatching con este"		aLadderView removeContact: self.! !!PLC_NOContactMorph methodsFor: 'drawing' stamp: 'EricPernia 5/22/2012 20:04'!rightVBar	"Barra vertical  derecha del contacto."	^ self vBar translateBy: self backgroundRectangle origin + (self extent x @ 0) - (self leftHBar extent x + self vBar width @ 0).	! !!PLC_NOContactMorph methodsFor: 'connection states' stamp: 'EricPernia 6/22/2013 01:51'!updateOutputsConnectonStates	"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."		| outputGraphicElement |			"Busco el elemento grafico conectado a la salida numero 1"	outputGraphicElement := self blockConnectedToOutput: 1.		"Cambio el estado de conexion de capa 2 al que traiga el elemento actual"	outputGraphicElement connectionStateLayer2: self connectionStateLayer2.	outputGraphicElement changed.			"El estado de conexion de capa 1 es conectado a self"	outputGraphicElement connectedToContact.		"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."	outputGraphicElement updateOutputsConnectonStates.! !!PLC_NOContactMorph methodsFor: 'drawing' stamp: 'EricPernia 5/22/2012 20:02'!vBar	"Barra horizontal que representa el cable del contacto"	| width height|		width := self properties scale x * 2.	height := self properties scale y * 14.		^ Rectangle origin: (0@0) corner: ( width @ height ).! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 6/23/2013 22:29'!addInputPin	"Aade un pin de entrada al elemento."	| pinMorph pos |	pinMorph := PLC_PinMorph new.		( self inputPins size = 0 )		ifTrue: [			pinMorph topLeft: self topLeft + ( 0 @ self firstPinYDistance ).			] 		ifFalse: [			pos := self inputPins last position.			pinMorph position: ( pos x @ ( pos y + self distanceBetweenPins ) ).			].		self addMorph: pinMorph.	self inputPins add: pinMorph.		^ pinMorph.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 6/23/2013 22:31'!addOutputPin	"Aade un pin de salida al elemento."	| pinMorph pos |	pinMorph := PLC_PinMorph new.		( self outputPins size = 0 )		ifTrue: [			pinMorph topRight: self topRight + ( 0 @ self firstPinYDistance ).			] 		ifFalse: [			pos := self outputPins last position.			pinMorph position: ( pos x @ ( pos y + self distanceBetweenPins ) ).			].		self addMorph: pinMorph.	self outputPins add: pinMorph.		^ pinMorph.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 4/28/2013 21:56'!distanceBetweenPins	"Devuelve la distancia en pantalla en Y ente pines del elemento."		^ self minYDistanceBetweenPins.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'draw elements' stamp: 'EricPernia 7/17/2013 01:53'!drawHorizontalLinksFrom: aLadderView	"Dibuja todos los Horizontal Links a las salidas del elemento. 	Los agrega al diccionario elements de aLadderView. 	Por ltimo le dice a los elementos graficos conectados 	a sus salidas que dibujen sus horizontal links."	| connectableBlock horizontalLink connection outputGraphicElement |		connectableBlock := aLadderView modelElementForGraphicElement: self.	"Si no tiene salidas no hace nada!!!!"	( 1 to: self outputPins size ) do: [ :ind |				"Creo el Horizontal Link corespondiente a la salida numero ind."		horizontalLink := PLC_HorizontalLinkMorph new.				"Lo agrego de submorph"		aLadderView addMorphBack: horizontalLink.				"Busco la conexion a la salida numero ind de connectableBlock"		connection := connectableBlock connectedAtOutput: ind.			"Lo agrego al diccionario elementos"		aLadderView elements at: horizontalLink put: connection.					"Lo agrego a la lista de seleccionados y le doy el foco del teclado"		aLadderView selectedAndKeyboardFocus: horizontalLink.				"Posiciono el Horizontal Link"		horizontalLink centeredToTheRight: ( self outputPins at: ind ).				"Actualizo su tamao"		horizontalLink extentChanged.						"Busco el bloque conectable conectado a la salida numero ind"		outputGraphicElement := self blockConnectedToOutput: ind.				"Dibujo los horizontal links de los elementos conectados a sus salidas"		outputGraphicElement drawHorizontalLinksFrom: aLadderView.				].! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 6/30/2013 05:26'!getFirstInputPinPosition	"Devuelve la posicin en pantalla del primer pin de entrada."		"^ self position."	^ self getPositionForInputPin: 1."Modificado el 30-6-2013"! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 6/30/2013 05:25'!getFirstOutputPinPosition	"Devuelve la posicin en pantalla del primer pin de salida."		"^ self topRight - ((self outputPins first extent x) @ 0). "	^ self getPositionForOutputPin: 1. "Modificado el 30-6-2013"! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 4/22/2013 01:19'!getPositionForInputPin: aPinNumber	"Obtiene la posicin del pin de entrada nmero aPinNumber."	^ (self inputPins at: aPinNumber) position.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 4/22/2013 01:19'!getPositionForOutputPin: aPinNumber	"Obtiene la posicin del pin de salida nmero aPinNumber."	^ (self outputPins at: aPinNumber) position.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'initialize-release' stamp: 'EricPernia 4/22/2013 01:17'!initialize	"Inicializaciones"	super initialize.	self inputPins: OrderedCollection new.	self outputPins: OrderedCollection new.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'accessing' stamp: 'EricPernia 4/22/2013 01:17'!inputPins	^ inputPins! !!PLC_GraphicElementWithPinsMorph methodsFor: 'accessing' stamp: 'EricPernia 4/22/2013 01:17'!inputPins: anObject	inputPins := anObject! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 4/22/2013 01:19'!minYDistanceBetweenPins	"Devuelve la distancia minima en pantalla en Y ente pines."		^ self properties scale y * self gridExtent y.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'accessing' stamp: 'EricPernia 4/22/2013 01:17'!outputPins	^ outputPins! !!PLC_GraphicElementWithPinsMorph methodsFor: 'accessing' stamp: 'EricPernia 4/22/2013 01:17'!outputPins: anObject	outputPins := anObject! !!PLC_GraphicElementWithPinsMorph methodsFor: 'draw elements' stamp: 'EricPernia 8/6/2013 23:46'!outputPinsSize	"Devuelve la cantidad de pines de salida"	^ self outputPins size.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 4/22/2013 01:19'!setPositionForInputPin: aPinNumber to: aPosition	"Establece la posicin del pin de entrada nmero aPinNumber en el valor  aPosition."		(self inputPins at: aPinNumber) position: aPosition.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'pins' stamp: 'EricPernia 4/22/2013 01:19'!setPositionForOutputPin: aPinNumber to: aPosition	"Establece la posicin del pin de salida nmero aPinNumber en el valor  aPosition."		(self outputPins at: aPinNumber) position: aPosition.! !!PLC_GraphicElementWithPinsMorph methodsFor: 'layout' stamp: 'EricPernia 4/22/2013 01:17'!xPositionedCascade: aBoolean	"Pone el flag xPosition al valor aBoolean de todos los elementos conectados a sus salidas y sus elementos hacen lo mismo."		| outputGraphicElement |		( 1 to: self outputPins size ) do: [ :ind |				outputGraphicElement := self blockConnectedToOutput: ind.				outputGraphicElement xPositioned: aBoolean.				outputGraphicElement xPositionedCascade: aBoolean.				].! !!PLC_LeftPowerRailMorph class methodsFor: 'instance creation' stamp: 'EricPernia 4/22/2013 16:45'!newFromElement: anElement	"Nueva isntancia a partir de un elemento de un bloque conectable"	| element num |		element := self new.		num := anElement connectableBlockOutputs.	num timesRepeat: [ element addOutputPin. ].		^ element.! !!PLC_LeftPowerRailMorph methodsFor: 'drawing' stamp: 'EricPernia 9/22/2012 01:54'!addInsertionPoint	"Aade un Punto de Insercion."	| insertionPoint penultimatePosition lastPosition  penultimate insertionPointCenter |	lastPosition := self outputPins last position + (0 @ 1).		self outputPins size - 1 >= 1 		ifTrue: [			penultimate := self outputPins at: self outputPins size - 1.			penultimatePosition := penultimate position + (0 @ penultimate extent y).			]		ifFalse: [			penultimatePosition := self position + (0 @ self extent y).			].		insertionPointCenter := (penultimatePosition - lastPosition) / 2.				insertionPoint := PLC_InsertionPointMorph new.	insertionPoint center: self center + insertionPointCenter.	self addMorph: insertionPoint.! !!PLC_LeftPowerRailMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 02:05'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self totalExtent.! !!PLC_LeftPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 4/22/2013 02:08'!backgroundRectanglePosition	"Devuelve la posicin en pantalla del backgroundRectangle relativa a position del elemento [px]."		^ self properties scale * ( 0 @ 0 ).! !!PLC_LeftPowerRailMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 02:05'!defaultExtent	"Tamao por defecto del elemento."		^ self properties scale * ( 8 @ ( self gridExtent y * 3 ) ).! !!PLC_LeftPowerRailMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 02:11'!drawElementOn: aCanvas	"Dibujo el rectangulo negro que representa al horizonta link."	aCanvas fillRectangle: self vBar color: self userInteractionStateLayer1 elementColor.! !!PLC_LeftPowerRailMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/9/2013 02:48'!exploreModel	"Explora todas sus salidas."	| newGroup |			"Por cada salida debo crear un Nuevo Grupo."		( 1 to: self outputPins size ) 		do: [ :ind |					"Creo un nuevo grupo misma altura de primer pin."			newGroup := PLC_GraphicElementGroup new.				"Lo aado a la coleccin groups del PLC_LadderView. Es una 			coleccin de gupos de primer pin."			self owner groups add: newGroup.				"Agrego todos los elementos serie de la rama conectada a la 			salida numero ind del LPR."			( self blockConnectedToOutput: ind ) addToGroup: newGroup.						].! !!PLC_LeftPowerRailMorph methodsFor: 'pins' stamp: 'EricPernia 4/28/2013 16:42'!firstPinYDistance	"Devuelve la distancia en pantalla en Y del primer pin de entrada 	y salida relativa a la posicion vertical de self .	Es la distancia vertical entre la parte de arriba del elemento y el primer pin."		^ self gridExtent y.! !!PLC_LeftPowerRailMorph methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 02:07'!isLeftPowerRail	"Devuelve true si el elemento grafico es una Barra derecha."	^ true.! !!PLC_LeftPowerRailMorph methodsFor: 'layout' stamp: 'EricPernia 4/22/2013 02:07'!layoutHorizontallyLeft: aDistanceX	"self se posiciona  de alguna manera con respecto a aDistanceX. 	self solo se mueve horizontalmente."		"Alineo el elemento al origen de la grilla."	self position: self gridOrigin - ( self layoutRectangle extent x @ 0).! !!PLC_LeftPowerRailMorph methodsFor: 'layout' stamp: 'EricPernia 6/30/2013 23:53'!layoutOn: aLadderView	"El elemento se posiciona dentro del ladderView."	"En este caso poriciona su layout area en el origen de la grilla. Luego posiciona todas sus salidas."		| outputGraphicElement |		"Posiciono el elemento con su layoutRectangle topRight en el origen de la grilla."	self position: self gridOrigin - ( self layoutRectangle extent x @ 0).		"Seteo los flags que indican que el elemento ya fue posicionado."	self xPositioned: true.	self yPositioned: true.		"Posiciono todos los elementos conectados a las salidas"	( 1 to: self outputPins size ) do: [ :ind |				"Busco el elemento grafico conectado a la salida numero ind"		outputGraphicElement := self blockConnectedToOutput: ind.				"Posiciono el elemento grafico hallado"		outputGraphicElement layoutOn: aLadderView from: self output: ind.				"Acomodo su pin de salida segun el elemento que acabo de posicionar."		self setPositionForOutputPin: ind to: ( self getFirstOutputPinPosition x @ outputGraphicElement getFirstInputPinPosition y ).		].		"Estiro el LPR al mayor tamao segn todos los elementos en el ladderView"	self extent: ( self extent x @ ( aLadderView bottomOfGraphicElementBelowOfAll - self gridOrigin y ) ).! !!PLC_LeftPowerRailMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 02:06'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		"En caso del LPR el tamao vertical del layoutRectangle debe ser del tamao vertical 	de la grilla  para que no moleste cuando est dentro un grupo de primer pin y le pida 	el layoutArea a dicho grupo. Molesta ya que me agranda el layoutRtangle del grupo 	verticalmente dificultando el posicionamiento."		^ ( self properties scale x * 4 ) @ self gridExtent y.! !!PLC_LeftPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 4/22/2013 02:08'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( 0 @ 0 ).! !!PLC_LeftPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 4/22/2013 02:08'!top: yPosition	"Establece la posicin vertical en pantalla del primer pin de entrada y salida a yPosition.	Antes: setFirstPinsVerticalPositionTo: yPosition"		"En el caso particular de la Barra Izquierda solo muevo el pin"	self setPositionForOutputPin: 1 to: ( self outputPins first position x @ yPosition).! !!PLC_LeftPowerRailMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 02:06'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self extent.! !!PLC_LeftPowerRailMorph methodsFor: 'connection states' stamp: 'EricPernia 7/6/2013 16:13'!updateOutputsConnectonStates	"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."		| outputGraphicElement |			"La primer salida va con el estado de conexion de capa 2 connectedToLeftPowerRailTroughFirstOutputPin"			"Busco el elemento grafico conectado a la salida numero 1"		outputGraphicElement := self blockConnectedToOutput: 1.				"Cambio el estado de conexion de capa 2 a connectedToLeftPowerRailTroughFirstOutputPin"		outputGraphicElement connectedToLeftPowerRailTroughFirstOutputPin.				"El estado de conexion de capa 1 es conectado a self en ambos casos"		outputGraphicElement connectedToLeftPowerRail.				"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."		outputGraphicElement updateOutputsConnectonStates.						"A partir de la segunda salida va con el estado de capa 2 notConnectedToLeftPowerRailTroughFirstOutputPinOrCoil"	( 2 to: self outputPins size ) do: [ :ind |				"Busco el elemento grafico conectado a la salida numero ind"		outputGraphicElement := self blockConnectedToOutput: ind.				"Cambio el estado de conexion de capa 2 a notConnectedToLeftPowerRailTroughFirstOutputPin"		outputGraphicElement notConnectedToLeftPowerRailTroughFirstOutputPin.				"El estado de conexion de capa 1 es conectado a self en ambos casos"		outputGraphicElement connectedToLeftPowerRail.				"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."		outputGraphicElement updateOutputsConnectonStates.		].	! !!PLC_LeftPowerRailMorph methodsFor: 'drawing' stamp: 'EricPernia 10/18/2012 15:38'!vBar	"Barra vertical que representa el right rail."	| width height vBar |	width := self properties scale y * 2.	height := self properties scale y * self bounds height.		vBar := Rectangle origin: (0@0) corner: ( width @ height ).		^ vBar align: vBar center with: self bounds center.! !!PLC_RightPowerRailMorph methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 02:02'!addToGroup: aGroup	"El elemento RPR se aade al grupo pasado como parmetro.	Aqu se corta la cadena de aadir al grupo."		aGroup add: self.! !!PLC_RightPowerRailMorph methodsFor: 'extent' stamp: 'EricPernia 4/27/2013 19:42'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self defaultExtent x @ ( self properties scale y * 14 ).! !!PLC_RightPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 4/22/2013 02:02'!backgroundRectanglePosition	"Devuelve la posicin en pantalla del backgroundRectangle relativa a position del elemento [px]."		^ self properties scale * ( 0 @ 2 ).! !!PLC_RightPowerRailMorph methodsFor: 'connection states' stamp: 'EricPernia 7/7/2013 20:50'!connectedToBlock 	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Bloque.	Define Tipo de dibujo ( -->> o --| ) y layoutRectanglePosition "	self connectionStateLayer1: PLC_GraphicElementState connectedToBlock .	self changed.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 05:46'!connectedToBlockDrawElementOn: aCanvas	"Dibuja el elemento grfico en este este estado de conexion."		self drawVBarOn: aCanvas.! !!PLC_RightPowerRailMorph methodsFor: 'connection states' stamp: 'EricPernia 7/7/2013 17:28'!connectedToCoil 	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Bobina.	Define Tipo de dibujo ( -->> o --| ) y layoutRectanglePosition "	self connectionStateLayer1: PLC_GraphicElementState connectedToCoil.	self changed.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 05:47'!connectedToCoilDrawElementOn: aCanvas	"Dibuja el elemento grfico en este este estado de conexion."		self drawVBarOn: aCanvas.! !!PLC_RightPowerRailMorph methodsFor: 'connection states' stamp: 'EricPernia 7/7/2013 02:25'!connectedToContact	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Contacto.	Define Tipo de dibujo ( -->> o --| ) y layoutRectanglePosition "	self connectionStateLayer1: PLC_GraphicElementState connectedToContact.	self changed.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/7/2013 05:48'!connectedToContactDrawElementOn: aCanvas	"Dibuja el elemento grfico en este este estado de conexion."		self drawDoubleArrowOn: aCanvas.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/13/2013 05:01'!connectedToContactLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self properties scale * ( ( self gridExtent x - 4 ) @ ( self gridExtent y * 2 ) ).! !!PLC_RightPowerRailMorph methodsFor: 'connection states' stamp: 'EricPernia 7/7/2013 02:24'!connectedToLeftPowerRail	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Barra Izquierda.	Define Tipo de dibujo ( -->> o --| ) y layoutRectanglePosition "	self connectionStateLayer1: PLC_GraphicElementState connectedToLeftPowerRail.	self changed.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/16/2013 14:30'!connectedToLeftPowerRailTroughFirstOutputPinDrawElementOn: aCanvas	"Dibuja el elemento grfico en este este estado de conexion."		self drawVBarOn: aCanvas.! !!PLC_RightPowerRailMorph methodsFor: 'extent' stamp: 'EricPernia 4/27/2013 03:44'!defaultExtent	"Tamao por defecto del elemento."		^ self properties scale * ( 15 @ self gridExtent y ).! !!PLC_RightPowerRailMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:38'!drawElementOn: aCanvas	"Dibujo el rectangulo negro que representa al horizonta link."	aCanvas fillRectangle: self hBar color: self userInteractionStateLayer1 elementColor.		self connectionStateLayer1 drawElementOn: aCanvas for: self.! !!PLC_RightPowerRailMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:39'!drawVBarOn: aCanvas.	"Dibuja la barra vertical del Riel Derecho conectado a contacto."		aCanvas fillRectangle: self vBar color: self userInteractionStateLayer1 elementColor.! !!PLC_RightPowerRailMorph methodsFor: 'drawing' stamp: 'EricPernia 5/28/2012 03:21'!hBar	"Barra horizontal que representa el cable de conexin con el right rail."	| width height hBar |	width := self properties scale x * self extent x.	height := self properties scale y * 2.		hBar := Rectangle origin: (0@0) corner: ( width @ height ).		^ hBar align: hBar center with: self bounds center.! !!PLC_RightPowerRailMorph methodsFor: 'initialize-release' stamp: 'EricPernia 7/14/2013 05:26'!initialize	"Inicializaciones del right rail."	super initialize.		"Agrego el pin de entrada"	self addInputPin.	"Lo hago invisible"	self submorphs do: [ :morph |		morph visible: false.		].		"Lo posiciono fuera del ladderView para que no moleste cuando	hago layout"	self position: self position - self layoutRectangle extent.	! !!PLC_RightPowerRailMorph methodsFor: 'model exploration' stamp: 'EricPernia 4/22/2013 02:02'!isRightPowerRail	"Devuelve true si el elemento grafico es un Right Power Rail."	^ true.! !!PLC_RightPowerRailMorph methodsFor: 'layout' stamp: 'EricPernia 4/27/2013 03:47'!layoutHorizontallyLeft: aDistanceX	"self se posiciona  de alguna manera con respecto a aDistanceX. 	self solo se mueve horizontalmente. Para lograrlo se lo pide a su	estado de conexion 2."		self connectionStateLayer2 layoutHorizontallyLeft: aDistanceX for: self.! !!PLC_RightPowerRailMorph methodsFor: 'layout' stamp: 'EricPernia 7/9/2013 03:23'!layoutOn: aLadderView from: aGraphicElement output: anOutputNumber	"El elemento se posiciona dentro del ladderView."	"Alineo Horizontalmente a este elemento grfico."	self layoutHorizontallyOn: aLadderView from: aGraphicElement output: anOutputNumber.		"Alineo Verticalmnete su grupo."	self layoutGroupVerticallyOn: aLadderView from: aGraphicElement output: anOutputNumber.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/16/2013 13:18'!layoutRectangleExtentConnectedToLeftPowerRailOutput1	"Devuelve el tamao en pixeles del layoutRectangle."		^ self properties scale * ( ( self gridExtent x - 4 ) @ ( self gridExtent y * 3 ) ).! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/14/2013 22:45'!layoutRectangleExtentNotConnectedToLeftPowerRailOutput1	"Devuelve el tamao en pixeles del layoutRectangle."		^ self voidLayoutRectangleExtent.! !!PLC_RightPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 7/7/2013 05:42'!layoutRectanglePositionConnectedToBlock	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px].	Cuando est conectado a Barra izquierda, Enlace Vertical o Bloque (F o FB)"		^ self properties scale * ( -32 @ 0 ).! !!PLC_RightPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 4/26/2013 12:38'!layoutRectanglePositionConnectedToContactOrCoil	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px].	Cuando est conectado a cotacto o Bobina"		^ self properties scale * ( 4 @ 0 ).! !!PLC_RightPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 4/28/2013 23:11'!layoutRectanglePositionConnectedToLeftPowerRail	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px].	Cuando est conectado a Barra izquierda, Enlace Vertical o Bloque (F o FB)"		^ self properties scale * ( -32 @ 0 ).! !!PLC_RightPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 5/6/2013 01:18'!layoutRectanglePositionConnectedToLeftPowerRailOutput1	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px].	Cuando est conectado a Barra izquierda, Enlace Vertical o Bloque (F o FB)"		^ self properties scale * ( -4 @ self gridExtent y ) negated.! !!PLC_RightPowerRailMorph methodsFor: 'connection states' stamp: 'EricPernia 7/7/2013 19:05'!leftConnectedToVerticalLink	"Cambia su estado de conexion (connection drawing layer) al estado conectado a Barra Izquierda.	Define Tipo de dibujo ( -->> o --| ) y layoutRectanglePosition "	self connectionStateLayer1: PLC_GraphicElementState leftConnectedToVerticalLink.	self changed.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/14/2013 05:04'!leftConnectedToVerticalLinkLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self properties scale * ( ( self gridExtent x - 8 ) @ ( self gridExtent y * 2 ) ).! !!PLC_RightPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 7/7/2013 19:06'!leftConnectedToVerticalLinkLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -28 @ 0 ).! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/16/2013 14:31'!notConnectedToLeftPowerRailTroughFirstOutputPinDrawElementOn: aCanvas	"Dibuja el elemento grfico en este este estado de conexion."		self drawDoubleArrowOn: aCanvas.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 5/2/2013 00:00'!removeElementFrom: aLadderView	"Remueve el elemento pidiendoselo a su ladder view. Hace un double dispatching con este"		aLadderView removeRightPowerRail: self.! !!PLC_RightPowerRailMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 01:59'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self defaultExtent.! !!PLC_RightPowerRailMorph methodsFor: 'connection states' stamp: 'EricPernia 4/27/2013 06:16'!updateInputConnectonStates	"Actualiza las capas de estado de conexion del elemento conectados a su entrada."		| inputGraphicElement |			"Busco el elemento grafico conectado a la entrada numero 1"	inputGraphicElement := self blockConnectedToInput: 1.			"El estado de conexion de capa 1 es conectado a self"	inputGraphicElement connectedToRightPowerRail.! !!PLC_RightPowerRailMorph methodsFor: 'connection states' stamp: 'EricPernia 7/7/2013 17:07'!updateOutputsConnectonStates	"Actualiza las capas de estado de conexion del elemento conectados a su salida."		"Actualiza las capas de estado de conexion de los elementos conectados a sus entradas."	self updateInputConnectonStates.! !!PLC_RightPowerRailMorph methodsFor: 'drawing' stamp: 'EricPernia 5/28/2012 03:21'!vBar	"Barra vertical que representa el right rail."	| width height vBar |	width := self properties scale x * 2.	height := self properties scale y * 6.		vBar := Rectangle origin: (0@0) corner: ( width @ height ).		^ vBar align: vBar rightCenter with: self bounds rightCenter.! !!PLC_RightPowerRailMorph methodsFor: 'commands recive from connection states' stamp: 'EricPernia 7/13/2013 04:56'!voidLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self properties scale * ( ( self gridExtent x - 4 ) @ ( self gridExtent y * 2 ) ).! !!PLC_RightPowerRailMorph methodsFor: 'position' stamp: 'EricPernia 7/7/2013 19:00'!voidLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -32 @ 0 ).! !!PLC_VerticalLinkMorph class methodsFor: 'instance creation' stamp: 'EricPernia 7/14/2013 05:28'!newFromElement: anElement	"Nueva isntancia a partir de un elemento de un bloque conectable"	| graphicElem num |	graphicElem := self new.			num := anElement connectableBlockInputs.	num timesRepeat: [ graphicElem addInputPin. ].		num := anElement connectableBlockOutputs.	num timesRepeat: [ graphicElem addOutputPin. ].		"Lo posiciono fuera del ladderView para que no moleste cuando	hago layout"	graphicElem position: graphicElem position - graphicElem layoutRectangle extent.		^ graphicElem.! !!PLC_VerticalLinkMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/9/2013 17:10'!addToGroup: aGroup	"Chequea si fue explorado, si es as no hace nada.	Si nunca fue explorado explora todas sus salidas."	| newGroup |			( self owner wasExplored: self )		ifFalse: [					"Se aade al grupo pasado como parmetro."			aGroup add: self.			"Aado al nuevo grupo todos los elementos de la rama serie a la 			primer salida del VL."			( self blockConnectedToOutput: 1 ) addToGroup: aGroup.						"Si tiene ms de una salida debo crear un Nuevo Grupo por cada una."				( 2 to: self outputPins size ) 				do: [ :ind |									"Creo un nuevo grupo."					newGroup := PLC_GraphicElementGroup new.						"Lo aado a la coleccin groups del PLC_LadderView."					self owner groups add: newGroup.										"Agrego todos los elementos de salida correspondientes a ese grupo."					( self blockConnectedToOutput: ind ) addToGroup: newGroup.					].			].! !!PLC_VerticalLinkMorph methodsFor: 'extent' stamp: 'EricPernia 4/25/2013 01:52'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self totalExtent x @ ( self totalExtent y - 4 ).! !!PLC_VerticalLinkMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 18:52'!defaultExtent	"Tamao por defecto del elemento."		^ self properties scale * ( 8 @ ( self gridExtent y * 3 ) ).! !!PLC_VerticalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 02:12'!drawElementOn: aCanvas	"Dibujo el rectangulo negro que representa al horizonta link."	aCanvas fillRectangle: self vBar color: self userInteractionStateLayer1 elementColor.! !!PLC_VerticalLinkMorph methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 19:47'!layoutHorizontallyLeft: aDistanceX	"self se posiciona  de alguna manera con respecto a aDistanceX. 	self solo se mueve horizontalmente."		"Como el VL arranca en (0@0) y nunca va a volver hacia la izquierda puedo siempre 	volver a alinearlo pero tengo que chequear que la nueva posicion en X sea mayor 	que la anterior as no piso a nadie."	| oldLeft |	oldLeft := self left.		"Alineo el elemento a aDistanceX."	self layoutLeft: aDistanceX.	"Si la nueva posicion horizontal es menor a la que tenia entonces lo vuelvo a correr."	self left < oldLeft		ifTrue: [			self left: oldLeft.			].! !!PLC_VerticalLinkMorph methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 19:08'!layoutHorizontallyOn: aLadderView from: aGraphicElement	"Posiciono Horizontalmente el VL."		| oldPosition maxRightGroup |			"Guardo la vieja posicion del enlace Vertical"	oldPosition := self position.				"Posiciono el VL Horizontalmente a la derecha del layoutRectangle del elemento 	que le envio este mensaje".	self layoutHorizontallyLeft: aGraphicElement layoutRectangle right.			"Posiciono Verticalemente los pines de entrada del VL y lo estiro al mayor tamao 	segn todos los elementos conectados a sus entradas.	Esto lo necesito para saber si pisa a algun grupo luego de posicionar horizontalmente."	self layoutVerticallyInputPins.		"Chequeo si el VL no pisa a algun grupo que no sea su propio grupo horizontalmente. 	Si pisa lo muevo otra vez. As en un loop hasta que no pise a nadie."	( aLadderView gotAGroupHorizontallyUnderElement: self )		ifTrue: [			"Busco el grupo con mayor layoutRectangle right pisado por el VL"			maxRightGroup :=  aLadderView maxRightGroupUnderElement: self.					"Posiciono el VL Horizontalmente a la derecha del layoutRectangle del 			grupo hallado".			maxRightGroup ifNotNil: [				self layoutHorizontallyLeft: maxRightGroup layoutRectangle right.				].			].			"Si cambio su posicion horizontal entonces debo reposicionar Horizontalmente los 	elementos conectados a sus salida. Para esto, borro los flags de las ramas serie a	partir de sus salidas. Esto causa que se posicionen horizontalmente cuando les 	llegue el turno de posicionarse."	"( oldPosition >= self position )		ifFalse: ["			self xPositionedCascade: false.			"]."		! !!PLC_VerticalLinkMorph methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 18:18'!layoutOn: aLadderView from: aGraphicElement output: anOutputNumber	"El elemento se posiciona dentro del ladderView."	"En este caso solo se corre horizontalmente a la derecha	de los elementos anteriores. Luego posiciona todas sus salidas."		"Posiciono Horizontalmente el VL."	self layoutHorizontallyOn: aLadderView from: aGraphicElement.	"Posiciono todos los elementos conectados a sus salidas si ya 	estn posicionadas todas sus entradas."	self layoutOutputsOn: aLadderView.! !!PLC_VerticalLinkMorph methodsFor: 'layout' stamp: 'EricPernia 3/13/2016 22:36'!layoutOutputsOn: aLadderView	"Posiciono todos los elementos conectados a sus salidas si ya estn posicionados 	todos los elementos conectados a sus entradas."		| xPositionedInputs inputGraphicElement outputGraphicElement 	  mostButtomInputPin mostButtomOutputPin |	"Chequeo que se hayan posicionado todos los elementos conectados a sus entradas.	Si esto no ocurre entonces no puedo posicionar los elementos conectados a sus salidas."	xPositionedInputs := true.	( 1 to: self inputPins size ) do: [ :ind |		"Busco el elemento grafico conectado a la entrada numero ind"		inputGraphicElement := self blockConnectedToInput: ind.		"Chequeo el xPositioned del elemento hallado"		xPositionedInputs := inputGraphicElement xPositioned and: [ xPositionedInputs ].		].		"Si ya posicion todos los elementos conectados a sus entradas, 	entonces posiciona todos los elementos conectados a sus salidas."	xPositionedInputs ifTrue: [							"Posiciono todos los elementos conectados a sus salidas."		( 1 to: self outputPins size ) do: [ :ind |					"Busco el elemento grafico conectado a la salida numero ind"			outputGraphicElement := self blockConnectedToOutput: ind.					"Posiciono el elemento grafico hallado"			outputGraphicElement layoutOn: aLadderView from: self output: ind.					"Acomodo su pin de salida segun el elemento que acabo de posicionar."			self setPositionForOutputPin: ind to: ( 				self getFirstOutputPinPosition x @ 					outputGraphicElement getFirstInputPinPosition y 				).			].			"Estiro el VL al mayor tamao segn todos los elementos conectados a sus entradas y salidas."		mostButtomInputPin := self inputPins max: [ :e | e bottom	].		mostButtomOutputPin := self outputPins max: [ :e | e bottom ].		self extent: (			self extent x @ (				( mostButtomInputPin max: mostButtomOutputPin ) - self position y 				) 			).						].! !!PLC_VerticalLinkMorph methodsFor: 'extent' stamp: 'EricPernia 7/7/2013 20:12'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		"En caso del Enlace Vertical el tamao vertical del layoutRectangle debe ser del tamao vertical 	de la grilla  para que no moleste cuando est dentro un grupo de primer pin y le pida 	el layoutArea a dicho grupo. Molesta ya que me agranda el layoutRtangle del grupo 	verticalmente dificultando el posicionamiento."	^ self extent.! !!PLC_VerticalLinkMorph methodsFor: 'layout' stamp: 'EricPernia 7/7/2013 20:14'!layoutRectangleForGroup	"Devuelve el rectngulo para acomodar en pantalla los elementos 	entre si que usan los grupos azules."	| origin corner |		origin := self layoutRectangle topLeft.	corner := origin + ( self defaultExtent x @ ( self properties scale y * self gridExtent y ) ).		^ Rectangle origin: origin corner: corner.! !!PLC_VerticalLinkMorph methodsFor: 'position' stamp: 'EricPernia 7/7/2013 19:38'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ 0 @ 0.! !!PLC_VerticalLinkMorph methodsFor: 'layout' stamp: 'EricPernia 7/14/2013 18:06'!layoutVerticallyInputPins	"Posiciono Verticalmente los pines de entrada del VL."		| inputGraphicElement |			"Posiciono todos los pines de entrada Verticalmente.	Esto lo necesito para saber si pisa a algun grupo luego de posicionar horizontalmente ademas 	de para acomodar los pines.."	( 1 to: self inputPins size ) do: [ :ind |				"Busco el elemento grafico conectado a la entrada numero ind"		inputGraphicElement := self blockConnectedToInput: ind.					"Acomodo su pin de entrada segun el elemento que acabo de hallar."		self setPositionForInputPin: ind to: ( self getFirstInputPinPosition x @ inputGraphicElement getFirstOutputPinPosition y ).		].			"Estiro el VL al mayor tamao segn todos los elementos conectados a sus entradas.	Esto lo necesito para saber si pisa a algun grupo luego de posicionar horizontalmente."	self extent: ( self extent x @ ( self inputPins last bottom - self position y ) ).	! !!PLC_VerticalLinkMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 18:52'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self extent.	! !!PLC_VerticalLinkMorph methodsFor: 'connection states' stamp: 'EricPernia 7/7/2013 18:38'!updateInputConnectonStates	"Actualiza las capas de estado de conexion del elemento conectados a su entrada."		| inputGraphicElement |				"Cambio los estados de conexion de capa 1 de todas sus entradas a conectado a self"	( 1 to: self inputPins size ) do: [ :ind |				"Busco el elemento grafico conectado a la salida numero ind"		inputGraphicElement := self blockConnectedToInput: ind.				"El estado de conexion de capa 1 es conectado a self en ambos casos"		inputGraphicElement rightConnectedToVerticalLink.		].! !!PLC_VerticalLinkMorph methodsFor: 'connection states' stamp: 'EricPernia 7/7/2013 17:06'!updateOutputsConnectonStates	"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."		| outputGraphicElement |		"Actualiza las capas de estado de conexion de los elementos conectados a sus entradas."	self updateInputConnectonStates.			"Busco el elemento grafico conectado a la salida numero 1"	outputGraphicElement := self blockConnectedToOutput: 1.		"Cambio el estado de conexion de capa 2 al que traiga el elemento actual"	outputGraphicElement connectionStateLayer2: self connectionStateLayer2.	outputGraphicElement changed.			"Cambio los estados de conexion de capa 1 de todas sus salidas a conectado a self"	( 1 to: self outputPins size ) do: [ :ind |				"Busco el elemento grafico conectado a la salida numero ind"		outputGraphicElement := self blockConnectedToOutput: ind.				"El estado de conexion de capa 1 es conectado a self en ambos casos"		outputGraphicElement leftConnectedToVerticalLink.			"Actualiza las capas de estado de conexion de los elementos conectados a sus salidas."		outputGraphicElement updateOutputsConnectonStates.		].! !!PLC_VerticalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 4/22/2013 18:50'!vBar	"Barra vertical que representa el right rail."	| width height vBar |	width := self properties scale y * 2.	height := self properties scale y * ( self bounds height - 16 ).		vBar := Rectangle origin: (0@0) corner: ( width @ height ).		^ vBar align: vBar center with: self bounds center.! !!PLC_HorizontalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 5/22/2012 18:56'!backgroundRectangle	"Fondo del elemento."	| width height backgroundRectangle |	width := self properties scale y * self bounds width.	height := self properties scale y * 8.		backgroundRectangle := Rectangle origin: (0@0) corner: ( width @ height ).		^ backgroundRectangle align: backgroundRectangle center with: self bounds center.! !!PLC_HorizontalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2012 15:59'!defaultExtent	"Tamao por defecto del horizontal link."	^ self properties scale * (24 @ 18).! !!PLC_HorizontalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 4/29/2013 13:58'!drawElementOn: aCanvas	"Dibujo el rectangulo negro que representa al horizonta link."	aCanvas fillRectangle: self hBar color: self userInteractionStateLayer1 elementColor.! !!PLC_HorizontalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 4/30/2013 01:53'!extentBetweenElements	"Tamao del horizontal link segn a lo que este conectado."	| outputGraphicElement inputGraphicElement |	inputGraphicElement := self connectedAtInput: 1.	outputGraphicElement := self connectedAtOutput: 1.			( inputGraphicElement isNil or: [ outputGraphicElement isNil] ) 		ifTrue: [ 			^ self defaultExtent			]		ifFalse: [ 			^ ( outputGraphicElement left - inputGraphicElement right) @ self defaultExtent y.			]	! !!PLC_HorizontalLinkMorph methodsFor: 'other events' stamp: 'EricPernia 5/30/2012 22:51'!extentChanged	"Actualiza el tamao de la Conexion Horizontal."	self extent: self extentBetweenElements.! !!PLC_HorizontalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 6/1/2012 16:49'!hBar	"Barra horizontal que representa el cable de conexin entre 2 elementos."	| width height hBar |	width := self properties scale y * self bounds width.	height := self properties scale y * 2.		hBar := Rectangle origin: (0@0) corner: ( width @ height ).		^ hBar align: hBar center with: self bounds center.! !!PLC_HorizontalLinkMorph methodsFor: 'initialize-release' stamp: 'EricPernia 6/1/2012 16:38'!initialize	"Inicializaciones del horizontal link."	| insertionPoint |	super initialize.		self extent: self defaultExtent.		insertionPoint := PLC_InsertionPointMorph new.		insertionPoint center: self insertionPointCenter.		self addMorph: insertionPoint;		openInWorld.! !!PLC_HorizontalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2012 16:00'!insertionPointCenter	"Devuelve el punto del centro del rectangulo del punto de insercin 	que no coincide siempre con el centro del area de drop."	^ self center.! !!PLC_HorizontalLinkMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2012 17:30'!insertionPointDropAreaExtent	"Tamao del area de drop del insertion point de un Vertical link u horizontal link."	^ self properties scale * ( 52 @ 24 ) .! !!PLC_HorizontalLinkMorph methodsFor: 'extent' stamp: 'EricPernia 6/30/2013 04:50'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent.! !!PLC_HorizontalLinkMorph methodsFor: 'position' stamp: 'EricPernia 7/7/2013 05:57'!layoutRectanglePosition	"Posicion relativa del layoutRectangle"		^ 0 @ 0! !!PLC_HorizontalLinkMorph methodsFor: 'commands recive from ladder view' stamp: 'EricPernia 5/1/2013 23:32'!openBranchOnConnectionFrom: aLadderView	"Si el elemento grafico es un Horizontal Link abre una rama en la conexion. Si no, no hace nada"		aLadderView openBranchOnConnection: self.! !!PLC_PinBlockMorph methodsFor: 'extent' stamp: 'EricPernia 5/1/2013 14:51'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ ( self totalExtent x @ (self properties scale y * 14) ).! !!PLC_PinBlockMorph methodsFor: 'drawing' stamp: 'EricPernia 5/1/2013 14:51'!drawElementOn: aCanvas	"Dibuja el palito horizontal del pin"	aCanvas fillRectangle: self hBar color: self userInteractionStateLayer1 elementColor.! !!PLC_PinBlockMorph methodsFor: 'drawing' stamp: 'EricPernia 5/1/2013 14:51'!hBar	"Barra horizontal que representa el cable de conexin del pin."	| width height hBar |	width := self properties scale x * self extent x.	height := self properties scale y * 2.		hBar := Rectangle origin: (0@0) corner: ( width @ height ).		^ hBar align: hBar center with: self bounds center.! !!PLC_PinBlockMorph methodsFor: 'initialize-release' stamp: 'EricPernia 5/1/2013 14:51'!initialize	"comment stating purpose of message"	super initialize.		self extentChanged;		openInWorld.	! !!PLC_PinBlockMorph methodsFor: 'extent' stamp: 'EricPernia 5/1/2013 14:51'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self totalExtent.! !!PLC_PinBlockMorph methodsFor: 'position' stamp: 'EricPernia 7/6/2013 01:56'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ 0 @ 0.! !!PLC_PinBlockMorph methodsFor: 'connection states layer 2' stamp: 'EricPernia 7/6/2013 16:20'!pinFallingEdge	"Cambia su estado de conexion de capa 2"		self connectionStateLayer2: PLC_GraphicElementState pinFallingEdge.	self changed.! !!PLC_PinBlockMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/6/2013 16:20'!pinFromBooleanFormalParameter	"Cambia su estado de conexion de capa 1 al estado conectado a a variable booleana. 	Se pone negro"			self connectionStateLayer1: PLC_GraphicElementState pinFromBooleanFormalParameter.	self changed.! !!PLC_PinBlockMorph methodsFor: 'connection states layer 1' stamp: 'EricPernia 7/6/2013 16:19'!pinFromNotBooleanFormalParameter	"Cambia su estado de conexion de capa 1 al estado conectado a a variable no booleana. 	Se pone dorado"		self connectionStateLayer1: PLC_GraphicElementState pinFromNotBooleanFormalParameter.	self changed.! !!PLC_PinBlockMorph methodsFor: 'connection states layer 2' stamp: 'EricPernia 7/6/2013 16:21'!pinNegated	"Cambia su estado de conexion de capa 2"		self connectionStateLayer2: PLC_GraphicElementState pinNegated.	self changed.! !!PLC_PinBlockMorph methodsFor: 'connection states layer 2' stamp: 'EricPernia 7/6/2013 16:20'!pinNormal	"Cambia su estado de conexion de capa 2"		self connectionStateLayer2: PLC_GraphicElementState pinNormal.	self changed.! !!PLC_PinBlockMorph methodsFor: 'connection states layer 2' stamp: 'EricPernia 7/6/2013 16:18'!pinRisingEdge	"Cambia su estado de conexion de capa 2"		self connectionStateLayer2: PLC_GraphicElementState pinRisingEdge.	self changed.! !!PLC_PinBlockMorph methodsFor: 'extent' stamp: 'EricPernia 5/1/2013 14:56'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self properties scale * ( 6 @ self defaultExtent y ).! !!PLC_PinMorph methodsFor: 'drawing' stamp: 'EricPernia 5/1/2013 14:55'!drawBackgroundOn: aCanvas	"Dibuja el fondo del pin. En este caso no hace nada.	Es para arreglar el error grafico de los elementos como contactos, LPR y VL"		! !!PLC_PinMorph methodsFor: 'extent' stamp: 'EricPernia 5/1/2013 14:56'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self properties scale * ( 3 @ self defaultExtent y ).! !!PLC_BlockNameMorph methodsFor: 'drawing' stamp: 'EricPernia 6/26/2013 01:37'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		"aCanvas 		fillRectangle: self backgroundRectangle 		color: self drawingLayer1 blockFootAndHeaderColor."! !!PLC_BlockNameMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 01:47'!elementDoubleWidth	"Doble ancho del elemento"	^ self properties scale x * 180.! !!PLC_BlockNameMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 01:47'!elementWidth	"Ancho estandar del elemento"	^ self properties scale x * 84.! !!PLC_BlockNameMorph methodsFor: 'event handling' stamp: 'EricPernia 6/26/2013 01:36'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^false.! !!PLC_BlockNameMorph methodsFor: 'initialize-release' stamp: 'EricPernia 6/26/2013 02:26'!initialize	"comment stating purpose of message"	super initialize.	text := 'BLOCK'.! !!PLC_BlockNameMorph methodsFor: 'extent' stamp: 'EricPernia 6/29/2013 18:21'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent.! !!PLC_BlockNameMorph methodsFor: 'position' stamp: 'EricPernia 6/29/2013 18:23'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ ( 0 @ 0 ).! !!PLC_BlockNameMorph methodsFor: 'margin' stamp: 'EricPernia 6/26/2013 01:40'!leftMargin	"Retorna el margen izquierdo del texto con respecto al elemento."		^ self properties scale x * 4.! !!PLC_BlockNameMorph methodsFor: 'margin' stamp: 'EricPernia 6/26/2013 01:40'!rightMargin	"Retorna el margen derecho del texto con respecto al elemento."		^ self properties scale x * 4.! !!PLC_ButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:44'!action		^ action! !!PLC_ButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:44'!action: anObject		action := anObject! !!PLC_ButtonMorph methodsFor: 'event handling'!handlesMouseDown: anEvent	"Permite manejar el evento de cuando el usuatio clickea el mouse sobre el morph."	^ true.! !!PLC_ButtonMorph methodsFor: 'event handling'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^true.! !!PLC_ButtonMorph methodsFor: 'mouse events'!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			self objetive ifNotNil: [		self objetive perform: self action.	]! !!PLC_ButtonMorph methodsFor: 'mouse events'!leftDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."! !!PLC_ButtonMorph methodsFor: 'mouse events'!leftDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!PLC_ButtonMorph methodsFor: 'event handling'!mouseDown: anEvent	"Manejador del evento mouse down"	"Do nothing upon mouse-down except inform the hand to watch for a double-click; wait until an 	ensuing click:, doubleClick:, or drag: message gets dispatched"	"Note that mouseMove: and mouseUp: events are not sent to aMorph until it becomes the mouse focus,	which is typically done by aMorph in its click:, doubleClick:, or drag: methods."		anEvent redButtonPressed "click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#leftClick:. #leftDoubleClick:. #leftDoubleClickTimeout:. #startDrag:.}				threshold: 5.								].				anEvent yellowButtonPressed "action-click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#rightClick:. #rightDoubleClick:. #rightDoubleClickTimeout:. nil.}				threshold: 5.			].! !!PLC_ButtonMorph methodsFor: 'event handling'!mouseEnter: anEvent	"Manejador del evento mouse enter. Este mensaje se le envia al 	morph cuando el puntero del mouse empieza a pasar por el."	self mouseOver.! !!PLC_ButtonMorph methodsFor: 'event handling'!mouseLeave: anEvent	"Manejador del evento mouse leave. Este mensaje se le envia al 	morph cuando el puntero del mouse deja de pasarpor el."	self mouseOut.! !!PLC_ButtonMorph methodsFor: 'event handling'!mouseUp: anEvent	"Manejador del evento mouse up"		! !!PLC_ButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:44'!objetive		^ objetive! !!PLC_ButtonMorph methodsFor: 'accessing' stamp: 'EricPernia 4/27/2015 00:44'!objetive: anObject		objetive := anObject! !!PLC_ButtonMorph methodsFor: 'mouse events'!rightClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."! !!PLC_ButtonMorph methodsFor: 'mouse events'!rightDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."	! !!PLC_ButtonMorph methodsFor: 'mouse events'!rightDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!PLC_ButtonMorph methodsFor: 'mouse events'!startDrag: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(startDrag) sent when the mouse moves more than threshold pixels from evt's position within DoubleClickTime."			anEvent hand grabMorph: self! !!PLC_ActualArgumentMorph methodsFor: 'model exploration' stamp: 'EricPernia 7/9/2013 17:13'!addToGroup: aGroup	"El elemento Actual Argument se aade al grupo pasado como parmetro.	Aqu se corta la cadena de aadir al grupo."		aGroup add: self.! !!PLC_ActualArgumentMorph methodsFor: 'extent' stamp: 'EricPernia 7/6/2013 01:07'!centerLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle	cuado tiene alineacin centrada."		^ self extent.! !!PLC_ActualArgumentMorph methodsFor: 'position' stamp: 'EricPernia 7/6/2013 00:35'!centerLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]	cuado tiene alineacin centrada."		^ 0 @ 0.! !!PLC_ActualArgumentMorph methodsFor: 'layout' stamp: 'EricPernia 7/9/2013 16:57'!layoutOn: aLadderView from: aGraphicElement output: anOutputNumber	"El elemento se posiciona dentro del ladderView."	"Alineo Horizontalmente a este elemento grfico."	self layoutHorizontallyOn: aLadderView from: aGraphicElement output: anOutputNumber.		"Alineo Verticalmnete su grupo."	self layoutGroupVerticallyOn: aLadderView from: aGraphicElement output: anOutputNumber.! !!PLC_ActualArgumentMorph methodsFor: 'extent' stamp: 'EricPernia 7/6/2013 00:32'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle.	Se lo pide a su estado de alineacin"		^ self textAlign layoutRectangleExtentFor: self.! !!PLC_ActualArgumentMorph methodsFor: 'position' stamp: 'EricPernia 7/6/2013 00:32'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px].	Se lo pide a su estado de alineacin"		^ self textAlign layoutRectanglePositionFor: self.! !!PLC_ActualArgumentMorph methodsFor: 'extent' stamp: 'EricPernia 7/6/2013 01:06'!leftLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle	cuado tiene alineacin izquierda."		^ self extent + (self properties scale * ( 4 @ 0 ) ).! !!PLC_ActualArgumentMorph methodsFor: 'position' stamp: 'EricPernia 7/10/2013 02:34'!leftLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]	cuado tiene alineacin izquierda."		^ self properties scale * ( -4 @ 0 ).! !!PLC_ActualArgumentMorph methodsFor: 'draw elements' stamp: 'EricPernia 8/6/2013 23:48'!outputPinsSize	"Devuelve la cantidad de pines de salida. Es un mensaje para que no 	tire error al dibujar la vista ladder intentando dibujar las salidas de 	un elemento que no tiene. FEOOO MEJORARR"	^ 0.! !!PLC_ActualArgumentMorph methodsFor: 'extent' stamp: 'EricPernia 7/6/2013 01:06'!rightLayoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle	cuado tiene alineacin derecha."		^ self extent + (self properties scale * ( 4 @ 0 ) ).! !!PLC_ActualArgumentMorph methodsFor: 'position' stamp: 'EricPernia 7/6/2013 00:38'!rightLayoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]	cuado tiene alineacin derecha."		^ 0 @ 0.! !!PLC_ActualArgumentMorph methodsFor: 'drawing' stamp: 'CarlosLombardi 10/29/2016 11:25'!textColor	"the color in which the text of this morph, i.e. the identifier	 of my model, must be written.	 Redefined in order to handle error arguments"	| standardColor errorColor |	standardColor := super textColor.	errorColor := (standardColor = Color white) 		ifTrue: [ Color orange ] 		ifFalse: [ Color red ] .	^(self element notNil and: [ self element actualArgument isError ])		ifTrue: [ errorColor ]		ifFalse: [ standardColor ]! !!PLC_ActualArgumentMorph methodsFor: 'layout' stamp: 'EricPernia 8/25/2013 18:42'!xPositionedCascade: aBoolean	"Pone el flag xPosition al valor aBoolean de todos los elementos conectados a sus salidas y sus elementos hacen lo mismo."		"No hace nada. Es por polimorfismo.  Para que no se tilde con las variables de salida de los bloques."! !!PLC_CellMorph methodsFor: 'extent' stamp: 'EricPernia 8/7/2013 02:42'!backgroundRectangleExtent	"Tamao por defecto"		^ self extent.! !!PLC_CellMorph methodsFor: 'position' stamp: 'EricPernia 8/7/2013 02:43'!backgroundRectanglePosition	"Tamao por defecto"		^ 0@0.! !!PLC_CellMorph methodsFor: 'extent' stamp: 'EricPernia 8/7/2013 02:41'!defaultExtent	"Tamao por defecto"		^ self properties scale * ( 96 @ 18 ).! !!PLC_CellMorph methodsFor: 'extent' stamp: 'EricPernia 4/27/2015 20:18'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self textWidth @ self defaultExtent y.! !!PLC_EditableTagMorph class methodsFor: 'instance creation' stamp: 'EricPernia 5/2/2015 02:24'!newWithText: aString andContainer: aContainer	"Nuevo con texto asString y contenedor aContainer 	(un objeto al que le avisa que cambio su texto)"	| graphicElem |		graphicElem := self newWithText: aString.		graphicElem container: aContainer.		^ graphicElem.! !!PLC_EditableTagMorph methodsFor: 'closeButton' stamp: 'EricPernia 4/28/2015 17:04'!buildCloseButton	"comment stating purpose of message"		closeButton := PLC_ImageButtonMorph closeButtonWithObjetive: self.	self addMorphFront: closeButton.		"imageButtonMorph comeToFront."		closeButton position: self position - (closeButton extent / 2 ).		^ closeButton.! !!PLC_EditableTagMorph methodsFor: 'pluggableTextMorph' stamp: 'EricPernia 4/28/2015 16:45'!buildPluggableTextMorph	"Construye el PluggableTextMorph, que por defecto esta oculto."	pluggableTextMorph := (PluggableTextMorph		on: self		text: #text		accept: #textChanged:).			pluggableTextMorph extent: self pluggableTextMorphExtent;		borderWidth: 1;		color: Color white;		"hasUnacceptedEdits: true;"		acceptOnCR: true;		acceptOnFocusChange: true;		"autoAccept: true;"		"setNameTo: #pluggableTextTag;"		openInWorld.			"Posiciono el pluggableTextMorph"	"pluggableTextMorph position: self positionInWorld. "	pluggableTextMorph position: self position. 			"Pongo el pluggableTextMorph sobre todas las ventanas"		"self currentWorld addMorphFront: pluggableTextMorph."		"Agrego el pluggableTextMorph de submorph para que se 	arrastre con la ventana y se ponga adelante."	"self owner 		ifNil: [ "			self addMorphFront: pluggableTextMorph.		"]			ifNotNil: [ 			self owner addMorphFront: pluggableTextMorph.		]."		^ pluggableTextMorph.! !!PLC_EditableTagMorph methodsFor: 'other events' stamp: 'EricPernia 4/28/2015 16:55'!changeFunction	"Estado changeFunction."	"Creo y cambio el texto del pluggableTextMorph al del Morph"	self pluggableTextMorph changeText: self text.	"Selecciono todo el texto del pluggableTextMorph"	self pluggableTextMorph selectAll.		"Creo el closeButton"	self closeButton.	! !!PLC_EditableTagMorph methodsFor: 'other events' stamp: 'EricPernia 4/28/2015 16:55'!changeFunction: anEvent	"Estado changeFunction."	self changeFunction.		" Le doy el foco del teclado al pluggableTextMorph"		anEvent hand newKeyboardFocus: self pluggableTextMorph.! !!PLC_EditableTagMorph methodsFor: 'closeButton' stamp: 'EricPernia 5/2/2015 06:36'!close	"Evento que se da al tocar el boton de cerrar"		"Elimino el boton de close"	self deleteCloseButton.		"Elimino el PluggableTextMorph"	self deletePluggableTextMorph.	! !!PLC_EditableTagMorph methodsFor: 'closeButton' stamp: 'EricPernia 4/28/2015 16:52'!closeButton	"Retorna el closeButton"	closeButton 		ifNil: [ ^ self buildCloseButton ] 		ifNotNil:  [ ^ closeButton ]. ! !!PLC_EditableTagMorph methodsFor: 'accessing' stamp: 'EricPernia 4/26/2015 17:59'!container		^ container! !!PLC_EditableTagMorph methodsFor: 'accessing' stamp: 'EricPernia 4/26/2015 17:59'!container: anObject		container := anObject! !!PLC_EditableTagMorph methodsFor: 'closeButton' stamp: 'EricPernia 4/28/2015 17:03'!deleteCloseButton	"Elimino el closeButton desreferenciandolo de todo."		self closeButton delete. 		closeButton := nil.! !!PLC_EditableTagMorph methodsFor: 'pluggableTextMorph' stamp: 'EricPernia 4/26/2015 19:26'!deletePluggableTextMorph	"Elimino el PluggableTextMorph desreferenciandolo de todo."	"self pluggableTextMorph visible: false.  "		self pluggableTextMorph delete.  		pluggableTextMorph := nil.! !!PLC_EditableTagMorph methodsFor: 'extent' stamp: 'EricPernia 8/7/2013 02:39'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent.! !!PLC_EditableTagMorph methodsFor: 'position' stamp: 'EricPernia 8/7/2013 02:39'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ 0 @ 0.! !!PLC_EditableTagMorph methodsFor: 'other events' stamp: 'EricPernia 4/26/2015 21:20'!lostKeyboardFocus	"Evento que ejecuta el Morph cuando pierde el foco del teclado"	"Transcript open.	Transcript show: 'Hola'."! !!PLC_EditableTagMorph methodsFor: 'pluggableTextMorph' stamp: 'EricPernia 4/26/2015 16:52'!pluggableTextMorph	"Retorna el pluggableTextMorph que es el nico submorph del ActualArgumentMorph"	pluggableTextMorph 		ifNil: [ ^ self buildPluggableTextMorph ] 		ifNotNil:  [ ^ pluggableTextMorph ]. ! !!PLC_EditableTagMorph methodsFor: 'pluggableTextMorph' stamp: 'EricPernia 4/26/2015 17:29'!pluggableTextMorphExtent	"Devuelve el tamao para setear al PluggableTextMorph"	(self totalExtent y < 44) 		ifTrue: [ ^ (self totalExtent x + 14) @ 44 ]		ifFalse:  [ ^ self totalExtent + (14@0) ]		"14 es el ancho del scrollbar y 44 el alto cuando aparece, esto podria mejorarse"! !!PLC_EditableTagMorph methodsFor: 'pluggableTextMorph' stamp: 'EricPernia 4/27/2015 15:27'!submorphsPerform: aSelector	"Actualiza el estado de los submorphs."		! !!PLC_EditableTagMorph methodsFor: 'change text' stamp: 'EricPernia 5/2/2015 06:42'!textChanged: aText	"Evento que se da al cambiar el texto del PluggableTextMorph de un EditableTagMorph."		"Si closeButton es nil significa que se presiono el boton cerrar y no 	importa lo si esta editado o no no quiero aceptar el texto del 	pluggableTextMorph."	closeButton ifNil: [ ^ self text. ]. 			"container es es un ladderView o PLC_Grid"	self container 		ifNil: [			"Cambio el texto si no tiene container asociado"			self text: aText asString.		]		ifNotNil: [			"Como tiene container delego el cambio de texto"							self container textChangedIn: self by: aText asString.		].			"Elimino el PluggableTextMorph y el closeButton"	self close.! !!PLC_FormalParameterMorph methodsFor: 'drawing' stamp: 'EricPernia 5/22/2013 12:47'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		aCanvas 		"fillRectangle: self backgroundRectangle 		color: self userInteractionLayer1 blockBodyColor;"				fillRectangle: self underline		fillStyle: ( self textAlign 			underlineStyleWithColor: self userInteractionStateLayer1 blockBodyColor			andOrigin: self position			andDirection: self extent x @ 0 ). ! !!PLC_FormalParameterMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 01:48'!elementDoubleWidth	"Doble ancho del elemento"	^ self properties scale x * 90.! !!PLC_FormalParameterMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 01:48'!elementWidth	"Ancho estandar del elemento"	^ self properties scale x * 42.! !!PLC_FormalParameterMorph methodsFor: 'event handling' stamp: 'EricPernia 6/26/2013 01:36'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^false.! !!PLC_FormalParameterMorph methodsFor: 'accessing' stamp: 'EricPernia 7/10/2013 01:26'!inOutFPAssociated		^ nil! !!PLC_FormalParameterMorph methodsFor: 'initialize-release' stamp: 'EricPernia 6/26/2013 02:26'!initialize	"comment stating purpose of message"		super initialize.		text := 'VAR'.! !!PLC_FormalParameterMorph methodsFor: 'extent' stamp: 'EricPernia 6/29/2013 18:21'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent.! !!PLC_FormalParameterMorph methodsFor: 'position' stamp: 'EricPernia 6/29/2013 18:23'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ ( 0 @ 0 ).! !!PLC_FormalParameterMorph methodsFor: 'margin' stamp: 'EricPernia 6/26/2013 01:39'!leftMargin	"Retorna el margen izquierdo del texto con respecto al elemento."		^ self properties scale x * 4.! !!PLC_FormalParameterMorph methodsFor: 'margin' stamp: 'EricPernia 6/26/2013 01:39'!rightMargin	"Retorna el margen derecho del texto con respecto al elemento."		^ self properties scale x * 4.! !!PLC_FormalParameterMorph methodsFor: 'text' stamp: 'EricPernia 6/26/2013 02:37'!text: anObject	text := anObject.	( text asMorph extent x > self textWidth )		ifTrue: [ 			self doubleWidth.			self owner ifNotNil: [ self owner formalParameterWithDoubleWidth. ].			].			self extentChanged.! !!PLC_FormalParameterMorph methodsFor: 'drawing' stamp: 'EricPernia 6/14/2012 04:58'!underline 	"Morph que representa el subrrayado de la etiqueta."	| underline |		underline := Rectangle 		origin: (0@0)		corner: ( self extent x - (self properties scale x * 2) ) @ (self properties scale y).			^ underline align: underline bottomCenter with: self bounds bottomCenter.! !!PLC_InOutFormalParameterMorph methodsFor: 'drawing' stamp: 'EricPernia 6/27/2013 02:36'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		aCanvas 		fillRectangle: self inOutLine 		color: self properties nonBooleanVariablePinColor; "self connectionStateLayer1 elementColor;" "DEBERIA PEDIRSELO A SU CONNECTION LAYER"				fillRectangle: self underline		fillStyle: ( self textAlign 			underlineStyleWithColor: self userInteractionStateLayer1 blockBodyColor			andOrigin: self position			andDirection: self extent x @ 0 ). ! !!PLC_InOutFormalParameterMorph methodsFor: 'accessing' stamp: 'EricPernia 7/10/2013 00:54'!inOutFPAssociated		^ inOutFPAssociated! !!PLC_InOutFormalParameterMorph methodsFor: 'accessing' stamp: 'EricPernia 7/10/2013 00:54'!inOutFPAssociated: anObject		inOutFPAssociated := anObject! !!PLC_InOutFormalParameterMorph methodsFor: 'drawing' stamp: 'EricPernia 6/27/2013 02:29'!inOutLine 	"Morph que representa la linea que continua el pin del tag in out."		^ self textAlign inOutLineFor: self! !!PLC_InOutFormalParameterMorph methodsFor: 'extent' stamp: 'EricPernia 6/27/2013 02:30'!inOutLineExtent	"Ancho de la linea que continua el pin del tag in out."	^ self extent x - self textLinesMaxWidth - self leftMargin - ( self properties scale x * 4 ).! !!PLC_InOutFormalParameterMorph methodsFor: 'drawing' stamp: 'EricPernia 6/27/2013 02:13'!leftInOutLine 	"Morph que representa la linea que continua el pin del tag in out."	| inOutLine |		inOutLine := Rectangle 		origin: (0@0)		corner: self inOutLineExtent @ (self properties scale y * 2).			^ inOutLine align: inOutLine rightCenter with: self bounds rightCenter.! !!PLC_InOutFormalParameterMorph methodsFor: 'drawing' stamp: 'EricPernia 6/27/2013 02:22'!rightInOutLine 	"Morph que representa la linea que continua el pin del tag in out."	| inOutLine |		inOutLine := Rectangle 		origin: (0@0)		corner: self inOutLineExtent @ (self properties scale y * 2).			^ inOutLine align: inOutLine leftCenter with: self bounds leftCenter.! !!PLC_InOutFormalParameterMorph methodsFor: 'position' stamp: 'EricPernia 7/10/2013 02:00'!updateInputInOutFPAssociatedVerticalPosition	"Actualiza la posicion Vertical del elemento cuando se lo pide su inOutFPAssociated.	Adems Notifica a su owner que es un bloque para que se actualice."	| oldBottom |		oldBottom := self bottom.		self bottom: ( self inOutFPAssociated bottom max: self bottom ).		( oldBottom = self bottom )		ifFalse: [			self owner inputInOutFPVerticallyChanged: self.			].! !!PLC_InOutFormalParameterMorph methodsFor: 'position' stamp: 'EricPernia 7/10/2013 02:01'!updateOutputInOutFPAssociatedVerticalPosition	"Actualiza la posicion Vertical del elemento cuando se lo pide su inOutFPAssociated.	Adems Notifica a su owner que es un bloque para que se actualice."	| oldBottom |		oldBottom := self bottom.		self bottom: ( self inOutFPAssociated bottom max: self bottom ).		( oldBottom = self bottom )		ifFalse: [			self owner outputInOutFPVerticallyChanged: self.			].! !!PLC_OneLineTagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 01:16'!defaultExtent	"Tamao por defecto"		^ self properties scale * ( 75 @ super defaultExtent y ).! !!PLC_OneLineTagMorph methodsFor: 'drawing' stamp: 'EricPernia 6/26/2013 01:16'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		"aCanvas 		fillRectangle: self backgroundRectangle 		color: self drawingLayer1 blockFootAndHeaderColor."! !!PLC_OneLineTagMorph methodsFor: 'event handling' stamp: 'EricPernia 6/26/2013 01:16'!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^false.! !!PLC_OneLineTagMorph methodsFor: 'extent' stamp: 'EricPernia 6/29/2013 18:22'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent.! !!PLC_OneLineTagMorph methodsFor: 'position' stamp: 'EricPernia 6/29/2013 18:23'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ ( 0 @ 0 ).! !!PLC_OneLineTagMorph methodsFor: 'margin' stamp: 'EricPernia 6/26/2013 01:41'!leftMargin	"Retorna el margen izquierdo del texto con respecto al elemento."		^ self properties scale x * 1.! !!PLC_OneLineTagMorph methodsFor: 'margin' stamp: 'EricPernia 6/26/2013 01:41'!rightMargin	"Retorna el margen derecho del texto con respecto al elemento."		^ self properties scale x * 1.! !!PLC_OneLineTagMorph methodsFor: 'size' stamp: 'EricPernia 6/26/2013 01:22'!textWidth	"Ancho de una linea de texto"	^ self text asMorph extent x + self leftMargin + self rightMargin. ! !!PLC_OneLineTagMorph methodsFor: 'size' stamp: 'EricPernia 6/26/2013 01:25'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self textWidth @ self defaultExtent y.! !!PLC_OverloadedMorph methodsFor: 'drawing' stamp: 'EricPernia 5/22/2013 12:48'!drawElementOn: aCanvas	"Dibuja el elemento"		super drawElementOn: aCanvas.		aCanvas			frameRectangle: self backgroundRectangle		 width: 1 		colors: { self userInteractionStateLayer1 blockBodyColor}  		dashes: {1}.! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!backgroundBorderColor	^ backgroundBorderColor! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!backgroundBorderColor: anObject	backgroundBorderColor := anObject! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!backgroundBorderWidth	^ backgroundBorderWidth! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!backgroundBorderWidth: anObject	backgroundBorderWidth := anObject! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!backgroundColor		^ self userInteractionStateLayer1 backgroundColor! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!backgroundColor: anObject	backgroundColor := anObject! !!PLC_RowMorph methodsFor: 'extent' stamp: 'EricPernia 8/4/2013 05:10'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self extent.! !!PLC_RowMorph methodsFor: 'extent' stamp: 'EricPernia 8/4/2013 05:10'!currentWidth	"Ancho actual de una linea de texto"	^ self extent x. ! !!PLC_RowMorph methodsFor: 'drawing' stamp: 'EricPernia 8/4/2013 05:10'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		aCanvas 		fillRectangle: self bounds 		color: self backgroundColor.			aCanvas			frameRectangle: self bounds		width: self backgroundBorderWidth 		colors: { self backgroundBorderColor. }  		dashes: {1}.! !!PLC_RowMorph methodsFor: 'drawing' stamp: 'EricPernia 8/4/2013 05:10'!drawElementOn: aCanvas	"Dibuja el elemento"	| strings |	strings := self stringsToDraw.		strings do:[ :str |		"Linea de texto"		aCanvas				drawString: str			at: (self stringPositionFor: str index: (strings indexOf: str))			font: self font			color: self textColor.		].! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!emphasis	^ emphasis! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!emphasis: anObject	emphasis := anObject! !!PLC_RowMorph methodsFor: 'drawing' stamp: 'EricPernia 8/4/2013 05:10'!font	"Fuente del texto"	^ TextStyle defaultFont emphasized: self emphasis.! !!PLC_RowMorph methodsFor: 'initialize-release' stamp: 'EricPernia 8/4/2013 05:10'!initialize 	"comment stating purpose of message"	self backgroundColor: Color lightGray.	self backgroundBorderColor: Color black.	self backgroundBorderWidth: 0.	self textColor: Color white. 	self leftMargin: 5.	self rightMargin: 5.	self emphasis: 0.		super initialize.! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!leftMargin	^ leftMargin! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!leftMargin: anObject	leftMargin := anObject! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!rightMargin	^ rightMargin! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!rightMargin: anObject	rightMargin := anObject! !!PLC_RowMorph methodsFor: 'drawing' stamp: 'EricPernia 8/4/2013 05:10'!stringPositionFor: aString index: aNumber	"Dibujo el texto"	| x y |			x:= (self textAlign) txtPositionXFor: aString in: self.	y := self position y + ( ( self extent y - self textLineHeight ) / 2.0 ) rounded.			^  x @ y.! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!textColor		^ self userInteractionStateLayer1 elementColor.! !!PLC_RowMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:10'!textColor: anObject	textColor := anObject! !!PLC_TagMorph class methodsFor: 'instance creation' stamp: 'EricPernia 4/26/2015 16:49'!newWithText: aString	"Nuevo con texto asString"	| graphicElem |		graphicElem := self new.		graphicElem text: aString.		graphicElem extentChanged.		"Lo posiciono fuera del ladderView para que no moleste cuando	hago layout"	graphicElem position: graphicElem position - graphicElem layoutRectangle extent.		^ graphicElem.	! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:18'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self extent x @ self textLinesExtent y.! !!PLC_TagMorph methodsFor: 'align-states' stamp: 'EricPernia 7/19/2012 23:35'!centerAlign		self textAlign: PLC_Aligns center.	self changed.! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 01:46'!defaultExtent	"Tamao por defecto"		^ self elementWidth @ super defaultExtent y.! !!PLC_TagMorph methodsFor: 'drawing' stamp: 'CarlosLombardi 10/28/2016 22:37'!drawElementOn: aCanvas	"Dibujo el texto"	| strings |	strings := self stringsToDraw.	strings		do: [ :str | 			"Linea de texto"			aCanvas				drawString: str				at: (self stringPositionFor: str index: (strings indexOf: str))				font: TextStyle defaultFont				color: self textColor.				"Borde delimitador de la linea de texto"			self properties drawTextLineBorder				ifTrue: [ 					self						drawTextLineBorderOn: aCanvas						rectangle:							((self stringPositionFor: str index: (strings indexOf: str))								corner: (self stringPositionFor: str index: (strings indexOf: str)) + str asMorph extent) ] ]! !!PLC_TagMorph methodsFor: 'drawing' stamp: 'EricPernia 7/19/2012 23:36'!drawTextLineBorderOn: aCanvas rectangle: aRectangle	"Borde delimitador de la linea de texto"				aCanvas			frameRectangle: aRectangle		 width: 1		colors: {Color red}  		dashes: {1}.! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:56'!elementDoubleWidth	"Doble ancho del elemento"	^ self properties scale x * 184.! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:55'!elementWidth	"Ancho estandar del elemento"	^ self properties scale x * 88.! !!PLC_TagMorph methodsFor: 'accessing' stamp: 'EricPernia 5/5/2013 22:27'!graphicElement	"Devuelve el elemento grafico asociado a la variable, por ejemplo, un contacto, bobina o bloque"	^ graphicElement.! !!PLC_TagMorph methodsFor: 'accessing' stamp: 'EricPernia 6/21/2013 22:40'!graphicElement: anObject 	graphicElement := anObject.! !!PLC_TagMorph methodsFor: 'initialize-release' stamp: 'EricPernia 6/26/2013 02:25'!initialize	"Inicializo la etiqueta"	super initialize.	text := '<???>'.	self unselected;			"drawingLayer1"		notKeyboardFocus.		"drawingLayer3"	PLC_Aligns initialize.	self textAlign: PLC_Aligns center.			self extentChanged;		color: Color white;		openInWorld.! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:59'!layoutRectangleExtent	"Devuelve el tamao en pixeles del layoutRectangle."		^ self extent + (self properties scale * ( 8 @ 0 ) ).! !!PLC_TagMorph methodsFor: 'position' stamp: 'EricPernia 4/25/2013 01:22'!layoutRectanglePosition	"Devuelve la posicin en pantalla del layoutRectangle relativa a position del elemento [px]."		^ self properties scale * ( -4 @ 0 ).! !!PLC_TagMorph methodsFor: 'align-states' stamp: 'EricPernia 7/19/2012 23:35'!leftAlign		self textAlign: PLC_Aligns left.	self changed.! !!PLC_TagMorph methodsFor: 'margin' stamp: 'EricPernia 6/26/2013 01:42'!leftMargin	"Retorna el margen izquierdo del texto con respecto al elemento."		^ 0.! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 01:32'!lineSpacing	"Alto de interlineado del texto. Es decir, tamao de separacion entre lineas." 	^ self properties scale y * 4.! !!PLC_TagMorph methodsFor: 'drawing' stamp: 'EricPernia 7/19/2012 23:36'!numberOfLines	"Devuelve el numero de lineas de texto"	^ self stringsToDraw size.! !!PLC_TagMorph methodsFor: 'align-states' stamp: 'EricPernia 7/19/2012 23:35'!rightAlign		self textAlign: PLC_Aligns right.	self changed.! !!PLC_TagMorph methodsFor: 'margin' stamp: 'EricPernia 6/26/2013 01:42'!rightMargin	"Retorna el margen derecho del texto con respecto al elemento."		^ 0.! !!PLC_TagMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2013 01:40'!stringPositionFor: aString index: aNumber	"Dibujo el texto"	| x y |			x:= (self textAlign) txtPositionXFor: aString in: self.	y := self position y + 2 + ( ( self textLineHeight + self lineSpacing ) * (aNumber-1) ).							"2= self top margin"			^  x @ y.! !!PLC_TagMorph methodsFor: 'drawing' stamp: 'EricPernia 6/26/2013 00:48'!stringsToDraw	"Devuelve una Ordered collection con los strings haciendo wrap al contenedor."		"CAMBIAR ESPACIOS POR UNDERLINES: _ para la detecion de como wrapear, OJO con TRIM "	| string character words wordsWrap stringAcum stringTemp strings stream |		string := self text.		" 1) Separo en palabras."		words := string findTokens: ' '.	"95 - underline"		"32 - space"	"13 - cr"	" 9  - tab"	"10 - line feed"	"12 - form feed"	(1 to: words size - 1) do: [ :index | 		words at: index put: ( (words at: index) , ' ' ).		].		 " 2) Corto las palabras largas."	wordsWrap := OrderedCollection new.	words do: [ :eachWord |		(eachWord trimRight asMorph extent x <= self textWidth)			ifTrue:[				wordsWrap add: eachWord.				]			ifFalse:[				stringAcum :=''.				stringTemp :=''.					stream := eachWord readStream.				eachWord size timesRepeat: [					character := stream next.					stringAcum := stringAcum , character asString.					(stringAcum asMorph extent x <= self textWidth)						ifTrue:[							stringTemp := stringAcum.							]						ifFalse:[							wordsWrap add: stringTemp.							stringTemp := character asString.							stringAcum := stringTemp.							].					].				wordsWrap add: stringTemp.				].		].wordsWrap.			" 3) Junto las palabras que pueda por linea."		strings := OrderedCollection new.	stringAcum :=''.	stringTemp :=''.	wordsWrap do: [ :eachWordWrap |		stringAcum := stringTemp ,  eachWordWrap.				(stringAcum trimRight asMorph extent x <= self textWidth) 	"el trimRight es para sacarle el ultimo espacio a derecha para ver si entra sin ese espacio"			ifTrue:[				stringTemp := stringAcum.				]			ifFalse:[.				strings add: stringTemp trimRight.				stringTemp := eachWordWrap.				stringAcum := ''.				].		].	strings add: stringTemp trimRight.		^ strings.! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 4/22/2013 01:32'!tagHeight	"Alto  de una linea de texto mas sus margenes superior e inferior." 	^ self textLineHeight + self lineSpacing! !!PLC_TagMorph methodsFor: 'text' stamp: 'EricPernia 7/19/2012 23:35'!text	^ text! !!PLC_TagMorph methodsFor: 'text' stamp: 'EricPernia 6/25/2013 00:36'!text: anObject	text := anObject.		self extentChanged.! !!PLC_TagMorph methodsFor: 'text' stamp: 'EricPernia 7/19/2012 23:35'!textAlign	^ textAlign! !!PLC_TagMorph methodsFor: 'text' stamp: 'EricPernia 7/19/2012 23:35'!textAlign: anObject	textAlign := anObject! !!PLC_TagMorph methodsFor: 'drawing' stamp: 'CarlosLombardi 10/28/2016 22:37'!textColor	^ self userInteractionStateLayer1 textColor! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:48'!textLineExtent	"Tamao de una linea de texto"	^ self textWidth @ self textLineHeight.! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:49'!textLineHeight	"Alto  de una linea de texto" 	^ self properties scale y * 14. "Aca deberia calcularlo segun el tamao de al fuente ejemplo: texto asMorph height"! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 7/19/2012 23:38'!textLinesExtent	"Tamao de todas las lineas de texto juntas."	^ ( (self textLineExtent + self lineSpacing) * (1 @ self numberOfLines) ) - self lineSpacing.! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/27/2013 02:22'!textLinesMaxWidth	"Devuelve el mayor ancho de linea de texto entre sus lineas de texto."	^ self stringsToDraw 		inject: 0		into: [ :acum :each | 			acum max: each asMorph extent x.			].! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:47'!textWidth	"Ancho de la linea de texto"	^ self extent x - self leftMargin - self rightMargin. ! !!PLC_TagMorph methodsFor: 'extent' stamp: 'EricPernia 6/26/2013 00:26'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self extent x @ ( self textLinesExtent y + self lineSpacing).! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 18:50'!backgroundBorderColor	^ backgroundBorderColor! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 18:50'!backgroundBorderColor: anObject	backgroundBorderColor := anObject! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/23/2013 00:23'!backgroundBorderWidth	^ backgroundBorderWidth! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/23/2013 00:23'!backgroundBorderWidth: anObject	backgroundBorderWidth := anObject! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 8/4/2013 05:09'!backgroundColor	^ backgroundColor! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 17:59'!backgroundColor: anObject	backgroundColor := anObject! !!PLC_TitleMorph methodsFor: 'extent' stamp: 'EricPernia 5/22/2013 16:58'!backgroundRectangleExtent	"Devuelve el tamao en pixeles del backgroundRectangle."		^ self extent.! !!PLC_TitleMorph methodsFor: 'extent' stamp: 'EricPernia 5/22/2013 13:01'!currentWidth	"Ancho actual de una linea de texto"	^ self extent x. ! !!PLC_TitleMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2013 01:58'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		aCanvas 		fillRectangle: self bounds 		color: self backgroundColor.			aCanvas			frameRectangle: self bounds		width: self backgroundBorderWidth 		colors: { self backgroundBorderColor. }  		dashes: {1}.! !!PLC_TitleMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2013 00:17'!drawElementOn: aCanvas	"Dibuja el elemento"	| strings |	strings := self stringsToDraw.		strings do:[ :str |		"Linea de texto"		aCanvas				drawString: str			at: (self stringPositionFor: str index: (strings indexOf: str))			font: self font			color: self textColor.		].! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/23/2013 00:19'!emphasis	^ emphasis! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/23/2013 00:19'!emphasis: anObject	emphasis := anObject! !!PLC_TitleMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2013 00:19'!font	"Fuente del texto"	^ TextStyle defaultFont emphasized: self emphasis.! !!PLC_TitleMorph methodsFor: 'event handling' stamp: 'EricPernia 11/17/2013 03:59'!handlesMouseOver: evt	"No maneja el evento de mouse sobre este elemento"	^ false! !!PLC_TitleMorph methodsFor: 'event handling' stamp: 'EricPernia 8/5/2013 02:37'!handlesMouseOverBORRAME: evt	"No maneja el evento de mouse sobre este elemento"	^ false! !!PLC_TitleMorph methodsFor: 'initialize-release' stamp: 'EricPernia 5/23/2013 00:24'!initialize 	"comment stating purpose of message"	self backgroundColor: Color lightGray.	self backgroundBorderColor: Color black.	self backgroundBorderWidth: 0.	self textColor: Color white. 	self leftMargin: 5.	self rightMargin: 5.	self emphasis: 0.		super initialize.! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 18:53'!leftMargin	^ leftMargin! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 18:53'!leftMargin: anObject	leftMargin := anObject! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 18:53'!rightMargin	^ rightMargin! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 18:53'!rightMargin: anObject	rightMargin := anObject! !!PLC_TitleMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2013 01:48'!stringPositionFor: aString index: aNumber	"Dibujo el texto"	| x y |			x:= (self textAlign) txtPositionXFor: aString in: self.	y := self position y + ( ( self extent y - self textLineHeight ) / 2.0 ) rounded.			^  x @ y.! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 17:59'!textColor	^ textColor! !!PLC_TitleMorph methodsFor: 'accessing' stamp: 'EricPernia 5/22/2013 17:59'!textColor: anObject	textColor := anObject! !!PLC_TitleMorph methodsFor: 'extent' stamp: 'EricPernia 11/17/2013 04:01'!totalExtent	"Devuelve el tamao total del elemento. Es el tamao total del Morph.	Ningn elemento puede pisar este rea de otro elemento."		^ self extent! !!PLC_InsertionPointMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2012 17:35'!defaultExtent	"Tamao del area de drop del insertion point."	(self owner isKindOf: PLC_GraphicElementMorph )		ifTrue: [			^ self owner insertionPointDropAreaExtent.			] 		ifFalse: [			^ 96 @ 24.			].		 ! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 9/22/2012 05:47'!draggingAnother	"Implementado solo por compatibilidad para polimorfismo."! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 9/22/2012 05:46'!draggingSelf 	"Implementado solo por compatibilidad para polimorfismo."! !!PLC_InsertionPointMorph methodsFor: 'drawing' stamp: 'EricPernia 5/21/2012 18:17'!drawBackgroundOn: aCanvas	"Dibuja el fondo del elemento"		aCanvas fillRectangle: self bounds color: self drawingLayer insertionPointBackgroundColor.		! !!PLC_InsertionPointMorph methodsFor: 'drawing' stamp: 'EricPernia 5/21/2012 18:18'!drawElementOn: aCanvas	"Dibuja el elemento"		aCanvas 		frameAndFillRectangle: self insertionPointRectangle		fillColor: self drawingLayer insertionPointColor		borderWidth: self properties scale x 		borderColor: self drawingLayer insertionPointBorderColor.! !!PLC_InsertionPointMorph methodsFor: 'drawing' stamp: 'EricPernia 4/27/2013 03:32'!drawOn: aCanvas	"Dibujo el elemento grafico"		self drawingLayer drawOn: aCanvas for: self.! !!PLC_InsertionPointMorph methodsFor: 'accessing' stamp: 'EricPernia 5/15/2012 22:40'!drawingLayer	^ drawingLayer! !!PLC_InsertionPointMorph methodsFor: 'accessing' stamp: 'EricPernia 5/15/2012 22:40'!drawingLayer: anObject	drawingLayer := anObject! !!PLC_InsertionPointMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2012 17:32'!dropAreaDefaultHeight	"Altura por defecto. Todos los Insertion Point tienen esta altura de su fondo o area de drop"	^ 24.! !!PLC_InsertionPointMorph methodsFor: 'initialize-release' stamp: 'EricPernia 5/15/2012 22:46'!initialize	"Inicializo el elemento grafico"	super initialize.		self properties: PLC_GraphicElementProperties uniqueInstance.			PLC_GraphicElementState initialize.	self notDragging.			"drawingLayer"	self openInWorld. 	self extent: self defaultExtent.	! !!PLC_InsertionPointMorph methodsFor: 'drawing' stamp: 'EricPernia 5/23/2012 15:00'!insertionPointCenter	"Devuelve el punto del centro del rectangulo del punto de insercin 	que no coincide siempre con el centro del area de drop."	^ self owner insertionPointCenter.! !!PLC_InsertionPointMorph methodsFor: 'drawing' stamp: 'EricPernia 5/13/2012 06:19'!insertionPointRectangle	"Rectangulito que representa el punto de insercin"		| width height origin corner|	width := self properties scale x * 6.	height := self properties scale y * 8.		origin := self center - ((width /2.0) rounded @ (height /2.0) rounded).	corner := origin + (width @ height).	^ Rectangle origin: origin corner: corner.! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 9/22/2012 05:46'!mouseOut	"Implementado solo por compatibilidad para polimorfismo."! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 9/22/2012 05:46'!mouseOver	"Implementado solo por compatibilidad para polimorfismo."! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 5/23/2012 18:05'!notDragging	"Estado Not Dragiing."		self visible: false.	self drawingLayer: PLC_GraphicElementState voidState.	self changed.! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 5/23/2012 18:04'!overDropArea	"Estado Over Drop Area."		self visible: true.	self drawingLayer: PLC_GraphicElementState overDropArea.	self changed.! !!PLC_InsertionPointMorph methodsFor: 'accessing' stamp: 'EricPernia 5/21/2012 18:04'!properties	^ properties! !!PLC_InsertionPointMorph methodsFor: 'accessing' stamp: 'EricPernia 5/21/2012 18:04'!properties: anObject	properties := anObject! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 9/22/2012 05:45'!selected	"Implementado solo por compatibilidad para polimorfismo."! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 5/23/2012 18:05'!underDragArea	"Estado Under Drag Area."		self visible: true.	self drawingLayer: PLC_GraphicElementState underDragArea.	self changed.! !!PLC_InsertionPointMorph methodsFor: 'states' stamp: 'EricPernia 9/22/2012 05:45'!unselected	"Implementado solo por compatibilidad para polimorfismo."! !!Trait method!handlesMouseDown: anEvent	"Permite manejar el evento de cuando el usuatio clickea el mouse sobre el morph."	^ true.! !!Trait method!handlesMouseDown: anEvent	"Permite manejar el evento de cuando el usuatio clickea el mouse sobre el morph."	^ true.! !!Trait method!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^true.! !!Trait method!handlesMouseOver: anEvent	"Permite manejar el evento de que el puntero pasa sobre el morph."	^true.! !!Trait method!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			self objetive ifNotNil: [		self objetive perform: self action.	]! !!Trait method!leftClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."			self objetive ifNotNil: [		self objetive perform: self action.	]! !!Trait method!leftDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."! !!Trait method!leftDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."! !!Trait method!leftDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!Trait method!leftDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!Trait method!mouseDown: anEvent	"Manejador del evento mouse down"	"Do nothing upon mouse-down except inform the hand to watch for a double-click; wait until an 	ensuing click:, doubleClick:, or drag: message gets dispatched"	"Note that mouseMove: and mouseUp: events are not sent to aMorph until it becomes the mouse focus,	which is typically done by aMorph in its click:, doubleClick:, or drag: methods."		anEvent redButtonPressed "click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#leftClick:. #leftDoubleClick:. #leftDoubleClickTimeout:. #startDrag:.}				threshold: 5.								].				anEvent yellowButtonPressed "action-click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#rightClick:. #rightDoubleClick:. #rightDoubleClickTimeout:. nil.}				threshold: 5.			].! !!Trait method!mouseDown: anEvent	"Manejador del evento mouse down"	"Do nothing upon mouse-down except inform the hand to watch for a double-click; wait until an 	ensuing click:, doubleClick:, or drag: message gets dispatched"	"Note that mouseMove: and mouseUp: events are not sent to aMorph until it becomes the mouse focus,	which is typically done by aMorph in its click:, doubleClick:, or drag: methods."		anEvent redButtonPressed "click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#leftClick:. #leftDoubleClick:. #leftDoubleClickTimeout:. #startDrag:.}				threshold: 5.								].				anEvent yellowButtonPressed "action-click"		ifTrue: [			anEvent hand				waitForClicksOrDrag: self				event: anEvent				selectors: {#rightClick:. #rightDoubleClick:. #rightDoubleClickTimeout:. nil.}				threshold: 5.			].! !!Trait method!mouseEnter: anEvent	"Manejador del evento mouse enter. Este mensaje se le envia al 	morph cuando el puntero del mouse empieza a pasar por el."	self mouseOver.! !!Trait method!mouseEnter: anEvent	"Manejador del evento mouse enter. Este mensaje se le envia al 	morph cuando el puntero del mouse empieza a pasar por el."	self mouseOver.! !!Trait method!mouseLeave: anEvent	"Manejador del evento mouse leave. Este mensaje se le envia al 	morph cuando el puntero del mouse deja de pasarpor el."	self mouseOut.! !!Trait method!mouseLeave: anEvent	"Manejador del evento mouse leave. Este mensaje se le envia al 	morph cuando el puntero del mouse deja de pasarpor el."	self mouseOut.! !!Trait method!mouseUp: anEvent	"Manejador del evento mouse up"		! !!Trait method!mouseUp: anEvent	"Manejador del evento mouse up"		! !!Trait method!rightClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."! !!Trait method!rightClick: anEvent	"Manejador del evento Click con boton izquiedo del mouse"	"(click) sent when the mouse button goes up within doubleClickTime."! !!Trait method!rightDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."	! !!Trait method!rightDoubleClick: anEvent	"Manejador del evento doble click con el boton izquierdo del mouse"	"(doubleClick) sent when the mouse goes up, down, and up again all within DoubleClickTime."	! !!Trait method!rightDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!Trait method!rightDoubleClickTimeout: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(doubleClickTimeout) sent when the mouse does not have a doubleClick within DoubleClickTime."! !!Trait method!startDrag: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(startDrag) sent when the mouse moves more than threshold pixels from evt's position within DoubleClickTime."			anEvent hand grabMorph: self! !!Trait method!startDrag: anEvent	"Manejador del evento doble click timeout con el boton izquierdo del mouse"	"(startDrag) sent when the mouse moves more than threshold pixels from evt's position within DoubleClickTime."			anEvent hand grabMorph: self! !!Trait method!stringsToDraw	"Devuelve una Ordered collection con los strings haciendo wrap al contenedor."	| strings |		"Strings es una OC de lineas de texto"	strings := OrderedCollection new.		strings add: super stringsToDraw first.	^ strings.! !!Trait method!stringsToDraw	"Devuelve una Ordered collection con los strings haciendo wrap al contenedor."	| strings |		"Strings es una OC de lineas de texto"	strings := OrderedCollection new.		strings add: super stringsToDraw first.	^ strings.! !"IDE4PLC"!!ConfigurationOfOSProcess commentStamp: '<historical>' prior: 0!OSProcess provides access to operating system functions, including pipes and child process creation. It is implemented using pluggable primitives in a shared library for Unix or Linux, and a DLL for Windows. The Smalltalk code, including the classes which implement pluggable primitives for Unix or Win32 operating system functions, may be loaded into any Squeak image, but the primitives are only useful on Unix and Windows systems. Placeholder classes are provided for MacOS, OS/2 and RiscOS, but are not yet implemented.ConfigurationOfOSProcess project stableVersion load.!!ConfigurationOfOSProcess class methodsFor: 'private' stamp: 'MiguelCoba 1/12/2010 23:39'!bootstrapPackage: aString from: aPath 	| repository version |	repository := MCHttpRepository				location: aPath				user: ''				password: ''.	repository		versionReaderForFileNamed: aString , '.mcz'		do: [:reader | 			version := reader version.			version load.			version workingCopy repositoryGroup addRepository: repository]! !!ConfigurationOfOSProcess class methodsFor: 'private' stamp: 'MiguelCoba 1/12/2010 23:39'!ensureMetacello	"Bootstrap Gofer (if necessary), bootstrap ConfigurationOfMetacello (using old Gofer API), then load the latest 	version of Metacello itself."	Smalltalk at: #MetacelloProject ifAbsent: [		Smalltalk at: #Gofer ifAbsent: [			"Current version of Gofer from which to bootstrap - as of 1.0-beta.15"			self bootstrapPackage: 'Gofer-lr.83' from: 'http://seaside.gemstone.com/ss/metacello' ].		Smalltalk at: #Gofer ifPresent: [:goferClass | | gofer |			gofer := goferClass new				url: 'http://seaside.gemstone.com/ss/metacello';				yourself.			[ gofer addPackage: 'ConfigurationOfMetacello' ] on: Warning do: [:ex | ex resume ].			gofer load ].		"load 'default' group of Metacello"		(Smalltalk at: #ConfigurationOfMetacello) perform: #load ]! !!ConfigurationOfOSProcess class methodsFor: 'metacello tool support' stamp: 'MiguelCoba 1/12/2010 23:39'!isMetacelloConfig	"Answer true and the Metacello tools will operate on you"		^true! !!ConfigurationOfOSProcess class methodsFor: 'metacello tool support' stamp: 'MiguelCoba 1/12/2010 23:39'!lastMetacelloVersionLoad	"Answer the last version loaded and the list of packages loaded for that version."	LastVersionLoad == nil ifTrue: [ LastVersionLoad := nil -> 'default' ].	^LastVersionLoad! !!ConfigurationOfOSProcess class methodsFor: 'loading' stamp: 'dtl 7/1/2010 21:18'!load	"self load"	| r |	r := self project latestVersion load.	(Smalltalk at: #ThisOSProcess) ifNotNilDo: [ :osp | osp startUp: true ] "initialize"! !!ConfigurationOfOSProcess class methodsFor: 'metacello tool support' stamp: 'MiguelCoba 1/12/2010 23:39'!metacelloVersion: versionString loads: anArrayOrString	"Stash the last version loaded and the list of packages loaded for that version. The list	 of packages will be used by the tools when doing 'Load Package Version'"	LastVersionLoad := versionString -> anArrayOrString! !!ConfigurationOfOSProcess class methodsFor: 'accessing' stamp: 'MiguelCoba 1/12/2010 23:39'!project	^self new project! !!ConfigurationOfOSProcess methodsFor: 'baselines' stamp: 'MiguelCoba 2/19/2011 01:33'!baseline4312: spec	<version: '4.3.12-baseline'>		spec for: #common do: [		spec blessing: #baseline.		spec description: 'Initial baseline for OSProcess'.		spec repository: 'http://www.squeaksource.com/OSProcess' ].		spec for: #squeakCommon do: [		spec			repository: 'http://www.squeaksource.com/OSProcess';			package: 'OSProcess-Base';   			package: 'OSProcess-AIO' with: [ spec requires: 'OSProcess-Base' ];  			package: 'OSProcess-Mac' with: [ spec requires: 'OSProcess-Base' ];  			package: 'OSProcess-OS2' with: [ spec requires: 'OSProcess-Base' ];  			package: 'OSProcess-RiscOS' with: [ spec requires: 'OSProcess-Base' ];  			package: 'OSProcess-Unix' with: [ spec requires: 'OSProcess-Base' ];  			package: 'OSProcess-Win32' with: [ spec requires: 'OSProcess-Base' ];  			package: 'OSProcess-Tests' with: [ spec requires: 'OSProcess-Base' ] ].		spec for: #common do: [		spec			group: 'default' with: #('OSProcess' 'OSProcess-AIO' 'Tests');			group: 'OSProcess' with: #('OSProcess-Base' 'Platforms');			group: 'Platforms' with: 'OSProcess-Mac';			group: 'Platforms' with: 'OSProcess-OS2';			group: 'Platforms' with: 'OSProcess-RiscOS';			group: 'Platforms' with: 'OSProcess-Unix';			group: 'Platforms' with: 'OSProcess-Win32';			group: 'Tests' with: 'OSProcess-Tests' ].! !!ConfigurationOfOSProcess methodsFor: 'baselines' stamp: 'MiguelCoba 1/13/2010 13:10'!baseline43: spec	<version: '4.3-baseline'>		spec for: #common do: [		spec blessing: #baseline.		spec description: 'Initial baseline for OSProcess'.		spec repository: 'http://www.squeaksource.com/OSProcess' ].		spec for: #squeakCommon do: [		spec			repository: 'http://www.squeaksource.com/OSProcess';			package: 'OSProcess';  			package: 'Tests-OSProcess' with: [ spec requires: 'OSProcess' ] ].		spec for: #common do: [		spec			group: 'default' with: 'OSProcess';			group: 'Tests' with: 'Tests-OSProcess' ].! !!ConfigurationOfOSProcess methodsFor: 'baselines' stamp: 'SeanDeNigris 2/12/2013 10:05'!baseline446: spec	<version: '4.4.6-baseline'>	spec for: #'common' do: [		spec blessing: #'baseline'.		spec description: 'Load the OSProcess-* packages instead of the OSProcess all-in-one package.David Lewis has said that these packages will be kept in sync with the al-in-one and this will give us greater flexibility in what to load.For example, we can now optionally load the tests. This seemed possible with the previous version, but actually the tests were always loaded as part of the all-in-one'.		spec repository: 'http://www.squeaksource.com/OSProcess'.		spec project: 'Pipeability' with: [			spec				repository: 'http://www.squeaksource.com/MetacelloRepository';				className: 'ConfigurationOfCommandShell';				loads: #('Piping') ].		spec 			package: 'OSProcess-AIO';			package: 'OSProcess-Base' with: [ spec requires: #('OSProcess-AIO') ];			package: 'OSProcess-OS2' with: [ spec requires: #('OSProcess-Base') ];			package: 'OSProcess-Win32' with: [ spec requires: #('OSProcess-Base') ];			package: 'OSProcess-Unix' with: [ spec requires: #('OSProcess-Base') ];			package: 'OSProcess-Mac' with: [ spec requires: #('OSProcess-Base') ];			package: 'OSProcess-RiscOS' with: [ spec requires: #('OSProcess-Base') ];			package: 'OSProcess-Tests' with: [ spec requires: #('OSProcess-Base') ].		spec			group: 'All OS' with: #('OSProcess-OS2' 'OSProcess-Win32' 'OSProcess-Unix' 'OSProcess-Mac' 'OSProcess-RiscOS');			group: 'Core' with: #('OSProcess-AIO' 'OSProcess-Base' 'All OS');			group: 'Core with Output' with: #('Core' 'Pipeability');			group: 'Tests' with: #('OSProcess-Tests' ). ].! !!ConfigurationOfOSProcess methodsFor: 'baselines' stamp: 'MiguelCoba 2/19/2011 01:53'!baseline44: spec	<version: '4.4-baseline'>	spec for: #'common' do: [		spec blessing: #'baseline'.		spec repository: 'http://www.squeaksource.com/OSProcess'.		spec 			package: 'OSProcess';			package: 'OSProcess-Tests' with: [				spec requires: #('OSProcess' ). ].		spec 			group: 'default' with: #('OSProcess' );			group: 'Tests' with: #('OSProcess-Tests' ). ].! !!ConfigurationOfOSProcess methodsFor: 'private' stamp: 'SeanDeNigris 2/12/2013 10:24'!loadType	self flag: 'OSProcess''s packages are highly interdependent (some circular), so we must load atomically for now. After these issues are resolved, this can be shanged to #linear'.	^ #atomic.! !!ConfigurationOfOSProcess methodsFor: 'accessing' stamp: 'SeanDeNigris 7/6/2012 11:04'!project	^ project ifNil: [ | constructor |		"Bootstrap Metacello if it is not already loaded"		self class ensureMetacello.		"Construct Metacello project"		constructor := (Smalltalk at: #MetacelloVersionConstructor) on: self.		project := constructor project.		project loadType: self loadType.		project ]! !!ConfigurationOfOSProcess methodsFor: 'symbolic versions' stamp: 'ThierryGoubier 6/18/2015 07:22'!stable: spec	<symbolicVersion: #'stable'>	spec for: #'common' version: '4.6.4'.	spec for: #'pharo1.4.x' version: '4.4.6'.	spec for: #'pharo2.x' version: '4.5.8'.! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'MiguelCoba 1/14/2010 00:31'!version4311: spec	<version: '4.3.11' imports: #('4.3-baseline')>		spec for: #common do: [		spec blessing: #development.		spec description: 'Release 4.3.11'.		spec author: 'MiguelCoba'.		spec timestamp: '01/14/2010 00:30' ].		spec for: #squeakCommon do: [		spec		  	package: 'OSProcess' with: 'OSProcess-dtl.53';			package: 'Tests-OSProcess' with: 'Tests-OSProcess-dtl.20' ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'MiguelCoba 2/19/2011 01:32'!version4312: spec	<version: '4.3.12' imports: #('4.3.12-baseline')>		spec for: #common do: [		spec blessing: #development.		spec description: 'Release 4.3.12'.		spec author: 'dtl'.		spec timestamp: '06/30/2010 19:55' ].		spec for: #squeakCommon do: [		spec		  	package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.4';		  	package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.1';		  	package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.1';		  	package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.1';		  	package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.1';		  	package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.3';		  	package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.2';			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.1' ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'mt 6/9/2011 13:25:13.015'!version440: spec	<version: '4.4.0' imports: #('4.4-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Version 4.4.0'.		spec author: 'MiguelCoba'.		spec timestamp: '2/19/2011 01:59'.		spec 			package: 'OSProcess' with: 'OSProcess-dtl.59';			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.4'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'mt 6/9/2011 13:25:09.479'!version442: spec	<version: '4.4.2' imports: #('4.4-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Version 4.4.2'.		spec author: 'MiguelCoba'.		spec timestamp: '5/29/2011 12:34'.		spec 			package: 'OSProcess' with: 'OSProcess-dtl.61';			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.4'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'mt 9/28/2011 14:14:43.783'!version445: spec	<version: '4.4.5' imports: #('4.4-baseline' )>	spec for: #'common' do: [		spec blessing: #release.		spec description: 'Version 4.4.5'.		spec author: 'Marcel Taeumel'.		spec timestamp: '9/28/2011 14:00'.		spec 			package: 'OSProcess' with: 'OSProcess-dtl.65';			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.7'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'SeanDeNigris 2/12/2013 10:06'!version446: spec	<version: '4.4.6' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'SeanDeNigris'.		spec timestamp: '7/5/2012 12:57'.		spec project: 'Pipeability' with: [ spec version: '1.0' ].		spec 			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.9';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.20';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.1';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.7';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.12';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.1';			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.4';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.1'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'ThierryGoubier 10/5/2014 09:34'!version4511: spec	<version: '4.5.11' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'ThierryGoubier'.		spec timestamp: '6/18/2014 16:42'.		spec project: 'Pipeability' with: [ spec version: '4.6.8' ].		spec 			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.11';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.43';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.11';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.19';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.8';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'ThierryGoubier 10/10/2014 16:38'!version4512: spec	<version: '4.5.12' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'ThierryGoubier'.		spec timestamp: '6/18/2014 16:42'.		spec project: 'Pipeability' with: [ spec version: '4.6.9' ].		spec 			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.11';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.45';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.11';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.20';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.8';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'ThierryGoubier 2/1/2015 10:05'!version4513: spec	<version: '4.5.13' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'ThierryGoubier'.		spec timestamp: '6/18/2014 16:42'.		spec project: 'Pipeability' with: [ spec version: '4.6.9' ].		spec 			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.11';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.45';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.12';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.20';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.8';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'ThierryGoubier 9/23/2013 10:36'!version457: spec	<version: '4.5.7' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'ThierryGoubier'.		spec timestamp: '9/23/2013 10:36'.		spec project: 'Pipeability' with: [ spec version: '4.6.7' ].		spec 			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.11';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.37';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.9';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.17';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.8';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'ThierryGoubier 10/24/2013 17:38'!version458: spec	<version: '4.5.8' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'ThierryGoubier'.		spec timestamp: '9/23/2013 10:36'.		spec project: 'Pipeability' with: [ spec version: '4.6.7' ].		spec 			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.11';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.39';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.9';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.17';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.8';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'SeanDeNigris 2/12/2013 10:07'!version45: spec	<version: '4.5' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'StephaneDucasse'.		spec timestamp: '10/02/2013 12:57'.		spec project: 'Pipeability' with: [ spec version: '1.1' ].		spec 			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.10';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.27';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.9';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.15';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.5';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'ThierryGoubier 4/25/2015 18:23'!version462: spec	<version: '4.6.2' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'ThierryGoubier'.		spec timestamp: '6/18/2014 16:42'.		spec project: 'Pipeability' with: [ spec version: '4.6.12' ].		spec 			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.8';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.49';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2';			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.13';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.23';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.14'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'ThierryGoubier 6/18/2015 07:22'!version463: spec	<version: '4.6.3' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Update to latest package versions'.		spec author: 'ThierryGoubier'.		spec timestamp: '6/17/2015 20:06'.		spec project: 'Pipeability' with: [ spec version: '4.6.13' ].		spec 			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.8';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.50';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2';			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.14';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.24';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.14'. ].! !!ConfigurationOfOSProcess methodsFor: 'versions' stamp: 'ThierryGoubier 7/6/2015 19:14'!version464: spec	<version: '4.6.4' imports: #('4.4.6-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: 'Updated to CommandShell 4.6.15'.		spec author: 'ThierryGoubier'.		spec timestamp: '7/6/2015 19:13'.		spec project: 'Pipeability' with: [ spec version: '4.6.15' ].		spec 			package: 'OSProcess-AIO' with: 'OSProcess-AIO-dtl.8';			package: 'OSProcess-Base' with: 'OSProcess-Base-dtl.51';			package: 'OSProcess-Mac' with: 'OSProcess-Mac-dtl.2';			package: 'OSProcess-OS2' with: 'OSProcess-OS2-dtl.2';			package: 'OSProcess-RiscOS' with: 'OSProcess-RiscOS-dtl.2';			package: 'OSProcess-Tests' with: 'OSProcess-Tests-dtl.14';			package: 'OSProcess-Unix' with: 'OSProcess-Unix-dtl.24';			package: 'OSProcess-Win32' with: 'OSProcess-Win32-dtl.14'. ].! !"ConfigurationOfOSProcess"!!ConfigurationOfCommandShell commentStamp: '<historical>' prior: 0!ConfigurationOfCommandShell project stableVersion load!!ConfigurationOfCommandShell class methodsFor: 'development support' stamp: 'SeanDeNigris 7/5/2012 15:51'!DevelopmentSupport"See the methods in the 'development support' category on the class-side of MetacelloBaseConfiguration. Decide what development support methods you would like to use and copy them the the class-side of your configuration."	<apiDocumentation>! !!ConfigurationOfCommandShell class methodsFor: 'private' stamp: 'SeanDeNigris 7/5/2012 15:51'!baseConfigurationClassIfAbsent: aBlock	^Smalltalk		at: #MetacelloBaseConfiguration		ifAbsent: [ 			self ensureMetacelloBaseConfiguration.			Smalltalk at: #MetacelloBaseConfiguration ifAbsent: aBlock ].! !!ConfigurationOfCommandShell class methodsFor: 'private' stamp: 'SeanDeNigris 7/5/2012 15:51'!ensureMetacello	(self baseConfigurationClassIfAbsent: []) ensureMetacello! !!ConfigurationOfCommandShell class methodsFor: 'private' stamp: 'SeanDeNigris 7/5/2012 15:51'!ensureMetacelloBaseConfiguration	Smalltalk		at: #MetacelloBaseConfiguration		ifAbsent: [ 			| repository version |			repository := MCHttpRepository location: 'http://seaside.gemstone.com/ss/metacello' user: '' password: ''.			repository				versionReaderForFileNamed: 'Metacello-Base-DaleHenrichs.2.mcz'				do: [ :reader | 					version := reader version.					version load.					version workingCopy repositoryGroup addRepository: repository ] ]! !!ConfigurationOfCommandShell class methodsFor: 'metacello tool support' stamp: 'SeanDeNigris 7/5/2012 15:51'!isMetacelloConfig	"Answer true and the Metacello tools will operate on you"		^true! !!ConfigurationOfCommandShell class methodsFor: 'loading' stamp: 'SeanDeNigris 7/5/2012 15:51'!load	"Load the #stable version defined for this platform. The #stable version is the version that is recommended to be used on this platform."	"self load"	<apiDocumentation>	^(self project version: #stable) load! !!ConfigurationOfCommandShell class methodsFor: 'loading' stamp: 'SeanDeNigris 7/5/2012 15:51'!loadBleedingEdge	"Load the latest versions of the mcz files defined for this project. It is not likely that the #bleedingEdge has been tested."	"self loadBleedingEdge"	<apiDocumentation>	^(self project version: #bleedingEdge) load! !!ConfigurationOfCommandShell class methodsFor: 'loading' stamp: 'SeanDeNigris 7/5/2012 15:51'!loadDevelopment	"Load the #development version defined for this platform. The #development version will change over time and is not expected to be stable."	"self loadDevelopment"	<apiDocumentation>	^(self project version: #development) load! !!ConfigurationOfCommandShell class methodsFor: 'accessing' stamp: 'SeanDeNigris 7/5/2012 15:51'!project	^self new project! !!ConfigurationOfCommandShell class methodsFor: 'development support' stamp: 'SeanDeNigris 7/5/2012 15:51'!validate	"Check the configuration for Errors, Critical Warnings, and Warnings (see class comment for MetacelloMCVersionValidator for more information). 	Errors identify specification issues that will result in unexpected behaviour when you load the configuration. 	Critical Warnings identify specification issues that may result in unexpected behavior when you load the configuration.	Warnings identify specification issues that are technically correct, but are worth take a look at."	"self validate"	<apiDocumentation>	self ensureMetacello.	^ ((Smalltalk at: #MetacelloToolBox) validateConfiguration: self debug: #() recurse: false) explore! !!ConfigurationOfCommandShell methodsFor: 'baselines' stamp: 'SeanDeNigris 2/12/2013 10:52'!baseline10: spec	<version: '1.0-baseline'>	spec for: #'common' do: [		spec blessing: #'baseline'.		spec repository: 'http://www.squeaksource.com/CommandShell'.		spec project: 'OSProcess' with: [			spec				className: 'ConfigurationOfOSProcess';				loads: #('Core');				repository: 'http://www.squeaksource.com/MetacelloRepository' ].		spec			package: 'CommandShell-Base' with: [ 				"Base actually requires the following packages, but the dependency is circular, so we'll include until it''s fixed"				spec includes: #('CommandShell-Commands' 'CommandShell-Piping' 'CommandShell-UI') ];			package: 'CommandShell-Commands' with: [ spec requires: #('CommandShell-Base') ];			package: 'CommandShell-Morphic' with: [ spec requires: #('CommandShell-Base') ];			package: 'CommandShell-Piping' with: [ spec requires: #('CommandShell-Base' 'OSProcess') ];			package: 'CommandShell-UI' with: [ spec requires: #('CommandShell-Base' 'CommandShell-Morphic') ];			package: 'CommandShellPharo' with: [ spec requires: #('CommandShell-Base') ];			package: 'CommandShell-Tests' with: [ spec requires: #('CommandShell-Base' 'CommandShell-Piping' 'OSProcess') ].		spec			group: 'Core' with: #('CommandShell-Base' 'CommandShell-Commands' 'CommandShell-Morphic' 'CommandShell-Piping' 'CommandShell-UI' 'CommandShellPharo' );			group: 'Piping' with: #('CommandShell-Piping');			group: 'Tests' with: #('CommandShell-Tests'). ].		spec for: #'squeak' do: [			spec package: 'CommandShell-MVC' with: [ "Unknown dependencies" ] ].! !!ConfigurationOfCommandShell methodsFor: 'symbolic versions' stamp: 'ThierryGoubier 7/6/2015 19:10'!development: spec	<symbolicVersion: #'development'>	spec for: #'common' version: '4.6.15'.! !!ConfigurationOfCommandShell methodsFor: 'accessing' stamp: 'SeanDeNigris 7/5/2012 15:51'!project	^ project ifNil: [ | constructor |		"Bootstrap Metacello if it is not already loaded"		(self class baseConfigurationClassIfAbsent: []) ensureMetacello.		"Construct Metacello project"		constructor := (Smalltalk at: #MetacelloVersionConstructor) on: self.		project := constructor project.		project loadType: #linear. "change to #atomic if desired"		project ]! !!ConfigurationOfCommandShell methodsFor: 'symbolic versions' stamp: 'ThierryGoubier 7/6/2015 19:10'!stable: spec	<symbolicVersion: #'stable'>	spec for: #'common' version: '4.6.15'.	spec for: #'pharo1.4.x' version: '1.0'.! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'SeanDeNigris 2/12/2013 10:52'!version10: spec	<version: '1.0' imports: #('1.0-baseline' )>	spec for: #'common' do: [		spec blessing: #'development'.		spec description: ''.		spec author: 'SeanDeNigris'.		spec timestamp: '7/5/2012 15:51'.		spec project: 'OSProcess' with: [ spec version: '4.4.6' ].		spec 			package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.23';			package: 'CommandShell-Commands' with: 'CommandShell-Commands-dtl.10';			package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.1';			package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.10';			package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.9';			package: 'CommandShell-UI' with: 'CommandShell-UI-dtl.9' ].			spec for: #'pharo' do: [		spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].		spec for: #'squeak' do: [		spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.2' ].! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'SeanDeNigris 2/12/2013 10:54'!version11: spec	<version: '1.1' imports: #('1.0-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: ''.		spec author: 'StephaneDucasse'.		spec timestamp: '10/02/2013 12:57'.		spec project: 'OSProcess' with: [ spec version: '4.5' ].		spec 			package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.31';			package: 'CommandShell-Commands' with: 'CommandShell-Commands-dtl.14';			package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';			package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.13';			package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.11';			package: 'CommandShell-UI' with: 'CommandShell-UI-dtl.10' ].			spec for: #'pharo' do: [		spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #'squeak' do: [		spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ].! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'ThierryGoubier 4/25/2015 18:24'!version4612: spec	<version: '4.6.12' imports: #('1.0-baseline')>	spec		for: #common		do: [ 			spec blessing: #release.			spec description: ''.			spec author: 'ThierryGoubier'.			spec timestamp: '4/25/2015 18:19'.			spec project: 'OSProcess' with: [ spec version: '4.6.2' ].			spec				package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.41';				package: 'CommandShell-Commands' with: 'CommandShell-Commands-ThierryGoubier.16';				package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';				package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.18';				package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.11';				package: 'CommandShell-UI' with: 'CommandShell-UI-ThierryGoubier.12' ].	spec for: #pharo do: [ spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #squeak do: [ spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ]! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'ThierryGoubier 6/17/2015 20:10'!version4613: spec	<version: '4.6.13' imports: #('1.0-baseline')>	spec		for: #common		do: [ 			spec blessing: #release.			spec description: ''.			spec author: 'ThierryGoubier'.			spec timestamp: '6/17/2015 20:09'.			spec project: 'OSProcess' with: [ spec version: '4.6.3' ].			spec				package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.42';				package: 'CommandShell-Commands' with: 'CommandShell-Commands-ThierryGoubier.16';				package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';				package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.19';				package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.11';				package: 'CommandShell-UI' with: 'CommandShell-UI-ThierryGoubier.12' ].	spec for: #pharo do: [ spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #squeak do: [ spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ]! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'ThierryGoubier 6/18/2015 07:22'!version4614: spec	<version: '4.6.14' imports: #('1.0-baseline')>	spec		for: #common		do: [ 			spec blessing: #release.			spec description: ''.			spec author: 'ThierryGoubier'.			spec timestamp: '6/18/2015 07:22'.			spec project: 'OSProcess' with: [ spec version: '4.6.4' ].			spec				package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.43';				package: 'CommandShell-Commands' with: 'CommandShell-Commands-ThierryGoubier.16';				package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';				package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.19';				package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.11';				package: 'CommandShell-UI' with: 'CommandShell-UI-ThierryGoubier.12' ].	spec for: #pharo do: [ spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #squeak do: [ spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ]! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'ThierryGoubier 7/6/2015 19:15'!version4615: spec	<version: '4.6.15' imports: #('1.0-baseline')>	spec		for: #common		do: [ 			spec blessing: #release.			spec description: 'CommandShell 4.6.15By Thierry Goubier: Reimplement CrLfFileEditor as subclass of Model to remove StringHolder reference.Use CrLfFileStream only if the preferred MultiByteFileStream is not present in the image (old images).'.			spec author: 'ThierryGoubier'.			spec timestamp: '7/6/2015 19:14'.			spec project: 'OSProcess' with: [ spec version: '4.6.4' ].			spec				package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.44';				package: 'CommandShell-Commands' with: 'CommandShell-Commands-dtl.18';				package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';				package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.19';				package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.13';				package: 'CommandShell-UI' with: 'CommandShell-UI-dtl.13' ].	spec for: #pharo do: [ spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #squeak do: [ spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ]! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'ThierryGoubier 9/11/2013 10:15'!version466: spec	<version: '4.6.6' imports: #('1.0-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: ''.		spec author: 'ThierryGoubier'.		spec timestamp: '09/11/2013 10:13'.		spec project: 'OSProcess' with: [ spec version: '4.5.7' ].		spec 			package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.34';			package: 'CommandShell-Commands' with: 'CommandShell-Commands-dtl.15';			package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';			package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.14';			package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.11';			package: 'CommandShell-UI' with: 'CommandShell-UI-dtl.11' ].			spec for: #'pharo' do: [		spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #'squeak' do: [		spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ].! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'ThierryGoubier 10/24/2013 17:40'!version467: spec	<version: '4.6.7' imports: #('1.0-baseline' )>	spec for: #'common' do: [		spec blessing: #'release'.		spec description: ''.		spec author: 'ThierryGoubier'.		spec timestamp: '9/23/2013 10:12'.		spec project: 'OSProcess' with: [ spec version: '4.5.8' ].		spec 			package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.36';			package: 'CommandShell-Commands' with: 'CommandShell-Commands-ThierryGoubier.16';			package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';			package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.14';			package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.11';			package: 'CommandShell-UI' with: 'CommandShell-UI-ThierryGoubier.12' ].			spec for: #'pharo' do: [		spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #'squeak' do: [		spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ].! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'ThierryGoubier 10/5/2014 09:23'!version468: spec	<version: '4.6.8' imports: #('1.0-baseline')>	spec		for: #common		do: [ 			spec blessing: #release.			spec description: ''.			spec author: 'ThierryGoubier'.			spec timestamp: '2014-10-05T09:22:59.050216+02:00'.			spec project: 'OSProcess' with: [ spec version: '4.5.11' ].			spec				package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.37';				package: 'CommandShell-Commands' with: 'CommandShell-Commands-ThierryGoubier.16';				package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';				package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.15';				package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.11';				package: 'CommandShell-UI' with: 'CommandShell-UI-ThierryGoubier.12' ].	spec for: #pharo do: [ spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #squeak do: [ spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ]! !!ConfigurationOfCommandShell methodsFor: 'versions' stamp: 'ThierryGoubier 3/6/2015 07:17'!version469: spec	<version: '4.6.9' imports: #('1.0-baseline')>	spec		for: #common		do: [ 			spec blessing: #release.			spec description: ''.			spec author: 'ThierryGoubier'.			spec timestamp: '2014-10-05T09:22:59.050216+02:00'.			spec project: 'OSProcess' with: [ spec version: '4.5.13' ].			spec				package: 'CommandShell-Base' with: 'CommandShell-Base-dtl.38';				package: 'CommandShell-Commands' with: 'CommandShell-Commands-ThierryGoubier.16';				package: 'CommandShell-Morphic' with: 'CommandShell-Morphic-dtl.2';				package: 'CommandShell-Piping' with: 'CommandShell-Piping-dtl.16';				package: 'CommandShell-Tests' with: 'CommandShell-Tests-dtl.11';				package: 'CommandShell-UI' with: 'CommandShell-UI-ThierryGoubier.12' ].	spec for: #pharo do: [ spec package: 'CommandShellPharo' with: 'CommandShellPharo-dtl.2' ].	spec for: #squeak do: [ spec package: 'CommandShell-MVC' with: 'CommandShell-MVC-dtl.3' ]! !"ConfigurationOfCommandShell"!!ExternalPipe commentStamp: 'dtl 3/10/2006 11:06' prior: 0!I represent a pipe provided by the underlying operating system, such as a Unix pipe. I have a reader stream and a writer stream which behave similarly to a read-only FileStream and a writeable FileStream.Subclasses implement buffering behavior for the reader end of a pipe.!!OSPipe commentStamp: 'dtl 3/8/2006 07:27' prior: 0!I represent a pipe provided by the underlying operating system, such as a Unix pipe. I have a reader stream and a writer stream which behave similarly to a read-only FileStream and a writeable FileStream.I use a single-character buffer to implement #peek without losing data from the external OS pipe.!!AttachableFileStream commentStamp: '<historical>' prior: 0!I am a stream on an input or output channel provided by the underlying operating system. I behave like an ordinary file stream, except that I can attach myself to an input or output stream which has already been opened by the underlying operating system.!!AsyncFileReadStream commentStamp: 'dtl 7/9/2003 21:04' prior: 0!AsyncFileReadStream implements event-driven read behavior on a file stream. Whenever data is available, a #changed event is generated. An AsyncFileReadStream expects to have a client object respond immediately to the change notification by reading the available data, otherwise a possibly endless stream of change notifications will be generated.AsyncFileReadStream requires aio support in the AioPlugin module.!!BufferedAsyncFileReadStream commentStamp: 'dtl 3/7/2006 06:55' prior: 0!BufferedAsyncFileReadStream adds output buffering behavior to an event driven file stream, permitting blocking reads without risk of blocking the Squeak VM. This is useful for OS pipes, for which Squeak may wish to read and write the pipe without concern for VM deadlocks.A BufferedAsyncFileReadStream may be set for either blocking or nonblocking reads. When in blocking mode, a Smalltalk Process that requests a read will be blocked until data is available, but the VM will not be blocked and other Smalltalk Processes can proceed normally.Whenever data becomes available, a dataAvailableSemaphore is signalled and a #changed event is generated.!!AioEventHandlerExample commentStamp: 'dtl 7/5/2003 18:38' prior: 0!Demonstrate asynchronous read handers for file streams, OS pipes, standard input, and sockets. See class category "examples". Some examples require OSProcess.!!OSFileLock commentStamp: 'dtl 2/23/2004 19:36' prior: 0!I describe the region representing the entire addressable space of an external file, including regions that have not yet been allocated for use by the file. On platforms that support file locking, an OSFileLock is used to describe a lock on the entire file.!!OSFileRegionLock commentStamp: 'jf 2/22/2004 19:50' prior: 0!I describe an addressable region of contiguous bytes in an external file. On platforms that support file locking, an OSFileRegionLock is used to specify a portion of the file to be locked.!!OSProcess commentStamp: '<historical>' prior: 0!I represent an operating system process, such as the process in which the Squeak VM is currently running. My subclasses implement system specific features for Unix, Windows, MacOS, or other operating systems.!!ExternalOSProcess commentStamp: '<historical>' prior: 0!I represent an OSProcess other than the process in which this Squeak is executing. I maintain information about the state of the external process during and after the lifetime of the process.!!ExternalMacOSProcess commentStamp: '<historical>' prior: 0!I represent an external MacOS process other than the process in which this Squeak is executing. I maintain information about the state of the external process during and after the lifetime of the process. In particular, I hold the exit status of the process after it completes execution. When the external process changes state (e.g. it exits), the VM signals a Squeak semaphore. A singleton MacOSProcessAccessor maintains a process which waits on the semaphore, and sends a changed: #childProcessStatus message to itself, thereby notifying its dependent MacOSProcess (a singleton) to check the status of all its ExternalMacOSProcess children, and #update: them accordingly.!!ExternalOS2Process commentStamp: '<historical>' prior: 0!I represent an external OS2 process other than the process in which this Squeak is executing. I maintain information about the state of the external process during and after the lifetime of the process. In particular, I hold the exit status of the process after it completes execution. When the external process changes state (e.g. it exits), the VM signals a Squeak semaphore. A singleton OS2ProcessAccessor maintains a process which waits on the semaphore, and sends a changed: #childProcessStatus message to itself, thereby notifying its dependent OS2Process (a singleton) to check the status of all its ExternalOS2Process children, and #update: them accordingly.!!ExternalRiscOSProcess commentStamp: '<historical>' prior: 0!I represent an external RiscOS task other than the process in which this Squeak is executing. I maintain information about the state of the external task during and after the lifetime of the task. In particular, I hold the exit status of the task after it completes execution. When the external task changes state (e.g. it exits), the VM signals a Squeak semaphore. A singleton RiscOSProcessAccessor maintains a process which waits on the semaphore, and sends a changed: #childProcessStatus message to itself, thereby notifying its dependent RiscOSProcess (a singleton) to check the status of all its ExternalRiscOSProcess children, and #update: them accordingly.!!ExternalUnixOSProcess commentStamp: '<historical>' prior: 0!I represent an external Unix process other than the process in which this Squeak is executing. I maintain information about the state of the external process during and after the lifetime of the process. In particular, I hold the exit status of the process after it completes execution. When the external process changes state (e.g. it exits), the VM signals a Squeak semaphore. A singleton UnixProcessAccessor maintains a process which waits on the semaphore, and sends a changed: #childProcessStatus message to itself, thereby notifying its dependent UnixProcess (a singleton) to check the status of all its ExternalUnixProcess children, and #update: them accordingly.!!ExternalWindowsOSProcess commentStamp: '<historical>' prior: 0!I represent an external Windows process other than the process in which this Squeak is executing. I maintain information about the state of the external process during and after the lifetime of the process. In particular, I hold the exit status of the process after it completes execution. When the external process changes state (e.g. it exits), the VM signals a Squeak semaphore. A singleton WindowsOSProcessAccessor maintains a process which waits on the semaphore, and sends a changed: #childProcessStatus message to itself, thereby notifying its dependent WindowsOSProcess (a singleton) to check the status of all its ExternalWindowsOSProcess children, and #update: them accordingly.!!ThisOSProcess commentStamp: '<historical>' prior: 0!I represent the operating system process in which the Squeak VM is currently running. My subclasses implement system specific features for Unix, Windows, MacOS, or other operating systems by collaborating with corresponding subclasses of OSProcessAccessor to provide primitive access to the external operating system.!!MacProcess commentStamp: '<historical>' prior: 0!I represent a Macintosh operating system process, such as the process in which the Squeak VM is currently running. I collaborate with an instance of MacOSProcessAccessor to provide primitive access to the external operating system. My instance variables are maintained as a convenience to allow inspection of an OSProcess. Access to these variables should always be done with my accessor methods, which update the instance variables by querying my MacOSProcessAccessor.!!OS2Process commentStamp: '<historical>' prior: 0!I represent an OS2 operating system process, such as the process in which the Squeak VM is currently running. I collaborate with an instance of OS2OSProcessAccessor to provide primitive access to the external operating system. My instance variables are maintained as a convenience to allow inspection of an OSProcess. Access to these variables should always be done with my accessor methods, which update the instance variables by querying my OS2OSProcessAccessor.!!RiscOSProcess commentStamp: '<historical>' prior: 0!I represent an Acorn RiscOS operating system task, such as the task in which the Squeak VM is currently running. I collaborate with a singleton instance of RiscOSProcessAccessor to provide primitive access to the external operating system. My instance variables are maintained as a convenience to allow inspection of a RiscOSProcess. Access to these variables should always be done with my accessor methods, which update the instance variables by querying my RiscOSProcessAccessor.!!UnixProcess commentStamp: '<historical>' prior: 0!I represent the Unix operating system process in which this Squeak session is running. I collaborate with an instance of UnixOSProcessAccessor to provide access to the external operating system. My instance variables are updated when my process accessor changes, allowing them to be monitored with a Smalltalk inspector.!!WindowsProcess commentStamp: 'dtl 9/25/2005 16:31' prior: 0!I represent a Windows operating system process, such as the process in which the Squeak VM is currently running. I collaborate with an instance of WindowsOSProcessAccessor to provide primitive access to the external operating system. My instance variables are maintained as a convenience to allow inspection of an OSProcess. Access to these variables should always be done with my accessor methods, which update the instance variables by querying my WindowsOSProcessAccessor.My process ID and process handle (a Win32 HANDLE) are held by my pid and processHandle variables. The main thread for this process is held by my mainThread variable.Standard input, output, and error streams are available, and my be used when the console is open (WindowsProcess>>openConsole). They can also be reassigned to file streams (WindowsOSProcessAccessor>>setStdOut:).When external processes are created, they are added to my allMyChildren collection, and a thread is created to wait for any of them to exit. This thread is held by my childWatcherThread instance variable while the thread is active, and is also added to my threads collection.Whenever a child process exits, the childWatcherThread will signal a Semaphore (a Smalltalk Semaphore, not a Windows semaphore), then exit. A Squeak process in my processAccessor waits on this Semaphore, and sends an 'update: #childProcessStatus' message to me. In response to this, I update the status of my active child processes, one or more of which will have exited. If any of my child processes are still active, I set a new childWatcherThread to wait for them to exit.Note that some Windows applications will exit their main process after creating another application process. These applications will appear to Squeak as if they have exited immediately, even though the application is running.!!UnixProcessExitStatus commentStamp: 'dtl 8/23/2012 22:48' prior: 0!A UnixProcessExitStatus represents the exit status of a unix process. This is an integer bit field answered by the wait() system call that contains information about exit status of the process. The meaning of the bit field varies according to the cause of process exit. Following a normal process exit, the status may be decoded to provide a small positive integer value in the range 0 - 255, which is the value that is presented by a unix shell as the exit status of a program. If terminated by a signal, the corresponding value is the signal number of the signal that caused process exit.UnixExitStatus decodes the process exit status in a manner compatible with a typical GNU unix implementation. It is not guaranteed to be portable and may produce misleading results on other unix systems.!!WindowsThread commentStamp: '<historical>' prior: 0!I represent a thread of execution within a Windows process. May threadID is a uniqueidentifier for the thread, and my handle is a Windows HANDLE to the thread. My handleshould be closed when the thread exits.!!AioEventHandler commentStamp: 'dtl 11/25/2006 15:55' prior: 0!AioEventHandler responds to external IO events, such as data available on a file descriptor. When an external IO event is received, an instance of AioEventHandler sends #changed to itself to notify its dependents that the event has occurred.!!OSProcessAccessor commentStamp: 'dtl 7/7/2010 07:58' prior: 0!I am an abstract class whose subclasses provide access to an operating system process, such as the process in which the Squeak VM is currently running. My subclasses collaborate with instances of OSProcess subclasses.The single instance ThisOSProcessAccessor provides access to the OS process in which the virtual machine is running. On Unix, this instance sets a signal handler to respond to externally generated sigchld signals. This must be done after each image restart in order to call a primitive which informs the VM of the  identity of the semaphore to signal. A similar mechanism is used for Windows to obtain exit status of external OS processes. ThisOSProcessor maintains a process that waits on child exit events and updates a dependent OSProcess of changes to external OS processes.When an image is restarted on a different kind of platform, a new instance is assigned to ThisOSProcessAccessor to provide access to the virtual machine OS process.!!MacOSProcessAccessor commentStamp: '<historical>' prior: 0!I provide access to an operating system process, such as the process in which the Squeak VM is currently running. I am based on the Macintosh process model.!!OS2OSProcessAccessor commentStamp: '<historical>' prior: 0!I provide access to an operating system process, such as the process in which the Squeak VM is currently running. I am based on the OS2 process model.!!RiscOSProcessAccessor commentStamp: '<historical>' prior: 0!I provide access to the operating system process in which the Squeak VM is currently running. I am based on the RiscOS task model. There is only one instance of me, and instances of RiscOSProcess depend on me to provide access to the operating system process which they represent. I know how to create child processes. I use a semaphore to receive signals when child processes die, and I notify my dependents (instances ofRiscOSProcess) when these events occur.!!UnixOSProcessAccessor commentStamp: '<historical>' prior: 0!I provide access to the operating system process in which the Squeak VM is currently running. I am based on the Unix process model. There is only one instance of me, and instances of UnixOSProcess depend on me to provide access to the operating system process which they represent.I know how to create child processes. I use a semaphore to receive signals when child processes die, and I notify my dependents (instances of UnixOSProcess) when these events occur.!!WindowsOSProcessAccessor commentStamp: '<historical>' prior: 0!I provide access to an operating system process, such as the process in which the Squeak VM is currently running. I am based on the Win32 process model for Windows and Windows NT.!!PseudoAioEventHandler commentStamp: 'dtl 11/25/2006 10:42' prior: 0!PseudoAioEventHandler is a replacement for AioEventHandler for use when an AioPlugin is not present. It creates a polling loop by generating #changed: events periodically. With a real AioEventHandler, events are generated only when actual IO activity occurs, while the PseudoAioEventHandler produces regularly timed events regardless of whether any actual IO changes have happened.!!ExternalPipe class methodsFor: 'instance creation' stamp: 'dtl 4/2/2006 21:34'!blockingPipe	"Warning: a read on a blocking pipe will hang the VM if there is insufficient	data in the pipe to fulfill the read request."	"OSPipe blockingPipe"	^ super basicNew initialize; setBlocking! !!ExternalPipe class methodsFor: 'instance creation' stamp: 'dtl 4/2/2006 21:34'!bufferedBlockingPipe	"Warning: a read on a blocking pipe will hang the VM if there is insufficient	data in the pipe to fulfill the read request."	"OSPipe bufferedBlockingPipe"	^ (super basicNew initialize; setBlocking) setBufferedReader; yourself! !!ExternalPipe class methodsFor: 'instance creation' stamp: 'dtl 4/2/2006 21:33'!bufferedNonBlockingPipe	"OSPipe bufferedNonBlockingPipe"	^ (super basicNew initialize; setNonBlocking) setBufferedReader; yourself! !!ExternalPipe class methodsFor: 'instance creation' stamp: 'dtl 4/2/2006 21:35'!new	"ExternalPipe new"	^ self nonBlockingPipe! !!ExternalPipe class methodsFor: 'instance creation' stamp: 'dtl 3/25/2006 14:14'!nonBlockingPipe	"OSPipe nonBlockingPipe"	^ super basicNew initialize; setNonBlocking! !!ExternalPipe class methodsFor: 'examples' stamp: 'dtl 3/7/2006 19:44'!testPipe	"OSPipe testPipe inspect"	| pipe result |	pipe := self new.	pipe nextPutAll: 'string to send through an OSPipe'.	pipe writer close.	result := pipe upToEnd.	pipe close.	^ result! !!ExternalPipe methodsFor: 'testing' stamp: 'dtl 4/2/2006 21:14'!atEnd	"Answer whether the receiver can access any more objects."	^ writer closed and: [self peek == nil]! !!ExternalPipe methodsFor: 'testing' stamp: 'dtl 6/4/2006 16:01'!atEndOfFile	"Answer whether the receiver is at its end based on the result of	the last read operation. This uses feof() to test the underlying file	stream status, and can be used as an alternative to #atEnd, which	does not properly report end of file status for an OSPipe."	^ reader atEndOfFile! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 3/7/2006 20:00'!blocking	"True if reader end is set to blocking mode."	^ blocking ifNil: [blocking := true]! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 3/7/2006 20:00'!blocking: trueOrFalse	"True if reader end is set to blocking mode."	blocking := trueOrFalse! !!ExternalPipe methodsFor: 'finalization' stamp: 'dtl 3/7/2006 19:44'!close	self closeWriter; closeReader! !!ExternalPipe methodsFor: 'finalization' stamp: 'dtl 3/7/2006 19:44'!closeReader	reader ifNotNil: [reader close]! !!ExternalPipe methodsFor: 'finalization' stamp: 'dtl 3/7/2006 19:44'!closeWriter	writer ifNotNil: [writer close]! !!ExternalPipe methodsFor: 'testing' stamp: 'dtl 9/16/2002 17:35'!closed	^ reader closed! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 4/16/2003 06:01'!contents	"Answer contents of the pipe, and return the contents to the pipe so it can still be read."	"ExternalPipe new nextPutAll: 'hello'; contents"	| s |	self closed ifTrue:		[self notify: self printString, ' ', self reader printString, ' closed'.		^ nil].	s := self reader upToEnd.	s isEmpty ifFalse:		[self writer closed			ifTrue: [self notify: self printString, ' ', self writer printString,								' closed, cannot replace contents']			ifFalse: [self nextPutAll: s]].	^ s! !!ExternalPipe methodsFor: 'character writing' stamp: 'dtl 3/7/2006 19:44'!cr	"Append a return character to the receiver."	self writer cr! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 4/12/2014 16:04'!flush	^writer flush! !!ExternalPipe methodsFor: 'initialize-release' stamp: 'dtl 3/25/2006 14:08'!initialize	^ self makePipe! !!ExternalPipe methodsFor: 'testing' stamp: 'dtl 3/26/2006 15:48'!isPipe	^ true! !!ExternalPipe methodsFor: 'initialize-release' stamp: 'dtl 3/7/2006 19:44'!makePipe	"Create an OS pipe and attach it to my input and output streams."	| handleArray |	handleArray := OSProcess accessor makePipeHandles.	handleArray isNil		ifTrue:			[self error: 'cannot create OS pipe']		ifFalse:			[self reader: (AttachableFileStream							name: 'pipeReader'							attachTo: (handleArray at: 1)							writable: false).			self writer: (AttachableFileStream							name: 'pipeWriter'							attachTo: (handleArray at: 2)							writable: true)]! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 9/16/2002 17:33'!next	"Answer the next object accessible by the receiver."	^ reader next! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 9/16/2002 17:33'!next: anInteger 	"Answer the next anInteger elements of my collection."	^ reader next: anInteger! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 3/7/2006 19:44'!nextPut: anObject 	"Insert the argument, anObject, as the next object accessible by the 	receiver. Answer anObject."	^ writer nextPut: anObject! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 3/7/2006 19:44'!nextPutAll: aCollection 	"Append the elements of aCollection to the sequence of objects accessible 	by the receiver. Answer aCollection."	^ writer nextPutAll: aCollection! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 9/16/2002 17:34'!peek	^ reader peek! !!ExternalPipe methodsFor: 'printing' stamp: 'dtl 4/2/2006 11:40'!printOn: aStream	"The implementation of Stream>>printOn: has bad side effects when used	for OSPipe. This implementation is copied from Object."	| title |	title := self class name.	aStream		nextPutAll: (title first isVowel ifTrue: ['an '] ifFalse: ['a ']);		nextPutAll: title! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 3/7/2006 19:44'!reader	"Answer a stream on the read end of the pipe."	^ reader! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 3/7/2006 19:44'!reader: aReadStream	reader := aReadStream! !!ExternalPipe methodsFor: 'initialize-release' stamp: 'dtl 3/9/2006 06:40'!setBlocking	"Set the reader side of the pipe for blocking reads."	reader ifNotNil: [OSProcess accessor setBlocking: reader ioHandle].	self blocking: true! !!ExternalPipe methodsFor: 'initialize-release' stamp: 'dtl 4/2/2006 19:06'!setBufferedReader	"Use an event driven AsyncFileReadStream to represent the reader end of the pipe.	This should be used if the pipe will be read by a Smalltalk process. It should not	be used if the pipe is to be read by an external OS process."	reader ifNotNil:		[reader removeDependent: self.		reader unregister.		self reader: reader asBufferedAsyncFileReadStream.		self setNonBlocking.		reader addDependent: self.		^ true].	^ false! !!ExternalPipe methodsFor: 'initialize-release' stamp: 'dtl 3/9/2006 06:40'!setNonBlocking	"Set the reader side of the pipe for non-blocking reads."	reader ifNotNil: [OSProcess accessor setNonBlocking: reader ioHandle].	self blocking: false! !!ExternalPipe methodsFor: 'updating' stamp: 'dtl 3/15/2006 07:17'!triggerDataReady	"Notify any object waiting for data ready on the pipe."	self triggerEvent: #dataReady.! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 9/18/2002 20:29'!upToEnd	"Answer the remaining elements in the string"	reader closed		ifTrue: [^ '']		ifFalse: [^ reader upToEnd]! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 11/11/2011 09:27'!upToEndOfFile	"Answer the remaining elements in the pipe.  Use #isAtEndOfFile: to	determine end of file status with feof(), required for reliable end of	file test on OS pipes."	reader closed		ifTrue: [^ '']		ifFalse: [^ reader upToEndOfFile]! !!ExternalPipe methodsFor: 'updating' stamp: 'dtl 1/18/2003 14:31'!update: aParameter	"Notify any object waiting for data ready on the pipe."	self changed.	self triggerDataReady.	^ super update: aParameter! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 3/7/2006 19:44'!writer	"Answer a stream on the write end of the pipe."	^ writer! !!ExternalPipe methodsFor: 'accessing' stamp: 'dtl 3/7/2006 19:44'!writer: aWriteStream	writer := aWriteStream! !!OSPipe methodsFor: 'accessing' stamp: 'dtl 10/14/2001 12:16'!next	"Answer the next object accessible by the receiver."	| c |	nextChar isNil		ifTrue:			[^ [reader next]				on: Error				do: [nil]]		ifFalse:			[c := nextChar.			nextChar := nil.			^ c]! !!OSPipe methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:24'!next: anInteger 	"Answer the next anInteger elements of my collection."	| c strm |	strm := WriteStream on: String new.	(1 to: anInteger) do:		[:index |		c := self next.		c isNil			ifTrue: [^ strm contents]				ifFalse: [strm nextPut: c. false]].	^ strm contents! !!OSPipe methodsFor: 'accessing' stamp: 'dtl 5/16/2006 06:52'!peek	^ nextChar isNil		ifTrue: [reader closed				ifFalse: [nextChar := reader next]]		ifFalse: [nextChar]! !!OSPipe methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:24'!upToEnd	"Answer the remaining elements in the string. This method is retained for backward	compatibility with older versions of CommandShell."	| strm s |	strm := WriteStream on: String new.	[(s := self next: 2000) isEmpty		ifTrue: [^ strm contents]		ifFalse: [strm nextPutAll: s]] repeat! !!OSPipe methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:24'!upToEndOfFile	"Answer the remaining elements in the pipe. Use #atEndOfFile to	determine end of file status with feof(), required for reliable end of	file test on OS pipes. Compare #upToEnd, which uses the generic end	of file test in FilePlugin."	| strm d s |	strm := WriteStream on: String new.	d := Delay forMilliseconds: 200.	[(s := self next: 2000) isEmpty		ifTrue: [self atEndOfFile			ifTrue: [^ strm contents]			ifFalse: [d wait]]		ifFalse: [strm nextPutAll: s]] repeat! !!AsyncFileReadStream class methodsFor: 'examples' stamp: 'dtl 7/9/2003 20:16'!stdIn	"self stdIn"	^ super stdIn initialize! !!AsyncFileReadStream methodsFor: 'finalization' stamp: 'dtl 6/17/2006 08:08'!actAsExecutor	super actAsExecutor.	eventHandler := nil! !!AsyncFileReadStream methodsFor: 'converting' stamp: 'dtl 7/8/2003 20:53'!asAsyncFileReadStream	^ self! !!AsyncFileReadStream methodsFor: 'converting' stamp: 'dtl 7/8/2003 19:40'!asAttachableFileStream	"Answer a replacement for this object, with no asynchronous event handling.	Do not close the ioHandle when this object is finalized."	self keepOpen.	^ AttachableFileStream		name: self name		attachTo: self ioHandle		writable: self isReadOnly not! !!AsyncFileReadStream methodsFor: 'converting' stamp: 'dtl 7/8/2003 21:01'!asBufferedAsyncFileReadStream	"Answer a replacement for this object, with buffered output."	^ BufferedAsyncFileReadStream		name: self name		attachTo: self ioHandle		writable: self isReadOnly not! !!AsyncFileReadStream methodsFor: 'initialize-release' stamp: 'dtl 7/8/2003 21:48'!close	self disableEventHandling.	^ super close! !!AsyncFileReadStream methodsFor: 'read event handling' stamp: 'dtl 9/3/2010 16:50'!disableEventHandling	eventHandler		ifNotNil: [eventHandler removeDependent: self; close].	self eventHandler: nil! !!AsyncFileReadStream methodsFor: 'read event handling' stamp: 'dtl 11/25/2006 10:56'!enableEventHandling	self eventHandler: (AioEventHandler aioPluginPresent		ifTrue: [AioEventHandler				forFileStream: self				exceptions: true				readEvents: true				writeEvents: false]		ifFalse: [PseudoAioEventHandler new]).	self eventHandler addDependent: self! !!AsyncFileReadStream methodsFor: 'accessing' stamp: 'dtl 7/8/2003 19:26'!eventHandler	"The aio event handler. Provides notification whenever external data is available."	^ eventHandler! !!AsyncFileReadStream methodsFor: 'accessing' stamp: 'dtl 7/8/2003 19:26'!eventHandler: anAioEventHandler	"The aio event handler. Provides notification whenever external data is available."	eventHandler := anAioEventHandler! !!AsyncFileReadStream methodsFor: 'finalization' stamp: 'dtl 9/3/2010 16:57'!finalize	"Shut the the event handler before closing the file, otherwise aio	functions may reference a closed file handle."	eventHandler ifNotNil: [eventHandler finalize].	super finalize! !!AsyncFileReadStream methodsFor: 'read event handling' stamp: 'dtl 7/8/2003 19:29'!hasValidHandler	^ self eventHandler notNil and: [eventHandler hasValidHandler]! !!AsyncFileReadStream methodsFor: 'initialize-release' stamp: 'dtl 3/15/2006 07:45'!initialize	super initialize.	self readOnly.	OSProcess accessor setNonBlocking: self ioHandle.	self enableEventHandling! !!AsyncFileReadStream methodsFor: 'initialize-release' stamp: 'dtl 7/8/2003 21:48'!open	^ super open initialize! !!AsyncFileReadStream methodsFor: 'read, write, position' stamp: 'dtl 9/2/2006 09:58'!upToEndOfFile	"Answer a subcollection from the current access position through	the last element of the receiver.  Use #atEndOfFile to determine end	of file status with feof(), required for reliable end of file test on	OS pipes. Close the file when end of file is detected."	| b |	b := super upToEndOfFile.	self isReadOnly		ifTrue: [self close].	^ b! !!AsyncFileReadStream methodsFor: 'updating' stamp: 'dtl 7/8/2003 21:22'!update: aParameter	(aParameter == self eventHandler)		ifTrue: [self changed]! !!BufferedAsyncFileReadStream class methodsFor: 'examples' stamp: 'dtl 7/9/2003 20:24'!stdIn	"self stdIn"	^ super stdIn! !!BufferedAsyncFileReadStream methodsFor: 'finalization' stamp: 'dtl 6/17/2006 08:10'!actAsExecutor	super actAsExecutor.	nonBlockingMode := nil.	readBuffer := nil.	readSyncSemaphore := nil.	dataAvailableSemaphore := nil! !!BufferedAsyncFileReadStream methodsFor: 'read ahead buffer' stamp: 'dtl 10/1/2006 17:12'!appendAllToBuffer: chars	"Append all chars to readBuffer, then signal dataAvailableSemaphore to inform	any blocked reader that the read can proceed. Also generate a #changed event	to inform any interested objects that new data has become available."	| pos |	self readSyncSemaphore critical:		[(self readBuffer position > self maxReadBufferSize) ifTrue:			["Read buffer is getting too large. Replace it."			self readBuffer: (ReadWriteStream on: readBuffer upToEnd)].		pos := readBuffer position.		readBuffer setToEnd.		readBuffer nextPutAll: chars.		readBuffer position: pos].	self dataAvailableSemaphore signal.	self changed! !!BufferedAsyncFileReadStream methodsFor: 'read ahead buffer' stamp: 'dtl 10/1/2006 17:12'!appendToBuffer: aCharacter	"Append aCharacter to readBuffer, then signal dataAvailableSemaphore to inform	any blocked reader that the read can proceed, and trigger a #dataReady event to	inform any interested objects that new data has become available."	| pos |	self readSyncSemaphore critical:		[pos := self readBuffer position.		readBuffer setToEnd.		readBuffer nextPut: aCharacter.		readBuffer position: pos].	self dataAvailableSemaphore signal.	self changed! !!BufferedAsyncFileReadStream methodsFor: 'converting' stamp: 'dtl 7/8/2003 20:54'!asAsyncFileReadStream	"Answer a replacement for this object, with asynchronous event handling but	no buffering."	^ AsyncFileReadStream		name: self name		attachTo: self ioHandle		writable: self isReadOnly not! !!BufferedAsyncFileReadStream methodsFor: 'converting' stamp: 'dtl 7/8/2003 20:55'!asBufferedAsyncFileReadStream	^ self! !!BufferedAsyncFileReadStream methodsFor: 'testing' stamp: 'dtl 2/22/2007 08:00'!atEnd	"Answer whether the receiver can access any more objects.	Warning: If this instance represents the reader end of an OS pipe, it	is possible for the #atEnd test to give a false negative. In particular, after	closing the writer end of an empty OSPipe, the reader may not appear to	be atEnd until some time has elapsed, or until an explicit read on the pipe	causes the status to be updated. To illustrate the problem:		(OSPipe new setBufferedReader; yourself) closeWriter; atEnd>>false		(OSPipe new ) closeWriter; next; yourself; atEnd>>true		(OSPipe new setBufferedReader; yourself) closeWriter; next; yourself; atEnd>>true"	^ self readSyncSemaphore		critical: [self readBuffer atEnd				and: [super atEnd]]! !!BufferedAsyncFileReadStream methodsFor: 'testing' stamp: 'dtl 2/22/2007 08:01'!atEndOfFile	"Answer whether the receiver is at its end based on the result of	the last read operation. This uses feof() to test the underlying file	stream status, and can be used as an alternative to #atEnd, which	does not properly report end of file status for an OSPipe."	^ self readSyncSemaphore		critical: [self readBuffer atEnd				and: [fileID isNil						or: [OSProcess accessor isAtEndOfFile: fileID]]]! !!BufferedAsyncFileReadStream methodsFor: 'read, write, position' stamp: 'dtl 2/22/2007 08:02'!basicNext	"Answer the next byte from this file, or nil if at the end of the file.	If the readBuffer is empty, force a basicNext in order to ensure that	the end of file flag is updated (in stdio stream)."	(self readSyncSemaphore			critical: [self readBuffer atEnd])		ifTrue: [^ super basicNext]		ifFalse: [[self isBlocking]				ifTrue: [self waitForDataReady].			^ self readSyncSemaphore				critical: [readBuffer next]]! !!BufferedAsyncFileReadStream methodsFor: 'accessing' stamp: 'dtl 7/6/2003 10:15'!dataAvailableSemaphore	"Signalled one or more times when data becomes available. Only one Process	is permitted to wait on this Semaphore."	^ dataAvailableSemaphore ifNil: [dataAvailableSemaphore := Semaphore new]! !!BufferedAsyncFileReadStream methodsFor: 'testing' stamp: 'dtl 7/9/2003 20:59'!isBlocking	"Answer true if set to blocking mode."	^ self nonBlockingMode not! !!BufferedAsyncFileReadStream methodsFor: 'defaults' stamp: 'dtl 7/6/2003 10:15'!maxReadBufferSize	"Replace readBuffer when position exceeds this."	^ 40000! !!BufferedAsyncFileReadStream methodsFor: 'read ahead buffer' stamp: 'dtl 12/7/2012 20:02'!moveAvailableDataFrom: sqFile	| count bufferSize buffer |	(readBuffer notNil and: [readBuffer size > self readBufferMemoryWarningThreshold])		ifTrue: [self notify: 'buffer size ', readBuffer size asString.			^(Delay forSeconds: 2) wait].	bufferSize := self readAheadChunkSize.	buffer := String new: bufferSize.	[count := self primRead: sqFile				into: buffer				startingAt: 1				count: bufferSize]		on: Error	"Could fail if closed"		do: [count := 0].	(count notNil and: [count > 0])		ifTrue:			[count == bufferSize				ifTrue:					[self appendAllToBuffer: buffer]				ifFalse:					[count > 0						ifTrue:							[self appendAllToBuffer: (buffer copyFrom: 1 to: count)]]]		ifFalse:			[(self closed or: [OSProcess accessor isAtEndOfFile: self ioHandle])				ifTrue:					[self disableEventHandling]]! !!BufferedAsyncFileReadStream methodsFor: 'read ahead buffer' stamp: 'dtl 7/6/2003 20:30'!moveAvailableDataToBuffer	^ self moveAvailableDataFrom: (OSProcess accessor handleFromAccessor: self ioHandle).! !!BufferedAsyncFileReadStream methodsFor: 'read, write, position' stamp: 'dtl 9/3/2010 17:01'!next	((self readSyncSemaphore				critical: [self readBuffer atEnd])			and: [self isBlocking])		ifTrue: [self waitForDataReady].	^ self readSyncSemaphore		critical: [readBuffer next]! !!BufferedAsyncFileReadStream methodsFor: 'read, write, position' stamp: 'dtl 7/6/2003 10:15'!next: n into: aString startingAt: startIndex	"Read n bytes into the given string.	Return aString or a partial copy if less than n elements have been read."	| count |	count := self readInto: aString startingAt: startIndex count: n.	count = n		ifTrue: [^ aString]		ifFalse: [^ aString copyFrom: 1 to: startIndex+count-1]! !!BufferedAsyncFileReadStream methodsFor: 'accessing' stamp: 'dtl 7/9/2003 20:57'!nonBlockingMode	"True if nonblocking read behavior should be implemented"	^ nonBlockingMode ifNil: [nonBlockingMode := true]! !!BufferedAsyncFileReadStream methodsFor: 'accessing' stamp: 'dtl 7/9/2003 20:58'!nonBlockingMode: trueOrFalse	"True if nonblocking read behavior should be implemented"	nonBlockingMode := trueOrFalse! !!BufferedAsyncFileReadStream methodsFor: 'read, write, position' stamp: 'dtl 9/3/2010 17:01'!peek	"Answer what would be returned if the message next were sent to the	receiver. If the receiver is at the end, answer nil. "	((self readSyncSemaphore				critical: [self readBuffer atEnd])			and: [self isBlocking])		ifTrue: [self waitForDataReady].	^ self readSyncSemaphore		critical: [readBuffer peek]! !!BufferedAsyncFileReadStream methodsFor: 'defaults' stamp: 'dtl 7/6/2003 10:15'!readAheadChunkSize	"The async read ahead process will read at most this many characters.	Notes: On my system (dtl), a chunk size of 2000 leads to ExternalCommandShell	overdriving the stdout stream when doing (for example) a long directory listing.	I have added error handling to accommodate this, but I do know know how	reliable it is, so I would prefer to avoid generating the condition. A chunk	size of 200 is small enough that performance is noticably impacted in a	CommandShell window. A chunk size of 1000 seems to produce good overall	behavior."	^ 1000! !!BufferedAsyncFileReadStream methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:22'!readBuffer	"Read ahead buffer, filled asynchronously as data becomes available on the IO channel"	^ readBuffer ifNil: [readBuffer := ReadWriteStream on: String new]! !!BufferedAsyncFileReadStream methodsFor: 'accessing' stamp: 'dtl 7/6/2003 10:15'!readBuffer: aStream	readBuffer := aStream! !!BufferedAsyncFileReadStream methodsFor: 'defaults' stamp: 'dtl 12/7/2012 19:54'!readBufferMemoryWarningThreshold	"A read buffer larger that this may start causing problems. Issue a warning	before the object memory becomes too large." 	^self maxReadBufferSize * 1000! !!BufferedAsyncFileReadStream methodsFor: 'read, write, position' stamp: 'dtl 3/21/2007 21:56'!readInto: byteArray startingAt: startIndex count: count 	"Read into the given array as specified, and return the count actually	transferred. "	| s size |	self isBlocking		ifTrue: [self waitForDataReady: count.			s := self readSyncSemaphore						critical: [self readBuffer next: count].			size := count]		ifFalse: [size := self readBuffer size - readBuffer position min: count.			s := self readSyncSemaphore						critical: [self readBuffer next: size]].	byteArray		replaceFrom: startIndex		to: startIndex + size - 1		with: s.	^ size! !!BufferedAsyncFileReadStream methodsFor: 'accessing' stamp: 'dtl 7/6/2003 10:15'!readSyncSemaphore	"A semaphore for synchronizing access to readBuffer"	^ readSyncSemaphore ifNil: [readSyncSemaphore := Semaphore forMutualExclusion]! !!BufferedAsyncFileReadStream methodsFor: 'initialize-release' stamp: 'dtl 7/9/2003 20:54'!setBlocking	"Set for blocking reads. Default is nonblocking mode."	self nonBlockingMode: false! !!BufferedAsyncFileReadStream methodsFor: 'initialize-release' stamp: 'dtl 7/9/2003 20:55'!setNonBlocking	"Set for nonblocking reads. This is the default mode."	self nonBlockingMode: true! !!BufferedAsyncFileReadStream methodsFor: 'read, write, position' stamp: 'dtl 3/19/2007 18:28'!upTo: delim 	^ self readSyncSemaphore critical: [self readBuffer upTo: delim]! !!BufferedAsyncFileReadStream methodsFor: 'read, write, position' stamp: 'dtl 12/21/2007 13:14'!upToEndOfFile	"Answer a subcollection from the current access position through	the last element of the receiver.  Use #atEndOfFile to determine end	of file status with feof(), required for reliable end of file test on	OS pipes. Close the file when end of file is detected."	| newStream buffer |	buffer := buffer1 species new: 1000.	newStream := WriteStream on: (buffer1 species new: 100).	[self atEndOfFile] whileFalse:		[self moveAvailableDataToBuffer.		newStream nextPutAll: (self nextInto: buffer)].	self isReadOnly ifTrue: [self close].	^ newStream contents! !!BufferedAsyncFileReadStream methodsFor: 'updating' stamp: 'dtl 7/8/2003 22:06'!update: aParameter	"A #changed event is generated as a side effect of this method"	(aParameter == self eventHandler)		ifTrue: [self moveAvailableDataToBuffer]! !!BufferedAsyncFileReadStream methodsFor: 'read ahead buffer' stamp: 'dtl 7/6/2003 10:15'!waitForBufferAvailable	"Block if the readBuffer has grown too large. No-op for now, but add	this later if large pipes prove to be a problem."! !!BufferedAsyncFileReadStream methodsFor: 'read ahead buffer' stamp: 'dtl 7/6/2003 10:15'!waitForDataReady	"Block until at least one character is available in the readBuffer. This is not	thread safe, and only one Process is permitted to send this message."	self dataAvailableSemaphore wait! !!BufferedAsyncFileReadStream methodsFor: 'read ahead buffer' stamp: 'dtl 2/22/2007 08:09'!waitForDataReady: count 	"Block until at least count characters are available in the readBuffer"	[self readSyncSemaphore		critical: [self readBuffer size - readBuffer position < count]]		whileTrue: [self waitForDataReady]! !!AttachableFileStream class methodsFor: 'file creation' stamp: 'dtl 6/12/1999 15:53'!fileNamed: fileName	self shouldNotImplement! !!AttachableFileStream class methodsFor: 'initialize-release' stamp: 'dtl 10/19/2001 21:53'!initialize	"AttachableFileStream initialize"	UseIOHandle := (Smalltalk hasClassNamed: #IOHandle)! !!AttachableFileStream class methodsFor: 'file creation' stamp: 'dtl 6/12/1999 15:53'!isAFileNamed: fileName	self shouldNotImplement! !!AttachableFileStream class methodsFor: 'instance creation' stamp: 'dtl 3/15/2006 19:50'!name: aSymbolOrString attachTo: anIOHandle writable: readWriteFlag 	"Create a new instance attached to anIOHandle, where anIOHandle	represents an open IO channel. For write streams, this represents two	Smalltalk streams which write to the same OS file or output stream,	presumably with interleaved output. The purpose of this method is to	permit a FileStream to be attached to an existing IOHandle, such as	the IOHandle for standard input, standard output, and standard error."	^ (super basicNew		name: aSymbolOrString		attachTo: anIOHandle		writable: readWriteFlag) initialize! !!AttachableFileStream class methodsFor: 'file creation' stamp: 'dtl 6/12/1999 15:54'!newFileNamed: fileName	self shouldNotImplement! !!AttachableFileStream class methodsFor: 'file creation' stamp: 'dtl 6/12/1999 15:55'!oldFileNamed: fileName	self shouldNotImplement! !!AttachableFileStream class methodsFor: 'file creation' stamp: 'dtl 6/12/1999 15:56'!readOnlyFileNamed: fileName	self shouldNotImplement! !!AttachableFileStream class methodsFor: 'registry' stamp: 'dtl 8/25/2006 18:15'!register: anObject	"An attachable file stream is generally either a second reference to an	existing file stream, or a reference to a transient object such as a pipe	endpoint. There is no need to register it for finalization."	^ anObject! !!AttachableFileStream class methodsFor: 'examples' stamp: 'dtl 3/7/2006 06:42'!stdIn	"self stdIn"	^ self name: 'stdIn' attachTo: OSProcess thisOSProcess stdIn ioHandle writable: false! !!AttachableFileStream class methodsFor: 'registry' stamp: 'dtl 8/25/2006 18:15'!unregister: anObject	"An attachable file stream is generally either a second reference to an	existing file stream, or a reference to a transient object such as a pipe	endpoint. There is no need to register it for finalization."	^ anObject! !!AttachableFileStream methodsFor: 'converting' stamp: 'dtl 7/8/2003 21:01'!asAsyncFileReadStream	"Answer a replacement for this object, with asynchronous event handling.	Do not close the ioHandle when this object is finalized."	self keepOpen.	^ AsyncFileReadStream		name: self name		attachTo: self ioHandle		writable: self isReadOnly not! !!AttachableFileStream methodsFor: 'converting' stamp: 'dtl 9/16/2002 17:59'!asAttachableFileStream	^ self! !!AttachableFileStream methodsFor: 'converting' stamp: 'dtl 7/8/2003 21:01'!asBufferedAsyncFileReadStream	"Answer a replacement for this object, with asynchronous event handling	and buffered output. Do not close the ioHandle when this object is finalized."	self keepOpen.	^ BufferedAsyncFileReadStream		name: self name		attachTo: self ioHandle		writable: self isReadOnly not! !!AttachableFileStream methodsFor: 'finalization' stamp: 'dtl 9/17/2002 08:08'!autoClose	"Private. Answer true if the file should be automatically closed when 	this object is finalized."	^ autoClose		ifNil: [autoClose := true]! !!AttachableFileStream methodsFor: 'open/close' stamp: 'dtl 9/3/2010 17:00'!close	"Close this file."	| h |	(h := self ioHandle) ifNotNil:		[UseIOHandle			ifTrue:				[h close.				self ioHandle: nil]			ifFalse:				[self primCloseNoError: h.				self unregister.				fileID := nil]]! !!AttachableFileStream methodsFor: 'initialize-release' stamp: 'dtl 4/14/2006 09:34'!disableEventHandling	"Subclasses may disable event handling"! !!AttachableFileStream methodsFor: 'open/close' stamp: 'dtl 6/12/1999 16:00'!ensureOpen	self shouldNotImplement! !!AttachableFileStream methodsFor: 'finalization' stamp: 'dtl 7/6/2006 22:17'!finalize	self autoClose		ifTrue: [[self primCloseNoError: fileID] on: Error do: []]! !!AttachableFileStream methodsFor: 'read, write, position' stamp: 'dtl 11/8/2000 21:55'!flush	"Flush the external OS stream (the one in the C library)."	OSProcess accessor flushExternalStream: self ioHandle! !!AttachableFileStream methodsFor: 'private - IOHandle' stamp: 'dtl 1/29/2000 15:18'!ioHandle	UseIOHandle		ifTrue: [^ super ioHandle]		ifFalse: [^ fileID]! !!AttachableFileStream methodsFor: 'testing' stamp: 'dtl 3/26/2006 15:52'!isPipe	^ false! !!AttachableFileStream methodsFor: 'finalization' stamp: 'dtl 9/17/2002 08:05'!keepOpen	"Do not allow the file to be closed when this object is finalized."	autoClose := false! !!AttachableFileStream methodsFor: 'attaching' stamp: 'dtl 11/30/2002 09:22'!name: aSymbolOrString attachTo: anIOHandle writable: readWriteFlag	"Attach to an existing file handle, assumed to have been previously opened by the underlying operating system."	name := aSymbolOrString.	UseIOHandle		ifTrue: [self ioHandle: anIOHandle]		ifFalse: [fileID := anIOHandle].	readWriteFlag ifTrue: [self readWrite] ifFalse: [self readOnly].	self ascii.	UseIOHandle ifFalse: [self register]! !!AttachableFileStream methodsFor: 'open/close' stamp: 'dtl 6/12/1999 16:00'!open	self shouldNotImplement! !!AttachableFileStream methodsFor: 'open/close' stamp: 'dtl 6/12/1999 16:01'!open: fileName forWrite: writeMode	self shouldNotImplement! !!AttachableFileStream methodsFor: 'open/close' stamp: 'dtl 6/12/1999 16:02'!openReadOnly	self shouldNotImplement! !!AttachableFileStream methodsFor: 'read, write, position' stamp: 'dtl 5/17/2009 14:11'!position	"Return the receiver's current file position. If the stream is not positionable,	as in the case of a Unix pipe stream, answer 0."	^ [super position]		on: Error		do: [0]! !!AttachableFileStream methodsFor: 'open/close' stamp: 'dtl 6/12/1999 16:02'!reopen	self shouldNotImplement! !!AttachableFileStream methodsFor: 'nonblocking' stamp: 'dtl 2/17/2007 18:10'!setBlocking	OSProcess accessor setBlocking: self ioHandle! !!AttachableFileStream methodsFor: 'nonblocking' stamp: 'dtl 2/17/2007 18:10'!setNonBlocking	OSProcess accessor setNonBlocking: self ioHandle! !!AttachableFileStream methodsFor: 'read, write, position' stamp: 'dtl 9/2/2006 17:17'!upToEnd	"Answer a subcollection from the current access position through the last element	of the receiver. This is slower than the method in StandardFileStream, but it	works with pipes which answer false to #atEnd when no further input is	currently available, but the pipe is not yet closed."	| newStream buffer nextBytes |	buffer := buffer1 species new: 1000.	newStream := WriteStream on: (buffer1 species new: 100).	[self atEnd or: [(nextBytes := self nextInto: buffer) isEmpty]]		whileFalse: [newStream nextPutAll: nextBytes].	^ newStream contents! !!AttachableFileStream methodsFor: 'read, write, position' stamp: 'dtl 6/4/2006 16:02'!upToEndOfFile	"Answer a subcollection from the current access position through	the last element of the receiver.  Use #atEndOfFile to determine end	of file status with feof(), required for reliable end of file test on	OS pipes."	| newStream buffer |	buffer := buffer1 species new: 1000.	newStream := WriteStream on: (buffer1 species new: 100).	[self atEndOfFile] whileFalse: [newStream nextPutAll: (self nextInto: buffer)].	^ newStream contents! !!StandardFileStream methodsFor: '*OSProcess-Base' stamp: 'dtl 6/5/2006 06:59'!atEndOfFile	"Answer whether the receiver is at its end based on the result of	the last read operation. This uses feof() to test the underlying file	stream status, and can be used as an alternative to #atEnd, which	does not properly report end of file status for an OSPipe."	^ fileID isNil or: [OSProcess accessor isAtEndOfFile: fileID]! !!StandardFileStream methodsFor: '*OSProcess-Base' stamp: 'dtl 1/13/2007 16:44'!fileID	"The contents of fileID can and will change after calling this method.	The sender should copy the result rather than depending on the result	to be immutable."	^ fileID! !!StandardFileStream methodsFor: '*OSProcess-Base' stamp: 'dtl 6/5/2006 07:18'!isPipe	^ false! !!AioEventHandlerExample class methodsFor: 'examples' stamp: 'dtl 9/4/2003 06:22'!osPipeExample	"Demonstrate an asynchronous read hander on an OS pipe. Output will	be displayed on the Transcript."	"self osPipeExample"	| pipe aio |	(Smalltalk hasClassNamed: #OSProcess)		ifFalse:			[self notify: 'this example requires OSProcess']		ifTrue:			[pipe := (Smalltalk at: #OSPipe) new.			aio := super new handler: (AioEventHandler for: pipe reader); ioStream: pipe reader.			aio handler addDependent: aio.			(1 to: 10) do:				[:i |				pipe nextPutAll: 'this is line ', i asString; cr.				(Delay forMilliseconds: 500) wait].			^ aio handler close]! !!AioEventHandlerExample class methodsFor: 'examples' stamp: 'dtl 9/4/2003 06:22'!showTtyOnTranscript: ttyName	"Enter lines on /dev/tty, and watch them show up on the Transcript. Normally,	/dev/tty corresponds to standard input for the Squeak process, so if you have	a serial port connected to something that generates data, try this example with	/dev/whatever to demonstrate asych input on a serial port.	Warning: This method does not set the file stream for nonblocking input, so	it can block the Squeak VM. The #getAvailableData attempts to work around this,	but save your image before testing with another serial interfaces."	"self showTtyOnTranscript: '/dev/tty'"	| inputStream handler example |	inputStream := FileStream readOnlyFileNamed: '/dev/tty'.	handler := AioEventHandler for: inputStream				exceptions: true				readEvents: true				writeEvents: false.	example := super new handler: handler; ioStream: inputStream.	handler addDependent: example.	Transcript cr; show: ''.	self notify: 'Enter lines on ', ttyName, ', watch the Transcript, and select "Proceed" when done'.	^ example handler close! !!AioEventHandlerExample class methodsFor: 'examples' stamp: 'dtl 9/4/2003 06:23'!standardInputExample	"Enter lines on stdin, and watch them show up on the Transcript."	"self standardInputExample"	| aio stdin |	(Smalltalk hasClassNamed: #OSProcess)		ifFalse:			[self notify: 'this example requires OSProcess']		ifTrue:			[Transcript cr; show: ''.			stdin := (Smalltalk at: #OSProcess) thisOSProcess stdIn.			aio := super new handler: (AioEventHandler for: stdin); ioStream: stdin.			aio handler addDependent: aio.			self notify: 'Enter lines on standard input, watch the Transcript, and select "Proceed" when done'.			^ aio handler close]! !!AioEventHandlerExample class methodsFor: 'examples' stamp: 'dtl 9/4/2003 06:24'!tcpSocketExample	"Loosely based on OldSocket>>remoteTestServerTCP. Output is displayed on the Transcript."	"self tcpSocketExample"	| port serverTcpSocket serverName clientTcpSocket handler example useOldStyleSockets |	port := 8086.	serverName := '127.0.0.1'.	"The networking code was updated for Squeak 3.6. This checks for which version to use."	useOldStyleSockets := Socket respondsTo: #initializeNetworkIfFail:.	Transcript show: 'initializing network ... '.	useOldStyleSockets		ifTrue:			[Socket initializeNetworkIfFail: [^Transcript show:'failed']]		ifFalse:			[[Socket initializeNetwork]				on: Error				do: [:ex | ^Transcript show:'failed']].	Transcript show:'ok';cr.	"Create the server (reader) socket"	serverTcpSocket := Socket newTCP.	serverTcpSocket listenOn: port.	[Transcript show: 'server endpoint created on port ', port asString; cr.	useOldStyleSockets		ifTrue:			[serverTcpSocket waitForConnectionUntil: Socket standardDeadline]		ifFalse:			[serverTcpSocket waitForConnectionFor: 10]] fork.	(Delay forMilliseconds: 1000) wait.	"Create the client (writer) socket"	clientTcpSocket := Socket newTCP.	clientTcpSocket connectTo: (NetNameResolver addressFromString: serverName) port: port.	useOldStyleSockets		ifTrue:			[clientTcpSocket waitForConnectionUntil: Socket standardDeadline]		ifFalse:			[clientTcpSocket waitForConnectionFor: 10].	Transcript show: 'client endpoint connected to ', serverName, ' port ', port asString; cr.	"Set up a read event handler on the server socket"	handler := AioEventHandler for: serverTcpSocket				exceptions: true				readEvents: true				writeEvents: false.	example := super new handler: handler; ioStream: serverTcpSocket.	handler addDependent: example.	Transcript show: 'event handler started'; cr.	"Send a few lines of data to the client socket, waiting briefly between lines.	The event handler will watch the server socket, and copy data to the Transcript	each time a new line of data is available to the server."	(1 to: 10) do:		[:i |		clientTcpSocket sendData: 'this is line ', i asString, Character cr asString.		(Delay forMilliseconds: 500) wait].	clientTcpSocket closeAndDestroy.	Transcript show: 'client endpoint closed'; cr.	serverTcpSocket closeAndDestroy.	Transcript show: 'server endpoint closed'; cr.	example close.	Transcript show: 'event handler stopped'; cr.	^ Array with: example with: serverTcpSocket with: clientTcpSocket! !!AioEventHandlerExample methodsFor: 'initialize-release' stamp: 'dtl 9/4/2003 06:20'!close	self handler close.	self handler removeDependent: self! !!AioEventHandlerExample methodsFor: 'updating' stamp: 'dtl 2/24/2013 10:22'!getAvailableData	"Obtain all available data from ioStream. For a FileStream, keep reading until	a line terminator is reached. This allows use with a FileStream that has not been	set for nonblocking input."	| ws c buffer n |	buffer := String new: 4000.	(self ioStream isKindOf: FileStream)		ifTrue:			[ws := WriteStream on: String new.			[c := ioStream next.			(c == Character lf)				ifTrue: [ws nextPut: Character cr]				ifFalse: [ws nextPut: c].			(c ~= Character lf) and: [c ~= Character cr]] whileTrue.			^ ws contents]		ifFalse:			[ioStream dataAvailable				ifTrue:					[n := ioStream receiveDataInto: buffer.					^ buffer copyFrom: 1 to: n]				ifFalse:					[^ '']]! !!AioEventHandlerExample methodsFor: 'accessing' stamp: 'dtl 7/5/2003 09:40'!handler	^ handler! !!AioEventHandlerExample methodsFor: 'accessing' stamp: 'dtl 7/5/2003 09:40'!handler: anAioHandler	handler := anAioHandler! !!AioEventHandlerExample methodsFor: 'accessing' stamp: 'dtl 7/5/2003 09:57'!ioStream	^ ioStream! !!AioEventHandlerExample methodsFor: 'accessing' stamp: 'dtl 7/5/2003 09:57'!ioStream: aFileStream	ioStream := aFileStream! !!AioEventHandlerExample methodsFor: 'updating' stamp: 'dtl 7/5/2003 18:23'!update: anObject	(anObject isKindOf: AioEventHandler)		ifTrue: [Transcript show: self getAvailableData]! !!OSFileLock class methodsFor: 'instance creation' stamp: 'jf 2/22/2004 17:35'!onFile: aFileStream exclusive: writeLockFlag	"A region representing the whole file"	^ super new onFile: aFileStream exclusive: writeLockFlag! !!OSFileLock methodsFor: 'comparing' stamp: 'dtl 11/28/2010 09:18'!= aFileLock	^ ((self species = aFileLock species)		and: [self fileStream == aFileLock fileStream])			and: [self exclusive == aFileLock exclusive]! !!OSFileLock methodsFor: 'conflict testing' stamp: 'jf 2/22/2004 16:38'!conflictsWith: otherFileLock	^ (self isExclusive or: [otherFileLock isExclusive])		and: [self overlaps: otherFileLock]! !!OSFileLock methodsFor: 'accessing' stamp: 'jf 2/22/2004 16:00'!exclusive	"Answer the value of exclusive. Default is true, indicating a read-write lock	as opposed to a shared read lock."	^ exclusive ifNil: [exclusive := true].! !!OSFileLock methodsFor: 'accessing' stamp: 'jf 2/22/2004 16:00'!exclusive: anObject	"Set the value of exclusive"	exclusive := anObject! !!OSFileLock methodsFor: 'accessing' stamp: 'jf 2/22/2004 16:00'!fileStream	"Answer the value of fileStream"	^ fileStream! !!OSFileLock methodsFor: 'accessing' stamp: 'jf 2/22/2004 16:00'!fileStream: anObject	"Set the value of fileStream"	fileStream := anObject! !!OSFileLock methodsFor: 'comparing' stamp: 'jf 2/22/2004 18:32'!hash	^ (self fileStream hash + self exclusive hash) hashMultiply! !!OSFileLock methodsFor: 'testing' stamp: 'jf 2/22/2004 18:13'!isActive	^ self fileStream closed not! !!OSFileLock methodsFor: 'testing' stamp: 'jf 2/22/2004 16:01'!isExclusive	^ self exclusive! !!OSFileLock methodsFor: 'private' stamp: 'jf 2/22/2004 18:07'!length	^ 0! !!OSFileLock methodsFor: 'system locking' stamp: 'dtl 5/8/2006 06:52'!lock	"Answer true on success"	^ self lockIfFail: [false]! !!OSFileLock methodsFor: 'system locking' stamp: 'dtl 5/8/2006 06:57'!lockIfFail: failBlock	| handle result |	handle := ThisOSProcess accessor handleFromFileStream: self fileStream.	result := ThisOSProcess accessor		primLockFileRegion: handle		offset: self offset		length: self length		exclusive: self isExclusive.	result == 0		ifTrue: [^ true]		ifFalse: [^ failBlock value]! !!OSFileLock methodsFor: 'private' stamp: 'jf 2/22/2004 18:02'!offset	^ 0! !!OSFileLock methodsFor: 'initialize-release' stamp: 'jf 2/22/2004 16:02'!onFile: aFileStream exclusive: writeLockFlag	self fileStream: aFileStream.	self exclusive: writeLockFlag! !!OSFileLock methodsFor: 'comparing' stamp: 'jf 2/22/2004 16:31'!overlaps: aFileLock	"Answer true if the receiver represents an addressable region that overlaps aFileLock"		^ aFileLock fileStream fullName = self fileStream fullName! !!OSFileLock methodsFor: 'comparing' stamp: 'jf 2/22/2004 16:35'!overlapsRegion: aFileRegionLock	^ aFileRegionLock fileStream fullName = self fileStream fullName! !!OSFileLock methodsFor: 'system locking' stamp: 'dtl 5/8/2006 07:00'!test	"Answer true if this is a lockable file or region"	| handle result |	handle := ThisOSProcess accessor handleFromFileStream: self fileStream.	result := ThisOSProcess accessor		primTestLockableFileRegion: handle		offset: self offset		length: self length		exclusive: self isExclusive.			^ (result == -1 or: [result isNil])		ifTrue: [false]		ifFalse: [result first]! !!OSFileLock methodsFor: 'system locking' stamp: 'dtl 5/8/2006 06:58'!unlock	"Answer true on success"	^ self unlockIfFail: [false]! !!OSFileLock methodsFor: 'system locking' stamp: 'dtl 5/8/2006 06:57'!unlockIfFail: failBlock	| handle result |	handle := ThisOSProcess accessor handleFromFileStream: self fileStream.	result := ThisOSProcess accessor		primUnlockFileRegion: handle		offset: self offset		length: self length.	result == 0		ifTrue: [^ true]		ifFalse: [^ failBlock value]! !!OSFileRegionLock class methodsFor: 'instance creation' stamp: 'dtl 2/22/2004 13:58'!onFile: aFileStream from: start to: end exclusive: writeLockFlag	"A region representing part of a file"	^ self onFile: aFileStream interval: (start to: end) exclusive: writeLockFlag! !!OSFileRegionLock class methodsFor: 'instance creation' stamp: 'dtl 2/22/2004 13:59'!onFile: aFileStream interval: anInterval exclusive: writeLockFlag	"A region representing part of a file"	^ super new onFile: aFileStream interval: anInterval exclusive: writeLockFlag! !!OSFileRegionLock methodsFor: 'comparing' stamp: 'jf 2/22/2004 18:33'!= aFileRegion	^ (super = aFileRegion) and: [self interval = aFileRegion interval]! !!OSFileRegionLock methodsFor: 'comparing' stamp: 'jf 2/22/2004 18:33'!hash	^ (super hash + self interval hash) hashMultiply! !!OSFileRegionLock methodsFor: 'accessing' stamp: 'dtl 3/10/2005 20:23'!interval	"Answer the value of interval"	^ interval! !!OSFileRegionLock methodsFor: 'accessing' stamp: 'dtl 3/10/2005 20:23'!interval: anObject	"Set the value of interval"	interval := anObject! !!OSFileRegionLock methodsFor: 'private' stamp: 'jf 2/22/2004 18:02'!length	^ self interval size! !!OSFileRegionLock methodsFor: 'private' stamp: 'jf 2/22/2004 18:02'!offset	^ self interval first! !!OSFileRegionLock methodsFor: 'initialize-release' stamp: 'jf 2/22/2004 16:03'!onFile: aFileStream interval: anInterval exclusive: writeLockFlag	self onFile: aFileStream exclusive: writeLockFlag.	self interval: anInterval.! !!OSFileRegionLock methodsFor: 'comparing' stamp: 'jf 2/22/2004 19:47'!overlaps: aFileLock	"Call #overlapsRegion: on aFileLock since we know we're a region but we don't know whether aFileLock is"		^ aFileLock overlapsRegion: self! !!OSFileRegionLock methodsFor: 'comparing' stamp: 'jf 2/22/2004 18:56'!overlapsRegion: aFileRegionLock	^ (super overlapsRegion: aFileRegionLock) and: [(self interval intersection: aFileRegionLock interval) isEmpty not]! !!ExternalMacOSProcess class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:45'!isResponsibleForThisPlatform	"Answer true if, for the current platform, this class is responsible for representing	an OS process other than that in which the Squeak VM is currently running."	^ self isNonUnixMac! !!ExternalOS2Process class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:47'!isResponsibleForThisPlatform	"Answer true if, for the current platform, this class is responsible for representing	an OS process other than that in which the Squeak VM is currently running."	^ self isOS2! !!ExternalOSProcess class methodsFor: 'concrete subclasses' stamp: 'dtl 3/5/2005 12:02'!concreteClass	"ExternalOSProcess concreteClass"	^ self subclasses		detect: [:c | c isResponsibleForThisPlatform]		ifNone: [self notify: self printString,					': No concrete class implementation available for system type ',					self platformName printString.				nil]! !!ExternalOSProcess class methodsFor: 'instance creation' stamp: 'dtl 1/16/2001 05:36'!exec: programName	"Run a program in an external OS process, and answer an instance of myself	which represents the external process."	"ExternalOSProcess exec: '/bin/ls'"	^ self concreteClass exec: programName! !!ExternalOSProcess class methodsFor: 'shell' stamp: 'SeanDeNigris 12/27/2013 12:30'!shellFlags	^ '-c'.! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 11/8/2000 21:41'!accessor	"Answer an OSProcessAccessor which may be used to obtain information about	the external OS process which I represent."	^ OSProcess thisOSProcess processAccessor! !!ExternalOSProcess methodsFor: 'initialize - release' stamp: 'dtl 3/1/2002 06:41'!closeInitialStdErr	initialStdErr ifNotNil: [initialStdErr close]! !!ExternalOSProcess methodsFor: 'initialize - release' stamp: 'dtl 3/1/2002 06:42'!closeInitialStdIn	initialStdIn ifNotNil: [initialStdIn close]! !!ExternalOSProcess methodsFor: 'initialize - release' stamp: 'dtl 3/1/2002 06:42'!closeInitialStdOut	initialStdOut ifNotNil: [initialStdOut close]! !!ExternalOSProcess methodsFor: 'initialize - release' stamp: 'dtl 11/21/2006 14:04'!closeStreams	self closeInitialStdIn; closeInitialStdOut; closeInitialStdErr! !!ExternalOSProcess methodsFor: 'setting run state' stamp: 'dtl 3/4/2001 18:55'!complete	"Process has exited and has been reaped. It no longer exists in the external operating system."	self runState: #complete! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 3/1/2002 06:38'!initialStdErr	"The stderr stream at the time the child process is invoked. If the same as	stderr for the current Squeak process, it may change as a result of Squeak	using its stderr stream. The child process may also modify its actual stderr;	therefore this is not an accurate representation of the child process stderr	during the life of the child process."	^ initialStdErr! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 3/1/2002 06:38'!initialStdErr: anExternalStream	initialStdErr := anExternalStream! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 3/1/2002 06:39'!initialStdIn	"The stdin stream at the time the child process is invoked. If the same as	stdin for the current Squeak process, it may change as a result of Squeak	using its stdin stream. The child process may also modify its actual stdin;	therefore this is not an accurate representation of the child process stdin	during the life of the child process."	^ initialStdIn! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 3/1/2002 06:39'!initialStdIn: anExternalStream	initialStdIn := anExternalStream! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 3/1/2002 06:39'!initialStdOut	"The stdout stream at the time the child process is invoked. If the same as	stdout for the current Squeak process, it may change as a result of Squeak	using its stdout stream. The child process may also modify its actual stdout;	therefore this is not an accurate representation of the child process stdout	during the life of the child process."	^ initialStdOut! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 3/1/2002 06:40'!initialStdOut: anExternalStream	initialStdOut := anExternalStream! !!ExternalOSProcess methodsFor: 'initialize - release' stamp: 'dtl 10/6/2000 21:01'!initialize	self notYetRunning! !!ExternalOSProcess methodsFor: 'testing' stamp: 'dtl 10/7/2000 14:45'!isAccessible	^ self accessor canAccessChildProcess: self! !!ExternalOSProcess methodsFor: 'testing' stamp: 'dtl 1/20/2001 11:40'!isComplete	^ self runState == #complete! !!ExternalOSProcess methodsFor: 'testing' stamp: 'dtl 1/20/2001 11:40'!isNotYetRunning	^ self runState == #notYetRunning! !!ExternalOSProcess methodsFor: 'testing' stamp: 'dtl 1/20/2001 11:40'!isRunning	^ self runState == #running! !!ExternalOSProcess methodsFor: 'setting run state' stamp: 'dtl 3/26/2000 15:23'!notYetRunning	"Process has not yet entered running state."	self runState: #notYetRunning! !!ExternalOSProcess methodsFor: 'printing' stamp: 'dtl 3/18/2000 14:07'!printOn: aStream	super printOn: aStream.	self isComplete ifTrue: [ aStream nextPutAll: ' (', self runState, ' with status ', self exitStatus printString, ')' ]		ifFalse: [ aStream nextPutAll: ' (', self runState asString, ')' ]! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 1/25/2004 11:01'!runState	^ runState ifNil: [self unknownRunState]! !!ExternalOSProcess methodsFor: 'accessing' stamp: 'dtl 3/18/2000 12:30'!runState: aSymbol	runState := aSymbol.	self changed: #runState! !!ExternalOSProcess methodsFor: 'setting run state' stamp: 'dtl 3/26/2000 15:23'!running	"Process is actively running."	self runState: #running! !!ExternalOSProcess methodsFor: 'testing' stamp: 'dtl 12/22/2001 18:32'!succeeded	"Answer true if my process completed successfully. Be optimistic here, and let	my subclasses implement the details."	^ self isComplete! !!ExternalOSProcess methodsFor: 'setting run state' stamp: 'dtl 10/6/2000 20:59'!unknownRunState	"Unable to determine the current run state of the process, possibly because	this is a stale reference to a process which no longer exists."	self runState: #unknownRunState! !!ExternalOSProcess methodsFor: 'updating' stamp: 'dtl 2/27/2002 09:45'!update: aParameter	"Notify any dependents if my run state changes. My subclasses will do additional	updating when the run state changes."	aParameter == #runState ifTrue: [self changed: #runState]! !!ExternalRiscOSProcess class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:48'!isResponsibleForThisPlatform	"Answer true if, for the current platform, this class is responsible for representing	an OS process other than that in which the Squeak VM is currently running."	^ self isRiscOS! !!ExternalUnixOSProcess class methodsFor: 'shells' stamp: 'dtl 1/23/2013 20:21'!bashShellPath	"A more full-featured shell from the Free Software Foundation"	| path |	path := '/bin/bash'.	(OSProcess fileExists: path)		ifTrue: [^ path]		ifFalse: [self notify: path, ' not found']! !!ExternalUnixOSProcess class methodsFor: 'instance creation' stamp: 'dtl 7/12/2003 11:38'!command: aCommandString	"ExternalUnixOSProcess command: 'ls -l /etc'"	^ self forkAndExec: self defaultShellPath		arguments: (Array with: '-c' with: aCommandString)		environment: nil! !!ExternalUnixOSProcess class methodsFor: 'shells' stamp: 'dtl 1/23/2013 20:30'!defaultShellPath	"Default shell to run"	| path |	path := '/bin/sh'.	(OSProcess fileExists: path)		ifTrue: [^ path]		ifFalse: [self notify: path, ' not found']! !!ExternalUnixOSProcess class methodsFor: 'instance creation' stamp: 'dtl 1/16/2001 05:33'!exec: programName	"Run a program in an external OS process, and answer an instance of myself	which represents the external process."	^ self forkAndExec: programName! !!ExternalUnixOSProcess class methodsFor: 'instance creation' stamp: 'dtl 2/27/2002 15:25'!forkAndExec: executableFile	"ExternalUnixOSProcess forkAndExec: '/bin/ls'"	^ super new		programName: executableFile;		initialize;		forkChild! !!ExternalUnixOSProcess class methodsFor: 'instance creation' stamp: 'dtl 2/27/2002 15:25'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary 	"Run a program in an external OS process, and answer an instance of 	myself which represents the external process."	"ExternalUnixOSProcess forkAndExec: '/bin/ls' arguments: (Array with: '-l') environment: (UnixProcess env)"	^ super new		programName: executableFile;		arguments: arrayOfStrings;		initialEnvironment: stringDictionary;		initialize;		forkChild! !!ExternalUnixOSProcess class methodsFor: 'instance creation' stamp: 'dtl 2/27/2002 15:25'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams	"Run a program in an external OS process, and answer an instance of myself	which represents the external process."	"ExternalUnixOSProcess		forkAndExec: '/bin/ls'		arguments: (Array with: '-l')		environment: (UnixProcess env)		descriptors: nil"	| proc |	proc := super new		programName: executableFile;		arguments: arrayOfStrings;		initialEnvironment: stringDictionary.	arrayOf3Streams ifNotNil:		[proc initialStdIn: (arrayOf3Streams at: 1).		proc initialStdOut: (arrayOf3Streams at: 2).		proc initialStdErr: (arrayOf3Streams at: 3)].	^ proc initialize forkChild! !!ExternalUnixOSProcess class methodsFor: 'instance creation' stamp: 'dtl 2/27/2002 15:25'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams workingDir: pathString	"Run a program in an external OS process, and answer an instance of myself	which represents the external process."	"ExternalUnixOSProcess forkAndExec: '/bin/ls' arguments: nil environment: nil descriptors: nil workingDir: '/etc'"	| proc |	proc := super new		programName: executableFile;		arguments: arrayOfStrings;		initialEnvironment: stringDictionary.	arrayOf3Streams ifNotNil:		[proc initialStdIn: (arrayOf3Streams at: 1).		proc initialStdOut: (arrayOf3Streams at: 2).		proc initialStdErr: (arrayOf3Streams at: 3)].	pathString ifNotNil: [proc pwd: pathString].	^ proc initialize forkChild! !!ExternalUnixOSProcess class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:48'!isResponsibleForThisPlatform	"Answer true if, for the current platform, this class is responsible for representing	an OS process other than that in which the Squeak VM is currently running."	^ self isUnix! !!ExternalUnixOSProcess class methodsFor: 'instance creation' stamp: 'dtl 2/28/2002 10:15'!programName: executableFile arguments: arrayOfStrings initialEnvironment: stringDictionary	"Answer an instance not yet running."	^ super new		programName: executableFile;		arguments: arrayOfStrings;		initialEnvironment: stringDictionary! !!ExternalUnixOSProcess class methodsFor: 'shells' stamp: 'dtl 1/23/2013 20:21'!remoteShellPath	"A remote shell processor. This may need to be edited for different systems."	| path |	path := '/usr/bin/rsh'.	(OSProcess fileExists: path)		ifTrue: [^ path]		ifFalse: [self notify: path, ' not found']! !!ExternalUnixOSProcess class methodsFor: 'shells' stamp: 'dtl 1/23/2013 20:21'!tkShellPath	"The wish command shell for Tk/Tcl. This tends to be installed in a wide variety	of places, so you may need to edit this method for your system."	| path |	path := '/usr/bin/wish'.	(OSProcess fileExists: path)		ifTrue: [^ path]		ifFalse: [self notify: path, ' not found']! !!ExternalUnixOSProcess methodsFor: 'comparing' stamp: 'dtl 11/15/2013 10:31'!= processProxy	"True if this is a proxy that represents the same OS process as processProxy"	^ ((processProxy isKindOf: ExternalUnixOSProcess)			and: [pid = processProxy pid])				and: [ppid = processProxy ppid]! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 1/20/2001 12:48'!arguments	^ arguments! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 1/20/2001 12:49'!arguments: arrayOfArgumentStrings	arguments := arrayOfArgumentStrings! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 7/3/1999 12:34'!exitStatus	^ exitStatus! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 10/22/1999 22:21'!exitStatus: anInteger	exitStatus := anInteger! !!ExternalUnixOSProcess methodsFor: 'initialize - release' stamp: 'dtl 4/4/2006 21:16'!forkChild	"Start the external OS process. All instances variables except for pid  	should have been set. The pid will be set following creation of the new 	external process. Creating a child process is the responsibility of the	currently executing OS process, so request it to do so on behalf of this	instance of ExternalUnixOSProcess."	^ OSProcess thisOSProcess		processProxy: self		forkAndExec: programName		arguments: arguments		environment: initialEnvironment		descriptors: (Array				with: initialStdIn				with: initialStdOut				with: initialStdErr)! !!ExternalUnixOSProcess methodsFor: 'comparing' stamp: 'dtl 6/28/2010 22:26'!hash	^ (pid ifNil: [self identityHash]) + (ppid ifNil: [self identityHash])! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 3/11/2001 09:17'!initialEnvironment	^ initialEnvironment! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 1/21/2001 11:31'!initialEnvironment: aDictionary	initialEnvironment := aDictionary! !!ExternalUnixOSProcess methodsFor: 'initialize - release' stamp: 'dtl 2/11/2001 19:07'!initialize	super initialize.	^ self setDefaults! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 7/3/1999 12:51'!pid	^ pid! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 10/22/1999 22:21'!pid: aPid	pid := aPid! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 7/3/1999 12:33'!ppid	^ ppid! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 10/22/1999 22:21'!ppid: aPid	ppid := aPid! !!ExternalUnixOSProcess methodsFor: 'printing' stamp: 'dtl 8/23/2012 22:45'!printOn: aStream	self programName isNil		ifTrue:			[^ super printOn: aStream]		ifFalse:			[aStream				nextPutAll: 'an ';				nextPutAll: self class name, ' with pid ';				nextPutAll: self pid printString;				nextPutAll: ' on ';				nextPutAll: programName;				nextPutAll: ' (';				nextPutAll: self runState asString.			self isComplete				ifTrue: [aStream nextPutAll: ', ';					nextPutAll: (UnixProcessExitStatus for: exitStatus) printString].			aStream nextPut: $)].! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 1/20/2001 12:51'!programName	^ programName! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 1/20/2001 12:51'!programName: fileName	programName := fileName! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 3/31/2001 17:08'!pwd	pwd ifNil: [pwd := self accessor primGetCurrentWorkingDirectory].	^ pwd! !!ExternalUnixOSProcess methodsFor: 'accessing' stamp: 'dtl 3/31/2001 17:08'!pwd: pathString	pwd := pathString! !!ExternalUnixOSProcess methodsFor: 'initialize - release' stamp: 'dtl 3/31/2001 17:10'!setDefaults	| this |	this := OSProcess thisOSProcess.	initialEnvironment ifNil: [self initialEnvironment: this environment].	initialStdIn ifNil: [self initialStdIn: this stdIn].	initialStdOut ifNil: [self initialStdOut: this stdOut].	initialStdErr ifNil: [self initialStdErr: this stdErr].		self pwd! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:44'!sigabrt	"Send a SIGABRT signal to the external process which I represent."	OSProcess thisOSProcess sigabrt: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:52'!sigalrm	"Send a SIGALRM signal to the external process which I represent."	OSProcess thisOSProcess sigalrm: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:52'!sigchld	"Send a SIGCHLD signal to the external process which I represent."	OSProcess thisOSProcess sigchld: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:52'!sigcont	"Send a SIGCONT signal to the external process which I represent."	OSProcess thisOSProcess sigcont: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:53'!sighup	"Send a SIGHUP signal to the external process which I represent."	OSProcess thisOSProcess sighup: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:53'!sigint	"Send a SIGINT signal to the external process which I represent."	OSProcess thisOSProcess sigint: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:54'!sigkill	"Send a SIGKILL signal to the external process which I represent."	OSProcess thisOSProcess sigkill: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:54'!sigpipe	"Send a SIGPIPE signal to the external process which I represent."	OSProcess thisOSProcess sigpipe: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:55'!sigquit	"Send a SIGQUIT signal to the external process which I represent."	OSProcess thisOSProcess sigquit: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:55'!sigstop	"Send a SIGSTOP signal to the external process which I represent."	OSProcess thisOSProcess sigstop: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:55'!sigterm	"Send a SIGTERM signal to the external process which I represent."	OSProcess thisOSProcess sigterm: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:56'!sigusr1	"Send a SIGUSR1 signal to the external process which I represent."	OSProcess thisOSProcess sigusr1: self! !!ExternalUnixOSProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:56'!sigusr2	"Send a SIGUSR2 signal to the external process which I represent."	OSProcess thisOSProcess sigusr2: self! !!ExternalUnixOSProcess methodsFor: 'testing' stamp: 'dtl 12/22/2001 18:30'!succeeded	^ self isComplete and: [self exitStatus == 0]! !!ExternalUnixOSProcess methodsFor: 'terminating child' stamp: 'dtl 2/11/2001 16:08'!terminate	"Kill the child process which I represent."	self sigkill.	self finalize! !!ExternalUnixOSProcess methodsFor: 'updating' stamp: 'dtl 7/6/2006 10:06'!update: aParameter 	| accessible |	aParameter == #runState		ifTrue: [| statusArray | 			"Has the process exited?"			statusArray := self accessor primGetChildExitStatus: self pid.			statusArray notNil				ifTrue: [self exitStatus: (statusArray at: 2).						^ self complete]].	aParameter == #accessibility		ifTrue: ["Does the process still exist, and is it reachable?"			((accessible := self isAccessible) notNil and: [accessible])				ifFalse: [^ self isRunning ifTrue: [self unknownRunState]]].	super update: aParameter! !!ExternalUnixOSProcess methodsFor: 'evaluating' stamp: 'dtl 11/21/2006 14:09'!value	"Start the external process"	self isNotYetRunning ifTrue: [self forkChild; closeStreams]! !!ExternalWindowsOSProcess class methodsFor: 'instance creation' stamp: 'dtl 2/28/2002 10:56'!command: aCommandString	"ExternalWindowsOSProcess command: 'SOL'"	"ExternalWindowsOSProcess command: 'NoSuchProgram'"	^ (self commandNoEvaluate: aCommandString) value! !!ExternalWindowsOSProcess class methodsFor: 'instance creation' stamp: 'dtl 2/28/2002 10:49'!commandNoEvaluate: aCommandString	"Answer an instance not yet running."	"ExternalWindowsOSProcess commandNoEvaluate: 'SOL'"	^ super new		commandLine: aCommandString;		ppid: OSProcess thisOSProcess pid;		notYetRunning! !!ExternalWindowsOSProcess class methodsFor: 'shells' stamp: 'SeanDeNigris 12/27/2013 10:17'!defaultShellPath	^ 'C:\Windows\System32\cmd.exe'.! !!ExternalWindowsOSProcess class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:50'!isResponsibleForThisPlatform	"Answer true if, for the current platform, this class is responsible for representing	an OS process other than that in which the Squeak VM is currently running."	^ self isWindows! !!ExternalWindowsOSProcess class methodsFor: 'instance creation' stamp: 'dtl 3/1/2002 07:02'!programName: executableFile arguments: arrayOfStrings initialEnvironment: stringDictionary	"This is for protocol compatibility with ExternalUnixOSProcess. For now, just reassemble	a command line string and ignore the environment argument."	| commandLine |	commandLine := WriteStream on: String new.	commandLine nextPutAll: executableFile.	arrayOfStrings ifNotNil:		[arrayOfStrings do: [:arg | commandLine nextPut: Character space; nextPutAll: arg]].	^ self commandNoEvaluate: commandLine contents! !!ExternalWindowsOSProcess class methodsFor: 'shell' stamp: 'SeanDeNigris 12/27/2013 12:31'!shellFlags	^ '/c'.! !!ExternalWindowsOSProcess methodsFor: 'comparing' stamp: 'dtl 11/15/2013 10:30'!= processProxy	"True if this is a proxy that represents the same OS process as processProxy"	^ ((processProxy isKindOf: ExternalWindowsOSProcess)			and: [pid = processProxy pid])				and: [ppid = processProxy ppid]! !!ExternalWindowsOSProcess methodsFor: 'initialize - release' stamp: 'dtl 3/1/2002 07:44'!closeHandles	"Clean up after process exits."	self threads do: [:thread | thread closeHandle].	handle ifNotNil:		[OSProcess accessor primCloseHandle: handle.		handle := nil]! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/26/2002 10:09'!commandLine	^ commandLine! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/26/2002 10:09'!commandLine: aCommandLineString	commandLine := aCommandLineString! !!ExternalWindowsOSProcess methodsFor: 'setting run state' stamp: 'dtl 6/24/2006 08:41'!complete	"Process has exited and has been reaped. It no longer exists in the external operating system."	(threads notNil and: [threads size > 0]) ifTrue: [threads do: [:t | t complete]].	self closeHandles.	super complete! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/25/2002 08:32'!exitStatus	^ exitStatus! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/25/2002 08:33'!exitStatus: status	exitStatus := status! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/25/2002 07:24'!handle	"A Windows HANDLE for this OS process, represented as a ByteArray. The	handle should be closed when the process exits."	^ handle! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/25/2002 07:32'!handle: aHandleObject	"A Windows HANDLE for this OS process, represented as a ByteArray. The	handle should be closed when the process exits."	handle := aHandleObject! !!ExternalWindowsOSProcess methodsFor: 'comparing' stamp: 'dtl 6/28/2010 22:27'!hash	^ (pid ifNil: [self identityHash]) + (ppid ifNil: [self identityHash])! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/25/2002 07:29'!ppid	^ ppid! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/25/2002 07:29'!ppid: aProcessID	ppid := aProcessID! !!ExternalWindowsOSProcess methodsFor: 'printing' stamp: 'dtl 2/26/2002 10:42'!printOn: aStream	self commandLine isNil		ifTrue:			[^ super printOn: aStream]		ifFalse:			[aStream				nextPutAll: 'a ';				nextPutAll: self class name, ' with pid ';				nextPutAll: self pid printString.			(self isComplete and: [handle isNil])				ifTrue:					[aStream nextPutAll: ' (handle closed)']				ifFalse:					[aStream nextPutAll: ' handle ';						nextPutAll: (handle isNil							ifTrue: [handle printString]							ifFalse: [handle asArray printString])].			aStream				nextPutAll: ' on ''';				nextPutAll: commandLine;				nextPutAll: ''' (';				nextPutAll: self runState asString;				nextPut: $)]! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/28/2002 10:28'!pwd	"Answer the current working directory string."	^ pwd! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/28/2002 10:28'!pwd: pathString	"The current working directory string."	pwd := pathString! !!ExternalWindowsOSProcess methodsFor: 'accessing' stamp: 'dtl 2/25/2002 07:09'!threads	"One or more threads of execution within the OS process"	^ threads ifNil: [threads := OrderedCollection new]! !!ExternalWindowsOSProcess methodsFor: 'updating' stamp: 'dtl 2/27/2002 09:45'!update: aParameter 	| accessible stat |	aParameter == #runState		ifTrue:			["Has the process exited?"	 		stat := self accessor primGetExitStatusForHandle: self handle.			stat ifNotNil: [self complete closeHandles exitStatus: stat]].	aParameter == #accessibility		ifTrue: ["Does the process still exist, and is it reachable?"			((accessible := self isAccessible) notNil and: [accessible])				ifFalse: [self isRunning ifTrue: [self unknownRunState]]].	super update: aParameter! !!ExternalWindowsOSProcess methodsFor: 'evaluating' stamp: 'dtl 1/11/2015 13:43'!value	"Start the external process"	| procInfo mainThread |	self isNotYetRunning ifTrue:		[procInfo := OSProcess accessor primCommand: self commandLine.		procInfo isNil			ifTrue:				[self initialStdErr ifNotNilDo: [ :err |					err nextPutAll: 'cannot execute ', self commandLine; cr ].				self exitStatus: #cannotExecuteCommandLine.				"FIXME: Close the OSPipes now, otherwise the image will block on a read"				self closeStreams.				[self complete] fork "defer execution so OSPipes stay in place for now"]			ifFalse:				[self pid: (procInfo at: 3).				self handle: (procInfo at: 1).				mainThread := WindowsThread						threadID: (procInfo at: 4)						handle: (procInfo at: 2)						running: true.				self threads add: mainThread. 				self running.				OSProcess thisOSProcess registerChildProcess: self.				"FIXME: Close the initial pipe handles. For now, I have not implemented				passing these to the child, and there is no support yet for nonblocking				Windows OS pipes. Once those are available, this method needs to change				to support."				self closeStreams]].! !!OSProcess class methodsFor: 'external process access' stamp: 'dtl 11/8/2000 22:04'!accessor	"Answer an OSProcessAccessor for this OS process."	^ self thisOSProcess processAccessor! !!OSProcess class methodsFor: 'sUnit' stamp: 'dtl 6/17/2015 19:31'!allTestResults	"Run all available sUnit tests and save the results in a file named	'OSProcessTestResults-<platform>.txt'. Display results on the Transcript as	tests are run. Answer a string with the test results."	"OSProcess allTestResults"	| resultsFileName writeStream resultString results fs problems result wordSize |	self listLoadedModules		detect: [:e | '*OSProcessPlugin*' match: e]		ifNone: [self notify: 'no OSProcessPlugin loaded'].	wordSize := (Smalltalk respondsTo: #wordSize)		ifTrue: [Smalltalk wordSize]		ifFalse: [4].	resultsFileName := 'OSProcessTestResults-' , OSProcess platformName , '-' ,		(wordSize * 8) asString , 'bitImage-' ,		(OSProcess accessor sizeOfPointer * 8) asString , 'bitHw.txt'.	[fs := FileStream newFileNamed: resultsFileName.	problems := false.	writeStream := WriteStream on: String new.	writeStream nextPutAll: self authorInitials , ' running OSProcess unit tests ' , DateAndTime now asString; cr.	writeStream nextPutAll: 'OSProcess platformName => ' , OSProcess platformName; cr.	writeStream nextPutAll: 'OSProcess platformSubtype => ' , OSProcess platformSubtype; cr.	writeStream nextPutAll: 'OSProcess osVersion => ' , OSProcess osVersion; cr.	writeStream nextPutAll: 'OSProcess vmVersion => ' , OSProcess vmVersion; cr.	writeStream nextPutAll: 'size of C int: OSProcess accessor sizeOfInt ==> ' , OSProcess accessor sizeOfInt asString; cr.	writeStream nextPutAll: 'size of C pointer: OSProcess accessor sizeOfPointer ==> ' , OSProcess accessor sizeOfPointer asString; cr.	writeStream nextPutAll: 'OSProcess versionInformation asString => ' , OSProcess versionInformation asString; cr.	Transcript show: writeStream contents.	(((Class allSubInstances select: [:class | #'OSProcess-Tests' = class category]) ,		(Class allSubInstances select: [:class | #'CommandShell-Tests' = class category]))			reject: [:class | 'Abstract*' match: class name])		do: [:testCase | 			writeStream nextPutAll: 'running tests in ' , testCase name; cr.			Transcript show: 'running tests in ' , testCase name; cr.			testCase allTestSelectors				do: [:testSelector |					OSProcess thisOSProcess stdOut nextPutAll:						testCase name, '>>',testSelector, String lf; flush.					resultString := (testSelector								-> ([result := (testCase selector: testSelector) run.									result hasPassed										ifFalse: [problems := true].									result]										on: Error										do: [:ex | problems := true.											'caught exception ' , ex printString])) printString.					writeStream nextPutAll: resultString; cr.					Transcript show: resultString; cr]].	problems		ifTrue: [writeStream nextPutAll: 'one or more problems found'; cr.			Transcript show: 'one or more problems were found, see results file'; cr]		ifFalse: [writeStream nextPutAll: 'all tests completed without problems'; cr.			Transcript show: 'all tests completed without problems'; cr].	results := writeStream contents copyReplaceAll: String cr with: String lf.	fs nextPutAll: results]		ensure: [fs close].	Transcript show: 'tests results have been saved in a file named ''' , resultsFileName , ''''; cr.	^ results! !!OSProcess class methodsFor: 'external system access' stamp: 'dtl 1/7/2001 12:32'!arguments	"OSProcess arguments"	^ self thisOSProcess arguments! !!OSProcess class methodsFor: 'sUnit' stamp: 'ThierryGoubier 10/11/2013 11:16'!authorInitials	"Get the author initials from the system."	((Smalltalk respondsTo: #metacelloPlatformAttributes)		and: [ 			(Smalltalk metacelloPlatformAttributes includes: #'pharo3.x')				or: [ Smalltalk metacelloPlatformAttributes includes: #'pharo2.x' ] ])		ifTrue: [ ^ (Smalltalk at: #Author) fullName select: [ :c | c isUppercase ] ].	^ (Smalltalk at: #Utilities) authorInitials! !!OSProcess class methodsFor: 'private' stamp: 'dtl 1/7/2001 13:13'!classForThisOSProcess	"Answer the class which represents the OS process in which Squeak runs."	^ ThisOSProcess concreteClass! !!OSProcess class methodsFor: 'external command processing' stamp: 'dtl 1/7/2001 12:09'!command: aCommandString	"Run a command in a shell process. Similar to the system(3) call in the standard C library,	except that aCommandString runs asynchronously in a child process."	"OSProcess command: 'ls -l /etc'"	^ self thisOSProcess command: aCommandString! !!OSProcess class methodsFor: 'debugging' stamp: 'dtl 4/2/2005 12:32'!debugMessage: aString	"Print aString on standard output. The debug message is prefixed with the	identity of the process in which the method is being evaluated, and the	identity of the object which received the message. Useful for debugging	timing or deadlock problems."	[self thisOSProcess stdOut		"The process in which the traced message is being evaluated"		nextPutAll: Processor activeProcess hash printString, ':';		"The identity of the object being traced"		nextPutAll: thisContext sender sender sender receiver hash printString, ':';		"The debug message"		nextPutAll: aString asString; nextPut: Character lf; flush]			on: Error			do: []! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 21:48'!defaultPathString	^ self useFileSystem		ifTrue: [(((Smalltalk at: #Path) perform: #workingDirectory) perform: #asFileReference) pathString]		ifFalse: [(Smalltalk at: #FileDirectory) default pathName]! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 9/5/2013 21:11'!deleteFileNamed: fileName	"Delete the file with the given name."	self useFileSystem		ifTrue: [ | file |			file := fileName perform: #asFileReference.			( {	#ensureDelete "preferred selector" .				#ensureDeleted "pharo 2, now deprecated in favor of ensureDelete" .				#delete "fallback (earlier pharo versions?)" }					detect: [ :e | file respondsTo: e ]					ifNone: [ self error: 'do not know how to ensureDelete' ] )				ifNotNilDo: [ :sel | file perform: sel ].			(file respondsTo: #ensureDelete)				ifTrue: [ file perform: #ensureDelete ]				ifFalse: [ file perform: #ensureDeleted ] ]		ifFalse: [ (Smalltalk at: #FileDirectory) default				deleteFileNamed: fileName ]! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 21:49'!directoryEntryNames: path	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) children collect: [:e | e perform: #basename] ]		ifFalse: [ ((Smalltalk at: #FileDirectory) on: path) entries collect: [:e | e name] ]! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 21:49'!directoryExists: path	"Answer true if a directory of the given name exists. The given name may	be either a full path name or a local directory within this directory."	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) exists ]		ifFalse: [ (Smalltalk at: #FileDirectory) default directoryExists: path ]! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 21:49'!fileExists: path	"Answer true if a file of the given name exists. The given name may be	either a full path name or a local file within this directory."	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) exists ]		ifFalse: [ (Smalltalk at: #FileDirectory) default fileExists: path ]! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 3/5/2005 11:32'!getSystemAttribute: attributeID 	"After Squeak version 3.6, #getSystemAttribute was moved to SmalltalkImage "	^ ((Smalltalk classNamed: 'SmalltalkImage')		ifNil: [^ Smalltalk getSystemAttribute: attributeID]) current getSystemAttribute: attributeID! !!OSProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 21:52'!helloStdErr	"Write a message on the standard error stream of the OS process, normally	the terminal or window from which Squeak is being run. Most operating	systems implement stdin, stdout, and stderr in some manner, so this shown	as an OSProcess example even though the implemention is in my subclasses."	"OSProcess helloStdErr"	| this |	this := self thisOSProcess.	this stdErr ifNil: [self noAccessorAvailable. ^ nil].	^ this stdErr nextPutAll: 'Hello stderr'; nextPut: (Character lf); yourself! !!OSProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 21:53'!helloWorld	"Write a message on the standard output stream of the OS process, normally	the terminal or window from which Squeak is being run. Most operating	systems implement stdin, stdout, and stderr in some manner, so this shown	as an OSProcess example even though the implemention is in my subclasses."	"OSProcess helloWorld"	| this |	this := self thisOSProcess.	this stdOut ifNil: [self noAccessorAvailable. ^ nil].	^ this stdOut nextPutAll: 'Hello world'; nextPut: Character lf; yourself! !!OSProcess class methodsFor: 'initialize-release' stamp: 'dtl 10/19/2001 18:44'!initialize	"OSProcess initialize"	UseIOHandle := (Smalltalk hasClassNamed: #IOHandle)! !!OSProcess class methodsFor: 'platform identification' stamp: 'dtl 3/5/2005 11:41'!isNonUnixMac	"True if the platform is Mac OS prior to OSX"	"OSProcess isNonUnixMac"	| numericOsVersion |	numericOsVersion := self osVersion asInteger ifNil: [0].	^ (self platformName = 'Mac OS') and: [numericOsVersion < 1000]! !!OSProcess class methodsFor: 'platform identification' stamp: 'dtl 3/5/2005 11:42'!isOS2	"True if the platform is OS2"	"FIXME please - What is the correct platform name for OS2?"	"OSProcess isOS2"	^ self platformName = 'OS2'! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 9/4/2013 08:35'!isPharo3AndLater	"True if this image is a pharo of major version 3 or greater"	Smalltalk		at: #SystemVersion		ifPresent: [:cls | ((cls canUnderstand: #type) and: [ cls canUnderstand: #major ])			ifTrue: [^ cls current type = 'Pharo' and: [ cls current major >= 3 ]]].	^false! !!OSProcess class methodsFor: 'platform identification' stamp: 'dtl 8/24/2003 09:52'!isResponsibleForThisPlatform	"Answer true if this class has responsibilities for the platform on which the	Squeak VM is currently running."	^ self subclassResponsibility! !!OSProcess class methodsFor: 'platform identification' stamp: 'dtl 3/5/2005 11:43'!isRiscOS	"True if the platform is RiscOS"	"OSProcess isRiscOS"	^ self platformName = 'RiscOS'! !!OSProcess class methodsFor: 'platform identification' stamp: 'dtl 3/5/2005 11:43'!isUnix	"True if the platform is Unix (including Linux, Mac OS X, or other unix-like OS).	Note: Keep this method in sync with UnixOSProcessPlugin>>isResponsibleForThisPlatform."	"OSProcess isUnix"	| numericOsVersion |	^ (self platformName = 'unix') or:		[numericOsVersion := self osVersion asInteger ifNil: [0].		(self platformName = 'Mac OS') and: [numericOsVersion >= 1000]]! !!OSProcess class methodsFor: 'platform identification' stamp: 'dtl 3/5/2005 11:46'!isUnixMac	"True if the platform is Mac OS on OSX"	"OSProcess isUnixMac"	| osVersion numericOsVersion |	osVersion := self osVersion.	^ ('darwin*' match: osVersion "Ian's VM")		or: [numericOsVersion := osVersion asInteger ifNil: [0].			(self platformName = 'Mac OS') and: [numericOsVersion >= 1000] "John's VM"]! !!OSProcess class methodsFor: 'platform identification' stamp: 'dtl 3/5/2005 11:46'!isWindows	"True if the platform is an MS Windows OS"	"OSProcess isWindows"	^ self platformName = 'Win32'! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 10/27/2007 10:55'!listLoadedModules	"After Squeak version 3.6, #listLoadedModules was moved to SmalltalkImage "	^ ((Smalltalk classNamed: 'SmalltalkImage')		ifNil: [^ Smalltalk listLoadedModules]) current listLoadedModules! !!OSProcess class methodsFor: 'utility' stamp: 'dtl 1/24/2013 19:59'!makeVM	"Rebuild the virtual machine and plugins, assuming that this Squeak	is running from a home directory in the appropriate place in the	source code tree. If the build is successful, save the image and	restart using the new VM."	"OSProcess makeVM"	^ self makeVmIn: OSProcess defaultPathString, OSProcess pathSeparator, 'build'! !!OSProcess class methodsFor: 'utility' stamp: 'dtl 1/25/2013 18:58'!makeVmIn: buildDirectoryPathName	"Rebuild the virtual machine and plugins in the buildDirectoryPathName	directory. If the build is successful, save the image and restart using the	new VM. This assumes that the currently executing VM is either located in,	or linked to, the buildDirectoryPathName directory."	"OSProcess makeVmIn: OSProcess defaultPathString, OSProcess pathSeparator, 'build'"	^ self classForThisOSProcess makeVmIn: buildDirectoryPathName! !!OSProcess class methodsFor: 'private' stamp: 'dtl 6/29/2005 14:18'!noAccessorAvailable	self notify: 'process accessor module not available'! !!OSProcess class methodsFor: 'version dependent' stamp: 'ThierryGoubier 9/5/2013 11:13'!osVersion	"After Squeak version 3.6, #osVersion was moved to SmalltalkImage. Some	versions of Pharo move this to OSPlatform and issue deprecation warnings	about the other usages. Pharo3 deprecated OSPlatform direct access."	"self osVersion"		self isPharo3AndLater		ifTrue: [ ^ (Smalltalk perform: #os) version ].	^ (((Smalltalk hasClassNamed: #OSPlatform)			and: [(Smalltalk at: #OSPlatform)					respondsTo: #osVersion])		ifTrue: [Smalltalk at: #OSPlatform]		ifFalse: [((Smalltalk classNamed: 'SmalltalkImage')				ifNil: [^ Smalltalk osVersion]) current]) osVersion! !!OSProcess class methodsFor: 'version dependent' stamp: 'SeanDeNigris 2/13/2013 09:46'!pathSeparator	^ self useFileSystem		ifTrue: [((Smalltalk at: #DiskStore) current perform: #delimiter) asString]		ifFalse: [(Smalltalk at: #FileDirectory) slash]! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 1/2/2014 20:54'!platformName 	"After Squeak version 3.6, #platformName was moved to SmalltalkImage Some	versions of Pharo move this to OSPlatform and issue deprecation warnings	about the other usages. The original idiom (Squeak 3.6 and earlier) is the sensible	default, but here we attempt to support other implementations if the sensible	default is not available."	"OSProcess platformName"	(Smalltalk respondsTo: #platformName)		ifTrue: [^ Smalltalk platformName].	self isPharo3AndLater		ifTrue: [ ^ (Smalltalk perform: #os) name ].	^ (((Smalltalk hasClassNamed: #OSPlatform)			and: [(Smalltalk at: #OSPlatform)					respondsTo: #platformName])		ifTrue: [Smalltalk at: #OSPlatform]		ifFalse: [((Smalltalk classNamed: 'SmalltalkImage')				ifNil: [^ Smalltalk osVersion]) current]) platformName! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 9/4/2013 08:00'!platformSubtype 	"After Squeak version 3.6, #platformSubtype was moved to SmalltalkImage "	"OSProcess platformSubtype"	self isPharo3AndLater		ifTrue: [ ^ (Smalltalk perform: #os) perform: #subtype ].	^ ((Smalltalk classNamed: 'SmalltalkImage')		ifNil: [^ Smalltalk platformSubtype]) current platformSubtype! !!OSProcess class methodsFor: 'external system access' stamp: 'dtl 1/7/2001 12:32'!programName	"OSProcess programName"	^ self thisOSProcess programName! !!OSProcess class methodsFor: 'utility' stamp: 'dtl 1/7/2001 12:35'!quitAndRestart	"Save image, start a new instance from the saved image, and quit this instance.	This is useful if the VM has been recompiled or if a new pluggable primitive	has been added."	"OSProcess quitAndRestart"	| firstPid this |	firstPid := OSProcess thisOSProcess pid.	firstPid ifNil: 			[self noAccessorAvailable.			^ nil].	Smalltalk saveSession.	"Value of firstPid gets saved in the image"	this := OSProcess thisOSProcess.	this pid = firstPid ifTrue: [self squeak ifNotNil: [Smalltalk quitPrimitive]].	^ this! !!OSProcess class methodsFor: 'examples' stamp: 'dtl 11/8/2000 23:23'!readFromStdIn	"Type some text on the standard input terminal, followed by <return> or <enter>,	then call this method. Any available input text in the stdin stream will be read.	This method sets standard input for the Squeak OS process for non-blocking reads	in order to prevent the Smalltalk image from blocking on the read. After the read,	standard input is set back to its normal blocking I/O mode.	Most operating systems implement stdin, stdout, and stderr in some manner, so this	is shown as an OSProcess example even though the implemention is in my subclasses."	"OSProcess readFromStdIn inspect"	| input ioHandle resultString |	input := self thisOSProcess stdIn.	input ifNil: [self noAccessorAvailable. ^ nil].	ioHandle := input ioHandle.	self accessor setNonBlocking: ioHandle.	resultString := self thisOSProcess stdIn next: 10000.	self accessor setBlocking: ioHandle.	^ resultString! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 12/15/2013 14:53'!snapshot: save andQuit: quit	"After Squeak version 3.6, #snapshot:andQuit: was moved to SmalltalkImage "	^ ((Smalltalk classNamed: 'SmalltalkImage')		ifNil: [^ Smalltalk snapshot: save andQuit: quit embedded: false]) current snapshot: save andQuit: quit! !!OSProcess class methodsFor: 'external command processing' stamp: 'dtl 1/7/2001 13:06'!squeak	"Start a new instance of Squeak running in a child OS process. The new instance	will restart from the image file, so it is a clone of this image as it existed at the	most recent image save. Note that subclasses can implement additional methods of	starting Squeak images, especially for Unix systems."	"OSProcess squeak"	^ self thisOSProcess squeak! !!OSProcess class methodsFor: 'utility' stamp: 'dtl 3/5/2005 11:34'!systemAttributes	"Answer a Dictionary of all of the system attributes which can be obtained from	SystemDictionary>>getSystemAttribute."	"OSProcess systemAttributes"	| args idx a |	args := Dictionary new.	idx := -1.	[a := self getSystemAttribute: idx.	a notNil and: [a size > 0]]		whileTrue: [args at: idx put: a. idx := idx - 1].	a := self getSystemAttribute: 0.	(a notNil and: [a size > 0]) ifTrue: [args at: 0 put: a. idx := idx - 1].	a := self getSystemAttribute: 1.	(a notNil and: [a size > 0]) ifTrue: [args at: 1 put: a. idx := idx - 1].	a := self getSystemAttribute: 2.	(a notNil and: [a size > 0]) ifTrue: [args at: 2 put: a. idx := idx - 1].	idx := 2.	[a := self getSystemAttribute: idx.	a notNil and: [a size > 0]]		whileTrue: [args at: idx put: a. idx := idx + 1].	idx := 1001.	[a := self getSystemAttribute: idx.	a notNil and: [a size > 0]]		whileTrue: [args at: idx put: a. idx := idx + 1].	^ args.! !!OSProcess class methodsFor: 'instance creation' stamp: 'dtl 1/7/2001 12:03'!thisOSProcess	"Answer the single instance of the class corresponding to the OS process in which	this Smalltalk image is executing."	"OSProcess thisOSProcess"	^ ThisOSProcess thisOSProcess! !!OSProcess class methodsFor: 'debugging' stamp: 'dtl 4/2/2005 12:32'!trace	"Print the sender's context on standard output. The debug message is	prefixed with the identity of the process in which the method is being	evaluated, and the identity of the object which received the message.	Useful for debugging timing or deadlock problems."	[self thisOSProcess stdOut		"The process in which the traced message is being evaluated"		nextPutAll: Processor activeProcess hash printString, ':';		"The identity of the object being traced"		nextPutAll: thisContext sender sender sender receiver hash printString, ':';		"The method context describing the method being evaluated"		nextPutAll: thisContext sender sender sender printString;		nextPut: Character lf;		flush]			on: Error			do: []! !!OSProcess class methodsFor: 'debugging' stamp: 'dtl 4/2/2005 12:30'!trace: debugMessageString	"Print trace information followed by a debug message"	[self thisOSProcess stdOut		"The process in which the traced message is being evaluated"		nextPutAll: Processor activeProcess hash printString, ':';		"The identity of the object being traced"		nextPutAll: thisContext sender sender sender receiver hash printString, ':';		"The method context describing the method being evaluated"		nextPutAll: thisContext sender sender sender printString, ':';		nextPutAll: debugMessageString;		nextPut: Character lf;		flush]			on: Error			do: []! !!OSProcess class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 21:48'!useFileSystem	"If true use FileSystem, otherwise use traditional FileDirectory. See senders	for methods with file system dependencies."	^ Smalltalk hasClassNamed: #FileReference! !!OSProcess class methodsFor: 'version testing' stamp: 'dtl 8/7/2003 07:28'!versionInformation	"OSProcess versionInformation"	| osppVersion |	osppVersion := (Smalltalk hasClassNamed: #OSProcessPlugin)		ifTrue:			[(Smalltalk at: #OSProcessPlugin) versionInformation]		ifFalse:			['(not installed in this image)'].	^ Array		with: (self name, ' version ', self versionString)		with: ((Smalltalk hasClassNamed: #CommandShell)				ifTrue:					[((Smalltalk at: #CommandShell) respondsTo: #versionString)						ifTrue:							['CommandShell version ', (Smalltalk at: #CommandShell) versionString]						ifFalse:							['CommandShell installed (old version, no versionString)']]				ifFalse:					['CommandShell is not installed'])		with:  osppVersion! !!OSProcess class methodsFor: 'version testing' stamp: 'dtl 6/17/2015 21:38'!versionString	"OSProcess versionString"	^'4.6.4'! !!OSProcess class methodsFor: 'version dependent' stamp: 'ThierryGoubier 9/5/2013 11:12'!vmVersion 	"After Squeak version 3.6, #vmVersion was moved to SmalltalkImage. Pharo3 deprecated vmVersion."	self isPharo3AndLater		ifTrue: [ ^ (Smalltalk perform: #vm) version ].	^ ((Smalltalk classNamed: 'SmalltalkImage')		ifNil: [^ Smalltalk vmVersion]) current vmVersion! !!OSProcess class methodsFor: 'external command processing' stamp: 'dtl 1/7/2001 12:11'!waitForCommand: aCommandString	"Run a command in a shell process. Similar to the system(3) call in the standard C library.	The active Smalltalk process waits for completion of the external command process."	"OSProcess waitForCommand: 'echo sleeping...; sleep 3; echo I just slept for three seconds'"	^ self thisOSProcess waitForCommand: aCommandString! !!OSProcess methodsFor: 'initialize - release' stamp: 'dtl 5/31/1999 13:54'!initialize	self subclassResponsibility! !!OSProcess methodsFor: 'testing' stamp: 'dtl 7/14/2001 21:12'!isExternalProcess	^ true! !!OSProcess methodsFor: 'private' stamp: 'dtl 8/30/2003 10:11'!noAccessorAvailable	^ self class noAccessorAvailable! !!OSProcess methodsFor: 'accessing' stamp: 'dtl 3/18/2000 13:57'!pid	^ pid! !!OSProcess methodsFor: 'accessing' stamp: 'dtl 3/18/2000 13:58'!pid: processIdentifier	pid := processIdentifier! !!OSProcess methodsFor: 'printing' stamp: 'dtl 10/17/1999 21:12'!printOn: aStream	super printOn: aStream. aStream nextPutAll: ' with pid '. self pid printOn: aStream! !!MacProcess class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:46'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for	the Squeak VM running on the current platform."	^ self isNonUnixMac! !!MacProcess methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:18'!command: aCommandString	"Run a command in a shell process. Similar to the system(3) call in	the standard C library, except that aCommandString runs asynchronously	in a child process. Answer an instance of ExternalMacOSProcess which	is a proxy for the new MacOS process."	self notYetImplemented! !!MacProcess methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:18'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams	"Use my processAccessor to call vfork() and execve() and create a	new child task. Answer a proxy for the new task, an instance of	ExternalMacOSProcess."	self notYetImplemented! !!MacProcess methodsFor: 'environment' stamp: 'dtl 1/23/2013 21:10'!getCwd	"Not yet implemented - answer a reasonable default."	^ OSProcess defaultPathString! !!MacProcess methodsFor: 'initialize - release' stamp: 'dtl 10/14/2001 14:03'!initialize	"Set my instance variables to reflect the state of the OS process in which 	this Smalltalk virtual machine is executing."! !!MacProcess methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:46'!isResponsibleForThisPlatform	"Answer true is this is an instance of the class which is responsible for representing	the OS process for the Squeak VM running on the current platform. A false answer is	usually the result of running the image on a different platform and VM."	^ self class isNonUnixMac! !!OS2Process class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:47'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for	the Squeak VM running on the current platform."	^ self isOS2! !!OS2Process methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:18'!command: aCommandString	"Run a command in a shell process. Similar to the system(3) call in	the standard C library, except that aCommandString runs asynchronously	in a child process. Answer an instance of ExternalOS2OSProcess which	is a proxy for the new OS2 process."	self notYetImplemented! !!OS2Process methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:18'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams	"Use my processAccessor to call vfork() and execve() and create a	new child task. Answer a proxy for the new task, an instance of	ExternalOS2OSProcess."	self notYetImplemented! !!OS2Process methodsFor: 'environment' stamp: 'dtl 1/23/2013 21:09'!getCwd	"Not yet implemented - answer a reasonable default."	^ OSProcess defaultPathString! !!OS2Process methodsFor: 'initialize - release' stamp: 'dtl 10/14/2001 14:03'!initialize	"Set my instance variables to reflect the state of the OS process in which 	this Smalltalk virtual machine is executing."! !!OS2Process methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:47'!isResponsibleForThisPlatform	"Answer true is this is an instance of the class which is responsible for representing	the OS process for the Squeak VM running on the current platform. A false answer is	usually the result of running the image on a different platform and VM."	^ self class isOS2! !!RiscOSProcess class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:48'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for	the Squeak VM running on the current platform."	^ self isRiscOS! !!RiscOSProcess class methodsFor: 'utility' stamp: 'dtl 3/11/2001 11:47'!makeVmIn: buildDirectoryPathName	"Rebuild the virtual machine and plugins in the buildDirectoryPathName	directory. If the build is successful, save the image and restart	using the new VM. This assumes that the currently executing VM is	either located in, or linked to, the buildDirectoryPathName directory."! !!RiscOSProcess methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:18'!command: aCommandString	"Run a command in a shell process. Similar to the system(3) call in	the standard C library, except that aCommandString runs asynchronously	in a child process. Answer an instance of ExternalRiscOSProcess which	is a proxy for the new RiscOS task."	self notYetImplemented! !!RiscOSProcess methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:18'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams	"Use my processAccessor to call vfork() and execve() and create a	new child task. Answer a proxy for the new task, an instance of	ExternalRiscOSProcess."	self notYetImplemented! !!RiscOSProcess methodsFor: 'environment' stamp: 'dtl 1/23/2013 21:10'!getCwd	"Not yet implemented - answer a reasonable default."	^ OSProcess defaultPathString! !!RiscOSProcess methodsFor: 'initialize - release' stamp: 'dtl 10/14/2001 14:04'!initialize	"Set my instance variables to reflect the state of the OS process in which 	this Smalltalk virtual machine is executing."! !!RiscOSProcess methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:48'!isResponsibleForThisPlatform	"Answer true is this is an instance of the class which is responsible for representing	the OS process for the Squeak VM running on the current platform. A false answer is	usually the result of running the image on a different platform and VM."	^ self class isRiscOS! !!ThisOSProcess class methodsFor: 'concrete subclasses' stamp: 'dtl 3/5/2005 12:08'!concreteClass	"ThisOSProcess concreteClass"	^ self subclasses		detect: [:c | c isResponsibleForThisPlatform]		ifNone: [self notify: self printString,					': No concrete class implementation available for system type ',					self platformName printString.				nil]! !!ThisOSProcess class methodsFor: 'concrete subclasses' stamp: 'dtl 6/28/2010 21:14'!concreteClassOrNil	"ThisOSProcess concreteClassOrNil"	^ self subclasses		detect: [:c | c isResponsibleForThisPlatform]		ifNone: [nil]! !!ThisOSProcess class methodsFor: 'initialize-release' stamp: 'dtl 2/6/2015 20:53'!initialize	"ThisOSProcess initialize"	OSProcess initialize. "required to ensure the change sets file in smoothly"	AttachableFileStream initialize.	OSProcessAccessor initialize.	ChildListSize := 20. "list will be pruned to this size, except for any children still running"	self initializeThisOSProcess.	Smalltalk addToStartUpList: ThisOSProcess.	Smalltalk addToShutDownList: ThisOSProcess! !!ThisOSProcess class methodsFor: 'initialize-release' stamp: 'dtl 8/25/2010 22:58'!initializeThisOSProcess	"Initialize the singleton instance, creating a new instance only if the	platform type has changed since shutdown (running on a different	type of computer)."	(ThisInstance isNil or: [ThisInstance isResponsibleForThisPlatform not])		ifTrue: [ | cls |			(cls := self concreteClassOrNil)				ifNil: [ThisInstance := nil "no concrete class for this platform"]				ifNotNil: [ThisInstance := cls basicNew]].	ThisInstance initialize! !!ThisOSProcess class methodsFor: 'initialize-release' stamp: 'dtl 7/5/2010 11:56'!initializeThisOSProcessWithNotifier	"Initialize the singleton instance, creating a new instance only if the	platform type has changed since shutdown (running on a different	type of computer). Warn if no implementation is available for this platform."	(ThisInstance isNil or: [ThisInstance isResponsibleForThisPlatform not])		ifTrue: [ThisInstance := self concreteClass basicNew].	ThisInstance initialize! !!ThisOSProcess class methodsFor: 'testing' stamp: 'dtl 8/18/2014 20:08'!isHeadless	"Answer true if the image is known to be headless, otherwise assume	that a user interface is present."	(Smalltalk respondsTo: #isHeadless)		ifTrue: [ ^Smalltalk perform: #isHeadless ].	^ false "assume that a UI is present"! !!ThisOSProcess class methodsFor: 'instance creation' stamp: 'dtl 11/5/2000 16:10'!new	self notify: self name, ': Only one instance of ThisOSProcess or any of its subclasses should exist in the image. Use #thisOSProcess to obtain the singleton instance.'.	self shouldNotImplement! !!ThisOSProcess class methodsFor: 'system startup' stamp: 'dtl 3/8/2013 18:42'!shutDown: quitting	"Break dependency on my OSProcessAccessor. This is done explicitly at	shutDown time in order to prevent possible problems when an image is	restarted on another platform type, in which case a new ThisOSProcess	instance is created and the old instance could still have an unwanted	dependency on an OSProcessAccessor."	quitting ifTrue: [OSProcess accessor				ifNotNilDo: [:acc | acc breakDependents]]! !!ThisOSProcess class methodsFor: 'system startup' stamp: 'dtl 2/6/2015 20:19'!startUp: resuming	"Initialize my singleton instance, and the singleton instance of my	OSProcessAccessor. On Unix, set the signal handler in my process	accessor to respond to externally generated sigchld signals. This	must be done after each image restart in order to call a primitive	which informs the VM of the identity of the semaphore to signal.	When not running on a Unix system, the primitive fails and the	method has no effect. Notify dependents of the singleton instance	if the image has restarted in a different OS process (this is not the	case when #startUp is called after a simple image save). The	notification is done in the initialization of my OSProcessAccessor."	| aio |	(aio := Smalltalk at: #AioEventHandler)		ifNotNil: [ aio startUp: resuming ].	resuming ifTrue: [ self initializeThisOSProcess ]! !!ThisOSProcess class methodsFor: 'instance creation' stamp: 'dtl 10/1/2006 08:38'!thisOSProcess	"Answer a single instance of the class corresponding to the OS process in 	which this Smalltalk image is executing."	"ThisOSProcess thisOSProcess"	^ ThisInstance! !!ThisOSProcess methodsFor: 'comparing' stamp: 'dtl 11/15/2013 10:30'!= processProxy	"True if this is a proxy that represents the same OS process as processProxy"	^ ((processProxy isKindOf: ThisOSProcess)			and: [pid = processProxy pid])		and: [sessionID = processProxy sessionID]! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 6/5/2015 20:13'!activeChildren	"Answer child processes which are currently believed to be running."	"OSProcess thisOSProcess activeChildren"	^ accessProtect critical: [ childProcessList select: [ :p | p isComplete not ] ].! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/6/2015 19:50'!allMyChildren	^ Dictionary withAll: (childProcessList collect: [ :e | e pid -> e ])! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/5/2003 21:59'!canConnectToXDisplay: xDisplayName	"Open and close a connection to displayName. It the connection was successfully	opened, answer true; otherwise false. This is intended to check for the ability	to open an X display prior to actually making the attempt."	"self thisOSProcess canConnectToXDisplay: ':0.0' "	"self thisOSProcess canConnectToXDisplay: ':1' "	"self thisOSProcess canConnectToXDisplay: 'bogus:0' " "<-make sure network is running first!!"	(xDisplayName isKindOf: String) ifFalse: [^ false].	^ self processAccessor primCanConnectToXDisplay: xDisplayName! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/6/2015 20:11'!childPids	^ childProcessList collect: [ :p | p pid ]! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/6/2003 06:35'!closeXDisplay	"Become headless by closing the X session. All subsequent processing should involve	no further display interaction."	"self thisOSProcess closeXDisplay"	| proc |	proc := self processAccessor primKillDisplay.	proc ifNil: [self noAccessorAvailable].	^ proc! !!ThisOSProcess methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:15'!command: aCommandString	"Run a command in a shell process. Similar to the system(3) call in	the standard C library, except that aCommandString runs asynchronously	in a child process. Answer an instance of ExternalMacOSProcess which	is a proxy for the new OS process."	self subclassResponsibility! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/5/2003 22:05'!currentXDisplayName	"self thisOSProcess currentXDisplayName"	^ self processAccessor primGetXDisplayName! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/6/2003 06:35'!decapitate	"Become headless by closing the X session. All subsequent processing should involve	no further display interaction."	"self thisOSProcess decapitate"	^ self closeXDisplay! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/6/2015 20:12'!discardExitedChildren	"Remove entries for completed child processed from dictionary."	self updateAllMyChildren.	childProcessList		select: [ :p | p isComplete ]		thenDo: [ :e | self unregisterChildProcess: e ].	^ childProcessList! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/6/2003 06:30'!disconnectXDisplay	"Disconnect from the X server, but do not close the existing Squeak window. A new	display medium must be opened before further interaction with the display."	"self thisOSProcess disconnectXDisplay"	| proc |	proc := self processAccessor primDisconnectDisplay.	proc ifNil: [self noAccessorAvailable].	^ proc! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/5/2003 22:12'!displayOnXServer: xDisplayName	"Check if it is possible to open a display on the X server identified by	xDisplayName. If so, close the current X display and reopen it on	the new server. On success, answer the previous display name. On	failure, answer a string with an error message. This method is expected	to be called by a web server or other application which may wish to	make use of the result string."	"self thisOSProcess displayOnXServer: ':0.0' "	"self thisOSProcess displayOnXServer: 'unix:0' "	"self thisOSProcess displayOnXServer: ':1' "	"self thisOSProcess displayOnXServer: 'noSuchMachine'"	"self thisOSProcess displayOnXServer: 'noSuchMachine:0'" "<-make sure network is running first!!"	| previousDisplayName |	(xDisplayName isKindOf: String)		ifFalse: [^ 'expected display name string'].	previousDisplayName := self currentXDisplayName.	(self canConnectToXDisplay: xDisplayName)		ifTrue:			[self decapitate.			self setXDisplayName: xDisplayName.			self recapitate.			^ previousDisplayName]		ifFalse:			[^ 'cannot connect to display ', xDisplayName]! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/6/2015 20:14'!exitedChildren	"Answer child processes which have exited and are no longer running."	"OSProcess thisOSProcess exitedChildren"	^ accessProtect critical: [ childProcessList select: [ :p | p isComplete ]].! !!ThisOSProcess methodsFor: 'finalization' stamp: 'dtl 11/4/2000 15:49'!finalize	processAccessor		ifNotNil: 			[processAccessor removeDependent: self.			processAccessor finalize].	processAccessor := nil! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 9/1/2003 13:15'!flushXDisplay	"Synchronize output to the X display."	"self thisOSProcess flushXDisplay"	^ self processAccessor primFlushXDisplay! !!ThisOSProcess methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:16'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams	"Use my processAccessor to call vfork() and execve() and create a	new child task. Answer a proxy for the new task, an instance of	ExternalOSProcess."	self subclassResponsibility! !!ThisOSProcess methodsFor: 'environment' stamp: 'dtl 10/18/2001 20:10'!getCwd	self subclassResponsibility! !!ThisOSProcess methodsFor: 'private - IOHandle' stamp: 'dtl 9/25/2005 16:23'!handleFromAccessor: aByteArrayOrIOAccessor	UseIOHandle		ifTrue: [aByteArrayOrIOAccessor isNil			ifTrue: [^ nil]			ifFalse: [^ aByteArrayOrIOAccessor asSQFileStruct]]		ifFalse: [^ aByteArrayOrIOAccessor]! !!ThisOSProcess methodsFor: 'private - IOHandle' stamp: 'dtl 9/25/2005 16:22'!handleFromFileStream: aFileStream	UseIOHandle		ifTrue: [^ aFileStream ioHandle asSQFileStruct]		ifFalse: [^ aFileStream fileID]! !!ThisOSProcess methodsFor: 'comparing' stamp: 'dtl 6/27/2010 22:38'!hash	^ (pid ifNil: [self identityHash])		+ (sessionID				ifNil: [0]				ifNotNil: [sessionID sum])! !!ThisOSProcess methodsFor: 'initialize - release' stamp: 'dtl 7/26/2010 13:51'!initialize	"Set my instance variables to reflect the state of the OS process in which 	this Smalltalk virtual machine is. executing."	accessProtect := Semaphore forMutualExclusion.	self initializeAllMyChildren.	processAccessor ifNotNil:		[processAccessor breakDependents.		processAccessor := nil].	((self processAccessor notNil		and: [processAccessor canAccessSystem])			and: [pid ~= processAccessor primGetPid])		ifTrue: [self resetChildProcessDictionary]! !!ThisOSProcess methodsFor: 'initialize - release' stamp: 'dtl 2/4/2015 23:35'!initializeAllMyChildren	"Use a Dictionary if process identifiers are unique. On Windows, the	process ID is not unique, so use an OrderedCollection instead."	^ childProcessList := OrderedCollection new! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/24/2003 10:12'!isConnectedToXServer	"Answer true if VM is currently connected to an X server."	"self thisOSProcess isConnectedToXServer"	^ self processAccessor primIsConnectedToXServer! !!ThisOSProcess methodsFor: 'platform identification' stamp: 'dtl 10/10/2001 21:24'!isResponsibleForThisPlatform	"Answer true is this is an instance of the class which is responsible for representing	the OS process for the Squeak VM running on the current platform. A false answer is	usually the result of running the image on a different platform and VM."	^ self subclassResponsibility! !!ThisOSProcess methodsFor: 'private - IOHandle' stamp: 'dtl 9/25/2005 16:23'!isStdErr: anIOHandle	"Answer true if anIOHandle represents stderr."	| realHandle |	anIOHandle ifNil: [^ false].	realHandle := self processAccessor getStdErrHandle.	realHandle ifNil: [^ false].	UseIOHandle		ifTrue: [^ anIOHandle handle = realHandle handle]		ifFalse: [^ anIOHandle = realHandle]! !!ThisOSProcess methodsFor: 'private - IOHandle' stamp: 'dtl 9/25/2005 16:23'!isStdIn: anIOHandle	"Answer true if anIOHandle represents stdin."	| realHandle |	anIOHandle ifNil: [^ false].	realHandle := self processAccessor getStdInHandle.	realHandle ifNil: [^ false].	UseIOHandle		ifTrue: [^ anIOHandle handle = realHandle handle]		ifFalse: [^ anIOHandle = realHandle]! !!ThisOSProcess methodsFor: 'private - IOHandle' stamp: 'dtl 9/25/2005 16:23'!isStdOut: anIOHandle	"Answer true if anIOHandle represents stdout."	| realHandle |	anIOHandle ifNil: [^ false].	realHandle := self processAccessor getStdOutHandle.	realHandle ifNil: [^ false].	UseIOHandle		ifTrue: [^ anIOHandle handle = realHandle handle]		ifFalse: [^ anIOHandle = realHandle]! !!ThisOSProcess methodsFor: 'updating' stamp: 'dtl 2/26/2002 08:37'!needsRefresh	"Answer true if the sessionID variable is out of date with respect to the running	OS Process. Subclasses should provide implementation, answer true as default."	^ true! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/6/2003 06:36'!openXDisplay	"Restore headful display opening the X session."	"self thisOSProcess closeXDisplay. (Delay forSeconds: 5) wait. self thisOSProcess openXDisplay."	| proc |	proc := self processAccessor primOpenXDisplay.	proc ifNil: [self noAccessorAvailable].	^ proc! !!ThisOSProcess methodsFor: 'accessing' stamp: 'dtl 2/28/2002 13:30'!processAccessor	| a |	processAccessor		ifNil: 			[a := OSProcessAccessor forThisOSProcess.			a isResponsibleForThisPlatform ifTrue:				[processAccessor := a.				processAccessor addDependent: self]].	^ processAccessor! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/6/2015 20:03'!pruneExitedChildrenAfter: size	"Limit the size of the child process registry. Select the last entries, and unregister	them if they are no longer active."	"OSProcess thisOSProcess pruneExitedChildrenAfter: 5"	(accessProtect critical: [childProcessList allButFirst: size])		do: [ :e |			e isComplete ifTrue: [ self unregisterChildProcess: e ]]! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/6/2003 06:34'!recapitate	"Restore headful display opening the X session."	"self thisOSProcess decapitate. (Delay forSeconds: 5) wait. self thisOSProcess recapitate."	^ self openXDisplay! !!ThisOSProcess methodsFor: 'updating' stamp: 'dtl 2/26/2002 08:32'!refreshFromProcessAccessor	"Set my instance variables to reflect the state of the OS process in which this Smalltalk	virtual machine is executing."	self subclassResponsibility! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/6/2015 20:54'!registerChildProcess: anOSProcess	"Unregister anOSProcess, and trim the child process registry to prevent excessive	accumulation of exited children."	accessProtect critical: [ childProcessList addFirst: anOSProcess ].	self pruneExitedChildrenAfter: ChildListSize.	^ anOSProcess! !!ThisOSProcess methodsFor: 'updating' stamp: 'dtl 2/27/2015 07:25'!resetChildProcessDictionary	"Forget all the entries in the allMyChildren dictionary. This method may be called	when a new session is started, since the child processes of the previous session are	no longer children of this process."	self allMyChildren do: [ :p | self unregisterChildProcess: p ]! !!ThisOSProcess methodsFor: 'accessing' stamp: 'dtl 9/26/2005 20:04'!sessionID	^ sessionID! !!ThisOSProcess methodsFor: 'private' stamp: 'dtl 9/25/2005 13:28'!setStdErr	"If stdErr is nil, then set it. If not nil, check to see if it is has a valid connection to	stderr. If not valid, then replace it, otherwise answer the existing valid stream.	Obscure bug warning: If a valid AttachableFileStream on stderr is garbage collected,	then stderr will be closed. It is advisable (but not necessary) to treat the stream	on stderr as a singleton, but in any case, any extra instances attached to stderr	should not be allowed to be garbage collected."	| stdErrHandle |	stdErr ifNotNil:			[(self isStdErr: stdErr ioHandle) ifTrue: [^ stdErr]].	stdErrHandle := self processAccessor getStdErrHandle.	stdErrHandle ifNotNil:			[stdErr := AttachableFileStream name: 'stderr' attachTo: stdErrHandle writable: true].	^ stdErr! !!ThisOSProcess methodsFor: 'private' stamp: 'dtl 9/25/2005 13:28'!setStdIn	"If stdIn is nil, then set it. If not nil, check to see if it is has a valid connection to	stdin. If not valid, then replace it, otherwise answer the existing valid stream.	Obscure bug warning: If a valid AttachableFileStream on stdin is garbage collected,	then stdin will be closed. It is advisable (but not necessary) to treat the stream	on stdin as a singleton, but in any case, any extra instances attached to stdin	should not be allowed to be garbage collected."	| stdInHandle |	stdIn ifNotNil:			[(self isStdIn: stdIn ioHandle) ifTrue: [^ stdIn]].	stdInHandle := self processAccessor getStdInHandle.	stdInHandle ifNotNil:			[stdIn := AttachableFileStream name: 'stdin' attachTo: stdInHandle writable: false].	^ stdIn! !!ThisOSProcess methodsFor: 'private' stamp: 'dtl 9/25/2005 13:29'!setStdOut	"If stdOut is nil, then set it. If not nil, check to see if it is has a valid connection to	stdout. If not valid, then replace it, otherwise answer the existing valid stream.	Obscure bug warning: If a valid AttachableFileStream on stdout is garbage collected,	then stdout will be closed. It is advisable (but not necessary) to treat the stream	on stdout as a singleton, but in any case, any extra instances attached to stdout	should not be allowed to be garbage collected."	| stdOutHandle |	stdOut ifNotNil:			[(self isStdOut: stdOut ioHandle) ifTrue: [^ stdOut]].	stdOutHandle := self processAccessor getStdOutHandle.	stdOutHandle ifNotNil:			[stdOut := AttachableFileStream name: 'stdout' attachTo: stdOutHandle writable: true].	^ stdOut! !!ThisOSProcess methodsFor: 'display management' stamp: 'dtl 8/5/2003 22:16'!setXDisplayName: xDisplayName	"Set X display name for use by the next call to recapitate"	"self thisOSProcess setXDisplayName: 'unix:0' "	"self thisOSProcess setXDisplayName: ':1' "	self processAccessor primSetXDisplayName: xDisplayName! !!ThisOSProcess methodsFor: 'accessing' stamp: 'dtl 9/25/2005 13:30'!stdErr	^ stdErr! !!ThisOSProcess methodsFor: 'accessing' stamp: 'dtl 9/25/2005 13:30'!stdIn	^ stdIn! !!ThisOSProcess methodsFor: 'accessing' stamp: 'dtl 9/25/2005 13:31'!stdOut	^ stdOut! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/6/2015 19:49'!unregisterChildProcess: anOSProcess	accessProtect		critical: [childProcessList remove: anOSProcess ifAbsent: [] ].	^ anOSProcess! !!ThisOSProcess methodsFor: 'updating' stamp: 'dtl 10/15/2001 21:27'!update: aParameter	aParameter == #invalidProcessAccessor ifTrue: [processAccessor := nil].	^ super update: aParameter! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/25/2002 23:23'!updateActiveChildren	"Test each active child for its completion status and update runState and exitStatus	accordingly. This method may be called when a semaphore is set indicating that	some child OSProcess has died. A better approach might be to use an event queue	for death of child events; however, until event queues are part of Squeak image,	this polling mechanism is sufficient."	self activeChildren do:		[:child | child update: #runState]! !!ThisOSProcess methodsFor: 'child process management' stamp: 'dtl 2/4/2015 23:38'!updateAllMyChildren	"Test each child to make sure that it is still accessible. If the child is believed to be	running, check to see if it has exited, and update runState and exitStatus accordingly."	| children |	accessProtect critical: [children := self allMyChildren asArray].	children do:		[:child |		child update: #accessibility.		child isRunning ifTrue: [child update: #runState]]! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 3/10/2001 09:52'!arguments	"UnixProcess arguments"	^ self thisOSProcess arguments! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 2/24/2013 10:26'!backgroundProcessInHeadlessSqueak	"Demonstrate running a ''batch job'' in a low priority background Squeak,	with output written to an OSPipe. This Squeak image reads data from the	pipe and displays it on the Transcript. The background Squeak will write	enough data to block an OSPipe, so the foreground Squeak loops while	reading available data up to end of file.	Open a Transcript, then '' inspect it '' on this method. Process runs	indefinitely, so terminate the process to end demo."	"UnixProcess backgroundProcessInHeadlessSqueak"	^ [[| pipe backgroundJob ws s | 	pipe := OSPipe new.	backgroundJob := OSProcess thisOSProcess	forkHeadlessSqueakAndDoThenQuit: [| beers | 		OSProcess accessor nice: 1. "lower priority of background OS process"		beers := [:i | (i < 1 ifTrue: ['no more'] ifFalse: [i asString])					, ' bottle' , (i = 1 ifTrue: [''] ifFalse: ['s'])].		(99 to: 1 by: -1) do: [:count | pipe nextPutAll:			(beers value: count) , ' of beer on the wall, '			, (beers value: count) , ' of beer' , String cr			, 'take one down and pass it around, '			, (beers value: count - 1) , ' of beer on the wall'; cr].		pipe close].	WorldState addDeferredUIMessage:		[Transcript show: backgroundJob asString , ' started'; cr].	pipe closeWriter. "don't need writer end, close it before the #upToEnd"	"pipe writer blocks when pipe full, so we need to loop while reading to end "	ws := WriteStream on: String new.	[backgroundJob isComplete] whileFalse:		[(Delay forMilliseconds: 200) wait.		(s := pipe upToEnd) ifNotNil: [ws nextPutAll: s]].	pipe close.	WorldState addDeferredUIMessage:		[Transcript show: backgroundJob asString			, ' completed, display results in 2 seconds'; cr].	(Delay forSeconds: 2) wait.	WorldState addDeferredUIMessage:		[Transcript show: ws contents.		Transcript cr; show: 'delay 5 seconds before forking next Squeak job'; cr].	(Delay forSeconds: 5) wait] repeat]		forkAt: Processor userBackgroundPriority! !!UnixProcess class methodsFor: 'X display - deprecated' stamp: 'dtl 8/5/2003 22:10'!canConnectToXDisplay: xDisplayName	"Deprecated. See ThisOSProcess>canConnectToXDisplay:"	"self canConnectToXDisplay: ':0.0' "	^ self thisOSProcess canConnectToXDisplay: xDisplayName! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 04:17'!catAFile	"Copy contents of a file to standard output. This demonstrates reassigning stdin to an open FileStream."	"UnixProcess catAFile"	| in proc |	in := FileStream readOnlyFileNamed: '/etc/hosts'.	proc := self forkJob: '/bin/cat'			arguments: nil			environment: nil			descriptors: (Array with: in with: nil with: nil).	in close.	proc ifNil: [self noAccessorAvailable].	^ proc! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 04:28'!catFromFileToFiles	"Copy contents of a file to another file, with any error messages going 	to a third file."	"UnixProcess catFromFileToFiles"	| in out err proc |	in := FileStream readOnlyFileNamed: '/etc/hosts'.	out := FileStream newFileNamed: '/tmp/deleteMe.out'.	err := FileStream newFileNamed: '/tmp/deleteMe.err'.	proc := UnixProcess				forkJob: '/bin/cat'				arguments: nil				environment: nil				descriptors: (Array						with: in						with: out						with: err).	in close.	out close.	err close.	proc ifNil: [self noAccessorAvailable].	^ proc! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 11/14/2000 00:07'!clientServerDemo	"Start a new headless instance of Squeak running in a child OS process. The new	instance is a nearly identical copy of its parent, resuming execution at the same	point as the parent. The child process will run a TCP server process in the headless	image, then exit. Test results are written to the Transcript.	Answer '127 0 0 1' in response to the host address dialog."	"UnixProcess clientServerDemo"	| proc |	proc := self forkHeadlessSqueakAndDoThenQuit: [Socket remoteTestServerTCP].	proc ifNotNil: [Socket remoteTestClientTCP].	^ proc! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 1/7/2001 12:55'!clientServerDemo2	"Start a new instance of Squeak running in a child OS process. The new 	instance is a nearly identical copy of its parent, resuming execution at	the same point as the parent. The child process will run a TCP server	process, then exit. Test results are written to the Transcript. "	"UnixProcess clientServerDemo2"	| remotePort remoteHost serverBlock socket buffer n bytesToSend sendBuf	receiveBuf done bytesSent bytesReceived packetsSent packetsReceived t |	remotePort := 54321.	remoteHost := 'localhost'.	serverBlock := 			[Transcript clear; cr; show: 'This is the server Squeak session'; cr.			Socket initializeNetworkIfFail: [^ nil].			socket := Socket newTCP.			socket listenOn: remotePort.			buffer := String new: 4000.			socket waitForConnectionUntil: Socket standardDeadline.			[socket isConnected]				whileTrue: [socket dataAvailable						ifTrue: 							[n := socket receiveDataInto: buffer.							socket sendData: buffer count: n]].			socket closeAndDestroy].	(UnixProcess forkSqueakAndDoThenQuit: serverBlock)		ifNil: [self noAccessorAvailable. ^ nil].	Transcript cr; show: 'This is the client Squeak session'; cr.	Transcript show: 'starting client/server TCP test'; cr.	Transcript show: 'initializing network ... '.	Socket initializeNetworkIfFail: [^ Transcript show: 'failed'].	Transcript show: 'ok'; cr.	socket := Socket newTCP.	socket connectTo: (NetNameResolver addressForName: remoteHost) port: remotePort.	socket waitForConnectionUntil: Socket standardDeadline.	Transcript show: 'client endpoint created'; cr.	bytesToSend := 1000000.	sendBuf := String new: 4000 withAll: $x.	receiveBuf := String new: 50000.	done := false.	bytesSent := bytesReceived := packetsSent := packetsReceived := 0.	t := Time				millisecondsToRun: 					[[done]						whileFalse: 							[(socket sendDone and: [bytesSent < bytesToSend])								ifTrue: 									[packetsSent := packetsSent + 1.									bytesSent := bytesSent + (socket sendData: sendBuf)].							socket dataAvailable								ifTrue: 									[packetsReceived := packetsReceived + 1.									bytesReceived := bytesReceived + (socket receiveDataInto: receiveBuf)].							done := bytesSent >= bytesToSend].					[bytesReceived < bytesToSend]						whileTrue: [socket dataAvailable								ifTrue: 									[packetsReceived := packetsReceived + 1.									bytesReceived := bytesReceived + (socket receiveDataInto: receiveBuf)]]].	socket closeAndDestroy.	Transcript show: 'remoteClient TCP test done; time = ' , t printString; cr.	Transcript show: packetsSent printString , ' packets, ' , bytesSent printString ,		' bytes sent (' , (bytesSent * 1000 // t) printString , ' bytes/sec)'; cr.	Transcript show: packetsReceived printString , ' packets, ' , bytesReceived printString ,		' bytes received (' , (bytesReceived * 1000 // t) printString , ' bytes/sec)'; cr.	^ bytesReceived! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 9/9/2000 16:00'!cloneSqueak	"Start a new instance of Squeak running in a child OS process. The new instance is a	nearly identical copy of its parent, resuming execution at the same point as the	parent, and differentiated only by the return value of this method."	"UnixProcess cloneSqueak"	| proc |	proc := self forkSqueak.	proc ifNil: [self noAccessorAvailable].	^ proc! !!UnixProcess class methodsFor: 'X display - deprecated' stamp: 'dtl 8/5/2003 22:10'!currentXDisplayName	"Deprecated. See ThisOSProcess>>currentXDisplayName"	"self currentXDisplayName"	^ self thisOSProcess currentXDisplayName! !!UnixProcess class methodsFor: 'X display - deprecated' stamp: 'dtl 8/5/2003 22:09'!decapitate	"Deprecated. See ThisOSProcess>>decapitate"	"self decapitate"	^ OSProcess thisOSProcess decapitate! !!UnixProcess class methodsFor: 'X display - deprecated' stamp: 'dtl 8/5/2003 22:18'!displayOnXServer: xDisplayName	"Deprecated. See ThisOSProcess>>displayOnXServer"	"self displayOnXServer: ':0.0' "	"self displayOnXServer: 'unix:0' "	"self displayOnXServer: ':1' "	"self displayOnXServer: 'noSuchMachine'"	"self displayOnXServer: 'noSuchMachine:0'" "<-make sure network is running first!!"	^ OSProcess thisOSProcess displayOnXServer: xDisplayName! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 04:31'!eightLeafSqueakTree	"Clone this squeak three times, resulting in a total of (2 raisedTo: 3) nearly identical	squeaks. Have a look at the pidArray inspectors and to the debug messages on stdout	in order to see what is going on. The tree of processes looks like this:	111	 +--------+--------+	 |		 |		 |	011		101		110	 +---+	 |	 |	 |	100	010	001		 |		000	"	"UnixProcess eightLeafSqueakTree inspect"	| depth this pidArray debugString |	depth := 3.	this := OSProcess thisOSProcess.	this stdOut ifNil: [self noAccessorAvailable. ^ nil].	pidArray := Array new: depth.	(1 to: depth) do: [ :e | | p pid |		p := this forkSqueak.		pid := (p == this) ifTrue: [0] ifFalse: [p pid].	"Use Unix fork(2) convention"		pidArray at: e put: pid].	debugString := 'pid ', (this pid printString), ' ppid ', (this ppid printString), ' ',		(pidArray printString), (Character lf asString).	this stdOut nextPutAll: debugString.	^ pidArray! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 12/27/2000 17:18'!env	"Note: The #environment selector has special meaning for classes, so use #env."	"UnixProcess env"	^ self thisOSProcess environment! !!UnixProcess class methodsFor: 'child process creation' stamp: 'dtl 12/27/2000 16:57'!forkHeadlessSqueakAndDo: aBlock 	"Start a new instance of Squeak running in a child OS process, and  	execute aBlock in the child instance. The new instance is a clone of 	this image, but without a connection to the X display. The child instance 	executes aBlock, which hopefully does not involve interaction with the 	X display; and the parent continues normally.  	  	The child should not depend on using existing connections to external  	resources. For example, the child may lose its connections to stdin, 	stdout, and stderr after its parent exits."	"UnixProcess forkHeadlessSqueakAndDo: [UnixProcess helloWorld]"	^ self thisOSProcess forkHeadlessSqueakAndDo: aBlock! !!UnixProcess class methodsFor: 'child process creation' stamp: 'dtl 12/27/2000 17:00'!forkHeadlessSqueakAndDoThenQuit: aBlock 	"Start a new instance of Squeak running in a child OS process, and 	execute aBlock in the child instance. The new instance is a clone of	this image, but without a connection to the X display. The child instance	executes aBlock, which hopefully does not involve interaction with the	X display; and the parent continues normally.	The child should not depend on using existing connections to external 	resources. For example, the child may lose its connections to stdin, stdout,	and stderr after its parent exits."	"UnixProcess forkHeadlessSqueakAndDoThenQuit: [UnixProcess helloWorld]"	^ self thisOSProcess forkHeadlessSqueakAndDoThenQuit: aBlock! !!UnixProcess class methodsFor: 'child process creation' stamp: 'dtl 12/27/2000 16:48'!forkJob: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams 	"Call Unix vfork() and execve() to create a child process, and answer the 	child process. Delegate this to the singleton OSProcess>>thisOSProcess."	^ self thisOSProcess		forkJob: executableFile		arguments: arrayOfStrings		environment: stringDictionary		descriptors: arrayOf3Streams! !!UnixProcess class methodsFor: 'child process creation' stamp: 'dtl 7/5/2000 07:19'!forkSqueak	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk.	The child should not depend on using existing connections to external resources. For	example, the child may lose its connections to stdin, stdout, and stderr after its parent	exits."	"UnixProcess forkSqueak"	^ self thisOSProcess forkSqueak.! !!UnixProcess class methodsFor: 'child process creation' stamp: 'dtl 10/8/2001 20:40'!forkSqueakAndDo: aBlock	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock.	The child should not depend on using existing connections to external resources. For	example, the child may lose its connections to stdin, stdout, and stderr after its parent	exits."	"UnixProcess forkSqueakAndDo:		[Object inform: 'Hi, I am the child Squeak process.']"	^ self thisOSProcess forkSqueakAndDo: aBlock! !!UnixProcess class methodsFor: 'child process creation' stamp: 'dtl 10/8/2001 20:41'!forkSqueakAndDoThenQuit: aBlock	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock.	The child should not depend on using existing connections to external resources. For	example, the child may lose its connections to stdin, stdout, and stderr after its parent	exits."	"UnixProcess forkSqueakAndDoThenQuit:		[Object inform: 'Hi, I am the child Squeak process. Click OK to exit the child Squeak.']"	^ self thisOSProcess forkSqueakAndDoThenQuit: aBlock! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 05:11'!headlessChild	"Start a new instance of Squeak running in a child OS process. The new	instance is a nearly identical copy of its parent, resuming execution at the	same point as the parent, and differentiated only by the return value of	this method. The child squeak will write a message to standard output,	then exit."	"UnixProcess headlessChild"	| this childBlock |	this := OSProcess thisOSProcess.	childBlock :=		[this stdOut nextPutAll: 'hello world from child process '.		this pid printOn: OSProcess thisOSProcess stdOut.		this stdOut nextPut: Character lf ].	^ self forkHeadlessSqueakAndDoThenQuit: childBlock! !!UnixProcess class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:49'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for	the Squeak VM running on the current platform."	^ self isUnix! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 04:34'!listDirectory	"Execute a simple command, sending output to standard output."	"UnixProcess listDirectory"	| proc |	proc := self			forkJob: '/bin/ls'			arguments: nil			environment: nil			descriptors: nil.	proc ifNil: [self noAccessorAvailable].	^ proc! !!UnixProcess class methodsFor: 'utility - VM building' stamp: 'dtl 10/19/2001 13:31'!makeVmIn: buildDirectoryPathName	"Rebuild the virtual machine and plugins in the buildDirectoryPathName	directory. If the build is successful, save the image and restart using the	new VM. This assumes that the currently executing VM is either located in,	or linked to, the buildDirectoryPathName directory."	"UnixProcess makeVmIn: '/usr/local/squeak/Squeak-2.8/build'"	"UnixProcess makeVmIn: nil"	^ self makeVmIn: (buildDirectoryPathName ifNil: ['']) interactive: true! !!UnixProcess class methodsFor: 'utility - VM building' stamp: 'dtl 10/19/2001 11:41'!makeVmIn: buildDirectoryPathName interactive: aBoolean	"Rebuild the virtual machine and plugins in the buildDirectoryPathName	directory. If the build is successful, save the image and restart using the	new VM. This assumes that the currently executing VM is either located in,	or linked to, the buildDirectoryPathName directory. If aBoolean is true,	display interactive dialogs, otherwise output goes only to the Transcript."	"UnixProcess makeVmIn: '/usr/local/squeak/Squeak-2.8/build' interactive: true"	| commandString result |	commandString := 'cd ', buildDirectoryPathName, '; make'.	Transcript cr; show: 'running external command "', commandString, '"'; cr.	result := self waitForCommandOutputArray: commandString.	((result at: 3) == 0 and: [(result at: 2) isEmpty])		ifTrue:			[Transcript show: 'make completed successfully, restarting VM'; cr.			aBoolean ifTrue:				[self inform: 'make completed successfully, restarting VM'].			self quitAndRestart]		ifFalse:			[Transcript show: (result at: 2); cr.			Transcript show: 'make did not succeed, VM will not be restarted'; cr.			aBoolean ifTrue:				[self inform: 'make did not succeed, VM will not be restarted'.				self inform: (result at: 2)]].	^ result! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 12/27/2000 17:16'!path	"UnixProcess path"	^ self thisOSProcess path! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 3/10/2001 09:53'!programName	"UnixProcess programName"	^ self thisOSProcess programName! !!UnixProcess class methodsFor: 'X display - deprecated' stamp: 'dtl 8/5/2003 22:15'!recapitate	"Deprecated. See ThisOSProcess>>recapitate"	"self decapitate. (Delay forSeconds: 5) wait. self recapitate."	^ OSProcess thisOSProcess recapitate! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 3/17/2002 13:38'!restartVirtualMachine	"Fork a new instance and quit this one. This moves the running VM into a new	OS process, and starts a new X display for the new process. It does not reload the	VM program text, so this cannot be used to restart the VM after rebuild."	"UnixProcess restartVirtualMachine"	| proc |	proc := self forkSqueak.	proc isNil		ifTrue: 			[self noAccessorAvailable.			nil]		ifFalse:			[OSProcess thisOSProcess == proc				ifFalse:					["Quit if this is the parent process"					Smalltalk quitPrimitive]].	^ proc! !!UnixProcess class methodsFor: 'unit tests' stamp: 'dtl 3/5/2005 14:19'!runTests	"Run a few tests to see if things are working correctly on Unix/Linux. 	Output is on stdout, stderr, and the Squeak Transcript. One of the tests 	requires input from stdin, so Squeak should be run from a shell command	line and not as a background process.	Warning: This test will crash your VM if your are using the -xshm command	line option. For reasons which I do not quite understand, the X shared	memory segment becomes invalid when the Squeak VM which initially	opened the shared memory exits. The remaining Squeak children will crash	when then then next try to update the display.	Note: If you see 'select: Bad file descriptor' messages on your console standard	output, these are occuring while running headless in the decapitate/recapitate	tests.	Important: Prior to evaluating this method, please type one line of text	followed by a <cr> on the terminal standard input. This provides the	input for the stdin test. Failing to provide this input prior to evaluating	the tests will cause one of the test cases to fail."	"UnixProcess runTests"	| this s p failures result a |	failures := 0.	Transcript show: 'Begin OSProcess tests'; cr.	Transcript show: 'Test for working ProcessAccessor ... '.	this := OSProcess thisOSProcess.	(this pid isKindOf: Integer)		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'Echo one line of text previously entered from stdin ... '.	s := OSProcess readFromStdIn.	s size > 0		ifTrue: [Transcript show: 'OK'; cr; show: s; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'Message to stdout ... '.	(OSProcess helloWorld isKindOf: AttachableFileStream)		ifTrue: [Transcript show: 'OK'; cr; show: s; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'Message to stderr ... '.	(OSProcess helloStdErr isKindOf: AttachableFileStream)		ifTrue: [Transcript show: 'OK'; cr; show: s; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess cataFile ... '.	p := UnixProcess catAFile.	(Delay forSeconds: 1) wait.	p exitStatus == 0		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess testEnvSet ... '.	p := UnixProcess testEnvSet.	(Delay forSeconds: 1) wait.	p exitStatus == 0		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess catFromFileToFiles ... '.	OSProcess command: 'rm /tmp/deleteMe.out'.	OSProcess command: 'rm /tmp/deleteMe.err'.	p := UnixProcess catFromFileToFiles.	(Delay forSeconds: 1) wait.	p exitStatus == 0		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess testRunCommand ... '.	OSProcess command: 'rm /tmp/deleteMe.out'.	OSProcess command: 'rm /tmp/deleteMe.err'.	p := UnixProcess testRunCommand.	(Delay forSeconds: 1) wait.	p exitStatus == 256		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess testPipe ... '.	UnixProcess testPipe = 'this is some text to write into the pipe'		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess testPipeLine ... '.	UnixProcess testPipeLine = 'This is the text to write out through one pipe, copy through an external cat command, and then read back in through another pipe.'		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess spawnTenHeadlessChildren ... '.	p := UnixProcess spawnTenHeadlessChildren.	(p size == 10 and: [(p select: [:e | (e runState == #running) | (e exitStatus == 0)]) size == 10])		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess cloneSqueak ... '.	p := UnixProcess cloneSqueak.	(p isKindOf: UnixProcess)		ifTrue: 			[(Delay forSeconds: 1) wait.			OSProcess snapshot: false andQuit: true].	(Delay forSeconds: 5) wait.	p exitStatus == 0		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess squeakSqueak ... '.	p := UnixProcess squeakSqueak.	(Delay forSeconds: 5) wait.	OSProcess thisOSProcess sigkill: p.	(Delay forSeconds: 1) wait.	p exitStatus == 9		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess restartVirtualMachine ... '.	p := UnixProcess restartVirtualMachine.	p pid == OSProcess thisOSProcess pid		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess command: ''cat'' input: ''this is some test data'' ... '.	p := (OSProcess thisOSProcess		command: 'cat'		input: 'this is some test data').	(Delay forSeconds: 1) wait.	p upToEnd = 'this is some test data'		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'UnixProcess waitForCommandOutput: ''echo sleeping...; sleep 1; echo I just slept for one second'' ... '.	('*I just slept for one second*' match:		(OSProcess thisOSProcess			waitForCommandOutput: 'echo sleeping...; sleep 1; echo I just slept for one second'))		ifTrue: [Transcript show: 'OK'; cr]		ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1].	Transcript show: 'Unix command pipeline with output and error returned in an array ... '.	(Smalltalk hasClassNamed: #PipeableOSProcess)		ifTrue:			[a := (((Smalltalk at: #PipeableOSProcess) command: 'echo this is a test; BOGUS') | 'cut -c11-14') outputAndError.			(((a isKindOf: Array)				and: ['test*' match: (a at: 1)])					and: ['*BOGUS*' match: (a at: 2)])						ifTrue: [Transcript show: 'OK'; cr]						ifFalse: [Transcript show: 'NFG'; cr. failures := failures + 1]]		ifFalse:			[Transcript show: 'skipping PipeableOSProcess test (requires CommandShell)'; cr].	Transcript show: 'UnixProcess decapitate and recapatiate five times'; cr.	5 timesRepeat:		[UnixProcess decapitate.		UnixProcess recapitate].	failures == 1		ifTrue: [result := 'OSProcess tests completed with ', failures printString, ' failure']		ifFalse: [result := 'OSProcess tests completed with ', failures printString, ' failures'].	Transcript show: result; cr.	^ result! !!UnixProcess class methodsFor: 'utility - image save' stamp: 'dtl 7/23/2010 07:50'!saveImageInBackground	"Save image in a background OS process."	"UnixProcess saveImageInBackground"	^ self saveImageInBackground: self uniqueNameForSavedImage nice: false! !!UnixProcess class methodsFor: 'utility - image save' stamp: 'dtl 1/8/2008 22:39'!saveImageInBackground: savedImageName nice: niceFlag	"When Squeak is used as a server it is sometimes desirable to periodically	save image snapshots. This method forks a headless Squeak to perform a	snapshot without impacting the server Squeak. Very little additional memory	is required to do this because Unix copy-on-write memory management allows	the two Squeak images to share object memory while the save is performed.	The saved image is given a time stamped name, and the image name of	the main server Squeak remains unchanged. If niceFlag is true, the	background OS process runs at lowered scheduling priority."	^ self forkHeadlessSqueakAndDo:		[| st |		"Delay is required in the background process when forking a headless		Squeak, probably necessary to permit X session stuff to settle down."		(Delay forMilliseconds: 500) wait.		(niceFlag notNil and: [niceFlag]) ifTrue:			["lower priority of background OS process"			OSProcess accessor nice: 1].		st := SmalltalkImage current.		(SourceFiles at: 2) ifNotNil:			["ensure that copying the changes file will always work"			st closeSourceFiles.			st saveChangesInFileNamed: (st fullNameForChangesNamed: savedImageName)].		st changeImageNameTo: savedImageName,'.image';			closeSourceFiles;			openSourceFiles;  "so SNAPSHOT appears in new changes file"			saveImageSegments;			snapshot: true andQuit: true]! !!UnixProcess class methodsFor: 'utility - image save' stamp: 'dtl 7/23/2010 07:50'!saveImageInBackgroundNicely	"Save image in a background OS process with lowered scheduling priority."	"UnixProcess saveImageInBackgroundNicely"	^ self saveImageInBackground: self uniqueNameForSavedImage nice: true! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 3/10/2001 09:53'!sessionID	"UnixProcess sessionID"	^ self thisOSProcess sessionID! !!UnixProcess class methodsFor: 'X display - deprecated' stamp: 'dtl 8/5/2003 22:18'!setXDisplayName: xDisplayName	"Deprecated. See ThisOSProcess>>setXDisplayName"	"self setXDisplayName: 'unix:0' "	"self setXDisplayName: ':1' "	^ OSProcess thisOSProcess setXDisplayName: xDisplayName! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 04:35'!spawnTenHeadlessChildren	"Spawn ten Squeak children, each of which writes a message to standard 	output, then exits. Answer an array of pid values for the child 	processes. "	"UnixProcess spawnTenHeadlessChildren"	| childBlock count children this |	this := OSProcess thisOSProcess.	this stdOut ifNil: [self noAccessorAvailable. ^ nil].	count := 10.	children := Array new: count.	childBlock := 			[this stdOut nextPutAll: 'hello world from child process '.			this pid printOn: this stdOut.			this stdOut nextPut: Character lf.			this stdOut flush].	(1 to: count)		do: 			[:e | 			OSProcess thisOSProcess stdOut flush.			children at: e put: (self forkHeadlessSqueakAndDoThenQuit: childBlock)].	^ children! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 04:38'!squeakSqueak	"Start a new instance of Squeak running in a child OS process. The new instance	will restart from the image file, so it is a clone of this image as it existed at the	most recent image save. See cloneSqueak for an example of how to clone the	running image without going back to the saved image file."	"UnixProcess squeakSqueak"	| proc |	proc := self squeak.	proc ifNil: [self noAccessorAvailable].	^ proc! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 7/13/2003 14:47'!startSwiki: aSwiki onPort: num loggingTo: aFileName	"Start a swiki in a headless Squeak image."	"UnixProcess startSwiki: 'myswiki' onPort: 8081 loggingTo: 'log.txt'"	| proc |	(Smalltalk hasClassNamed: #SwikiAction)		ifTrue:			[proc := self forkSqueakAndDo:				[(Smalltalk at: #SwikiAction) new restore: 'myswiki'.				(Smalltalk at: #PWS) serveOnPort: num loggingTo: aFileName.				UnixProcess decapitate].			proc ifNil: [self noAccessorAvailable].			^ proc]		ifFalse:		[self notify: 'PWS not installed in this image']! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 12/27/2000 17:12'!stdErr	"UnixProcess stdErr"	^ self thisOSProcess stdErr! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 12/27/2000 17:11'!stdIn	"UnixProcess stdIn"	^ self thisOSProcess stdIn! !!UnixProcess class methodsFor: 'utility' stamp: 'dtl 12/27/2000 17:11'!stdOut	"UnixProcess stdOut"	^ self thisOSProcess stdOut! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 04:41'!testEnvSet	"Set up a new environment for a child process. Exec a shell to show the 	environment variables on the terminal standard output. Note that many 	shells will set other environment variables in addition to those which we	set up prior to executing the shell."	"UnixProcess testEnvSet"	| e proc |	e := Dictionary new.	e at: #KEY1 put: 'value1';	 at: #KEY2 put: 'value2';	 at: #KEY3 put: 'value3'.	proc := self			forkJob: '/bin/sh'			arguments: #('-c' 'env' )			environment: e			descriptors: nil.	proc ifNil: [self noAccessorAvailable].	^ proc! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 2/11/2001 14:03'!testPipe	"Create an OS pipe, write some text to it, and read the text back from the 	other end of the pipe."	"UnixProcess testPipe inspect"	| s p r |	s := 'this is some text to write into the pipe'.	p := OSPipe new.	p ifNil: 		[self noAccessorAvailable.		^ p].	p writer nextPutAll: s.	p writer close.	r := p reader next: s size.	p reader close.	^ r! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 2/24/2001 16:28'!testPipeLine	"Create two OS pipes, and a child OS process with its input connected to 	one pipe and its  output connected to the other pipe. Write some text to	the input pipe, and read the resulting output (just echoed back by the	Unix cat command) back through the output pipe. Send a SIGHUP signal	to the child process to tell it to exit.	This test verifies the ability of Squeak to send text to an external OS process	through a pipe, and read the output text back from another pipe.	See ConnectedUnixProcess for a more useful implementation."	"UnixProcess testPipeLine inspect"	| testString pipe1 pipe2 input output src dest desc result child |	OSProcess accessor canAccessSystem ifFalse: [^ nil].	testString := 'This is the text to write out through one pipe, copy through an external cat command, and then read back in through another pipe.'.	pipe1 := OSPipe blockingPipe.	pipe2 := OSPipe nonBlockingPipe.	input := pipe1 reader.	output := pipe2 writer.	src := pipe1 writer.	dest := pipe2 reader.	desc := Array				with: input				with: output				with: nil.	child := self				forkJob: '/bin/cat'				arguments: nil				environment: nil				descriptors: desc.	input close.	output close.	src nextPutAll: testString.	src close.	(Delay forSeconds: 1) wait.	result := dest next: testString size.	dest close.	child sigterm. "Tell the child to exit"	^ result! !!UnixProcess class methodsFor: 'examples' stamp: 'dtl 7/12/2000 04:46'!testRunCommand	"Run the command 'ls -l /etc /etc/noSuchFile'. The output of the 	command will be in the file '/tmp/deleteMe.out', and the error output	will be in '/tmp/deleteMe.err'. "	"UnixProcess testRunCommand"	| out err desc args proc |	out := FileStream newFileNamed: '/tmp/deleteMe.out'.	err := FileStream newFileNamed: '/tmp/deleteMe.err'.	desc := Array				with: nil				with: out				with: err.	args := Array				with: '-l'				with: '/etc'				with: '/etc/noSuchFile'				with: '/etc/anotherNonexistentFile'.	proc := self				forkJob: '/bin/ls'				arguments: args				environment: nil				descriptors: desc.	proc ifNil: [self noAccessorAvailable].	out close.	err close.	^ proc! !!UnixProcess class methodsFor: 'utility - image save' stamp: 'dtl 11/8/2005 11:39'!uniqueNameForSavedImage	"A time stamped image name that will sort in date order in a directory listing"	"UnixProcess uniqueNameForSavedImage"	| now month day hour minute second |	now := DateAndTime now.	month := now month asString.	day := now dayOfMonth asString.	hour := now hour24 asString.	minute := now minute asString.	second := now second asString.	^ 'squeak-',		now year asString,		(month size < 2 ifTrue: ['0', month] ifFalse: [month]),		(day size < 2 ifTrue: ['0', day] ifFalse: [day]),		(hour size < 2 ifTrue: ['0', hour] ifFalse: [hour]),		(minute size < 2 ifTrue: ['0', minute] ifFalse: [minute]),		(second size < 2 ifTrue: ['0', second] ifFalse: [second])! !!UnixProcess class methodsFor: 'external command processing' stamp: 'dtl 1/18/2001 23:14'!waitForCommandOutput: aCommandString 	"Run a command in a shell process. Similar to the system(3) call in the 	standard C library. The active Smalltalk process waits for completion of	the external command process."	"UnixProcess waitForCommandOutput: 'echo sleeping...; sleep 1; echo I just slept for one second'"	"UnixProcess waitForCommandOutput: 'ThisIsABogusCommand'"	^ self thisOSProcess waitForCommandOutput: aCommandString! !!UnixProcess class methodsFor: 'external command processing' stamp: 'dtl 1/18/2001 23:14'!waitForCommandOutputArray: aCommandString	"Run a command in a shell process. Similar to the system(3) call in the standard C library.	The active Smalltalk process waits for completion of the external command process."	"UnixProcess waitForCommandOutputArray: 'echo Hello world!!; ls /NOSUCHFILE'"	^ self thisOSProcess waitForCommandOutputArray: aCommandString! !!UnixProcess methodsFor: 'private' stamp: 'djr 4/6/2009 14:31'!argsAsFlatArrayAndOffsets: anArrayOfNullTerminatedStrings	"Given anArrayOfNullTerminatedStrings, flatten the array into a string buffer,	leaving space at the beginning of the buffer for a list of C pointers. Answer	the string buffer and an array of address offsets. The address offsets may later	be converted to C pointers and overlaid on the beginning of the buffer, resulting	in a data structure which can be treated as a C array of strings suitable for	use as a Unix argv vector."	"OSProcess thisOSProcess argsAsFlatArrayAndOffsets:		(UnixProcess arguments collect:			[:e | e, (Character value: 0) asString])"	| offset arraySize flatStringArray ws addresses |	"Preserve offset space to hold address pointers."	offset := (anArrayOfNullTerminatedStrings size + 1) * self processAccessor sizeOfPointer.	"Allocate flat strings buffer"	arraySize := (anArrayOfNullTerminatedStrings collect: [:e | e size]) sum		+ ((anArrayOfNullTerminatedStrings size + 1) * self processAccessor sizeOfPointer).	"Flatten the strings out into a buffer, leaving room at the	beginning of the buffer for an array of addresses."	flatStringArray := String new: arraySize.	ws := WriteStream on: flatStringArray.	offset timesRepeat: [ws nextPut: (Character value: 0)].	anArrayOfNullTerminatedStrings do: [:e | ws nextPutAll: e].	"Find address offsets to be used in creating the addresses for the strings."	ws := WriteStream on: (Array new: anArrayOfNullTerminatedStrings size).	(anArrayOfNullTerminatedStrings collect: [:e | e size])		inject: offset into: [:p :e | ws nextPut: p. p + e].	addresses := ws contents.	"Results"	^ Array with: flatStringArray with: addresses! !!UnixProcess methodsFor: 'accessing' stamp: 'dtl 11/7/2000 09:09'!arguments	^ arguments! !!UnixProcess methodsFor: 'environment' stamp: 'dtl 1/25/2013 19:00'!chDir: pathString	"Change current working directory, and update $PWD if it exists in the environment.	Answer nil for success, or an error message."	"OSProcess thisOSProcess chDir: '/tmp'"	"OSProcess thisOSProcess chDir: '/no/such/path'"	"OSProcess thisOSProcess chDir: OSProcess defaultPathString"	| realPath result |	realPath := self processAccessor realpath: pathString.	realPath ifNil: [realPath := pathString].	result := self processAccessor chDir: realPath.	result isNil		ifTrue:			[(self environmentAt: #PWD)				ifNotNil:					[self environmentAt: #PWD put: realPath.					^ nil]]		ifFalse:			[self inform: realPath, ': ', result.			^ result]! !!UnixProcess methodsFor: 'external command processing' stamp: 'dtl 2/27/2002 15:24'!command: aCommandString	"Run a command in a shell process. Similar to the system(3) call in the standard C library,	except that aCommandString runs asynchronously in a child process. The command is	run by a ConnectedUnixProcess in order to facilitate command pipelines within Squeak."	"UnixProcess thisOSProcess command: 'ls -l /etc'"	| proc |	pid isNil		ifTrue:			[self class noAccessorAvailable. ^nil]		ifFalse:			[proc := self					forkJob: ExternalUnixOSProcess defaultShellPath					arguments: (Array with: '-c' with: aCommandString)					environment: nil					descriptors: nil.			proc ifNil: [self class noAccessorAvailable].			^ proc]! !!UnixProcess methodsFor: 'external command processing' stamp: 'dtl 7/12/2003 11:51'!command: aCommandString input: aStreamOrString	"Run a command in a shell process. Similar to the system(3) call in the standard C library,	except that aCommandString runs asynchronously in a child process."	"OSProcess thisOSProcess		command: 'cat'		input: 'this is some test data'"	"OSProcess thisOSProcess		command: 'cat'		input: (ReadStream on: 'this is some test data')"	| proc |	(Smalltalk hasClassNamed: #PipeableOSProcess)		ifTrue:			[proc := (Smalltalk at: #PipeableOSProcess) command: aCommandString.			proc ifNil: [^ nil].			proc nextPutAll: aStreamOrString contents.			proc pipeToInput close.			^ proc]		ifFalse:			[self notify: 'the #command:input: method requires CommandShell, using #command: instead'.			^ self command: aStreamOrString contents]! !!UnixProcess methodsFor: 'private' stamp: 'djr 4/6/2009 14:31'!envAsFlatArrayAndOffsets: anEnvironmentDictionary	"Given anEnvironmentDictionary, flatten the dictionary into a string buffer,	leaving space at the beginning of the buffer for a list of C pointers. Answer	the string buffer and an array of address offsets. The address offsets may later	be converted to C pointers and overlaid on the beginning of the buffer, resulting	in a data structure which can be treated as a C array of strings suitable for	use as a Unix process environment."	"OSProcess thisOSProcess envAsFlatArrayAndOffsets: UnixProcess env"	| offset envArray arraySize flatStringArray ws addresses |	"Preserve offset space to hold address pointers."	offset := (anEnvironmentDictionary size + 1) * self processAccessor sizeOfPointer.	"Build collection of environment strings"	envArray := OrderedCollection new.	anEnvironmentDictionary keysAndValuesDo: [:k :v | envArray add: (k, '=', v)].	"Allocate flat strings buffer"	arraySize := ((envArray collect: [:e | e size + 1]) sum) + offset.	"Flatten the strings out into a buffer, leaving room at the beginning of	the buffer for an array of addresses."	flatStringArray := String new: arraySize.	ws := WriteStream on: flatStringArray.	offset timesRepeat: [ws nextPut: (Character value: 0)].	envArray do: [:e | ws nextPutAll: e; nextPut: (Character value: 0)].	"Find address offsets to be used in creating the addresses for the strings."	ws := WriteStream on: (Array new: anEnvironmentDictionary size).	(envArray collect: [:e | e size + 1])		inject: offset into: [:p :e | ws nextPut: p. p + e].	addresses := ws contents.	"Results"	^ Array with: flatStringArray with: addresses! !!UnixProcess methodsFor: 'accessing' stamp: 'dtl 11/7/2000 09:09'!environment	^ environment! !!UnixProcess methodsFor: 'environment' stamp: 'dtl 3/6/2001 21:30'!environmentAt: aSymbol	"Answer an environment variable for the external OS process, and update the dictionary	in this Smalltalk object."	^ environment at: aSymbol asSymbol ifAbsent: []! !!UnixProcess methodsFor: 'environment' stamp: 'dtl 3/6/2001 21:30'!environmentAt: aSymbol put: aString	"Set an environment variable for the external OS process, and update the dictionary in	this Smalltalk object."	| s |	self initialize.	s := self processAccessor environmentAt: aSymbol put: aString.	s ifNotNil: [ self environment at: aSymbol asSymbol put: aString ].	^ s! !!UnixProcess methodsFor: 'finalization' stamp: 'dtl 2/4/2015 23:39'!finalize	"Use this to release any external resources prior to reinitializing."	super finalize.	stdIn := stdIn ifNotNil:		[[stdIn close] on: Error do: [:ex | ].		nil].	stdIn := stdOut ifNotNil:		[[stdOut close] on: Error do: [:ex | ].		nil].	stdIn := stdErr ifNotNil:		[[stdErr close] on: Error do: [:ex | ].		nil].	sessionID := nil.	ppid := nil.	programName := nil.	arguments := nil.	path := nil.	environment := nil.	self updateAllMyChildren.	childProcessList := nil.	processAccessor		ifNotNil: 			[processAccessor removeDependent: self.			processAccessor := nil]! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 2/27/2002 15:24'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams 	"Call Unix vfork() and execve() to create a child process, and answer the 	child process. This method is expected to be called by class side methods."	^ ExternalUnixOSProcess		forkAndExec: executableFile		arguments: arrayOfStrings		environment: stringDictionary		descriptors: arrayOf3Streams! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 2/27/2015 20:04'!forkHeadlessSqueak	"Just like forkSqueak, except that the child Squeak continues headless."	| thisPid childPid child connected |	stdOut ifNil: [^ nil].	self stdOut flush.	self stdErr flush.	thisPid := self pid.	connected := self processAccessor canControlXDisplay					and: [self flushXDisplay notNil].	childPid := self processAccessor forkSqueak.	^ childPid ifNotNil: [		childPid == 0			ifTrue:				[connected ifTrue: [self disconnectXDisplay].				OSProcess thisOSProcess processAccessor newPid.				^ self]			ifFalse:				[child := ExternalUnixOSProcess new.				child pid: childPid.				child ppid: thisPid.				child programName: self programName.				child initialStdIn: self stdIn.					child initialStdOut: self stdOut.				child initialStdErr: self stdErr.				child arguments: self arguments.				child initialEnvironment: self environment.				child notYetRunning.				self registerChildProcess: child.				child running.				^ child]]! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 1/7/2001 12:59'!forkHeadlessSqueakAndDo: aBlock 	"Start a new instance of Squeak running in a child OS process, and  	execute aBlock in the child instance. The new instance is a clone of 	this image, but without a connection to the X display. The child instance 	executes aBlock, which hopefully does not involve interaction with the 	X display; and the parent continues normally.  	  	The child should not depend on using existing connections to external  	resources. For example, the child may lose its connections to stdin, 	stdout, and stderr after its parent exits."	| childOrThisProc |	childOrThisProc := self forkHeadlessSqueak.	childOrThisProc		ifNil: 			[self class noAccessorAvailable.			^ nil].	childOrThisProc == self		ifTrue:			["Child process"			aBlock value].	^ childOrThisProc! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 8/7/2003 07:17'!forkHeadlessSqueakAndDoThenQuit: aBlock 	"Start a new instance of Squeak running in a child OS process, and 	execute aBlock in the child instance. The new instance is a clone of	this image, but without a connection to the X display. The child instance	executes aBlock, which hopefully does not involve interaction with the	X display; and the parent continues normally.	The child should not depend on using existing connections to external 	resources. For example, the child may lose its connections to stdin, stdout,	and stderr after its parent exits."	"self thisOSProcess forkHeadlessSqueakAndDoThenQuit:		[OSProcess thisOSProcess stdOut nextPutAll: 'hello world!!'; nextPut: Character lf]"	"self thisOSProcess forkHeadlessSqueakAndDoThenQuit: [OSProcess thisOSProcess command: 'xeyes']"	| childOrThisProc |	childOrThisProc := self forkHeadlessSqueak.	childOrThisProc		ifNil: 			[self class noAccessorAvailable.			^ nil].	childOrThisProc == self		ifTrue:			["Child process"			aBlock value.			Smalltalk quitPrimitive].	^ childOrThisProc! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 12/27/2000 16:47'!forkJob: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams	"Call Unix vfork() and execve() to create a child process, and answer the child process.	Delegate this to the singleton OSProcess>>thisOSProcess."	^ self forkAndExec: executableFile		arguments: arrayOfStrings		environment: stringDictionary		descriptors: arrayOf3Streams! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 2/27/2015 20:04'!forkSqueak	"Fork a child and continue running this Squeak image in both the parent and the child.	Parent and child are distinguished by the pid returned by primForkSqueak.	If continuing as the parent process, answer the ExternalUnixOSProcess which	represents the child. This can be inspected to watch the run state of the child	process from the parent.	If continuing as the child process, answer OSProcess thisOSProcess. This can be	inspected to watch the full state of the child process from the child. The	child cannot directly view the state of its parent.	Parent and child should be cautious about using shared connections to external	resources."	"self thisOSProcess forkSqueak"	| thisPid childPid child connected |	stdOut ifNil: [^ nil].	self stdOut flush.	self stdErr flush.	thisPid := self pid.	connected := self processAccessor canControlXDisplay					and: [self flushXDisplay notNil].	childPid := self processAccessor forkSqueak.	^ childPid ifNotNil: [		childPid == 0			ifTrue:				[connected ifTrue: [self disconnectXDisplay; recapitate].				OSProcess thisOSProcess processAccessor newPid.				^ self]			ifFalse:				[child := ExternalUnixOSProcess new.				child pid: childPid.				child ppid: thisPid.				child programName: self programName.				child initialStdIn: self stdIn.					child initialStdOut: self stdOut.				child initialStdErr: self stdErr.				child arguments: self arguments.				child initialEnvironment: self environment.				child notYetRunning.				self registerChildProcess: child.				child running.				^ child]]! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 10/8/2001 19:56'!forkSqueakAndDo: aBlock	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock.	The child should not depend on using existing connections to external resources. For	example, the child may lose its connections to stdin, stdout, and stderr after its parent	exits."	"UnixProcess thisOSProcess forkSqueakAndDo:		[Object inform: 'Hi, I am the child Squeak process.']"	| childOrThisProc |	childOrThisProc := self forkSqueak.	(childOrThisProc == self) ifTrue: [aBlock value]. "Child process"	^ childOrThisProc! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 10/8/2001 19:56'!forkSqueakAndDoThenQuit: aBlock	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock.	The child should not depend on using existing connections to external resources. For	example, the child may lose its connections to stdin, stdout, and stderr after its parent	exits."	"UnixProcess thisOSProcess forkSqueakAndDoThenQuit:		[Object inform: 'Hi, I am the child Squeak process.']"	| childOrThisProc |	childOrThisProc := self forkSqueak.	(childOrThisProc == self)		ifTrue:			[ aBlock value.			Smalltalk quitPrimitive]. "Child process"	^ childOrThisProc! !!UnixProcess methodsFor: 'private' stamp: 'dtl 3/31/2001 14:16'!getArgumentList	"Answer the argument list using anOSProcessAccessor. For Unix, the first element of the list	would be the program name. This element will not be treated as an argument; rather, it is	stored as the programName instance variable."	| index val list |	list := OrderedCollection new.	index := 2.	[(val := processAccessor primArgumentAt: index) notNil] whileTrue: [		list add: val.		index := index + 1].	^ list asArray! !!UnixProcess methodsFor: 'environment' stamp: 'dtl 3/22/2000 05:55'!getCwd	"Get current working directory. At image startup, this is equivalent to	evaluating environmentAt: #PWD"	"OSProcess thisOSProcess getCwd"	^ self processAccessor primGetCurrentWorkingDirectory! !!UnixProcess methodsFor: 'private' stamp: 'dtl 3/31/2001 14:14'!getEnvironmentDictionary	"Answer an environment dictionary using an OSProcessAccessor."	| index str key val env |	env := Dictionary new.	index := 1.	[(str := processAccessor primEnvironmentAt: index) notNil] whileTrue: [		key := (str copyUpTo: $=) asSymbol.		val := (str copyFrom: ((str indexOf: $=) + 1) to: (str size)).		env at: key put: val.		index := index + 1].	^ env! !!UnixProcess methodsFor: 'private' stamp: 'dtl 3/31/2001 14:16'!getProgramName	"Answer the name of the program which is being run by this OS process. Assume the	Unix convention where the first element of (char **)argv is the program name."	^ programName := processAccessor primArgumentAt: 1! !!UnixProcess methodsFor: 'initialize - release' stamp: 'dtl 7/6/2010 21:55'!initialize	"Set my instance variables to reflect the state of the OS process in which 	this Smalltalk virtual machine is executing."	super initialize.	(self processAccessor notNil and: [processAccessor canAccessSystem])		ifTrue: 			[self refreshFromProcessAccessor]		ifFalse: 			[stdIn := nil.			stdOut := nil.			stdErr := nil].	processAccessor restartChildWatcherProcess! !!UnixProcess methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:49'!isResponsibleForThisPlatform	"Answer true is this is an instance of the class which is responsible for representing	the OS process for the Squeak VM running on the current platform. A false answer is	usually the result of running the image on a different platform and VM."	^ self class isUnix! !!UnixProcess methodsFor: 'VM atexit' stamp: 'dtl 2/6/2015 20:38'!killCurrentChildrenAtExit	"Arrange for the currently active child processes to receive a SIGTERM	signal then the Squeak VM exits. Each invokation of this method overrides	the effects of any previous calls."	"OSProcess thisOSProcess killCurrentChildrenAtExit"	self processAccessor killOnVmExit: self activeChildren withSignal: nil! !!UnixProcess methodsFor: 'private' stamp: 'dtl 11/7/2000 09:26'!needsRefresh	"Answer true if the sessionID variable is out of date with respect to the running OS Process."	^ ((sessionID ~= (self processAccessor primGetSession)) | (pid ~= (self processAccessor primGetPid)))! !!UnixProcess methodsFor: 'accessing' stamp: 'dtl 11/7/2000 09:10'!path	^ path := self pathString! !!UnixProcess methodsFor: 'accessing' stamp: 'dtl 11/7/2000 09:10'!path: aPathString	self environmentAt: #PATH put: aPathString.	path := self pathString! !!UnixProcess methodsFor: 'private' stamp: 'dtl 3/6/2001 21:46'!pathString	"Answer the path string from the environment. Assume Unix convention in which the	path name is a colon delimited string stored in the PATH environment variable."	^ self environment at: #PATH ifAbsent: [nil]! !!UnixProcess methodsFor: 'accessing' stamp: 'dtl 10/18/2001 20:01'!pid	^ pid := self processAccessor primGetPid! !!UnixProcess methodsFor: 'accessing' stamp: 'dtl 11/7/2000 09:10'!ppid	"Always refresh ppid from the processAccessor, because it is possible for a child	to be reparented when the parent exits. The child does not know about this, so	we refresh ppid on every access."	^ ppid := processAccessor primGetPPid! !!UnixProcess methodsFor: 'printing' stamp: 'dtl 7/7/2010 07:37'!printOn: aStream	"In English, say 'a Unix' rather than 'an Unix'. Therefore do not use super printOn, which	treats $U as a vowel."	self ppid.		"Force update of ppid, in case parent may have exited."	aStream nextPutAll: 'a ';			nextPutAll: self class name;			nextPutAll: ' with pid ';			nextPutAll: self pid printString! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 1/25/2004 12:40'!processProxy: anExternalProcess forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams	"Call Unix vfork() and execve() to create a child process, and answer the child process.	This method is expected to be called by class side methods. Prepare the arguments before	calling the primitive, including null termination of all strings. anExternalProcess is an	object which represents the new child process, and which responds to the #pid: message."	| nullString progName args argVecAndOffsets argVec argOffsets	envVecAndOffsets envVec envOffsets in out err childPid pwd |	stdOut ifNil: [^ nil].	nullString := (Character value: 0) asString.	progName := executableFile, nullString.		"Null terminated string"	arrayOfStrings isNil							"Should be a (possibly empty) array"		ifTrue:			[args := Array with: progName]		"First argument is the program name (Unix convention)"		ifFalse:			[args := (OrderedCollection new: arrayOfStrings size + 2)						add: progName;						addAll: (arrayOfStrings collect: [:e | e, nullString ]);	"Null terminate each string"						yourself;						asArray].	argVecAndOffsets := self argsAsFlatArrayAndOffsets: args.	argVec := argVecAndOffsets at: 1.	argOffsets := argVecAndOffsets at: 2.	(stringDictionary notNil and: [stringDictionary ~= (self environment)])		ifTrue:			[envVecAndOffsets := self envAsFlatArrayAndOffsets: stringDictionary.			envVec := envVecAndOffsets at: 1.			envOffsets := envVecAndOffsets at: 2]		ifFalse:			[envVec := nil.			envOffsets := nil].	"Same as current environment, so just pass nil."	arrayOf3Streams isNil		ifTrue:			[in := self handleFromAccessor: (self stdIn ioHandle).			out := self handleFromAccessor: (self stdOut ioHandle).			err := self handleFromAccessor: (self stdIn ioHandle)]		ifFalse:			[(arrayOf3Streams at: 1)				isNil					ifTrue: [in := self handleFromAccessor: (self stdIn ioHandle)]					ifFalse: [in := self handleFromFileStream: (arrayOf3Streams at: 1)].						(arrayOf3Streams at: 2)				isNil					ifTrue: [ out := self handleFromAccessor: (self stdOut ioHandle)]					ifFalse: [ out := self handleFromFileStream: (arrayOf3Streams at: 2)].			(arrayOf3Streams at: 3)				isNil					ifTrue: [ err := self handleFromAccessor: (self stdErr ioHandle)]					ifFalse: [ err := self handleFromFileStream: (arrayOf3Streams at: 3)]].	pwd := anExternalProcess pwd.	(pwd = self getCwd)		ifTrue: [pwd := nil]		ifFalse: [pwd := pwd, nullString].	childPid := self processAccessor				forkAndExec: progName				stdIn: in				stdOut: out				stdErr: err				argBuf: argVec				argOffsets: argOffsets				envBuf: envVec				envOffsets: envOffsets				workingDir: pwd.	anExternalProcess pid: childPid.	anExternalProcess ppid: self pid.	((childPid == 0) or: [childPid isNil])		ifTrue:			[anExternalProcess unknownRunState]		ifFalse:			[anExternalProcess running.			self registerChildProcess: anExternalProcess].	^ anExternalProcess! !!UnixProcess methodsFor: 'accessing' stamp: 'dtl 11/7/2000 09:10'!programName	^ programName! !!UnixProcess methodsFor: 'accessing' stamp: 'dtl 3/17/2007 22:54'!pthread	"The identity of the pthread in which the interpreter executes.	Always refresh pthread from the processAccessor, because it is possible for a child	to be reparented when the parent exits. The child does not know about this, so	we refresh pthread on every access."	^ pthread := processAccessor getThreadID! !!UnixProcess methodsFor: 'IO redirection' stamp: 'dtl 5/18/2009 21:07'!redirect: aFileStream to: newFileStream	| oldfd newfd |	oldfd := self processAccessor unixFileNumber: aFileStream fileID.	newfd := self processAccessor unixFileNumber: newFileStream fileID.	self processAccessor primUnixFileClose: oldfd.	^ self processAccessor primDup: newfd to: oldfd! !!UnixProcess methodsFor: 'IO redirection' stamp: 'dtl 5/17/2009 23:12'!redirectStdErrTo: fileStream	"Redirect the standard error stream to another output stream."	^ self redirect: self stdErr to: fileStream! !!UnixProcess methodsFor: 'IO redirection' stamp: 'dtl 5/17/2009 23:12'!redirectStdInTo: fileStream	"Redirect the standard input stream to another input stream."	^ self redirect: self stdIn to: fileStream! !!UnixProcess methodsFor: 'IO redirection' stamp: 'dtl 5/17/2009 23:11'!redirectStdOutTo: fileStream	"Redirect the standard output stream to another output stream."	"| pipe |	pipe := OSPipe nonBlockingPipe.	OSProcess thisOSProcess redirectStdOutTo: pipe writer.	pipe"		^ self redirect: self stdOut to: fileStream! !!UnixProcess methodsFor: 'updating' stamp: 'dtl 7/4/2010 22:35'!refreshFromProcessAccessor	"Set my instance variables to reflect the state of the OS process in which this Smalltalk	virtual machine is executing."	self needsRefresh ifTrue: [		sessionID := self processAccessor getSessionIdentifier.		pid := processAccessor primGetPid.		ppid := processAccessor primGetPPid.		pthread := processAccessor getThreadID.		self setStdIn.		self setStdOut.		self setStdErr.		programName := self getProgramName.		arguments := self getArgumentList.		environment := self getEnvironmentDictionary.		path := self pathString.		self updateAllMyChildren]! !!UnixProcess methodsFor: 'child process management' stamp: 'dtl 2/5/2015 20:06'!registerChildProcess: anOSProcess	self processAccessor sigChldSemaphore.	self processAccessor grimReaperProcess.	 "Start the reaper process if it is not running."	^ super registerChildProcess: anOSProcess! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:49'!sigabrt: anExternalOSProcess	"Send a SIGABRT signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigabrtTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:49'!sigalrm: anExternalOSProcess	"Send a SIGALRM signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigalrmTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:48'!sigchld: anExternalOSProcess	"Send a SIGCHLD signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigchldTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:48'!sigcont: anExternalOSProcess	"Send a SIGCONT signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigcontTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:48'!sighup: anExternalOSProcess	"Send a SIGHUP signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSighupTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:48'!sigint: anExternalOSProcess	"Send a SIGINT signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigintTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:48'!sigkill: anExternalOSProcess	"Send a SIGKILL signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigkillTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:48'!sigpipe: anExternalOSProcess	"Send a SIGPIPE signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigpipeTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:49'!sigquit: anExternalOSProcess	"Send a SIGQUIT signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigquitTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:50'!sigstop: anExternalOSProcess	"Send a SIGSTOP signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigstopTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:50'!sigterm: anExternalOSProcess	"Send a SIGTERM signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigtermTo: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:50'!sigusr1: anExternalOSProcess	"Send a SIGUSR1 signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigusr1To: anExternalOSProcess pid! !!UnixProcess methodsFor: 'OS signal sending' stamp: 'dtl 7/6/2000 16:51'!sigusr2: anExternalOSProcess	"Send a SIGUSR2 signal to the external process represented by anExternalOSProcess."	^ self processAccessor primSendSigusr2To: anExternalOSProcess pid! !!UnixProcess methodsFor: 'child process creation' stamp: 'dtl 1/21/2001 11:47'!squeak	"Start a new instance of Squeak running in a child OS process. The new 	instance will restart from the image file, so it is a clone of this image 	as it existed at the most recent image save."	"OSProcess thisOSProcess squeak"	^ self		forkJob: self programName		arguments: self arguments		environment: nil		descriptors: nil! !!UnixProcess methodsFor: 'updating' stamp: 'dtl 10/20/2001 09:05'!update: aParameter	"Framework to update some or all of the instance variables based on external events,	such as receipt of a sigchd signal when a child process exits."	(aParameter == (self processAccessor)) ifTrue:		[^ self refreshFromProcessAccessor; yourself].	(aParameter == #pid) ifTrue:		[^ self resetChildProcessDictionary. "Forget children of prior process"].	(aParameter == #childProcessStatus) ifTrue:		[^ self updateActiveChildren; changed; yourself].	(aParameter == #startUp) ifTrue:		[^ self update: #pid].	aParameter == #invalidProcessAccessor ifTrue:		[processAccessor := processAccessor ifNotNil: [processAccessor removeDependent: self. nil].		^ self].	self error: 'Unexpected update parameter'! !!UnixProcess methodsFor: 'external command processing' stamp: 'dtl 2/27/2002 15:24'!waitForCommand: aCommandString	"Run a command in a shell process. Similar to the system(3) call in the standard C library.	The active Smalltalk process waits for completion of the external command process. This just	uses a simple polling loop, which is not very elegant but works well enough for most purposes."	"OSProcess thisOSProcess waitForCommand: 'echo sleeping...; sleep 3; echo I just slept for three seconds'"	| proc d |	d := Delay forMilliseconds: 50.	proc := self		forkJob: ExternalUnixOSProcess defaultShellPath		arguments: (Array with: '-c' with: aCommandString)		environment: nil		descriptors: nil.	proc ifNil: [self class noAccessorAvailable].	[proc runState == #complete] whileFalse: [d wait].	^ proc! !!UnixProcess methodsFor: 'external command processing' stamp: 'dtl 7/12/2003 12:06'!waitForCommandOutput: aCommandString 	"Run a command in a shell process. Similar to the system(3) call in the 	standard C library. The active Smalltalk process waits for completion of	the external command process."	"OSProcess thisOSProcess waitForCommandOutput: 'echo sleeping...; sleep 1; echo I just slept for one second'"	"OSProcess thisOSProcess waitForCommandOutput: 'ThisIsABogusCommand'"	"OSProcess thisOSProcess waitForCommandOutput: '/bin/ls -l /etc /bin'"	"OSProcess thisOSProcess waitForCommandOutput: 'echo Hello world!!; ls /NOSUCHFILE'"	(Smalltalk hasClassNamed: #PipeableOSProcess)		ifTrue:			[^ ((Smalltalk at: #PipeableOSProcess) command: aCommandString) output]		ifFalse:			[self notify: 'the #waitForCommandOutput: method requires CommandShell'.			^ '']! !!UnixProcess methodsFor: 'external command processing' stamp: 'dtl 7/12/2003 12:08'!waitForCommandOutputArray: aCommandString	"Run a command in a shell process. Similar to the system(3) call in the standard C library.	The active Smalltalk process waits for completion of the external command process."	"OSProcess thisOSProcess waitForCommandOutputArray: 'echo Hello world!!; ls /NOSUCHFILE'"	| proc |	(Smalltalk hasClassNamed: #PipeableOSProcess)		ifTrue:			[proc := (Smalltalk at: #PipeableOSProcess) command: aCommandString.			^ Array				with: proc output				with: proc errorUpToEnd				with: proc processProxy exitStatus]		ifFalse:			[self notify: 'the #waitForCommandOutputArray: method requires CommandShell'.			^ Array with: '' with: '' with: nil]! !!WindowsProcess class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:50'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for	the Squeak VM running on the current platform."	^ self isWindows! !!WindowsProcess methodsFor: 'child process management' stamp: 'dtl 2/26/2002 16:08'!activeHandles	"Answer an Array of handles for all children that are believed to be running."	^ (self activeChildren collect: [:c | c handle]) asArray! !!WindowsProcess methodsFor: 'console' stamp: 'dtl 9/7/2002 20:57'!closeConsole	"Close the console. The standard input, output and error streams will no longer be available."	"OSProcess thisOSProcess closeConsole"	self processAccessor primFreeConsole.	self refreshFromProcessAccessor! !!WindowsProcess methodsFor: 'child process creation' stamp: 'dtl 2/28/2002 14:48'!command: aCommandString	"Run a command in a shell process. Similar to the system(3) call in	the standard C library, except that aCommandString runs asynchronously	in a child process. Answer an instance of ExternalWindowsProcess which	is a proxy for the new Windows process."	"OSProcess command: 'SOL'"	^ ExternalWindowsOSProcess command: aCommandString! !!WindowsProcess methodsFor: 'accessing' stamp: 'dtl 2/22/2002 22:02'!environment	^ environment! !!WindowsProcess methodsFor: 'environment' stamp: 'DamienCassou 5/3/2012 11:53'!environmentAt: aSymbol	"Answer an environment variable for the external OS process, and update the dictionary	in this Smalltalk object."	^ environment at: aSymbol asSymbol ifAbsent: []! !!WindowsProcess methodsFor: 'environment' stamp: 'DamienCassou 5/3/2012 11:53'!environmentAt: aSymbol put: aString	"Set an environment variable for the external OS process, and update the dictionary in	this Smalltalk object."	| s |	self initialize.	s := self processAccessor environmentAt: aSymbol put: aString.	s ifNotNil: [ self environment at: aSymbol asSymbol put: aString ].	^ s! !!WindowsProcess methodsFor: 'child process creation' stamp: 'dtl 10/18/2001 20:19'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams	"Use my processAccessor to call vfork() and execve() and create a	new child task. Answer a proxy for the new task, an instance of	ExternalWindowsProcess."	self notYetImplemented! !!WindowsProcess methodsFor: 'environment' stamp: 'dtl 1/24/2013 19:23'!getCwd	"Get current working directory. If this cannot be obtained from the	environment, answer a reasonable default."	"OSProcess thisOSProcess getCwd"	^ self processAccessor primGetCurrentWorkingDirectory		ifNil: [OSProcess defaultPathString]! !!WindowsProcess methodsFor: 'private' stamp: 'dtl 2/22/2002 22:00'!getEnvironmentDictionary	"Answer an environment dictionary using an OSProcessAccessor."	"OSProcess thisOSProcess getEnvironmentDictionary"	| strings env |	strings := processAccessor primGetEnvironmentStrings.	strings isNil		ifTrue:			[^ nil]		ifFalse:			[env := Dictionary new.			strings do: [:s |				env at: (s copyUpTo: $=) asSymbol put: (s copyAfterLast: $=)].			^ env]! !!WindowsProcess methodsFor: 'initialize - release' stamp: 'dtl 8/25/2010 20:49'!initialize	"Set my instance variables to reflect the state of the OS process in which 	this Smalltalk virtual machine is executing. On Windows, we cannot rely	on the pid to have changed when the VM is restarted, so use a one-shot	function to determine if we are restarting the VM (as opposed to returning	from an image save)."	super initialize.	(self processAccessor canAccessSystem not or: [processAccessor primOneShot]) ifTrue:		["Restarting the VM in a new process"		self resetThreads.		self threads; mainThread.		processHandle := nil.		self processHandle].	self refreshFromProcessAccessor! !!WindowsProcess methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:50'!isResponsibleForThisPlatform	"Answer true is this is an instance of the class which is responsible for representing	the OS process for the Squeak VM running on the current platform. A false answer is	usually the result of running the image on a different platform and VM."	^ self class isWindows! !!WindowsProcess methodsFor: 'accessing' stamp: 'dtl 2/28/2002 07:15'!mainThread	"The main thread for this OS process. The handle for this thread is a	pseudo-handle, and cannot be used to close the main thread."	^ mainThread ifNil: [mainThread := processAccessor getMainThread]! !!WindowsProcess methodsFor: 'console' stamp: 'dtl 9/7/2002 20:57'!openConsole	"Open a console. This makes the standard input, output and error streams available."	"OSProcess thisOSProcess openConsole"	self processAccessor primAllocConsole.	self refreshFromProcessAccessor! !!WindowsProcess methodsFor: 'environment' stamp: 'dtl 9/25/2005 05:11'!path	"Newer versions of Windows mixed case"	^ self environment		at: #PATH		ifAbsent: [environment				at: #Path				ifAbsent: ['']]! !!WindowsProcess methodsFor: 'accessing' stamp: 'dtl 2/22/2002 16:43'!pid	^ pid := self processAccessor primGetPid! !!WindowsProcess methodsFor: 'accessing' stamp: 'dtl 2/28/2002 07:26'!processHandle	"The handle for this OS process. This is a pseudo-handle, a constant provided	by Windows to represent the process. Note that the main thread handle is also	represented by a pseudo-handle."	^ processHandle ifNil: [processHandle := self processAccessor primGetPidHandle]! !!WindowsProcess methodsFor: 'updating' stamp: 'dtl 9/7/2002 20:47'!refreshFromProcessAccessor	"Set my instance variables to reflect the state of the OS process in which this Smalltalk	virtual machine is executing."	sessionID := self processAccessor getSessionIdentifier.	pid := processAccessor primGetPid.	self setStdIn.	self setStdOut.	self setStdErr.	environment := self getEnvironmentDictionary! !!WindowsProcess methodsFor: 'child process management' stamp: 'dtl 2/5/2015 20:06'!registerChildProcess: anOSProcess	"Register the external process and set an exit handler thread to signal when	the process exits."	super registerChildProcess: anOSProcess.	self threads add: self restartChildWatcherThread.	^ anOSProcess! !!WindowsProcess methodsFor: 'initialize - release' stamp: 'dtl 2/28/2002 07:16'!resetThreads	"If any cleanup is required, do it here."	threads := nil.	mainThread := nil! !!WindowsProcess methodsFor: 'child process management' stamp: 'dtl 1/13/2007 09:49'!restartChildWatcherThread	"Set an exit handler thread to signal when the process exits."	^ self processAccessor restartChildWatcherThread: self activeHandles! !!WindowsProcess methodsFor: 'private' stamp: 'dtl 9/7/2002 20:55'!setStdErr	"Reset to nil if the console has been closed"	^ self processAccessor getStdErr isNil		ifTrue: [stdErr := nil]		ifFalse: [super setStdErr]! !!WindowsProcess methodsFor: 'private' stamp: 'dtl 9/7/2002 20:55'!setStdIn	"Reset to nil if the console has been closed"	^ self processAccessor getStdIn isNil		ifTrue: [stdIn := nil]		ifFalse: [super setStdIn]! !!WindowsProcess methodsFor: 'private' stamp: 'dtl 9/7/2002 20:55'!setStdOut	"Reset to nil if the console has been closed"	^ self processAccessor getStdOut isNil		ifTrue: [stdOut := nil]		ifFalse: [super setStdOut]! !!WindowsProcess methodsFor: 'accessing' stamp: 'dtl 2/28/2002 08:04'!threads	"One or more threads of execution within the OS process. The main	thread for the process is held by the mainThread variable and is not	included in this collection. Threads are created to wait for the exit of	child processes, so this collection grows as child processes are created."	^ threads ifNil: [threads := OrderedCollection new]! !!WindowsProcess methodsFor: 'updating' stamp: 'dtl 2/25/2002 08:29'!update: aParameter	"Framework to update some or all of the instance variables based on external events,	such as receipt of a sigchd signal when a child process exits."	(aParameter == (self processAccessor)) ifTrue:		[^ self refreshFromProcessAccessor; yourself].	(aParameter == #pid) ifTrue:		[^ self resetChildProcessDictionary. "Forget children of prior process"].	(aParameter == #childProcessStatus) ifTrue:		[^ self updateActiveChildren; changed; yourself].	(aParameter == #startUp) ifTrue:		[^ self update: #pid].	aParameter == #invalidProcessAccessor ifTrue:		[processAccessor := processAccessor ifNotNil: [processAccessor removeDependent: self. nil].		^ self].	self error: 'Unexpected update parameter'! !!WindowsProcess methodsFor: 'child process management' stamp: 'dtl 2/28/2002 08:17'!updateActiveChildren	super updateActiveChildren.	self restartChildWatcherThread! !!WindowsProcess methodsFor: 'child process creation' stamp: 'dtl 11/24/2008 17:47'!waitForCommand: aCommandString	"Run a command in a shell process. Similar to the system(3) call in the standard C library.	The active Smalltalk process waits for completion of the external command process. This just	uses a simple polling loop, which is not very elegant but works well enough for most purposes."	| proc d |	d := Delay forMilliseconds: 50.	proc := self command: aCommandString.		proc ifNil: [self class noAccessorAvailable].	[proc runState == #complete] whileFalse: [d wait].	^ proc! !!UnixProcessExitStatus class methodsFor: 'instance creation' stamp: 'dtl 8/22/2012 21:24'!for: integerValue	^self new for: integerValue! !!UnixProcessExitStatus methodsFor: 'accessing' stamp: 'dtl 8/22/2012 23:10'!exitStatus	self isExited ifTrue: [^self statusIfExited].	self isSignaled ifTrue: [^self statusIfSignaled].	self isStopped ifTrue: [^self statusIfStopped].	self notify: 'cannot decode exit status ', intValue asString.	^intValue! !!UnixProcessExitStatus methodsFor: 'initialize-release' stamp: 'dtl 8/22/2012 23:10'!for: anInteger	intValue := anInteger! !!UnixProcessExitStatus methodsFor: 'testing' stamp: 'dtl 8/22/2012 22:32'!isExited	"	/* Nonzero if STATUS indicates normal termination.  */	#define __WIFEXITED(status)     (__WTERMSIG(status) == 0)	"	^ self statusIfSignaled = 0! !!UnixProcessExitStatus methodsFor: 'testing' stamp: 'dtl 8/22/2012 23:11'!isSignaled	"	/* Nonzero if STATUS indicates termination by a signal.  */	#define __WIFSIGNALED(status) \	  (((signed char) (((status) & 0x7f) + 1) >> 1) > 0)	"	^(((intValue bitAnd: 16r7F) + 1) >> 1) > 0! !!UnixProcessExitStatus methodsFor: 'testing' stamp: 'dtl 8/22/2012 23:11'!isStopped	"	/* Nonzero if STATUS indicates the child is stopped.  */	#define __WIFSTOPPED(status)    (((status) & 0xff) == 0x7f)	"	^(intValue bitAnd: 16rFF) = 16r7F! !!UnixProcessExitStatus methodsFor: 'testing' stamp: 'dtl 8/22/2012 23:31'!isSuccess	^self exitStatus = 0! !!UnixProcessExitStatus methodsFor: 'printing' stamp: 'dtl 8/22/2012 23:18'!printOn: aStream	self isExited		ifTrue: [aStream nextPutAll: 'normal termination with status ';				 nextPutAll: self statusIfExited asString].	self isSignaled		ifTrue: [aStream nextPutAll: 'exit due to signal ';				nextPutAll: self statusIfSignaled asString].	self isStopped		ifTrue: [aStream nextPutAll: 'stopped due to signal ';				nextPutAll: self statusIfStopped].! !!UnixProcessExitStatus methodsFor: 'accessing' stamp: 'dtl 8/22/2012 23:11'!statusIfExited	"	/* If WIFEXITED(STATUS), the low-order 8 bits of the status.  */	#define __WEXITSTATUS(status)   (((status) & 0xff00) >> 8)	"	^(intValue bitAnd: 16rFF00) >> 8! !!UnixProcessExitStatus methodsFor: 'accessing' stamp: 'dtl 8/22/2012 23:11'!statusIfSignaled	"	/* If WIFSIGNALED(STATUS), the terminating signal.  */	#define __WTERMSIG(status)      ((status) & 0x7f)	"	^intValue bitAnd: 16r7F! !!UnixProcessExitStatus methodsFor: 'accessing' stamp: 'dtl 8/22/2012 22:28'!statusIfStopped	"	/* If WIFSTOPPED(STATUS), the signal that stopped the child.  */	#define __WSTOPSIG(status)      __WEXITSTATUS(status)	"	^self statusIfExited! !!UnixProcessExitStatus methodsFor: 'accessing' stamp: 'dtl 8/22/2012 23:11'!value	^intValue! !!WindowsThread class methodsFor: 'instance creation' stamp: 'dtl 2/25/2002 07:00'!threadID: anInteger handle: aHandleObject	^ super new threadID: anInteger; handle: aHandleObject; initialize! !!WindowsThread class methodsFor: 'instance creation' stamp: 'dtl 2/26/2002 07:17'!threadID: anInteger handle: aHandleObject running: trueOrFalse	| thread |	thread := super new threadID: anInteger; handle: aHandleObject; initialize.	trueOrFalse ifTrue: [thread running].	^ thread! !!WindowsThread methodsFor: 'initialize - release' stamp: 'dtl 2/25/2002 07:38'!closeHandle	"Clean up after thread exits."	OSProcess accessor primCloseHandle: handle.	handle := nil! !!WindowsThread methodsFor: 'setting run state' stamp: 'dtl 2/26/2002 10:45'!complete	"Thread has exited."	self closeHandle; runState: #complete! !!WindowsThread methodsFor: 'accessing' stamp: 'dtl 2/25/2002 06:39'!handle	"A Windows HANDLE represented as a ByteArray."	^ handle! !!WindowsThread methodsFor: 'accessing' stamp: 'dtl 2/25/2002 06:38'!handle: aHandleObject	"A Windows HANDLE represented as a ByteArray."	handle := aHandleObject! !!WindowsThread methodsFor: 'initialize - release' stamp: 'dtl 2/25/2002 07:03'!initialize	self runState! !!WindowsThread methodsFor: 'testing' stamp: 'dtl 2/25/2002 06:37'!isComplete	^ self runState == #complete! !!WindowsThread methodsFor: 'testing' stamp: 'dtl 2/25/2002 06:37'!isRunning	^ self runState == #running! !!WindowsThread methodsFor: 'printing' stamp: 'dtl 2/27/2002 12:02'!printOn: aStream	super printOn: aStream.	aStream nextPutAll: ' (', self threadID printString, ', ', self runState, ')'! !!WindowsThread methodsFor: 'accessing' stamp: 'dtl 1/25/2004 11:01'!runState	^ runState ifNil: [self unknownRunState]! !!WindowsThread methodsFor: 'accessing' stamp: 'dtl 2/25/2002 07:02'!runState: aSymbol	runState := aSymbol! !!WindowsThread methodsFor: 'setting run state' stamp: 'dtl 2/25/2002 06:36'!running	"Thread is scheduled to run."	self runState: #running! !!WindowsThread methodsFor: 'initialize - release' stamp: 'dtl 2/27/2002 11:35'!terminate	"Force an exit. No cleanup is performed. Use with caution for a thread which	is (for example) manipulating a mutex."	(self isRunning and: [self handle notNil]) ifTrue:		[OSProcess accessor primTerminateThread: self handle.		self complete]! !!WindowsThread methodsFor: 'accessing' stamp: 'dtl 2/25/2002 06:40'!threadID	"A unique identifier for the thread."	^ threadID! !!WindowsThread methodsFor: 'accessing' stamp: 'dtl 2/25/2002 06:40'!threadID: anInteger	"A unique identifier for the thread."	threadID := anInteger! !!WindowsThread methodsFor: 'setting run state' stamp: 'dtl 2/25/2002 06:36'!unknownRunState	"Unable to determine the current run state of the thread, possibly because	this is a stale reference to a thread which no longer exists."	self runState: #unknownRunState! !!AioEventHandler class methodsFor: 'testing' stamp: 'dtl 2/11/2013 19:17'!aioPluginPresent	"Answer true if an AIO plugin is available. The value of AioPluginPresent	is cleared at startup time, and is reestablished once for each Squeak session.	See initializeAioPluginPresent to initialize after an image startup if warning	dialog is not desired."	"AioEventHandler aioPluginPresent"	^ AioPluginPresent		ifNil: [AioPluginPresent := self basicNew primAioModuleVersionString notNil.			AioPluginPresent ifFalse:				[self notify: 'AioPlugin not present, AioEventHandler will use polling input'].			^ AioPluginPresent]! !!AioEventHandler class methodsFor: 'instance creation' stamp: 'dtl 7/5/2003 09:16'!for: aSocketOrFileStream	"self for: SourceFiles first"	"self for: Socket new"	"self for: OSProcess thisOSProcess stdIn"	^ self new for: aSocketOrFileStream! !!AioEventHandler class methodsFor: 'instance creation' stamp: 'dtl 7/5/2003 11:14'!for: aSocketOrFileStream exceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag	"Flag parameters are true or false, indicating types of events to be handled."	^ self new for: aSocketOrFileStream			exceptions: exceptionEventFlag			readEvents: readEventFlag			writeEvents: writeEventFlag! !!AioEventHandler class methodsFor: 'instance creation' stamp: 'dtl 7/4/2003 18:47'!forFileStream: aFileStream	"self forFileStream: SourceFiles first"	^ self new forFileStream: aFileStream! !!AioEventHandler class methodsFor: 'instance creation' stamp: 'dtl 7/5/2003 11:14'!forFileStream: aFileStream exceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag	"Flag parameters are true or false, indicating types of events to be handled."	"self forFileStream: SourceFiles first"	^ self new forFileStream: aFileStream			exceptions: exceptionEventFlag			readEvents: readEventFlag			writeEvents: writeEventFlag! !!AioEventHandler class methodsFor: 'instance creation' stamp: 'dtl 7/4/2003 19:01'!forSocket: aSocket	"self forSocket: Socket new"	^ self new forSocket: aSocket! !!AioEventHandler class methodsFor: 'instance creation' stamp: 'dtl 7/5/2003 11:14'!forSocket: aSocket exceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag	"Flag parameters are true or false, indicating types of events to be handled."	"self forSocket: Socket new"	^ self new forSocket: aSocket			exceptions: exceptionEventFlag			readEvents: readEventFlag			writeEvents: writeEventFlag! !!AioEventHandler class methodsFor: 'testing' stamp: 'dtl 10/3/2012 20:24'!initializeAioPluginPresent	"Initialize the AioPluginPresent flag silently without invoking a warning	if the plugin is not present, and answer the value of the flag. Send this	to prevent a warning dialog from being presented after image startup,	as may be preferred if the image is to be run headless."	"AioEventHandler initializeAioPluginPresent"	^ AioPluginPresent		ifNil: [AioPluginPresent := self basicNew primAioModuleVersionString notNil]! !!AioEventHandler class methodsFor: 'system startup' stamp: 'dtl 11/25/2006 10:04'!startUp: resuming	"Clear the value of AioPluginPresent. The value will be set once when	#aioPluginPresent is first sent, and will remain set to that value for the	duration of this Squeak session.	This method is called by ThisOSProcess>>startUp. AioEventHandler does	not need to be registered in the system startup list."	resuming ifTrue: [AioPluginPresent := nil]! !!AioEventHandler methodsFor: 'aio event forwarding' stamp: 'dtl 7/4/2003 19:10'!aioDisable: ioDescriptor	"Definitively disable asynchronous event notification for a descriptor. The ioDescriptor	parameter is an object representing a low level OS file or socket descriptor."	^ self primAioDisable: ioDescriptor! !!AioEventHandler methodsFor: 'aio event forwarding' stamp: 'dtl 9/1/2003 16:58'!aioEnable: ioDescriptor forSemaphore: semaphoreIndex externalObject: trueOrFalse	"Enable asynchronous notification for a descriptor. Send this message one time	prior to beginning event handling for ioDescriptor. The ioDescriptor parameter is an	object representing a low level OS file or socket descriptor. The semaphoreIndex is	the index of a Semaphore to be notified, and the third parameter is a flag indicating	that ioDescriptor represents an external object which should not be closed on termination	of aio handling."	^ (self primAioEnable: ioDescriptor forSemaphore: semaphoreIndex externalObject: trueOrFalse)			ifNil: [self notify: 'aio event forwarding not supported']! !!AioEventHandler methodsFor: 'aio event forwarding' stamp: 'dtl 7/4/2003 18:52'!aioHandle: ioDescriptor exceptionEvents: exceptionFlag readEvents: readFlag writeEvents: writeFlag	"Enable asynchronous notification for a descriptor. Send this message one time to	enable a single event notification. Send it again after each event has been received	and handled (in other words, the process which waits on the event semaphore is	responsible for re-enabling the handler by calling this method each time an event	is handled). The ioDescriptor parameter is an object representing a low level OS file or	socket descriptor. The remaining three parameters are Boolean flags representing the	types of events for which notification is being requested: handle exceptions, handle	for read, and handle for write. It is common to watch for read events and exception	events, or to watch for write events and exception events."	^ self primAioHandle: ioDescriptor		exceptionEvents: exceptionFlag		readEvents: readFlag		writeEvents: writeFlag! !!AioEventHandler methodsFor: 'aio event forwarding' stamp: 'dtl 7/4/2003 19:10'!aioSuspend: ioDescriptor exceptionEvents: exceptionFlag readEvents: readFlag writeEvents: writeFlag	"Temporarily suspend asynchronous event notification for a descriptor. The	ioDescriptor parameter is an object representing a low level OS file or socket	descriptor. The remaining three parameters are Boolean flags representing the	types of events for which notification is being requested: handle exceptions,	handle for read, and handle for write."	^ self primAioSuspend: ioDescriptor		exceptionEvents: exceptionFlag		readEvents: readFlag		writeEvents: writeFlag! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 8/20/2006 18:43'!close	"When the FileStream or Socket handled by this aio handler is closed,	it should send #close to this handler."	| p |	self breakDependents.	Smalltalk unregisterExternalObject: semaphore.	self aioDisable: self descriptor.	semaphore := nil.	semaIndex := nil.	p := handlerProc.	handlerProc := nil.	p ifNotNil: [p terminate] "p may be the active process, do this last"! !!AioEventHandler methodsFor: 'handler process' stamp: 'dtl 7/5/2003 10:50'!defaultHandlerProcess	"Generate a #changed notification whenever an external aio event occurs"	^ self handleReadAndExceptionsEvents! !!AioEventHandler methodsFor: 'accessing' stamp: 'dtl 3/30/2003 19:05'!descriptor	^ descriptor! !!AioEventHandler methodsFor: 'accessing' stamp: 'dtl 3/30/2003 19:05'!descriptor: aLowLevelIODescriptor	descriptor := aLowLevelIODescriptor! !!AioEventHandler methodsFor: 'finalization' stamp: 'dtl 9/4/2003 06:54'!finalize	"Note: An aio handler will not be garbage collected until the semaphore	is unregistered. When the FileStream or Socket handled by this aio	handler is closed, it should send #close to this handler."	self close! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 7/5/2003 09:15'!for: aSocketOrFileStream	"Answer an event handler for any kind of IO stream that can be associated	with an OS handle for aio events. Currently, subclasses of FileStream and	Socket can have aio event handlers."	(aSocketOrFileStream isKindOf: Socket)		ifTrue: [^ self forSocket: aSocketOrFileStream].	(aSocketOrFileStream isKindOf: FileStream)		ifTrue: [^ self forFileStream: aSocketOrFileStream].	self error: 'expected a FileStream or Socket subclass'! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 7/5/2003 11:03'!for: aSocketOrFileStream exceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag	"Answer an event handler for any kind of IO stream that can be associated	with an OS handle for aio events. Currently, subclasses of FileStream and	Socket can have aio event handlers."	(aSocketOrFileStream isKindOf: Socket)		ifTrue: [^ self forSocket: aSocketOrFileStream					exceptions: exceptionEventFlag					readEvents: readEventFlag					writeEvents: writeEventFlag].	(aSocketOrFileStream isKindOf: FileStream)		ifTrue: [^ self forFileStream: aSocketOrFileStream					exceptions: exceptionEventFlag					readEvents: readEventFlag					writeEvents: writeEventFlag].	self error: 'expected a FileStream or Socket subclass'! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 7/9/2005 14:00'!forFileStream: aFileStream	self descriptor: (self handleForFile: aFileStream).	self setDefaultEventMask.! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 7/5/2003 11:01'!forFileStream: aFileStream exceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag	self descriptor: (self handleForFile: aFileStream).	self initializeForExceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 7/9/2005 14:00'!forSocket: aSocket	"Any existing event handling for aSocket will be disabled. Note that this	will make the socket useless for any applications that expect the prior	event handling behavior."	self descriptor: (self handleForSocket: aSocket).	self aioDisable: self descriptor.	self setDefaultEventMask.! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 7/5/2003 12:46'!forSocket: aSocket exceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag	"Any existing event handling for aSocket will be disabled. Note that this	will make the socket useless for any applications that expect the prior	event handling behavior."	self descriptor: (self handleForSocket: aSocket).	self aioDisable: self descriptor.	self initializeForExceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag! !!AioEventHandler methodsFor: 'handler process' stamp: 'dtl 11/12/2011 21:25'!handleExceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag	"Generate a #changed notification whenever the requested type of external aio event occurs."	| p sema handler |	sema := Semaphore new.	handler := [[self hasValidHandler] whileTrue:		[self aioHandle: self descriptor			exceptionEvents: exceptionEventFlag			readEvents: readEventFlag			writeEvents: writeEventFlag.		sema signal. "event handler is ready"		self semaphore wait.		self changed]].	p := handler forkAt: Processor userBackgroundPriority.	sema wait. "until process has been started and events are being handled"	^p! !!AioEventHandler methodsFor: 'private' stamp: 'dtl 9/4/2003 06:40'!handleForFile: aFileStream	"self new handleForFile: SourceFiles first"	| ioHandle |	ioHandle := self useIOHandle		ifTrue: [aFileStream ioHandle]		ifFalse: [aFileStream fileID].	^ self primOSFileHandle: ioHandle! !!AioEventHandler methodsFor: 'private' stamp: 'dtl 7/4/2003 15:16'!handleForSocket: aSocket	"self new handleForSocket: Socket newTCP"	| ioHandle |	ioHandle := self useIOHandle		ifTrue: [aSocket ioHandle]		ifFalse: [aSocket socketHandle].	^ self primOSSocketHandle: ioHandle! !!AioEventHandler methodsFor: 'handler process' stamp: 'dtl 7/5/2003 10:49'!handleReadAndExceptionsEvents	"Generate a #changed notification whenever data is available for reading or an exception	occurs on the external IO channel."	^ self handleExceptions: true readEvents: true writeEvents: false! !!AioEventHandler methodsFor: 'handler process' stamp: 'dtl 7/5/2003 10:49'!handleReadEvents	"Generate a #changed notification whenever data is available for reading"	^ self handleExceptions: false readEvents: true writeEvents: false! !!AioEventHandler methodsFor: 'accessing' stamp: 'dtl 3/30/2003 19:04'!handlerProc	^ handlerProc! !!AioEventHandler methodsFor: 'handler process' stamp: 'dtl 4/23/2012 06:45'!hasValidHandler	"True if the event handler is running, and if it refers to the correct external	object semaphore. For protection following an image restart."	^ semaIndex notNil		and: [Smalltalk externalObjects size >= semaIndex			and: [(Smalltalk externalObjects at: semaIndex) == semaphore]]! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 9/3/2010 16:48'!initializeForExceptions: exceptionEventFlag readEvents: readEventFlag writeEvents: writeEventFlag	semaphore := Semaphore new.	semaIndex := Smalltalk registerExternalObject: semaphore.	([self aioEnable: self descriptor forSemaphore: self semaIndex externalObject: true]		on: Warning		do: [:e |			self close. "unregister the semaphore"			self notify: e messageText. nil])		ifNotNil:			[handlerProc := self				handleExceptions: exceptionEventFlag				readEvents: readEventFlag				writeEvents: writeEventFlag]! !!AioEventHandler methodsFor: 'primitive access' stamp: 'dtl 9/1/2003 17:53'!primAioDisable: aDescriptor	"Definitively disable asynchronous event notification for a descriptor. The descriptor	parameter is an object representing a low level OS file or socket descriptor."	<primitive: 'primitiveAioDisable' module: 'AioPlugin'>	^ nil! !!AioEventHandler methodsFor: 'primitive access' stamp: 'dtl 9/1/2003 17:53'!primAioEnable: aDescriptor forSemaphore: semaphoreIndex externalObject: trueOrFalse	"Enable asynchronous notification for a descriptor. The descriptor parameter is an	object representing a low level OS file or socket descriptor. The semaphoreIndex	is the index of a Semaphore to be notified, and the third parameter is a flag indicating	that descriptor represents an external object which should not be closed on termination	of aio handling."	<primitive: 'primitiveAioEnable' module: 'AioPlugin'>	^ nil! !!AioEventHandler methodsFor: 'primitive access' stamp: 'dtl 9/1/2003 17:53'!primAioHandle: aDescriptor exceptionEvents: exceptionFlag readEvents: readFlag writeEvents: writeFlag	"Enable asynchronous notification for a descriptor. The descriptor parameter is an	object representing a low level OS file or socket descriptor. The second parameter is	the index of a Semaphore to be notified, the remaining three parameters are Boolean	flags representing the types of events for which notification is being requested:	handle exceptions, handle for read, and handle for write. It is common to watch for	read events and exception events, or to watch for write events and exception events."	<primitive: 'primitiveAioHandle' module: 'AioPlugin'>	^ nil! !!AioEventHandler methodsFor: 'primitive access' stamp: 'dtl 9/1/2003 17:26'!primAioModuleName	"Module name of the installed plugin, if any."	"self new primAioModuleName"	<primitive: 'primitiveModuleName' module: 'AioPlugin'>	^ nil! !!AioEventHandler methodsFor: 'primitive access' stamp: 'dtl 9/1/2003 17:28'!primAioModuleVersionString	"Module name of the installed plugin, if any."	"self new primAioModuleVersionString"	<primitive: 'primitiveVersionString' module: 'AioPlugin'>	^ nil! !!AioEventHandler methodsFor: 'primitive access' stamp: 'dtl 9/1/2003 17:54'!primAioSuspend: aDescriptor exceptionEvents: exceptionFlag readEvents: readFlag writeEvents: writeFlag	"Temporarily suspend asynchronous event notification for a descriptor. The	descriptor parameter is an object representing a low level OS file or socket	descriptor. The remaining three parameters are Boolean flags representing the	types of events for which notification is being requested: handle exceptions,	handle for read, and handle for write."	<primitive: 'primitiveAioSuspend' module: 'AioPlugin'>	^ nil! !!AioEventHandler methodsFor: 'primitive access' stamp: 'dtl 9/1/2003 17:54'!primOSFileHandle: sqFile	"Answer the low level file descriptor for a file IO handle."	<primitive: 'primitiveOSFileHandle' module: 'AioPlugin'>	^ nil! !!AioEventHandler methodsFor: 'primitive access' stamp: 'dtl 9/1/2003 17:54'!primOSSocketHandle: sqFile	"Answer the low level socket descriptor for a socket IO handle."	<primitive: 'primitiveOSSocketHandle' module: 'AioPlugin'>	^ nil! !!AioEventHandler methodsFor: 'accessing' stamp: 'dtl 3/30/2003 19:04'!semaIndex	^ semaIndex! !!AioEventHandler methodsFor: 'accessing' stamp: 'dtl 3/30/2003 19:04'!semaphore	^ semaphore! !!AioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 7/9/2005 14:00'!setDefaultEventMask	"Default initialization for read events and exception events"	^ self initializeForExceptions: true readEvents: true writeEvents: false! !!AioEventHandler methodsFor: 'private' stamp: 'dtl 3/30/2003 19:26'!useIOHandle	^ Smalltalk hasClassNamed: #IOHandle! !!MacOSProcessAccessor class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:44'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for the	Squeak VM running on the current platform."	^ OSProcess isNonUnixMac! !!MacOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 2/23/2002 05:57'!primGetSession	"Answer the unique identifier for this session of Smalltalk running in this OS Process."	^ nil! !!OS2OSProcessAccessor class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:47'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for the	Squeak VM running on the current platform."	^ OSProcess isOS2! !!OS2OSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 2/23/2002 05:56'!primGetSession	"Answer the unique identifier for this session of Smalltalk running in this OS Process."	^ nil! !!OSProcessAccessor class methodsFor: 'concrete subclasses' stamp: 'dtl 3/5/2005 12:04'!concreteClass	"OSProcessAccessor concreteClass"	^ self subclasses		detect: [:c | c isResponsibleForThisPlatform]		ifNone: [self notify: self printString,					': No concrete class implementation available for system type ',					OSProcess platformName printString.				nil]! !!OSProcessAccessor class methodsFor: 'initialize-release' stamp: 'dtl 3/5/2005 13:24'!emulateWin32FileLocking: trueOrFalse	"This is a preference that controls whether file locking will attempt to emulation	Win32 behavior, in which a lock request will fail if the requested region overlaps	a region for which there is an existing lock. This behavior is valid only for locks	managed within a single Squeak image, and will not produce the expected results	for a Squeak image cooperating with another Squeak image, or with some other	external program.	Use of the Win32 emulation may result in performance penalties for an application	that performs a large number of lock requests, such as a database."	"self emulateWin32FileLocking: true"	"self emulateWin32FileLocking: false"	EmulateWin32FileLocking := trueOrFalse! !!OSProcessAccessor class methodsFor: 'instance creation' stamp: 'dtl 12/14/2013 09:15'!forThisOSProcess	"Answer a single instance corresponding to the OS process in which this 	Smalltalk image is executing."	"OSProcessAccessor forThisOSProcess"	ThisOSProcessAccessor		ifNotNil: [ThisOSProcessAccessor isResponsibleForThisPlatform					ifTrue:						["Common case, platform has not changed"						^ThisOSProcessAccessor ]					ifFalse:						["We are running on a different platform, so start a new accessor"						ThisOSProcessAccessor changed: #invalidProcessAccessor.						ThisOSProcessAccessor finalize]].	^ ThisOSProcessAccessor := self concreteClass basicNew initialize! !!OSProcessAccessor class methodsFor: 'initialize-release' stamp: 'dtl 12/14/2013 09:15'!initialize	"OSProcessAccessor initialize"	UseIOHandle := (Smalltalk hasClassNamed: #IOHandle).	ThisOSProcessAccessor := nil.	self emulateWin32FileLocking: false.	self allSubInstances do: [:e | e finalize]! !!OSProcessAccessor class methodsFor: 'platform identification' stamp: 'dtl 8/24/2003 09:17'!isResponsibleForThisPlatform	"Answer true if an instance of this class is responsible for representing the	OS process for the Squeak VM running on the current platform."	^ self subclassResponsibility! !!OSProcessAccessor class methodsFor: 'instance creation' stamp: 'dtl 3/2/2002 08:29'!new	self inform: 'use OSProcessAccessor>>forThisOSProcess to create or obtain the OSProcess instance for this Smalltalk session.'.	^ nil! !!OSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:41'!aioModuleName	"Answer a string containing the module name string for the AIO plugin."	"OSProcess accessor aioModuleName"	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:41'!aioVersionString	"Answer a string containing the version string for the AIO plugin."	"OSProcess accessor aioVersionString"	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'testing' stamp: 'dtl 10/18/2001 22:58'!canAccessSystem	"Answer true if it is possible to access the external process. Concrete subclasses should	know how to answer true."	^ false! !!OSProcessAccessor methodsFor: 'file lock registry' stamp: 'dtl 4/9/2005 22:44'!canAcquireLock: anOSFileLockDescriptor	"Answer true if the file lock cache will permit fileLock to be acquired. This method	does not guarantee that the underlying OS will grant the lock."	^ (self fileLockRegistry anySatisfy:			[:ld | ld isActive and: [ld conflictsWith: anOSFileLockDescriptor]]) not! !!OSProcessAccessor methodsFor: 'testing' stamp: 'dtl 2/14/2004 11:43'!canForwardExternalSignals	"Answer true if it is possible to forward OS signals to a Smalltalk Semaphore."	^ false! !!OSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 4/7/2007 10:19'!canObtainSessionIdentifierFromPlugin	^ canObtainSessionIdentifierFromPlugin		ifNil: [canObtainSessionIdentifierFromPlugin := self primGetSession notNil]! !!OSProcessAccessor methodsFor: 'file lock registry' stamp: 'dtl 3/5/2005 13:21'!emulateWin32FileLocking	"Answer the current value of this preference"	^ EmulateWin32FileLocking! !!OSProcessAccessor methodsFor: 'file lock registry' stamp: 'dtl 9/24/2009 21:36'!fileLockRegistry	^ FileLockRegistry ifNil: [FileLockRegistry := Set new]! !!OSProcessAccessor methodsFor: 'session identification' stamp: 'dtl 8/6/2003 21:39'!getSessionIdentifier	"Call a primitive to obtain the unique identifier for this Squeak session. If the	primitive fails, try to deduce the session identifier from an instance of	StandardFileStream. Some versions of the OSProcessPlugin may not be able to	obtain a session ID, so this provides a mechanism for obtaining the session ID	indirectly if necessary."	"OSProcess accessor getSessionIdentifier"	| session |	session := self primGetSession.	session ifNil: [session :=  self getSessionIdentifierFromSourcesFile].	session ifNil: [session :=  self getSessionIdentifierFromFileInSqueakDirectory].	^ session! !!OSProcessAccessor methodsFor: 'session identification' stamp: 'dtl 1/23/2013 21:30'!getSessionIdentifierFromFileInSqueakDirectory	"Deduce the session identifier using method of last resort.	This is an unreliable method, because it assumes knowledge of the internal structure	of the SQFile data structure.	Deprecated:	As of approximately Squeak 3.8 and beyond, the session id has been moved to the	first slot of the data structure. This method will not work for a Squeak VM beyond	that point, and will not work for any 64 bit VM. However, an reliable means of	obtaining sessionID is now available (#getSessionIdentifier), so this method is retained	only for backwards compatibility to allow OSPP to be built on an older VMMaker."	"OSProcess accessor getSessionIdentifierFromFileInSqueakDirectory"	| id s |	(OSProcess directoryEntryNames: OSProcess defaultPathString) do:		[:n | (s := FileStream readOnlyFileNamed: n) ifNotNil:			[(Smalltalk hasClassNamed: #IOHandle)				ifTrue: [id := s ioHandle getHandle copyFrom: 5 to: 8]				ifFalse: [(id := s fileID) ifNotNil: [id copyFrom: 5 to: 8]].			s close.			^ id]].	^ nil! !!OSProcessAccessor methodsFor: 'session identification' stamp: 'dtl 8/7/2005 22:02'!getSessionIdentifierFromSourcesFile	"Deduce the session identifier from an existing open FileStream on the sources file.	This is an unreliable method, because it assumes knowledge of the internal structure	of the SQFile data structure.	Deprecated:	As of approximately Squeak 3.8 and beyond, the session id has been moved to the	first slot of the data structure. This method will not work for a Squeak VM beyond	that point, and will not work for any 64 bit VM. However, an reliable means of	obtaining sessionID is now available (#getSessionIdentifier), so this method is retained	only for backwards compatibility to allow OSPP to be built on an older VMMaker."	"OSProcess accessor getSessionIdentifierFromSourcesFile"	| s id |	s := SourceFiles first.	s ifNil: [^ nil].	^ (Smalltalk hasClassNamed: #IOHandle)		ifTrue: [s ioHandle getHandle copyFrom: 5 to: 8]		ifFalse: [(id := s fileID) ifNotNil: [id copyFrom: 5 to: 8]]! !!OSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/25/2005 16:07'!getStdErrHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard error for the	OS process in which I am currently executing."	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/25/2005 16:07'!getStdInHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard input for the	OS process in which I am currently executing."	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/25/2005 16:06'!getStdOutHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard output for the	OS process in which I am currently executing."	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 2/27/2015 19:54'!grimReaper	"Answer the value of grimReaper"	^ grimReaper! !!OSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 2/27/2015 19:54'!grimReaper: anObject	"Set the value of grimReaper"	grimReaper := anObject! !!OSProcessAccessor methodsFor: 'private - IOHandle' stamp: 'dtl 3/1/2002 15:19'!handleFromAccessor: aByteArrayOrIOAccessor	UseIOHandle		ifTrue: [aByteArrayOrIOAccessor isNil			ifTrue: [^ nil]			ifFalse: [^ aByteArrayOrIOAccessor asSQFileStruct]]		ifFalse: [^ aByteArrayOrIOAccessor]! !!OSProcessAccessor methodsFor: 'private - IOHandle' stamp: 'dtl 1/3/2004 21:21'!handleFromFileStream: aFileStream	^ UseIOHandle		ifTrue: [self handleFromAccessor: aFileStream ioHandle]		ifFalse: [aFileStream fileID]! !!OSProcessAccessor methodsFor: 'testing' stamp: 'dtl 8/8/2002 15:13'!handlesOsSignals	"True if OS signals can be handled and forwarded to the image"	^ false! !!OSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 2/27/2015 19:51'!initialize	canObtainSessionIdentifierFromPlugin := nil.	self canObtainSessionIdentifierFromPlugin.	sessionIdentifier := nil.	self sessionIdentifier.! !!OSProcessAccessor methodsFor: 'private - IOHandle' stamp: 'dtl 7/12/2003 12:17'!ioAccessorFromSQFile: aByteArray	"Answer an object which represents an IO channel. If IOHandle is present in	this image, use it; otherwise just answer aByteArray."	UseIOHandle		ifTrue: [^ (Smalltalk at: #IOHandle) newFromSqFileStruct: aByteArray]		ifFalse: [^ aByteArray]! !!OSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 11/28/2010 14:04'!isAtEndOfFile: anIOHandle	"Answer whether the file represented by anIOHandle is at end of file, as determined	by a call to feof(). This is different from StandardFileStream>>primAtEnd: which answers	true if the file pointer is at the end of the file, but which does not call feof() to	determine that an end of file condition has occurred. The difference is significant	if aSqFileStruct represents a pipe or a device file, which may not be positionable	in the sense of a conventional disk file."	^ self primTestEndOfFileFlag: (self handleFromAccessor: anIOHandle)! !!OSProcessAccessor methodsFor: 'platform identification' stamp: 'dtl 8/24/2003 09:18'!isResponsibleForThisPlatform	"Answer true is this is an instance of the class which is responsible for representing	the OS process for the Squeak VM running on the current platform. A false answer is	usually the result of running the image on a different platform and VM."	^ self class isResponsibleForThisPlatform! !!OSProcessAccessor methodsFor: 'pipe open' stamp: 'dtl 11/28/2010 12:28'!makePipeHandles	"Create a pipe, and answer an array of two IO accessors for the pipe 	reader and writer."	"OSProcess accessor makePipeHandles"	^self primCreatePipe		ifNotNilDo: [:p | ^ p collect: [:e | self ioAccessorFromSQFile: e]]! !!OSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 2/28/2015 18:33'!newPid	"This image is now being run in a new VM process with different pid. Pause the handling	of child processes, and remove references to child processes that no longer pertain to	the current VM process."	grimReaper ifNotNilDo: [ :p | p terminate. grimReaper := nil ].	self changed: #pid.	self restartChildWatcherProcess! !!OSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:41'!osppModuleName	"Answer a string containing the module name string for the OSPP plugin."	"OSProcess accessor osppModuleName"	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:41'!osppModuleVersionString	"Answer a string containing the version string for the OSPP plugin."	"OSProcess accessor osppModuleVersionString"	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'session identification' stamp: 'dtl 3/2/2002 09:07'!primGetSession	"Subclasses should override if they know how to obtain the session identifier."	^ nil! !!OSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 4/8/2007 10:49'!primTestEndOfFileFlag: aSqFileStruct	"Answer whether the file represented by aSqFileStruct is at end of file, as determined	by a call to feof(). This is different from StandardFileStream>>primAtEnd: which answers	true if the file pointer is at the end of the file, but which does not call feof() to	determine that an end of file condition has occurred. The difference is significant	if aSqFileStruct represents a pipe or a device file, which may not be positionable	in the sense of a conventional disk file."	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'file lock registry' stamp: 'dtl 3/5/2005 13:06'!register: fileRegionLock	"If an object equal to fileRegionLock exists in the registry, answer it. Otherwise, add	fileRegionLock to the registry and answer fileRegionLock."	^ (self fileLockRegistry like: fileRegionLock)		ifNil: [self fileLockRegistry add: fileRegionLock]! !!OSProcessAccessor methodsFor: 'file lock registry' stamp: 'dtl 4/10/2005 15:05'!registeredLocksForFile: aFileStream	"Answer all lock descriptors associated with aFileStream"	^ self fileLockRegistry select: [:ea | ea fileStream = aFileStream]! !!OSProcessAccessor methodsFor: 'file lock registry' stamp: 'jf 2/26/2004 18:06'!removeInactiveLocks	"Go through the lock cache and remove any that have been left	behind after their streams were closed."	^ self fileLockRegistry copy do: [:ea | ea isActive ifFalse: [self fileLockCache remove: ea]]! !!OSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 2/28/2015 18:31'!restartChildWatcherProcess	self subclassResponsibility! !!OSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 3/2/2002 08:32'!sessionIdentifier	^ sessionIdentifier ifNil: [sessionIdentifier := self getSessionIdentifier]! !!OSProcessAccessor methodsFor: 'file control' stamp: 'dtl 2/11/2001 15:37'!setNonBlocking: anIOHandle	"Convert anIOHandle to an SQFile data structure and call primitive to set it non-blocking."	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'file lock registry' stamp: 'dtl 3/5/2005 13:07'!unregister: fileRegionLock	"If an object equal to fileRegionLock exists in the registry, remove it and	answer the object. Otherwise answer nil."	^ self fileLockRegistry remove: fileRegionLock ifAbsent: [nil]! !!OSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:41'!xdcpModuleName	"Answer a string containing the module name string for the display control plugin."	"OSProcess accessor xdcpModuleName"	^ self subclassResponsibility! !!OSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:42'!xdcpVersionString	"Answer a string containing the version string for the display control plugin."	"OSProcess accessor xdcpVersionString"	^ self subclassResponsibility! !!RiscOSProcessAccessor class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:48'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for the	Squeak VM running on the current platform."	^ OSProcess isRiscOS! !!RiscOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 1/6/2001 23:15'!primForkAndExec: executableFile	withArgs: anArrayOfArgumentStrings	argCount: numberOfArgumentStrings	withEnv: anArrayOfEnvironmentStrings	envCount: numberOfEnvironmentStrings	stdIn: inputFileHandle	stdOut: outputFileHandle	stdErr: errorFileHandle	"Parameters are expected to have been properly prepared by the caller,	including string values which are to be null terminated strings.	In other words, all strings should have (Character value: 0) as the	last element in the string."! !!RiscOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 2/23/2002 05:56'!primGetSession	"Answer the unique identifier for this session of Smalltalk running in this OS Process."	^ nil! !!UnixOSProcessAccessor class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:49'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for the	Squeak VM running on the current platform."	^ OSProcess isUnix! !!UnixOSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:43'!aioModuleName	"Answer a string containing the module name string for the AIO plugin."	"OSProcess accessor aioModuleName"	^ self primAioPluginModuleName! !!UnixOSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:44'!aioVersionString	"Answer a string containing the version string for the AIO plugin."	"OSProcess accessor aioVersionString"	^ self primAioPluginVersionString! !!UnixOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 10/7/2000 13:39'!canAccessChildProcess: anExternalProcess	"Is the child process still there? Maybe not if we have restarted the image	and anExternalProcess refers to a process which died while we were not	watching."	^ self primCanReceiveSignals: anExternalProcess pid! !!UnixOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 9/9/2000 15:45'!canAccessSystem	"Answer true if it is possible to access the external process, else false. Failure	to access the external process is probably due to lack of a UnixOSProcessPlugin	module."	^ self primGetPid notNil! !!UnixOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 8/30/2003 18:43'!canControlXDisplay	"True if the XDisplayControlPlugin is accessible. Older versions of OSProcess relied on	the X display control to be embedded in the OSProcessPlugin module. This has been	moved to a separate display control plugin to allow support of non-X platforms and	other display media on Unix platforms (OS X)."	"OSProcess accessor canControlXDisplay"	^ self primXDisplayControlPluginModuleName notNil! !!UnixOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 2/14/2004 12:17'!canForwardExternalSignals	"Answer true if it is possible to forward OS signals to a Smalltalk Semaphore."	^ true! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/31/2001 15:07'!chDir: pathString	"Change current working directory. The $PWD environment variable is not updated (but	see UnixProcess>>chDir:). Answer nil for success, or an error message."	"OSProcess accessor chDir: '/tmp'"	"OSProcess accessor chDir: '/no/such/path'"	"OSProcess accessor chDir: FileDirectory default name"	| result message |	result := self primChdir: pathString.	result isNil		ifTrue:			[^ nil]		ifFalse:			[message := self primErrorMessageAt: result.			^ message]! !!UnixOSProcessAccessor methodsFor: 'signal print stack trace' stamp: 'dtl 7/20/2010 00:06'!clearPrintAllStacksOnSigUsr1	"Clear any signal handler in the VM that was set to print all call stacks on	console output when a SIGUSR1 is received. Restores default SIGUSR1	handler, which may result in exiting the VM on this signal. Answer an	identifier for the previously defined signal handler or nil if no handler	had been set."	^self primForwardSignal: self primSigUsr1Number toSemaphore: nil	! !!UnixOSProcessAccessor methodsFor: 'file control' stamp: 'dtl 3/2/2009 22:42'!closeUnixFileNumber: unixFileDescriptor	"Close the file associated with unixFileDescriptor, a small integer value."	<primitive: 'primitiveUnixFileClose' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'debugging' stamp: 'dtl 11/19/2006 09:02'!currentSigHandlerAddress: signalNumber	"Answer the current machine address of the signal handler for signalNumber,	expressed as a ByteArray.	Temporarily set a signal forwarded for signalNumber, and remember the	machine address of the prior signal handler. Restore the signal handler	to its previous value, and answer the machine address of the handler."	"OSProcess accessor currentSigHandlerAddress: OSProcess accessor primSigIntNumber"	| sema index previousHandlerAddress |	sema := Semaphore new.	index := Smalltalk registerExternalObject: sema.	(previousHandlerAddress := self primForwardSignal: signalNumber toSemaphore: index)		ifNil:			[Smalltalk unregisterExternalObject: sema.			^ self error: 'could not forward signal number ', signalNumber asString].	self restoreSignal: signalNumber.	^ previousHandlerAddress! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 7/2/2000 19:59'!environmentAt: aSymbolOrString	"Get an environment variable from the external OS process."	"OSProcess thisOSProcess environmentAt: 'PATH'"	^ self primEnvironmentAtSymbol: aSymbolOrString! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 10/7/2001 01:18'!environmentAt: aSymbolOrString put: aString	"Add or update an environment variable in the external OS process. Convert aSymbol	and aString into a KEY=value string and pass this to the OS process environment.	Standard C libraries provide a putenv() function for this purpose, with a parameter	in the form KEY=value. Note: Maintain a reference to the return value, see note in	primitivePutEnv."	"OSProcess accessor environmentAt: 'AAAA' put: 'this is the value of AAAA'"	"OSProcess accessor environmentAt: 'AAAA' put: nil"	"OSProcess accessor environmentAt: 'AAAA'"	aString isNil		ifTrue:			[^ self primUnsetEnv: aSymbolOrString, (Character value: 0) asString]		ifFalse:			[^ self environmentPut: (aSymbolOrString asString, '=', aString)]! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 9/10/2000 09:48'!environmentPut: aString	"Add or update an environment variable in the external OS process using a 'KEY=value'	string. Create a null terminated string for use by the external putenv() call in a pluggable	primitive."	"OSProcess thisOSProcess processAccessor environmentPut: 'SOMEKEY=somevalue'"	| cString |	cString := aString, (Character value: 0) asString.	^ self primPutEnv: cString! !!UnixOSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 5/1/2001 05:49'!fileProtectionMask: aPathString	"Call stat(2) to obtain the file protection mask for a file."	"OSProcess accessor fileProtectionMask: '/bin/sh'"	"OSProcess accessor fileProtectionMask: '/etc/hosts'"	"OSProcess accessor fileProtectionMask: '/bin/su'"	"OSProcess accessor fileProtectionMask: '/bin/NOSUCHFILE'"	"OSProcess accessor fileProtectionMask: 12345"	| mask |	(aPathString isKindOf: String) ifFalse: [self error: 'expected a path string'. ^ nil].	mask := self primFileProtectionMask: aPathString.	(mask == nil) ifTrue: [^ nil].	(mask isKindOf: Integer)		ifTrue: [^ self primErrorMessageAt: mask].	^ mask! !!UnixOSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 5/1/2001 05:49'!fileStat: aPathString	"Call stat(2) to obtain the UID, GID, and file protection mask for a file."	"OSProcess accessor fileStat: '/var/spool/news'"	"OSProcess accessor fileStat: '/etc/hosts'"	"OSProcess accessor fileStat: '/bin/su'"	"OSProcess accessor fileStat: '/bin/NOSUCHFILE'"	"OSProcess accessor fileStat: 12345"	| mask |	(aPathString isKindOf: String) ifFalse: [self error: 'expected a path string'. ^ nil].	mask := self primFileStat: aPathString.	(mask == nil) ifTrue: [^ nil].	(mask isKindOf: Integer)		ifTrue: [^ self primErrorMessageAt: mask].	^ mask! !!UnixOSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 7/6/2010 21:22'!finalize	"Clean up grimReaper and associated semaphore."	self grimReaper ifNotNil:			[grimReaper terminate.			grimReaper := nil].	self sigChldSemaphore ifNotNil:			[self restoreSigChld.			self sigChldSemaphore: nil]! !!UnixOSProcessAccessor methodsFor: 'file control' stamp: 'dtl 11/28/2010 12:13'!flushExternalStream: anIOHandle	"Convert anIOHandle to an SQFile data structure and call primitive to flush the	external I/O stream."	^ self primSQFileFlush: (self handleFromAccessor: anIOHandle)! !!UnixOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 1/25/2004 21:43'!forkAndExec: executableFile	stdIn: inputFileHandle	stdOut: outputFileHandle	stdErr: errorFileHandle	argBuf: argVec	argOffsets: argOffsets	envBuf: envVec	envOffsets: envOffsets	workingDir: pathString	"Parameters are expected to have been properly prepared by the caller, including string	values which are to be null terminated strings. In other words, all strings should have	(Character value: 0) as the last element in the string.	Parameters should be:		executableFile: a string with the name of a file to execute.		stdIn: a fileID ByteArray (struct SQFile in C) to be used as standard input.		stdOut: a fileID ByteArray to be used as standard output.		stdErr: a fileID ByteArray to be used as standard error.		argVec: a String arranged to look more or less like a char **, but with the addresses not yet fixed.		argOffsets: an Array of offsets for fixing up the argVec addresses.		envVec: a String arranged to look more or less like a char **, but with the addresses not yet fixed.		envOffsets: an Array of offsets for fixing up the envVec addresses.		workingDir: a null terminated path name String, or nil.	The envVec parameter may be nil, in which case envOffsets is ignored. workingDir may be nil. The	other parameters are required. Parameters with nil value indicate that current values for this process	should be used."	^ self primForkExec: executableFile			stdIn: inputFileHandle			stdOut: outputFileHandle			stdErr: errorFileHandle			argBuf: argVec			argOffsets: argOffsets			envBuf: envVec			envOffsets: envOffsets			workingDir: pathString! !!UnixOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 4/27/2011 21:01'!forkSqueak	"Clone this Squeak Smalltalk image in a child OSProcess. The child is the same as the	parent, except for its new X session connection, and the return value of this method,	which is zero for the child process, and a positive integer equal to the pid of the child	for the parent process.	The child should not depend on using existing connections to external resources. For	example, the child may lose its connections to stdin, stdout, and stderr after its parent	exits."	self safeToForkSqueak		ifTrue: [^self primForkSqueak].	[self notify: 'forkSqueak requires XDisplayControlPlugin']		ensure: [^nil]! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:51'!forwardSigChld	"Set a signal handler for SIGCHLD. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigChld"	^ self forwardSignal: self primSigChldNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:51'!forwardSigHup	"Set a signal handler for SIGHUP. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigHup"	^ self forwardSignal: self primSigHupNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:51'!forwardSigInt	"Set a signal handler for SIGINT. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigInt"	^ self forwardSignal: self primSigIntNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:51'!forwardSigKill	"Set a signal handler for SIGKILL. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigKill"	self notify: 'SIGKILL and SIGSTOP signals cannot be caught, see man signal(2)'.	^ self forwardSignal: self primSigKillNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:52'!forwardSigPipe	"Set a signal handler for SIGPIPE. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigPipe"	^ self forwardSignal: self primSigPipeNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:52'!forwardSigQuit	"Set a signal handler for SIGQUIT. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigQuit"	^ self forwardSignal: self primSigQuitNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:52'!forwardSigTerm	"Set a signal handler for SIGTERM. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigTerm"	^ self forwardSignal: self primSigTermNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:52'!forwardSigUsr1	"Set a signal handler for SIGUSR1. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigUsr1"	^ self forwardSignal: self primSigUsr1Number! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:52'!forwardSigUsr2	"Set a signal handler for SIGUSR2. Answer a new Semaphore, or nil if unable	to set the handler (possibly because it has already been set)."	"OSProcess accessor forwardSigUsr1"	^ self forwardSignal: self primSigUsr2Number! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 12/6/2002 18:28'!forwardSignal: signalNumber 	"Set a signal handler in the VM which will signal a Smalltalk semaphore 	at semaphoreIndex whenever an external signal sigNum is received.	Answer a new Semaphore, or nil if unable to set the handler (possibly	because it has already been set). A Smalltalk process can wait on the	Semaphore, and take action when a signal is detected. See man(7) signal	for signal number definitions on your unix system."	"OSProcess accessor forwardSignal: OSProcess accessor primSigIntNumber"	| sema index |	sema := Semaphore new.	index := Smalltalk registerExternalObject: sema.	(self primForwardSignal: signalNumber toSemaphore: index)		ifNil:			[Smalltalk unregisterExternalObject: sema.			^ nil].	^ sema! !!UnixOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 11/28/2010 12:07'!getStdErrHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard error for the	OS process in which I am currently executing."	^ self primGetStdErrHandle		ifNotNilDo: [:handle | self ioAccessorFromSQFile: handle]! !!UnixOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 11/28/2010 12:07'!getStdInHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard input for the	OS process in which I am currently executing."	^ self primGetStdInHandle		ifNotNilDo: [:handle | self ioAccessorFromSQFile: handle]! !!UnixOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 11/28/2010 12:08'!getStdOutHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard output for the	OS process in which I am currently executing."	^ self primGetStdOutHandle		ifNotNilDo: [:handle | self ioAccessorFromSQFile: handle]! !!UnixOSProcessAccessor methodsFor: 'pthreads' stamp: 'dtl 3/17/2007 23:14'!getThreadID	"Answer the ID of the pthread that is currently executing (the interpreter thread).	A thread ID may be a 64 bit value on some platforms, so answer a byte array	containing the value in machine-dependent byte order."	"OSProcess accessor getThreadID"	| osppVer |	[osppVer := OSProcess accessor osppModuleVersionString asNumber]		on: Error		do: [^ nil].	(osppVer notNil and: [osppVer >= 4.2])		ifTrue: [^ self primGetThreadID]		ifFalse: [^ nil]! !!UnixOSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 6/2/2015 20:54'!grimReaperProcess	"This is a process which waits for the death of a child OSProcess, and 	informs any dependents of the change. Use SIGCHLD events if possible,	otherwise a Delay to poll for exiting child processes."	| eventWaiter processSynchronizationDelay |	^ self canAccessSystem		ifTrue:			[eventWaiter := (self canAccessSystem and: [self canForwardExternalSignals])				ifTrue: [self sigChldSemaphore "semaphore signaled by SIGCHLD" ]				ifFalse: [Delay forMilliseconds: 200 "simple polling loop" ].			processSynchronizationDelay := Delay forMilliseconds: 20.			grimReaper ifNil:				[grimReaper :=					[[(eventWaiter respondsTo: #waitTimeoutMSecs: )						ifTrue: [eventWaiter waitTimeoutMSecs: 1000 "semaphore with timeout"]						ifFalse: [eventWaiter wait].					processSynchronizationDelay wait. "Avoids lost signals in heavy process switching"					self changed: #childProcessStatus] repeat] newProcess.					grimReaper resume.					"name selected to look reasonable in the process browser"					grimReaper name: ((ReadStream on: grimReaper hash asString) next: 5)							, ': the child OSProcess watcher']]		ifFalse:			[nil]! !!UnixOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 8/8/2002 15:13'!handlesOsSignals	"True if OS signals can be handled and forwarded to the image"	^ true! !!UnixOSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 7/7/2010 07:46'!initialize	"Call this method when an instance is first created, or to refresh after an image	restart to clean up from the previous session. Notify dependents of my singleton	instance if the image has restarted in a different OS process (this is not the case	when #startUp is called after a simple image save)."	self finalize.	super initialize.	ThisProcessPid ~~ self primGetPid		ifTrue: 			["Image has been restarted and is now running in a different OS process"			ThisProcessPid := self primGetPid.			self changed: #startUp].	self changed.	self restartChildWatcherProcess.! !!UnixOSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 10/6/2001 12:08'!isExecutable: aPathName	"Answer true if file at aPathName has execute permission for this process."	"OSProcess accessor isExecutable: '/bin/sh'"	"OSProcess accessor isExecutable: '/no/such/file'"	^ self isExecutable: aPathName forUser: self primGetUid inGroup: self primGetGid! !!UnixOSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 5/1/2001 22:53'!isExecutable: aPathName forUser: uid inGroup: gid	"Answer true if file at aPathName has execute permission for a user	identified by user uid and group gid."	"OSProcess accessor		isExecutable: '/bin/sh'		forUser: OSProcess accessor primGetUid		inGroup: OSProcess accessor primGetGid"	| fStat suid sgid user group protectionMask |	fStat := self fileStat: aPathName.	(fStat isKindOf: String)		ifTrue: [self inform: aPathName, ': ', fStat. ^ nil].	protectionMask := fStat at: 3.	((protectionMask at: 4) allMask: 1)		ifTrue: [^ true]. "Test executable by any user ID"	sgid := (protectionMask at: 1) allMask: 2.	sgid		ifTrue: [group := gid]		ifFalse: [group := fStat at: 2].	((gid == group) and: [(protectionMask at: 3) allMask: 1])		ifTrue: [^ true]. "Test executable by my group ID"	suid := (protectionMask at: 1) allMask: 4.	suid		ifTrue: [user := uid]		ifFalse: [user := fStat at: 1].	((uid == user) and: [(protectionMask at: 2) allMask: 1])		ifTrue: [^ true]. "Test executable by my user ID"	^ false! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/14/2004 15:10'!isLockableFile: aFileStream	"Check for ability to place an exclusive lock on the entire file represented by	aFileStream. An exclusive lock (write lock) permits only one OS process to hold	the lock. Answer true if the region is lockable."	^ self isLockableFile: aFileStream exclusive: true! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'jf 2/22/2004 17:30'!isLockableFile: aFileStream exclusive: flag	"Check for ability to place an exclusive lock on the entire file represented by	aFileStream. An exclusive lock (write lock) permits only one OS process to hold	the lock. Answer true if the region is lockable."	| fileLock |	aFileStream ifNil: [^ false].	fileLock := OSFileLock onFile: aFileStream exclusive: flag.	^ self isLockableFileRegion: fileLock! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/14/2004 15:09'!isLockableFile: aFileStream from: start to: end	"Pass a struct SQFile on the stack, and check for ability to lock the specified region.	If the exclusive flag is true, then specify an exclusive (F:=WRLCK) lock on the     file. Otherwise, specify a shared (F:=RDLCK) lock. Any number of Unix processes     may hold  a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock).	If length is zero, then the request is for the entire file to be locked, including	region extents that have not yet been allocated for the file.	Answer true if the region is lockable."	^ self isLockableFile: aFileStream from: start to: end exclusive: true! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/22/2004 15:10'!isLockableFile: aFileStream from: start to: end exclusive: flag	"Pass a struct SQFile on the stack, and check for ability to lock the specified region.	If the exclusive flag is true, then specify an exclusive (F:=WRLCK) lock on the     file. Otherwise, specify a shared (F:=RDLCK) lock. Any number of Unix processes     may hold  a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock).	If length is zero, then the request is for the entire file to be locked, including	region extents that have not yet been allocated for the file.	Answer true if the region is lockable."	| fileRegion |	aFileStream ifNil: [^ false].	fileRegion := OSFileRegionLock onFile: aFileStream from: start to: end exclusive: flag.	^ self isLockableFileRegion: fileRegion! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'jf 2/22/2004 18:42'!isLockableFileRegion: aFileLock	"Pass a struct SQFile on the stack, and check for ability to lock the specified region.	If the exclusive flag is true, then specify an exclusive (F:=WRLCK) lock on the     file. Otherwise, specify a shared (F:=RDLCK) lock. Any number of Unix processes     may hold  a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock).	If length is zero, then the request is for the entire file to be locked, including	region extents that have not yet been allocated for the file.	Answer true if the region is lockable."	aFileLock ifNil: [^ false].	(self canAcquireLock: aFileLock) ifFalse: [^ false].		^ aFileLock test! !!UnixOSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 5/1/2001 23:09'!isReadable: aPathName	"Answer true if file at aPathName has read permission for this process."	"OSProcess accessor isWritable: '/bin/sh'"	^ self isReadable: aPathName forUser: self primGetUid inGroup: self primGetGid! !!UnixOSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 5/1/2001 23:00'!isReadable: aPathName forUser: uid inGroup: gid	"Answer true if file at aPathName has read permission for a user	identified by user uid and group gid."	"OSProcess accessor		isReadable: '/bin/sh'		forUser: OSProcess accessor primGetUid		inGroup: OSProcess accessor primGetGid"	| fStat user group protectionMask |	fStat := self fileStat: aPathName.	(fStat isKindOf: String)		ifTrue: [self inform: aPathName, ': ', fStat. ^ nil].	protectionMask := fStat at: 3.	((protectionMask at: 4) allMask: 4)		ifTrue: [^ true]. "Test readable by any user ID"	group := fStat at: 2.	((gid == group) and: [(protectionMask at: 3) allMask: 4])		ifTrue: [^ true]. "Test readable by my group ID"	user := fStat at: 1.	((uid == user) and: [(protectionMask at: 2) allMask: 4])		ifTrue: [^ true]. "Test readable by my user ID"	^ false! !!UnixOSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 5/1/2001 23:09'!isWritable: aPathName	"Answer true if file at aPathName has write permission for this process."	"OSProcess accessor isWritable: '/bin/sh'"	^ self isWritable: aPathName forUser: self primGetUid inGroup: self primGetGid! !!UnixOSProcessAccessor methodsFor: 'file testing' stamp: 'dtl 5/1/2001 23:08'!isWritable: aPathName forUser: uid inGroup: gid	"Answer true if file at aPathName has read permission for a user	identified by user uid and group gid."	"OSProcess accessor		isWritable: '/bin/sh'		forUser: OSProcess accessor primGetUid		inGroup: OSProcess accessor primGetGid"	| fStat user group protectionMask |	fStat := self fileStat: aPathName.	(fStat isKindOf: String)		ifTrue: [self inform: aPathName, ': ', fStat. ^ nil].	protectionMask := fStat at: 3.	((protectionMask at: 4) allMask: 2)		ifTrue: [^ true]. "Test writable by any user ID"	group := fStat at: 2.	((gid == group) and: [(protectionMask at: 3) allMask: 2])		ifTrue: [^ true]. "Test writable by my group ID"	user := fStat at: 1.	((uid == user) and: [(protectionMask at: 2) allMask: 2])		ifTrue: [^ true]. "Test writable by my user ID"	^ false! !!UnixOSProcessAccessor methodsFor: 'VM atexit' stamp: 'dtl 3/17/2007 18:39'!kill: listOfPids withSignal: signumOrNil	"On exit of the VM process, send signal to the external processes	identified by listOfPids. If signumOrNil is nil, the default SIGTERM	signal will be sent to listOfPids."	^ self primKill: listOfPids withSignal: signumOrNil! !!UnixOSProcessAccessor methodsFor: 'VM atexit' stamp: 'dtl 3/18/2007 10:39'!killOnVmExit: proxies withSignal: signumOrNil	"When Squeak uses OSProcess to start a long running external process, it	may be useful to guarantee that one or more child processes is killed when	the Squeak VM exits, regardless of whether the normal Squeak shutdown	processing has occurred. This method arranges for a collection of external	process proxies to receive a signal when the Squeak VM exits. If signumOrNil	is nil, the default SIGTERM will be used. Each invocation of this method will	override the effects of previous calls."	"OSProcess accessor killOnVmExit: OSProcess thisOSProcess allMyChildren withSignal: nil"	| pids |	pids := (proxies select: [:p | p isRunning] thenCollect: [:e | e pid]) asArray.	^ self kill: pids withSignal: signumOrNil! !!UnixOSProcessAccessor methodsFor: 'debugging' stamp: 'dtl 11/19/2006 09:05'!listSigHandlerAddressesOnConsole	"OSProcess accessor listSigHandlerAddressesOnConsole"	(0 to: 67) do: [:sigNum | | prev |		[prev := OSProcess accessor currentSigHandlerAddress: sigNum.		OSProcess debugMessage: 'signal ', sigNum asString,' hander is ', prev printString]			on: Error			do: [:ex | OSProcess debugMessage: ex printString]]! !!UnixOSProcessAccessor methodsFor: 'debugging' stamp: 'dtl 11/19/2006 09:07'!listSigHandlerAddressesOnTranscript	"OSProcess accessor listSigHandlerAddressesOnTranscript"	Transcript cr.	(0 to: 67) do: [:sigNum | | prev |		[prev := OSProcess accessor currentSigHandlerAddress: sigNum.		Transcript show: 'signal ', sigNum asString,' hander is ', prev printString; cr]			on: Error			do: [:ex | Transcript show: ex printString; cr]]! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/14/2004 15:01'!lockFile: aFileStream	"Request an exclusive lock on the entire file represented by aFileStream. The	exclusive lock (write lock) permits only one OS process to hold the lock. Answer	a descriptor for the locked file region, an Array of file handle and region interval;	or answer nil on error.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self lockFile: aFileStream exclusive: true! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/11/2006 23:40'!lockFile: aFileStream exclusive: flag	"Request an exclusive lock on the entire file represented by aFileStream. The	exclusive lock (write lock) permits only one OS process to hold the lock. Answer	a descriptor for the locked file region, an Array of file handle and region interval;	or answer nil on error.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self lockFile: aFileStream exclusive: flag ifFail: nil! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/11/2006 23:39'!lockFile: aFileStream exclusive: flag ifFail: failBlock	"Request an exclusive lock on the entire file represented by aFileStream. The	exclusive lock (write lock) permits only one OS process to hold the lock. Answer	a descriptor for the locked file region, an Array of file handle and region interval;	or answer nil on error.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	| fileLock |	aFileStream ifNil: [^ failBlock value].	fileLock := OSFileLock onFile: aFileStream exclusive: flag.	^ self lockFileRegion: fileLock ifFail: failBlock! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/14/2004 15:01'!lockFile: aFileStream from: start to: end	"Pass a struct SQFile on the stack, and request a lock on the specified region.	If the exclusive flag is true, then request an exclusive (F:=WRLCK) lock on the     file. Otherwise, request a shared (F:=RDLCK) lock. Any number of Unix processes     may hold a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock). Answer a descriptor for the locked file region,	an Array of file handle and region interval; or answer nil on error.	If length is zero, then the request is for the entire file to be locked, including	region extents that have not yet been allocated for the file.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self lockFile: aFileStream from: start to: end exclusive: true! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/22/2004 15:10'!lockFile: aFileStream from: start to: end exclusive: flag	"Pass a struct SQFile on the stack, and request a lock on the specified region.	If the exclusive flag is true, then request an exclusive (F:=WRLCK) lock on the     file. Otherwise, request a shared (F:=RDLCK) lock. Any number of Unix processes     may hold a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock). Answer a descriptor for the locked file region,	an Array of file handle and region interval; or answer nil on error.	If length is zero, then the request is for the entire file to be locked, including	region extents that have not yet been allocated for the file.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	| fileRegion |	aFileStream ifNil: [^ nil].	fileRegion := OSFileRegionLock onFile: aFileStream from: start to: end exclusive: flag.	^ self lockFileRegion: fileRegion! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 8/30/2009 14:51'!lockFile: fileStream from: start to: end exclusive: writeLockFlag ifFail: failBlock	| lock |	lock := OSFileRegionLock onFile: fileStream from: start to: end exclusive: writeLockFlag.	^ self lockFileRegion: lock ifFail: [failBlock value]! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 11/28/2010 19:07'!lockFile: fileStream from: start to: end ifFail: failBlock	^ self lockFile: fileStream from: start to: end exclusive: true ifFail: failBlock! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/11/2006 23:41'!lockFile: aFileStream ifFail: failBlock	"Request an exclusive lock on the entire file represented by aFileStream. The	exclusive lock (write lock) permits only one OS process to hold the lock. Answer	a descriptor for the locked file region, an Array of file handle and region interval;	or answer nil on error.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self lockFile: aFileStream exclusive: true ifFail: failBlock! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/8/2006 07:04'!lockFileRegion: aFileLock	"Pass a struct SQFile on the stack, and request a lock on the specified region.	If the exclusive flag is true, then request an exclusive (F:=WRLCK) lock on the     file. Otherwise, request a shared (F:=RDLCK) lock. Any number of Unix processes     may hold a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock). Answer a descriptor for the locked file region,	an Array of file handle and region interval; or answer nil on error.	If length is zero, then the request is for the entire file to be locked, including	region extents that have not yet been allocated for the file.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self lockFileRegion: aFileLock ifFail: [nil]! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/8/2006 07:03'!lockFileRegion: aFileLock ifFail: failBlock	"Pass a struct SQFile on the stack, and request a lock on the specified region.	If the exclusive flag is true, then request an exclusive (F:=WRLCK) lock on the     file. Otherwise, request a shared (F:=RDLCK) lock. Any number of Unix processes     may hold a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock). Answer a descriptor for the locked file region,	an Array of file handle and region interval; or answer nil on error.	If length is zero, then the request is for the entire file to be locked, including	region extents that have not yet been allocated for the file.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	aFileLock ifNil: [^ failBlock value].	"Check region lock overlap for Win32 compatibility"	(self canAcquireLock: aFileLock) ifFalse: [^ failBlock value].		aFileLock lock		ifFalse: [^ failBlock value]		ifTrue:			[self register: aFileLock.			^ aFileLock]! !!UnixOSProcessAccessor methodsFor: 'pipe open' stamp: 'dtl 1/31/2004 19:08'!makePipeHandles	"Create a pipe, and answer an array of two IO accessors for the pipe 	reader and writer. Set a signal handler to cause SIGPIPE signals to be	ignored. This will register a Semaphore to receive the SIGPIPE events,	but we will simply ignore the semaphore, effectively ignoring the	external OS signals. This is done instead of explicitly telling the OS to	ignore the signals because it allows the use of a uniform signal	forwarding mechanism in Squeak, even for signals that are ultimately	ignored."	self forwardSigPipe.	^ super makePipeHandles! !!UnixOSProcessAccessor methodsFor: 'temp files and directories' stamp: 'dtl 6/3/2013 22:05'!mkdtemp: templateString	"Call mkdtemp() to generate a uniquely named temporary directory from a template	string. The last six or more characters of template must be XXXXXX and these are	replaced with characters that make the directory name unique. The directory is then	created with permissions 0700. Answer the new directory name."	"OSProcess accessor mkdtemp: 'foodir.XXXXXX' "	^self primMkdtemp: templateString! !!UnixOSProcessAccessor methodsFor: 'temp files and directories' stamp: 'dtl 6/3/2013 22:36'!mkstemp: templateString	"Call mkstemp() to generate a unique temporary file from a template string.	The last six or more characters of template must be XXXXXX and these are	replaced with a string that make the filename unique. Contents of the template	string are modified. The file is created with permissions 0600, that is, read plus	write for owner only. Answer an opened file stream on the newly created file."	"OSProcess accessor mkstemp: 'foo.XXXXXX' "	" | s | { s := 'foo.XXXXXX' . OSProcess accessor mkstemp: s } "	| fileName sqFile |	fileName := templateString copy.	sqFile := self primMkstemp: fileName.	^ AttachableFileStream		name: fileName		attachTo: sqFile		writable: true! !!UnixOSProcessAccessor methodsFor: 'temp files and directories' stamp: 'dtl 6/3/2013 21:59'!mktemp: templateString	"Call mktemp() to generate a unique temporary filename from a template string.	The last six or more characters of template must be XXXXXX and these are replaced	with a string that make the filename unique. The templateString must be a mutable	string, because the primitive will change its contents.		Use primitiveMkstemp to avoid file creation race condition, see man 3 mktemp."	"OSProcess accessor mktemp: 'foo.XXXXXX' "	"OSProcess accessor mktemp: '/tmp/foo.XXXXXX' "	^ self primMktemp: templateString! !!UnixOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 10/8/2005 09:55'!nice: inc	"Change the scheduling priority of this OS process by the given nice increment.	A positive increment decreases the priority. Only the superuser can specify	a negative value to increase the priority. A typical use is to increase the	nice value by 1 in order to make the Squeak VM run at lower priority. This	may be useful for a background Squeak doing an image save or other non-	interactive process."	"OSProcess accessor nice: 1"	^ self primNice: inc! !!UnixOSProcessAccessor methodsFor: 'display handling - old plugin compatibility' stamp: 'dtl 8/3/2003 20:34'!oldPrimCanConnectToXDisplay: xDisplayName	"Deprecated - install the XDisplayControlPlugin to eliminate the need to call this method"	"Open and close a connection to displayName. It the connection was successfully	opened, answer true; otherwise false. This is intended to check for the ability	to open an X display prior to actually making the attempt."	"OSProcess accessor primCanConnectToXDisplay: ':0.0' "	"OSProcess accessor primCanConnectToXDisplay: ':1' "	<primitive: 'primitiveCanConnectToXDisplay' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling - old plugin compatibility' stamp: 'dtl 8/3/2003 20:34'!oldPrimGetXDisplayName	"Deprecated - install the XDisplayControlPlugin to eliminate the need to call this method"	"Answer a string containing the name for the X display, or nil if the display was opened	using the $DISPLAY environment variable. This answers the name of the X display as of	the time it was last opened, which may be different from the current setting of $DISPLAY."	"OSProcess accessor primGetXDisplayName"	<primitive: 'primitiveGetXDisplayName' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling - old plugin compatibility' stamp: 'dtl 8/3/2003 20:35'!oldPrimIsConnectedToXServer	"Deprecated - install the XDisplayControlPlugin to eliminate the need to call this method"	"Answer true if VM is currently connected to an X server."	"OSProcess accessor primIsConnectedToXServer inspect"	"| x |	OSProcess accessor primKillDisplay.	x := OSProcess accessor primIsConnectedToXServer.	OSProcess accessor primOpenXDisplay.	x inspect"	<primitive: 'primitiveIsConnectedToXServer' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling - old plugin compatibility' stamp: 'dtl 8/3/2003 20:35'!oldPrimKillDisplay	"Deprecated - install the XDisplayControlPlugin to eliminate the need to call this method"	"Call an internal function which will disconnect the X display session."	"OSProcess thisOSProcess processAccessor primKillDisplay"	<primitive: 'primitiveKillDisplay' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling - old plugin compatibility' stamp: 'dtl 8/3/2003 20:35'!oldPrimOpenXDisplay	"Deprecated - install the XDisplayControlPlugin to eliminate the need to call this method"	"Call an internal function which will open the X display session."	"OSProcess thisOSProcess processAccessor primKillDisplay.	(Delay forSeconds: 5) wait.	OSProcess thisOSProcess processAccessor primOpenXDisplay"	<primitive: 'primitiveOpenXDisplay' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling - old plugin compatibility' stamp: 'dtl 8/3/2003 20:35'!oldPrimSetXDisplayName: aStringOrNil	"Deprecated - install the XDisplayControlPlugin to eliminate the need to call this method"	"Set the name for the X display for use in the next call to primitiveOpenXDisplay.	aStringOrNil must be either a String (such as 'myhost:0') or nil, indicating that	the current value of $DISPLAY should be used."	"OSProcess accessor primSetXDisplayName: ':0.0' "	"OSProcess accessor primSetXDisplayName: nil "	<primitive: 'primitiveSetXDisplayName' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 11:48'!osppModuleName	"Answer a string containing the module name string for the OSPP plugin."	"OSProcess accessor osppModuleName"	^ self primOSProcessPluginModuleName! !!UnixOSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 11:49'!osppModuleVersionString	"Answer a string containing the version string for the OSPP plugin."	"OSProcess accessor osppModuleVersionString"	^ self primOSProcessPluginModuleVersionString! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/1/2005 10:37'!primAioPluginModuleName	"Answer a string containing the module name string for the AIO plugin."	"OSProcess accessor primAioPluginModuleName"	<primitive: 'primitiveModuleName' module: 'AioPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/1/2005 10:38'!primAioPluginVersionString	"Answer a string containing the version string for the AIO plugin."	"OSProcess accessor primAioPluginVersionString"	<primitive: 'primitiveVersionString' module: 'AioPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 7/22/2000 17:19'!primArgumentAt: index	"Answer the argument string in the argument OS process argument list at position index.	In Unix, the first element of the list is the program name, and any additional elements	of the list are optional command line arguments passed to the program. This convention	may be simulated by the C runtime libraries on other operating systems, but argument	list handling should be assumed to be operating system dependent."	<primitive: 'primitiveArgumentAt' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling' stamp: 'dtl 8/3/2003 18:26'!primCanConnectToXDisplay: xDisplayName	"Open and close a connection to displayName. It the connection was successfully	opened, answer true; otherwise false. This is intended to check for the ability	to open an X display prior to actually making the attempt."	"OSProcess accessor primCanConnectToXDisplay: ':0.0' "	"OSProcess accessor primCanConnectToXDisplay: ':1' "	<primitive: 'primitiveCanConnectToDisplay' module: 'XDisplayControlPlugin'>	^ self oldPrimCanConnectToXDisplay: xDisplayName! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 2/24/2001 14:28'!primCanReceiveSignals: anIntegerPid	"Answer true if an external OS process can receive signals. In most	cases, if the process identified by anIntegerPid cannot receive signals, it is	because the process does not exist and anIntegerPid is a stale reference (possibly	left over from a previous Squeak session). Answer nil if the primitive does	not exist (possibly because the VM is using an older version of the plugin)."	<primitive: 'primitiveCanReceiveSignals' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 3/31/2001 11:18'!primChdir: pathString	"Change current working directory. Does not update the $PWD environment variable."	<primitive: 'primitiveChdir' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 11/28/2010 12:31'!primCreatePipe	"Create a pipe, and answer an array of two file handles (SQFile data structures in interp.c)	for the pipe reader and writer."	<primitive: 'primitiveCreatePipe' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 11/28/2010 12:32'!primCreatePipeWithSessionIdentifier: aByteArray	"Create a pipe, and answer an array of two file handles (SQFile data structures in interp.c)	for the pipe reader and writer."	<primitive: 'primitiveCreatePipeWithSessionIdentifier' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling' stamp: 'dtl 8/6/2003 06:24'!primDisconnectDisplay	"Disconnect the X display session. The actual Squeak window on the X server is not	effected, but this instance of Squeak will not have any further interaction with it."	"OSProcess thisOSProcess processAccessor primDisconnectDisplay"	<primitive: 'primitiveDisconnectDisplay' module: 'XDisplayControlPlugin'>	^ self oldPrimKillDisplay! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 9/10/2011 23:28'!primDup: fileDescriptor	"Call dup2 to duplicate a file descriptor to the next available descriptor. Answer	the new file descriptor or -1 on failure."	<primitive: 'primitiveDup' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 5/17/2009 21:57'!primDup: oldFileDescriptor to: newFileDescriptor	"Call dup2() to duplicate a file descriptor. Answer the duplicated file descriptor	or -1 on failure."	<primitive: 'primitiveDupTo' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 7/22/2000 17:20'!primEnvironmentAt: index	"Answer the environment string at index position in the OS process environment list.	This returns a 'KEY=value' string, which the caller is expected to parse into #KEY	and 'value' to be stored an environment dictionary."	<primitive: 'primitiveEnvironmentAt' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:28'!primEnvironmentAtSymbol: aSymbol	"Answer the value of an environment variable in the external OS process."	<primitive: 'primitiveEnvironmentAtSymbol' module: 'UnixOSProcessPlugin'>	^ nil ! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/31/2001 11:03'!primErrorMessageAt: anInteger	"Answer an error message string from the sys:=errlist array, indexed by anInteger."	"OSProcess accessor primErrorMessageAt: 0"	"OSProcess accessor primErrorMessageAt: 100"	"OSProcess accessor primErrorMessageAt: 1000"	"OSProcess accessor primErrorMessageAt: -1"	<primitive: 'primitiveErrorMessageAt' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 4/30/2001 05:49'!primFileProtectionMask: aPathString	"Call stat(2) to obtain the file protection mask for a file. Answer an Array of	four integers representing the protection mask, or answer errno on failure. The	protection mask is four Integers, each of which may be considered an octal digit	(0-7), with bit values 4, 2, and 1. The first digit selects the set user ID (4) and set	group ID (2) and save text image (1) attributes. The second digit selects permissions	for the user who owns the file: read (4), write (2), and execute (1); the third	selects permissions for other users in the file's group, with the same values; and	the fourth for other users not in the file's group, with the same values."	<primitive: 'primitiveFileProtectionMask' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 4/30/2001 20:56'!primFileStat: aPathString	"Call stat(2) to obtain the file protection mask for a file. Answer errno on failure,	or on success answer an array with: UID with: GID with: protectionMask. The		protectionMask is an Array of four integers representing the protection mask, or	answer errno on failure. The protection mask is four Integers, each of which may	be considered an octal digit (0-7), with bit values 4, 2, and 1. The first digit selects	the set user ID (4) and set group ID (2) and save text image (1) attributes. The second	digit selects permissions for the user who owns the file: read (4), write (2), and	execute (1); the third selects permissions for other users in the file's group, with	the same values; and the fourth for other users not in the file's group, with the	same values."	<primitive: 'primitiveFileStat' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling' stamp: 'dtl 8/24/2003 10:13'!primFlushXDisplay	"Call an internal function to synchronize output to the X display."	"OSProcess thisOSProcess processAccessor primFlushXDisplay"	<primitive: 'primitiveFlushDisplay' module: 'XDisplayControlPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 11/28/2010 12:35'!primForkExec: executableFile	stdIn: inputFileHandle	stdOut: outputFileHandle	stdErr: errorFileHandle	argBuf: argVec	argOffsets: argOffsets	envBuf: envVec	envOffsets: envOffsets	workingDir: pathString	"Parameters are expected to have been properly prepared by the caller, including string	values which are to be null terminated strings. In other words, all strings should have	(Character value: 0) as the last element in the string.	Parameters should be:		executableFile: a string with the name of a file to execute.		stdIn: a fileID ByteArray (struct SQFile in C) to be used as standard input.		stdOut: a fileID ByteArray to be used as standard output.		stdErr: a fileID ByteArray to be used as standard error.		argVec: a String arranged to look more or less like a char **, but with the addresses not yet fixed.		argOffsets: an Array of offsets for fixing up the argVec addresses.		envVec: a String arranged to look more or less like a char **, but with the addresses not yet fixed.		envOffsets: an Array of offsets for fixing up the envVec addresses.		workingDir: a null terminated path name String, or nil.	The envVec parameter may be nil, in which case envOffsets is ignored. workingDir may be nil. The	other parameters are required. Parameters with nil value indicate that current values for this process	should be used."	<primitive: 'primitiveForkExec' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 11/28/2010 12:37'!primForkSqueak	"Clone this Squeak Smalltalk image in a child OSProcess. The child is the same as the	parent, except for its new X session connection, and the return value of this method,	which is zero for the child process, and a positive integer equal to the pid of the child	for the parent process.	The child should not depend on using existing connections to external resources. For	example, the child may lose its connections to stdin, stdout, and stderr after its parent	exits."	<primitive: 'primitiveForkSqueakWithoutSigHandler' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 8/3/2002 20:29'!primForwardSignal: signalNumber toSemaphore: semaphoreIndex	"Set a signal handler in the VM which will signal a Smalltalk semaphore at	semaphoreIndex whenever an external signal sigNum is received. Answer the	prior value of the signal handler. If semaphoreIndex is zero, the handler is	unregistered, and the VM returns to its default behavior for handling that	signal.	The Smalltalk semaphore is expected to be kept at the same index location	indefinitely during the lifetime of a Squeak session. If that is not the case, the	handler must be unregistered prior to unregistering the Smalltalk semaphore."	<primitive: 'primitiveForwardSignalToSemaphore' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 10/14/2001 11:15'!primGetChildExitStatus: childPid	"Clean up after the death of a child process, and answer the exit status of the child process."	<primitive: 'primitiveReapChildProcess' module: 'UnixOSProcessPlugin'>	^ Array with: childPid with: nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 7/22/2000 17:20'!primGetCurrentWorkingDirectory	"Call getcwd() to get the current working directory."	"OSProcess thisOSProcess processAccessor primGetCurrentWorkingDirectory"	<primitive: 'primitiveGetCurrentWorkingDirectory' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 4/30/2001 21:07'!primGetEGid	"Answer the effective group ID for the OS process in which I am currently executing."	"OSProcess accessor primGetEGid"	<primitive: 'primitiveGetEGid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 4/30/2001 21:01'!primGetEUid	"Answer the effective user ID for the OS process in which I am currently executing."	"OSProcess accessor primGetEUid"	<primitive: 'primitiveGetEUid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 4/30/2001 21:01'!primGetGid	"Answer the group ID for the OS process in which I am currently executing."	"OSProcess accessor primGetGid"	<primitive: 'primitiveGetGid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/15/2007 19:43'!primGetPGid: pid	"Answer the process group ID of the process identified by pid"	<primitive: 'primitiveGetPGid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/15/2007 19:39'!primGetPGrp	"Answer the process group ID of this OS process"	<primitive: 'primitiveGetPGrp' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 7/22/2000 17:20'!primGetPPid	"Answer the OS process ID for the parent process of the OS process in which I am	currently executing."	<primitive: 'primitiveGetPPid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 7/22/2000 17:20'!primGetPid	"Answer the OS process ID for the OS process in which I am currently executing."	<primitive: 'primitiveGetPid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/2/2002 08:15'!primGetSession	"Answer the unique identifier for this session of Smalltalk running in this OS Process."	"OSProcess accessor primGetSession"	<primitive: 'primitiveGetSession' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:28'!primGetStdErrHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard error for the	OS process in which I am currently executing."	<primitive: 'primitiveGetStdErrHandle' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:28'!primGetStdInHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard input for	the OS process in which I am currently executing."	<primitive: 'primitiveGetStdInHandle' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:28'!primGetStdOutHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard output for the	OS process in which I am currently executing."	<primitive: 'primitiveGetStdOutHandle' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'pthreads' stamp: 'dtl 3/5/2006 10:51'!primGetThreadID	"Answer the ID of the pthread that is currently executing (the interpreter thread).	A thread ID may be a 64 bit value on some platforms, so answer a byte array	containing the value in machine-dependent byte order."	"OSProcess accessor primGetThreadID"	<primitive: 'primitiveGetThreadID' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 4/30/2001 21:00'!primGetUid	"Answer the user ID for the OS process in which I am currently executing."	"OSProcess accessor primGetUid"	<primitive: 'primitiveGetUid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling' stamp: 'dtl 8/3/2003 18:27'!primGetXDisplayName	"Answer a string containing the name for the X display, or nil if the display was opened	using the $DISPLAY environment variable. This answers the name of the X display as of	the time it was last opened, which may be different from the current setting of $DISPLAY."	"OSProcess accessor primGetXDisplayName"	<primitive: 'primitiveGetDisplayName' module: 'XDisplayControlPlugin'>	^ self oldPrimGetXDisplayName! !!UnixOSProcessAccessor methodsFor: 'display handling' stamp: 'dtl 8/3/2003 18:29'!primIsConnectedToXServer	"Answer true if VM is currently connected to an X server."	"OSProcess accessor primIsConnectedToXServer inspect"	"| x |	OSProcess accessor primKillDisplay.	x := OSProcess accessor primIsConnectedToXServer.	OSProcess accessor primOpenXDisplay.	x inspect"	<primitive: 'primitiveIsConnectedToDisplay' module: 'XDisplayControlPlugin'>	^ self oldPrimIsConnectedToXServer! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 3/18/2007 10:35'!primKill: listOfPids withSignal: signumOrNil	"Set a list of pids to kill with signum when VM exits. If the signum	parameter is nil, the default value of SIGTERM will be used."	<primitive: 'primitiveKillOnExit' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'display handling' stamp: 'dtl 8/6/2003 06:22'!primKillDisplay	"Disconnect the X display session and destroy the Squeak window on the X display."	"OSProcess thisOSProcess processAccessor primKillDisplay"	<primitive: 'primitiveKillDisplay' module: 'XDisplayControlPlugin'>	^ self oldPrimKillDisplay! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 1/3/2004 19:59'!primLockFileRegion: aSQFileStruct offset: begin length: len exclusive: flag	"Pass a struct SQFile on the stack, and request a lock on the specified region.	If the exclusive flag is true, then request an exclusive (F:=WRLCK) lock on the     file. Otherwise, request a shared (F:=RDLCK) lock. Any number of Unix processes     may  hold  a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock). Answer the result of the call to fcntl()."	<primitive: 'primitiveLockFileRegion' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 6/1/2013 17:14'!primMkdtemp: templateString	"Call mkdtemp() to generate a uniquely named temporary directory from a template	string. The last six characters of template must be XXXXXX and these are replaced	with characters that make the directory name unique. The directory is then created	with permissions 0700. Answer the new directory name."	<primitive: 'primitiveMkdtemp' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 6/3/2013 22:33'!primMkstemp: templateString	"Call mkstemp() to generate a unique temporary file from a template string.	The last six characters of template must be XXXXXX and these are replaced with	a string that make the filename unique. Answer a SQFile descriptor for the file stream.		Contents of the template string are modified, and provide the name of the newly	created file.	The  file  is  created  with permissions 0600, that is, read plus write for owner only.	Sender must convert the file descriptor to a FileStream before it can be used."	<primitive: 'primitiveMkstemp' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 6/1/2013 17:14'!primMktemp: templateString	"Call mktemp() to generate a unique temporary filename from a template string.	The last six characters of template must be XXXXXX and these are replaced with	a string that make the filename unique. The templateString must be a mutable	string, because the primitive will change its contents.		Use primitiveMkstemp to avoid file creation race condition, see man 3 mktemp."	<primitive: 'primitiveMktemp' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 10/8/2005 09:55'!primNice: inc	"Change the scheduling priority of this OS process by the given nice increment."	<primitive: 'primitiveNice' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/1/2005 11:48'!primOSProcessPluginModuleName	"Answer a string containing the module name string for the OSPP plugin."	"OSProcess accessor primOSProcessPluginModuleName"	<primitive: 'primitiveModuleName' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/1/2005 11:48'!primOSProcessPluginModuleVersionString	"Answer a string containing the version string for the OSPP plugin."	"OSProcess accessor primOSProcessPluginModuleVersionString"	<primitive: 'primitiveVersionString' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling' stamp: 'dtl 8/3/2003 18:31'!primOpenXDisplay	"Call an internal function which will open the X display session."	"OSProcess thisOSProcess processAccessor primKillDisplay.	(Delay forSeconds: 5) wait.	OSProcess thisOSProcess processAccessor primOpenXDisplay"	<primitive: 'primitiveOpenDisplay' module: 'XDisplayControlPlugin'>	^ self oldPrimOpenXDisplay! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 7/19/2010 23:38'!primPrintAllStacksOnSignal: signalNumber	"Set a signal handler in the VM which will print all call stacks on the console	output whenever an external signal sigNum is received. Answer the	prior value of the signal handler."	"OSProcess accessor primPrintAllStacksOnSignal: OSProcess accessor primSigUsr1Number"	"OSProcess accessor primForwardSignal: OSProcess accessor primSigUsr1Number toSemaphore: nil"	<primitive: 'primitivePrintAllStacksOnSignal' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:28'!primPutEnv: aString	"Add or update an environment variable in the external OS process using a 'KEY=value'	string."	<primitive: 'primitivePutEnv' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 3/31/2001 15:44'!primRealpath: pathString	"Resolve pathString into a real path if possible, or answer nil."	<primitive: 'primitiveRealpath' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:28'!primSQFileFlush: aSQFileStruct	"Pass a struct SQFile on the stack, flush the external file stream."	<primitive: 'primitiveSQFileFlush' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:29'!primSQFileSetBlocking: aSQFileStruct	"Pass a struct SQFile on the stack, and call fcntl() to set the file non-blocking."	<primitive: 'primitiveSQFileSetBlocking' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:29'!primSQFileSetNonBlocking: aSQFileStruct	"Pass a struct SQFile on the stack, and call fcntl() to set the file non-blocking."	<primitive: 'primitiveSQFileSetNonBlocking' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 7/22/2000 17:29'!primSQFileSetUnbuffered: aSQFileStruct	"Pass a struct SQFile on the stack, set the file non-blocking."	<primitive: 'primitiveSQFileSetUnbuffered' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 8/4/2002 01:13'!primSemaIndexFor: sigNum	"Answer the registration index of the semaphore currently associated with the	signal handler for sigNum."	<primitive: 'primitiveSemaIndexFor' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:24'!primSendSigabrtTo: anIntegerPid	"Send SIGABRT (abort) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigabrtTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:24'!primSendSigalrmTo: anIntegerPid	"Send SIGALRM (alarm) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigalrmTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:24'!primSendSigchldTo: anIntegerPid	"Send SIGCHLD (child status has changed, usually death of child) to the OS process	identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigchldTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:25'!primSendSigcontTo: anIntegerPid	"Send SIGCONT (continue) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigcontTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:25'!primSendSighupTo: anIntegerPid	"Send SIGHUP (hangup) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSighupTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:25'!primSendSigintTo: anIntegerPid	"Send SIGINT (interrupt) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigintTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:25'!primSendSigkillTo: anIntegerPid	"Send SIGKILL (kill, unblockable) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigkillTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:25'!primSendSigpipeTo: anIntegerPid	"Send SIGPIPE (broken pipe) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigpipeTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:25'!primSendSigquitTo: anIntegerPid	"Send SIGQUIT (quit) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigquitTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:25'!primSendSigstopTo: anIntegerPid	"Send SIGSTOP (stop, unblockable) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigstopTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:26'!primSendSigtermTo: anIntegerPid	"Send SIGTERM (termination) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigtermTo' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:26'!primSendSigusr1To: anIntegerPid	"Send SIGUSR1 (User-defined signal 1) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigusr1To' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'OS signal sending' stamp: 'dtl 7/22/2000 17:26'!primSendSigusr2To: anIntegerPid	"Send SIGUSR2 (User-defined signal 2) to the OS process identified by anIntegerPid.	Answer 0 on success, -1 on failure, and nil if the pluggable primitive is not present."	<primitive: 'primitiveSendSigusr2To' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/15/2007 19:47'!primSet: pid pGid: processGroupId	"Set the process group ID of the process identified by pid to a new process	group ID."	<primitive: 'primitiveSetPGid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/15/2007 19:40'!primSetPGrp	"Set a new process group for this OS process. Newly created child processes	will be members of the new process group."	<primitive: 'primitiveSetPGrp' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/18/2007 10:50'!primSetSid	"Quoted from Linux man pages:	setsid() creates a new session if the calling process is not a process group leader.	The calling process is the leader of the new session, the process  group  leader  of	the new process group, and has no controlling tty.  The process group ID and session	ID of the calling process are set to the PID of the calling  process.   The  calling	process  will be the only process in this new process group and in this new session."	<primitive: 'primitiveSetSid' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'display handling' stamp: 'dtl 8/3/2003 18:32'!primSetXDisplayName: aStringOrNil	"Set the name for the X display for use in the next call to primitiveOpenXDisplay.	aStringOrNil must be either a String (such as 'myhost:0') or nil, indicating that	the current value of $DISPLAY should be used."	"OSProcess accessor primSetXDisplayName: ':0.0' "	"OSProcess accessor primSetXDisplayName: nil "	<primitive: 'primitiveSetDisplayName' module: 'XDisplayControlPlugin'>	^ self oldPrimSetXDisplayName: aStringOrNil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 8/3/2002 20:36'!primSigChldNumber	"Integer value corresponding to SIGCHLD"	<primitive: 'primitiveSigChldNumber' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 12/6/2002 18:04'!primSigHupNumber	"Integer value corresponding to SIGHUP"	<primitive: 'primitiveSigHupNumber' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 8/4/2002 00:19'!primSigIntNumber	"Integer value corresponding to SIGINT"	"OSProcess accessor primSigIntNumber"	<primitive: 'primitiveSigIntNumber' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 12/6/2002 18:05'!primSigKillNumber	"Integer value corresponding to SIGKILL"	"OSProcess accessor primSigKillNumber"	<primitive: 'primitiveSigKillNumber' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 8/3/2002 20:35'!primSigPipeNumber	"Integer value corresponding to SIGPIPE"	<primitive: 'primitiveSigPipeNumber' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 12/6/2002 18:06'!primSigQuitNumber	"Integer value corresponding to SIGQUIT"	<primitive: 'primitiveSigQuitNumber' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 12/6/2002 18:06'!primSigTermNumber	"Integer value corresponding to SIGTERM"	<primitive: 'primitiveSigTermNumber' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 11/4/2005 06:41'!primSigUsr1Number	"Integer value corresponding to SIGUSR1"	<primitive: 'primitiveSigUsr1Number' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - signal forwarding' stamp: 'dtl 11/4/2005 06:42'!primSigUsr2Number	"Integer value corresponding to SIGUSR2"	<primitive: 'primitiveSigUsr2Number' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 8/7/2005 12:33'!primSizeOfInt	"Size of an integer for this C compiler on this machine."	<primitive: 'primitiveSizeOfInt' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 8/7/2005 12:33'!primSizeOfPointer	"Size of a void pointer for this C compiler on this machine."	<primitive: 'primitiveSizeOfPointer' module: 'UnixOSProcessPlugin'>	^ self primitiveFailed! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 11/28/2010 14:06'!primTestEndOfFileFlag: aSqFileStruct	"Answer whether the file represented by aSqFileStruct is at end of file, as determined	by a call to feof(). This is different from StandardFileStream>>primAtEnd: which answers	true if the file pointer is at the end of the file, but which does not call feof() to	determine that an end of file condition has occurred. The difference is significant	if aSqFileStruct represents a pipe or a device file, which may not be positionable	in the sense of a conventional disk file."	<primitive: 'primitiveTestEndOfFileFlag' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 1/4/2004 15:29'!primTestLockableFileRegion: aSQFileStruct offset: begin length: len exclusive: flag	"Pass a struct SQFile on the stack, and check for ability to lock the specified region.	If the exclusive flag is true, then specify an exclusive (F:=WRLCK) lock on the     file. Otherwise, specify a shared (F:=RDLCK) lock. Any number of Unix processes     may hold  a read lock (shared lock) on a file region, but only one process may     hold a write lock (exclusive lock).	If length is zero, then the request is for the entire file to be locked, including	region extents that have not yet been allocated for the file.	If the fcntl() call fails, answer -1 (the result of the failed call). Otherwise,	answer an array with the following six fields:		lockable (true or false)		l:=pid (pid of the process preventing this lock request, or nil)		l:=type (request type F:=WRLCK or F:=RDLOCK of the process preventing this lock request)		l:=whence (the SEEK:=SET, SEEK:=CUR, or SEEK:=END value of the lock preventing this lock request).		l:=start (offset of the region lock preventing this lock request)		l:=len (length of the region lock preventing this lock request)"	<primitive: 'primitiveTestLockableFileRegion' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 5/17/2009 21:07'!primUnixFileClose: integerFileNumber	"Close a file handle at the close(2) level, using a handle returned by	#primUnixFileNumber."	<primitive: 'primitiveUnixFileClose' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 2/11/2001 16:23'!primUnixFileNumber: aSQFileStruct	"Pass a struct SQFile on the stack, and answer the corresponding Unix file number."	<primitive: 'primitiveUnixFileNumber' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 1/3/2004 23:08'!primUnlockFileRegion: aSQFileStruct offset: begin length: len	"Pass a struct SQFile on tthe stack, and unlock the specified region.	Answer the result of the call to fcntl(). If the region is in the file lock cache,	remove it, but otherwise ignore the cache. The cache supports Win32 semantics	within a single Squeak image, but not across separate images, therefore the	unlock should be attempted regardless of whether this image thinks that the	region has previously been locked. Answer the result of the call to fcntl()."	<primitive: 'primitiveUnlockFileRegion' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/7/2001 00:37'!primUnsetEnv: aKeyString	"Remove an environment variable from the external OS process environment."	<primitive: 'primitiveUnsetEnv' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 8/30/2003 18:29'!primXDisplayControlPluginModuleName	"Answer a string containing the module name string for the display control plugin."	"OSProcess accessor primXDisplayControlPluginModuleName"	<primitive: 'primitiveModuleName' module: 'XDisplayControlPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 8/30/2003 18:32'!primXDisplayControlPluginModuleVersionString	"Answer a string containing the version string for the display control plugin."	"OSProcess accessor primXDisplayControlPluginModuleVersionString"	<primitive: 'primitiveVersionString' module: 'XDisplayControlPlugin'>	^ nil! !!UnixOSProcessAccessor methodsFor: 'printing' stamp: 'dtl 9/10/2000 10:16'!printOn: aStream	"In English, say 'a Unix' rather than 'an Unix'. Therefore do not use super printOn, which	treats $U as a vowel."	aStream		nextPutAll: 'a ';		nextPutAll: self class name;		nextPutAll: ' on pid ';		nextPutAll: self primGetPid printString! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 9/10/2000 11:59'!putPath: aString	"Convenience method. Set the environment PATH variable to aString."	| pathString |	pathString := 'PATH=', aString, ((Character value: 0) asString). 	^ self environmentPut: pathString! !!UnixOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 1/25/2013 18:59'!realpath: pathString	"Get the real path for pathString from the external OS process."	"OSProcess accessor realpath: '/tmp'"	"OSProcess accessor realpath: OSProcess defaultPathString"	"OSProcess accessor realpath: '/bogus/path/name'"	^ self primRealpath: pathString! !!UnixOSProcessAccessor methodsFor: 'file lock registry' stamp: 'dtl 3/5/2005 13:10'!register: fileRegionLock	"If an object equal to fileRegionLock exists in the registry, answer it. Otherwise, add	fileRegionLock to the registry and answer fileRegionLock. Caching is enabled when	EmulateWin32FileLocking is true."	^ self emulateWin32FileLocking		ifTrue: [super register: fileRegionLock]		ifFalse: [fileRegionLock]! !!UnixOSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 8/15/2010 15:30'!restartChildWatcherProcess	"OSProcess accessor restartChildWatcherProcess"	self finalize.	^ self grimReaperProcess! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:45'!restoreSigChld	"Unset a SIGCHLD signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigChld"	^ self restoreSignal: self primSigChldNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:47'!restoreSigHup	"Unset a SIGHUP signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigHup"	^ self restoreSignal: self primSigHupNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:46'!restoreSigInt	"Unset a SIGINT signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigInt"	^ self restoreSignal: self primSigIntNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:48'!restoreSigKill	"Unset a SIGKILL signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigKill"	self notify: 'SIGKILL and SIGSTOP signals cannot be caught, see man signal(2)'.	^ self restoreSignal: self primSigIntNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:48'!restoreSigPipe	"Unset a SIGPIPE signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigPipe"	^ self restoreSignal: self primSigPipeNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:49'!restoreSigQuit	"Unset a SIGQUIT signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigQuit"	^ self restoreSignal: self primSigQuitNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:49'!restoreSigTerm	"Unset a SIGTERM signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigTerm"	^ self restoreSignal: self primSigTermNumber! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:49'!restoreSigUsr1	"Unset a SIGUSR1 signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigUsr1"	^ self restoreSignal: self primSigUsr1Number! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 11/4/2005 06:50'!restoreSigUsr2	"Unset a SIGUSR2 signal handler and unregister the Smalltalk semaphore.	Answer the unregistered Semaphore, or nil if unable to restore the signal	(possibly because no handler had been set)."	"OSProcess accessor restoreSigUsr2"	^ self restoreSignal: self primSigUsr2Number! !!UnixOSProcessAccessor methodsFor: 'signal forwarding' stamp: 'dtl 12/28/2002 15:33'!restoreSignal: signalNumber 	"Unset a signal handler and unregister the Smalltalk semaphore. Answer	the unregistered Semaphore, or nil if unable to restore the signal (possibly	because no handler had been set)."	"OSProcess accessor restoreSignal: OSProcess accessor primSigIntNumber"	| semaphoreIndex sema |	semaphoreIndex := self primSemaIndexFor: signalNumber.	semaphoreIndex ifNotNil:		[sema := Smalltalk externalObjects at: semaphoreIndex ifAbsent: [].		sema ifNotNil:			[self primForwardSignal: signalNumber toSemaphore: nil.			Smalltalk unregisterExternalObject: sema]].	^ sema! !!UnixOSProcessAccessor methodsFor: 'fork and exec' stamp: 'dtl 8/18/2014 20:16'!safeToForkSqueak	"The forkSqueak method is currently supported only for X11 displays with	XDisplayControlPlugin available. If the plugin is not available, the child Squeak	VM will continue interacting with the X display, which leads to errors in the	parent Squeak, including VM crashes."	^self canControlXDisplay		or: [ ThisOSProcess isHeadless ]! !!UnixOSProcessAccessor methodsFor: 'file control' stamp: 'dtl 11/28/2010 12:15'!setBlocking: anIOHandle	"Convert anIOHandle to an SQFile data structure and call primitive to set for blocking I/O."	^ self primSQFileSetBlocking: (self handleFromAccessor: anIOHandle)! !!UnixOSProcessAccessor methodsFor: 'file control' stamp: 'dtl 11/28/2010 12:16'!setNonBlocking: anIOHandle	"Convert anIOHandle to an SQFile data structure and call primitive to set it non-blocking."	^ self primSQFileSetNonBlocking: (self handleFromAccessor: anIOHandle)! !!UnixOSProcessAccessor methodsFor: 'signal print stack trace' stamp: 'dtl 7/20/2010 00:07'!setPrintAllStacksOnSigUsr1	"Set a signal handler in the VM that will print all call stacks on console output	whenever a SIGUSR1 is received. Answer an identifier for the previously	defined signal handler or nil if this signal handler has already been set."		"OSProcess accessor setPrintAllStacksOnSigUsr1"	"OSProcess accessor clearPrintAllStacksOnSigUsr1"	^self primPrintAllStacksOnSignal: self primSigUsr1Number	! !!UnixOSProcessAccessor methodsFor: 'file control' stamp: 'dtl 11/28/2010 12:17'!setUnbuffered: anIOHandle	"Convert anIOHandle to an SQFile data structure and call primitive to set unbuffered I/O."	^ self primSQFileSetUnbuffered: (self handleFromAccessor: anIOHandle)! !!UnixOSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 1/25/2004 21:31'!sigChldSemaphore	"Answer the value of sigChldSemaphore"	^ sigChldSemaphore ifNil: [sigChldSemaphore := self forwardSigChld].! !!UnixOSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 1/25/2004 21:29'!sigChldSemaphore: anObject	"Set the value of sigChldSemaphore"	sigChldSemaphore := anObject! !!UnixOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 3/25/2001 15:34'!sizeOfInt	"Size of an integer on this machine with this C compiler."	^ self primSizeOfInt! !!UnixOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 3/25/2001 20:55'!sizeOfPointer	"Size of a void pointer on this machine with this C compiler."	^ self primSizeOfPointer! !!UnixOSProcessAccessor methodsFor: 'file control' stamp: 'dtl 10/6/2001 07:27'!unixFileNumber: anIOHandle	"Answer the integer Unix file number corresponding to anIOHandle."	^ anIOHandle ifNotNil: [self primUnixFileNumber: (self handleFromAccessor: anIOHandle)]! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 4/10/2005 15:17'!unlockAllForFile: aFileStream	"Unlock and uncache all locks associated with aFileStream.  This could be called	before closing a stream, for example."	(self registeredLocksForFile: aFileStream) do: [:ea | self unlockFileRegion: ea]! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/22/2004 15:02'!unlockFile: aFileStream	"Unlock the file represented by aFileStream.  Answer a descriptor for the unlocked	file region, an Array of file handle and region interval; or answer nil on error	or if the region did not appear in the cache.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self unlockFile: aFileStream exclusive: true! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'jf 2/22/2004 17:30'!unlockFile: aFileStream exclusive: flag	"Unlock the file represented by aFileStream.  Answer a descriptor for the unlocked	file region, an Array of file handle and region interval; or answer nil on error	or if the region did not appear in the cache.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	| fileLock |	aFileStream ifNil: [^ nil].	fileLock := OSFileLock onFile: aFileStream exclusive: flag.	^ self unlockFileRegion: fileLock! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/12/2006 07:05'!unlockFile: aFileStream exclusive: flag ifFail: failBlock	"Unlock the file represented by aFileStream.  Answer a descriptor for the unlocked	file region, an Array of file handle and region interval; or answer nil on error	or if the region did not appear in the cache.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	| fileLock |	aFileStream ifNil: [^ failBlock value].	fileLock := OSFileLock onFile: aFileStream exclusive: flag.	^ self unlockFileRegion: fileLock ifFail: failBlock! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/22/2004 15:01'!unlockFile: aFileStream from: start to: end	"Pass a struct SQFile on the stack, and unlock the specified region.	Answer the result of the call to fcntl(). If the region is in the file lock cache,	remove it, but otherwise ignore the cache. The cache supports Win32 semantics	within a single Squeak image, but not across separate images, therefore the	unlock should be attempted regardless of whether this image thinks that the	region has previously been locked. Answer a descriptor for the unlocked file	region, an Array of file handle and region interval; or answer nil on error	or if the region did not appear in the cache.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self unlockFile: aFileStream from: start to: end exclusive: true! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 2/22/2004 15:09'!unlockFile: aFileStream from: start to: end exclusive: flag	"Pass a struct SQFile on the stack, and unlock the specified region.	Answer the result of the call to fcntl(). If the region is in the file lock cache,	remove it, but otherwise ignore the cache. The cache supports Win32 semantics	within a single Squeak image, but not across separate images, therefore the	unlock should be attempted regardless of whether this image thinks that the	region has previously been locked. Answer a descriptor for the unlocked file	region, an Array of file handle and region interval; or answer nil on error	or if the region did not appear in the cache.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	| fileRegion |	aFileStream ifNil: [^ nil].	fileRegion := OSFileRegionLock onFile: aFileStream from: start to: end exclusive: flag.	^ self unlockFileRegion: fileRegion! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 8/30/2009 14:54'!unlockFile: fileStream from: start to: end exclusive: writeLockFlag ifFail: failBlock	| lock |	lock := OSFileRegionLock onFile: fileStream from: start to: end exclusive: writeLockFlag.	^ self unlockFileRegion: lock ifFail: [failBlock value]! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 8/30/2009 16:25'!unlockFile: fileStream from: start to: end ifFail: failBlock	^ self unlockFile: fileStream from: start to: end exclusive: true ifFail: failBlock! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/12/2006 07:06'!unlockFile: aFileStream ifFail: failBlock	"Unlock the file represented by aFileStream.  Answer a descriptor for the unlocked	file region, an Array of file handle and region interval; or answer nil on error	or if the region did not appear in the cache.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self unlockFile: aFileStream exclusive: true ifFail: failBlock! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/8/2006 07:12'!unlockFileRegion: aFileLock	"Pass a struct SQFile on the stack, and unlock the specified region.	Answer the result of the call to fcntl(). If the region is in the file lock cache,	remove it, but otherwise ignore the cache. The cache supports Win32 semantics	within a single Squeak image, but not across separate images, therefore the	unlock should be attempted regardless of whether this image thinks that the	region has previously been locked. Answer a descriptor for the unlocked file	region, an Array of file handle and region interval; or answer nil on error	or if the region did not appear in the cache.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	^ self unlockFileRegion: aFileLock ifFail: [nil]! !!UnixOSProcessAccessor methodsFor: 'file locking' stamp: 'dtl 5/20/2006 12:46'!unlockFileRegion: aFileLock ifFail: failBlock	"Pass a struct SQFile on the stack, and unlock the specified region.	Answer the result of the call to fcntl(). If the region is in the file lock cache,	remove it, but otherwise ignore the cache. The cache supports Win32 semantics	within a single Squeak image, but not across separate images, therefore the	unlock should be attempted regardless of whether this image thinks that the	region has previously been locked. Answer a descriptor for the unlocked file	region, an Array of file handle and region interval; or answer nil on error	or if the region did not appear in the cache.	Warning: The registry permits compatibility with Win32 file locking semantics,	but only within a single Squeak image. Multiple cooperating images must not	rely on the overlap checking, because the registry is local to this image and	cannot be shared across images in different OS process contexts."	aFileLock ifNil: [^ failBlock value].	"Check region lock overlap for Win32 compatibility"	self emulateWin32FileLocking		ifTrue: [ | unregisteredLock |				(unregisteredLock := self unregister: aFileLock)					ifNil: [^ failBlock value]					ifNotNil: [unregisteredLock unlock						ifTrue: [^ unregisteredLock]						ifFalse: [^ failBlock value]]]		ifFalse: [aFileLock unlock					ifTrue: [^ aFileLock]					ifFalse: [^ failBlock value]]! !!UnixOSProcessAccessor methodsFor: 'file lock registry' stamp: 'dtl 3/5/2005 13:10'!unregister: fileRegionLock	"If an object equal to fileRegionLock exists in the registry, remove it and	answer the object. Otherwise answer nil. Caching is enabled when	EmulateWin32FileLocking is true."	^ self emulateWin32FileLocking		ifTrue: [super unregister: fileRegionLock]		ifFalse: [nil]! !!UnixOSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:45'!xdcpModuleName	"Answer a string containing the module name string for the display control plugin."	"OSProcess accessor xdcpModuleName"	^ self primXDisplayControlPluginModuleName! !!UnixOSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 10:46'!xdcpVersionString	"Answer a string containing the version string for the display control plugin."	"OSProcess accessor xdcpVersionString"	^ self primXDisplayControlPluginModuleVersionString! !!WindowsOSProcessAccessor class methodsFor: 'platform identification' stamp: 'dtl 8/30/2003 17:50'!isResponsibleForThisPlatform	"Answer true if this class is responsible for representing the OS process for the	Squeak VM running on the current platform."	^ OSProcess isWindows! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 2/26/2002 16:11'!activeHandles	"Answer an Array of handles for all children that are believed to be running."	^ OSProcess thisOSProcess activeHandles! !!WindowsOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 9/10/2002 09:24'!canAccessChildProcess: anExternalProcess	"Is the child process still there? Maybe not if we have restarted the image	and anExternalProcess refers to a process which died while we were not	watching."	| handle |	^ (handle := anExternalProcess handle) notNil		ifTrue: [self primCanAccessChildProcess: handle]		ifFalse: [false]! !!WindowsOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 2/22/2002 22:17'!canAccessSystem	"Answer true if it is possible to access the external process, else false. Failure	to access the external process is probably due to lack of a UnixOSProcessPlugin	module."	^ self primGetPid notNil! !!WindowsOSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 2/27/2002 11:56'!childWatcherThread	"A thread which signals my sigChldSemaphore when any child process exits."	^ childWatcherThread! !!WindowsOSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 2/27/2002 11:44'!childWatcherThread: aThreadObject	"A thread which signals my sigChldSemaphore when any child process exits."	childWatcherThread := aThreadObject! !!WindowsOSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 2/26/2002 08:43'!finalize	"Clean up grimReaper and associated semaphore."	grimReaper ifNotNil:			[grimReaper terminate.			grimReaper := nil].	sigChldSemaphore ifNotNil:			[Smalltalk unregisterExternalObject: sigChldSemaphore.			sigChldSemaphore := nil].	semaIndex := nil! !!WindowsOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 2/27/2002 13:22'!getMainThread	"Answer the main thread of this OS process. The handle for this thread is a	pseudo-handle, and cannot be used to terminate the thread."	"OSProcess accessor getMainThread"	^ WindowsThread threadID: self primGetPid handle: self primGetPidHandle running: true! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/7/2002 20:09'!getStdErr	"Answer an IO handle (representing a SQFile data structure in interp.c) for the standard	error for the OS process in which I am currently executing, or nil if the IO handle	cannot be obtained."	"OSProcess accessor getStdErr"	| error |	error := self primGetStdErrorForSession: self sessionIdentifier.	^ (error notNil and: [error last])		ifTrue: [self ioAccessorFromSQFile: error first]		ifFalse: [nil]! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/25/2005 16:11'!getStdErrHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard error for the	OS process in which I am currently executing."	^ self ioAccessorFromSQFile: self getStdErr! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/7/2002 20:11'!getStdIn	"Answer an IO handle (representing a SQFile data structure in interp.c) for the standard	input for the OS process in which I am currently executing, or nil if the IO handle	cannot be obtained."	"OSProcess accessor getStdIn"	| input |	input := self primGetStdInputForSession: self sessionIdentifier.	^ (input notNil and: [input last])		ifTrue: [self ioAccessorFromSQFile: input first]		ifFalse: [nil]! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/25/2005 16:10'!getStdInHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard input for the	OS process in which I am currently executing."	^ self ioAccessorFromSQFile: self getStdIn! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/7/2002 20:11'!getStdOut	"Answer an IO handle (representing a SQFile data structure in interp.c) for the standard	output for the OS process in which I am currently executing, or nil if the IO handle	cannot be obtained."	"OSProcess accessor getStdOut"	| output |	output := self primGetStdOutputForSession: self sessionIdentifier.	^ (output notNil and: [output last])		ifTrue: [self ioAccessorFromSQFile: output first]		ifFalse: [nil]! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/25/2005 16:09'!getStdOutHandle	"Answer the handle (a SQFile data structure in interp.c) for the standard output for the	OS process in which I am currently executing."	^ self ioAccessorFromSQFile: self getStdOut! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 9/3/2010 13:13'!grimReaperProcess	"This is a process which waits for the death of a child OSProcess, and 	informs any dependents of the change."	grimReaper ifNil: [grimReaper := [				[self sigChldSemaphoreSet wait.				self changed: #childProcessStatus] repeat] newProcess.				grimReaper resume.				"name selected to look reasonable in the process browser"				grimReaper name: ((ReadStream on: grimReaper hash asString) next: 5)						, ': the child OSProcess watcher'].	^ grimReaper! !!WindowsOSProcessAccessor methodsFor: 'initialize - release' stamp: 'dtl 3/2/2002 08:33'!initialize	"Create and register a semaphore to be used for signaling external process exits"	super initialize.	self sigChldSemaphoreSet.	self grimReaperProcess! !!WindowsOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 9/26/2005 07:45'!isExecutable: aPathName	"Answer true if file at aPathName has execute permission for this process."	"FIXME: Default to true for Windows"	^ true! !!WindowsOSProcessAccessor methodsFor: 'nonblocking read' stamp: 'dtl 10/1/2005 09:26'!lastReadFor: aSemaphoreIndex	"A character has been read into an external buffer corresponding to aSemaphoreIndex,	and is now available. Answer integer value of the character, or nil if no character	was read, or -1 if an error occurred on the read."	| c readResult |	readResult := Array new: 3.	c := self primLastReadFor: aSemaphoreIndex storeIn: readResult.	(c < 1) ifTrue: [self error: 'primLastReadFor: error, returned negative value'].	^ c! !!WindowsOSProcessAccessor methodsFor: 'nonblocking read' stamp: 'dtl 10/1/2005 09:26'!lastReadFor: aSemaphoreIndex storeIn: aThreeElementArray	"A character has been read into an external buffer corresponding to aSemaphoreIndex,	and is now available. Answer integer value of the character, or nil if no character	was read, or -1 if an error occurred on the read. The results of the read call are	stored in aThreeElementArray as a side effect."	^ self primLastReadFor: aSemaphoreIndex storeIn: aThreeElementArray! !!WindowsOSProcessAccessor methodsFor: 'nonblocking read' stamp: 'dtl 4/1/2002 11:02'!nextFrom: aFileStream signaling: aSemaphoreIndex	"Read the next character from aFileStream into a buffer in the VM. When the read completes,	signal the specified Semaphore to notify that the character is available."	| sqFile |	sqFile := UseIOHandle				ifTrue: [aFileStream ioHandle handle]				ifFalse: [aFileStream fileID].	^ self primNextFrom: sqFile signaling: aSemaphoreIndex! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/7/2002 20:03'!openStdErr	"Answer an IO handle (representing a SQFile data structure in interp.c) for the standard	error for the OS process in which I am currently executing. Open a console if necessary	to make standard error available."	"OSProcess accessor openStdErr"	| error |	error := self primGetStdErrorForSession: self sessionIdentifier.	error ifNil: [^ nil].	error last		ifFalse:			[self primAllocConsole.			error := self primGetStdOutputForSession: self sessionIdentifier].	^ self ioAccessorFromSQFile: error first! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/7/2002 20:04'!openStdIn	"Answer an IO handle (representing a SQFile data structure in interp.c) for the standard	input for the OS process in which I am currently executing. Open a console if necessary	to make standard input available."	"OSProcess accessor openStdIn"	| input |	input := self primGetStdInputForSession: self sessionIdentifier.	input ifNil: [^ nil].	input last		ifFalse:			[self primAllocConsole.			input := self primGetStdOutputForSession: self sessionIdentifier].	^ self ioAccessorFromSQFile: input first! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/7/2002 20:05'!openStdOut	"Answer an IO handle (representing a SQFile data structure in interp.c) for the standard	output for the OS process in which I am currently executing. Open a console if necessary	to make standard input available."	"OSProcess accessor openStdOut"	| output |	output := self primGetStdOutputForSession: self sessionIdentifier.	output ifNil: [^ nil].	output last		ifFalse:			[self primAllocConsole.			output := self primGetStdOutputForSession: self sessionIdentifier].	^ self ioAccessorFromSQFile: output first! !!WindowsOSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 11:46'!osppModuleName	"Answer a string containing the module name string for the OSPP plugin."	"OSProcess accessor osppModuleName"	^ self primOSProcessPluginModuleName! !!WindowsOSProcessAccessor methodsFor: 'plugin identification' stamp: 'dtl 10/1/2005 11:46'!osppModuleVersionString	"Answer a string containing the version string for the OSPP plugin."	"OSProcess accessor osppModuleVersionString"	^ self primOSProcessPluginModuleVersionString! !!WindowsOSProcessAccessor methodsFor: 'console' stamp: 'dtl 3/25/2002 06:28'!primAllocConsole	"Allocate a console if not already allocated."	"OSProcess accessor primAllocConsole"	<primitive: 'primitiveAllocConsole' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 8/17/2002 12:46'!primBufferValuesAt: aSemaphoreIndex	"For debugging only. Answer the current values of readCharBufferArray,	readCharCountArray, and readCharStatusArray at index, an integer corresponding	to a semaphore for one read handler thread. Answer an Array with the buffered	character, the character count, and the status value."	"OSProcess accessor primBufferValuesAt: 1"	<primitive: 'primitiveBufferValuesAt' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 9/10/2002 09:19'!primCanAccessChildProcess: handleObject	"Answer true if the OS process represented by a HANDLE can be accessed by this OS process."	<primitive: 'primitiveCanAccessChildProcess' module: 'Win32OSProcessPlugin'>	^ false! !!WindowsOSProcessAccessor methodsFor: 'handles' stamp: 'dtl 2/25/2002 07:37'!primCloseHandle: handleObject	"Close the specified handle, which may refer to a process, a thread, or	some other Win32 object."	"| procInfo |	procInfo := OSProcess accessor primCommand: 'SOL'.	OSProcess accessor primCloseHandle: procInfo first"	<primitive: 'primitiveCloseHandle' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'deprecated' stamp: 'dtl 9/9/2002 09:24'!primCommand: commandString	"Run a command in a new external process. Answer a result array with	hProcess, hThread, dwProcessId, dwThreadId.	This primitive has been replaced by #primCommand:stdIn:stdOut:stdErr:, and	will be removed in future versions of OSProcess."	"OSProcess accessor primCommand: 'C:\WINDOWS\SOL'"	"OSProcess accessor primCommand: 'SOL'"	"OSProcess accessor primCommand: 'NoSuchProgram'"	<primitive: 'primitiveCommand' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'process creation' stamp: 'dtl 9/9/2002 09:19'!primCommand: commandString stdIn: inputFileIoHandle stdOut: outputFileIoHandle stdErr: errorFileIoHandle	"Run a command in a new external process. The standard input, output and error	stream handles are sqFile byte arrays (not Win32 HANDLE arrays), and may be nil.	Answer a result array with hProcess, hThread, dwProcessId, dwThreadId."	"OSProcess accessor primCommand: 'C:\WINDOWS\SOL' stdIn: nil stdOut: nil stdErr: nil"	"OSProcess accessor primCommand: 'SOL' stdIn: nil stdOut: nil stdErr: nil"	"OSProcess accessor primCommand: 'NoSuchProgram' stdIn: nil stdOut: nil stdErr: nil"	"OSProcess accessor primCommand: 'SOL' stdIn: (FileStream fileNamed: 'output.tmp') fileID stdOut: nil stdErr: nil"	<primitive: 'primitiveCommandWithInputOutputError' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'pipe open' stamp: 'dtl 11/28/2010 12:51'!primCreatePipe	"Create a pipe, and answer an array of two file handles (SQFile data structures in interp.c)	for the pipe reader and writer."	<primitive: 'primitiveCreatePipe' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'pipe open' stamp: 'dtl 11/28/2010 12:52'!primCreatePipeWithSessionIdentifier: aByteArray	"Create a pipe, and answer an array of two file handles (SQFile data structures in interp.c)	for the pipe reader and writer."	<primitive: 'primitiveCreatePipeWithSessionIdentifier' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'console' stamp: 'dtl 3/25/2002 06:27'!primFreeConsole	"Deallocate the console if allocated."	"OSProcess accessor primFreeConsole"	<primitive: 'primitiveFreeConsole' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 9/6/2002 14:58'!primGetCurrentWorkingDirectory	"Call getcwd() to get the current working directory."	"OSProcess accessor primGetCurrentWorkingDirectory"	<primitive: 'primitiveGetCurrentWorkingDirectory' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 2/22/2002 18:23'!primGetEnvironmentStrings	"Answer the environment block in the form of an Array of Strings. The	caller is expected to parse the strings into a dictionary of keys and values."	<primitive: 'primitiveGetEnvironmentStrings' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 2/25/2002 08:23'!primGetExitStatusForHandle: handleObject	"Answer the exit status for the process represented by a HANDLE. Fail if	the process is still active, or if the GetExitCodeProcess call fails."	"| procInfo |	procInfo := OSProcess accessor primCommand: 'SOL'.	(Delay forSeconds: 5) wait.	OSProcess accessor primGetExitStatusForHandle: procInfo first"	<primitive: 'primitiveGetExitStatusForHandle' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 2/27/2002 13:20'!primGetMainThreadHandle	"Answer a pseudo-handle for my main thread."	"OSProcess accessor primGetMainThreadHandle"	<primitive: 'primitiveGetMainThreadHandle' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 3/4/2006 17:57'!primGetMainThreadID	"Answer the ID of my main thread."	"OSProcess accessor primGetMainThreadID"	<primitive: 'primitiveGetMainThreadID' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 2/22/2002 16:06'!primGetPid	"Answer the OS process ID for the OS process in which I am currently executing."	<primitive: 'primitiveGetPid' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'external process access' stamp: 'dtl 2/27/2002 13:21'!primGetPidHandle	"Answer the pseudo-handle for my OS process"	"OSProcess accessor primGetPidHandle"	<primitive: 'primitiveGetPidHandle' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'session identification' stamp: 'dtl 3/2/2002 08:15'!primGetSession	"Answer the unique identifier for this session of Smalltalk running in this OS Process."	"OSProcess accessor primGetSession"	<primitive: 'primitiveGetSession' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 9/7/2002 14:55'!primGetStdErrorForSession: sessionIdentifierByteArray	"Answer a two element array containing the sqFile data structure representing	standard error stream for my OS process, and a flag (true or false) to indicate	whether the sqFile data structure contains a valid HANDLE. If no standard error	stream is available for this OS process, the sqFile data structure will contain an	invalid HANDLE value, which will result in failures on subsequent accesses."	"OSProcess accessor primGetStdError"	<primitive: 'primitiveGetStdError' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 9/7/2002 14:55'!primGetStdInputForSession: sessionIdentifierByteArray	"Answer a two element array containing the sqFile data structure representing	standard input stream for my OS process, and a flag (true or false) to indicate	whether the sqFile data structure contains a valid HANDLE. If no standard input	stream is available for this OS process, the sqFile data structure will contain an	invalid HANDLE value, which will result in failures on subsequent accesses."	"OSProcess accessor primGetStdInput"	<primitive: 'primitiveGetStdInput' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 9/7/2002 14:55'!primGetStdOutputForSession: sessionIdentifierByteArray	"Answer a two element array containing the sqFile data structure representing	standard output stream for my OS process, and a flag (true or false) to indicate	whether the sqFile data structure contains a valid HANDLE. If no standard output	stream is available for this OS process, the sqFile data structure will contain an	invalid HANDLE value, which will result in failures on subsequent accesses."	"OSProcess accessor primGetStdOutput"	<primitive: 'primitiveGetStdOutput' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/1/2005 09:26'!primLastReadFor: aSemaphoreIndex	"A character has been read into an external buffer corresponding to aSemaphoreIndex,	and is now available. Answer integer value of the character, or nil if no character	was read, or -1 if an error occurred on the read."	<primitive: 'primitiveLastReadFor' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/1/2005 09:27'!primLastReadFor: aSemaphoreIndex storeIn: aThreeElementArray	"A character has been read into an external buffer corresponding to aSemaphoreIndex,	and is now available. Answer integer value of the character, or nil if no character	was read, or -1 if an error occurred on the read. Contents of the aThreeElementArray	will be status of the read call, character read, and character count (which should	always be 1)."	<primitive: 'primitiveLastReadForStoreIn' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 4/1/2002 10:58'!primNextFrom: anIOHandle signaling: aSemaphoreIndex	"Read the next character from anIOHandle (a SQFile struct) into a buffer in the VM. When	the read completes, signal the specified Semaphore to notify that the character is available."	<primitive: 'primitiveNextFromSignaling' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/1/2005 11:50'!primOSProcessPluginModuleName	"Answer a string containing the module name string for the OSPP plugin."	"OSProcess accessor primOSProcessPluginModuleName"	<primitive: 'primitiveModuleName' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 10/1/2005 11:51'!primOSProcessPluginModuleVersionString	"Answer a string containing the version string for the OSPP plugin."	"OSProcess accessor primOSProcessPluginModuleVersionString"	<primitive: 'primitiveVersionString' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'testing' stamp: 'dtl 10/10/2012 08:05'!primOneShot	"Answer true the first time this is called in a Squeak session, and false thereafter."	"OSProcess accessor primOneShot"	<primitive: 'primitiveOneShot' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'handles' stamp: 'dtl 3/29/2002 17:47'!primSetStdErr: anIOHandle	"Set the standard error handle to that of anIOHandle, where anIOHandle is a	ByteArray representation of a SQFile structure."	<primitive: 'primitiveSetStdErr' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'handles' stamp: 'dtl 3/29/2002 17:48'!primSetStdIn: anIOHandle	"Set the standard input handle to that of anIOHandle, where anIOHandle is a	ByteArray representation of a SQFile structure."	<primitive: 'primitiveSetStdIn' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'handles' stamp: 'dtl 3/29/2002 17:48'!primSetStdOut: anIOHandle	"Set the standard output handle to that of anIOHandle, where anIOHandle is a	ByteArray representation of a SQFile structure."	<primitive: 'primitiveSetStdOut' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 2/26/2002 16:14'!primSetWaitForAnyProcessExit: arrayOfProcessHandleObjects thenSignalSemaphoreWithIndex: index	"Set up a thread to wait for a process HANDLE to exit, then signal the Semaphore	at index. This provides asychronous notification of an external process exit."	<primitive: 'primitiveSetWaitForAnyProcessExitThenSignalSemaphoreWithIndex' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 2/27/2002 11:34'!primTerminateThread: aThreadHandle	"Kill the thread. No cleanup is performed, so use with caution for a thread which	is (for example) manipulating a mutex. Answer true for success, else false."	<primitive: 'primitiveTerminateThread' module: 'Win32OSProcessPlugin'>	^ nil! !!WindowsOSProcessAccessor methodsFor: 'private - primitive access' stamp: 'dtl 4/8/2007 10:54'!primTestEndOfFileFlag: aSqFileStruct	"Answer whether the file represented by aSqFileStruct is at end of file, as determined	by a call to feof(). This is different from StandardFileStream>>primAtEnd: which answers	true if the file pointer is at the end of the file, but which does not call feof() to	determine that an end of file condition has occurred. The difference is significant	if aSqFileStruct represents a pipe or a device file, which may not be positionable	in the sense of a conventional disk file."	<primitive: 'primitiveTestEndOfFileFlag' module: 'Win32OSProcessPlugin'>	self flag: 'FIXME'. "not yet implemented in OSPP for Windows"	^ self primitiveFailed! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 3/2/2015 20:03'!restartChildWatcherProcess	grimReaper ifNotNilDo: [ :p | p terminate. grimReaper := nil ].	self grimReaperProcess! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 1/13/2007 09:48'!restartChildWatcherThread: arrayOfProcessHandleObjects	"Start a new child watcher thread. If a thread is alread active, terminate	it before starting a new one."	self childWatcherThread ifNotNil: [childWatcherThread terminate].	self childWatcherThread: (self setWaitForAnyProcessExit: arrayOfProcessHandleObjects).	^ childWatcherThread! !!WindowsOSProcessAccessor methodsFor: 'accessing' stamp: 'dtl 2/25/2002 21:17'!semaIndex	"Index of the registered Semaphore"	semaIndex ifNil: [self initialize].	^ semaIndex! !!WindowsOSProcessAccessor methodsFor: 'file control' stamp: 'dtl 9/26/2005 07:35'!setBlocking: anIOHandle	"Convert anIOHandle to an SQFile data structure and call primitive to set for blocking I/O."	"FIXME: need to implement this for Win32"	"self notify: 'there is no general mechanism to set blocking IO on Win32'"! !!WindowsOSProcessAccessor methodsFor: 'file control' stamp: 'dtl 9/26/2005 07:36'!setNonBlocking: anIOHandle	"Convert anIOHandle to an SQFile data structure and call primitive to set it non-blocking."	"FIXME: need to implement this for Win32"	"self notify: 'there is no general mechanism to set nonblocking IO on Win32'"! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/9/2002 07:22'!setStdErr: aFileStream	"Set the standard error handle for this OSProcess to be that of aFileStream"	"| fs |	fs := FileStream fileNamed: 'stdError.tmp'.	OSProcess accessor setStdErr: fs"	| sqFile |	aFileStream ifNil: [^ false].	sqFile := UseIOHandle				ifTrue: [aFileStream ioHandle handle]				ifFalse: [aFileStream fileID].	^ self primSetStdErr: sqFile! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/9/2002 07:22'!setStdIn: aFileStream	"Set the standard input handle for this OSProcess to be that of aFileStream"	"| fs |	fs := FileStream fileNamed: 'stdInput.tmp'.	fs nextPutAll: 'this is a line of text'; cr.	fs position: 0.	OSProcess accessor setStdIn: fs"	| sqFile |	aFileStream ifNil: [^ false].	sqFile := UseIOHandle				ifTrue: [aFileStream ioHandle handle]				ifFalse: [aFileStream fileID].	^ self primSetStdIn: sqFile! !!WindowsOSProcessAccessor methodsFor: 'standard IO handles' stamp: 'dtl 9/9/2002 07:22'!setStdOut: aFileStream	"Set the standard output handle for this OSProcess to be that of aFileStream"	"| fs |	fs := FileStream fileNamed: 'stdOutput.tmp'.	OSProcess accessor setStdOut: fs"	| sqFile |	aFileStream ifNil: [^ false].	sqFile := UseIOHandle				ifTrue: [aFileStream ioHandle handle]				ifFalse: [aFileStream fileID].	^ self primSetStdOut: sqFile! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 2/26/2002 19:08'!setWaitForAnyProcessExit: arrayOfProcessHandleObjects	"Set up a thread to wait for a process HANDLE to exit, then signal the Semaphore	at index. This provides asychronous notification of an external process exit. The	caller should close the thread handle when it is no longer needed."	"OSProcess command: 'SOL'.	OSProcess accessor setWaitForAnyProcessExit: OSProcess thisOSProcess activeHandles."	| threadInfo |	arrayOfProcessHandleObjects isEmpty ifTrue: [^ nil].	threadInfo := self		primSetWaitForAnyProcessExit: arrayOfProcessHandleObjects		thenSignalSemaphoreWithIndex: self semaIndex.	^ WindowsThread		threadID: threadInfo last		handle: threadInfo first		running: true! !!WindowsOSProcessAccessor methodsFor: 'child process management' stamp: 'dtl 2/25/2002 21:12'!sigChldSemaphoreSet	sigChldSemaphore ifNil:		[sigChldSemaphore := Semaphore new.		semaIndex := Smalltalk registerExternalObject: sigChldSemaphore].	^ sigChldSemaphore! !!PseudoAioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 11/25/2006 10:49'!close	"When the FileStream or Socket handled by this aio handler is closed,	it should send #close to this handler."	eventGenerator ifNotNil: [eventGenerator terminate]! !!PseudoAioEventHandler methodsFor: 'accessing' stamp: 'dtl 11/25/2006 13:17'!eventGenerator	"Answer the value of eventGenerator"	^ eventGenerator ifNil: [eventGenerator := self eventGeneratorProcess]! !!PseudoAioEventHandler methodsFor: 'initialize-release' stamp: 'RB 9/3/2010 11:52'!eventGeneratorProcess	"A process that generates periodic #changed events"	| d p|	d := Delay forMilliseconds: 125.	p := [[self changed.	d wait] repeat] newProcess.	^p resume.! !!PseudoAioEventHandler methodsFor: 'initialize-release' stamp: 'dtl 11/25/2006 13:15'!initialize	self eventGenerator.	^ super initialize! !"OSProcess-AIO"!"OSProcess-Base"!"OSProcess-OS2"!"OSProcess-Win32"!"OSProcess-Unix"!"OSProcess-Mac"!"OSProcess-RiscOS"!!ShellSyntax commentStamp: 'dtl 9/7/2009 12:36' prior: 0!My instances implement parsing of strings in a manner similar to a simple Unix command shell. I provide path name expansion in the context of an external file system, and support the syntax required for IO redirection. All file name globbing and PATH searching are implemented in Smalltalk rather than in C library functions or an external command shell.Most of my syntax is applicable for any operating system. Where needed, platform specific methods are in my "platform dependent" category. Currently, Unix and Windows are supported, and other platforms have not been tested. The primary difference between Unix and Windows support is that device names (such as 'C:') are used in Windows path strings. Separate current working directory strings are maintained for all Windows device names. For Unix, a single current working directory path is used. On Windows, this permits the CommandShell 'cd' command to support changing directories to another device without losing track of the current working directory for the previous device.Command pipeline syntax is not supported here. See CommandShell for the implementation of command pipelines.!!CommandShell commentStamp: '<historical>' prior: 0!I am a command shell, similar to /bin/sh, with a simple command line user interface. I collaborate with process proxies to provide command execution, and I provide a limited set of built in commands similar to those in /bin/sh. My built in commands are implemented in Smalltalk, and any other commands are passed to process proxies to be executed either internally as Smalltalk "doIt" expressions, or externally as commands passed to the external operating system. I am similar to a TranscriptStream (some methods are copied directly from TranscriptStream), but I also know how to accept lines of command input, parse them, and hand them off to process proxies for execution.Three types of commands may be executed from a CommandShell: internal "builtin" commands implemented in Smalltalk; internal Smalltalk "doIt" commands; and external commands. Internal commands (builtin commands or doIt commands) may be freely mixed with external operating system commands in a command pipeline. See CommandShell class>>commandProcessing for more information.Each command line is first evaluated as a Smalltalk expression, and is subject to further parsing only if the Smalltalk evaluation fails. In practice, this permits complete Smalltalk expressions to be evaluated easily without conflicting with shell syntax, and allows Smalltalk and unix shell commands to be freely mixed.Simple command scripting is supported (method category 'command scripting'). Any mix of internal and external commands may be included in a script. Conditional branching is supported based on command exit status.Open a new shell window with "CommandShell open". Type 'help' followed by <return> or <enter> for help on builtin commands.Things that work reasonably well:- Simple command execution for running command line programs or starting  X programs.- Command pipelines. Built in commands can be mixed with external  commands, as in "help sqsh | wc -l".- Command IO redirection with '<',  '>', '>>', '2>', and '2>>'.- Command history and command history recall.- Background command execution, as in "xterm&".- <ctl-C> to interrupt a running external command.- <ctl-D> to indicate end of file in terminal input.Limitations include:- Dumb tty only. Do not try to run vi.- Standard Unix shell syntax is not completely implemented.Race conditions are possible for certain command pipelines. See CommandShell class>>raceConditions for more information.!!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/25/2013 19:12'!appendPath: aPathString toPath: startingPathString 	"ShellSyntax new appendPath: 'hosts' toPath: '/etc'"	"ShellSyntax new appendPath: 'etc' toPath: '/'"	"ShellSyntax new appendPath: 'hosts' toPath: '/etc'"	"ShellSyntax new appendPath: 'WINDOWS' toPath: 'C:\'"	"ShellSyntax new appendPath: 'someFileName' toPath: 'C:\WINDOWS'"	| newPath |	^ (aPathString findTokens: CommandShell pathSeparator)		inject: startingPathString		into: [:dirPath :nextPart | 			nextPart = '..'				ifTrue: [newPath := self upOneDirectoryLevel: dirPath]				ifFalse: [nextPart = '.'						ifTrue: [newPath := dirPath]						ifFalse: [newPath := (self isAtFileSystemRoot: dirPath)										ifTrue: [dirPath , nextPart]										ifFalse: [dirPath , CommandShell pathSeparator , nextPart]]].			newPath]! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 5/11/2002 20:15'!argsFromCommand: aString	"Answer a collection of strings from a whitespace delimited string. Single quote characters	protect substrings from expansion to tokens. Single quote characters may be escaped by	the backslash character to prevent this interpretation."	^ (self stringTokensFrom: aString) first! !!ShellSyntax methodsFor: 'private' stamp: 'dtl 8/7/2002 13:09'!canAccessOSProcess	"True if OSProcess is in the image and if the OSProcess plugin is functioning properly"	"ShellSyntax new canAccessOSProcess"	| osp |	^ (osp := Smalltalk at: #OSProcess ifAbsent: []) notNil and: [osp accessor canAccessSystem]! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 3/10/2001 18:07'!character: aCharacter matches: aToken	"Test if aCharacter is included in the characters of aToken, or if aToken is a #matchAny"	(aToken == #matchAny) ifTrue: [^ true].	^ aToken includes: aCharacter! !!ShellSyntax methodsFor: 'defaults' stamp: 'dtl 9/8/2001 10:15'!commentChar	^ $#! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 1/25/2013 19:23'!containsExpansionTokens: aString	"Answer true if aString contains wildcard expansion characters, or if it contains	anything that might be construed as a regular expression for globbing, or if it	contains path separator characters. If false, the sender may safely skip normal	glob expansion on aString."	^ aString includesAnyOf: {$? . $* . $[ . CommandShell pathNameDelimiter}! !!ShellSyntax methodsFor: 'accessing' stamp: 'dtl 12/16/2001 20:04'!cwdDictionary	"Current working directory paths indexed by device or file system name"	^ cwdDictionary ifNil: [cwdDictionary := Dictionary new]! !!ShellSyntax methodsFor: 'accessing' stamp: 'dtl 1/25/2013 19:08'!cwdIndex	"Key to current cwd path name in cwdDictionary"	^ cwdIndex ifNil: [cwdIndex := self cwdIndexFor: CommandShell defaultPathString]! !!ShellSyntax methodsFor: 'working directory' stamp: 'dtl 12/16/2001 20:06'!cwdIndex: aSymbol	"Key to current cwd path name in cwdDictionary"	cwdIndex := aSymbol! !!ShellSyntax methodsFor: 'working directory' stamp: 'dtl 12/17/2001 09:56'!cwdIndexFor: aPathStringWithPrefix	"Answer key to use for aPathStringWithPrefix"	| prefix |	prefix := (self splitLocationPrefixFromPath: aPathStringWithPrefix) first.	^ prefix isEmpty		ifTrue: [#default]		ifFalse: [prefix]! !!ShellSyntax methodsFor: 'working directory' stamp: 'dtl 1/3/2002 19:15'!defaultPathFor: aPathStringWithPrefix	"Answer a reasonable path string to use as a default"	^ self pathRoot: aPathStringWithPrefix! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 1/29/2013 20:29'!doItStringFrom: aCommandString	"Answer a string which can be evaluated as Smalltalk doIt, or nil."	| s |	s := CommandShell withBlanksTrimmed: aCommandString.	s last == $!!		ifTrue: [^ aCommandString copyUpToLast: $!!]		ifFalse: [^ nil]! !!ShellSyntax methodsFor: 'defaults' stamp: 'dtl 4/28/2002 16:09'!escapeChar	"The character to use to escape the normal interpretation of the following character	in a string."	^ $\! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/25/2013 19:12'!expandArgument: aString inDirectoryPath: aDefaultFileDirectoryPath	"Perform globbing expansion of a command argument. If argument is not a	pathname, use aDefaultFileDirectory as the context for globbing. Answer a	(possibly empty) collection of all matching paths relative to the default	directory path."	"ShellSyntax new expandArgument: 'ho?ts' inDirectoryPath: '/etc'"	"ShellSyntax new expandArgument: '/b?n/s?' inDirectoryPath: '/etc'"	"ShellSyntax new expandArgument: 'fs*' inDirectoryPath: '/etc'"	"ShellSyntax new expandArgument: 'NOSUCHFILE' inDirectoryPath: '/etc'"	"ShellSyntax new expandArgument: '/us*/b?n/v?' inDirectoryPath: '/etc'"	"ShellSyntax new expandArgument: 'b?n/v?' inDirectoryPath: '/usr'"	"ShellSyntax new expandArgument: nil inDirectoryPath: '/etc'"	| dirPath pathNames newArgs |	aString ifNil: [^ Array new: 0].	dirPath := (aDefaultFileDirectoryPath				ifNil: [self workingDirectory])					ifNil: [CommandShell defaultPathString].	pathNames := (self containsExpansionTokens: aString)				ifTrue: [self expandedPathsFrom: aString beginningAt: dirPath]				ifFalse: [OrderedCollection new].	newArgs := pathNames collect:				[:p | (aDefaultFileDirectoryPath notNil and: [p beginsWith: aDefaultFileDirectoryPath, CommandShell pathSeparator])					ifTrue: [(ReadStream on: p) next: aDefaultFileDirectoryPath size + CommandShell pathSeparator size; upToEnd]					ifFalse: [p]].	newArgs isEmpty ifTrue: [newArgs add: aString].	^ newArgs! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/25/2013 19:09'!expandArgumentsFrom: argArray inDirectoryPath: aDefaultFileDirectoryPath	"Perform globbing expansion of command arguments. For each argument which is not a	pathname, use aDefaultFileDirectory as the context for globbing."	"ShellSyntax new		expandArgumentsFrom: #('-help' '/b?n/s?' 'ho?ts' 'fs*' 'NOSUCHFILE')		inDirectoryPath: '/etc'"	"ShellSyntax new		expandArgumentsFrom: #('this' 'is' 'a' 'test' 'Sq*log' '/us*/b?n/v?')		inDirectoryPath: CommandShell defaultPathString"	"ShellSyntax new		expandArgumentsFrom: #('this' 'is' 'a' 'test' 'Sq*log' '/us*/b?n/v?')		inDirectoryPath: nil"	| newArgs |	newArgs := OrderedCollection new.	argArray do:		[:arg |		(self isFlagParameter: arg)			ifTrue:				[newArgs add: arg]			ifFalse:				[newArgs addAll: (self					expandArgument: arg					inDirectoryPath: aDefaultFileDirectoryPath)]].	^ newArgs! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/26/2013 15:40'!expandPathParts: pathParts beginningAt: root	"Walk directory tree and answer a collection of matching path strings."	| firstPart remainder dirPaths names dirNames basePath |	(pathParts size == 0)		ifTrue:			["Should never get here, but just in case"			^ Array with: root].	firstPart := pathParts first.	remainder := pathParts allButFirst.	(firstPart = '.')		ifTrue: "Stay at the current directory level"			[dirPaths := Array with: root]		ifFalse:			[(firstPart = '..') "Move up a directory level if possible"				ifTrue:					[dirPaths := Array with: (self upOneDirectoryLevel: root)]				ifFalse: "Normal case, a directory name"					[remainder isEmpty						ifTrue:							["This condition terminates recursion"							names := self glob: firstPart inDirectory: root.							^ (root = CommandShell pathSeparator)								ifTrue: [^ names collect: [:n | root, n]]								ifFalse: [^ names collect: [:n | root, CommandShell pathSeparator, n]]]						ifFalse:							["Continue recursion until no more elements"							CommandShell directoryNamesInPath: root.							dirNames := self glob: firstPart											names: (CommandShell directoryNamesInPath: root).							(('*', CommandShell pathSeparator) match: root)								ifTrue: [basePath := root]								ifFalse: [basePath := root, CommandShell pathSeparator].							dirPaths := dirNames collect: [:d | basePath, d]]]].		^ dirPaths			inject: OrderedCollection new			into: [:result :dir |				result addAll: (self expandPathParts: remainder beginningAt: dir).				result]! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 12/28/2002 09:48'!expandedPathsFrom: aPathString beginningAt: firstPartOfPath	"Answer a collection of all paths which match aPathString. If aPathString is a relative path,	expand the path relative to firstPartOfPath."	 "ShellSyntax new expandedPathsFrom: '/e*c/h*s' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: 'e*c/h*s' beginningAt: '/'"	 "ShellSyntax new expandedPathsFrom: '/usr/bin/vi' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: 'bin/vi' beginningAt: '/usr'"	 "ShellSyntax new expandedPathsFrom: '/usr/*/vi' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: '/usr/bin/../bin/./../bin/../../usr/bin/vi' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: '/bin/../bin/./../bin/../../usr/bin/vi' beginningAt: '/usr'"	 "ShellSyntax new expandedPathsFrom: '/usr/bin/../bin/./../bin/../../../../../usr/bin/vi' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: '../../../../../../usr/bin/vi' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: '/' beginningAt: '/'"	 "ShellSyntax new expandedPathsFrom: '*.image' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: 'C:\WINDOWS\*.*' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: '*.*' beginningAt: 'C:\WINDOWS'"	 "ShellSyntax new expandedPathsFrom: 'C:\*.*' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: 'C:\CONFIG.*' beginningAt: nil"	 "ShellSyntax new expandedPathsFrom: 'C:\CONFIG.*' beginningAt: '\'"	^ (self isAbsolutePath: aPathString)		ifTrue: [self expandedPathsFromAbsolutePath: aPathString]		ifFalse: [self expandedPathsFromRelativePath: aPathString beginningAt: firstPartOfPath]! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/25/2013 19:12'!expandedPathsFromAbsolutePath: anAbsolutePathString	"Answer a collection of all paths which match anAbsolutePathString."	 "ShellSyntax new expandedPathsFromAbsolutePath: '/e*c/h*s'"	 "ShellSyntax new expandedPathsFromAbsolutePath: 'e*c/h*s'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '/usr/bin/vi'"	 "ShellSyntax new expandedPathsFromAbsolutePath: 'bin/vi'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '/usr/*/vi'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '/usr/bin/../bin/./../bin/../../usr/bin/vi'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '/bin/../bin/./../bin/../../usr/bin/vi'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '/usr/bin/../bin/./../bin/../../../../../usr/bin/vi'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '../../../../../../usr/bin/vi'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '/'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '*.image'"	 "ShellSyntax new expandedPathsFromAbsolutePath: 'C:\WINDOWS\*.*'"	 "ShellSyntax new expandedPathsFromAbsolutePath: '*.*'"	 "ShellSyntax new expandedPathsFromAbsolutePath: 'C:\*.*'"	 "ShellSyntax new expandedPathsFromAbsolutePath: 'C:\CONFIG.*'"	 "ShellSyntax new expandedPathsFromAbsolutePath: 'C:\CONFIG.*'"	| result pathParts a prefix dirPathString root |	result := OrderedCollection new.	a := self splitLocationPrefixFromPath: anAbsolutePathString.	prefix := a at: 1.	dirPathString := a at: 2.	pathParts := dirPathString findTokens: CommandShell pathSeparator.	root := prefix, CommandShell pathSeparator.	result addAll: (self expandPathParts: pathParts beginningAt: root).	^ result! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/25/2013 19:12'!expandedPathsFromRelativePath: aPathString beginningAt: firstPartOfPath	"Answer a collection of all paths which match aPathString. Expand the path relative to firstPartOfPath."	 "ShellSyntax new expandedPathsFromRelativePath: 'e*c/h*s' beginningAt: '/'"	 "ShellSyntax new expandedPathsFromRelativePath: 'usr/b?n/vi' beginningAt: '/'"	 "ShellSyntax new expandedPathsFromRelativePath: 'bin/vi' beginningAt: '/usr'"	 "ShellSyntax new expandedPathsFromRelativePath: 'usr/*/vi' beginningAt: nil"	 "ShellSyntax new expandedPathsFromRelativePath: 'usr/bin/../bin/./../bin/../../usr/bin/vi' beginningAt: '/'"	 "ShellSyntax new expandedPathsFromRelativePath: 'bin/../bin/./../bin/../../usr/bin/vi' beginningAt: '/usr'"	 "ShellSyntax new expandedPathsFromRelativePath: '../../../../../../usr/bin/vi' beginningAt: '/'"	 "ShellSyntax new expandedPathsFromRelativePath: '*.image' beginningAt: nil"	 "ShellSyntax new expandedPathsFromRelativePath: '*.*' beginningAt: 'C:\WINDOWS'"	| result pathParts root |	result := OrderedCollection new.	pathParts := aPathString findTokens: CommandShell pathSeparator.	root := firstPartOfPath isNil				ifTrue: [CommandShell defaultPathString]				ifFalse: [firstPartOfPath].	result addAll: (self expandPathParts: pathParts beginningAt: root).	^ result! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 4/19/2015 09:34'!findExecutablePathFor: aString inDirectoryPath: pathString	"Look for the executable, following Unix conventions for searching the PATH.	If no likely candidate is found, answer nil."	"ShellSyntax new findExecutablePathFor: 'bash' inDirectoryPath: nil"	"ShellSyntax new findExecutablePathFor: 'ReadMe.txt' inDirectoryPath: nil"	"ShellSyntax new findExecutablePathFor: 'SqueakDebug.log' inDirectoryPath: nil"	"ShellSyntax new findExecutablePathFor: 'noSuchFileName' inDirectoryPath: nil"	"ShellSyntax new findExecutablePathFor: 'a' inDirectoryPath: nil"	"ShellSyntax new findExecutablePathFor: 'sqcat' inDirectoryPath: '/home/lewis/bin'"	| delimiter path localNames fullName fileExists |	self canAccessOSProcess ifFalse: [^ nil].	delimiter := CommandShell pathNameDelimiter.	path := (pathString				ifNil: [self workingDirectory])					ifNil: [CommandShell defaultPathString].	"Unix compatibility note: If aString contains wildcard characters,	it is expanded in the context of the current working directory. Expansion	does not take place in the context of the PATH directories."	(aString includes: delimiter)		ifTrue:			["A fully or partially qualified path, do not search PATH"			^ (self expandedPathsFrom: aString beginningAt: pathString)				detect: [:fileName |					(CommandShell fileExists: fileName inPath: path) and: [self isExecutable: fileName]]				ifNone: [nil]]		ifFalse:			["Look for the file in the PATH locations"			localNames := self glob: aString inDirectory: path.			(localNames size == 0)				ifTrue:					["Name was not expanded, so use the unmodified value of aString"					localNames := Array with: aString].			(self pathEntriesInDirectoryPath: path)				do: [:pathName |					localNames						do: [:fileName |							fileExists := [ CommandShell useFileSystem									ifTrue: [ CommandShell fileExists: fileName inDirectory: (pathName perform: #asFileReference) ]									ifFalse: [ CommandShell fileExists: fileName inDirectory: ((Smalltalk at: #FileDirectory) on: pathName) ]								] on: (Smalltalk at: #InvalidDirectoryError ifAbsent: [ Error ]) "Pharo does not have InvalidDirectoryError"									do: [:e | false].							fileExists ifTrue:								[fullName := pathName, CommandShell pathSeparator, fileName.								(self isExecutable: fullName)									ifTrue: [^ fullName]]]].			^ nil]! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/29/2013 20:27'!firstExpandedArgument: aString inDirectoryPath: aPath	"Expand a single argument and answer a fully qualified path to the first matching	name. If no match, answer the literal path and file name (which does not exist).	If aString is nil, answer an empty string. This method may be used to expand a single	argument, such as the target for a command output redirection, where the target is	expected to resolve to a single file name."	"ShellSyntax new firstExpandedArgument: 'b?*h' inDirectoryPath: '/usr/bin'"	"ShellSyntax new firstExpandedArgument: 'b?*h' inDirectoryPath: '/no/such/directory'"	"ShellSyntax new firstExpandedArgument: 'no*such*file???' inDirectoryPath: '/usr/bin'"	"ShellSyntax new firstExpandedArgument: '/usr/bin/vi' inDirectoryPath: '/usr/bin'"	"ShellSyntax new firstExpandedArgument: '../bin/vi' inDirectoryPath: '/usr/bin'"	"ShellSyntax new firstExpandedArgument: '../b?n' inDirectoryPath: '/usr/bin'"	"ShellSyntax new firstExpandedArgument: nil inDirectoryPath: '/usr/bin'"	| expanded path trimmedString |	aString ifNil: [^ ''].	trimmedString := CommandShell withBlanksTrimmed: aString.	expanded := self expandArgument: trimmedString inDirectoryPath: aPath.	path := expanded isEmpty			ifTrue: [trimmedString]			ifFalse: [expanded first].	^ self newPathFor: path fromDefault: aPath! !!ShellSyntax methodsFor: 'working directory' stamp: 'dtl 12/17/2001 09:52'!getCwdForPath: aPathString	| prefix |	prefix := (self splitLocationPrefixFromPath: aPathString) first.	^ prefix isEmpty		ifTrue: [self workingDirectory]		ifFalse: [self cwdDictionary at: prefix ifAbsentPut: [self defaultPathFor: aPathString]]! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 10/13/2008 20:02'!glob: aString	"Apply Unix shell globbing rules to aString, and answer an array of matching	file names."	"ShellSyntax new glob: 'ReadMe.txt'"	"ShellSyntax new glob: 'rEADmE.TXT'"	"ShellSyntax new glob: 'R*dM?.txt'"	^ self glob: aString inDirectory: self workingDirectory! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 1/26/2013 14:03'!glob: aString inDirectory: directoryPath	"Apply Unix shell globbing rules to aString, and answer an array of matching	file names."	"ShellSyntax new glob: 'ReadMe.txt' inDirectory: FileDirectory default pathName"	"ShellSyntax new glob: 'SqueakDebug.log' inDirectory: FileDirectory default pathName"	"ShellSyntax new glob: '?queak*.[0-9].log' inDirectory: FileDirectory default pathName"	"ShellSyntax new glob: '*image*' inDirectory: FileDirectory default pathName"	"ShellSyntax new glob: 'noSuchFileName' inDirectory: FileDirectory default pathName"	"ShellSyntax new glob: 'b?n' inDirectory: '/usr'"	[^ self glob: aString names: (CommandShell directoryEntryNames: directoryPath)]		on: Error		do: [:ex | ^ #()]! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 3/11/2001 17:37'!glob: aString names: fileNameArray	"Apply Unix shell globbing rules to aString with respect to the elements of fileNameArray,	and answer an array of matching file names. The fileNameArray is expected to have been	provided by a FileDirectory query."	| tokens |	tokens := self globTokensFrom: aString.	^ fileNameArray		select: [:n |			self tokenStream: (ReadStream on: tokens)				matches: (ReadStream on: n)]! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 2/24/2013 10:25'!globRangeFrom: aString tokenStream: aTokenStream	"Answer a string containing the characters specified by a range expression	such as [a-z]. Sorry, this is just a simple implementation which assumes ASCII."	| r w c t |	(aString includes: $-) ifFalse: [^ aString]. "Simple case"	r := ReadStream on: aString.	w := WriteStream on: String new.	(r peek == $!!) ifTrue:		[r next.		aTokenStream nextPut: #not].	[r atEnd] whileFalse: [		c := r next.		(r peek == $-)			ifTrue: [r next.					t := r next.					(c asciiValue to: t asciiValue) do:						[:e | w nextPut: (Character value: e)]]			ifFalse: [w nextPut: c]].	^ w contents! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 12/17/2001 11:41'!globTokensFrom: aString	"Answer a collection of tokens to be used for glob matching."	"ShellSyntax new globTokensFrom: 'abc?def\ghi\?jkl*mno\*pqr[hello]there[Xa-eY]Z[!!A-Z]end'"	| lastToken r w t |	lastToken := nil.	r := ReadStream on: aString.	w := WriteStream on: #().	[r atEnd] whileFalse:		[t := self nextGlobToken: r lastToken: lastToken tokenStream: w.		(t ~~ #escape) ifTrue: [w nextPut: t].		lastToken := t].	^ w contents! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 1/25/2013 19:12'!isAbsolutePath: aPathString	"Answer true if aPathString is specified relative to the root of the file system."	"ShellSyntax new isAbsolutePath: 'not/absolute/path'"	"ShellSyntax new isAbsolutePath: '/absolute/path'"	"ShellSyntax new isAbsolutePath: '/'"	"ShellSyntax new isAbsolutePath: 'C:\'"	"ShellSyntax new isAbsolutePath: '\'"	"ShellSyntax new isAbsolutePath: 'C:'"	"ShellSyntax new isAbsolutePath: 'C:WINDOWS'"	"ShellSyntax new isAbsolutePath: 'C:\WINDOWS'"	| prefixAndPath path |	^ ((((CommandShell pathSeparator, '*') match: aPathString)		or:	[prefixAndPath := self splitLocationPrefixFromPath: aPathString.			(CommandShell pathSeparator, '*') match: (path := prefixAndPath last)])				or: [prefixAndPath first isEmpty not and: [path isEmpty]]) "One above the root of a Win32 file system tree"! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 1/25/2013 19:12'!isAtFileSystemRoot: aPathString	"Answer true if aPathString is not a subdirectory."	"ShellSyntax new isAtFileSystemRoot: 'D:\'"	"ShellSyntax new isAtFileSystemRoot: 'D:'"	"ShellSyntax new isAtFileSystemRoot: 'D:\Windows'"	"ShellSyntax new isAtFileSystemRoot: '\'"	^ (CommandShell pathSeparator = (self splitLocationPrefixFromPath: aPathString) last) or: [aPathString isEmpty]! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 1/21/2007 14:07'!isComment: aString	"Answer true if aString is empty or if its first non-space character is commentChar"	^ (aString size == 0)		or:			[aString do: [:e | (e isSeparator not)							ifTrue: [^ e == self commentChar]].			false]! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 1/28/2013 00:03'!isDirectoryPath: aPathString	| fullPath localName entry |	^ (('*', CommandShell pathSeparator) match: aPathString) or:		[fullPath := CommandShell fullNameFor: aPathString.		localName := CommandShell localNameFor: fullPath.		[entry := CommandShell useFileSystem			ifTrue: [entry := ((CommandShell dirPathFor: fullPath) perform: #asFileReference) entries						detect: [:e | e basename = localName] ifNone: [nil]]			ifFalse: [entry := ((Smalltalk at: #FileDirectory) on: (CommandShell dirPathFor: fullPath)) entries						detect: [:e | e name = localName] ifNone: [nil]]]					on: Error					do: [: ex | ^false].		entry notNil and: [entry isDirectory]]! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 1/29/2013 20:29'!isDoItCommand: aCommandString	"Answer true if aCommandString should be evaluated as Smalltalk doIt."	^ (CommandShell withBlanksTrimmed: aCommandString) last == $!!! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 8/7/2002 13:36'!isExecutable: aPath 	"Answer true if aPath points to an executable file. This could be 	enhanced to support setting UID and GID for a CommandShell session. 	For now, just take the default for the current Squeak process."	^ aPath notNil		and: [(Smalltalk				at: #OSProcess				ifPresent: [:osp | osp accessor isExecutable: aPath])				ifNil: [false]]! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 1/21/2007 14:12'!isFlagParameter: aString	"Answer true if aString begins with $- (the convention for command flags for Unix)"	^ (aString size > 0) and: [(aString at: 1) == $-]! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 9/4/2013 08:35'!isPharo3AndLater	"True if this image is a pharo of major version 3 or greater"	Smalltalk		at: #SystemVersion		ifPresent: [:cls | ((cls canUnderstand: #type) and: [ cls canUnderstand: #major ])			ifTrue: [^ cls current type = 'Pharo' and: [ cls current major >= 3 ]]].	^false! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 4/20/2003 11:31'!newDirPath: aPath from: initialPath	"Answer a path string for a change directory command. Change from initialPath	(usually the current working directory) to the new path, where aPath may be	either an absolute path name (fully specified from the root) or a relative path	name (relative to initialPath)."	"self new newDirPath: 'b?n' from: '/usr'"	"self new newDirPath: '..' from: '/usr/bin'"	"self new newDirPath: '.././bin' from: '/usr/bin'"	"self new newDirPath: '../../../../..' from: '/usr/bin'"	"self new newDirPath: '../../../../../usr' from: '/usr/bin'"	^ (self expandedPathsFrom: aPath beginningAt: initialPath)		at: 1		ifAbsent: [nil]! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/2/2002 22:09'!newPathFor: aPathString fromDefault: startingPathString	"Answer a new path starting from startingPathString if aPathString is a,	relative path, otherwise just answer aPathString unmodified."	"ShellSyntax new newPathFor: 'hosts' fromDefault: '/etc'"	"ShellSyntax new newPathFor: 'three' fromDefault: 'one/two'"	"ShellSyntax new newPathFor: 'one/two/three' fromDefault: ''"	"ShellSyntax new newPathFor: '/hosts' fromDefault: '/etc'"	"ShellSyntax new newPathFor: 'WINDOWS' fromDefault: 'C:\'"	"ShellSyntax new newPathFor: 'D:\WINDOWS' fromDefault: 'C:\'"	"ShellSyntax new newPathFor: 'D:WINDOWS' fromDefault: 'C:\'"	^ (self isAbsolutePath: aPathString)		ifTrue:			[aPathString]		ifFalse:			[self appendPath: (self splitLocationPrefixFromPath: aPathString) last					toPath: startingPathString]! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 12/15/2001 09:55'!nextGlobToken: aStream lastToken: aToken tokenStream: aTokenStream	"Escape character processing probably belongs elsewhere. Since it can conflict	with Win32 file name conventions, I have commented it out here. The code	is otherwise left alone here in case I change my mind later. -dtl"	| c |	(aToken == #escape)		ifTrue:			[^ aStream next]		ifFalse:			[c := aStream next.			(c == $[)				ifTrue:					["character range"					^ self globRangeFrom: (aStream upTo: $]) tokenStream: aTokenStream]				ifFalse:					[(c == $*) ifTrue: [^ #matchRun].					(c == $?) ifTrue: [^ #matchAny].					"(c == $\) ifTrue: [^ #escape].	Escape processing disabled here"					^ c asString]]! !!ShellSyntax methodsFor: 'defaults' stamp: 'dtl 1/20/2007 14:11'!noWaitToken	"This character at the end of a command string means execute as detached process."	^ '&'! !!ShellSyntax methodsFor: 'working directory' stamp: 'dtl 4/20/2003 11:50'!nullDirectoryString	"String to display when the current directory is one level above the file system root."	^ '[]'! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 1/25/2013 19:13'!pathAboveRoot	"Answer a path pointing to a location above the file system root. The	pathStringAboveRoot string refers to this location."	 "ShellSyntax new pathAboveRoot"	^ (self platformName = 'Win32')		ifTrue: ['']		ifFalse: [CommandShell pathSeparator].! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 1/25/2013 19:09'!pathEntriesInDirectoryPath: basePath	"Answer a possibly empty collection of path entries from a colon-delimited path	string provided by the operating system. Relative path names are interpreted relative	to basePath"	"ShellSyntax new pathEntriesInDirectoryPath: CommandShell defaultPathString"	^ (Smalltalk at: #OSProcess ifPresent:		[:osp |		(osp thisOSProcess path findTokens: ':')			collect:				[:e | self newPathFor: e fromDefault: basePath]])		ifNil: [Array new].! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 1/25/2013 19:13'!pathRoot: aPathString	"For aPathString pointing to a file in a file system, answer the root of the	file system. This method works fine for Unix and Windows, but may require	conditional code for other platforms."	| prefix |	prefix := (self splitLocationPrefixFromPath: aPathString) first.	^ prefix, CommandShell pathSeparator! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 1/4/2002 21:19'!pathStringAboveRoot	"Magic string indicating location above the file system root. For Unix, this just	points to the file system root. For Windows, it points to one level above the C: drive."	^ '[]'! !!ShellSyntax methodsFor: 'defaults' stamp: 'dtl 9/8/2001 10:16'!pipeCharToken	"The command pipeline character"	^ '|'! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 9/4/2013 08:34'!platformName 	"After Squeak version 3.6, #platformName was moved to SmalltalkImage Some	versions of Pharo move this to OSPlatform and issue deprecation warnings	about the other usages."	"self new platformName"	self isPharo3AndLater		ifTrue: [ ^ (Smalltalk perform: #os) name ].	^ (((Smalltalk hasClassNamed: #OSPlatform)			and: [(Smalltalk at: #OSPlatform)					respondsTo: #platformName])		ifTrue: [Smalltalk at: #OSPlatform]		ifFalse: [((Smalltalk classNamed: 'SmalltalkImage')				ifNil: [^ Smalltalk osVersion]) current]) platformName! !!ShellSyntax methodsFor: 'path name expansion' stamp: 'dtl 10/13/2008 06:26'!programNameAndArgumentsFrom: aString inDirectoryPath: pathString findExecutable: expandExePath	"Answer an array with the name of the program to run, and with the expanded	arguments list. If expandExePath is true, search the file system for an executable	program to run, otherwise use the literal command name."	"ShellSyntax new		programNameAndArgumentsFrom: 'sleep 6'		inDirectoryPath: '/etc'		findExecutable: true"	"ShellSyntax new		programNameAndArgumentsFrom: 'sleep 6'		inDirectoryPath: '/etc'		findExecutable: false"	"ShellSyntax new		programNameAndArgumentsFrom: 'ls -l h?s*'		inDirectoryPath: '/etc'		findExecutable: true"	| tokens tok args exe |	tokens := self argsFromCommand: aString.	tokens size == 0		ifTrue: [tok := '']		ifFalse: [tok := tokens at: 1].	args := self		expandArgumentsFrom: (tokens copyFrom: 2 to: tokens size)		inDirectoryPath: pathString.	exe := expandExePath		ifTrue: [self findExecutablePathFor: tok inDirectoryPath: pathString]		ifFalse: [tok].	^ exe ifNotNil: [Array with: exe with: args]! !!ShellSyntax methodsFor: 'defaults' stamp: 'dtl 4/27/2002 18:57'!quoteChar	"In a Unix shell, this character is used to delimit chunks of text which should not	be expanded with wildcards or shell variables. In a Smalltalk compiler, this character	delimits a String. ShellSyntax interprets it as a delimiter for a  literal string which	should not be expanded or interpreted in any way."	^ $'! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 12/22/2007 10:17'!redirectIOFor: commandString inDirectoryPath: dirPathString	"Handle IO redirection. Answer a four element array with the command string	(with IO tokens removed); and stdin, stdout and stderr if specified for	redirection."	"ShellSyntax new		redirectIOFor: 'ls /tmp /NOSUCHFILE > /tmp/sqTempOut.tmp 2> /tmp/sqTempErr.tmp'		inDirectoryPath: nil"	"ShellSyntax new		redirectIOFor: 'cat < /etc/hosts > /tmp/sqHosts.tmp'		inDirectoryPath: nil"	| cmd tokenStream tok target input output error |	cmd := nil.	input := output := error := nil.	"Default to nil unless overridden by commandString."	tokenStream := ReadStream on: (self tokenizeForRedirect: commandString).	[tokenStream atEnd]		whileFalse:			[tok := tokenStream next.			tok == #inputRedirect				ifTrue: ["Do input redirection"					target := self firstExpandedArgument: tokenStream next								inDirectoryPath: dirPathString.					"Use StandardFileStream to prevent multi-byte interpretation."					input := StandardFileStream readOnlyFileNamed: target.					input						ifNil: [self inform: 'Cannot open ' , target , ', using default stdin']]				ifFalse: [tok == #outputRedirect						ifTrue: ["Do output redirection"							target := self firstExpandedArgument: tokenStream next										inDirectoryPath: dirPathString.							output := self truncatedOutputFile: target.							output ifNil:									[self inform: 'Cannot open ' , target , ', using default stdout']]						ifFalse: [tok == #outputAppendRedirect								ifTrue: ["Do output redirection, appended to existing output file if any."									target := self firstExpandedArgument: tokenStream next												inDirectoryPath: dirPathString.									output := FileStream fileNamed: target.									output isNil										ifTrue: [self inform: 'Cannot open ' , target , ', using default stdout']										ifFalse: [output setToEnd]]								ifFalse: [tok == #errorRedirect										ifTrue: ["Do error redirection"											target := self firstExpandedArgument: tokenStream next														inDirectoryPath: dirPathString.											error := self truncatedOutputFile: target.											error ifNil:													[self inform: 'Cannot open ' , target , ', using default stdout']]										ifFalse: [tok == #errorAppendRedirect												ifTrue: ["Do error redirection, appended to existing error file if any. "													target := self firstExpandedArgument: tokenStream next																inDirectoryPath: dirPathString.													error := FileStream fileNamed: target.													error isNil														ifTrue: [self inform: 'Cannot open ' , target , ', using default stdout']														ifFalse: [error setToEnd]]												ifFalse: [cmd isNil														ifTrue: [cmd := tok]														ifFalse: [self inform: 'Ack!! Pfft!! IO redirection parsing error.']]]]]]].	^ Array		with: cmd		with: input		with: output		with: error! !!ShellSyntax methodsFor: 'working directory' stamp: 'dtl 12/16/2001 21:26'!setCwdIndexFrom: aPathString	"Set the current working directory index to a string (Win32 device name) or to #default."	| prefix |	prefix := (self splitLocationPrefixFromPath: aPathString) first.	prefix isEmpty		ifTrue: [self cwdIndex: #default]		ifFalse: [self cwdIndex: prefix]! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 10/30/2007 18:59'!splitLocationPrefixFromPath: aPathString	"Split any leading prefix from a path string, such as the C: device name	for Win32. Answer an Array with prefix and path."	 "ShellSyntax new splitLocationPrefixFromPath: 'C:\u'"	 "ShellSyntax new splitLocationPrefixFromPath: 'C:\'"	 "ShellSyntax new splitLocationPrefixFromPath: 'C:'"	 "ShellSyntax new splitLocationPrefixFromPath: 'C:u'"	 "ShellSyntax new splitLocationPrefixFromPath: 'c:u'"	 "ShellSyntax new splitLocationPrefixFromPath: '\u'"	| prefix path |	(self platformName = 'Win32')		ifTrue:			[((aPathString at: 2 ifAbsent: []) == $:)				ifTrue:					[prefix := (String new: 2).					prefix at: 1 put: (aPathString at: 1) asUppercase.					prefix at: 2 put: $:.					path := aPathString copyAfter: $:]				ifFalse:					[prefix := ''.					path := aPathString]]		ifFalse:			[prefix := ''.			path := aPathString].	^ Array with: prefix with: path! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 1/29/2013 20:27'!splitPipelineCommands: aCommand	"Answer a list of the individual commands in a command pipeline string,	delimited by the pipe character."	^ (aCommand findTokens: self pipeCharToken) collect: [:e | CommandShell withBlanksTrimmed: e]! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 1/21/2007 15:11'!stringTokensFrom: aString	"Answer a two element array with a collection of strings from a whitespace	delimited string, and with an optional error message. Single quote characters	protect substrings from expansion to tokens. Single quote characters may be	escaped by the backslash character to prevent this interpretation."	| result r w errorMessage quoteEnabled t |	result := OrderedCollection new.	r := ReadStream on: aString.	w := WriteStream on: String new.	errorMessage := nil.	(quoteEnabled := r peek == self quoteChar) ifTrue: [r next].	[r atEnd] whileFalse:		[t := r next.		(t == self quoteChar)			ifTrue:				[quoteEnabled := quoteEnabled not]			ifFalse:				[quoteEnabled					ifTrue:						[w nextPut: t]					ifFalse:						[(t == self escapeChar)							ifTrue:								["An escaped character is treated as a literal character."								t := r next.								t isNil									ifTrue: ["FIXME: This would indicate an escaped end of line"]									ifFalse: [w nextPut: t]]							ifFalse:								[t isSeparator									ifTrue:										["Whitespace delimits tokens."										(w isEmpty) ifFalse: [result add: w contents].										w := WriteStream on: String new.										[r peek notNil and: [r peek isSeparator]] whileTrue: [r next].]									ifFalse:										[w nextPut: t]]]]].	quoteEnabled ifTrue: [errorMessage := 'unbalanced quotes'].	(w isEmpty) ifFalse: [result add: w contents].	^ Array with: result with: errorMessage! !!ShellSyntax methodsFor: 'globbing' stamp: 'dtl 1/5/2002 09:52'!tokenStream: aTokenStream matches: aCharacterStream 	"Iterate over both streams. If each character in aCharacterStream 	matches its corresponding token in tokenStream, answer true."	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'a?c')) matches: (ReadStream on: 'abc')"	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'ab*cde')) matches: (ReadStream on: 'abcde')"	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'ab*cde')) matches: (ReadStream on: 'abXXXcde')"	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'ab*cdX')) matches: (ReadStream on: 'abXXXcde')"	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'abc*')) matches: (ReadStream on: 'abcde')"	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'abc*')) matches: (ReadStream on: 'abc')"	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'a?cde*jkl')) matches: (ReadStream on: 'abcdefghijkl')"	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'abc[A-C]xyz')) matches: (ReadStream on: 'abcBxyz')"	"ShellSyntax new tokenStream: (ReadStream on: (ShellSyntax new globTokensFrom: 'abc[!!A-C]xyz')) matches: (ReadStream on: 'abcZxyz')"	| c tok |	[aCharacterStream atEnd]		whileFalse: [aTokenStream atEnd				ifTrue: [^ false].			c := aCharacterStream peek.			tok := aTokenStream next.			tok == #not				ifTrue: ["A negated character range follows"					tok := aTokenStream next.					(self character: c matches: tok)						ifTrue: [^ false].					aCharacterStream next]				ifFalse: ["The normal case"					tok == #matchRun						ifTrue:							["Skip characters until we resync the streams, or answer false"							[self tokenStream: aTokenStream copy matches: aCharacterStream copy]								whileFalse:									[aCharacterStream atEnd ifTrue: [^ false].									aCharacterStream next]]						ifFalse: [(self character: c matches: tok)								ifFalse: [^ false].							aCharacterStream next]]].	^ aTokenStream atEnd		or: [aTokenStream next == #matchRun				and: [aTokenStream atEnd]]! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 2/24/2013 10:25'!tokenizeForRedirect: aString	"Answer a collection of tokens for IO redirection. Answers a collection of	tokens, where each token is either a String, or a Symbol in:	#(#inputRedirect #outputRedirect #outputAppendRedirect #errorRedirect #errorAppendRedirect)"	"ShellSyntax new tokenizeForRedirect: 'one > two < three 2> four five six 2>> seven eight > nine ten >> eleven twelve 2 > thirteen'"	| oc rs ws c redirectToken tok |	oc := OrderedCollection new.	rs := ReadStream on: aString.	ws := WriteStream on: String new.	[rs atEnd]		whileFalse:			[c := rs next.			((c == $2) and: [rs peek == $>])				ifTrue:					[rs next.					(rs peek == $>)						ifTrue:							[rs next.							redirectToken := #errorAppendRedirect]						ifFalse:							[redirectToken := #errorRedirect].					c := ws contents.					(c size > 0)						ifTrue:							[oc add: c.							ws resetContents].					oc add: redirectToken]				ifFalse:					[(c == $>)						ifTrue:							[(rs peek == $>)								ifTrue:									[rs next.									redirectToken := #outputAppendRedirect]								ifFalse:									[redirectToken := #outputRedirect].							c := ws contents.							(c size > 0)								ifTrue:									[oc add: c.									ws resetContents].							oc add: redirectToken]						ifFalse:							[(c == $<)								ifTrue:									[c := ws contents.									(c size > 0)										ifTrue:											[oc add: c.											ws resetContents].									oc add: #inputRedirect]								ifFalse: [ws nextPut: c]]]].	tok := ws contents.	(tok size > 0) ifTrue: [oc add: tok].	^ oc! !!ShellSyntax methodsFor: 'command string parsing' stamp: 'dtl 12/17/2001 11:39'!truncatedOutputFile: fileName	"Attempt to do reasonable things to open a file of size zero. Better would be	to implement a file truncation primitive."	"ShellSyntax new truncatedOutputFile: '/tmp/delete.me'"	"ShellSyntax new truncatedOutputFile: '/dev/null'"	| strm |	[strm := FileStream concreteStream forceNewFileNamed: fileName]		on: Error		do: [:ex | ^ FileStream fileNamed: fileName].	^ strm! !!ShellSyntax methodsFor: 'platform dependent' stamp: 'dtl 1/25/2013 19:23'!upOneDirectoryLevel: aPathName	"Answer a path name for a directory one level up the directory tree"	 "ShellSyntax new upOneDirectoryLevel: 'C:\Windows\temp'"	 "ShellSyntax new upOneDirectoryLevel: 'C:\Windows'"	 "ShellSyntax new upOneDirectoryLevel: 'C:\'"	 "ShellSyntax new upOneDirectoryLevel: ''"	 "ShellSyntax new upOneDirectoryLevel: '/usr/bin'"	 "ShellSyntax new upOneDirectoryLevel: '/usr'"	 "ShellSyntax new upOneDirectoryLevel: '/'"	 "ShellSyntax new upOneDirectoryLevel: 'usr'"	 "ShellSyntax new upOneDirectoryLevel: ''"	| prefixAndPath prefix path newPath |	prefixAndPath := self splitLocationPrefixFromPath: aPathName.	prefix := prefixAndPath at: 1.	path := prefixAndPath at: 2.	(self isAtFileSystemRoot: aPathName)		ifTrue:			[(self isAbsolutePath: aPathName)				ifTrue:					[prefix isEmpty						ifTrue: "Normal case, unix. Do not go up a level."							[^ aPathName]						ifFalse: "A Win32 device name, go up a level above the file systems"							[^ '']]				ifFalse:					["One level above whererever we are. Unfortunately we have					no way to know where we are, so this probably should be treated					as a sytax error."					^ '..']]		ifFalse:			[newPath := (path includes: CommandShell pathNameDelimiter)				ifTrue: [path copyUpToLast: CommandShell pathNameDelimiter]				ifFalse: [''].			^ newPath isEmpty				ifTrue:					[(self isAbsolutePath: aPathName)						ifTrue: [prefix, CommandShell pathSeparator]						ifFalse: [prefix]]				ifFalse:					[prefix, newPath]]! !!ShellSyntax methodsFor: 'working directory' stamp: 'dtl 8/7/2002 13:32'!workingDirectory	^ self cwdDictionary at: self cwdIndex ifAbsentPut:		[Smalltalk at: #OSProcess ifPresent: [:osp | osp thisOSProcess getCwd]]! !!ShellSyntax methodsFor: 'working directory' stamp: 'dtl 12/16/2001 21:32'!workingDirectory: aPathString	self setCwdIndexFrom: aPathString.	self cwdDictionary at: self cwdIndex put: aPathString! !!CommandShell class methodsFor: 'instance creation' stamp: 'dtl 12/11/2007 21:22'!command: aCommandString	"Evaluate aCommandString in the context of a CommandShell, using a	CommandShellTranscript to display the results."	"CommandShell command: 'help'"	"CommandShell command: 'ls'"	| cs w |	cs := self new.	w := cs openLabel: self defaultWindowName.	w scheduleToEvaluate: [w nextPutAll: aCommandString; cr].	w processCommand: aCommandString.	^ w! !!CommandShell class methodsFor: 'documentation' stamp: 'dtl 12/29/2001 14:18'!commandProcessing	"Explanation of the command parsing and evaluation."	"CommandShell new pipeline: 'CommandShell commandProcessing!! | edit'"	^'CommandShell behaves similarly to a Unix command shell. One or more Morphic or MVC views can be opened on an instance of CommandShell. Command lines are accepted in the view, passed to the CommandShell instance (the model), and the results are displayed in the view(s). The overall behavior can be thought of as a Transcript acting like an xterm window, and the CommandShell acting like a /bin/sh shell.A command line is first evaluated as a Smalltalk expression if possible. If this evaluation fails, either as a result of a sytax error or a runtime error, it is assumed to be a command string with syntax similar to that of a Unix command shell.The command line is parsed by CommandShell to break command lines into elements of a command pipeline. All further parsing, such as file name expansion, is performed by an instance of ShellSyntax.Three types of commands may be executed from a CommandShell:1) Internal "builtin" commands are implemented in Smalltalk, and behave similarly to the shell builtin commands of a typical Unix command shell. See protocol category "shell builtins" for the implementation of these builtin shell commands.2) Internal "doIt" commands are simple Smalltalk expression strings, terminated by a $!! character, which are evaluated as Smalltalk expressions, and which recognize the tokens "stdin", "stdout", and "stderr" as temporary variables in the doIt expression. An internal doIt command is evaluated such that it may be incorporated into a command pipeline with access to the stdin/stdout/stderr streams used in the command pipeline. In the current implementation, a doIt command may not include a $| character, which has meaning both for Smalltalk syntax and for Unix command line processor syntax.3) External commands. Any command expression not recognized as a shell builtin or as a doIt expression is passed to an external process proxy for execution by the external operating system, with stdin/stdout/stderr incorporated into the command pipeline.Internal and external commands can be freely mixed in a command pipeline, with results which should be familiar to users of Unix command shells. Pipes are implemented as instances of OSPipe or InternalPipe, and are capable of passing streams of characters from one process proxy to the next. All commands (internal or external) evaluate to strings, such that their results can either be passed through a pipe to the next command proxy in a pipeline, or displayed in the terminal window view if the proxy represents the last command in a command pipeline. Error messages (also strings) are written to an errorPipelineStream which is shared by all proxies in a command pipeline, such that any error messages are accumulated for the entire command pipeline.'! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/26/2013 15:37'!defaultPathString	^ self useFileSystem		ifTrue: [(((Smalltalk at: #Path) perform: #workingDirectory) perform: #asFileReference) pathString]		ifFalse: [(Smalltalk at: #FileDirectory) default pathName]! !!CommandShell class methodsFor: 'defaults' stamp: 'dtl 4/2/2001 20:48'!defaultWindowName	^ 'Squeak Shell'! !!CommandShell class methodsFor: 'version dependent' stamp: 'SeanDeNigris 2/13/2013 09:51'!deleteFileNamed: fileName	"Delete the file with the given name."	self useFileSystem		ifTrue: [ | file |			file := fileName perform: #asFileReference.			(file respondsTo: #ensureDeleted)				ifTrue: [ file perform: #ensureDeleted ]				ifFalse: [ file perform: #delete ] ]		ifFalse: [ (Smalltalk at: #FileDirectory) default				deleteFileNamed: fileName ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 18:00'!deleteFileNamed: fileName inDirectory: directoryOrFileReference	"Delete the file with the given name in the given directory."	^ self useFileSystem		ifTrue: [(directoryOrFileReference files						detect: [:e | e basename = fileName ]						ifNone: [ ])					ifNotNilDo: [:f | f delete ]]		ifFalse: [ directoryOrFileReference deleteFileNamed: fileName ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 17:59'!dirPathFor: path	"Return the directory part the given name."	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) parent fullName ]		ifFalse: [(Smalltalk at: #FileDirectory) perform: #dirPathFor: with: path]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/26/2013 15:38'!directoryEntryNames: path	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) children collect: [:e | e perform: #basename] ]		ifFalse: [ ((Smalltalk at: #FileDirectory) on: path) entries collect: [:e | e name] ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 17:59'!directoryExists: path	"Answer true if a directory of the given name exists. The given name may	be either a full path name or a local directory within this directory."	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) exists ]		ifFalse: [ (Smalltalk at: #FileDirectory) default directoryExists: path ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 22:31'!directoryForPath: path	^ self useFileSystem		ifTrue: [path perform: #asFileReference]		ifFalse: [(Smalltalk at: #FileDirectory) on: path]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/26/2013 15:38'!directoryNamesInPath: path	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) children						select: [:e | e isDirectory ]					thenCollect: [:e | e perform: #basename] ]		ifFalse: [ ((Smalltalk at: #FileDirectory) on: path) entries					select: [:e | e isDirectory ]					thenCollect: [:e | e name] ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/28/2013 20:12'!entryName: directoryEntry	"Answer the name of a directory entry."	^ self useFileSystem		ifTrue: [ directoryEntry basename ]		ifFalse: [ directoryEntry name ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 17:57'!fileExists: path	"Answer true if a file of the given name exists. The given name may be	either a full path name or a local file within this directory."	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) exists ]		ifFalse: [ (Smalltalk at: #FileDirectory) default fileExists: path ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 17:57'!fileExists: fileName inDirectory: directoryOrFileReference	"Answer true if a file of the given name exists in this directory."	^ self useFileSystem		ifTrue: [ (directoryOrFileReference entries					detect: [:e | e basename = fileName] ifNone: []) notNil ]		ifFalse: [ directoryOrFileReference fileExists: fileName ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 17:58'!fileExists: fileName inPath: path	"Answer true if a file of the given name exists in the directory named by path."	^ self useFileSystem		ifTrue: [ self fileExists: fileName inDirectory: (path perform: #asFileReference) ]		ifFalse: [ self fileExists: fileName inDirectory: ((Smalltalk at: #FileDirectory) on: path) ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 17:52'!fileNamed: fileName inDirectory: directoryOrFileReference	"Open the file with the given name in this directory for writing."	^ self useFileSystem		ifTrue: [(directoryOrFileReference files						detect: [:e | e basename = fileName ]						ifNone: [ ])					ifNotNilDo: [:f | f writeStream ]]		ifFalse: [ directoryOrFileReference fileNamed: fileName ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 17:56'!fullNameFor: fileName	"Return a corrected, fully-qualified name for the given file name."	^ self useFileSystem		ifTrue: [ (fileName perform: #asFileReference) perform: #fullName ]		ifFalse: [ (Smalltalk at: #FileDirectory) default fullNameFor: fileName ]! !!CommandShell class methodsFor: 'documentation' stamp: 'dtl 8/30/2011 07:30'!htmlOverview	"A general overview"	^'<html><head><title>Introduction to CommandShell</title></head><body><h3>CommandShell</h3> CommandShell is a Smalltalk implementation of a command processor shell and terminal window. It is intended to behave like to a simple terminal window (like xterm) running a Unix command shell (like /bin/sh). It lacks some elements of Unix shell syntax, and does not provide terminal emulation, but it adds some nice Smalltalk enhancements such as a text editor which works in a command pipeline, and the ability to evalute Smalltalk expressions in a command pipeline with Unix commands.<h3>How to use CommandShell</h3>  Evaluate "CommandShell open" or, if you have loaded the change set to put CommandShell  in your world menu, just select "Squeak Shell" from the "open..." menu entry.  To use the command shell window, enter commands on the command line (after  the "$ " command prompt, followed by cr to accept the command. The "help" command  gives some clues as to what can be done. In general, just try any command which  you might otherwise enter into a Unix shell or xterm window. Then try some of  the Smalltalk features such as mixing Smalltalk expressions with Unix commands, and  piping commands into Smalltalk editors.<h3>Basic Concepts</h3><ul><li><h4>  Commands</h4>    Smalltalk uses objects and messages, with expressions arranged in a natural    Noun-Verb-Predicate sentence structure, similar to that of some spoken languages.    In contrast, many other computer systems use a style in which users issue    a command to the system, in which the "command" (a verb) is followed by various    (predicate) modifiers. In the case of a traditional command-line interface, such    as a Unix shell, the command is usualy the name of a program, and the modifiers    are parameters passed to the program to influence its behavior. CommandShell attempts    to provide a command line interface for executing commands within Squeak, in    a style and environment which is comforable for someone accustomed to the    Smalltalk style of expression.<p><li><h4>  Process Proxies</h4>    A command line user interface, such as a Unix shell or a "DOS window" in    Windows, revolves around the notion of executing programs from user commands.    When Squeak is hosted in another operating system, it is useful to be able to    execute an external program from a command line expression. A process proxy    is an object which represents the evaluation of such an external command    in a command line environment.<p>    From the point of view of Squeak, a process proxy might just as well represent    the evaluation of a Smalltalk expression in the context of a command line    environment. Thus a process proxy can be an object which represents the execution    of an external program or an internal Smalltalk expression. It is created from a    command line expression, and provides a representation of certain aspects of the    external (or internal) process execution, such as process run state, exit status, and    the input, output and error streams for the process.<p>    External process proxies are used to evaluate programs in the external operating    system (this requires the OSProcess change set in addition to CommandShell). Internal    process proxies are used to evaluate "built in" commands for a command shell,    such as the "cd" command to change the working directory for the command shell.    Internal proxies are also used for evaluating "doIt" expressions within a command    pipeline. In this case, the variables "stdin", "stdout", and "stderr" are pre-defined    such that the doIt expression can directly access the input, output and error    pipes for the internal process proxy (in other words, the doIt expression    "stdout nextPutAll: ''Hello world'' !!" will write ''Hello world'' on the output pipe    of the proxy).<p><li><h4> Pipelines</h4>    Powerful computing systems may be built upon simple design metaphors. In    Smalltalk, the concept of objects communicating through messages is generalized    and extended to produce the Squeak system. In Unix systems, the metaphor of a    pipe with data flowing between two programs is generalized to produce a mechanism    for connecting small programs to produce complex systems. The command line shells    for Unix support this metaphor by providing syntax for connecting two or more    commands together into more complex command pipelines.<p>    CommandShell provides a framework for connecting several process proxies into a    command pipeline, using command syntax similar to that of a Unix shell. Since the    process proxies are implemented in Smalltalk, the "programs" in a command pipeline    may consist of process proxies representing external programs, or of proxies representing    the evaluation of internal Smalltalk expressions. The objects which flow through    the pipes in a command pipeline are assumed to be characters, such that the external    commands can operate on the streams of characters in the usual way, and the internal    Smalltalk commands read and write streams of characters.<p>    Just as programs (or internal expressions) are represented by process proxies, the    pipes which interconnect two process proxies are represented by pipe objects. The    pipe may be either an OSPipe (a proxy representing a Unix system FIFO pipe) or an    InternalPipe (a Smalltalk object which behaves similarly to an OSPipe). The combination    of process proxies and pipes is a command pipeline, which may be created and    evaluated from a command line expression using conventional Unix shell syntax.</ul><h3>Command Line Syntax</h4>    A command or command pipeline may be created from a string expression, and    evaluated using Unix shell syntax. CommandShell accepts command line strings and    does some high level processing to set up process proxy execution. For most of the    command parsing, it relies on a ShellSyntax object to do the syntax evaluation.    In particular, a real Unix shell interprets command line parameters in the context of the    Unix file system, expanding "wildcard" characters and searching for files in the context    of a "current working directory" location in the file system tree. A CommandShell,    collaborating with an instance of ShellSyntax, implements this syntax parsing    and evaluation in Smalltalk.<h3>Command Execution</h4>    Beginning with a command line (which may represent a pipeline of several    commands), a CommandShell first attempts to treat the entire command line as    a Smalltalk expression. The command line string is used to create an instance of    PipeableEvaluator (a kind of process process). If the expression is successfully    compiled and evaluated in the PipeableEvaluator, the command line is executed    just as if it were an external Unix command, with the result of the evaluation    written as a string to the output stream of the process proxy.<p>    If the complete command line cannot be treated as a Smalltalk expression,    CommandShell assumes that it must be a Unix style command pipeline. If the    command line is a comment (starting with ''#'') it is discarded; otherwise it    is broken down into a series of process proxies connected by pipes, with    command line parameters and other aspects of the command line parsing handled    by a ShellSyntax object.<p>    The process proxies in the command pipeline may represent internal or external    commands. CommandShell parses the command line to create the proxies by breaking    the command pipeline into segments (separated by the "|" pipe character), with    different kinds of process proxy created according to the following priorities:<ul><li>      If the command segment is a simple Smalltalk expression terminated by "!!", it      is treated as a "doIt" expression, evaluated in a PipeableEvaluator proxy. This      kind of simple doIt expression is limited to commands with characters which      are unambiguous in a shell command. For example, "|" has special meaning in      a command line, and cannot be used in a doIt expression (command line quoting      and escape characters have not yet been implemented in the CommandShell syntax).<li>      If the command segment is not a doIt expression, CommandShell checks to see      if it matches one of several "shell builtin" commands. These are special commands      implemented in class ShellBuiltin and evaluated in a PipeableEvaluator proxy.      They behave analogously to shell builtin commands in a conventional Unix shell.      A number of commands such as "cd" and "pwd" are implemented as internal builtin      commands, rather than relying on Unix external equivalents. In addition, other      builtin commands such as "edit" do things which are useful in Squeak and have      no real equivalent in Unix (the "edit" builtin opens an editor within Squeak, taking      its input from files or directly from the output of a command pipeline such as      "Smalltalk !! | edit" or "who | edit").<li>      If the command segment is not a shell builtin command, it is assumed to be an      external command. It this case, the command line segment is fully parsed, then      used to create an external OS process proxy to run the external command. The      external process proxy responds to a #value message by running the external      program, with output and error written to pipes connected to the command      pipeline.<li>      Finally, if no external program can be found to execute the command, an error      message is provided to the command window, and no command is evaluated.</ul>    Once the command proxy pipeline has been created, the individual process proxies    are evaluated in such a way that they appear to execute in parallel, with each    proxy reading its input from a pipe connected to its predecessor in the pipeline,    and writing its output to a pipe connected to its successor in the pipeline. An    additional error pipe is shared by all process proxies in the pipeline, such that    any error output is accumulated in the shared error pipe stream.<p>    A command shell can obtain the output and error of a complex command pipeline    simply by evaluating the last process proxy in the chain, and reading up to the    end of its output and error pipes. Since a process proxy knows its run state, and    a pipe is not "at end" until a process proxy closes one end of the pipe, the pipeline    can be constructed in such a way that the command shell is assured that all process    proxies have completed their evaluation when the output of the last proxy is read    up to the end of the pipe.<p>    As the last process proxy in a command pipeline is evaluated, CommandShell reads    its output and error pipes, and displays the text in the View or Morph which it uses    as its terminal window. When complete, it issues a new prompt string, and waits for    another command line to be entered by the user.<p><h3>Exercise for the Reader:</h4>Which one of the following five command lines will generatean error, and why?<ol><li>  $ stdout nextPutAll: ''hello world''<li>  $ stdout nextPutAll: ''hello world''; cr<li>  $ stdout nextPutAll: ''hello world''!!<li>  $ stdout nextPutAll: ''hello world''; cr!!<li>  $ stdout nextPutAll: ''hello world''!!; stdout cr!!</ol><h3>Answer:</h4>The fourth command will generate an error.<ul><li>  Line one is evaluated as a complete Smalltalk expression, and succeeds.<li>  Line two is evaluated as a complete Smalltalk expression, and succeeds.<li>  Line three is evaluated as a pipeline after failing evaluation as a complete Smalltalk  expression. It succeeds as a pipeline with one internal doIt proxy, and produces  the same output as line one.<li>  Line four cannot be evaluated as a complete Smalltalk expression. The ";" token  causes the command line to be evaluated as two pipelines. The expression for the  first pipeline does not have a trailing "!!" token, so it is assumed to be an external  command, and fails. The second pipeline is evaluated as a doIt on the string ''cr!!'',  which fails as an invalid Smalltalk expression. The error messages for both failures  are accumulated on the shared error pipe, and are displayed in the terminal window.<li>  Line five is evaluated successfully as two pipelines, each consisting of one doIt  proxy. The output is the same as for line two.</ul></body></html>'! !!CommandShell class methodsFor: 'class initialization' stamp: 'dtl 2/3/2012 22:06'!initialize	"CommandShell initialize"	| preferencesClass |	Smalltalk addToStartUpList: self.	(Smalltalk hasClassNamed: #Preferences)		ifTrue: ["Pharo deprecates Preference in favor of pragma registration mechanism"			preferencesClass := Smalltalk at: #Preferences.			(preferencesClass respondsTo: #setWindowColorFor:to: )				ifTrue: ["Squeak"					preferencesClass 						setWindowColorFor: #CommandShell 						to: (Color colorFrom: self windowColorSpecification pastelColor)]				ifFalse: ["Pharo images use some other preferences protocol"]].	Smalltalk at: #TheWorldMenu ifPresent: [ :class |		class class methodDict at: #registerOpenCommand: ifPresent: [ :method |			(method hasLiteral: #deprecated:) "n.b.  use #hasLiteral: rather than #sendsSelector: for Squeak 3.8"				ifTrue: ["Pharo issues deprecation and tells you to do it their way. Ignore the warning."]				ifFalse: [ class unregisterOpenCommand: 'Squeak shell'. "if previously registered"					class registerOpenCommand: {'Squeak Shell'. {CommandShell . #open}}]]]! !!CommandShell class methodsFor: 'version testing' stamp: 'dtl 6/29/2010 21:06'!isMorphic	"Squeak traditionally used #isMorphic to distinguish between Morphic	and MVC user interfaces. In newer Squeak images, the current project	knows its active user interface, so requests are vectored through the	current project. Pharo images pretend to be unaware of the fact that	they are running Morphic, refusing to respond to #isMorphic. This 	implementation does reasonable things in any of the above scenarios."	^(Smalltalk respondsTo: #isMorphic) not or: [Smalltalk isMorphic]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 17:55'!localNameFor: path	"Return the local part the given name."	^ self useFileSystem		ifTrue: [ (path perform: #asFileReference) perform: #basename ]		ifFalse: [(Smalltalk at: #FileDirectory) perform: #localNameFor: with: path]! !!CommandShell class methodsFor: 'VM building' stamp: 'dtl 1/25/2013 19:08'!makeVmIn: buildDirectoryPathName	"Rebuild the virtual machine and plugins in the buildDirectoryPathName	directory. If the build is successful, save the image and restart using the	new VM. This assumes that the currently executing VM is either located in,	or linked to, the buildDirectoryPathName directory."	"CommandShell makeVmIn: CommandShell defaultPathString, CommandShell pathSeparator, 'build'"	| shell |	shell := self new.	shell open.	^ shell makeVmIn: buildDirectoryPathName! !!CommandShell class methodsFor: 'instance creation' stamp: 'dtl 12/27/2001 23:36'!open	"CommandShell open"	^ self new open! !!CommandShell class methodsFor: 'instance creation' stamp: 'dtl 3/17/2003 21:19'!openLabel: aString	"CommandShell openLabel: self defaultWindowName"	^ self new openLabel: aString! !!CommandShell class methodsFor: 'instance creation' stamp: 'dtl 6/27/2010 16:08'!openWithHelp	"CommandShell openWithHelp"	self open processCommand: 'help'! !!CommandShell class methodsFor: 'documentation' stamp: 'dtl 12/1/2001 18:51'!overview	"A general overview"	"CommandShell new pipeline: 'CommandShell overview!! | edit'"	| rs ws |	rs := ReadStream on: self htmlOverview.	ws := WriteStream on: String new.	[rs atEnd]		whileFalse:			[ws nextPutAll: (rs upTo: $<).			rs upTo: $>].	^ ws contents! !!CommandShell class methodsFor: 'version dependent' stamp: 'SeanDeNigris 2/13/2013 09:46'!pathNameDelimiter	^ self useFileSystem		ifTrue: [(Smalltalk at: #DiskStore) current perform: #delimiter]		ifFalse: [(Smalltalk at: #FileDirectory) pathNameDelimiter]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/27/2013 18:17'!pathNameForDirectory: directoryOrFileReference	"Return the full name of this directory."	^ self useFileSystem		ifTrue: [directoryOrFileReference fullName]		ifFalse: [ directoryOrFileReference pathName ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'SeanDeNigris 2/13/2013 09:46'!pathSeparator	^ self useFileSystem		ifTrue: [((Smalltalk at: #DiskStore) current perform: #delimiter) asString]		ifFalse: [(Smalltalk at: #FileDirectory) slash]! !!CommandShell class methodsFor: 'proxy creation' stamp: 'dtl 12/31/2007 14:51'!pipeableProxyFor: commandString 	"Create a new proxy for a PipeJunction. The proxy may be any type	of PipeJunction, such as a PipeableOSProcess or ExpressionEvaluator.	Send #value to evaluate the newly created proxy."	"(CommandShell pipeableProxyFor: 'ls -l') value upToEndOfFile"	"(CommandShell pipeableProxyFor: 'Array new: 4 !!') value upToEndOfFile"	"(CommandShell pipeableProxyFor: 'help') value upToEndOfFile"	^ self new		pipeableProxyFor: commandString		input: nil		output: nil		error: nil		predecessorProxy: nil! !!CommandShell class methodsFor: 'proxy creation' stamp: 'dtl 12/31/2007 14:55'!pipeline: aCommand	"Find the individual commands in a command pipeline string, and evaluate	them as a command pipeline. Answer a ProxyPipeline collection of processes	in the pipeline."	"(CommandShell pipeline: 'ps | grep ps | wc') upToEndOfFile"	"(CommandShell pipeline: 'ls NOSUCHFILE * | dd | cat') errorUpToEndOfFile"	"(CommandShell pipeline: 'ls NOSUCHFILE * | dd | cat') upToEndOfFile"	^ self new pipeline: aCommand! !!CommandShell class methodsFor: 'documentation' stamp: 'dtl 12/15/2007 12:25'!raceConditions	"CommandShell new pipeline: 'CommandShell raceConditions!! | edit'"	^'It may be possible to hang the Squeak VM in an IO race condition when doing certain command pipelines. These conditions have been largely eliminated for Unix platforms through the use of nonblocking pipes in conjunction with asynchronous IO or polling processes on the Smalltalk side of the pipes. However, these notes are provided to describe possible deadlock scenarios.Note that nonblocking OS pipes are not yet available on Windows. Command pipelines with external OS processes on Windows are not supported. Blocking on read or write to an OSPipe in Windows will definitely lock the VM.Two kinds of deadlock are possible. In both cases, deadlock occurs when the single-threaded Squeak VM is blocked on a read or write to an OS pipe, and the blocked condition can only be cleared by another process running in the blocked VM.1) Block on write. The Squeak VM can block on a write to an OS pipe if the external process at the other end of the pipe does not keep up with reading it. One internal process proxy writes on an pipe to an external process proxy, and fills the pipe up to some capacity limit, after which the write blocks. The external proxy is writing its output to another internal process proxy in the command pipeline, which never executes because the VM is still blocked trying to write to the full pipe.2) Block on read. The Squeak VM can block on a read from an OS pipe if the external process writing to the pipe never closes the pipe. The internal proxy will post a read on the output pipe from the external command. If the external command has exited, the read will return with a (possibly empty) string. However, if the external command either does not exit, or exits without Squeak being notified, the read on the output pipe will block indefinitely.2a) In the case where the external command exits while the Squeak VM is blocked on a read, Squeak is unable to respond to the notification of the external process exiting. The process stays in a zombie state, the pipes therefore never get closed, and the VM stays in a blocked condition.Here are things to try if a deadlock occurs:Squeak will be blocked and will not respond to the mouse or keyboard. Open a command shell outside of Squeak (perhaps an xterm, or log in to another virtual terminal on Linux or FreeBSD). Using the "ps" command, find the Squeak VM process and its subprocesses. Kill the subprocess. In many cases this will free up the deadlock, and Squeak will come back to life. If this does not work, then you will probably find that one of the processes which you just killed is now in a "zombie" state, which means that the Squeak VM is deadlocked in such a way that it cannot recognize that its child process exited (and therefore cannot properly close the associated file handles). In this case, if your operating system supports a /proc file system, you may be able to break things free by emptying the pipes. On Linux, go to /proc/<pidOfTheSqueakVMProcess>/fd/ and do "cat" commands on all the pipe files in this directory. If none of this works, you are just plain stuck, and you will need to kill your Squeak session and recover anything valuable from the changes log.'! !!CommandShell class methodsFor: 'system startup' stamp: 'dtl 7/12/2002 19:26'!startUp: resuming	"A CommandShell may be running external processes in background, and waiting	for those processes to complete. If the Squeak image is stopped and restarted, the	background processes are no longer children of the Squeak process, and there is	no way to receive notification when the processes exit. This would result in leftover	Smalltalk processes associated with the CommandShell waiting forever for the	external processes to exit. The simplest way to prevent this is to terminate all	the Smalltalk processes unconditionally after an image restart."	resuming ifTrue: [self allSubInstances do: [:e | e startUpInNewSession]]! !!CommandShell class methodsFor: 'class initialization' stamp: 'dtl 2/3/2012 22:06'!unload	Smalltalk at: #TheWorldMenu ifPresent: [ :class |		class class methodDict at: #unregisterOpenCommandWithReceiver: ifPresent: [ :method |			(method hasLiteral: #deprecated:) "n.b.  use #hasLiteral: rather than #sendsSelector: for Squeak 3.8"				ifFalse: [ class unregisterOpenCommandWithReceiver: self ] ] ]! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/26/2013 15:38'!useFileSystem	"If true use FileSystem, otherwise use traditional FileDirectory. See senders	for methods with file system dependencies."	^ Smalltalk hasClassNamed: #FileReference! !!CommandShell class methodsFor: 'version testing' stamp: 'dtl 7/1/2015 21:19'!versionString	"CommandShell versionString"	^'4.6.15'! !!CommandShell class methodsFor: 'window color' stamp: 'dtl 6/29/2010 00:07'!windowColorSpecification	"Answer a WindowColorSpec object that declares my preference"	| windowColorSpec |	windowColorSpec := Smalltalk				at: #WindowColorSpec				ifAbsent: [^ self error: 'this image does not support WindowColorSpec'].	^ windowColorSpec		classSymbol: self name		wording: 'Squeak Shell'		brightColor: (Color lightGray lighter paler)		pastelColor: (Color lightGray lighter lighter paler paler)		helpMessage: 'CommandShell window for evaluating Smalltalk and OS commands'! !!CommandShell class methodsFor: 'version dependent' stamp: 'dtl 1/29/2013 20:40'!withBlanksTrimmed: aString	^ (aString respondsTo: #withBlanksTrimmed)		ifFalse: [aString perform: #trimBoth "Pharo"]		ifTrue: [aString perform: #withBlanksTrimmed]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/24/2001 19:09'!activeController	"In Morphic, alway nil. In MVC, the controller which most recently invoked	a command."	^ activeController! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/24/2001 19:09'!activeController: aController	"In Morphic, alway nil. In MVC, the controller which most recently invoked	a command."	activeController := aController! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/19/2002 07:13'!backgroundMessageQueue	"When a background pipeline completes, it places a message in this queue.	The message will be displayed the next time the user accepts a line of	text (presses CR)."	^ backgroundMessageQueue ifNil: [backgroundMessageQueue := OrderedCollection new]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 8/19/2006 13:14'!backgroundMessageQueue: anObject	"Set the value of backgroundMessageQueue"	backgroundMessageQueue := anObject! !!CommandShell methodsFor: 'event handling' stamp: 'dtl 12/11/2007 21:33'!backgroundPipelineComplete: aPipeline commandIndex: index	"This message is sent when aPipeline has completed evaluation.	Ensure that the output and error event handlers have had a chance	to completely empty the pipes prior to cleaning things up."	self waitUntilPipesAreEmpty: aPipeline.	aPipeline closePipes; release.	self backgroundMessageQueue addLast:		((WriteStream on: String new)			nextPutAll: '[', index asString, ']+ Done                     ';			nextPutAll: aPipeline commandLine;			cr;			contents).	self backgroundProxies removeAll: aPipeline.	self unRegisterBackgroundPipeline: aPipeline at: index.	self notifyRestorePrompt! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 12/15/2002 16:23'!backgroundPipelines	"The pipelines which are currently being evaluated in background. This	collection is used to keep track of the background command lines by giving	each background pipeline an index number corresponding to its position in	this collection. New pipelines are inserted at the first available nil position	in the collection, and the collection is expanded as needed."	^ backgroundPipelines ifNil: [backgroundPipelines := OrderedCollection new]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 8/19/2006 13:14'!backgroundPipelines: anObject	"Set the value of backgroundPipelines"	backgroundPipelines := anObject! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 12/9/2006 10:23'!backgroundProxies	"All of my process proxies that are being evaluated in the background."	backgroundProxies ifNil: [backgroundProxies := OrderedCollection new].	^ backgroundProxies! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 12/9/2006 10:23'!backgroundProxies: aCollection	"All of my process proxies that are being evaluated in the background."	backgroundProxies := aCollection! !!CommandShell methodsFor: 'process proxy creation' stamp: 'dtl 11/21/2006 09:20'!builtinCommandProxyFor: aCommandString input: in output: out error: err	"Answer a PipeableEvaluator on a built in command, or nil."	"CommandShell new initialize builtinCommandProxyFor: 'help' input: nil output: nil error: nil"	| args command commandAndArgs |	^ (self isBuiltInCommand: aCommandString)		ifTrue:			[commandAndArgs := self shellSyntax									programNameAndArgumentsFrom: aCommandString									inDirectoryPath: nil									findExecutable: false.			command := self builtinCommands at: commandAndArgs first.			args := commandAndArgs last.			^ ShellBuiltinEvaluator				command: command				withArguments: args				shell: self				pipeFrom: in				pipeTo: out				errorPipelineStream: err]		ifFalse: [nil]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 12/27/2001 12:24'!builtinCommands	^ builtinCommands ifNil: [builtinCommands := Dictionary new]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 7/14/2002 11:54'!builtinCommands: aCommandDictionary	builtinCommands := aCommandDictionary! !!CommandShell methodsFor: 'testing' stamp: 'dtl 8/7/2002 11:45'!canAccessOSProcess	"True if OSProcess is in the image and if the OSProcess plugin is functioning properly"	"CommandShell new canAccessOSProcess"	| osp |	^ (osp := Smalltalk at: #OSProcess ifAbsent: []) notNil and: [osp accessor canAccessSystem]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 3/16/2001 05:58'!characterLimit	"Tell the views how much to retain on screen"	^ 20000! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 2/18/2007 15:37'!checkSttyFor: characterValue	"Check for interrupt characters and such. Consume interrupt character and	answer nil, otherwise answer characterValue."	(self isInterrupt: characterValue)		ifTrue:			[self changed: #interruptCharacter.			^ nil].	(self isEndOfFile: characterValue)		ifTrue:			[self doEndOfFile.			^ nil].	^ characterValue! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 12/2/2001 12:05'!clearSemaphore	[self readSyncSemaphore isEmpty] whileFalse: [readSyncSemaphore terminateProcess].	readSyncSemaphore signal! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 9/15/2012 18:48'!command: aCommandString	"Evaluate aCommandString. Answer a collection of evaluated pipelines,	or nil if nothing was done."	"CommandShell new command: 'ls -l | cat'"	"CommandShell new open; command: 'ls -l | cat'"	"CommandShell new open; command: 'who'"	"CommandShell new open; command: 'who&'"	"CommandShell new open; command: 'sol'"	"CommandShell new command: 'sol'"	^self command: aCommandString echo: true! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 9/15/2012 18:47'!command: aCommandString echo: showCommand	"Evaluate aCommandString. Answer a collection of evaluated pipelines,	or nil if nothing was done. If showCommand is true, update dependent	views in order to display the command."	showCommand ifTrue: [self changed: aCommandString].	^ self evaluatePipelines: (self evaluateOrMakePipelinesFrom: aCommandString)! !!CommandShell methodsFor: 'command scripting' stamp: 'dtl 3/18/2003 20:33'!command: aCommandString onFailureDo: aBlockWithZeroOrOneParameter	"Evaluate aCommandString. On failure, answer the result of evaluating	aBlockWithOneParameter with the collection of evaluated pipelines as	its parameter. Otherwise, answer a collection of evaluated pipelines or	nil if nothing was done."	"CommandShell new open;		command: 'who'		onFailureDo: [:p | 'the proxy pipeline collection which failed was ', p printString]"	"CommandShell new open;		command: 'ls NOSUCHFILE'		onFailureDo: [:p | 'the proxy pipeline collection that failed was ', p printString]"	"CommandShell new open;		command: 'ls NOSUCHFILE'		onFailureDo: ['the command failed']"	| pipelines |	pipelines := self command: aCommandString.	(pipelines anySatisfy: [:p | p succeeded not])		ifTrue:			[(aBlockWithZeroOrOneParameter numArgs == 0)				ifTrue: [^ aBlockWithZeroOrOneParameter value]				ifFalse: [^ aBlockWithZeroOrOneParameter value: pipelines]]		ifFalse: [^ pipelines]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 4/7/2001 12:48'!commandHistory	"Automatically trim the history list, and answer the resulting list."	| trimIncrement |	trimIncrement := 1.	"Could be a larger number to copy the collection less often"	commandHistory isNil		ifTrue:			[commandHistory := OrderedCollection new]		ifFalse:			[(commandHistory size > (self historyDepth * 2 + (trimIncrement * 2) - 2))				ifTrue:					[commandHistory := commandHistory						copyFrom: (trimIncrement * 2 + 1) to: commandHistory size]].	^ commandHistory! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/15/2002 09:21'!commandLineProcesses	"The Smalltalk processes associated with currently executing command lines. Keep	track of them here so that they can be conveniently terminated if something gets	out of whack and needs cleaning up."	commandLineProcesses ifNil: [commandLineProcesses := OrderedCollection new].	^ commandLineProcesses! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 8/19/2006 13:14'!commandLineProcesses: anObject	"Set the value of commandLineProcesses"	commandLineProcesses := anObject! !!CommandShell methodsFor: 'event handling' stamp: 'dtl 1/13/2007 19:10'!copyAllErrorFrom: aProxy	"An event driven data source may send this message to cause its available	error stream characters to be processed."	| s |	self readSyncSemaphore critical:		[s := aProxy errorUpToEnd.		s isEmpty ifFalse:			[[self errorStream nextPutAll: s]				on: Error				do: [:ex | ex retryUsing:						["If the error pipe overflows we get an unhandled error,						so wait a while and retry the write."						(Delay forMilliseconds: self pollingDelayTime) wait.						self errorStream nextPutAll: s]]]]! !!CommandShell methodsFor: 'event handling' stamp: 'dtl 1/16/2007 07:05'!copyAllOutputFrom: aProxy	"An event driven data source may send this message to cause its available	characters to be processed."	| s |	self readSyncSemaphore critical:		[s := aProxy upToEnd.		s isEmpty ifFalse:			[[self outputStream nextPutAll: s]				on: Error				do: [:ex | ex retryUsing:						["If the output pipe overflows we get an unhandled error,						so wait a while and retry the write."						(Delay forMilliseconds: self pollingDelayTime) wait.						self outputStream nextPutAll: s]]]]! !!CommandShell methodsFor: 'event handling' stamp: 'dtl 1/13/2007 19:10'!copyErrorToEofFrom: aProxy	"An event driven data source may send this message to cause its available	error stream characters to be processed."	| s |	self readSyncSemaphore critical:		[s := aProxy errorUpToEndOfFile.		s isEmpty ifFalse:			[[self errorStream nextPutAll: s]				on: Error				do: [:ex | ex retryUsing:						["If the error pipe overflows we get an unhandled error,						so wait a while and retry the write."						(Delay forMilliseconds: self pollingDelayTime) wait.						self errorStream nextPutAll: s]]]]! !!CommandShell methodsFor: 'event handling' stamp: 'dtl 1/13/2007 19:11'!copyOutputToEofFrom: aProxy	"An event driven data source may send this message to cause its available	characters to be processed."	| s |	self readSyncSemaphore critical:		[s := aProxy upToEndOfFile.		s isEmpty ifFalse:			[[self outputStream nextPutAll: s]				on: Error				do: [:ex | ex retryUsing:						["If the output pipe overflows we get an unhandled error,						so wait a while and retry the write."						(Delay forMilliseconds: self pollingDelayTime) wait.						self outputStream nextPutAll: s]]]]! !!CommandShell methodsFor: 'defaults' stamp: 'dtl 7/14/2002 12:42'!defaultBuiltinCommands	^ #(cd: clear: copyToError: copyToOutput: edit: snapshot: exit: fc: help: history: inspect: pwd: sls: sqsh: type:)! !!CommandShell methodsFor: 'defaults' stamp: 'dtl 6/17/2002 23:43'!defaultPromptString	^ '$ '! !!CommandShell methodsFor: 'defaults' stamp: 'dtl 6/17/2002 23:45'!defaultPromptStringTwo	^ '> '! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 9/3/2010 17:02'!doEndOfFile	"EOF character detected, close stdin to pipeline."	| pipelineInput |	(pipelineInput := self keyboardConnector)		ifNotNil: [pipelineInput closeWriter]! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 3/9/2002 18:22'!doInterrupt	"Interrupt character detected, do interrupt stuff."	| msgStrm children answer |	children := self externalChildren collect: [:e | e processProxy].	(children size > 0)		ifTrue:			[msgStrm := WriteStream on: String new.			(children size > 1)				ifTrue: [msgStrm nextPutAll: 'kill processes']				ifFalse: [msgStrm nextPutAll: 'kill process'].			children do: [:e | msgStrm nextPutAll: ' ', e pid printString, ' (', e programName, ')'].			msgStrm nextPut: $?.			self readSyncSemaphore critical:				[self pauseStProcesses.				answer := self confirm: msgStrm contents.				self unpauseStProcesses.				answer ifTrue:					[children reverseDo: [:e | e sigkill].					self terminateStProcesses]]]! !!CommandShell methodsFor: 'process proxy creation' stamp: 'dtl 1/20/2007 14:18'!doItProxyFor: aCommandString input: in output: out error: err	"Answer a PipeableEvaluator on a doIt command, or nil."	"CommandShell new doItProxyFor: '#thisIsADoIt !! ' input: nil output: nil error: nil"	^ (self shellSyntax isDoItCommand: aCommandString)		ifTrue: [self evaluationProxyFor: (self shellSyntax doItStringFrom: aCommandString)					input: in					output: out					error: err]! !!CommandShell methodsFor: 'command history' stamp: 'dtl 1/28/2013 21:40'!editCommand: aString	^ UIManager default		request: 'edit command'		initialAnswer: aString! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 6/7/2001 23:17'!endOfFileCharacterValue	"<ctl>-D"	^ 4! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 5/18/2008 11:36'!environment	^ environment ifNil:		[environment := (Smalltalk at: #OSProcess ifPresent:			[:osp | osp thisOSProcess environment deepCopy]) ifNil: [Dictionary new]].! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 8/19/2006 13:14'!environment: anObject	"Set the value of environment"	environment := anObject! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:23'!errorStream	"Answer the value of errorStream"	^ errorStream ifNil: [errorStream := WriteStream on: String new]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 8/19/2006 13:14'!errorStream: anObject	"Set the value of errorStream"	errorStream := anObject! !!CommandShell methodsFor: 'command line parsing' stamp: 'dtl 1/22/2007 07:04'!evaluateOrMakePipelinesFrom: aCommandString	"Convert aCommandString into a structured collection of process proxies,	possibly after evaluating aCommandString as Smalltalk."	"CommandShell new evaluateOrMakePipelinesFrom: 'who | cat | wc; ps -aef | cat& pwd | cat'"	"CommandShell new evaluateOrMakePipelinesFrom: 'Array new: 10' "	| process |	"Ignore trivial case of a single word starting with $#"	(self isOneWordCommentString: aCommandString)		ifTrue:			[^ #()]		ifFalse:			[process := self tryEvaluatingAsSmalltalk: aCommandString.			(process exitStatus == #success)				ifTrue: "aCommandString was successfully evaluated as a Smalltalk expression"					[self outputStream nextPutAll: process upToEnd.					self errorStream nextPutAll: process errorUpToEnd.					self saveInHistoryList: aCommandString.					^ #()]				ifFalse: "Treat aCommandString as a command pipeline"					[^ self pipelineCollectionFrom: aCommandString]]! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 12/11/2007 18:39'!evaluatePipeline: aPipeline	"Evaluate aPipeline with event handlers to process output and error data."	"CommandShell new evaluatePipeline: 			(CommandShell new				pipelineCollectionFrom: 'ls NOSUCHFILE * | cat | dd | cat | wc; ps -aef | cat& pwd | cat') first"	| index |	self registerOutputEventsFor: aPipeline.	self registerErrorEventsFor: aPipeline.	aPipeline background		ifTrue:			[index := self registerBackgroundPipeline: aPipeline.			self registerBackgroundCompletionEventsFor: aPipeline				commandIndex: index.			self backgroundProxies addAll: aPipeline.			aPipeline value.			"Print the index of the background process."			self errorStream nextPutAll: '[', index asString, '] '.			aPipeline last isExternalProcess ifTrue:				[aPipeline last processProxy pid printOn: self errorStream].			self errorStream cr; nextPut: Character lf]		ifFalse:			[self keyboardConnector: aPipeline pipeToInput.			self registerForegroundCompletionEventsFor: aPipeline.			self foregroundProxies addAll: aPipeline.			aPipeline value].	^ aPipeline! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 9/3/2010 17:04'!evaluatePipelines: aPipelineCollection	"Evaluate the process proxies in aPipelineCollection, and process their output and error	streams. Answer aPipelineCollection."	| lastForegroundPipeline completionSemaphore |	lastForegroundPipeline := nil.	aPipelineCollection isEmpty ifFalse:		[lastForegroundPipeline := aPipelineCollection reversed			detect: [:p | p background not]			ifNone: [].		lastForegroundPipeline ifNotNil: [self registerPromptEventFor: lastForegroundPipeline].		aPipelineCollection do: [:pipeline |			completionSemaphore := Semaphore new.			pipeline background				ifTrue: [completionSemaphore signal "no wait"]				ifFalse: [pipeline when: #complete send: #signal to: completionSemaphore].			self evaluatePipeline: pipeline.			completionSemaphore wait]].	lastForegroundPipeline ifNil: [self notifyPrompt].	self resetSafeToExitFlag.	^ aPipelineCollection! !!CommandShell methodsFor: 'process proxy creation' stamp: 'dtl 11/21/2006 09:21'!evaluationProxyFor: aCommandString input: in output: out error: err	"Answer a PipeableEvaluator on a doIt command, or nil."	"CommandShell new evaluationProxyFor: 'Smalltalk' input: nil output: nil error: nil"	"CommandShell new evaluationProxyFor: 'BOGUS' input: nil output: nil error: nil"	| proxy |	proxy := ExpressionEvaluator				command: aCommandString				pipeFrom: in				pipeTo: out				errorPipelineStream: err.	^ proxy! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 6/9/2001 16:13'!filterAndForward: aCharacter	"Filter aCharacter, taking special action if needed. If a child process is active,	forward aCharacter to the child and answer nil. Otherwise answer aCharacter."	^ (self checkSttyFor: aCharacter asciiValue) ifNotNil:		[keyboardConnector isNil			ifTrue:				[aCharacter]			ifFalse:				[keyboardConnector closed					ifTrue:						[aCharacter]					ifFalse:						[keyboardConnector nextPut: aCharacter; flush.						nil]]]! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 11/7/2007 07:01'!filterAndForwardEvent: keyboardEvent 	"Filter keyboardEvent, taking special action if needed. If a child process	is active, forward keyboardEvent to the child and answer nil. Otherwise	answer keyboardEvent."	(keyboardConnector isNil or: [keyboardConnector closed])		ifTrue: [^ keyboardEvent]		ifFalse: [keyboardConnector					nextPut: keyboardEvent keyValue asCharacter;					flush.			^ nil]! !!CommandShell methodsFor: 'event handling' stamp: 'dtl 7/7/2006 09:19'!foregroundPipelineComplete: aPipeline	"This message is sent when aPipeline has completed evaluation.	Ensure that the output and error event handlers have had a chance	to completely empty the pipes prior to cleaning things up."	self waitUntilPipesAreEmpty: aPipeline.	aPipeline closePipes; release.	self keyboardConnector: nil.	[self foregroundProxies removeAll: aPipeline]		on: Error		do: ["exit command may cause the collection to be eliminated, hence an error"]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 12/9/2006 10:23'!foregroundProxies	"All of my process proxies that are being evaluated in the foreground."	^ foregroundProxies ifNil: [foregroundProxies := OrderedCollection new]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 12/9/2006 10:23'!foregroundProxies: aCollection	"All of my process proxies that are being evaluated in the foreground."	foregroundProxies := aCollection! !!CommandShell methodsFor: 'command history' stamp: 'dtl 4/22/2001 10:48'!historyAt: anInteger	| bufferSize index |	bufferSize := commandHistory size / 2.	(anInteger > 0)		ifTrue:			[index := bufferSize + 1 - historyIndex + anInteger * 2]		ifFalse:			[index := bufferSize + anInteger * 2].	((index > commandHistory size) | (index < 1))		ifTrue: [^ '']		ifFalse: [^ commandHistory at: index]! !!CommandShell methodsFor: 'defaults' stamp: 'dtl 4/8/2001 15:26'!historyDepth	"Number of commands to retain in the command history list"	^ 100! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 4/3/2001 22:48'!historyIndex	historyIndex ifNil: [historyIndex := 1].	^ historyIndex! !!CommandShell methodsFor: 'working directory' stamp: 'dtl 12/29/2002 20:14'!home	"Home directory. Use the environment variable, and set it in #initialize."	^ self environment at: #HOME! !!CommandShell methodsFor: 'command scripting' stamp: 'dtl 3/18/2003 23:12'!if: aCommandStringOrScript then: successBlock else: failureBlock	"Evaluate aCommandStringOrScript, then evaluate successBlock or failureBlock	depending on the exit status of the command or script. The blocks may use	either zero or one argument. If a single argument is used, the collection of	evaluated pipelines is passed to the block as an argument."	"CommandShell new open;		if: 'who'		then: ['the command succeeded']		else: ['the command failed']"	"CommandShell new		if: 'who			ls NOSUCHFILE			pwd'		then: ['the script succeeded']		else: ['the script failed']"	"CommandShell new		if: 'who			ls NOSUCHFILE			pwd'		then: [:p | 'the script succeeded ', p printString]		else: [:p | 'the script failed ', p printString]"	| pipelines |	pipelines := self script: aCommandStringOrScript		onFailureDo: [:p | (failureBlock numArgs == 0)						ifTrue: [^ failureBlock value]						ifFalse: [^ failureBlock value: p]].	(successBlock numArgs == 0)		ifTrue: [^ successBlock value]		ifFalse: [^ successBlock value: pipelines]! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 12/29/2002 20:00'!initialize	self installCommands.	self setHomeDirectory! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 12/27/2001 12:24'!installCommand: aShellBuiltin	self builtinCommands at: aShellBuiltin name put: aShellBuiltin! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 7/14/2002 12:05'!installCommands	self installCommands: self defaultBuiltinCommands! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 7/14/2002 12:05'!installCommands: aCommandArray	self builtinCommands: (ShellBuiltin commandDictionaryFor: self commands: aCommandArray)! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 6/7/2001 23:17'!interruptCharacterValue	"<ctl>-C"	^ 3! !!CommandShell methodsFor: 'defaults' stamp: 'dtl 4/8/2001 15:11'!invalidCommandMessage	^ 'invalid command', Character cr asString! !!CommandShell methodsFor: 'testing' stamp: 'dtl 9/26/2009 13:15'!isBuiltInCommand: aCommandString	"Answer true if aCommandString can be evaluated as a built in command."	"CommandShell new initialize isBuiltInCommand: 'help this should answer true'"	"CommandShell new initialize isBuiltInCommand: 'this should answer false'"	^ self builtinCommands includesKey: (aCommandString copyUpTo: Character space)! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 6/7/2001 23:20'!isEndOfFile: anInteger	^ anInteger == self endOfFileCharacterValue! !!CommandShell methodsFor: 'testing' stamp: 'dtl 4/7/2001 13:04'!isExcludedFromHistory: commandString	"Answer true if commandString should not be remembered in the history list. The 'fc'	and 'history' commands should be excluded."	^ ('fc*' match: commandString)		or: ['history*' match: commandString]! !!CommandShell methodsFor: 'testing' stamp: 'dtl 4/19/2003 09:13'!isExternalProcess	"Answer true if the process which I represent is an external OSProcess. For protocol	compatibility with PipeJunction."	^ false! !!CommandShell methodsFor: 'input character filtering' stamp: 'dtl 6/7/2001 23:21'!isInterrupt: anInteger	^ anInteger == self interruptCharacterValue! !!CommandShell methodsFor: 'testing' stamp: 'dtl 1/29/2013 20:24'!isOneWordCommentString: aCommandString	"Answer true if aCommandString is one word beginning with $#, or if it is an empty string."	"CommandShell new isOneWordCommentString: '#oneWordComment'"	"CommandShell new isOneWordCommentString: ' #oneWordComment'"	"CommandShell new isOneWordCommentString: ' #oneWordComment '"	"CommandShell new isOneWordCommentString: '#three word comment'"	"CommandShell new isOneWordCommentString: 'not a comment'"	"CommandShell new isOneWordCommentString: 'notAComment'"	"CommandShell new isOneWordCommentString: ''"	| s |	s := CommandShell withBlanksTrimmed: aCommandString.	^ s isEmpty		or: [(s first == self shellSyntax commentChar)			and: [(Scanner new scanTokens: s) size == 1]]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 4/22/2001 18:49'!keyboardConnector	"If nil, then my views should behave normally. If a WriteStream, then my	views should attempt to forward all keyboard inputs to the WriteStream.	This is to permit the keyboard to be connected to an externally executing	process, then reconnected to its normal functions when the external process	is complete."	^ keyboardConnector! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 4/22/2001 18:56'!keyboardConnector: aWriteStreamOrNil	"If nil, then my views should behave normally. If a WriteStream, then my	views should attempt to forward all keyboard inputs to the WriteStream.	This is to permit the keyboard to be connected to an externally executing	process, then reconnected to its normal functions when the external process	is complete."	keyboardConnector := aWriteStreamOrNil! !!CommandShell methodsFor: 'VM building' stamp: 'dtl 1/25/2013 19:06'!makeVmIn: buildDirectoryPathName	"Rebuild the virtual machine and plugins in the buildDirectoryPathName	directory. If the build is successful, save the image and restart using the	new VM. This assumes that the currently executing VM is either located in,	or linked to, the buildDirectoryPathName directory."	"CommandShell makeVmIn: CommandShell defaultPathString, CommandShell pathSeparator, 'build'"	self canAccessOSProcess		ifFalse:			[^ self notify: 'OSProcess not available or OSProcess plugin not functioning'].	self if: 'cd ', buildDirectoryPathName		then:			[self if: 'make'				then:					[self script: 'echo make completed successfully, restarting VM; OSProcess quitAndRestart !!']				else:					[self script: 'echo make failed']]		else:			[self script: 'echo cannot change directory to ', buildDirectoryPathName]! !!CommandShell methodsFor: 'command prompt' stamp: 'dtl 1/20/2007 10:49'!notifyAlternatePrompt	"Display $PS2"	self changed: #alternatePrompt! !!CommandShell methodsFor: 'command prompt' stamp: 'dtl 1/20/2007 10:48'!notifyPrompt	"Display $PS1"	self changed: #prompt! !!CommandShell methodsFor: 'command prompt' stamp: 'dtl 1/20/2007 10:49'!notifyRestorePrompt	"Restore last prompt display"	self changed: #restorePrompt! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 1/20/2007 09:26'!open	| tty |	tty := CommandShellTranscript commandShell: self.	tty open.	^ tty! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 12/11/2007 18:46'!openLabel: aString 	| tty |	tty := CommandShellTranscript commandShell: self.	tty openLabel: aString.	^ tty! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:23'!outputStream	"Answer the value of outputStream"	^ outputStream ifNil: [outputStream := WriteStream on: String new]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 8/19/2006 13:14'!outputStream: anObject	"Set the value of outputStream"	outputStream := anObject! !!CommandShell methodsFor: 'process proxy creation' stamp: 'dtl 10/13/2008 21:22'!pipeableProxyFor: aCommandString input: in output: out error: err predecessorProxy: lastProxy	"Answer a proxy for an external OS process, or for an internal builtin command,	or for an evaluation string. The proxy is suitable for use in a command pipeline,	possibly mixing internal and external commands."	"(CommandShell new pipeableProxyFor: '#''this is a doIt'' !! ' input: nil output: nil error: nil predecessorProxy: nil) value upToEnd"	"(CommandShell new pipeableProxyFor: 'help' input: nil output: nil error: nil predecessorProxy: nil) value upToEnd"	"(CommandShell new pipeableProxyFor: 'cat /etc/hosts' input: nil output: nil error: nil predecessorProxy: nil) value upToEnd"	| errorPipelineStream cmd |	errorPipelineStream := lastProxy ifNotNil: [lastProxy errorPipeForNextProxy].	^ (((self doItProxyFor: aCommandString						"try entire line as a Smalltalk expression"			input: in			output: out			error: (err ifNil: [errorPipelineStream]))		ifNil: [self builtinCommandProxyFor: aCommandString	"is it a shell builtin?"				input: in				output: out				error: (err ifNil: [errorPipelineStream])])			ifNil: [self processProxyFor: aCommandString			"then it must be an external command"					input: in					output: out					error: err					predecessorProxy: lastProxy])				ifNil: [cmd := (aCommandString findTokens: ' ') first.		"otherwise create evaluator to print error message"					self evaluationProxyFor: 'stderr nextPutAll: ''sqsh: ', cmd, ': command not found''; cr. self fail'						input: in						output: out						error: err]! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 11/20/2006 08:10'!pipeline: aCommand	"Find the individual commands in a command pipeline string, and execute them	as a command pipeline. Answer a ProxyPipeline collection of processes in the pipeline."	"(CommandShell new pipeline: 'ps | grep ps | wc') last output"	"CommandShell new pipeline: 'ls NOSUCHFILE * | dd | cat'"	| sema pipeline |	sema := Semaphore new.	pipeline := ProxyPipeline fromString: aCommand shell: self.	pipeline when: #complete send: #signal to: sema.	pipeline value.	sema wait.	^ pipeline! !!CommandShell methodsFor: 'command line parsing' stamp: 'dtl 1/29/2013 20:25'!pipelineCollectionFrom: aCommandString	"Break aCommandString into individual pipeline command strings, and answer a	collection of process proxy pipelines."	"CommandShell new pipelineCollectionFrom: 'who | cat | wc; ps -aef | cat& pwd | cat'"	| str pipelineCollection tokens strm cmd cmdWithTerm pipeline lastProxy |	str := CommandShell withBlanksTrimmed: aCommandString.	pipelineCollection := OrderedCollection new.	(self shellSyntax isComment: str)		ifFalse:			[tokens := str findTokens: ';&' keep: ';&'.			strm := ReadStream on: tokens.			[strm atEnd]				whileFalse:					[cmd := CommandShell withBlanksTrimmed: strm next.					(self shellSyntax isComment: cmd)						ifFalse:							[strm atEnd								ifTrue:									[((cmd size == 1) and: [((cmd at: 1) == $;) | ((cmd at: 1) == $&)])										ifTrue:											["Special case, user has entered ';<cr>' or '&<cr>'"											cmd := cmdWithTerm := '']										ifFalse:											[cmdWithTerm := cmd]]								ifFalse:									[cmdWithTerm := cmd, strm peek].							self saveInHistoryList: cmdWithTerm.							(cmdWithTerm size > 0)								ifTrue:									[pipeline := ProxyPipeline fromString: cmd shell: self.									pipeline background:										(strm next = self shellSyntax noWaitToken).									lastProxy := pipeline last.									lastProxy ifNil:										[self inform: 'cannot access system'.										^ nil].									lastProxy outputPipeForNextProxy										ifNotNil:											[lastProxy setNonBlockingOutput].									pipelineCollection add: pipeline]]]].	^ pipelineCollection! !!CommandShell methodsFor: 'defaults' stamp: 'dtl 6/4/2006 18:01'!pollingDelayTime	"For various polling loops, number of milliseconds to delay"	^ 50! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 9/15/2012 18:59'!processCommand: aCommandString	"Evaluate aCommandString in a separate Smalltalk process. This permits the	user interface to remain responsive."	^self processCommand: aCommandString echo: true! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 9/15/2012 18:55'!processCommand: aCommandString echo: showCommand	"Evaluate aCommandString in a separate Smalltalk process. This permits the	user interface to remain responsive. If showCommand is true, update dependent	views in order to display the command."	self commandLineProcesses add:		([self command: aCommandString echo: showCommand.		self commandLineProcesses				remove: Processor activeProcess				ifAbsent: []] forkAt: Processor userBackgroundPriority)! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 11/23/2002 13:31'!processProxies	"All of my process proxies."	^ self foregroundProxies, self backgroundProxies! !!CommandShell methodsFor: 'process proxy creation' stamp: 'dtl 10/14/2008 20:11'!processProxyFor: aCommandString input: in output: out error: err predecessorProxy: lastProxy	"Answer a proxy for an external OS command process. Note that the sender is	responsible for closing the input pipe. Under certain conditions, reading up to	end on a proxy can deadlock the VM if the input pipe remains open."	"CommandShell new processProxyFor: '/bin/sh' input: nil output: nil error: nil predecessorProxy: nil"	| input newInputPipe errorPipelineStream p proxy |	self canAccessOSProcess		ifFalse:			["Answer a doIt proxy with an error message. Call it this way to make sure that			the error streams get wired up correctly"			p := self pipeableProxyFor: 'String new: 0 !! '					input: in					output: out					error: err					predecessorProxy: lastProxy.			p errorPipelineStream nextPutAll:				'cannot access system to run ''', aCommandString, '''', Character cr asString.			^ p].	((in isNil or: [lastProxy isNil]) or: [in isPipe not])		ifTrue:			[input := in]		ifFalse:			["Input from a command pipeline"			(in isKindOf: InternalPipe)				ifTrue:					["The input stream is not an external OS pipe. Need to create one,					and move the contents of the in stream into the new OSPipe prior					to starting the external OS process."					newInputPipe := PipeJunction externalPipeClass blockingPipe.					lastProxy replaceOutputStreamWith: newInputPipe writer.					input := newInputPipe reader]				ifFalse:					[input := in reader]].	errorPipelineStream := lastProxy ifNotNil: [lastProxy errorPipeForNextProxy].	proxy := PipeableOSProcess		commandNoEvaluate: aCommandString		environment: self environment		workingDir: self workingDirectory		input: input		output: out		error: err		errorPipelineStream: errorPipelineStream		shellSyntax: self shellSyntax.	(proxy isNil and: [newInputPipe notNil])		ifTrue: [newInputPipe closeReader]. "replacement pipe will not be read, so close its output"	^ proxy! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/17/2002 23:45'!promptString	"The primary command prompt string, equivalent to $PS1 in a Unix shell"	^ promptString ifNil: [promptString := self defaultPromptString]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/17/2002 23:47'!promptString: aString	"The primary command prompt string, equivalent to $PS1 in a Unix shell"	promptString := aString! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/17/2002 23:46'!promptStringTwo	"The secondary command prompt string, equivalent to $PS2 in a Unix shell"	^ promptStringTwo ifNil: [promptStringTwo := self defaultPromptStringTwo]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/17/2002 23:48'!promptStringTwo: aString	"The secondary command prompt string, equivalent to $PS2 in a Unix shell"	promptStringTwo := aString! !!CommandShell methodsFor: 'event handling' stamp: 'dtl 1/20/2007 13:41'!promptWhenComplete: aPipeline	self waitUntilPipesAreEmpty: aPipeline.	self notifyPrompt! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/25/2001 23:07'!readSyncSemaphore	"Used in MVC to pause the screen output when presenting a dialogue to the user"	readSyncSemaphore ifNil: [readSyncSemaphore := Semaphore forMutualExclusion].	^ readSyncSemaphore! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 6/25/2001 20:34'!readSyncSemaphore: aSemaphore	"Used in MVC to pause the screen output when presenting a dialogue to the user"	readSyncSemaphore := aSemaphore! !!CommandShell methodsFor: 'process proxy creation' stamp: 'dtl 4/8/2006 18:18'!redirectedPipeableProxyFor: aCommandString predecessorProxy: lastProxy	"Answer a proxy for an external OS process, or for an internal builtin command,	or for an evaluation string. The proxy is suitable for use in a command pipeline,	possibly mixing internal and external commands."	"(CommandShell new redirectedPipeableProxyFor: '#''this is a doIt'' !! '							predecessorProxy: nil) value upToEnd"	"(CommandShell new redirectedPipeableProxyFor: 'help'							predecessorProxy: nil) value upToEnd"	"(CommandShell new redirectedPipeableProxyFor: 'cat /etc/hosts'							predecessorProxy: nil) value upToEnd"	| redirectedCommand nextProxy input |	redirectedCommand := self shellSyntax								redirectIOFor: aCommandString								inDirectoryPath: self workingDirectory.	lastProxy isNil		ifTrue:			[input := redirectedCommand at: 2]		ifFalse:			[(redirectedCommand at: 2) isNil				ifTrue:					[input := lastProxy outputPipeForNextProxy]				ifFalse:					[lastProxy replaceOutputStreamWith: nil.					input := redirectedCommand at: 2]].	nextProxy := self pipeableProxyFor: (redirectedCommand at: 1)		input: input		output: (redirectedCommand at: 3)		error: (redirectedCommand at: 4)		predecessorProxy: lastProxy.	^ nextProxy handleRedirectedOutputOf: lastProxy! !!CommandShell methodsFor: 'event registration' stamp: 'dtl 1/20/2007 13:46'!registerBackgroundCompletionEventsFor: aPipeline commandIndex: index	"When an event driven pipeline is complete, it will trigger #complete."	aPipeline when: #complete		send: #backgroundPipelineComplete:commandIndex:		to: self		withArguments: {aPipeline . index}! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 12/15/2002 16:48'!registerBackgroundPipeline: aPipeline	"Register aPipeline and answer an index number identifier."	| index |	aPipeline background		ifTrue:			["Find available slot in registry, expanding if needed"			index := self backgroundPipelines identityIndexOf: nil.			(index > 0)				ifTrue:					[self backgroundPipelines at: index put: aPipeline.					^ index]				ifFalse:					[self backgroundPipelines addLast: aPipeline.					^ backgroundPipelines size]]		ifFalse:			[self error: 'expected a background pipeline']! !!CommandShell methodsFor: 'event registration' stamp: 'dtl 1/13/2007 17:22'!registerErrorEventsFor: aPipeline	"When an event driven PipeJunction has error data available, it will	trigger #errorDataReady."	aPipeline when: #errorDataReady		send: #copyAllErrorFrom:		to: self		with: aPipeline! !!CommandShell methodsFor: 'event registration' stamp: 'dtl 12/15/2002 13:29'!registerForegroundCompletionEventsFor: aPipeline	"When an event driven pipeline is complete, it will trigger #complete."	aPipeline when: #complete		send: #foregroundPipelineComplete:		to: self		with: aPipeline! !!CommandShell methodsFor: 'event registration' stamp: 'dtl 1/13/2007 17:22'!registerOutputEventsFor: aPipeline	"When an event driven PipeJunction has new data available, it will	trigger #outputDataReady."	aPipeline when: #outputDataReady		send: #copyAllOutputFrom:		to: self		with: aPipeline! !!CommandShell methodsFor: 'event registration' stamp: 'dtl 1/20/2007 13:45'!registerPromptEventFor: aPipeline	aPipeline when: #complete		send: #promptWhenComplete:		to: self		with: aPipeline! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 6/24/2002 07:02'!release	self startUpInNewSession.	^ super release! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 6/4/2006 17:44'!resetSafeToExitFlag	"When all foreground and background proxies are complete, the safeToExit	flag may be set to true. The flag is set false when a snaphot command is	evaluated, and is checked by any command which would cause Squeak to	exit. This prevents Squeak from automatically exiting when restarting the	image."	[[self foregroundProxies isEmpty not or: [self backgroundProxies isEmpty not]]		whileTrue: [(Delay forMilliseconds: self pollingDelayTime * 2) wait].	self safeToExit: true] forkAt: Processor userBackgroundPriority! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 7/14/2002 15:56'!safeToExit	"This is a guard variable to prevent the user from running a command line containing both	a snapshot command and an exit command. This prevents the user from entering a command	such as 'snapshot; exit' which would cause the image to immediately exit when next restarted."	^ safeToExit ifNil: [safeToExit := true]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 7/14/2002 15:56'!safeToExit: trueOrFalse	"This is a guard variable to prevent the user from running a command line containing both	a snapshot command and an exit command. This prevents the user from entering a command	such as 'snapshot; exit' which would cause the image to immediately exit when next restarted."	safeToExit := trueOrFalse! !!CommandShell methodsFor: 'command history' stamp: 'dtl 4/7/2001 13:05'!saveInHistoryList: aCommandString	((aCommandString size == 0) or: [self isExcludedFromHistory: aCommandString])		ifFalse:			[self commandHistory add: self historyIndex printString; add: aCommandString.			historyIndex := historyIndex + 1]! !!CommandShell methodsFor: 'command support' stamp: 'ThierryGoubier 9/20/2013 15:19'!scheduleToEvaluate: aBlock	"Evaluate aBlock, typically to create a new scheduled window. Make it work in	both Morphic and MVC. In Morphic, just evaluate aBlock, but in MVC, put it in	a queue for evaluation within a control loop. This method may be sent from	a process running independent of MVC controller scheduling.		Newer Squeak images implement #addDeferredUIMessage in the current	project, eliminating the need for an #isMorphic test. This mechanism is not	available for older images or for Pharo."	CommandShell isMorphic		ifTrue: [WorldState addDeferredUIMessage: aBlock]		ifFalse: [(Smalltalk at: #ScheduledControllers) activeController addDeferredUIMessage: aBlock]! !!CommandShell methodsFor: 'command scripting' stamp: 'dtl 12/15/2002 18:50'!script: aScriptString	"A script is a String containing a list of commands separated by Character cr.	Evaluate each command string in the array until a failure is encountered.	Answer the last collection of pipelines to have been evaluated."	"CommandShell new open; 		script: 'who				help				ls -l NOSUCHFILE				help'"	^ self script: aScriptString onFailureDo: [:p | p]! !!CommandShell methodsFor: 'command scripting' stamp: 'dtl 1/21/2007 20:19'!script: aScriptString onFailureDo: aBlockWithZeroOrOneParameter	"A script is a String containing a list of commands separated by Character cr.	Evaluate each command in aScriptString until a failure is encountered.	On failure, answer the result of evaluating aBlockWithOneParameter with	the collection of evaluated pipelines as its parameter. Otherwise, answer the	last collection of pipelines to have been evaluated."	"CommandShell new open; 		script: 'who				help				ls -l NOSUCHFILE				help'		onFailureDo: [:p | 'the pipeline collection that failed was ', p printString]"	"CommandShell new open; 		script: 'who				help				ls				help'		onFailureDo: [:p | 'the pipeline collection that failed was ', p printString]"	"CommandShell new open; 		script: 'who				help				ls -l NOSUCHFILE				help'		onFailureDo: ['the pipeline collection failed']"	| commandStream pipelines |	commandStream := ReadStream on:						(aScriptString							copyReplaceAll: Character lf asString							with: Character cr asString).	pipelines := nil.	[commandStream atEnd]		whileFalse:			[pipelines := self				command: commandStream nextLine				onFailureDo:					[:p | (aBlockWithZeroOrOneParameter numArgs == 0)						ifTrue: [^ aBlockWithZeroOrOneParameter value]						ifFalse: [^ aBlockWithZeroOrOneParameter value: p]]].	^ pipelines! !!CommandShell methodsFor: 'command scripting' stamp: 'dtl 12/15/2002 18:47'!scriptDoAll: aScriptString	"A script is a String containing a list of commands separated by Character cr.	Evaluate each command in aScriptString. Ignore failures and force evaluation of	all commands in the script. Answer the last pipeline collection to have been	evaluated."	"CommandShell new open; 		scriptDoAll: 'who				help				ls -l NOSUCHFILE				help'"	| commandStream lastPipelineCollection |	commandStream := ReadStream on:						(aScriptString							copyReplaceAll: Character lf asString							with: Character cr asString).	[commandStream atEnd]		whileFalse:			[lastPipelineCollection := self command: commandStream nextLine].	^ lastPipelineCollection! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 1/25/2013 19:07'!setHomeDirectory	self environment.	^ environment at: #HOME put: CommandShell defaultPathString! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 12/17/2001 11:34'!shellSyntax	"A pluggable instance of a command processing syntax"	^ shellSyntax ifNil: [shellSyntax := ShellSyntax new]! !!CommandShell methodsFor: 'accessing' stamp: 'dtl 9/8/2001 11:10'!shellSyntax: aSyntax	"A pluggable instance of a command processing syntax"	shellSyntax := aSyntax! !!CommandShell methodsFor: 'command support' stamp: 'dtl 1/20/2007 14:09'!splitPipelineCommands: aCommand	"Answer a list of the individual commands in a command pipeline string,	delimited by the pipe character."	^ self shellSyntax splitPipelineCommands: aCommand! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 12/31/2002 11:53'!startUpInNewSession	"Do this if the image has been restarted, in which case all external process	references are invalid."	self clearSemaphore.	self terminateCommandLineProcesses.	foregroundProxies := backgroundProxies := backgroundPipelines := nil.	self keyboardConnector: nil! !!CommandShell methodsFor: 'initialize-release' stamp: 'dtl 12/15/2002 17:33'!terminateCommandLineProcesses	(self commandLineProcesses reject: [:e | e == Processor activeProcess])		do: [:p | p terminate].	commandLineProcesses := nil! !!CommandShell methodsFor: 'command line parsing' stamp: 'dtl 4/20/2003 15:35'!tryEvaluatingAsSmalltalk: aCommandString	"Attempt to treat aCommandString as a Smalltalk expression running in an	evaluation process. Evaluate the proxy and set exit status to reflect failure	on either the expression compilation or the runtime evaluation. Answer the	process proxy."	"CommandShell new tryEvaluatingAsSmalltalk: 'this expression should fail in the compiler'"	"CommandShell new tryEvaluatingAsSmalltalk: '#this expressionShouldFailInRuntimeEvaluation'"	"CommandShell new tryEvaluatingAsSmalltalk: '#thisIsAValidSymbolExpression'"	"CommandShell new tryEvaluatingAsSmalltalk: 'Smalltalk'"	"CommandShell new tryEvaluatingAsSmalltalk: '#oneWordCommentShouldFail'"	| process |	process := self evaluationProxyFor: aCommandString input: nil output: nil error: nil.	process value.	process closeErrorPipeline. "Last process in pipeline, so it can be closed."	^ process! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 12/15/2002 16:34'!unRegisterBackgroundPipeline: aPipeline at: index	(self backgroundPipelines at: index) == aPipeline		ifTrue: [self backgroundPipelines at: index put: nil]		ifFalse: [self error: 'inconsistent registry']! !!CommandShell methodsFor: 'evaluation' stamp: 'dtl 9/15/2012 18:25'!waitForCommand: aCommandString	"Evaluate aCommandString in a separate Process, and signal completionSemaphore	when complete. Answer a collection of evaluated pipelines, or nil if nothing was done."	| sema pipelines lastPipeline |	self changed: aCommandString.	pipelines := self evaluateOrMakePipelinesFrom: aCommandString.	pipelines isEmpty ifFalse:		[lastPipeline := pipelines last.		lastPipeline isComplete ifFalse:			[sema := Semaphore new.			lastPipeline when: #complete				send: #signal				to: sema.			[self evaluatePipelines: pipelines] forkAt: Processor userBackgroundPriority.			lastPipeline isComplete ifFalse: [sema wait].			self waitUntilPipesAreEmpty: lastPipeline]].	^ pipelines! !!CommandShell methodsFor: 'event handling' stamp: 'dtl 10/3/2006 07:21'!waitUntilPipesAreEmpty: aPipeline	"Some other Smalltalk process may be updating the pipes, or we may be	waiting for data in an external OS pipe to be read into the image. Wait	for these to reach completion."	[aPipeline pipesAreEmpty] whileFalse: [(Delay forMilliseconds: 100) wait]! !!CommandShell methodsFor: 'working directory' stamp: 'dtl 1/25/2013 19:07'!workingDirectory	^ self shellSyntax workingDirectory		ifNil:			[shellSyntax workingDirectory: CommandShell defaultPathString; workingDirectory]! !!CommandShell methodsFor: 'working directory' stamp: 'dtl 12/16/2001 20:15'!workingDirectory: aPathString	self shellSyntax workingDirectory: aPathString! !"CommandShell-Base"!!ShellWindowMorph commentStamp: '<historical>' prior: 0!I am a simple teletype shell session morph, providing a view on an instance of CommandShell.!!TtyTextMorphForEditView commentStamp: '<historical>' prior: 0!I add a keyboard hook to a TextMorphForEditView to allow filtering of keystrokes for a simple tty terminal emulator.!!ShellWindowMorph class methodsFor: 'instance creation' stamp: 'dtl 1/21/2007 09:57'!open	"Open a new CommandShell, and answer the instance of ShellWindowMorph which it uses."	"ShellWindowMorph open"	^ CommandShell open dependents at: 2! !!ShellWindowMorph methodsFor: 'menu commands' stamp: 'dtl 9/15/2012 18:59'!accept	self model cr; flush; processCommand: self commandLineInput asString echo: false! !!ShellWindowMorph methodsFor: 'updating' stamp: 'dtl 1/21/2007 13:02'!appendEntry	| str |	"Append the text in the model's writeStream to the editable text. "	textMorph asText size > model characterLimit ifTrue:		["Knock off first half of text"		self selectInvisiblyFrom: 1 to: textMorph asText size // 2.		self replaceSelectionWith: Text new].	self selectInvisiblyFrom: textMorph asText size + 1 to: textMorph asText size.	str := model contents.	(str size > 0) ifTrue:		[self replaceSelectionWith: (Text			string: str			attribute: (TextFontChange fontNumber: self textStyle defaultFontIndex)).		self selectInvisiblyFrom: textMorph asText size + 1 to: textMorph asText size.		model reset]! !!ShellWindowMorph methodsFor: 'command input' stamp: 'dtl 3/18/2001 18:17'!commandLineInput	^ (self text copyFrom: self positionAfterPromptString to: self text size) asString.! !!ShellWindowMorph methodsFor: 'command input' stamp: 'dtl 4/7/2001 12:21'!positionAfterPromptString	"Answer the index of the first character after the last prompt string in my text. If	not found, then assume that the contents of the text are all intended to be command	input."	| t loc |	t := self text.	(1 to: (t size - model promptString size))		reverseDo: [:i |			((loc := t findString: model promptString startingAt: i) ~= 0)				ifTrue: [^ loc + model promptString size]].	^ 1! !!ShellWindowMorph methodsFor: 'model access' stamp: 'dtl 1/21/2007 10:33'!setText: aText	scrollBar setValue: 0.0.	textMorph		ifNil: [textMorph := TtyTextMorphForEditView new						contents: aText wrappedTo: self innerBounds width-6.				textMorph setEditView: self.				textMorph setTextStyle: self textStyle.				scroller addMorph: textMorph]		ifNotNil: [textMorph newContents: aText].	self hasUnacceptedEdits: false.	self setScrollDeltas.! !!ShellWindowMorph methodsFor: 'model access' stamp: 'dtl 11/18/2009 22:20'!textStyle	"A fixed width font for the text morph"	^ (TextStyle named: 'DefaultFixedTextStyle')		ifNil: [TextStyle default]! !!ShellWindowMorph methodsFor: 'updating' stamp: 'dtl 6/3/2001 19:02'!update: something	(something == #doCommand)		ifTrue:			[^ self accept].	(something == #exit)		ifTrue:			[^ self owner release; delete].	^ super update: something! !!TtyTextMorphForEditView methodsFor: 'editing' stamp: 'dtl 11/2/2007 05:18'!keyStroke: evt	(self editView model filterAndForwardEvent: evt)		ifNotNil: [^ super keyStroke: evt]! !"CommandShell-Morphic"!!ProxyPipeline commentStamp: 'dtl 12/13/2002 19:30' prior: 0!A collection of connected PipeJunctions, representing external OS processes or internal evaluators. This class exists primarily to make the functioning of a collection of command pipelines, some of which may be evaluated as asynchronous "background" processes, easier to understand.Events triggered by my proxies are handled and forwarded in such a way that a client (such as a CommandShell) will receive events from a ProxyPipeline as if it were an individual PipeJunction.The user of a ProxyPipeline is responsible for closing the external resources associated with the proxies by sending either #closePipes or #finalize.!!InternalPipe commentStamp: '<historical>' prior: 0!I am a first-in, first-out queue with streaming behavior. I behave similarly to an OSPipe,but am implemented in the Smalltalk image rather than with external OS pipes. I canbehave either as a blocking pipe or as a nonblocking pipe, similar to an OS pipe withits reader end set in blocking or nonblocking mode.!!RemoteTask commentStamp: 'dtl 11/12/2011 23:26' prior: 0!RemoteTask do: [2 + 2]A RemoteTask represents a block to be evaluated in a headless Squeak child process. The results of evaluating the block are returned to the sender through a reference stream on an OS pipe. Asynchronous event notification may be used to signal completion of remote processing.The block is evaluated in a remote headless image beginning with a clone of the sender image at the time of the message send. All side effects of evaluating the task block are localized to the remote image, and have no effect on the sending image. The result object may be an object of any complexity, such as a dictionary or array of result values.On a unix system, the creation of child Squeak images is a relatively light weight operation, so tasks of varying degrees of complexity can be assigned to remote tasks with only moderate overhead.!!PipeJunction commentStamp: '<historical>' prior: 0!I am a connector junction for input, output, and error pipelines. I obtain input from an input pipeline and, after possibly performing some kind of operation on the input objects, I send output to an output pipeline. I may also append objects onto an error pipeline.My subclasses implement the operations on the objects which pass through a pipe junction.In general, input pipes are connected to output pipes in a serial fashion, and error pipelines are shared by one or more instances of my subclasses.!!PipeableEvaluator commentStamp: 'dtl 2/1/2003 16:56' prior: 0!I evaluate Smalltalk expressions, taking input from my pipeToInput, and print the results of the evaluation on my pipeFromOutput. I may append error messages to my errorPipelineStream. I provide a framework for pipelines of expressions, possibly combined in the same pipeline with ExternalOSProcess proxies executing external operating system commands.My evaluationBlock may be supplied directly, or can be compiled from an expression string. If compiled from an expression string, the names 'stdin', 'stdout', 'stderr', and 'args' are used to refer to the input stream, output stream, error stream, and an array of arguments. If any of these names are used in the expression string, then the evaluation block will be compiled in such as way as to connect these names with their corresponding streams or argument array.!!ExpressionEvaluator commentStamp: 'dtl 2/1/2003 16:58' prior: 0!I provide a context in which a Smalltalk expression can be evaluated as an element of a command pipeline.!!ShellBuiltinEvaluator commentStamp: 'dtl 2/1/2003 17:47' prior: 0!I provide the context in which a ShellBuiltin is evaluated as an element of a command pipeline.!!PipeableOSProcess commentStamp: '<historical>' prior: 0!I am a connector junction for input, output, and error pipelines. I collaborate with a process proxy to evaluate an internal or external process, and to move objects through the pipelines as the proxy is evaluated.From Smalltalk, you can write to my pipeToInput, and read from my pipeFromOutput and pipeFromError streams. I implement simple streaming protocol as a convenience for reading and writing these pipe streams. I support command pipelines with the #| message, with the pipeFromOutput of one instance connected to the pipeToInput of the next instance, and a shared errorPipelineStream collecting error output text for the command pipeline.All reading and writing should be done with the streaming protocol, rather than by direct access to the pipe streams. This is because the output pipe streams may be silently replaced by simple ReadStreams following the exit of the child process.Normal exit for the external process may not happen when expected. If the process is writing to the output pipe, it may block on write until enough of its data is read from the pipeFromOutput pipe, after which it will exit normally.!!ProxyPipeline class methodsFor: 'command processing' stamp: 'dtl 1/24/2013 08:39'!command: aCommandString	"Evaluate a new instance created from aCommandString. Sender is responsible	for closing the pipes with #closePipes or #finalize."	"ProxyPipeline command: 'ls | cat | wc'"	"ProxyPipeline command: 'ls NOSUCHFILE * | cat | wc'"	"ProxyPipeline command: 'ls | copyToOutput | wc'"	"ProxyPipeline command: ''"	Smalltalk at: #CommandShell		ifPresent: [ :cls | ^ self command: aCommandString shell: cls new ].	self notify: 'CommandShell not found'! !!ProxyPipeline class methodsFor: 'command processing' stamp: 'dtl 4/27/2003 11:32'!command: aCommandString shell: aCommandShell	"Evaluate a new instance created from aCommandString using aCommandShell.	Sender is responsible for closing the pipes #closePipes or #finalize."	"ProxyPipeline command: 'ls | cat | wc' shell: CommandShell new"	"ProxyPipeline command: 'ls NOSUCHFILE * | cat | wc' shell: CommandShell new"	"ProxyPipeline command: 'ls | copyToOutput | wc' shell: CommandShell new "	"ProxyPipeline command: '' shell: CommandShell new"	^ (self fromString: aCommandString shell: aCommandShell) value! !!ProxyPipeline class methodsFor: 'instance creation' stamp: 'dtl 6/8/2006 06:57'!fromString: aCommandString shell: aCommandShell	"Answer a new instance created from aCommandString using aCommandShell."	"ProxyPipeline fromString: 'ls | cat | wc' shell: CommandShell new"	"ProxyPipeline fromString: 'ls NOSUCHFILE * | cat | wc' shell: CommandShell new"	"ProxyPipeline fromString: 'ls | copyToOutput | wc' shell: CommandShell new "	"ProxyPipeline fromString: '' shell: CommandShell new"	^ super new fromString: aCommandString shell: aCommandShell! !!ProxyPipeline methodsFor: 'testing' stamp: 'dtl 3/29/2003 13:49'!atEnd	^ self last atEnd! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:42'!background	"Answer true if this pipeline should be evaluated in the background."	^ background ifNil: [background := false]! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:42'!background: trueOrFalse	background := trueOrFalse! !!ProxyPipeline methodsFor: 'initialize - release' stamp: 'dtl 12/31/2002 10:57'!close	"Close input pipe to first proxy in the pipeline. The proxies are not	finalized, this simply closes the input stream to allow normal processing	to proceed to completion."	self isEmpty ifFalse: [self first close]! !!ProxyPipeline methodsFor: 'initialize - release' stamp: 'dtl 9/3/2010 17:37'!closePipes	| p |	self do: [:e | e closePipes].	self unregisterEvents.	(p := self pipeFromOutput) ifNotNil: [p close]! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 11/20/2002 19:20'!commandLine	"Command line string from which this pipeline was constructed"	^ commandLine! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:42'!commandLine: aString	"Command line string from which this pipeline was constructed"	commandLine := aString! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 11/20/2006 13:28'!completionSemaphore	"Answer the value of completionSemaphore. This semaphore is signaled	when the last proxy completes. Subsequent cleanup is preformed by a	process waiting on the semaphore. Completion notification is often triggered	by the grimReaperProcess, so the separate pipeline cleanup prevents	those activities from being processed in the context of the grimReaperProcess."	^ completionSemaphore ifNil: [completionSemaphore := Semaphore new]! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 11/20/2006 13:21'!completionWatcher	"A process that waits for notification that the last proxy has completed,	and performs any necessary cleanup. Completion notification is often	triggered by the grimReaperProcess, so the separate pipeline cleanup	prevents those activities from being processed in the context of the	grimReaperProcess."	^ completionWatcher! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:42'!completionWatcher: anObject	"Set the value of completionWatcher"	completionWatcher := anObject! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 4/28/2003 21:02'!errorPipelineStream	"Accumulates the error output of commands in a command pipeline."	self isEmpty		ifTrue: [^ nil]		ifFalse: [^ self last errorPipelineStream]! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 11/21/2002 18:10'!errorUpToEnd	"Answer all available characters from the error stream shared by my proxies."	^ self last errorUpToEnd! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 8/25/2006 12:22'!errorUpToEndOfFile	"Answer all available characters from the error stream. Block and	continue reading until end of file is detected."	^ self last errorUpToEndOfFile! !!ProxyPipeline methodsFor: 'finalization' stamp: 'dtl 4/9/2006 09:43'!finalize	self closePipes.	^ super finalize! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 11/21/2002 18:10'!flush	"Flush output to the standard input stream of my first proxy."	^ self first flush! !!ProxyPipeline methodsFor: 'initialize - release' stamp: 'dtl 11/8/2007 20:42'!fromString: aCommandString shell: aCommandShell 	"Initialize a new instance created from aCommandString using aCommandShell. "	self commandLine: aCommandString.	(aCommandShell splitPipelineCommands: aCommandString)		inject: nil		into: [:prevProxy :command | 			| nextProxy |			nextProxy := aCommandShell				redirectedPipeableProxyFor: command				predecessorProxy: prevProxy.			prevProxy				ifNotNil: [prevProxy prepareOutputFor: nextProxy.					prevProxy canProvideOutputPipe						ifFalse: [nextProxy closeWriter]].			self add: nextProxy].	self isEmpty		ifFalse: [self last prepareOutputFor: self; addDependent: self]! !!ProxyPipeline methodsFor: 'event handling' stamp: 'dtl 9/3/2010 17:51'!handleCompletionWhenSignaled: aSemaphore	"Answer a process that will complete processing the the last proxy has	signaled its completion."	| lastProxy proc |	proc := [aSemaphore wait.		self waitForAllToComplete.		(lastProxy := self last)			ifNotNil: [lastProxy closeErrorPipeline.					self triggerEvent: #complete]] newProcess.	^ proc resume! !!ProxyPipeline methodsFor: 'event handling' stamp: 'dtl 9/3/2010 17:40'!handleRunstateChange	| lastProxy |	(lastProxy := self last)		ifNotNil: [lastProxy isComplete					ifTrue: [self completionSemaphore signal]]! !!ProxyPipeline methodsFor: 'testing' stamp: 'dtl 9/12/2003 11:53'!isComplete	"True if all proxies are complete. The proxies may report their completion events	out of sequence, so test all the proxies (not just the last one in the pipeline)."	^ self noneSatisfy: [:proxy | proxy isComplete not]! !!ProxyPipeline methodsFor: 'testing' stamp: 'dtl 4/19/2003 09:16'!isExternalProcess	"Answer true if the process which I represent is an external OSProcess. For protocol	compatibility with PipeJunction."	^ false! !!ProxyPipeline methodsFor: 'testing' stamp: 'dtl 11/23/2002 13:37'!needsPrompt	^ self last needsPrompt! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 11/21/2002 18:08'!next	^ self last next! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 11/21/2002 18:08'!next: count	^ self last next: count! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 11/21/2002 18:11'!nextFromError: count	"Answer up to count characters from the error pipeline stream, or an empty string	if no data is available. All characters are routed through the errorPipelineStream,	which is shared by all my proxies."	^ self last next: count! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 11/21/2002 18:09'!nextPut: aCharacter	"Write aCharacter to the standard input stream of my first proxy."	^ self first nextPut: aCharacter! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 11/21/2002 18:09'!nextPutAll: characters	"Write characters to the standard input stream of my first proxy."	^ self first nextPutAll: characters! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 4/14/2006 10:32'!output	^ self last output! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 4/29/2003 05:04'!pipeFromOutput	"The output from the last proxy in the pipeline, if any"	self isEmpty		ifTrue: [^ nil]		ifFalse: [^ self last pipeFromOutput]! !!ProxyPipeline methodsFor: 'accessing' stamp: 'dtl 4/28/2003 20:58'!pipeToInput	"The input to the first proxy in the pipeline, if any"	self isEmpty		ifTrue: [^ nil]		ifFalse: [^ self first pipeToInput]! !!ProxyPipeline methodsFor: 'testing' stamp: 'dtl 9/12/2003 11:49'!pipesAreEmpty	"True after processing is complete and all available data has been read from	the output pipe and the errorPipelineStream pipe."	^ self isComplete and: [self last pipesAreEmpty]! !!ProxyPipeline methodsFor: 'printing' stamp: 'dtl 11/20/2002 19:32'!printOn: aStream	self background		ifTrue: [aStream nextPutAll: 'a background ']		ifFalse: [aStream nextPutAll: 'a foreground '].	aStream nextPutAll: self class name, ' for "', self commandLine asString, '"'! !!ProxyPipeline methodsFor: 'initialize - release' stamp: 'dtl 1/4/2003 15:35'!release	self do: [:proxy | proxy release].	^ super release! !!ProxyPipeline methodsFor: 'testing' stamp: 'dtl 7/5/2006 09:07'!succeeded	"Answer true if all proxies succeeded, otherwise false"	self detect: [:proxy | proxy succeeded not] ifNone: [^ true].	^ false! !!ProxyPipeline methodsFor: 'initialize - release' stamp: 'dtl 8/20/2006 19:05'!unregisterEvents	self isEmpty ifFalse: [self last removeDependent: self]! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 8/25/2006 12:21'!upToEnd	"Answer all available characters from the output stream."	^ self last upToEnd! !!ProxyPipeline methodsFor: 'streaming' stamp: 'dtl 8/25/2006 12:21'!upToEndOfFile	"Answer all available characters from the output stream. Block and	continue reading until end of file is detected."	^ self last upToEndOfFile! !!ProxyPipeline methodsFor: 'updating' stamp: 'dtl 8/22/2006 06:28'!update: aParameter	aParameter == self pipeFromOutput		ifTrue: [^ self triggerEvent: #outputDataReady].	aParameter == self errorPipelineStream		ifTrue: [^ self triggerEvent: #errorDataReady].	aParameter == #runState		ifTrue: [^ self handleRunstateChange].	self error: 'unexpected parameter'! !!ProxyPipeline methodsFor: 'evaluation' stamp: 'dtl 8/28/2012 07:44'!value	"Initiate evaluation of each member of the pipeline, and answer the	last proxy in the pipeline. Evaluation may proceed asynchronously, and	the sender should wait for the last proxy to complete its evalation in order	to obtain complete output and error contents from the pipeline."	"(ProxyPipeline command: 'ls | cat | wc' shell: CommandShell new) value"	self completionWatcher: (self handleCompletionWhenSignaled: self completionSemaphore).	self do: [:proxy |		proxy value.		"A proxy may have associated Smalltalk processes for stream handling.		Schedule a short delay to permit these processes to be started prior to		starting the next proxy in the pipeline."		(Delay forMilliseconds: 10) wait]! !!ProxyPipeline methodsFor: 'event handling' stamp: 'dtl 11/20/2006 12:43'!waitForAllToComplete	"In some cases the last proxy in a pipeline may complete before some	of the others. In particular, if one proxy has redirected its output to	a file, the next proxy will see a nil input stream, and may quickly	complete its processing before its predecessor proxies have finished	writing to the file. Time out with an error if pipeline fails to complete	after 10 seconds."	(1 to: 100) do: [:e |		self isComplete ifTrue: [^ self].		(Delay forMilliseconds: 100) wait].	self error: 'pipeline did not complete evaluation'! !!InternalPipe class methodsFor: 'instance creation' stamp: 'dtl 12/2/2001 19:24'!blockingPipe	"InternalPipe blockingPipe"	^ super basicNew initialize setBlocking! !!InternalPipe class methodsFor: 'instance creation' stamp: 'dtl 12/2/2001 19:25'!new	"InternalPipe new"	^ self blockingPipe! !!InternalPipe class methodsFor: 'instance creation' stamp: 'dtl 12/2/2001 19:24'!nonBlockingPipe	"InternalPipe nonBlockingPipe"	^ super basicNew initialize setNonBlocking! !!InternalPipe class methodsFor: 'examples' stamp: 'dtl 11/8/2007 20:33'!testPipe	"InternalPipe testPipe inspect"	| pipe result |	pipe := self new.	pipe nextPutAll: 'string to send through an InternalPipe'.	pipe closeWriter.	result := pipe upToEnd.	pipe close.	^ result! !!InternalPipe methodsFor: 'finalization' stamp: 'dtl 4/20/2003 20:34'!addDummyNilAsEndOfFileIndicatorForBlockingPipe	"And add a trailing nil to the pipe to mimic the behaviour of an external pipe	which blocks until the writer end is closed. Writing a trailing nil the the queue	has the side effect of waking up any process which is blocked waiting on the	queue, which will receive the nil as an indication that the pipe has been closed.	FIXME: This is almost certainly a Bad Idea, so it is encapsulated in its own method."	self isBlocking ifTrue: [queue nextPut: nil]! !!InternalPipe methodsFor: 'testing' stamp: 'dtl 12/26/2002 19:09'!atEnd	"Answer whether the receiver can access any more objects. A nonblocking	pipe with writer end closed which answers nil is considered to be at end.	See InternalPipe>>closeWriter. Yes, it is ugly to have a pipe which cannot	pass a nil object, but this is intended to mimic the behavior of an external	OS pipe in nonblocking mode."	^ self writerClosed and:		[self isBlocking			ifTrue:				[(queue size == 0) or:					[(queue size == 1) and:						[(queue nextPut: queue next) isNil]]]			ifFalse:				[queue size == 0]]! !!InternalPipe methodsFor: 'testing' stamp: 'dtl 6/4/2006 16:09'!atEndOfFile	"Answer whether the receiver is at its end based on the result of	the last read operation. For compatibility with ExternalPipe."	^ self atEnd! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 1/25/2003 18:58'!basicNext	"Answer the next object accessible by the receiver."	self nonBlockingMode		ifFalse:			[^ queue next]		ifTrue:			[queue isEmpty ifTrue: [^ nil] ifFalse: [^ queue next]]! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 1/7/2003 20:23'!basicNextPut: anObject 	"Insert the argument, anObject, as the next object accessible by the 	receiver. Answer anObject."	^ queue nextPut: anObject! !!InternalPipe methodsFor: 'finalization' stamp: 'dtl 1/1/2002 11:38'!close	self closeWriter; closeReader! !!InternalPipe methodsFor: 'finalization' stamp: 'dtl 1/4/2003 15:12'!closeReader	"Protocol compatibility with OSPipe. No further reads are possible after	closing the reader, therefore any dependents and events may be released.	Nothing actually is done, except to release dependents and events."	self release! !!InternalPipe methodsFor: 'finalization' stamp: 'dtl 4/20/2003 20:46'!closeWriter	"Set the writerClosed flag, and add a trailing nil to the pipe to mimic the	behaviour of an external pipe which blocks until the writer end is closed.	Writing a trailing nil the the queue has the side effect of waking up any	process which is blocked waiting on the queue, which will receive the nil	as an indication that the pipe has been closed."	self writerClosed ifFalse:		[self writerClosed: true.		self addDummyNilAsEndOfFileIndicatorForBlockingPipe.		self notifyDataReady	"in case someone is waiting on the pipe output"]! !!InternalPipe methodsFor: 'testing' stamp: 'dtl 11/24/2001 15:03'!closed	^ self writerClosed! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:33'!contents	"Answer contents of the pipe, and return the contents to the pipe so it can still be read."	"InternalPipe new nextPutAll: 'hello'; contents"	| s |	s := self next: queue size.	self nextPutAll: s.	^ s! !!InternalPipe methodsFor: 'character writing' stamp: 'dtl 9/23/2001 16:49'!cr	"Append a return character to the receiver."	self queue nextPut: Character cr! !!InternalPipe methodsFor: 'initialize-release' stamp: 'dtl 9/16/2001 22:35'!initialize	self queue! !!InternalPipe methodsFor: 'testing' stamp: 'dtl 8/7/2002 14:20'!isBlocking	"Answer true if reader end is set to blocking mode."	^ self nonBlockingMode not! !!InternalPipe methodsFor: 'testing' stamp: 'dtl 3/26/2006 15:48'!isPipe	^ true! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 3/26/2006 11:23'!next	"Answer the next object accessible by the receiver."	^ self basicNext! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:24'!next: anInteger 	"Answer the next anInteger elements of my collection."	| strm c |	strm := WriteStream on: String new.	(1 to: anInteger) do: [:index |		self atEnd			ifTrue: [^ strm contents]			ifFalse: [(c := self basicNext) ifNil: [^ strm contents].					strm nextPut: c]].	^ strm contents! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:33'!nextPut: anObject 	"Insert the argument, anObject, as the next object accessible by the 	receiver. Answer anObject."	| result |	result := queue nextPut: anObject.	self notifyDataReady.	Processor yield.	^ result! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:33'!nextPutAll: aCollection 	"Append the elements of aCollection to the sequence of objects accessible 	by the receiver. Answer aCollection."	| result |	result := aCollection do: [:e | queue nextPut: e].	self notifyDataReady.	Processor yield.	^ result! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:33'!nonBlockingMode	^ nonBlockingMode ifNil: [nonBlockingMode := false]! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:33'!nonBlockingMode: trueOrFalse	nonBlockingMode := trueOrFalse! !!InternalPipe methodsFor: 'event driven reader' stamp: 'dtl 1/7/2003 20:23'!notifyDataReady	"Whenever new data becomes available, notify any dependents. This method	exists only to document the event generation mechanism, which is intended	to be compatible with events generated by an OSPipe."	self changed! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 9/16/2001 22:42'!peek	^ queue peek! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:34'!queue	^ queue ifNil: [queue := SharedQueue new]! !!InternalPipe methodsFor: 'initialize-release' stamp: 'dtl 11/25/2001 14:33'!setBlocking	"For compatibility with OSPipe"	self nonBlockingMode: false! !!InternalPipe methodsFor: 'event driven reader' stamp: 'dtl 1/7/2003 20:31'!setBufferedReader	"An InternalPipe behaves like an OSPipe with a buffered reader, and is	capable of generating events when data is available. Answer true to	indicate that this is the case."	^ true! !!InternalPipe methodsFor: 'initialize-release' stamp: 'dtl 11/24/2001 15:56'!setNonBlocking	"For compatibility with OSPipe"	self nonBlockingMode: true! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/25/2001 19:15'!size	"An InternalPipe may contain a trailing nil if it has been closed. This should	not be counted as part of the pipe size, so use #contents to determine the size	after stripping any trailing nil."	"InternalPipe new nextPutAll: 'hello'; size"	^ self closed		ifTrue: [self contents size]		ifFalse: [self queue size]! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:24'!upToEnd	"Answer the remaining elements in the pipe"	| strm c |	strm := WriteStream on: String new.	[self atEnd] whileFalse:		[c := self next.		c isNil			ifTrue: [^ strm contents]			ifFalse: [strm nextPut: c]].	^ strm contents! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 5/20/2006 18:45'!upToEndOfFile	"For compatibility with external pipes"	^ self upToEnd! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:34'!writerClosed	^ writerClosed ifNil: [writerClosed := false]! !!InternalPipe methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:34'!writerClosed: trueOrFalse	writerClosed := trueOrFalse! !!RemoteTask class methodsFor: 'evaluating' stamp: 'dtl 11/12/2011 23:23'!do: aBlock	"Start a remote task and read the result object. The image will be blocked	on read until completion of the remote task."	"RemoteTask do: [2 + 2]"	^(self new task: aBlock) value! !!RemoteTask class methodsFor: 'evaluating' stamp: 'dtl 11/12/2011 23:20'!do: taskBlock whenComplete: aOneArgumentBlock	"Evaluate taskBlock in an image running in a separate OS process.	Set the completion block, a block that takes result object as its single argument.	Start remote processing with an AIO event notifier. Completion of the remote task	will result in a changed notification from the event notifier, which will activate the	completion block. The completion block is expected to do something useful with	the result of the remote task."	"n.b. Inspect the RemoteTask to prevent it being garbage collected and finalized	before processing is complete"	"(RemoteTask do: [2 + 2] whenComplete: [ :result | result inspect ]) inspect"	"(RemoteTask do: [(Delay forSeconds: 3) wait. 2 + 2] whenComplete: [ :result | result inspect ]) inspect"	^ self new task: taskBlock whenComplete: aOneArgumentBlock! !!RemoteTask class methodsFor: 'finalization' stamp: 'dtl 11/12/2011 23:05'!finalize: aRemoteTask	aRemoteTask finalize! !!RemoteTask class methodsFor: 'class initialization' stamp: 'dtl 2/19/2015 22:33'!headlessChild: boolean	"If true (default), the child process is headless. Set to false to allow debugging in	the child Squeak image"	"RemoteTask headlessChild:true"	"RemoteTask headlessChild:false" "for debugging the child image"	HeadlessChild := boolean! !!RemoteTask class methodsFor: 'class initialization' stamp: 'dtl 2/19/2015 22:32'!initialize	"Initilialize the serialization strategy. Assume that if Magma is loaded in this image,	that the Magma serializer is preferred. If Fuel is present, use that. Otherwise use the	simple and effective default of a Squeak ReferenceStream."	"RemoteTask initialize"	"RemoteTask useReferenceStreamSerializer"	"RemoteTask useFuelSerializer"	"RemoteTask useMagmaSerializer"	self headlessChild: true.	(Smalltalk hasClassNamed: #MaObjectSerializer)		ifTrue: [^self useMagmaSerializer].	(Smalltalk hasClassNamed: #FLSerializer)		ifTrue: [^ self useFuelSerializer].	self useReferenceStreamSerializer.! !!RemoteTask class methodsFor: 'examples' stamp: 'dtl 11/13/2011 00:29'!parallelPerformance	"Compare performance of three tasks run in parallel versus the equivalent serial	processing. Results will vary depending on availability of CPU cores. On a quad core	machine, the parallel processing should complete in well under half the time of the	equivalent serial job."	"RemoteTask parallelPerformance"	| parallelExecutionTime results sema task1 task2 task3 serialExecutionTime p1 p2 p3 |	parallelExecutionTime := Time millisecondsToRun: [		results := Array new: 3.		sema := Semaphore new.		task1 := [(100000000000000000000000000000 to: 100000000000000000000000019999)					select: [:f | f isPrime] thenCollect: [:s | s asString]].		task2 := [(100000000000000000000000020000 to: 100000000000000000000000039999)					select: [:f | f isPrime] thenCollect: [:s | s asString]].		task3 := [(100000000000000000000000040000 to: 100000000000000000000000059999)					select: [:f | f isPrime] thenCollect: [:s | s asString]].		"n.b. assign to variables to prevent RemoteTask from being finalized"		p1 := RemoteTask do: task1 whenComplete: [:result |  results at: 1 put: result. sema signal].		p2 := RemoteTask do: task2 whenComplete: [:result | results at: 2 put: result. sema signal].		p3 := RemoteTask do: task3 whenComplete: [:result |  results at: 3 put: result. sema signal].		sema wait; wait; wait.		results].	serialExecutionTime :=  Time millisecondsToRun: [		(100000000000000000000000000000 to: 100000000000000000000000019999)					select: [:f | f isPrime] thenCollect: [:s | s asString].		(100000000000000000000000020000 to: 100000000000000000000000039999)					select: [:f | f isPrime] thenCollect: [:s | s asString].		(100000000000000000000000040000 to: 100000000000000000000000059999)					select: [:f | f isPrime] thenCollect: [:s | s asString]].	^ { #parallelExecutionTime -> parallelExecutionTime . #serialExecutionTime -> serialExecutionTime }! !!RemoteTask class methodsFor: 'examples' stamp: 'dtl 11/13/2011 00:32'!threeParallelTasks	"Find all primes in a range of large integers. Divide the problem into	three tasks running the three child images, and return the results to	the supervisory image. Answer a tasks array and a results array, where	the results array will be populated on completion of the tasks."	"RemoteTask threeParallelTasks"	| p1 p2 p3 results task1 task2 task3 |	results := Array new: 3.	task1 := [(100000000000000000000000000000					to: 100000000000000000000000019999)				select: [:f | f isPrime] thenCollect: [:s | s asString]].	task2 := [(100000000000000000000000020000					to: 100000000000000000000000039999)				select: [:f | f isPrime] thenCollect: [:s | s asString]].	task3 := [(100000000000000000000000040000					to: 100000000000000000000000059999)				select: [:f | f isPrime] thenCollect: [:s | s asString]].	"n.b. Assign task to a variable to prevent RemoteTask from being finalized"	p1 := RemoteTask do: task1 whenComplete: [:result | results at: 1 put: result].	p2 := RemoteTask do: task2 whenComplete: [:result | results at: 2 put: result].	p3 := RemoteTask do: task3 whenComplete: [:result | results at: 3 put: result].	^ { #tasks -> { p1 . p2 . p3 } . #results -> results }! !!RemoteTask class methodsFor: 'class initialization' stamp: 'dtl 2/16/2015 19:01'!useFuelSerializer	"RemoteTask useFuelSerializer"	Serializer := (Smalltalk at: #FLSerializer ifAbsent: [self error: 'Fuel not installed']) newDefault.	Materializer := (Smalltalk at: #FLMaterializer) newDefault..	^SerializingStrategy := #fuel! !!RemoteTask class methodsFor: 'class initialization' stamp: 'dtl 2/16/2015 19:00'!useMagmaSerializer	"RemoteTask useMagmaSerializer"	Serializer := (Smalltalk at: #MaObjectSerializer ifAbsent: [self error: 'Magma serializer not installed']) new.	Materializer := Serializer.	^SerializingStrategy := #magma! !!RemoteTask class methodsFor: 'class initialization' stamp: 'dtl 2/16/2015 19:01'!useReferenceStreamSerializer	"RemoteTask useReferenceStreamSerializer"	Serializer := (Smalltalk at: #ReferenceStream).	Materializer := Serializer.	^SerializingStrategy := #referenceStream! !!RemoteTask methodsFor: 'finalization' stamp: 'dtl 11/12/2011 21:30'!finalize	"If garbage collected before remote processing is complete, the AIO	handler process should be terminated and the external process should	be stopped. When evaluating a #do:whenComplete: a reference should	be maintained to the RemoteTask in order to avoid this finalization."	aioHandler ifNotNilDo: [:aio | aio close].	childProxy ifNotNilDo: [:child | child terminate]! !!RemoteTask methodsFor: 'serializing' stamp: 'dtl 2/16/2015 19:13'!getResult	"Materialize the result, reading serialized data from standard input"	SerializingStrategy = #referenceStream		ifTrue: [^(Materializer on: childProxy pipeFromOutput reader) next].	SerializingStrategy = #fuel		ifTrue: [^(Materializer materializeFrom: childProxy pipeFromOutput reader binary) root].	SerializingStrategy = #magma		ifTrue: [^Materializer objectFromStream: childProxy pipeFromOutput reader].	self error: 'undefined strategy ', SerializingStrategy asString! !!RemoteTask methodsFor: 'serializing' stamp: 'dtl 2/16/2015 19:14'!put: result	"Serialize the result and write to standard output"	SerializingStrategy = #referenceStream		ifTrue: [ ^ (Serializer on: OSProcess thisOSProcess stdOut) nextPut: result].	SerializingStrategy = #fuel		ifTrue: [ ^ Serializer serialize: result on: OSProcess thisOSProcess stdOut binary].	SerializingStrategy = #magma		ifTrue: [ ^Serializer object: result toStream: OSProcess thisOSProcess stdOut].	self error: 'undefined strategy ', SerializingStrategy asString! !!RemoteTask methodsFor: 'finalization' stamp: 'dtl 11/12/2011 23:07'!registerForFinalization		self toFinalizeSend: #finalize:		to: self class		with: self copy! !!RemoteTask methodsFor: 'evaluating' stamp: 'dtl 11/27/2011 12:26'!result	"Answer the result of a previously started task. The child Squeak sends one	result object back to its parent Squeak before exiting."	^self getResult! !!RemoteTask methodsFor: 'evaluating' stamp: 'dtl 2/19/2015 22:52'!start	"Fork a headless child Squeak to evaluate my task."	| childBlock result |	self registerForFinalization.	"Create block to be evaluated in a Squeak child process."	childBlock := ["First set standard input to blocking. This avoids a delay to wait for		data to be available, but note that it is dangerous to do this unless you		are certain that you know in advance that the correct number of characters		will be available on the input. If this is not the case, then the VM will block		on the read and lock up the child squeak process."		result := [self task value]					on: Exception					do: [:e |						HeadlessChild ifFalse: [ e halt; resume ].						result := 'remote task execution failed: ', e printString].		OSProcess thisOSProcess stdIn setBlocking.		self put: result.		OSProcess thisOSProcess stdOut flush; close].	"Fork a child Squeak that will evaluate the childBlock then exit"	childProxy := PipeableOSProcess					forkSqueakAndDoThenQuit: childBlock					errorPipelineStream: InternalPipe nonBlockingPipe					headless: HeadlessChild					bufferedOutput: false					outputNotifier: aioHandler! !!RemoteTask methodsFor: 'accessing' stamp: 'dtl 1/25/2010 19:03'!task	"Answer the value of task"	^ task! !!RemoteTask methodsFor: 'accessing' stamp: 'dtl 1/25/2010 19:03'!task: anObject	"Set the value of task"	task := anObject! !!RemoteTask methodsFor: 'evaluating' stamp: 'dtl 11/12/2011 23:20'!task: taskBlock whenComplete: aOneArgumentBlock	"Evaluate taskBlock in an image running in a separate OS process.	Set the completion block, a block that takes result object as its single argument.	Start remote processing with an AIO event notifier. Completion of the remote task	will result in a changed notification from the event notifier, which will activate the	completion block. The completion block is expected to do something useful with	the result of the remote task."	"n.b. Inspect the RemoteTask to prevent it being garbage collected and finalized	before processing is complete"	"(RemoteTask new task: [2 + 2] whenComplete: [ :result | result inspect]) inspect"	"(RemoteTask new task: [(Delay forSeconds: 3) wait. 2 + 2] whenComplete: [ :result | result inspect]) inspect"	task := taskBlock.	completionBlock := aOneArgumentBlock.	aioHandler ifNotNil: [aioHandler close].	aioHandler := AioEventHandler new.	aioHandler addDependent: self.	self start! !!RemoteTask methodsFor: 'updating' stamp: 'dtl 11/11/2011 10:47'!update: anObject	"An event handler has indicated availability of data on the pipe from	the remote process. Begin reading data until the entire result object	is received. The remote process will exit when complete, but possibly	not until data has been read from the pipe, as it may block on write	until the pipe has been serviced."	(anObject isKindOf: AioEventHandler)		ifTrue: [[completionBlock						ifNotNil: [completionBlock value: self result]]					ensure: [anObject close]]! !!RemoteTask methodsFor: 'evaluating' stamp: 'dtl 11/27/2011 11:34'!value	"Start a remote task and read the result object. The child Squeak sends one	result object back to its parent Squeak before exiting."	"(RemoteTask new task: [2 + 2]) value"	self start.	^self result! !!PipeJunction class methodsFor: 'defaults' stamp: 'dtl 4/2/2006 13:10'!externalPipeClass	"If external pipes are not supported, use an internal pipe instead"	"self externalPipeClass"	^ Smalltalk		at: #ExternalPipe		ifAbsent: [Smalltalk			at: #OSPipe "Older versions of OSProcess"			ifAbsent: [InternalPipe]]! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 3/29/2003 11:33'!atEnd	"True after processing is complete and all available data has been read from	the output pipe."	^ pipeFromOutput atEnd and: [self isComplete]! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 6/4/2006 18:10'!atEndOfFile	"True after processing is complete and all available data has been read	from the output pipe. Uses feof() to test for the end of file flag, which	will have been set by a previous read operation."	^ pipeFromOutput isNil		or: [pipeFromOutput atEndOfFile				and: [self isComplete]]! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 11/15/2002 09:09'!canProvideOutputPipe	"If a subclass is not able to provide pipe output, it may answer false.	This may happen if output has been redirected to a file."	^ self pipeFromOutput notNil! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 3/11/2007 11:00'!close	"Close pipe to proxy input."	pipeToInput ifNotNil: [pipeToInput close]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 8/24/2012 08:31'!closeErrorPipeline	self errorPipelineStream ifNotNil: [[errorPipelineStream close]		on: Error		do: ["may be called from multiple processes, so tolerate primitive failure"]]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 9/3/2010 17:15'!closeOutput	self pipeFromOutput ifNotNil: [pipeFromOutput close]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 11/24/2006 12:59'!closePipeInputs	"Close all pipe endpoints not used after process termination."	pipeToInput		ifNotNil: [pipeToInput close].	pipeFromOutput ifNotNil:		[pipeFromOutput isPipe			ifTrue: [pipeFromOutput closeWriter]			ifFalse: [pipeFromOutput close]]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 8/20/2006 18:54'!closePipes	self closeOutput.	pipeToInput ifNotNil: [pipeToInput close].	self errorHasBeenRedirected ifTrue: [errorPipelineStream close]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 8/26/2006 13:42'!closeWriter	"No further input expected"	(self pipeToInput notNil and: [pipeToInput isPipe])		ifTrue: [pipeToInput closeWriter]! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 8/26/2006 12:11'!complete	"Evaluation has been completed. Perform any necessary cleanup."	^ self closePipeInputs! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 11/14/2002 06:35'!enableErrorStreamTriggers	"Set the error stream to be event driven if possible, and answer true	if event driven output is supported, otherwise false."	^ false! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 1/6/2003 20:31'!enableEventTriggers	"Set the output stream to be event driven if possible, and answer true if	event driven output is supported, otherwise false. See #update: for event	triggering logic."	^ self enableOutputStreamTriggers! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 6/5/2006 07:19'!enableOutputStreamTriggers	"Set the output stream to be event driven if possible, and answer true	if event driven output is supported, otherwise false."	(pipeFromOutput notNil and: [pipeFromOutput isPipe])		ifTrue: [^ pipeFromOutput setBufferedReader]		ifFalse: [^ false]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 1/25/2003 13:07'!ensurePipeFromOutput	"Make sure that an output pipe is provided."	^ self pipeFromOutput ifNil: [self pipeFromOutput: InternalPipe new]! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 11/21/2006 14:56'!errorHasBeenRedirected	"Answer true if the error output has been redirected to an external file	and is not available to be read as error output of a pipeline."	^ self errorPipelineStream isPipe not! !!PipeJunction methodsFor: 'command pipelines' stamp: 'dtl 3/22/2003 14:48'!errorPipeForNextProxy	^ self errorHasBeenRedirected		ifTrue: [nil]		ifFalse: [self errorPipelineStream]! !!PipeJunction methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:35'!errorPipelineStream	"Accumulates the error output of commands in a command pipeline."	errorPipelineStream isNil ifTrue: [errorPipelineStream := InternalPipe nonBlockingPipe].	^ errorPipelineStream! !!PipeJunction methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:35'!errorPipelineStream: aStream	"Accumulates the error output of commands in a command pipeline."	errorPipelineStream := aStream! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 6/3/2006 10:40'!errorUpToEnd	"Answer all available characters from my error stream."	^ (errorPipelineStream isNil or: [self errorHasBeenRedirected])		ifTrue: ['']		ifFalse: [errorPipelineStream upToEnd]! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 7/17/2006 05:48'!errorUpToEndOfFile	"Answer all available characters from the error stream. Block and	continue reading until end of file is detected."	^ (errorPipelineStream isNil or: [self errorHasBeenRedirected])		ifTrue: ['']		ifFalse: [errorPipelineStream upToEndOfFile]! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 9/19/2002 09:30'!flush	"Flush output to the standard input stream of my external process. If no	external process is involved, do nothing."! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 9/3/2010 17:17'!handleRedirectedOutputOf: predecessorProxy	"If the output of predecessorProxy (in a pipeline) has been redirected,	this pipe junction will not know when predecessorProxy has completed	unless it requests notification. The pipe to input of this pipe junction should	not be closed until predecessorProxy is complete, so close the pipe when the	completion event occurs."	predecessorProxy ifNotNil:		[(predecessorProxy canProvideOutputPipe not			and: [self inputHasBeenRedirected not]) ifTrue:				[self pipeToInput					ifNotNil:						[predecessorProxy							when: #complete							send: #close							to: pipeToInput writer]]]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 9/10/2002 00:15'!initialize	(self requiresNonBlockingInput and: [pipeToInput isKindOf: OSPipe])		ifTrue:[pipeToInput setNonBlocking]			! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 11/21/2006 16:21'!inputHasBeenRedirected	"Answer true if the input stream has been redirected to an external file."	^ self pipeToInput notNil and: [pipeToInput isPipe not]! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 4/14/2006 11:35'!isComplete	^ self subclassResponsibility! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 3/9/2002 18:16'!isExternalProcess	"Answer true if the process which I represent is an external OSProcess."	^ false! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 9/19/2002 09:23'!next	^ pipeFromOutput next! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 9/19/2002 09:24'!next: count	^ pipeFromOutput next: count! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 9/19/2002 09:28'!nextFromError: count	"Answer up to count characters from the error pipeline stream, or an empty string	if no data is available. All characters are routed through the errorPipelineStream,	so that they are concatenated with any preceeding error message text (possibly from	a preceeding process in a command pipeline)."	^ errorPipelineStream next: count! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 9/19/2002 09:24'!nextPut: aCharacter	"Write aCharacter to the standard input stream of my external process."	^ pipeToInput nextPut: aCharacter! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 9/19/2002 09:25'!nextPutAll: characters	"Write characters to the standard input stream of my external process."	^ pipeToInput nextPutAll: characters! !!PipeJunction methodsFor: 'command pipelines' stamp: 'dtl 2/24/2013 10:25'!output	"Wait for process completion, and answer all available output."	"((PipeableOSProcess command: 'ps') | 'grep squeak' | 'cut -c16-100') output"	^ (self isNotYetRunning not and: [self canProvideOutputPipe])		ifTrue: [(self outputOn: (WriteStream on: String new)) contents]		ifFalse: ['']! !!PipeJunction methodsFor: 'command pipelines' stamp: 'dtl 11/8/2007 20:35'!outputAndError	"Answer an array with output and error contents. If standard error has been	redirected to a file, answer a null string as the error message."	"((PipeableOSProcess command: 'ps') | 'NoSuchCommand; grep squeak' | 'cut -c16-100') outputAndError"	| out err |	out := self output.	(self errorHasBeenRedirected)		ifTrue: [err := '']		ifFalse: [err := errorPipelineStream contents].	^ Array with: out with: err! !!PipeJunction methodsFor: 'command pipelines' stamp: 'dtl 11/8/2007 20:35'!outputOn: aStream	"Wait for process completion, writing all available output on aStream"	| d |	d := nil.	[self isComplete] whileFalse:		[(d ifNil: [d := Delay forMilliseconds: 50]) wait.		aStream nextPutAll: self upToEnd].	aStream nextPutAll: self upToEndOfFile.	^ aStream! !!PipeJunction methodsFor: 'command pipelines' stamp: 'dtl 4/14/2006 11:31'!outputPipeForNextProxy	^ self canProvideOutputPipe		ifTrue: [pipeFromOutput]		ifFalse: [nil]! !!PipeJunction methodsFor: 'accessing' stamp: 'dtl 3/4/2002 21:46'!pipeFromOutput	^ pipeFromOutput! !!PipeJunction methodsFor: 'accessing' stamp: 'dtl 9/3/2010 17:18'!pipeFromOutput: aPipeStream	(pipeFromOutput := aPipeStream)		ifNotNil: [pipeFromOutput addDependent: self]! !!PipeJunction methodsFor: 'accessing' stamp: 'dtl 3/4/2002 21:36'!pipeToInput	^ pipeToInput! !!PipeJunction methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:36'!pipeToInput: aPipeStream	pipeToInput := aPipeStream! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 6/4/2006 17:26'!pipesAreEmpty	"True after processing is complete and all available data has been read 	from the output pipe and the errorPipelineStream pipe."	^ self atEndOfFile		and: [self errorHasBeenRedirected				or: [errorPipelineStream atEnd]]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 1/2/2003 21:18'!prepareOutputFor: aPipeJunction	"External process proxies are independent of the Smalltalk image and do	not require event driven input. Internal proxies will prefer to request	event notification."	aPipeJunction isExternalProcess		ifTrue: [self prepareOutputForPipe]		ifFalse: [self prepareOutputForInternalReader]! !!PipeJunction methodsFor: 'command pipelines - private' stamp: 'dtl 11/25/2006 11:03'!prepareOutputForInternalReader	"Output stream will be used directly by a Smalltalk process. Set output 	stream characteristics accordingly."	self canProvideOutputPipe		ifTrue: [pipeFromOutput setNonBlocking].	self enableEventTriggers! !!PipeJunction methodsFor: 'command pipelines - private' stamp: 'dtl 12/3/2006 12:34'!prepareOutputForPipe	"Output stream will be used by another process proxy as input. Set output stream	characteristics accordingly. The output stream will be owned by the next process	in a pipeline, but the error stream is shared by all processes in the pipeline, and	can be event driven."	Smalltalk		at: #AioEventHandler		ifPresent: [:aio | aio aioPluginPresent				ifTrue: [self enableErrorStreamTriggers]]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 1/4/2003 15:44'!release	"The input pipe may be released, but the output and error pipes may	still be in use."	self pipeToInput release.	^ super release! !!PipeJunction methodsFor: 'command pipelines' stamp: 'dtl 11/8/2007 20:35'!replaceOutputStreamWith: anotherStream	"Sender is not happy with the kind of output stream we are using. Replace	pipeFromOutput with anotherStream, and copy the current contents of pipeFromOutput	to the new stream."	| oldOutputStream |	oldOutputStream := self pipeFromOutput.	oldOutputStream removeDependent: self. "Break old dependency"	self pipeFromOutput: anotherStream. "Restores the dependency automatically"	oldOutputStream ifNotNil:		[anotherStream ifNotNil:			[anotherStream nextPutAll: oldOutputStream contents].		oldOutputStream close]! !!PipeJunction methodsFor: 'testing' stamp: 'dtl 9/9/2002 13:50'!requiresNonBlockingInput	"A PipeJunction managed by Squeak may be subject to deadlocks associated with	reading or writing an OSPipe. Answer true if the input pipe must function in	nonBlocking mode in order to prevent deadlocks. This method exists simply to	make the requirement explicit."	^ true! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 7/14/2002 23:51'!resetStdioStreams	"After an image restart, call this method to reset to the correct input, output	and error streams if they are attached to standard input, output or error."	Smalltalk at: #OSProcess ifPresent:		[:osp |		((self pipeToInput respondsTo: #isStdIn) and: [pipeToInput isStdIn])			ifTrue: [self pipeToInput: osp thisOSProcess stdIn].		((self pipeToInput respondsTo: #isStdOut) and: [pipeToInput isStdOut])			ifTrue: [self pipeToInput: osp thisOSProcess stdOut].		((self pipeToInput respondsTo: #isStdErr) and: [pipeToInput isStdErr])			ifTrue: [self pipeToInput: osp thisOSProcess stdErr]]! !!PipeJunction methodsFor: 'initialize - release' stamp: 'dtl 9/28/2002 20:54'!setNonBlockingOutput	"Check first to make sure process is not complete because pipeFromOutput will not respond	to #setNonBlocking after the process has exited."	self isComplete ifFalse: [pipeFromOutput setNonBlocking]! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 7/7/2006 00:32'!triggerComplete	self triggerEvent: #complete! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 7/7/2006 09:11'!triggerErrorDataReady	self triggerEvent: #errorDataReady.	Processor yield! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 7/7/2006 09:11'!triggerOutputDataReady	self triggerEvent: #outputDataReady.	Processor yield! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 6/3/2006 10:38'!upToEnd	"Answer all available characters from the output stream."	^ (self pipeFromOutput notNil and: [self canProvideOutputPipe])		ifTrue: [pipeFromOutput upToEnd]		ifFalse: ['']! !!PipeJunction methodsFor: 'streaming' stamp: 'dtl 6/3/2006 10:38'!upToEndOfFile	"Answer all available characters from the output stream. Block and	continue reading until end of file is detected."	^ (self pipeFromOutput notNil and: [self canProvideOutputPipe])		ifTrue: [pipeFromOutput upToEndOfFile]		ifFalse: ['']! !!PipeJunction methodsFor: 'updating' stamp: 'dtl 8/19/2006 11:43'!update: aParameter	^ self changed: aParameter! !!PipeJunction methodsFor: 'event handling' stamp: 'dtl 11/21/2002 18:38'!updateErrorPipelineStream	"Ensure that all available error output is placed into errorPipelineStream."! !!ExpressionEvaluator class methodsFor: 'instance creation' stamp: 'dtl 3/26/2006 12:10'!block: aBlock	"(self block: [#'This block answers a symbol as String']) value upToEnd"	^ self basicNew block: aBlock! !!ExpressionEvaluator class methodsFor: 'instance creation' stamp: 'dtl 3/26/2006 12:09'!command: aString	"(self command: '''Hello world!!''') value upToEnd"	^ self basicNew command: aString! !!ExpressionEvaluator class methodsFor: 'instance creation' stamp: 'dtl 12/13/2007 21:38'!command: aString pipeFrom: inputStream errorPipelineStream: errorStream	"(self command: 'stdout nextPutAll: stdin upToEnd'		pipeFrom: (ReadStream on: 'Here is some input text')		errorPipelineStream: InternalPipe nonBlockingPipe)			value upToEnd"	^ self command: aString pipeFrom: inputStream pipeTo: nil errorPipelineStream: errorStream! !!ExpressionEvaluator class methodsFor: 'instance creation' stamp: 'dtl 12/13/2007 21:38'!command: aString pipeFrom: inputStream pipeTo: outputStream errorPipelineStream: errorStream	"(self command: 'stdout nextPutAll: stdin contents'		pipeFrom: (ReadStream on: 'Here is some input text')		pipeTo: nil		errorPipelineStream: InternalPipe nonBlockingPipe)			value upToEnd"	^ super new		expression: aString;		pipeToInput: inputStream;		pipeFromOutput: outputStream;		errorPipelineStream: errorStream;		notYetRunning;		initialize! !!ExpressionEvaluator methodsFor: 'evaluating' stamp: 'dtl 2/1/2003 16:34'!addTreeLeaves: treeOfSymbols to: aCollection	"Flatten a tree of Symbols built by a Scanner."	treeOfSymbols do: [:e |		(e isKindOf: Array)			ifTrue: [self addTreeLeaves: e to: aCollection]			ifFalse: [aCollection add: e]].	^ aCollection! !!ExpressionEvaluator methodsFor: 'initialize - release' stamp: 'dtl 4/19/2003 16:29'!block: aBlock	self evaluationBlock: aBlock.	self initialize.	self prepareOutputForInternalReader! !!ExpressionEvaluator methodsFor: 'evaluating' stamp: 'dtl 11/8/2007 20:32'!blockString	"Answer source code for a block to execute my expression. Attempt to give it the correct	number of parameters based on scanning expression for use of #args, #stderr, #stdout,	and #stdin tokens."	"PipeableEvaluator new expression: 'stdout nextPutAll: (args at: 4)'; blockString"	"PipeableEvaluator new expression: 'stderr nextPutAll: stdin contents'; blockString"	"PipeableEvaluator new expression: 'stdout nextPutAll: stdin contents'; blockString"	"PipeableEvaluator new expression: 'stdin contents'; blockString"	"PipeableEvaluator new expression: '#HelloWorld'; blockString"	| tokens prefix |	self expression isNil		ifTrue:			[^ '[]']		ifFalse:			[tokens := self addTreeLeaves: (Scanner new scanTokens: expression) to: OrderedCollection new.			(tokens includes: #args)				ifTrue:					[prefix := '[:stdin :stdout :stderr :args | ']				ifFalse:					[(tokens includes: #stderr)						ifTrue:							[prefix := '[:stdin :stdout :stderr | ']						ifFalse:							[(tokens includes: #stdout)								ifTrue:									[prefix := '[:stdin :stdout | ']								ifFalse:									[(tokens includes: #stdin)										ifTrue:											[prefix := '[:stdin | ']										ifFalse:											[prefix := '[']]]].			^ prefix, self expression, ']']! !!ExpressionEvaluator methodsFor: 'evaluating' stamp: 'dtl 11/8/2007 20:32'!blockValue	"Evaluate my evaluationBlock. For a smart block, answer self. For a dumb	block, answer the result of evaluating it. Heuristic: If the block receives	two or more arguments, then assume that it was smart enough to write	output to stdout. Otherwise, assume that it was a dumb block."	| nArgs |	self evaluationBlock ifNil: [^ nil].	nArgs := evaluationBlock numArgs.	(nArgs == 0)		ifTrue: "dumb block"			[^ evaluationBlock value]		ifFalse:			[(nArgs == 4)				ifTrue: "smart block"					[evaluationBlock						value: self pipeToInput						value: self pipeFromOutput						value: self errorPipelineStream						value: self argumentArray]				ifFalse:					[(nArgs == 3)						ifTrue: "smart block"							[evaluationBlock								value: self pipeToInput								value: self pipeFromOutput								value: self errorPipelineStream]						ifFalse:							[(nArgs == 2)								ifTrue: "smart block"									[evaluationBlock										value: self pipeToInput										value: self pipeFromOutput]									ifFalse:									[(nArgs == 1)										ifTrue: "dumb block"											[^ evaluationBlock value: self pipeToInput]										ifFalse: "really stupid block"											[self error: 'expected block with 4 or fewer arguments'.											^ nil]]]]]! !!ExpressionEvaluator methodsFor: 'initialize - release' stamp: 'dtl 4/19/2003 16:25'!command: aString	self expression: aString.	self initialize.	self prepareOutputForInternalReader! !!ExpressionEvaluator methodsFor: 'evaluating' stamp: 'dtl 11/29/2010 23:33'!compile	"Compile my expression into a block with zero to four parameters. The parameters,	if present, correspond to my pipeToInput, pipeFromOutput, errorPipelineStream, and	an array of extra parameters (in that order). By convention, these are named 'stdin',	'stdout', 'stderr', and 'args' within my expression string.	If the compilation fails due to a syntax error (compile time failure, not run time	failure), put an error message on the standard error stream and answer a block	which evaluates to a null string."	evaluationBlock ifNil:		[evaluationBlock :=			[Compiler evaluate: self blockString					for: self					notifying: self					logged: false]				on: Exception				do: [:e |					self errorPipelineStream						nextPutAll: 'Compiler: invalid Smalltalk expression ', self blockString;						nextPut: Character lf.					self fail.					nil]]! !!ExpressionEvaluator methodsFor: 'accessing' stamp: 'dtl 2/1/2003 16:34'!evaluationBlock	"Answer the block to be evaluated, possibly compiling it from the expression string."	evaluationBlock ifNil: [self compile].	^ evaluationBlock! !!ExpressionEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:32'!evaluationBlock: aBlock	"The block to be evaluated, possibly compiled from the expression string."	evaluationBlock := aBlock! !!ExpressionEvaluator methodsFor: 'accessing' stamp: 'dtl 2/1/2003 16:34'!expression	^ expression! !!ExpressionEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:32'!expression: aString	expression := aString! !!ExpressionEvaluator methodsFor: 'printing' stamp: 'dtl 3/24/2003 07:23'!printOn: aStream	super printOn: aStream.	self expression isNil		ifTrue:			[self evaluationBlock isNil				ifTrue:					[aStream nextPutAll: ' for '.					self evaluationBlock printOn: aStream]				ifFalse:					[aStream nextPutAll: ' for a '.					self evaluationBlock class printOn: aStream]]		ifFalse:			[aStream nextPutAll: ' for '.			self expression printOn: aStream]! !!ExpressionEvaluator methodsFor: 'evaluating' stamp: 'dtl 11/8/2007 20:32'!value	"Evaluate my evaluationBlock. If the block evaluates to anything other	than self, then print the result on pipeFromOutput as output. Otherwise,	assume that the block was smart enough to have written its own output.	For a block which does not write its own output, add a trailing line	terminator after the evaluation if needed. Answer self as the result of	the evaluation."	| result resultString |	self success. "Hope for the best, send #fail if something goes wrong"	self isNotYetRunning ifTrue:		[self ensurePipeFromOutput.		self running.		self evaluationBlock notNil			ifTrue:				[result := [self blockValue]					on: Error					do: [:e |						self errorPipelineStream nextPutAll: e description; nextPut: Character lf.						self fail].				(result == self)					ifFalse:						[resultString := result asString.						pipeFromOutput nextPutAll: resultString.						(resultString isEmpty not and:							[(resultString last ~= Character cr) and:								[resultString last ~= Character lf]])							ifTrue: [pipeFromOutput nextPut: Character lf]]]			ifFalse:				[self fail].		self complete]! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 2/1/2003 16:45'!argumentArray	^ argumentArray! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:36'!argumentArray: anArrayOfStrings	argumentArray := anArrayOfStrings! !!PipeableEvaluator methodsFor: 'testing' stamp: 'dtl 6/8/2003 22:37'!atEnd	"True after processing is complete and all available data has been read from	the output pipe."	^ self isComplete		and: [self outputHasBeenRedirected				or: [self outputIsExternalStream					or: [pipeFromOutput atEnd]]]! !!PipeableEvaluator methodsFor: 'testing' stamp: 'dtl 11/15/2002 09:10'!canProvideOutputPipe	"Answer false if output has been redirected to a file and cannot be accessed by	the next process proxy in a command pipeline."	^ super canProvideOutputPipe and: [self outputHasBeenRedirected not]! !!PipeableEvaluator methodsFor: 'setting run state' stamp: 'dtl 11/24/2006 13:01'!complete	"Evaluation has been completed. Perform some cleanup and notify	interested parties."	self closePipeInputs.	self runState: #complete.	self errorHasBeenRedirected		ifTrue: [self closeErrorPipeline]! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:36'!errorPipelineStream	"Accumulates the error output of commands in a command pipeline."	errorPipelineStream isNil		ifTrue:			[errorPipelineStream := InternalPipe nonBlockingPipe.			errorPipelineStream addDependent: self].	^ errorPipelineStream! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:36'!errorPipelineStream: aStream	"Accumulates the error output of commands in a command pipeline."	errorPipelineStream ifNotNil: [errorPipelineStream removeDependent: self].	errorPipelineStream := aStream.	errorPipelineStream ifNotNil: [errorPipelineStream addDependent: self]! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 4/19/2003 09:56'!exitStatus	^ exitStatus! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:36'!exitStatus: aSymbol	exitStatus := aSymbol! !!PipeableEvaluator methodsFor: 'evaluating' stamp: 'dtl 11/25/2001 22:39'!fail	self exitStatus: #fail! !!PipeableEvaluator methodsFor: 'initialize - release' stamp: 'dtl 9/9/2002 13:51'!initialize	"If pipeFromOutput has been set, then the output stream is being redirected.	Set a flag to indicate this, otherwise open new a pipe stream to use for output."	pipeFromOutput isNil		ifTrue: [self ensurePipeFromOutput]		ifFalse: [self outputHasBeenRedirected: true].	^ super initialize! !!PipeableEvaluator methodsFor: 'testing' stamp: 'dtl 3/4/2002 06:58'!isComplete	^ self runState == #complete! !!PipeableEvaluator methodsFor: 'testing' stamp: 'dtl 3/4/2002 06:59'!isNotYetRunning	^ self runState == #notYetRunning! !!PipeableEvaluator methodsFor: 'streaming' stamp: 'dtl 11/8/2007 20:37'!nextPut: aCharacter	"Write aCharacter to the standard input stream of my process."	| readPosition |	readPosition := pipeToInput position.	pipeToInput setToEnd nextPut: aCharacter.	pipeToInput position: readPosition.	^ pipeToInput! !!PipeableEvaluator methodsFor: 'streaming' stamp: 'dtl 11/8/2007 20:37'!nextPutAll: aCollection	"Write aCollection to the standard input stream of my process."	| readPosition |	readPosition := pipeToInput position.	pipeToInput setToEnd nextPutAll: aCollection.	pipeToInput position: readPosition.	^ pipeToInput! !!PipeableEvaluator methodsFor: 'setting run state' stamp: 'dtl 3/4/2002 22:32'!notYetRunning	"Process has not yet entered running state."	self runState: #notYetRunning! !!PipeableEvaluator methodsFor: 'error handling' stamp: 'dtl 11/8/2007 20:37'!notify: aString at: aPosition in: aStream	| s |	s := aStream contents.	self errorPipelineStream		nextPutAll: (s copyFrom: 1 to: (aPosition - 1));		nextPutAll: aString;		nextPutAll: (s copyFrom: aPosition to: s size);		cr! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:37'!outputHasBeenRedirected	"True if pipeFromOutput has been redirected to a FileStream"	^ outputHasBeenRedirected ifNil: [outputHasBeenRedirected := false]! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:37'!outputHasBeenRedirected: trueOrFalse	"True if pipeFromOutput has been redirected to a FileStream"	outputHasBeenRedirected := trueOrFalse! !!PipeableEvaluator methodsFor: 'testing' stamp: 'dtl 6/8/2003 22:35'!outputIsExternalStream	"True if output is being piped to an external proxy, or if output has been	redirected to a file."	^ self pipeFromOutput isKindOf: FileStream! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/29/2006 06:29'!pipeFromError	"Internal evaluators use the errorPipelineStream directly"	^ self errorPipelineStream! !!PipeableEvaluator methodsFor: 'printing' stamp: 'dtl 1/12/2003 00:45'!printOn: aStream	super printOn: aStream.	aStream nextPutAll: ' ('; nextPutAll: self runState; nextPut: $)! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:37'!runState	^ runState ifNil: [runState := #notYetRunning]! !!PipeableEvaluator methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:37'!runState: aSymbol	runState := aSymbol.	self changed: #runState! !!PipeableEvaluator methodsFor: 'setting run state' stamp: 'dtl 3/4/2002 22:32'!running	"Process is actively running."	self runState: #running! !!PipeableEvaluator methodsFor: 'error handling' stamp: 'dtl 4/7/2001 21:27'!selectFrom: start to: end	^ self blockString copyFrom: start to: end! !!PipeableEvaluator methodsFor: 'error handling' stamp: 'dtl 4/7/2001 19:50'!selectionInterval	"The compiler wants this for some reason."	^ 1 to: 1! !!PipeableEvaluator methodsFor: 'testing' stamp: 'dtl 12/22/2001 18:37'!succeeded	"Answer true if my evaluation completed successfully."	^ self exitStatus == #success! !!PipeableEvaluator methodsFor: 'evaluating' stamp: 'dtl 11/25/2001 22:39'!success	self exitStatus: #success! !!PipeableEvaluator methodsFor: 'error handling' stamp: 'dtl 12/8/2001 18:13'!text	"The compiler needs this to generate error messages."	^ Text fromString: self expression! !!PipeableEvaluator methodsFor: 'setting run state' stamp: 'dtl 3/4/2002 22:32'!unknownRunState	"Unable to determine the current run state of the process."	self runState: #unknownRunState! !!PipeableEvaluator methodsFor: 'command pipelines' stamp: 'dtl 11/8/2007 20:38'!| anotherCommandString	"Pipe my output to another evaluator, where the other evaluator evaluates	anotherCommandString."	"((ExpressionEvaluator command: 'Smalltalk')		| 'stdout nextPutAll: stdin upToEnd'		| 'stdout nextPutAll: stdin upToEnd') upToEnd"	"(ExpressionEvaluator command: 'BOGUS')		| 'stdout nextPutAll: stdin upToEnd'		| 'stdout nextPutAll: stdin upToEnd'"	"((ExpressionEvaluator command: '(true == false) not')		| 'stdout nextPutAll: stdin upToEnd'		| 'stdout nextPutAll: stdin upToEnd') upToEnd"	| new |	new := self species			command: anotherCommandString			pipeFrom: self pipeFromOutput			errorPipelineStream: self errorPipelineStream.	self value.	^ new! !!ShellBuiltinEvaluator class methodsFor: 'instance creation' stamp: 'dtl 2/1/2003 16:01'!command: aShellBuiltin withArguments: argumentArray shell: commandShell pipeFrom: inputStream pipeTo: outputStream errorPipelineStream: errorStream	^ super new		shellBuiltin: aShellBuiltin;		argumentArray: argumentArray;		commandShell: commandShell;		pipeToInput: inputStream;		pipeFromOutput: outputStream;		errorPipelineStream: errorStream;		initialize! !!ShellBuiltinEvaluator methodsFor: 'accessing' stamp: 'dtl 2/1/2003 15:13'!commandShell	^ commandShell! !!ShellBuiltinEvaluator methodsFor: 'accessing' stamp: 'dtl 2/1/2003 15:12'!commandShell: aCommandShell	commandShell := aCommandShell! !!ShellBuiltinEvaluator methodsFor: 'testing' stamp: 'dtl 2/1/2003 16:08'!needsPrompt	"Answer true if a shell will want to issue a prompt after evaluating me."	^ self shellBuiltin needsPrompt! !!ShellBuiltinEvaluator methodsFor: 'printing' stamp: 'dtl 3/22/2003 13:58'!printOn: aStream	super printOn: aStream.	aStream nextPutAll: ' on '.	self shellBuiltin printOn: aStream! !!ShellBuiltinEvaluator methodsFor: 'accessing' stamp: 'dtl 2/1/2003 15:12'!shellBuiltin	^ shellBuiltin! !!ShellBuiltinEvaluator methodsFor: 'accessing' stamp: 'dtl 2/1/2003 15:12'!shellBuiltin: aShellBuiltin	shellBuiltin := aShellBuiltin! !!ShellBuiltinEvaluator methodsFor: 'evaluating' stamp: 'dtl 12/21/2007 12:50'!value	self isNotYetRunning ifTrue:		[self success. "Hope for the best, send #fail if something goes wrong"		self running.		self ensurePipeFromOutput.		self shellBuiltin				performWith: self argumentArray				evaluator: self				shell: self commandShell				input: self pipeToInput				output: self pipeFromOutput				error: self errorPipelineStream]! !!PipeableOSProcess class methodsFor: 'examples' stamp: 'dtl 1/24/2013 19:12'!addTwoPlusTwoInChildSqueak	"Fork a headless child Squeak. Send three objects to the child, and read one object	returned from the child. The child Squeak uses the three objects to compute a result,	which it sends back to its parent Squeak before exiting."	"PipeableOSProcess addTwoPlusTwoInChildSqueak"	| serializerClass childBlock in out rcv op param result childProxy writer sum s inputStream |	(serializerClass := Smalltalk at: #ReferenceStream ifPresent: [:cls | cls ])		ifNil: [^ self notify: 'ReferenceStream not found'].	"Create block to be evaluated in a Squeak child process."	childBlock := ["First set standard input to blocking. This avoids a delay to wait for		data to be available, but note that it is dangerous to do this unless you		are certain that you know in advance that the correct number of characters		will be available on the input. If this is not the case, then the VM will block		on the read and lock up the child squeak process."		OSProcess thisOSProcess stdIn setBlocking.		in := serializerClass on: OSProcess thisOSProcess stdIn.		out := serializerClass on: OSProcess thisOSProcess stdOut.		"read three objects"		rcv := in next.		op := in next.		param := in next.		"add two plus two"		result := rcv perform: op with: param.		"answer the result"		out nextPut: result].	"Fork a child Squeak that will evaluate the childBlock then exit"	childProxy := PipeableOSProcess forkHeadlessSqueakAndDoThenQuit: childBlock.	"Write three objects to the child Squeak process"	writer := serializerClass on: childProxy pipeToInput writer.	writer nextPut: 2.	writer nextPut: #+.	writer nextPut: 2.	"Read the result object from the child Squeak process"	s := RWBinaryOrTextStream with: childProxy pipeFromOutput upToEndOfFile.	s reset.	inputStream := serializerClass on: s.	sum := inputStream next.	"show result of 2 + 2 evaluated in the child Squeak"	self inform: '2 + 2 equals ', sum asString.	^ sum! !!PipeableOSProcess class methodsFor: 'utility' stamp: 'dtl 9/3/2010 17:26'!bash	"Start a Gnu bash command interpreter (enhanced Unix shell)"	"self bash"	"self bash exec: 'ls'; exec: 'who'; close; upToEnd"	| proxyClass |	(proxyClass := self externalProxyClass) ifNotNil:		[^ self command: proxyClass bashShellPath].	^ self notify: 'OSProcess not available'! !!PipeableOSProcess class methodsFor: 'utility' stamp: 'dtl 11/8/2007 20:40'!canAccessOSProcess	"True if OSProcess is in the image and if the OSProcess plugin is functioning properly"	"self canAccessOSProcess"	| osp |	^ (osp := Smalltalk at: #OSProcess ifAbsent: []) notNil and: [osp accessor canAccessSystem]! !!PipeableOSProcess class methodsFor: 'external command processing' stamp: 'dtl 3/4/2002 07:24'!command: aString	"(PipeableOSProcess command: '/bin/echo this is a test') output"	"(PipeableOSProcess command: 'echo this is a test') output"	"(PipeableOSProcess command: '/bin/noSuchCommand this is a test') output"	"(PipeableOSProcess command: 'ls -l Sq*log') output"	"(PipeableOSProcess command: 'ls -l ?q*log') output"	"(PipeableOSProcess command: '/bogusDirectory/ls -l Sq*log') output"	^ self command: aString		environment: nil		workingDir: nil		input: nil		output: nil		error: nil		errorPipelineStream: nil! !!PipeableOSProcess class methodsFor: 'external command processing' stamp: 'dtl 11/8/2011 19:44'!command: aString environment: anEnvironmentDictionary	"| env path |	env := OSProcess thisOSProcess environment copy.	path := (env at: #PATH), ':/opt/local/bin/'.	env at: #PATH put: path.	(PipeableOSProcess command: 'echo $PATH' environment: env) output"	^ self command: aString		environment: anEnvironmentDictionary		workingDir: nil		input: nil		output: nil		error: nil		errorPipelineStream: nil! !!PipeableOSProcess class methodsFor: 'external command processing' stamp: 'dtl 12/13/2007 21:46'!command: aString environment: anEnvironmentDictionary workingDir: pathString input: inputStream output: outputStream error: errorStream errorPipelineStream: anErrorWriteStream	"(PipeableOSProcess command: 'ls -l hosts NOSUCHFILE' environment: nil workingDir: '/etc' input: nil output: nil error: nil errorPipelineStream: (InternalPipe nonBlockingPipe nextPutAll: 'this is the error stream '; yourself)) output"	^ self command: aString		environment: anEnvironmentDictionary		workingDir: pathString		input: inputStream		output: outputStream		error: errorStream		errorPipelineStream: anErrorWriteStream		shellSyntax: nil! !!PipeableOSProcess class methodsFor: 'external command processing' stamp: 'dtl 9/27/2014 11:28'!command: aString environment: anEnvironmentDictionary workingDir: pathString input: inputStream output: outputStream error: errorStream errorPipelineStream: anErrorWriteStream shellSyntax: aSyntaxProcessor	"(PipeableOSProcess command: 'ls -l hosts NOSUCHFILE' environment: nil workingDir: '/etc' input: nil output: nil error: nil errorPipelineStream: (InternalPipe nonBlockingPipe nextPutAll: 'this is the error stream '; yourself) shellSyntax: nil) output"	| p |	p := self		commandNoEvaluate: aString		environment: anEnvironmentDictionary		workingDir: pathString		input: inputStream		output: outputStream		error: errorStream		errorPipelineStream: anErrorWriteStream		shellSyntax: aSyntaxProcessor.	p pipeFromOutput setBufferedReader.	(Delay forMilliseconds: 1) wait. "context switch to enable buffered reader"	p value.	^p! !!PipeableOSProcess class methodsFor: 'external command processing' stamp: 'dtl 4/28/2001 12:04'!command: aCommandString pipeFrom: aPipeStream errorPipelineStream: anErrorStream	"Run a command in a shell process. Similar to the system(3) call in the standard C library,	except that aCommandString runs asynchronously in a child process."	^ self		command: aCommandString		environment: nil		workingDir: nil		input: aPipeStream		output: nil		error: nil		errorPipelineStream: anErrorStream! !!PipeableOSProcess class methodsFor: 'external command processing' stamp: 'dtl 10/13/2008 06:31'!commandNoEvaluate: aString environment: anEnvironmentDictionary workingDir: pathString input: inputStream output: outputStream error: errorStream errorPipelineStream: anErrorWriteStream shellSyntax: aSyntaxProcessor	"Set up the command but do not actually fork the child process."	"PipeableOSProcess commandNoEvaluate: 'ls -l hosts NOSUCHFILE' environment: nil workingDir: '/etc' input: nil output: nil error: nil errorPipelineStream: (InternalPipe nonBlockingPipe nextPutAll: 'this is the error stream '; yourself) shellSyntax: nil"	| nameAndArgs proxyClass |	nameAndArgs := aSyntaxProcessor isNil		ifTrue:			[(proxyClass := self externalProxyClass) isNil				ifTrue:					[Array with: aString with: Array new]				ifFalse:					[Array						with: proxyClass defaultShellPath						with: (Array with: '-c' with: aString)]]		ifFalse:			[aSyntaxProcessor				programNameAndArgumentsFrom: aString				inDirectoryPath: pathString				findExecutable: true].	^ nameAndArgs ifNotNil:		[self new: (nameAndArgs at: 1)			arguments: (nameAndArgs at: 2)			environment: anEnvironmentDictionary			descriptors: (Array with: inputStream with: outputStream with: errorStream)			workingDir: pathString			errorPipelineStream: anErrorWriteStream]! !!PipeableOSProcess class methodsFor: 'process proxy classes' stamp: 'dtl 8/7/2002 13:42'!externalProxyClass	"self externalProxyClass"	^ Smalltalk at: #ExternalOSProcess ifPresent: [:eosp | eosp concreteClass]! !!PipeableOSProcess class methodsFor: 'instance creation' stamp: 'dtl 12/13/2007 21:39'!forkAndExec: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams workingDir: pathString errorPipelineStream: anErrorStream	"Run a program in an external OS process, and answer an instance of myself	which represents the external process."	"PipeableOSProcess forkAndExec: '/bin/ls' arguments: #('-ls' 'hosts' 'NOSUCHFILE') environment: nil descriptors: nil workingDir: '/etc' errorPipelineStream: (InternalPipe nonBlockingPipe nextPutAll: 'this is the error stream '; yourself)"	^ self canAccessOSProcess		ifTrue:			[(self new: executableFile			arguments: arrayOfStrings			environment: stringDictionary			descriptors: arrayOf3Streams			workingDir: pathString			errorPipelineStream: anErrorStream) value; yourself]		ifFalse:			[self notify: 'OSProcess not available or OSProcess plugin not functioning']! !!PipeableOSProcess class methodsFor: 'instance creation' stamp: 'dtl 5/19/2009 23:28'!forkHeadlessSqueakAndDoThenQuit: aBlock	"Start a new headless Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock."	"| child |	child := PipeableOSProcess forkHeadlessSqueakAndDoThenQuit:		[OSProcess thisOSProcess stdOut			nextPutAll: 'hello from headless Squeak child ',				OSProcess thisOSProcess pid asString].	child upToEndOfFile"		^ self forkSqueakAndDoThenQuit: aBlock		errorPipelineStream: InternalPipe nonBlockingPipe		headless: true! !!PipeableOSProcess class methodsFor: 'instance creation' stamp: 'dtl 11/11/2011 10:20'!forkSqueakAndDoThenQuit: aBlock	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock."	"PipeableOSProcess forkSqueakAndDoThenQuit:		[Object inform: 'Hi, I am the child Squeak process. Click OK to exit the child Squeak.']"		^ self		forkSqueakAndDoThenQuit: aBlock		errorPipelineStream: InternalPipe nonBlockingPipe		headless: false! !!PipeableOSProcess class methodsFor: 'instance creation' stamp: 'dtl 11/10/2011 20:25'!forkSqueakAndDoThenQuit: aBlock errorPipelineStream: anErrorStream headless: headless	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock."	^ self		forkSqueakAndDoThenQuit: aBlock		errorPipelineStream: anErrorStream		headless: headless		bufferedOutput: true! !!PipeableOSProcess class methodsFor: 'instance creation' stamp: 'dtl 11/11/2011 11:35'!forkSqueakAndDoThenQuit: aBlock errorPipelineStream: anErrorStream headless: headless bufferedOutput: buffered	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock."	^ self		forkSqueakAndDoThenQuit: aBlock		errorPipelineStream: anErrorStream		headless: headless		bufferedOutput: buffered		outputNotifier: nil! !!PipeableOSProcess class methodsFor: 'instance creation' stamp: 'dtl 6/7/2015 12:05'!forkSqueakAndDoThenQuit: aBlock errorPipelineStream: anErrorStream headless: headless bufferedOutput: buffered outputNotifier: aioEventHandler	"Start a new instance of Squeak running in a child OS process. The new instance is a	clone of this image except for the return value of this method. It does not reload the	image file from disk. The child image evaluates aBlock."	| pp proc parentVmProcess blockWithRedirection |	pp := super new.	pp createPipes.	buffered ifTrue: [pp pipeFromOutput setBufferedReader].	aioEventHandler ifNotNil: [ buffered		ifTrue: [self error: 'buffered reader already has AIO handler']		ifFalse: [aioEventHandler forFileStream: pp pipeFromOutput reader]].	blockWithRedirection := [		pp pipeToInput reader setNonBlocking.		OSProcess thisOSProcess redirectStdInTo: pp pipeToInput reader.		OSProcess thisOSProcess redirectStdOutTo: pp pipeFromOutput writer.		OSProcess thisOSProcess redirectStdErrTo: pp pipeFromError writer.		pp pipeToInput writer close.		pp pipeFromOutput reader close.		pp pipeFromError reader close.		aBlock value].		parentVmProcess := OSProcess thisOSProcess.	proc := headless				ifTrue: [parentVmProcess forkHeadlessSqueakAndDoThenQuit: blockWithRedirection]				ifFalse: [parentVmProcess forkSqueakAndDoThenQuit: blockWithRedirection].	proc pid = parentVmProcess pid		ifTrue: ["child Squeak - this branch is never reached"]		ifFalse: ["parent Squeak - set the child Squeak as the process proxy"			pp errorPipelineStream: anErrorStream.			pp pipeToInput reader close.			pp pipeFromOutput writer close.			pp pipeFromError writer close.			^ pp processProxy: proc]! !!PipeableOSProcess class methodsFor: 'instance creation' stamp: 'dtl 9/3/2010 17:33'!new: executableFile arguments: arrayOfStrings environment: stringDictionary descriptors: arrayOf3Streams workingDir: pathString errorPipelineStream: anErrorStream	"Prepare to run a program in an external OS process, and answer an instance of	myself which will represent the external process."	"PipeableOSProcess new: '/bin/ls' arguments: #('-ls' 'hosts' 'NOSUCHFILE') environment: nil descriptors: nil workingDir: '/etc' errorPipelineStream: (InternalPipe nonBlockingPipe nextPutAll: 'this is the error stream '; yourself)"	"PipeableOSProcess new: 'sol' arguments: nil environment: nil descriptors: nil workingDir: nil errorPipelineStream: (InternalPipe nonBlockingPipe nextPutAll: 'this is the error stream '; yourself)"	| pp proc proxyClass s |	pp := super new.	(proxyClass := self externalProxyClass) ifNotNil:		[proc := proxyClass			programName: executableFile			arguments: arrayOfStrings			initialEnvironment: stringDictionary].	proc ifNil: [^ self notify: 'OSProcess not available'].	arrayOf3Streams isNil		ifTrue:			[pp createPipes.			proc initialStdIn: pp pipeToInput reader.			proc initialStdOut: pp pipeFromOutput writer.			proc initialStdErr: pp pipeFromError writer]		ifFalse:			[(s := (arrayOf3Streams at: 1)) isNil				ifTrue:					[pp createInputPipe.					proc initialStdIn: pp pipeToInput reader]				ifFalse:					[proc initialStdIn: s].			(s := (arrayOf3Streams at: 2)) isNil				ifTrue:					[pp createOutputPipe.					proc initialStdOut: pp pipeFromOutput writer]				ifFalse:					[proc initialStdOut: s].			(s := (arrayOf3Streams at: 3)) isNil				ifTrue:					[pp createErrorPipe.					proc initialStdErr: pp pipeFromError writer]				ifFalse:					[proc initialStdErr: s]].	pathString ifNotNil: [proc pwd: pathString].	pp errorPipelineStream: anErrorStream.	pp initialize.	proc initialize.	^ pp processProxy: proc! !!PipeableOSProcess class methodsFor: 'utility' stamp: 'dtl 9/3/2010 17:35'!remoteShell: remoteSystemName 	"Start a remote Unix shell on another computer"	"self remoteShell: 'localhost'"	| proxyClass |	(proxyClass := self externalProxyClass) ifNotNil:		[^ self			forkAndExec: proxyClass remoteShellPath			arguments: (Array with: remoteSystemName with: 'sh')			environment: nil			descriptors: nil			workingDir: nil			errorPipelineStream: nil].	^ self notify: 'OSProcess not available'! !!PipeableOSProcess class methodsFor: 'examples' stamp: 'dtl 11/8/2007 20:41'!remoteShellExample: remoteUnixHostName	"Start a shell on another computer using rsh, and answer the the output	of some commands on the remote host. You must have security access to	the remote system in order for this to work."	"PipeableOSProcess remoteShellExample: 'minnow.cc.gatech.edu'"	"PipeableOSProcess remoteShellExample: 'micron'"	"PipeableOSProcess remoteShellExample: 'localhost'"	| rsh output |	rsh :=  self remoteShell: remoteUnixHostName.	rsh exec: 'echo remote host name is '.	rsh exec: 'hostname'.	rsh exec: 'exit'.	output := rsh output.	rsh close.	rsh succeeded		ifTrue: [self notify: output]		ifFalse: [self notify: 'remote shell failed with error message: ', rsh errorUpToEnd].	^ rsh! !!PipeableOSProcess class methodsFor: 'utility' stamp: 'dtl 9/3/2010 17:35'!shell	"Start a Unix shell"	"self shell"	"self shell exec: 'ls'; exec: 'who'; close; upToEnd"	| proxyClass |	(proxyClass := self externalProxyClass) ifNotNil:		[^ self command: proxyClass defaultShellPath].	^ self notify: 'OSProcess not available'! !!PipeableOSProcess class methodsFor: 'examples' stamp: 'dtl 11/8/2007 20:41'!tkExample	"Start an interactive Tk shell and send it some commands to display a user interface."	"PipeableOSProcess tkExample"	| wish |	wish :=  self wish.	[wish		exec: 'button .b1 -text "This is button b1"';		exec: 'button .b2 -text "This is button b2"';		exec: 'button .exit -text Exit -command exit';		exec: 'pack .b1 .b2 .exit'] fork.	^ wish! !!PipeableOSProcess class methodsFor: 'examples' stamp: 'dtl 3/4/2002 07:21'!unixCommandPipeLine	"Run a pipeline of commands in a manner similar to Unix command shell	usage, and answer the result as a string."	"PipeableOSProcess unixCommandPipeLine"	^ ((PipeableOSProcess command: 'ps') | 'grep squeak' | 'cut -c16-100') output! !!PipeableOSProcess class methodsFor: 'utility' stamp: 'dtl 11/8/2007 20:40'!waitForCommand: aCommandString	"Run a command in a shell process. Similar to the system(3) call in the standard C library.	The active Smalltalk process waits for completion of the external command process. This just	uses a simple polling loop, which is not very elegant but works well enough for most purposes."	"self waitForCommand: 'echo sleeping...; sleep 3; echo I just slept for three seconds'"	| proc d |	d := Delay forMilliseconds: 50.	proc := self command: aCommandString.	proc ifNil: [self class noAccessorAvailable].	[proc isComplete] whileFalse: [d wait].	^ proc! !!PipeableOSProcess class methodsFor: 'utility' stamp: 'dtl 9/3/2010 17:36'!wish	"Start a Tk/Tcl command interpreter"	"self wish"	| proxyClass |	(proxyClass := self externalProxyClass) ifNotNil:		[^ self command: proxyClass tkShellPath].	^ self notify: 'OSProcess not available'! !!PipeableOSProcess class methodsFor: 'utility' stamp: 'dtl 12/15/2007 11:49'!xon: remoteSystem command: aCommandString	"Convenience method for running an X program on a remote system and displaying its window	on the local display."	"self xon: 'someRemoteHost' command: 'xeyes'"	^ self command: 'xon ', remoteSystem, ' ', aCommandString! !!PipeableOSProcess class methodsFor: 'utility' stamp: 'dtl 4/19/2003 16:41'!xterm: aCommandString	"Convenience method for running a command in an external xterm window"	"self xterm: 'top -d 2'"	^ self command: 'xterm -T ''', aCommandString, ''' -e ', aCommandString! !!PipeableOSProcess class methodsFor: 'examples' stamp: 'dtl 12/15/2007 11:52'!xtermExample	"Open an external xterm window running a 'top' command. Works on unix	X window platforms."	"self xtermExample"	^ self xterm: 'top -d 2'! !!PipeableOSProcess methodsFor: 'command pipelines - private' stamp: 'dtl 7/7/2006 09:11'!addToErrorPipeline: aString	(aString isNil or: [aString isEmpty])		ifFalse: [self errorPipelineStream nextPutAll: aString]! !!PipeableOSProcess methodsFor: 'testing' stamp: 'dtl 6/4/2006 15:55'!atEnd	"True after processing is complete and all available data has been read 	from the output pipe."	^ pipeFromOutput isNil or: [pipeFromOutput atEnd]! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 11/27/2010 12:56'!close	"Close pipe to proxy input. The pipes from output and error are not	closed. This will result in the external process seeing end of file on its	input stream, which typically causes the external process to flush any	remaining data to its output and error streams, then exit. It is the	responsibility of the user to wait for that data to become available,	read any data of interest, then close the output and error pipes to	free remaining external pipe references (see closePipes)."	^super close! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 9/3/2010 17:19'!closeOutput	| p |	(p := self pipeFromOutput)		ifNotNil: [p removeDependent: self; close]! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 8/26/2006 12:10'!closePipeInputs	"Close all pipe endpoints not used after process termination."	super closePipeInputs.	pipeFromError ifNotNil: [pipeFromError closeWriter]! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 9/3/2010 17:20'!closePipes	"Replace the output and error pipe streams with internal pipes, and close	all input and output pipes."	| output out err p |	self keepInitialStdOutOpen		ifTrue:			["The pipe stream will be closed by the next process in the command pipeline"			(p := pipeFromOutput) ifNotNil: [p triggerDataReady]]		ifFalse:			[(output := self pipeFromOutput)				ifNotNil:					[accessProtect critical:						[self pipeFromOutput: InternalPipe new.						out := output upToEnd.						out isEmpty ifFalse:							[self pipeFromOutput nextPutAll: out.							self triggerOutputDataReady].						self pipeFromOutput closeWriter.						output removeDependent: self; close]]].	(pipeFromError) ifNotNil:		[accessProtect critical:			[err := pipeFromError upToEnd.			err isEmpty ifFalse:				[self addToErrorPipeline: err.				self triggerEvent: #errorDataReady].			pipeFromError removeDependent: self; close]].	self keepInitialStdErrOpen ifTrue: [self processProxy initialStdErr close].	self pipeToInput ifNotNil: [pipeToInput close]! !!PipeableOSProcess methodsFor: 'updating' stamp: 'dtl 11/21/2006 14:34'!complete	super complete.	self updateErrorPipelineStreamToEndOfFile! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 3/26/2006 14:06'!createErrorPipe	"Create a pipe for the error stream from the child process."	self pipeFromError: PipeJunction externalPipeClass nonBlockingPipe! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 3/26/2006 14:06'!createInputPipe	"Create a pipe for input to the child process."	self pipeToInput: PipeJunction externalPipeClass blockingPipe! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 3/26/2006 14:06'!createOutputPipe	"Create a pipe for output from the child process. The pipe should later be set	to nonBlocking mode only if necessary to provent Squeak VM deadlocks."	self pipeFromOutput: PipeJunction externalPipeClass blockingPipe! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 2/26/2002 19:03'!createPipes	pipeToInput ifNil: [self createInputPipe].	pipeFromOutput ifNil: [self createOutputPipe].	pipeFromError ifNil: [self createErrorPipe]! !!PipeableOSProcess methodsFor: 'event handling' stamp: 'dtl 9/3/2010 17:20'!enableErrorStreamTriggers	"Set the error stream to be event driven if possible, and answer true	if event driven output is supported, otherwise false."	| err |	(err := pipeFromError)		ifNotNil: [^ err setBufferedReader].	^ false! !!PipeableOSProcess methodsFor: 'event handling' stamp: 'dtl 11/11/2002 22:51'!enableEventTriggers	"Set the output and error streams to be event driven if possible, and 	answer true if event driven output is supported, otherwise false."	^ self enableOutputStreamTriggers and: [self enableErrorStreamTriggers]! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:39'!errorPipelineStream: aStream	"Accumulates the error output of commands in a command pipeline. Overridden	to eliminate setting self as a dependent of the error pipeline stream."	errorPipelineStream := aStream! !!PipeableOSProcess methodsFor: 'streaming' stamp: 'dtl 6/3/2006 10:41'!errorUpToEnd	"Answer all available characters from the error stream of my external process."	^ accessProtect critical: [super errorUpToEnd]! !!PipeableOSProcess methodsFor: 'streaming' stamp: 'dtl 11/21/2006 14:21'!errorUpToEndOfFile	"Answer all available characters from the error stream. Block and	continue reading until end of file is detected."	self updateErrorPipelineStreamToEndOfFile.	^ errorPipelineStream upToEnd! !!PipeableOSProcess methodsFor: 'evaluating' stamp: 'dtl 2/27/2002 14:46'!exec: aString	"Pass aString to the child for execution. Presumably the child is running a	command processor of some kind, such as a Unix shell."	processProxy isRunning		ifTrue:			[self nextPutAll: aString;			nextPut: Character lf;			flush]		ifFalse: [self notify: 'child process not running']! !!PipeableOSProcess methodsFor: 'streaming' stamp: 'dtl 9/3/2010 17:42'!flush	"Flush output to the standard input stream of my external process."	| p |	(p := pipeToInput) ifNotNil: [p flush]! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 11/8/2007 20:38'!handlePrecedingError	"The stderr stream has been redirected. If there are any characters in the	errorPipelineStream, write them to the stderr stream before proceeding. Fork	a process to keep reading any additional error messages from preceding	processes, and write them to the redirected error. When done, close the redirected	error stream (this does not affect the actual external process, which has its own	file handle on the error stream). A background process is used to copy the	errorPipelineStream because it is not straightforward to attach all predecessor	proxies in a command pipeline to the redirected error output. This design is	kludgy, but it works."	| d |	d := Delay forMilliseconds: 200.	self setKeepInitialStdErrOpen.	Processor yield.	"A chance to clean up predecessor proxies in command pipeline"	errorPipelineStream ifNotNil:			[processProxy initialStdErr nextPutAll: errorPipelineStream upToEnd.			[[self isRunning or: [self isNotYetRunning]]				whileTrue:					[processProxy initialStdErr nextPutAll: errorPipelineStream upToEnd.					d wait].				self keepInitialStdErrOpen ifFalse: [processProxy initialStdErr close]] fork]! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 11/8/2007 20:38'!initialize	"Semaphore to protect against finalizing the output and error streams	while they are being read."	accessProtect := Semaphore forMutualExclusion.	^ super initialize! !!PipeableOSProcess methodsFor: 'testing' stamp: 'dtl 2/27/2002 15:32'!isComplete	^ processProxy isComplete! !!PipeableOSProcess methodsFor: 'testing' stamp: 'dtl 3/9/2002 18:17'!isExternalProcess	"Answer true if the process which I represent is an external OSProcess."	^ true! !!PipeableOSProcess methodsFor: 'testing' stamp: 'dtl 2/27/2002 22:50'!isNotYetRunning	^ processProxy isNotYetRunning! !!PipeableOSProcess methodsFor: 'testing' stamp: 'dtl 2/27/2002 22:50'!isRunning	^ processProxy isRunning! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:39'!keepInitialStdErrOpen	"True if stderr has been redirected and the handle must be kept open in case	a predecessor in a command pipeline might have more error messages to write	to the redirected error stream."	^ keepInitialStdErrOpen ifNil: [keepInitialStdErrOpen := false]! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:39'!keepInitialStdErrOpen: trueOrFalse	"True if stderr has been redirected and the handle must be kept open in case	a predecessor in a command pipeline might have more error messages to write	to the redirected error stream."	keepInitialStdErrOpen := trueOrFalse! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:39'!keepInitialStdOutOpen	"If false, close the output pipe when the child exits. If true, do not close the output pipe.	This should be set true for an output pipe connected to another process in a pipeline,	where it is assumed that the next process will close the pipe when it is done reading	from it. Otherwise, the default behavior is to close the output pipe after transferring its	contents to a Smalltalk stream."	^ keepInitialStdOutOpen ifNil: [keepInitialStdOutOpen := false]! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:39'!keepInitialStdOutOpen: trueOrFalse	"If false, close the output pipe when the child exits. If true, do not close the output pipe.	This should be set true for an output pipe connected to another process in a pipeline,	where it is assumed that the next process will close the pipe when it is done reading	from it. Otherwise, the default behavior is to close the output pipe after transfering its	contents to a Smalltalk stream."	keepInitialStdOutOpen := trueOrFalse! !!PipeableOSProcess methodsFor: 'shell support' stamp: 'dtl 10/13/2001 11:33'!needsPrompt	"After evaluating the command, a shell will want to issue a prompt"	^ true! !!PipeableOSProcess methodsFor: 'streaming' stamp: 'dtl 11/8/2007 20:40'!next	"Answer the next character from the output stream of my external process,	or nil if no data is available."	| s |	s := accessProtect critical: [pipeFromOutput ifNotNil: [pipeFromOutput next]].	^ s! !!PipeableOSProcess methodsFor: 'streaming' stamp: 'dtl 11/8/2007 20:40'!next: count	"Answer up to count characters from the output stream of my external process,	or an empty string if no data is available."	| s |	s := accessProtect critical: [pipeFromOutput ifNotNil: [pipeFromOutput next: count]].	^ s! !!PipeableOSProcess methodsFor: 'streaming' stamp: 'dtl 11/21/2002 18:37'!nextFromError: count	"Answer up to count characters from the error stream of my external process,	or an empty string if no data is available. All characters are routed through	the errorPipelineStream, so that they are concatenated with any preceeding	error message text (possibly from a preceeding process in a command pipeline)."	self updateErrorPipelineStream.	^ self errorHasBeenRedirected		ifTrue: [nil]		ifFalse: [self errorPipelineStream next: count]! !!PipeableOSProcess methodsFor: 'shell support' stamp: 'dtl 10/13/2001 11:33'!nullStream	^ FileStream oldFileNamed: '/dev/null'! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 1/20/2001 17:14'!pipeFromError	^ pipeFromError! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 9/3/2010 17:22'!pipeFromError: aPipeStream	(pipeFromError := aPipeStream)		ifNotNil: [pipeFromError addDependent: self]! !!PipeableOSProcess methodsFor: 'testing' stamp: 'dtl 6/4/2006 17:26'!pipesAreEmpty	"True after processing is complete and all available data has been read 	from the output pipe and the error pipe. Note: uses error handling 	rather than testing for pipe closed to avoid race condition."	^ (self atEndOfFile			and: [pipeFromError isNil					or: [pipeFromError atEndOfFile]])		and: [errorPipelineStream atEnd]! !!PipeableOSProcess methodsFor: 'command pipelines - private' stamp: 'dtl 9/3/2010 17:23'!prepareOutputForInternalReader	"Output stream will be used directly by a Smalltalk process. Set output stream	characteristics accordingly."	| err |	super prepareOutputForInternalReader.	self setKeepInitialStdOutOpen.	(err := self pipeFromError) ifNotNil: [err setNonBlocking]! !!PipeableOSProcess methodsFor: 'command pipelines - private' stamp: 'dtl 1/18/2003 10:06'!prepareOutputForPipe	"Output stream will be used by another process proxy as input. Set output stream	characteristics accordingly."	super prepareOutputForPipe.	self setKeepInitialStdOutOpen; setBlockingOutput! !!PipeableOSProcess methodsFor: 'printing' stamp: 'dtl 4/8/2006 19:32'!printOn: aStream	super printOn: aStream.	aStream nextPutAll: ' on '.	self processProxy printOn: aStream! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 3/3/2002 13:44'!processProxy	"An internal evaluation proxy, or an external OS process proxy."	^ processProxy! !!PipeableOSProcess methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:39'!processProxy: aProxy	"An internal evaluation proxy, or an external OS process proxy. Add myself as	a dependent of aProxy in order to receive notification when the process run	state changes."	aProxy addDependent: self.	processProxy := aProxy! !!PipeableOSProcess methodsFor: 'initialize - release' stamp: 'dtl 1/4/2003 15:45'!release	self processProxy release.	self pipeFromError release.	^ super release! !!PipeableOSProcess methodsFor: 'command pipelines' stamp: 'dtl 2/28/2002 07:57'!replaceOutputStreamWith: anotherStreamOrNil	"Sender is my successor in a command pipeline."	processProxy isNotYetRunning		ifFalse:			[self error: 'too late to change the output now'].	anotherStreamOrNil isNil		ifFalse:			[processProxy initialStdOut: anotherStreamOrNil.			self pipeFromOutput: nil "Not accessible any more"]		ifTrue:			["Sender is my successor in a command pipeline, but does not want to use			my standard output. Therefore, dump my standard output to the null device."			pipeFromOutput				ifNotNil:					[pipeFromOutput close.					self pipeFromOutput: nil].			processProxy initialStdOut: self nullStream]! !!PipeableOSProcess methodsFor: 'testing' stamp: 'dtl 9/18/2002 11:24'!requiresNonBlockingInput	"A PipeJunction managed by Squeak may be subject to deadlocks associated with	reading or writing an OSPipe. A PipeableOSProcess relies on the external operating	system to provide process scheduling, so it will not block the Squeak VM when it	is blocked on a read or a write."	^ false! !!PipeableOSProcess methodsFor: 'private' stamp: 'dtl 8/7/2002 11:56'!setBlockingOutput	"Set the pipe from the child stdout to blocking mode. This is the normal	mode for a pipe, although for Squeak we set pipe outputs to nonblocking	to protect ourselves from blocking the Squeak VM when reading from	a pipe. Unix command pipelines use the normal blocking behavior, and	let the operating system timeslice the processes to keep the rest of the	world from hanging on a blocked read."	Smalltalk at: #OSProcess ifPresent:		[:osp | pipeFromOutput ifNotNil: [osp accessor setBlocking: self pipeFromOutput reader ioHandle]]! !!PipeableOSProcess methodsFor: 'command pipelines' stamp: 'dtl 12/3/2001 23:52'!setKeepInitialStdErrOpen	"Send this message if stderr has been redirected and the handle must be kept open in	case a predecessor in a command pipeline might have more error messages to write	to the redirected error stream."	self keepInitialStdErrOpen: true! !!PipeableOSProcess methodsFor: 'command pipelines' stamp: 'dtl 1/18/2003 10:06'!setKeepInitialStdOutOpen	"When child exits, do not close the output pipe. This is for an output pipe connected to	another process in a pipeline, where it is assumed that the next process will close	the pipe when it is done reading from it."	self keepInitialStdOutOpen: true! !!PipeableOSProcess methodsFor: 'testing' stamp: 'dtl 2/27/2002 22:51'!succeeded	^ processProxy succeeded! !!PipeableOSProcess methodsFor: 'private' stamp: 'dtl 2/24/2013 10:25'!unixFileNumbers	"Utility method for debugging. Answer the Unix file numbers for the streams	associated with this instance. This may be useful for debugging file handle	leaks (files or sockets being opened but never closed).	When a process proxy is initially set up, it will normally have six file	numbers associated with it prior to forking the child (two file numbers each	for stdin, stdout, and stderr). Once the child is forked, the process proxy in	Squeak will close its copies of the child ends of the pipes, so only three of	the original six file numbers remain visible to Squeak."	"(PipeableOSProcess command: 'who') unixFileNumbers"	"(PipeableOSProcess new: '/bin/ls'		arguments: #('-ls' 'hosts' 'NOSUCHFILE') environment: nil		descriptors: nil workingDir: '/etc'		errorPipelineStream: ((WriteStream on: String new)		nextPutAll: 'this is the error stream '; yourself)) unixFileNumbers"	| d |	Smalltalk at: #OSProcess ifPresent:		[:osp |		d := Dictionary new.		d at: #initialStdIn put: (osp accessor unixFileNumber: processProxy initialStdIn ioHandle).		d at: #initialStdOut put: (osp accessor unixFileNumber: processProxy initialStdOut ioHandle).		d at: #initialStdErr put: (osp accessor unixFileNumber: processProxy initialStdErr ioHandle).		d at: #'pipeToInput writer'			put: (osp accessor unixFileNumber: pipeToInput writer ioHandle).		d at: #'pipeFromOutput reader'			put: (osp accessor unixFileNumber: pipeFromOutput reader ioHandle).		d at: #'pipeFromError reader'			put: (osp accessor unixFileNumber: pipeFromError reader ioHandle).		^ d].	^ nil! !!PipeableOSProcess methodsFor: 'streaming' stamp: 'dtl 6/3/2006 10:35'!upToEnd	"Answer all available characters from the output of my external process."	^ accessProtect critical: [super upToEnd]! !!PipeableOSProcess methodsFor: 'streaming' stamp: 'dtl 6/3/2006 10:35'!upToEndOfFile	"Answer all available characters from the output stream. Block and	continue reading until end of file is detected."	^ accessProtect critical: [super upToEndOfFile]! !!PipeableOSProcess methodsFor: 'updating' stamp: 'dtl 9/3/2010 17:24'!update: aParameter	"Clean up after processProxy exits. Remove myself as a dependent of processProxy,	and close pipes."	| err |	(aParameter == pipeFromError)		ifTrue:			[accessProtect critical: [self addToErrorPipeline: pipeFromError upToEnd].			^ self changed: self errorPipelineStream].	(aParameter == #runState)		ifTrue:			[processProxy isComplete				ifTrue:					[(err := self pipeFromError)						ifNotNil: [self addToErrorPipeline: err upToEnd].					self complete.					self changed: aParameter]				ifFalse:					[^ self]].	^ super update: aParameter! !!PipeableOSProcess methodsFor: 'event handling' stamp: 'dtl 9/3/2010 17:24'!updateErrorPipelineStream	"Ensure that all available error output is placed into errorPipelineStream."	| p |	(p := self pipeFromError) ifNotNil: [ | s |		s := p upToEnd. "must be outside the critical block, race condition on #update:"		accessProtect critical: [errorPipelineStream nextPutAll: s]]! !!PipeableOSProcess methodsFor: 'event handling' stamp: 'dtl 9/3/2010 17:25'!updateErrorPipelineStreamToEndOfFile	"Move all error output up to end of file to the errorPipelineStream."	| p |	(p := self pipeFromError) ifNotNil: [ | s |		s := p upToEndOfFile. "must be outside the critical block, race condition on #update:"		accessProtect critical: [errorPipelineStream nextPutAll: s].		p close]! !!PipeableOSProcess methodsFor: 'evaluating' stamp: 'dtl 12/15/2007 08:54'!value	"Start the external process"	| p |	self errorHasBeenRedirected ifTrue: [self handlePrecedingError].	accessProtect critical:		[p := processProxy ifNotNil: [processProxy value].		"The external child process now owns its own copy of the pipe handles. We no		longer need our copies of these handles, so close the ones that are not needed."		p ifNotNil:			[self keepInitialStdOutOpen ifFalse: [p closeInitialStdOut].			self keepInitialStdErrOpen ifFalse: [p closeInitialStdErr]]]! !!PipeableOSProcess methodsFor: 'command pipelines' stamp: 'dtl 1/18/2003 10:06'!| anotherCommandString	"Pipe my output to another external process, where the other external process	executes anotherCommandString."	"(PipeableOSProcess command: 'ps') | 'grep squeak' | 'cut -c16-100'"	self setKeepInitialStdOutOpen.	self setBlockingOutput.	^ self species			command: anotherCommandString			pipeFrom: pipeFromOutput reader			errorPipelineStream: self errorPipelineStream! !"CommandShell-Piping"!!ShellBuiltin commentStamp: 'dtl 2/1/2003 12:25' prior: 0!A shell builtin command, intended to be invoked by a CommandShell.A builtin command consists of: name - a String identifier, used by the CommandShell to identify and invoke the commmand. helpString - a String to describe the function of the command. procedure - a BlockContext with parameters to be passed by the CommandShell.Commands are implemented in instance methods. To create a new command, write anew command implementation method and a new help method for the command. Writea new class side instance creation method patterned after one of the existing commandsand install the instance creation method in an instance of CommandShell withCommandShell>>installCommand:.A command implementation is a method which receives six paramaters. The parameters areto be interpreted as follows:	- First parameter: The EvaluatorProxy which is evaluating the command. If a command fails,	  send #fail to this object.	- Second parameter: The CommandShell from which the command was evaluated. Use this	  for any additional parsing which may be required in the command implementation.	- Third parameter: The input stream for the command.	- Forth parameter: The output stream for the command.	- Fifth parameter: The error stream for the command.	- Sixth parameter: An array of optional command arguments.!!CrLfFileEditor commentStamp: '<historical>' prior: 0!I provide an editor on a single file. I attempt to avoid changing the line termination character convention when writing my text back to a file.Bug: On older Squeak systems which do not support FilesStream>>truncate, file permissions may be lost when a file is rewritten at a shorter length.!!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:03'!cd: commandShell	"Define command to set the current working directory. Answer an empty string	or #invalidCommand."	^ self name: 'cd'		help: #cdHelp		procedure: #cdCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:03'!clear: commandShell	"Define command to clear the terminal display screen. Answer a string or an invalid	command message."	^ self name: 'clear'		help: #clearHelp		procedure: #clearCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'command dictionary creation' stamp: 'dtl 7/14/2002 12:11'!commandDictionaryFor: aCommandShell commands: commandNameArray	"Answer a Dictionary of ShellBuiltin instances suitable for use by a CommandShell"	"ShellBuiltin commandDictionaryFor: CommandShell new commands: #(cd: clear: copyToError: copyToOutput: edit: exit: fc: help: history: inspect: pwd: sls: sqsh: type:)"	^ commandNameArray		inject: Dictionary new		into:			[:d :cmd | | b |			b := self perform: cmd with: aCommandShell.			d at: b name put: b; yourself]! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:03'!copyToError: commandShell	"Define command to copy the contents of (argArray at: 1) or stdin onto	stderr. This command exists only for purposes of testing stdin and pipelines	for PipeableEvaluator proxies."	^ self name: 'copyToError'		help: nil		procedure: #copyToErrorCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:03'!copyToOutput: commandShell	"Define command to  copy the contents of (argArray at: 1) or stdin onto	stdout. This command exists only for purposes of testing stdin and pipelines	for PipeableEvaluator proxies."	^ self name: 'copyToOutput'		help: nil		procedure: #copyToOutputCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:03'!edit: commandShell	"Define command to open an editor on each of the named files."	^ self name: 'edit'		help: #editHelp		procedure: #editCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:03'!exit: commandShell	"Define command to exit the shell window. Answer a string or an invalid	command message."	^ self name: 'exit'		help: #exitHelp		procedure: #exitCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:03'!fc: commandShell	"Define 'fix command' command. If argArray is emply, answer the last	command in the history list. If there is one argument, interpret it as an	integer index into the history list. Otherwise answer an invalid command	message."	^ self name: 'fc'		help: #fcHelp		procedure: #fcCommand:shell:input:output:error:arguments:		needsPrompt: false! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:03'!help: commandShell	"Define command to display help messages."	^ self name: 'help'		help: #helpHelp		procedure: #helpCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:04'!history: commandShell	"Define command to display the command history list."	^ self name: 'history'		help: #historyHelp		procedure: #historyCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:04'!inspect: commandShell	"Define command to open a Smalltalk inspector on the contents of stdin, or the	file(s) named on the command line."	^ self name: 'inspect'		help: #inspectHelp		procedure: #inspectCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'private' stamp: 'dtl 1/4/2002 21:28'!name: aString help: helpSelector procedure: procedureSelector needsPrompt: trueOrFalse	"Command definition methods use this method to create instances representing	shell builtin commands. The commands are installed in a CommandShell, and	later evaluated in the context of a PipeableEvaluator."	^ self new		name: aString;		helpSelector: helpSelector;		procedureSelector: procedureSelector;		needsPrompt: trueOrFalse! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:04'!pwd: commandShell	"Define command to answer the current working directory (a string) or an	invalid command message."	^ self name: 'pwd'		help: #pwdHelp		procedure: #pwdCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:04'!sls: commandShell	"Define command to for a simple directory contents lister"	^ self name: 'sls'		help: #slsHelp		procedure: #slsCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:04'!snapshot: commandShell	"Define command to save the Squeak image."	^ self name: 'snapshot'		help: #snapshotHelp		procedure: #snapshotCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:04'!sqsh: commandShell	"Define command to open a new shell window."	^ self name: 'sqsh'		help: #sqshHelp		procedure: #sqshCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:04'!ttyExit: commandShell	"Define command to exit the Squeak shell and quit Squeak without saving the image."	^ self name: 'exit'		help: #ttyExitHelp		procedure: #ttyExitCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin class methodsFor: 'instance creation' stamp: 'dtl 8/4/2002 19:04'!type: commandShell	"Define command to answer how each name would be interpreted if used as a	command name."	^ self name: 'type'		help: #typeHelp		procedure: #typeCommand:shell:input:output:error:arguments:		needsPrompt: true! !!ShellBuiltin methodsFor: 'private' stamp: 'dtl 8/7/2002 12:56'!canAccessOSProcess	"True if OSProcess is in the image and if the OSProcess plugin is functioning properly"	"self canAccessOSProcess"	| osp |	^ (osp := Smalltalk at: #OSProcess ifAbsent: []) notNil and: [osp accessor canAccessSystem]! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 1/25/2013 19:37'!cdCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Set the current working directory. Answer an empty string or #invalidCommand."	| newPath path arg pathCwd p |	argArray size == 0		ifTrue:			[newPath := commandShell home]		ifFalse:			[argArray size == 1				ifTrue:					[path := argArray at: 1.					(path = commandShell shellSyntax pathStringAboveRoot)						ifTrue:							[newPath := commandShell shellSyntax pathAboveRoot]						ifFalse:							[pathCwd := commandShell shellSyntax getCwdForPath: path.							arg := (path = CommandShell pathSeparator)								ifTrue: [path]								ifFalse: [commandShell shellSyntax												firstExpandedArgument: path												inDirectoryPath: pathCwd].							newPath := arg isEmpty								ifTrue: [arg]								ifFalse:									[p := commandShell shellSyntax newDirPath: arg from: pathCwd.									p ifNotNil: [CommandShell fullNameFor: p]]]]				ifFalse:					[myProxy fail.					^ commandShell invalidCommandMessage]].	newPath isNil		ifTrue:			["No directory found with this name"			myProxy fail.			stderr nextPutAll: argArray first, ': No such file or directory'; nextPut: Character lf]		ifFalse:			[(commandShell workingDirectory ~= newPath)				ifTrue:					[(newPath isEmpty or: [commandShell shellSyntax isDirectoryPath: newPath])						ifTrue:							[commandShell workingDirectory: newPath.							commandShell changed: #relabel.							commandShell environment ifNotNil:								[commandShell environment at: #PWD put: commandShell workingDirectory]]						ifFalse:							["File of this name exists, but is not a directory"							myProxy fail.							stderr nextPutAll: newPath, ': not a directory'; nextPut: Character lf]]]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 19:58'!cdHelp	^ 'cd [path] - change default directory'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 8/4/2002 19:38'!clearCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Clear the terminal display screen. Answer a string or an invalid command message."	argArray size == 0 ifFalse:		[myProxy fail.		^ commandShell invalidCommandMessage].	commandShell startUpInNewSession.	commandShell changed: #clearText! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 19:59'!clearHelp	^ 'clear - clear screen'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 1/25/2013 19:17'!copyToErrorCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Copy the contents of (argArray at: 1) or stdin onto stderr. This	command exists only for purposes of testing stdin and pipelines	for PipeableEvaluator proxies."	| fs |	(argArray isNil or: [argArray size == 0])		ifTrue:			[stdin ifNotNil: [self copyUntilDoneFrom: stdin to: stderr]]		ifFalse:			[argArray do:				[:file |				(CommandShell fileExists: file)					ifTrue:						[fs := FileStream readOnlyFileNamed: file.						fs ifNotNil:							[self copyUntilDoneFrom: fs to: stderr.							fs close]]]]! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 1/25/2013 19:17'!copyToOutputCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Copy the contents of (argArray at: 1) or stdin onto stdout. This	command exists only for purposes of testing stdin and pipelines	for PipeableEvaluator proxies."	| fs |	(argArray isNil or: [argArray size == 0])		ifTrue:			[stdin ifNotNil: [self copyUntilDoneFrom: stdin to: stdout]]		ifFalse:			[argArray do:				[:file |				(CommandShell fileExists: file)					ifTrue:						[fs := FileStream readOnlyFileNamed: file.						fs ifNotNil:							[self copyUntilDoneFrom: fs to: stdout.							fs close]]]]! !!ShellBuiltin methodsFor: 'private' stamp: 'dtl 4/8/2007 10:21'!copyUntilDoneFrom: aPipe to: aStream	"Copy the contents of aPipe to aStream, where aPipe is the output of a process	proxy. Whenever new data is available, aPipe will trigger #dataReady. This	method responds to the #dataReady events until the end of the pipe is reached.	It is possible for the #atEnd check to give a false negative, so a timeout alarm	is used to prevent deadlock conditions."	| sema s |	sema := Semaphore new.	aPipe when: #dataReady send: #signal to: sema.	[aPipe atEndOfFile] whileFalse:		[self timeoutAfter: 200 notifying: sema.		sema wait. "Wait for data available"		[(s := aPipe next: 10000) isEmpty] whileFalse:			[aStream nextPutAll: s; flush]].	aPipe release.	^ aStream! !!ShellBuiltin methodsFor: 'private' stamp: 'dtl 1/26/2013 15:24'!dirEntryString: aDirectoryEntry	"Original code lifted from Lex Spoon's FileList>>fileNameFormattedFrom:sizePad:"	"self new dirEntryString: FileDirectory default entries first"	| folderString nameStr dateStr sizeStr date time |	folderString := ' [...]'.	CommandShell useFileSystem		ifTrue: [nameStr := aDirectoryEntry isDirectory				ifTrue: [(aDirectoryEntry perform: #basename), folderString]				ifFalse: [aDirectoryEntry perform: #basename].				date := aDirectoryEntry modificationTime asDate.				time := aDirectoryEntry modificationTime asTime.				sizeStr := aDirectoryEntry size asStringWithCommas]		ifFalse: [nameStr := aDirectoryEntry isDirectory				ifTrue: [aDirectoryEntry name , folderString]				ifFalse: [aDirectoryEntry name].				date := Date fromSeconds: aDirectoryEntry modificationTime.				time := Time fromSeconds: aDirectoryEntry modificationTime \\ 86400.				sizeStr := aDirectoryEntry fileSize asStringWithCommas].	dateStr := (date printFormat: #(3 2 1 $. 1 1 2)) , ' ' ,					(String streamContents: [:s | time print24: true on: s]).	^ nameStr , '    (' , dateStr , ' ' , sizeStr , ')'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 1/28/2013 21:45'!editCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Open an editor on each of the named files."	| controllers inputString expandedName |	(argArray isNil or: [argArray size == 0])		ifTrue:			["When taking input from a command pipeline, the input must be			read into inputString now. This is because, in MVC, the CrLfFileEditor			is scheduled to be created later, and the input pipe will be closed by			the caller of this method before the CrLfFileEditor ever has a chance			to read it."			| workingDir |			inputString := stdin isNil				ifTrue:					['']				ifFalse:					[(self copyUntilDoneFrom: stdin to: (WriteStream on: String new)) contents						replaceAll: Character lf with: Character cr].			workingDir := CommandShell useFileSystem					ifTrue: [commandShell workingDirectory perform: #asFileReference]					ifFalse: [(Smalltalk at: #FileDirectory) on: commandShell workingDirectory].			commandShell scheduleToEvaluate:				[CrLfFileEditor					openOn: inputString					withLabel: (commandShell commandHistory isEmpty									ifTrue: ['']									ifFalse: [commandShell commandHistory last])					inDirectory: workingDir					defaultFileName: 'buffer.txt']]		ifFalse:			[controllers := argArray collect:				[:arg |				"Expand arguments to convert them to full pathnames as expected by CrLfFileEditor"				expandedName := commandShell shellSyntax									firstExpandedArgument: arg									inDirectoryPath: commandShell shellSyntax workingDirectory.				CrLfFileEditor fileNamed: expandedName withLabel: arg].			CommandShell isMorphic				ifFalse:					[controllers						inject: nil						into:							[:prev :c |							prev ifNotNil:								[c addDeferredUIMessage: [prev open]].							c].					commandShell scheduleToEvaluate: [controllers last open]]				ifTrue:					[controllers do: [:e |						WorldState addDeferredUIMessage: [e openInWorld]]]]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:00'!editHelp	^ 'edit [files...] - edit the contents of stdin or the named files'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 8/4/2002 19:38'!exitCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Exit the shell window. Answer a string or an invalid command message."	argArray size == 0 ifFalse:		[myProxy fail.		^ commandShell invalidCommandMessage].	commandShell changed: #exit! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:00'!exitHelp	^ 'exit - exit shell and close window'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 9/15/2012 19:00'!fcCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Fix command. If argArray is emply, answer the last command in the	history list. If there is one argument, interpret it as an integer index	into the history list. Otherwise answer an invalid command message."	| index cmd |	commandShell commandHistory ifNotNil:		[commandShell scheduleToEvaluate:			[argArray size == 0				ifTrue:					[cmd := commandShell editCommand: (commandShell historyAt: 0)]				ifFalse:					[[index := (argArray at: 1) asNumber]								on: Error								do: [:ex | index := nil].					cmd := commandShell editCommand:							(index isNil								ifTrue: ['']								ifFalse: [commandShell historyAt: index])].					commandShell notifyPrompt.					cmd isEmpty ifFalse:						[commandShell outputStream nextPutAll: cmd; cr; flush; processCommand: cmd echo: false]]]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:01'!fcHelp	^ 'fc [i] - "fix command", command number i from history list, or -i, or the last command'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 2/24/2013 10:25'!helpCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	| topic command cacheStream |	argArray size == 0		ifTrue:			[cacheStream := WriteStream on: String new.			(commandShell builtinCommands				collect: [:c | c helpSelector] thenSelect: [:s | s notNil])					asArray sort do:						[:sel | cacheStream nextPutAll: (self perform: sel);								nextPut: Character lf].			cacheStream				nextPutAll: 'simple Smalltalk expression!! evaluates a simple expression as a doIt';				nextPut: Character lf;				nextPutAll: '<ctl-C> to interrupt a running program';				nextPut: Character lf;				nextPutAll: '<ctl-D> to end input to a running program';				nextPut: Character lf.			stdout nextPutAll: cacheStream contents]		ifFalse:			[topic := argArray at: 1.			command := commandShell builtinCommands at: topic ifAbsent: [^ self].			command helpSelector ifNotNil:				[stdout nextPutAll: (self perform: command helpSelector); nextPut: Character lf]]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:01'!helpHelp	^ 'help - help on sqsh commands'! !!ShellBuiltin methodsFor: 'accessing' stamp: 'dtl 12/31/2001 20:08'!helpSelector	^ helpSelector! !!ShellBuiltin methodsFor: 'accessing' stamp: 'dtl 12/31/2001 20:08'!helpSelector: aSymbol	helpSelector := aSymbol! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 12/29/2002 10:45'!historyCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Display the command history list."	| ws rs |	ws := WriteStream on: Character lf asString.	rs := ReadStream on: commandShell commandHistory.	[rs atEnd]		whileFalse: [ws nextPutAll: rs next.			ws nextPutAll: ' '.			ws nextPutAll: rs next.			rs atEnd				ifFalse: [ws nextPut: Character lf]].	stdout nextPutAll: (ws contents, Character lf asString)! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:02'!historyHelp	^ 'history - display command history list'! !!ShellBuiltin methodsFor: 'private' stamp: 'dtl 12/23/2007 00:41'!imageName 	"After Squeak version 3.6, #imageName was moved to SmalltalkImage "	^ ((Smalltalk classNamed: 'SmalltalkImage')		ifNil: [^ Smalltalk imageName]) current imageName! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 1/25/2013 19:17'!inspectCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Open a Smalltalk inspector on the contents of stdin, or the file(s) named on the	command line."	| fs inputString pathName |	(argArray isNil or: [argArray size == 0])		ifTrue:			[stdin ifNotNil:				["When taking input from a command pipeline, the input must be				read into inputString now. This is because, in MVC, the inspector				is scheduled to be created later, and the input pipe will be closed by				the caller of this method before the deferred block ever has a				chance to read it."				inputString := stdin ifNotNil:					[(self copyUntilDoneFrom: stdin to: (WriteStream on: String new)) contents						replaceAll: Character lf with: Character cr].				commandShell scheduleToEvaluate: [inputString inspect]]]		ifFalse:			[argArray isEmpty				ifTrue:					[commandShell scheduleToEvaluate: [nil inspect]]				ifFalse:					[argArray do:						[:e |						pathName := commandShell shellSyntax							firstExpandedArgument: e							inDirectoryPath: commandShell shellSyntax workingDirectory.						fs := (CommandShell fileExists: pathName)							ifTrue: [FileStream readOnlyFileNamed: pathName]							ifFalse: [nil].						fs isNil							ifTrue:								[commandShell scheduleToEvaluate: [nil inspect]]							ifFalse:								[commandShell scheduleToEvaluate:									[(fs contentsOfEntireFile									replaceAll: Character lf									with: Character cr) inspect.									fs close]]]]]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:02'!inspectHelp	^ 'inspect [files...] - open an inspector on the contents of stdin or the named files'! !!ShellBuiltin methodsFor: 'accessing' stamp: 'dtl 12/26/2001 19:54'!name	^ name! !!ShellBuiltin methodsFor: 'accessing' stamp: 'dtl 12/26/2001 19:54'!name: aString	name := aString! !!ShellBuiltin methodsFor: 'accessing' stamp: 'dtl 12/27/2001 01:24'!needsPrompt	"True if the command should be followed by a prompt"	^ needsPrompt ifNil: [needsPrompt := true]! !!ShellBuiltin methodsFor: 'accessing' stamp: 'dtl 12/27/2001 01:22'!needsPrompt: trueOrFalse	"True if the command should be followed by a prompt"	needsPrompt := trueOrFalse! !!ShellBuiltin methodsFor: 'evaluating' stamp: 'dtl 2/1/2003 16:21'!performWith: argumentArray evaluator: aPipeableEvaluator shell: aCommandShell input: inputStream output: outputStream error: errorStream	self perform: self procedureSelector		withArguments: (Array			with: aPipeableEvaluator			with: aCommandShell			with: inputStream			with: outputStream			with: errorStream			with: argumentArray).	aPipeableEvaluator complete! !!ShellBuiltin methodsFor: 'printing' stamp: 'dtl 3/22/2003 13:53'!printOn: aStream	super printOn: aStream.	aStream nextPutAll: ' for '.	self name printOn: aStream.! !!ShellBuiltin methodsFor: 'accessing' stamp: 'dtl 12/31/2001 20:09'!procedureSelector	^ procedureSelector! !!ShellBuiltin methodsFor: 'accessing' stamp: 'dtl 12/31/2001 20:09'!procedureSelector: aSymbol	procedureSelector := aSymbol! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 4/20/2003 11:50'!pwdCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Answer the current working directory (a string) or an invalid command message."	| directoryString |	directoryString := commandShell workingDirectory.	directoryString isEmpty ifTrue: [directoryString := self nullDirectoryString].	argArray size == 0 ifFalse:		[myProxy fail.		^ commandShell invalidCommandMessage].	stdout nextPutAll: directoryString; nextPut: Character lf! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:02'!pwdHelp	^ 'pwd - print current working directory'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 2/24/2013 10:25'!slsCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Simple directory contents lister"	| filePatterns d entries names dirs files entry linesToPrint lineCount cacheStream |	"A small value of linesToPrint will prevent an ExternalCommandShell from	overdriving is stdout stream. Maybe. A larger value allows faster updates to	an interactive CommandShell display."	linesToPrint := 16.	(argArray isNil or: [argArray size == 0])		ifTrue:			["Contents of current directory."			filePatterns := Array with: '*']		ifFalse:			["List named files"			filePatterns := argArray].	CommandShell useFileSystem		ifTrue: [d := commandShell workingDirectory perform: #asFileReference]		ifFalse: [d := (Smalltalk at: #FileDirectory) on: commandShell workingDirectory].	entries := d entries.	names := Set new.	filePatterns do: [:pat | names addAll: (commandShell shellSyntax glob: pat inDirectory: commandShell workingDirectory)].	dirs := OrderedCollection new.	files := OrderedCollection new.	names asArray sort do:		[:n |		entry := entries detect: [:e | (CommandShell entryName: e) = n].		entry isDirectory			ifTrue: [dirs add: entry]			ifFalse: [files add: entry]].	linesToPrint := 5.	lineCount := 1.	cacheStream := WriteStream on: String new.	dirs do:	[:dir |		lineCount := lineCount + 1.		cacheStream nextPutAll: (self dirEntryString: dir); nextPut: Character lf.		(lineCount > linesToPrint) ifTrue:			[stdout nextPutAll: cacheStream contents.			cacheStream := WriteStream on: String new.			lineCount := 1]].	files do: [:file |		lineCount := lineCount + 1.		cacheStream nextPutAll: (self dirEntryString: file); nextPut: Character lf.		(lineCount > linesToPrint) ifTrue:			[stdout nextPutAll: cacheStream contents.			cacheStream := WriteStream on: String new.			lineCount := 1]].	stdout nextPutAll: cacheStream contents.! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:06'!slsHelp	^ 'sls [filepatterns] - list current directory contents'! !!ShellBuiltin methodsFor: 'private' stamp: 'dtl 12/23/2007 12:23'!snapshot: save andQuit: quit	"After Squeak version 3.6, #snapshot:andQuit: was moved to SmalltalkImage "	^ ((Smalltalk classNamed: 'SmalltalkImage')		ifNil: [^ Smalltalk snapshot: save andQuit: quit]) current snapshot: save andQuit: quit! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 12/23/2007 12:23'!snapshotCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Save the image"	| s |	Smalltalk at: #WorldState ifPresent:		[:ws |		s := Semaphore new.		commandShell safeToExit: false.		stdout nextPutAll: self imageName; nextPut: Character lf.		ws addDeferredUIMessage:			[self snapshot: true andQuit: false.			s ifNotNil: [s signal] "s is nil when resuming after snapshot"].		s ifNotNil: [s wait]]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 1/28/2013 21:47'!snapshotHelp	^ 'snapshot - snapshot and save image'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 11/30/2010 07:33'!sqshCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Open a new shell window."	| ws |	argArray size == 0		ifTrue:			[commandShell scheduleToEvaluate: [commandShell class open]]		ifFalse:			[ws := WriteStream on: String new.			argArray inject: true into:				[:first :each |				first ifFalse: [ws nextPut: Character space].				ws nextPutAll: each.				false].			commandShell scheduleToEvaluate: [commandShell class openLabel: ws contents]]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:03'!sqshHelp	^ 'sqsh [title] - open new shell window'! !!ShellBuiltin methodsFor: 'private' stamp: 'dtl 1/25/2003 14:28'!timeoutAfter: milliseconds notifying: sema	"Under certain conditions it is possible to receive a false negative on	and end of file check (for example, closing the writer end of a pipe	from Squeak, and immediately checking for end of file on the reader	in the same Squeak method). If looping while waiting on end of file,	this timeout method can be used to prevent a deadlock condition."	[(Delay forMilliseconds: milliseconds) wait.	sema signal] fork! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 12/29/2002 10:51'!ttyExitCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Exit an ExternalCommandShell by quitting Squeak. The image is not saved and the shutdown	list is not processed."	commandShell safeToExit		ifTrue: [Smalltalk quitPrimitive]		ifFalse: [stderr nextPutAll: 'cannot exit in same command line with snapshot'; nextPut: Character lf]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 7/14/2002 12:24'!ttyExitHelp	^ 'exit - exit shell and quit Squeak without saving image'! !!ShellBuiltin methodsFor: 'implementations' stamp: 'dtl 12/29/2002 10:51'!typeCommand: myProxy shell: commandShell input: stdin output: stdout error: stderr arguments: argArray	"Answer how each name would be interpreted if used as a command name."	| results exe |	argArray size == 0		ifTrue:			[^ '']		ifFalse:			[results := WriteStream on: Array new.			argArray do:			[:arg |			(commandShell isBuiltInCommand: arg)				ifTrue:					[results nextPut: arg, ' is a shell builtin']				ifFalse:					[self canAccessOSProcess					 	ifFalse:							[self inform:								((Smalltalk hasClassNamed: #OSProcess)									ifTrue: [(Smalltalk at: #OSProcess) accessor class name]									ifFalse: [commandShell class name]), ' cannot access system'.							stdout nextPutAll: 'cannot access system'; nextPut: Character lf.							^ self].					exe := commandShell shellSyntax findExecutablePathFor: arg inDirectoryPath: commandShell workingDirectory.					(commandShell shellSyntax isExecutable: exe) ifFalse: [exe := nil].					exe isNil						ifTrue: [results nextPut: arg, ': not found']								ifFalse: [results nextPut: arg, ' is ', exe]]].				results contents do: [:e | stdout nextPutAll: e; nextPut: Character lf]]! !!ShellBuiltin methodsFor: 'help messages' stamp: 'dtl 12/31/2001 20:03'!typeHelp	^ 'type [names...] - indicate how each name would be interpreted if used as a command'! !!CrLfFileEditor class methodsFor: 'private' stamp: 'dtl 12/15/2007 13:38'!defaultLineEndConvention	"FIXME: The Unix and Win32 are right, but I just guessed at the others - dtl"	| platform |	platform :=  ShellSyntax new platformName.	(platform = 'unix') ifTrue: [^ #lf].	(platform = 'Win32') ifTrue: [^ #crlf].	(platform = 'Mac OS') ifTrue: [^ #cr].	(platform = 'RiscOS') ifTrue: [^ #cr].	(platform = 'OS2') ifTrue: [^ #crlf]. "FIXME: Is this the right name for OS2?"	"Add other system types here..."	^ #cr! !!CrLfFileEditor class methodsFor: 'instance creation' stamp: 'dtl 9/12/2002 10:16'!editFileNamed: pathName	"CrLfFileEditor editFileNamed: '/etc/hosts'"	"CrLfFileEditor editFileNamed: '/NO/SUCH/FILE'"	"CrLfFileEditor editFileNamed: '/etc/NOSUCHFILE)'"	^ Cursor read showWhile: [self openForFileNamed: pathName].! !!CrLfFileEditor class methodsFor: 'instance creation' stamp: 'dtl 9/12/2002 11:38'!fileNamed: pathName	"Answer a Controller or Morph as view on an instance of myself."	"CrLfFileEditor fileNamed: '/etc/hosts'"	"CrLfFileEditor fileNamed: '/NO/SUCH/FILE'"	"CrLfFileEditor fileNamed: '/etc/NOSUCHFILE'"	^ self fileNamed: pathName withLabel: pathName! !!CrLfFileEditor class methodsFor: 'instance creation' stamp: 'dtl 7/1/2015 21:13'!fileNamed: pathName inDirectoryPath: dirPath	"Answer a Controller or Morph as view on an instance of myself."	"CrLfFileEditor fileNamed: '/etc/hosts' inDirectoryPath: '/usr/bin'"	"CrLfFileEditor fileNamed: 'bin/vi' inDirectoryPath: '/usr'"	"CrLfFileEditor fileNamed: 'hosts' inDirectoryPath: '/etc'"	"CrLfFileEditor fileNamed: 'hosts' inDirectoryPath: '/usr/bin'"	"CrLfFileEditor fileNamed: '/NO/SUCH/FILE' inDirectoryPath: '/etc'"	"CrLfFileEditor fileNamed: '/etc/NOSUCHFILE' inDirectoryPath: '/etc'"	| dir fs convention editText |	dir := CommandShell directoryForPath: dirPath.	(dir fileExists: pathName)		ifTrue:			[[fs := (Smalltalk						at: #MultiByteFileStream						ifAbsent: [Smalltalk at: #CrLfFileStream])							readOnlyFileNamed: dirPath, CommandShell pathSeparator, pathName.			convention := fs detectLineEndConvention.			editText := fs contentsOfEntireFile.			fs close]				on: Error				do: [:ex |					convention := #lf.	"Default for Unix text files"					editText := '']]		ifFalse:			[convention := #lf.	"Default for Unix text files"			editText := ''].	^ self on: editText		withLabel: pathName		inDirectory: dir		defaultFileName: pathName		lineEndConvention: convention! !!CrLfFileEditor class methodsFor: 'instance creation' stamp: 'dtl 7/1/2015 21:14'!fileNamed: pathName withLabel: windowLabel	"Answer a Controller or Morph as view on an instance of myself."	"CrLfFileEditor fileNamed: '/etc/hosts' withLabel: 'an editor on /etc/hosts'"	| dirPath dir fs convention editText localName |	dirPath := CommandShell dirPathFor: pathName.	dir := CommandShell directoryForPath: dirPath..	localName := CommandShell localNameFor: pathName.	(CommandShell fileExists: localName inDirectory: dir)		ifTrue:			[[fs := (Smalltalk						at: #MultiByteFileStream						ifAbsent: [Smalltalk at: #CrLfFileStream])							readOnlyFileNamed: pathName.			convention := fs detectLineEndConvention.			editText := fs contentsOfEntireFile.			fs close]				on: Error				do: [:ex |					convention := #lf.	"Default for Unix text files"					editText := '']]		ifFalse:			[convention := #lf.	"Default for Unix text files"			editText := ''].	^ self on: editText		withLabel: windowLabel		inDirectory: dir		defaultFileName: localName		lineEndConvention: convention! !!CrLfFileEditor class methodsFor: 'class initialization' stamp: 'dtl 11/29/2010 22:10'!initialize	"CrLfFileEditor initialize"	| preferencesClass |	(Smalltalk hasClassNamed: #Preferences)		ifTrue: ["Pharo deprecates Preference in favor of pragma registration mechanism"			preferencesClass := Smalltalk at: #Preferences.			(preferencesClass respondsTo: #setWindowColorFor:to: )				ifTrue: ["Squeak"					preferencesClass 						setWindowColorFor: #CommandShell 						to: (Color colorFrom: self windowColorSpecification pastelColor)]				ifFalse: ["Pharo images use some other preferences protocol"]].! !!CrLfFileEditor class methodsFor: 'instance creation' stamp: 'dtl 9/12/2002 10:10'!on: aString withLabel: aLabelString inDirectory: aDirectory defaultFileName: nameString	"(CrLfFileEditor on: 'this is the string to edit' withLabel: 'this is the window label' inDirectory: FileDirectory default defaultFileName: 'buffer.txt') openInWorld"	^ self on: aString withLabel: aLabelString inDirectory: aDirectory defaultFileName: nameString lineEndConvention: self defaultLineEndConvention! !!CrLfFileEditor class methodsFor: 'instance creation' stamp: 'dtl 9/12/2002 10:09'!on: aString withLabel: aLabelString inDirectory: aDirectory defaultFileName: nameString lineEndConvention: convention	"(CrLfFileEditor on: 'this is the string to edit' withLabel: 'this is the window label' inDirectory: FileDirectory default defaultFileName: 'buffer.txt' lineEndConvention: #lf) openInWorld"	| model |	model := self new contents: aString.	model directory: aDirectory.	model fileName: nameString.	model lineEndConvention: convention.	^ model withLabel: aLabelString! !!CrLfFileEditor class methodsFor: 'private' stamp: 'dtl 6/29/2010 21:09'!openForFileNamed: pathName	"CrLfFileEditor openForFileNamed: '/etc/hosts'"	"CrLfFileEditor openForFileNamed: '/NO/SUCH/FILE'"	"CrLfFileEditor openForFileNamed: '/etc/NOSUCHFILE'"	^ CommandShell isMorphic		ifTrue: [(self fileNamed: pathName) openInWorld]		ifFalse: [(self fileNamed: pathName) open]! !!CrLfFileEditor class methodsFor: 'instance creation' stamp: 'dtl 9/12/2002 10:10'!openOn: aString withLabel: aLabelString inDirectory: aDirectory defaultFileName: nameString	"CrLfFileEditor openOn: 'this is the string to edit' withLabel: 'this is the window label' inDirectory: FileDirectory default defaultFileName: 'buffer.txt'"	^ self openOn: aString withLabel: aLabelString inDirectory: aDirectory defaultFileName: nameString lineEndConvention: self defaultLineEndConvention! !!CrLfFileEditor class methodsFor: 'instance creation' stamp: 'dtl 12/13/2007 21:08'!openOn: aString withLabel: aLabelString inDirectory: aDirectory defaultFileName: nameString lineEndConvention: convention	"CrLfFileEditor openOn: 'this is the string to edit' withLabel: 'this is the window label' inDirectory: FileDirectory default defaultFileName: 'buffer.txt' lineEndConvention: #lf"	| model |	model := self new contents: aString.	model directory: aDirectory.	model fileName: nameString.	model lineEndConvention: convention.	^ model openLabel: aLabelString! !!CrLfFileEditor class methodsFor: 'window color' stamp: 'dtl 6/29/2010 00:07'!windowColorSpecification	"Answer a WindowColorSpec object that declares my preference"	| windowColorSpec |	windowColorSpec := Smalltalk				at: #WindowColorSpec				ifAbsent: [^self error: 'this image does not support WindowColorSpec'].	^ windowColorSpec		classSymbol: self name		wording: 'Squeak Shell File Editor'		brightColor: Color lightOrange		pastelColor: Color lightOrange paler paler		helpMessage: 'CrLfFileEditor window for CommandShell ''edit'' comand'! !!CrLfFileEditor methodsFor: 'private' stamp: 'ThierryGoubier 9/20/2013 15:14'!bogusTruncate: fileStream	"Truncate the file by brute force if FileStream>>truncate is not supported on	this system. Note that this does not preserve file permissions."	| name |	name := fileStream name.	fileStream close.	CommandShell deleteFileNamed: name inDirectory: directory.	^ (Smalltalk at: #CrLfFileStream) fileNamed: name! !!CrLfFileEditor methodsFor: 'menus' stamp: 'dtl 1/27/2013 17:53'!browseChanges	"Browse in fileIn format."	| fs |	fs :=  CommandShell fileNamed: fileName inDirectory: directory.	ChangeList browseStream: fs.	fs close! !!CrLfFileEditor methodsFor: 'model access' stamp: 'dtl 1/26/2013 12:29'!contents	^ viewStyle == #hex		ifTrue: [self hexFormat: contents]		ifFalse: [contents]! !!CrLfFileEditor methodsFor: 'model access' stamp: 'ThierryGoubier 6/25/2015 22:26'!contents: aString	viewStyle == #hex		ifTrue: [ self inform: 'cannot update in hex mode' ]		ifFalse: [ contents := aString	"asString" ]! !!CrLfFileEditor methodsFor: 'accessing' stamp: 'ThierryGoubier 6/25/2015 22:27'!contentsSelection	"Return the interval of text in the code pane to select when I set the pane's contents"	^ 1 to: 0  "null selection"! !!CrLfFileEditor methodsFor: 'menus' stamp: 'dtl 6/29/2010 21:08'!controllerForAccept	"Find the controller or morph which expects the #accept message"	| controller view |	CommandShell isMorphic		ifTrue:			[controller := dependents detect: [:e | e respondsTo: #accept] ifNone: [nil]]		ifFalse:			[view := dependents detect: [:e | e controller respondsTo: #accept] ifNone: [nil].			controller := view isNil				ifTrue: [nil]				ifFalse: [view controller]].	^ controller! !!CrLfFileEditor methodsFor: 'model access' stamp: 'dtl 1/27/2013 18:05'!currentFilePathName	^ (CommandShell dirPathFor: directory), CommandShell pathSeparator, fileName! !!CrLfFileEditor methodsFor: 'initialize-release' stamp: 'dtl 12/13/2007 20:57'!defaultFont	"A fixed width font suitable for displaying output of shell command lines"	^ StrikeFont familyName: 'Atlanta' size: 11 emphasized: 0! !!CrLfFileEditor methodsFor: 'accessing' stamp: 'dtl 5/19/2001 17:40'!directory: aDirectory	directory := aDirectory! !!CrLfFileEditor methodsFor: 'menus' stamp: 'dtl 6/29/2010 21:09'!exit	self changed: #accept.	CommandShell isMorphic		ifTrue:			[dependents do: [:d | (d respondsTo: #closeBoxHit) ifTrue: [d closeBoxHit]]]		ifFalse:			[dependents first controller closeAndUnschedule]! !!CrLfFileEditor methodsFor: 'model access' stamp: 'ThierryGoubier 9/20/2013 15:17'!fileContentsMenu: aMenu shifted: shifted| shiftMenu |^ shifted 	ifFalse: [aMenu 		labels: 'savesave as...exitview as hexview as textbrowse changesfind...(f)find again (g)set search string (h)do again (j)undo (z)copy (c)cut (x)paste (v)paste...do it (d)print it (p)inspect it (i)fileIn selectionaccept (s)cancel (l)more...' 		lines: #(3 6 9 11 15 19 21)		selections: #(save saveAs exit getHex getText browseChangesfind findAgain setSearchStringagain undocopySelection cut paste pasteRecentdoIt printIt inspectIt fileItInaccept cancelshiftedYellowButtonActivity)]	ifTrue: [shiftMenu := (Smalltalk at: #ParagraphEditor) shiftedYellowButtonMenu.		aMenu 			labels: shiftMenu labelString 			lines: shiftMenu lineArray			selections: shiftMenu selections]! !!CrLfFileEditor methodsFor: 'accessing' stamp: 'dtl 5/19/2001 17:01'!fileName: aString	fileName := aString! !!CrLfFileEditor methodsFor: 'private' stamp: 'dtl 6/29/2001 23:21'!forceDirtyBuffer	"This will force the view to behave as if it had been edited. Call this to	enable a file save even if the text has not actually been edited by the	user."	| controller |	controller := self dependents			detect: [:e | e respondsTo: #hasUnacceptedEdits:]			ifNone:				[self dependents					collect: [:d | d controller]					thenSelect: [:c | c respondsTo: #hasUnacceptedEdits:]].	controller hasUnacceptedEdits: true.! !!CrLfFileEditor methodsFor: 'private' stamp: 'ThierryGoubier 9/20/2013 15:16'!getAnotherFileName: initialFileName	| choice newFileName |	choice := ((Smalltalk at: #PopUpMenu)		labels: 'choose another name\cancel' withCRs)		startUpWithCaption: initialFileName.	choice = 1		ifTrue: [newFileName := (Smalltalk at: #FillInTheBlank)									request: 'Enter a new file name'									initialAnswer: initialFileName.				newFileName := (CommandShell fileExists: newFileName inDirectory: directory)					ifTrue: [self getFileName: newFileName]					ifFalse: [newFileName].				^ newFileName].	^ nil! !!CrLfFileEditor methodsFor: 'private' stamp: 'ThierryGoubier 9/20/2013 15:16'!getFileName: initialFileName	| choice newFileName |	choice := ((Smalltalk at: #PopUpMenu)		labels: 'overwrite that file\choose another name\cancel' withCRs)		startUpWithCaption: initialFileName, ' already exists.'.	choice = 1		ifTrue: [^ initialFileName].	choice = 2		ifTrue: [newFileName := (Smalltalk at: #FillInTheBlank)									request: 'Enter a new file name'									initialAnswer: initialFileName.				newFileName := (CommandShell fileExists: newFileName inDirectory: directory)					ifTrue: [self getFileName: newFileName]					ifFalse: [newFileName].				^ newFileName].	^ nil! !!CrLfFileEditor methodsFor: 'menus' stamp: 'dtl 5/20/2001 12:46'!getHex	Cursor read showWhile:		[self viewStyle: #hex.		self changed: #contents]! !!CrLfFileEditor methodsFor: 'model access' stamp: 'dtl 5/26/2001 18:23'!getSelection	^ 1 to: 0  "null selection"! !!CrLfFileEditor methodsFor: 'menus' stamp: 'dtl 5/20/2001 14:01'!getText	Cursor read showWhile:		[self viewStyle: #text.		self changed: #contents]! !!CrLfFileEditor methodsFor: 'private' stamp: 'dtl 5/20/2001 14:25'!hexFormat: aString	"CrLfFileEditor new hexFormat: 'this is a test of the HEX string reformat method'"	| s |	s := WriteStream on: (String new: aString size*4).	0 to: aString size-1 by: 16 do:		[:loc | s nextPutAll: loc hex; space;			nextPut: $(; print: loc; nextPut: $); space; tab.		loc+1 to: (loc+16 min: aString size) do: [:i | s nextPutAll: (aString at: i) hex; space].		s cr].	^ s contents.! !!CrLfFileEditor methodsFor: 'model access' stamp: 'dtl 5/20/2001 21:22'!labelString	"For views to use a labels"	^ self currentFilePathName! !!CrLfFileEditor methodsFor: 'accessing' stamp: 'dtl 5/19/2001 17:01'!lineEndConvention: aSymbol	"See CrLfFileStream for the allowable values of aSymbol."	lineEndConvention := aSymbol! !!CrLfFileEditor methodsFor: 'initialize-release' stamp: 'ThierryGoubier 9/20/2013 15:18'!mvcWithLabel: aLabelString	| topView controllerClass fileContentsView |	CommandShell isMorphic		ifTrue: [ ^ self error: 'this method should be used only for MVC' ].	topView := (Smalltalk at: #StandardSystemView) new.	controllerClass := Smalltalk		at: #DeferredActionStandardSystemController		ifAbsent: [ Smalltalk at: #StandardSystemController ].	topView		model: self;		controller: controllerClass new;		label: aLabelString;		minimumSize: 200 @ 200.	topView borderWidth: 1.	fileContentsView := (Smalltalk at: #PluggableTextView)		on: self		text: #contents		accept: #put:		readSelection: #contentsSelection		menu: #fileContentsMenu:shifted:.	fileContentsView window: (0 @ 0 extent: 200 @ 140).	topView addSubView: fileContentsView.	^ topView controller! !!CrLfFileEditor methodsFor: 'initialize-release' stamp: 'dtl 12/13/2007 20:57'!openAsMorphLabel: aLabelString	| window textMorph |	textMorph := PluggableTextMorph		on: self		text: #contents		accept: #put:		readSelection: #contentsSelection menu: #fileContentsMenu:shifted:.	textMorph font: self defaultFont.	window := (SystemWindow labelled: aLabelString) model: self.	window		addMorph: textMorph		frame: (0@0 corner: 1@1).	^ window! !!CrLfFileEditor methodsFor: 'initialize-release' stamp: 'dtl 6/29/2010 21:09'!openLabel: aLabelString	CommandShell isMorphic		ifTrue:			[^ (self openAsMorphLabel: aLabelString) openInWorld]		ifFalse:			[^ (self mvcWithLabel: aLabelString) open]! !!CrLfFileEditor methodsFor: 'model access' stamp: 'ThierryGoubier 9/20/2013 15:15'!put: aText 	| str newFileName fs |	viewStyle == #hex		ifTrue: [self inform: 'cannot save file in hex mode'.				^ false].	str := aText asString.	self contents: str.	(CommandShell fileExists: fileName inDirectory: directory)		ifTrue: [newFileName := self					getFileName: (CommandShell pathNameForDirectory: directory),						CommandShell pathSeparator , fileName.]		ifFalse: [newFileName := (CommandShell pathNameForDirectory: directory),						CommandShell pathSeparator , fileName].	newFileName ifNil: [^ false].	fs := (Smalltalk at: #CrLfFileStream) fileNamed: newFileName.	[fs isNil] whileTrue:		[self inform: 'cannot write file'.		newFileName := self getAnotherFileName: newFileName.		newFileName isNil			ifTrue:				[self inform: 'file not written'.				^ false]			ifFalse:				[fs := (Smalltalk at: #CrLfFileStream )fileNamed: newFileName]].	(str size < fs size)		ifTrue:			[(fs respondsTo: #truncate)				ifTrue:					[[fs truncate]						on: Error						do: [:ex | fs := self bogusTruncate: fs]]				ifFalse: [fs := self bogusTruncate: fs]].	fs nextPutAll: str.	fs close.	self updateFilePathWith: newFileName.	^ true! !!CrLfFileEditor methodsFor: 'menus' stamp: 'dtl 6/29/2001 23:22'!save	| controller |	self forceDirtyBuffer.	controller := self controllerForAccept.	controller ifNotNil: [controller accept]! !!CrLfFileEditor methodsFor: 'menus' stamp: 'ThierryGoubier 9/20/2013 15:17'!saveAs	| oldFilePath newFilePath controller |	oldFilePath := self currentFilePathName.	newFilePath := (Smalltalk at: #FillInTheBlank)					request: 'Enter a new file name'					initialAnswer: oldFilePath.	newFilePath isEmpty		ifFalse:			[self updateFilePathWith: newFilePath.			controller := self controllerForAccept.			controller ifNotNil:				[self forceDirtyBuffer.				controller accept]]! !!CrLfFileEditor methodsFor: 'menus' stamp: 'dtl 5/20/2001 19:39'!selectedClassOrMetaClass	"For support of the pretty printer menu option"	^ self class! !!CrLfFileEditor methodsFor: 'menus' stamp: 'dtl 5/20/2001 19:37'!selectedMessageCategoryName	"For support of the pretty printer menu option"	^ '-- all --'! !!CrLfFileEditor methodsFor: 'private' stamp: 'dtl 1/27/2013 22:33'!updateFilePathWith: aPathString	self fileName: (CommandShell localNameFor: aPathString).	self directory: (CommandShell directoryForPath: aPathString).	self changed: #relabel! !!CrLfFileEditor methodsFor: 'accessing' stamp: 'dtl 5/20/2001 12:45'!viewStyle: aSymbol	"#text or #hex"	viewStyle := aSymbol! !!CrLfFileEditor methodsFor: 'initialize-release' stamp: 'dtl 6/29/2010 21:09'!withLabel: aLabelString	"Same as #openLabel: but does not open the window in MVC"	CommandShell isMorphic		ifTrue:			[^ self openAsMorphLabel: aLabelString]		ifFalse:			[^ self mvcWithLabel: aLabelString]! !"CommandShell-Commands"!!CommandShellTranscript commentStamp: 'dtl 1/20/2007 09:11' prior: 0!CommandShellTranscript is a user interface for a ComandShell. It behaves like a simple teletype text terminal.!!ExternalCommandShell commentStamp: '<historical>' prior: 0!On some platforms it is possible to use OSProcess to read and write the standard input, output and error streams. In that case, ExternalCommandShell allows Squeak to be used as a traditional text mode command shell.When used in a headless Squeak image, ExternalCommandShell behaves like a traditional Unix command shell, except that it has the ability to evaluate Smalltalk expressions as well as other programs and commands. On a Unix system running a Squeak shell in a headless image, the Smalltalk display can be opened by entering the command "UnixProcess recapitate" at the Squeak shell prompt.ExternalCommandShell has one instance, which is accessible as "ExternalCommandShell inSmalltalk". The shell can be stopped with "ExternalCommandShell stop" and restarted with "ExternalCommandShell start". If the shell is running when Squeak is shut down, it will be automatically be restarted when the image is restarted.!!CommandShellTranscript class methodsFor: 'instance creation' stamp: 'dtl 1/20/2007 10:32'!commandShell: cliShell	| ttyDisplay |	ttyDisplay := self new cliShell: cliShell.	cliShell outputStream: ttyDisplay; errorStream: ttyDisplay.	cliShell addDependent: ttyDisplay.	^ ttyDisplay! !!CommandShellTranscript class methodsFor: 'defaults' stamp: 'dtl 1/17/2007 06:29'!defaultWindowName	^ 'Squeak Shell'! !!CommandShellTranscript class methodsFor: 'instance creation' stamp: 'dtl 1/17/2007 06:29'!new	^ (self on: (String new: 1000)) initialize! !!CommandShellTranscript class methodsFor: 'instance creation' stamp: 'dtl 1/17/2007 06:29'!open	"CommandShell open"	^ self new open! !!CommandShellTranscript class methodsFor: 'instance creation' stamp: 'dtl 1/17/2007 06:29'!openLabel: aString	"CommandShell openLabel: self defaultWindowName"	^ self new openLabel: aString! !!CommandShellTranscript class methodsFor: 'window color' stamp: 'dtl 6/29/2010 00:07'!windowColorSpecification	"Answer a WindowColorSpec object that declares my preference"	| windowColorSpec |	windowColorSpec := Smalltalk				at: #WindowColorSpec				ifAbsent: [^ self error: 'this image does not support WindowColorSpec'].	^ windowColorSpec		classSymbol: self name		wording: 'Squeak Shell'		brightColor: (Color lightGray lighter paler)		pastelColor: (Color lightGray lighter lighter paler paler)		helpMessage: 'CommandShell window for evaluating Smalltalk and OS commands'! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 6/24/2001 19:09'!activeController	"In Morphic, alway nil. In MVC, the controller that most recently invoked	a command."	^ activeController! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:28'!activeController: aController	"In Morphic, alway nil. In MVC, the controller that most recently invoked	a command."	activeController := aController! !!CommandShellTranscript methodsFor: 'stream extensions' stamp: 'dtl 1/17/2007 06:29'!bs	self position > 0 ifTrue: [^ self skip: -1].	self changed: #bs! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 1/17/2007 06:28'!characterLimit	"Tell the views how much to retain on screen"	^ 20000! !!CommandShellTranscript methodsFor: 'input character filtering' stamp: 'dtl 11/8/2007 19:38'!checkSttyForEvent: keyboardEvent	"Check for interrupt characters and such. Consume interrupt character and	answer nil, otherwise answer keyboardEvent."	(self isInterruptEvent: keyboardEvent)		ifTrue:			[self handleInterruptCharacterEvent.			^ nil].	(self isEndOfFileEvent: keyboardEvent)		ifTrue:			[self cliShell doEndOfFile.			^ nil].	^ keyboardEvent! !!CommandShellTranscript methodsFor: 'stream extensions' stamp: 'dtl 1/17/2007 06:29'!clear	"Clear all characters and redisplay the view"	self changed: #clearText.	self reset! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 12/11/2007 19:00'!cliShell	"Answer the value of cliShell"	^ cliShell ifNil: [cliShell := CommandShell new]! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:28'!cliShell: commandShell	"Set the value of cliShell"	cliShell := commandShell! !!CommandShellTranscript methodsFor: 'initialize-release' stamp: 'dtl 1/20/2007 11:56'!close	super close.	self changed: #exit! !!CommandShellTranscript methodsFor: 'model protocol' stamp: 'dtl 6/17/2015 21:22'!codePaneMenu: aMenu shifted: shifted	"Note that unless we override perform:orSendTo:, PluggableTextController will respond	to all menu items.	If StringHolder is not present, try to delegate to Workspace instead."	^ (Smalltalk		at: #StringHolder		ifAbsent: [Smalltalk				at: #Workspace				ifAbsent: [^ self ]]) basicNew codePaneMenu: aMenu shifted: shifted! !!CommandShellTranscript methodsFor: 'input character filtering' stamp: 'dtl 11/8/2007 20:29'!confirmBeforeKilling: externalProxies	"Interrupt character detected, do interrupt stuff."	| msgStrm |	(externalProxies size > 0)		ifTrue:			[msgStrm := WriteStream on: String new.			(externalProxies size > 1)				ifTrue: [msgStrm nextPutAll: 'kill processes']				ifFalse: [msgStrm nextPutAll: 'kill process'].			externalProxies do: [:e | msgStrm nextPutAll: ' ', e pid printString, ' (', e programName, ')'].			msgStrm nextPut: $?.			(self confirm: msgStrm contents)				ifTrue:					[externalProxies reverseDo: [:e | e terminate]]]! !!CommandShellTranscript methodsFor: 'model protocol' stamp: 'dtl 12/11/2007 20:19'!defaultLabelStringBlock	^ [ | directoryString |	directoryString := self cliShell workingDirectory.	directoryString isEmpty ifTrue: [directoryString := self cliShell shellSyntax nullDirectoryString].	self class defaultWindowName, ': ', directoryString]! !!CommandShellTranscript methodsFor: 'stream extensions' stamp: 'dtl 1/17/2007 06:29'!endEntry	"Display all the characters since the last endEntry, and reset the stream"	self changed: #appendEntry.	self reset! !!CommandShellTranscript methodsFor: 'input character filtering' stamp: 'dtl 1/20/2007 09:42'!filterAndForward: aCharacter	"Filter aCharacter, taking special action if needed. If a child process is active,	forward aCharacter to the child and answer nil. Otherwise answer aCharacter."	^ self cliShell filterAndForward: aCharacter! !!CommandShellTranscript methodsFor: 'input character filtering' stamp: 'dtl 11/7/2007 06:54'!filterAndForwardEvent: keyboardEvent 	"Filter keyboardEvent, taking special action if needed. If a child process	is active, forward keyboardEvent to the child and answer nil. Otherwise	answer keyboardEvent."	^ (self checkSttyForEvent: keyboardEvent)		ifNotNil: [self cliShell filterAndForwardEvent: keyboardEvent]! !!CommandShellTranscript methodsFor: 'stream extensions' stamp: 'dtl 1/17/2007 06:29'!flush	self endEntry! !!CommandShellTranscript methodsFor: 'input character filtering' stamp: 'dtl 11/8/2007 19:38'!handleInterruptCharacterEvent	"Interrupt character detected, do interrupt stuff."	self confirmBeforeKilling: (self cliShell foregroundProxies		select: [:e | e isExternalProcess]		thenCollect: [:r | r processProxy]).	self confirmBeforeKilling: (self cliShell backgroundProxies		select: [:e | e isExternalProcess]		thenCollect: [:r | r processProxy]).! !!CommandShellTranscript methodsFor: 'input character filtering' stamp: 'dtl 12/25/2007 16:30'!isEndOfFileEvent: keystrokeEvent 	"A <ctl>d event, represented either as character value 4, or as $d with	the control or meta key. The actual representation varies on different	versions of Squeak."	^ keystrokeEvent keyValue == 4		or: [keystrokeEvent keyCharacter = $d				and: [keystrokeEvent controlKeyPressed]]! !!CommandShellTranscript methodsFor: 'input character filtering' stamp: 'dtl 12/25/2007 16:30'!isInterruptEvent: keystrokeEvent 	"A <ctl>c event, represented either as character value 3, or as $c with	the control or meta key. The actual representation varies on different	versions of Squeak."	^ keystrokeEvent keyValue == 3		or: [keystrokeEvent keyCharacter = $c				and: [keystrokeEvent controlKeyPressed]]! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 1/22/2007 21:24'!keyboardConnector	^ self cliShell keyboardConnector! !!CommandShellTranscript methodsFor: 'model protocol' stamp: 'dtl 12/11/2007 20:20'!labelString	^ self labelStringBlock value! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 12/11/2007 20:18'!labelStringBlock	"Answer a block that when evaluated answers a string to be used	as the window label."	^ labelStringBlock ifNil: [labelStringBlock := self defaultLabelStringBlock]! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 12/11/2007 20:16'!labelStringBlock: aBlockAnsweringAString	labelStringBlock := aBlockAnsweringAString! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 1/20/2007 11:44'!lastPromptString	"Answer the value of lastPromptString"	^ lastPromptString ifNil: [lastPromptString := self cliShell promptString]! !!CommandShellTranscript methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:28'!lastPromptString: anObject	"Set the value of lastPromptString"	lastPromptString := anObject! !!CommandShellTranscript methodsFor: 'stream extensions' stamp: 'dtl 12/11/2007 21:35'!nextPut: anObject 	self scheduleToEvaluate:		[super nextPut: anObject]! !!CommandShellTranscript methodsFor: 'stream extensions' stamp: 'dtl 12/11/2007 21:35'!nextPutAll: characters	"Convert line terminators to cr. Note that #nextPut: does not do this conversion."	self scheduleToEvaluate:		[characters isEmpty ifFalse:			[super nextPutAll: (characters copyReplaceAll: String lf with: String cr).			self flush]]! !!CommandShellTranscript methodsFor: 'initialize-release' stamp: 'dtl 12/11/2007 20:31'!open	^ self openLabel: nil "invoke default label setting block"! !!CommandShellTranscript methodsFor: 'initialize-release' stamp: 'dtl 12/11/2007 20:30'!openAsMorphLabel: labelString 	"Build a morph viewing this stream"	| window textMorph |	window := SystemWindow new model: self.	textMorph := ShellWindowMorph					on: self					text: nil					accept: nil					readSelection: nil					menu: #codePaneMenu:shifted:.	textMorph acceptOnCR: true.	window addMorph: textMorph frame: (0@0 corner: 1@1).	self prompt.	labelString ifNotNil: [self labelStringBlock: [labelString]].	self changed: #relabel.	^ window! !!CommandShellTranscript methodsFor: 'initialize-release' stamp: 'ThierryGoubier 9/20/2013 15:20'!openLabel: aString 	"Open a window on this stream. This is copied from the corresponding method in	TranscriptStream."	| topView controllerClass codeView |	CommandShell isMorphic ifTrue: [^ (self openAsMorphLabel: aString) openInWorld].	aString ifNotNil: [self labelStringBlock: [aString]].	topView := (Smalltalk at: #StandardSystemView) new.	controllerClass := Smalltalk		at: #DeferredActionStandardSystemController		ifAbsent: [(Smalltalk at: #StandardSystemController)].		topView model: self;			controller: controllerClass new;			borderWidth: 1;			label: aString;			minimumSize: 100 @ 50.	codeView := (Smalltalk at: #ShellWindowView)					on: self					text: nil					accept: nil					readSelection: nil					menu: #codePaneMenu:shifted:.	codeView window: (0@0 extent: 200@200).	topView addSubView: codeView.	topView controller addDeferredUIMessage:		[self changed: #relabel.		self prompt].	topView controller open.! !!CommandShellTranscript methodsFor: 'stream extensions' stamp: 'dtl 1/17/2007 06:29'!pastEndPut: anObject	"If the stream reaches its limit, just output the contents and reset."	self endEntry.	^ self nextPut: anObject! !!CommandShellTranscript methodsFor: 'model protocol' stamp: 'dtl 1/17/2007 06:29'!perform: selector orSendTo: otherTarget	"Selector was just chosen from a menu by a user.  If can respond, then	perform it on myself. If not, send it to otherTarget, presumably the	editPane from which the menu was invoked."	(self respondsTo: selector)		ifTrue: [^ self perform: selector]		ifFalse: [^ otherTarget perform: selector]! !!CommandShellTranscript methodsFor: 'evaluation' stamp: 'dtl 9/15/2012 18:59'!processCommand: aCommandString	"Evaluate aCommandString in a separate Smalltalk process. This permits the	user interface to remain responsive."	^ self processCommand: aCommandString echo: true! !!CommandShellTranscript methodsFor: 'evaluation' stamp: 'dtl 9/15/2012 18:56'!processCommand: aCommandString echo: showCommand	"Evaluate aCommandString in a separate Smalltalk process. This permits the	user interface to remain responsive. If showCommand is true, update dependent	views in order to display the command."	^ self cliShell processCommand: aCommandString echo: showCommand! !!CommandShellTranscript methodsFor: 'command prompt' stamp: 'dtl 12/11/2007 21:36'!prompt	self scheduleToEvaluate:		[self show: self cliShell promptString.		self restoreSelectionMarker]! !!CommandShellTranscript methodsFor: 'command prompt' stamp: 'dtl 1/20/2007 11:46'!promptString	"Dependents call this when restoring the prompt string display"	self flag: #FIXME. "change the dependents to call #lastPromptString"	^ self lastPromptString! !!CommandShellTranscript methodsFor: 'command prompt' stamp: 'dtl 1/20/2007 11:42'!promptTwo	self show: self cliShell promptStringTwo.	self restoreSelectionMarker! !!CommandShellTranscript methodsFor: 'command prompt' stamp: 'dtl 1/20/2007 11:40'!restorePrompt	self flag: #FIXME. "remember last prompt string and redisplay it"	self prompt! !!CommandShellTranscript methodsFor: 'command prompt' stamp: 'dtl 11/30/2010 07:33'!restoreSelectionMarker	"Restore selection marker in MVC"	| c |	CommandShell isMorphic		ifFalse:			[c := self activeController.			self scheduleToEvaluate: [c initializeSelection]]! !!CommandShellTranscript methodsFor: 'evaluation' stamp: 'dtl 6/29/2010 22:15'!scheduleToEvaluate: aBlock	"Evaluate aBlock, typically to create a new scheduled window. Make it work in	both Morphic and MVC. In Morphic, just evaluate aBlock, but in MVC, put it in	a queue for evaluation within a control loop. This method may be sent from	a process running independent of MVC controller scheduling.		Newer Squeak images implement #addDeferredUIMessage in the current	project, eliminating the need for an #isMorphic test. This mechanism is not	available for older images or for Pharo."	CommandShell isMorphic		ifTrue: [WorldState addDeferredUIMessage: aBlock]		ifFalse: [self activeController ifNotNil: [activeController addDeferredUIMessage: aBlock]]! !!CommandShellTranscript methodsFor: 'stream extensions' stamp: 'dtl 1/17/2007 06:29'!show: anObject  "TextCollector compatibility"	self nextPutAll: anObject asString; endEntry! !!CommandShellTranscript methodsFor: 'updating' stamp: 'dtl 9/15/2012 18:22'!update: event	event == #prompt	"display $PS1"		ifTrue: [^ self prompt].	event == #alternatePrompt	"display $PS2"		ifTrue: [^ self promptTwo].	event == #restorePrompt	"restore last prompt display"		ifTrue: [self flag: #FIXME. ^ self prompt].	event == #exit		ifTrue: [^ self close].	event == #clearText		ifTrue: [^ self clear].	event == #interruptCharacter		ifTrue: [^ self handleInterruptCharacterEvent].	event == #relabel		ifTrue: [^ self changed: event].	"Treat anything other than the symbols above as a string to be displayed on	the command line in the view"	self show: event asString; cr.! !!ExternalCommandShell class methodsFor: 'instance creation' stamp: 'dtl 2/18/2007 14:09'!default	^ ExternalShell! !!ExternalCommandShell class methodsFor: 'class initialization' stamp: 'dtl 5/20/2011 19:12'!initialize	"If OSProcess is in this  image, it important that #startup be send to	ThisOSProcess before it is sent to ExternalCommandShell. Therefore ensure	that ExternalCommandShell appears after ThisOSProcess in the system	startup list."	"ExternalCommandShell initialize"	ExternalShell ifNotNil:		[ExternalShell stop.		ExternalShell := nil].	Smalltalk addToStartUpList: self! !!ExternalCommandShell class methodsFor: 'instance creation' stamp: 'dtl 7/12/2002 08:01'!new	self notify: self name, ': Only one instance of ExternalCommandShell or any of its subclasses should exist in the image. Use #inSmalltalk to obtain the singleton instance.'.	self shouldNotImplement! !!ExternalCommandShell class methodsFor: 'instance creation' stamp: 'dtl 11/8/2007 20:21'!onTty	"Answer a singleton instance. When called the first time, the shell is created	and its evaluation loop is started. Subsequent calls answer the singleton	instance, which may or may not be running. Use the #stop and #start messages	to control the shell once it has been created."	"ExternalCommandShell onTty"	^ ExternalShell ifNil: [ExternalShell := self basicNew initialize].! !!ExternalCommandShell class methodsFor: 'class initialization' stamp: 'dtl 8/4/2002 16:17'!open	self start! !!ExternalCommandShell class methodsFor: 'system startup' stamp: 'dtl 9/3/2010 17:10'!shutDown: quitting	"System is going down. Stop input processing so we will not try to 	refer to invalid IO streams when the image is restarted. If OSProcess	is in this  image, it important that #startup be send to ThisOSProcess	before it is sent to ExternalCommandShell. Therefore ensure that	ExternalCommandShell appears after ThisOSProcess in the system startup	list."	| shell |	quitting		ifTrue: [(shell := self default)			ifNotNil: [shell shutdownInOldSession]]! !!ExternalCommandShell class methodsFor: 'start-stop' stamp: 'dtl 8/7/2002 19:29'!start	"ExternalCommandShell start"	"ExternalCommandShell stop"	^ self onTty start! !!ExternalCommandShell class methodsFor: 'system startup' stamp: 'dtl 9/3/2010 17:10'!startUp: resuming	| shell |	resuming ifTrue:		[(shell := self default)			ifNotNil: [shell startUpInNewSession]]! !!ExternalCommandShell class methodsFor: 'start-stop' stamp: 'dtl 8/7/2002 19:29'!stop	"ExternalCommandShell stop"	"ExternalCommandShell start"	^ self onTty stop! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 2/18/2007 11:59'!cliShell	"Answer the value of cliShell"	^ cliShell! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:24'!cliShell: anObject	"Set the value of cliShell"	cliShell := anObject! !!ExternalCommandShell methodsFor: 'interrupt handling' stamp: 'dtl 2/18/2007 15:57'!confirm: queryString	"Put up a yes/no menu with caption queryString. Answer true if the 	response is yes, false if no."	self flag: #FIXME. "bypass the dialog and assume true"	self cliShell backgroundMessageQueue addLast: queryString, ' (yes)', Character lf asString.	^ true! !!ExternalCommandShell methodsFor: 'input character filtering' stamp: 'dtl 11/8/2007 20:26'!confirmBeforeKilling: externalProxies	"Interrupt character detected, do interrupt stuff."	| msgStrm |	(externalProxies size > 0)		ifTrue:			[msgStrm := WriteStream on: String new.			(externalProxies size > 1)				ifTrue: [msgStrm nextPutAll: 'kill processes']				ifFalse: [msgStrm nextPutAll: 'kill process'].			externalProxies do: [:e | msgStrm nextPutAll: ' ', e pid printString, ' (', e programName, ')'].			msgStrm nextPut: $?.			(self confirm: msgStrm contents)				ifTrue:					[externalProxies reverseDo: [:e | e terminate]]]! !!ExternalCommandShell methodsFor: 'defaults' stamp: 'dtl 12/30/2002 10:45'!defaultBuiltinCommands	"The commands which make sense in a headless tty environment"	^ #(cd: copyToError: copyToOutput: snapshot: ttyExit: help: history: pwd: sls: type:)! !!ExternalCommandShell methodsFor: 'input processing' stamp: 'dtl 3/20/2007 06:15'!disableInputProcessing	self inputStream removeDependent: self; disableEventHandling! !!ExternalCommandShell methodsFor: 'interrupt handling' stamp: 'dtl 2/18/2007 15:49'!doInterruptCharHandler	"Interrupt character detected, do interrupt stuff."	self confirmBeforeKilling: (self cliShell foregroundProxies		select: [:e | e isExternalProcess]		thenCollect: [:r | r processProxy]).	self confirmBeforeKilling: (self cliShell backgroundProxies		select: [:e | e isExternalProcess]		thenCollect: [:r | r processProxy]).! !!ExternalCommandShell methodsFor: 'command history' stamp: 'dtl 1/20/2007 14:02'!editCommand: aString	self flag: #FIXME. "should interact with tty"	^ super editCommand: aString! !!ExternalCommandShell methodsFor: 'input processing' stamp: 'dtl 3/20/2007 06:14'!enableInputProcessing	self inputStream addDependent: self; enableEventHandling! !!ExternalCommandShell methodsFor: 'input processing' stamp: 'dtl 9/15/2012 18:51'!handleInput: str 	| rs line |	self lineBuffer nextPutAll: str.	[self lineBuffer contents includes: Character lf]		whileTrue: [rs := ReadStream on: lineBuffer contents.			self lineBuffer: nil.			line := rs upTo: Character lf.			self cliShell command: line echo: false.			self lineBuffer nextPutAll: rs upToEnd]! !!ExternalCommandShell methodsFor: 'initialize-release' stamp: 'dtl 3/12/2007 18:44'!initialize	super initialize.	self cliShell: (CommandShell new			installCommands: self defaultBuiltinCommands;			promptString: 'sqsh> ';			addDependent: self;			yourself).	self setStdioStreams! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 7/12/2002 19:15'!inputStream	^ inputStream! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:24'!inputStream: externalStream	inputStream := externalStream! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:24'!isRunning	"True if my evaluation loop should be running. This instance variable supports	restarting the evaluation loop after an image restart."	^ isRunning ifNil: [isRunning := false]! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:24'!isRunning: trueOrFalse	"True if my evaluation loop should be running. This instance variable supports	restarting the evaluation loop after an image restart."	isRunning := trueOrFalse! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 2/24/2013 10:23'!lineBuffer	"Answer the value of lineBuffer"	^ lineBuffer ifNil: [lineBuffer := WriteStream on: String new]! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:24'!lineBuffer: anObject	"Set the value of lineBuffer"	lineBuffer := anObject! !!ExternalCommandShell methodsFor: 'printing' stamp: 'dtl 4/9/2006 11:11'!printOn: aStream	super printOn: aStream.	aStream nextPutAll: (self isRunning ifTrue: [' (running)'] ifFalse: [' (stopped)'])! !!ExternalCommandShell methodsFor: 'command prompt' stamp: 'dtl 2/18/2007 12:37'!prompt	self cliShell outputStream nextPutAll: self cliShell promptString.! !!ExternalCommandShell methodsFor: 'command prompt' stamp: 'dtl 1/20/2007 11:46'!promptString	"Dependents call this when restoring the prompt string display"	self flag: #FIXME. "change the dependents to call #lastPromptString"	^ self lastPromptString! !!ExternalCommandShell methodsFor: 'command prompt' stamp: 'dtl 2/18/2007 17:36'!promptTwo	self cliShell outputStream nextPutAll: self cliShell promptStringTwo! !!ExternalCommandShell methodsFor: 'initialize-release' stamp: 'dtl 9/3/2010 17:08'!release	cliShell ifNotNil: [cliShell removeDependent: self].	super release! !!ExternalCommandShell methodsFor: 'command prompt' stamp: 'dtl 1/20/2007 11:40'!restorePrompt	self flag: #FIXME. "remember last prompt string and redisplay it"	self prompt! !!ExternalCommandShell methodsFor: 'initialize-release' stamp: 'dtl 2/18/2007 11:22'!setNonblockingInput	Smalltalk at: #OSProcess ifPresent:		[:osp | osp thisOSProcess stdIn setNonBlocking]! !!ExternalCommandShell methodsFor: 'initialize-release' stamp: 'dtl 3/12/2007 22:33'!setStdioStreams	Smalltalk		at: #OSProcess		ifPresent: [:osp | 			self inputStream: osp thisOSProcess stdIn				asBufferedAsyncFileReadStream disableEventHandling.			self cliShell outputStream: osp thisOSProcess stdOut.			self cliShell errorStream: osp thisOSProcess stdErr]! !!ExternalCommandShell methodsFor: 'initialize-release' stamp: 'dtl 3/12/2007 18:54'!shutdownInOldSession	"The VM is about to shut down."	self disableInputProcessing.	self stopHandlingInterruptSignal! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:25'!sigIntHandler	"The interrupt handler process, for catching <ctl>C from the keyboard."	^ sigIntHandler ifNil: [sigIntHandler := self sigIntHandlerProcess]! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:25'!sigIntHandler: aProcess	"The interrupt handler process, for catching <ctl>C from the keyboard."	sigIntHandler := aProcess! !!ExternalCommandShell methodsFor: 'interrupt handling' stamp: 'dtl 12/15/2002 15:43'!sigIntHandlerProcess	"The interrupt handler process, for catching <ctl>C from the keyboard."	^ [[self sigIntSema isNil		ifTrue:			[(Delay forMilliseconds: 1000) wait]		ifFalse:			[self sigIntSema wait.			self doInterruptCharHandler]] repeat] fork! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 8/4/2002 12:48'!sigIntSema	"A Smalltalk Semaphore which will be signalled when an external SIGINT signal is	received from the operating system."	^ sigIntSema! !!ExternalCommandShell methodsFor: 'accessing' stamp: 'dtl 11/8/2007 20:25'!sigIntSema: aSemaphore	"A Smalltalk Semaphore which will be signalled when an external SIGINT signal is	received from the operating system."	sigIntSema := aSemaphore! !!ExternalCommandShell methodsFor: 'initialize-release' stamp: 'dtl 3/13/2007 06:23'!start	self isRunning ifTrue: [self stop].	self setNonblockingInput.	self isRunning: true.	self startHandlingInterruptSignal.	self cliShell addDependent: self.	self cliShell outputStream cr; nextPut: Character lf.	self cliShell notifyPrompt.	self enableInputProcessing! !!ExternalCommandShell methodsFor: 'interrupt handling' stamp: 'dtl 11/8/2007 20:26'!startHandlingInterruptSignal	"Whenever a SIGINT is received, forward it to my sigIntSema."	| sema |	sigIntHandler ifNotNil: [sigIntHandler terminate. self sigIntHandler: nil].	Smalltalk at: #OSProcess		ifPresent:			[:osp |			osp accessor handlesOsSignals ifTrue:				[sema := osp accessor forwardSignal: osp accessor primSigIntNumber.				sema ifNotNil: [self sigIntSema: sema].				self sigIntHandler]]! !!ExternalCommandShell methodsFor: 'initialize-release' stamp: 'dtl 3/12/2007 22:31'!startUpInNewSession	"Image has been restarted, so the references to standard input, output	and error are no longer valid. Reinitialize to make things right."	self setNonblockingInput.	self setStdioStreams.	self isRunning		ifTrue: [self stop; start]! !!ExternalCommandShell methodsFor: 'initialize-release' stamp: 'dtl 9/3/2010 17:08'!stop	self disableInputProcessing.	self stopHandlingInterruptSignal.	cliShell ifNotNil: [cliShell removeDependent: self].	self isRunning: false! !!ExternalCommandShell methodsFor: 'interrupt handling' stamp: 'dtl 8/8/2002 15:19'!stopHandlingInterruptSignal	"Revert to prior SIGINT handling behavior in the VM."	Smalltalk at: #OSProcess		ifPresent:			[:osp |			osp accessor handlesOsSignals				ifTrue:					[osp accessor restoreSignal: osp accessor primSigIntNumber].			self sigIntSema: nil.			self sigIntHandler terminate.			self sigIntHandler: nil]! !!ExternalCommandShell methodsFor: 'updating' stamp: 'dtl 9/15/2012 18:22'!update: event	event == self inputStream		ifTrue: [^ self handleInput: event upToEnd].	event == #prompt	"display $PS1"		ifTrue: [^ self prompt].	event == #alternatePrompt	"display $PS2"		ifTrue: [^ self promptTwo].	event == #restorePrompt	"restore last prompt display"		ifTrue: [self flag: #FIXME. ^ self prompt].	event == #exit		ifTrue: [^ self close].	event == #clearText		ifTrue: [^ self error: 'FIXME'].	event == #interruptCharacter		ifTrue: [^ self doInterruptCharHandler].	"Treat anything other than the symbols above as a string to be displayed on	the command line in the view"	self show: event asString; cr.! !"CommandShell-UI"!!AbstractUnixProcessFileLockingTestCase commentStamp: 'dtl 4/30/2006 14:02' prior: 0!Test file locking with the UnixOSProcessPlugin. The test suite requires that OSProcess and CommandShell be loaded in the image.These tests rely on a remote Squeak image to test file locks between cooperating Unix processes. This may be timing dependent (see #delay, set in #setUp, and cleanup in #tearDown). In case of intermittent failures, try running the failed test individually. In some cases it may be necessary to restart Squeak in order to clear leftover file locks from previous failed tests.!!UnixProcessUnixFileLockingTestCase commentStamp: 'dtl 4/30/2006 14:03' prior: 0!Test file locking with the UnixOSProcessPlugin using Unix file locking semantics. The test suite requires that OSProcess and CommandShell be loaded in the image.These tests rely on a remote Squeak image to test file locks between cooperating Unix processes. This may be timing dependent (see #delay, set in #setUp, and cleanup in #tearDown). In case of intermittent failures, try running the failed test individually. In some cases it may be necessary to restart Squeak in order to clear leftover file locks from previous failed tests.!!UnixProcessWin32FileLockingTestCase commentStamp: 'dtl 4/30/2006 14:03' prior: 0!Test file locking with the UnixOSProcessPlugin using Windows file locking semantics. The test suite requires that OSProcess and CommandShell be loaded in the image.These tests rely on a remote Squeak image to test file locks between cooperating Unix processes. This may be timing dependent (see #delay, set in #setUp, and cleanup in #tearDown). In case of intermittent failures, try running the failed test individually. In some cases it may be necessary to restart Squeak in order to clear leftover file locks from previous failed tests.!!AioEventHandlerTestCase commentStamp: 'dtl 7/10/2005 15:41' prior: 0!Test AioEventHandler and AioPlugin. Provides fair coverage of IO readable events, minimal coverage of IO writable events, and no real coverage for IO exception events. The writable events and exception events probably work, but this test suite will not prove it.!!OSPipeTestCase commentStamp: '<historical>' prior: 0!Test operation of OSPipe in blocking and nonBlocking mode.!!UnixProcessAccessorTestCase commentStamp: '<historical>' prior: 0!Unit tests for the UnixProcessAccessor.!!UnixProcessFileLockTestCase commentStamp: 'dtl 3/7/2005 21:57' prior: 0!This test case was provided by Julian Fitzell. It provides more file locking tests in addition to those in UnitProcessFileLockingTestCase.!!UnixProcessTestCase commentStamp: '<historical>' prior: 0!Unit tests for the Unix portion of OSProcess.!!AbstractUnixProcessFileLockingTestCase class methodsFor: 'testing' stamp: 'dtl 4/30/2006 13:49'!isAbstract	"Override to true if a TestCase subclass is Abstract and should not have	TestCase instances built from it"	^ true! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'accessing' stamp: 'dtl 4/30/2006 13:47'!accessor	"Answer the value of accessor"	^ accessor! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'accessing' stamp: 'dtl 4/30/2006 13:47'!accessor: anObject	"Set the value of accessor"	accessor := anObject! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'accessing' stamp: 'dtl 4/30/2006 13:47'!delay	"Answer the value of delay"	^ delay! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'accessing' stamp: 'dtl 4/30/2006 13:47'!delay: anObject	"Set the value of delay"	delay := anObject! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'remote image commands' stamp: 'dtl 12/15/2013 15:50'!doRemote: remoteBlock doLocal: localBlock	"Evaluate remoteBlock in a remote Squeak image. While the remote Squeak is	still running, evaluate localBlock. When done, terminate the remote Squeak	image and answer the result of evaluating localBlock."	"self new		doRemote: [OSProcess thisOSProcess stdOut nextPutAll: 'hello from child Squeak';						nextPut: Character lf]		doLocal: [(Delay forSeconds: 1) wait.						OSProcess thisOSProcess stdOut nextPutAll: 'hello from parent Squeak';					nextPut: Character lf]"	| result |	self shouldnt: [remoteProcess := OSProcess thisOSProcess forkHeadlessSqueak]		raise: Warning.	self assert: remoteProcess notNil. "Fail if fork did not succeed"	(remoteProcess == OSProcess thisOSProcess)		ifTrue:			["remote child Squeak"			remoteBlock value]		ifFalse:			["parent Squeak"			[[remoteProcess isRunning] whileFalse: [self delay wait].			self delay wait.			result := localBlock value]				ensure:	[remoteProcess terminate.					[remoteProcess isComplete] whileFalse: [self delay wait].					self delay wait.					result]].	^ result! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'failures' stamp: 'eem 3/27/2014 11:28'!expectedFailures	^UnixOSProcessAccessor basicNew safeToForkSqueak		ifTrue: [#()]		ifFalse: [#(	testCooperatingProcesses01					testCooperatingProcesses02					testCooperatingProcesses03					testCooperatingProcesses04					testCooperatingProcesses05					testFailFileLockOnLockedFile					testFailLockOnLockedOverlappedRegion					testFailLockOnLockedRegion					testFailLockOnLockedSupersetRegion					testFailRegionLockOnLockedFile					testLockEntireFileForWrite01					testLockEntireFileForWrite02					testLockEntireFileForWrite03					testLockEntireFileForWrite04					testLockEntireFileForWrite05					testLockEntireFileForWrite06					testLockRegionForRead01					testLockRegionForRead02					testLockRegionForWrite01					testLockRegionForWrite02					testLockRegionForWrite03					testLockRegionForWrite04					testLockRegionForWrite05					testLockRegionForWrite06					testLockRegionForWrite07					testLockRegionForWrite08					testNoFailLockOnAdjacentLockedRegions					testNoFailLockOnDifferentLockedRegion)]! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'accessing' stamp: 'dtl 4/30/2006 13:47'!fileStream	"Answer the value of fileStream"	^ fileStream! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'accessing' stamp: 'dtl 4/30/2006 13:47'!fileStream: anObject	"Set the value of fileStream"	fileStream := anObject! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'accessing' stamp: 'dtl 4/30/2006 13:57'!initialCompatibilitySetting	"Answer the value of initialCompatibilitySetting"	^ initialCompatibilitySetting! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'accessing' stamp: 'dtl 4/30/2006 13:57'!initialCompatibilitySetting: anObject	"Set the value of initialCompatibilitySetting"	initialCompatibilitySetting := anObject! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'initialize' stamp: 'dtl 4/30/2006 13:58'!initialize	initialCompatibilitySetting		ifNil: [self initialCompatibilitySetting: OSProcess accessor emulateWin32FileLocking]! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/13/2006 09:36'!isValidUnlockResult: result	self subclassResponsibility! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'remote image commands' stamp: 'dtl 4/30/2006 13:47'!quitImage	fileStream close.	OSProcess snapshot: false andQuit: true! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'running' stamp: 'dtl 7/30/2010 16:38'!setUp	(self respondsTo: #timeout: ) "Recent Squeak images with test case timeout"		ifTrue: [self perform: #timeout: with: 30].	self delay: (Delay forMilliseconds: 150).	self accessor: ThisOSProcess accessor.	self fileStream: (FileStream fileNamed: 'junkfile').	1000 timesRepeat: (fileStream nextPutAll: 'hello world ').! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'running' stamp: 'dtl 9/3/2010 16:02'!tearDown	| d |	OSProcessAccessor emulateWin32FileLocking: self initialCompatibilitySetting.	d := Delay forMilliseconds: 50.	self fileStream close.	remoteProcess ifNotNil:		[remoteProcess terminate.		[remoteProcess isComplete] whileFalse: [d wait].		remoteProcess := nil]! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 4/30/2006 13:47'!testCooperatingProcesses01	"Two cooperating Squeak processes using file region locking to coordinate their	writes to a shared file."	"(self selector: #testCooperatingProcesses01) run"	| result |	result := self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 120) notNil]) ifNil: [self quitImage].			fileStream position: 100.			fileStream nextPutAll: 'THIS '.			accessor unlockFile: fileStream from: 100 to: 120.			delay wait.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			fileStream position: 108.			fileStream nextPutAll: 'A '.			accessor unlockFile: fileStream from: 108 to: 120.			delay wait.			self quitImage]		doLocal:			[self assert: (self tryUntil: [(accessor lockFile: fileStream from: 104 to: 120) notNil]).			fileStream position: 105.			fileStream nextPutAll: 'IS '.			accessor unlockFile: fileStream from: 104 to: 120.			delay wait.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			fileStream position: 110.			fileStream nextPutAll: 'TEST '.			accessor unlockFile: fileStream from: 108 to: 120.			delay wait].	self tryUntil: [(accessor lockFile: fileStream from: 100 to: 140) notNil].	fileStream position: 100.	result := fileStream next: 14.	accessor unlockFile: fileStream from: 100 to: 140.	self assert: result = 'THIS IS A TEST'! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 4/30/2006 13:47'!testCooperatingProcesses02	"Two cooperating Squeak processes using file region locking to coordinate their	writes to a shared file."	"(self selector: #testCooperatingProcesses02) run"	| result |	result := self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 120) notNil]) ifNil: [self quitImage].			fileStream position: 100.			fileStream nextPutAll: 'THIS 11111111111111111111111'.			accessor unlockFile: fileStream from: 100 to: 120.			delay wait; wait; wait.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			fileStream position: 108.			fileStream nextPutAll: 'A 3333333333333333333333333'.			accessor unlockFile: fileStream from: 108 to: 120.			self quitImage]		doLocal:			[self assert: (self tryUntil: [(accessor lockFile: fileStream from: 104 to: 120) notNil]).			fileStream position: 105.			fileStream nextPutAll: 'IS 2222222222222222222222222'.			accessor unlockFile: fileStream from: 104 to: 120.			delay wait; wait; wait.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			fileStream position: 110.			fileStream nextPutAll: 'TEST 4444444444444444444444'.			accessor unlockFile: fileStream from: 108 to: 120].	self tryUntil: [(accessor lockFile: fileStream from: 100 to: 140) notNil].	fileStream position: 100.	result := fileStream next: 17.	accessor unlockFile: fileStream from: 100 to: 140.	self assert: result = 'THIS IS A TEST 44'! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 4/30/2006 13:47'!testCooperatingProcesses03	"Two cooperating Squeak processes using file region locking to coordinate their	writes to a shared file."	"(self selector: #testCooperatingProcesses03) run"	| result |	result := self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 120) notNil]) ifNil: [self quitImage].			fileStream position: 100.			fileStream nextPutAll: 'THIS 11111111111111111111111'.			accessor unlockFile: fileStream from: 100 to: 120.			delay wait; wait; wait.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			fileStream position: 108.			fileStream nextPutAll: 'A 3333333333333333333333333'.			accessor unlockFile: fileStream from: 108 to: 120.			self quitImage]		doLocal:			[self assert: (self tryUntil: [(accessor lockFile: fileStream from: 104 to: 120) notNil]).			fileStream position: 105.			fileStream nextPutAll: 'IS 2222222222222222222222222'.			accessor unlockFile: fileStream from: 104 to: 120.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			fileStream position: 110.			fileStream nextPutAll: 'TEST 4444444444444444444444'.			accessor unlockFile: fileStream from: 108 to: 120].	self tryUntil: [(accessor lockFile: fileStream from: 100 to: 140) notNil].	fileStream position: 100.	result := fileStream next: 17.	accessor unlockFile: fileStream from: 100 to: 140.	self assert: result = 'THIS IS 22TEST 44'! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 4/30/2006 13:47'!testCooperatingProcesses04	"Two cooperating Squeak processes using file region locking to coordinate their	writes to a shared file."	"(self selector: #testCooperatingProcesses04) run"	| result |	result := self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 120) notNil]) ifNil: [self quitImage].			delay wait.			fileStream position: 100.			fileStream nextPutAll: 'THIS 11111111111111111111111'.			accessor unlockFile: fileStream from: 100 to: 120.			delay wait.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			delay wait.			fileStream position: 108.			fileStream nextPutAll: 'A 3333333333333333333333333'.			accessor unlockFile: fileStream from: 108 to: 120.			delay wait.			self quitImage]		doLocal:			[self assert: (self tryUntil: [(accessor lockFile: fileStream from: 104 to: 120) notNil]).			delay wait.			fileStream position: 105.			fileStream nextPutAll: 'IS 2222222222222222222222222'.			accessor unlockFile: fileStream from: 104 to: 120.			delay wait.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			fileStream position: 110.			fileStream nextPutAll: 'TEST 4444444444444444444444'.			accessor unlockFile: fileStream from: 108 to: 120].	self tryUntil: [(accessor lockFile: fileStream from: 100 to: 140) notNil].	fileStream position: 100.	result := fileStream next: 17.	accessor unlockFile: fileStream from: 100 to: 140.	self assert: result = 'THIS IS A TEST 44'! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 4/30/2006 13:47'!testCooperatingProcesses05	"Two cooperating Squeak processes using file region locking to coordinate their	writes to a shared file."	"(self selector: #testCooperatingProcesses05) run"	| result |	result := self		doRemote:			[OSProcess thisOSProcess stdOut nextPutAll: 'starting remote squeak requesting lock on 100 to 120';				nextPut: Character lf.			(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 120) notNil]) ifNil: [self quitImage].			OSProcess thisOSProcess stdOut nextPutAll: 'remote squeak lock acquired on 100 to 120'; nextPut: Character lf.			fileStream position: 100.			fileStream nextPutAll: 'THIS '.			OSProcess thisOSProcess stdOut nextPutAll: 'remote squeak releasing lock on 100 to 120'; nextPut: Character lf.			accessor unlockFile: fileStream from: 100 to: 120.			OSProcess thisOSProcess stdOut nextPutAll: 'remote squeak lock released on 100 to 120'; nextPut: Character lf.			delay wait.			OSProcess thisOSProcess stdOut nextPutAll: 'remote squeak requesting lock on 108 to: 120'; nextPut: Character lf.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			OSProcess thisOSProcess stdOut nextPutAll: 'remote squeak lock acquired on 108 to: 120'; nextPut: Character lf.			fileStream position: 108.			fileStream nextPutAll: 'A '.			OSProcess thisOSProcess stdOut nextPutAll: 'remote squeak releasing lock on 108 to: 120'; nextPut: Character lf.			accessor unlockFile: fileStream from: 108 to: 120.			OSProcess thisOSProcess stdOut nextPutAll: 'remote squeak lock released on 108 to: 120'; nextPut: Character lf.			delay wait.			self quitImage]		doLocal:			[OSProcess thisOSProcess stdOut nextPutAll: 'starting local squeak requesting lock on 104 to: 120';				nextPut: Character lf.			self assert: (self tryUntil: [(accessor lockFile: fileStream from: 104 to: 120) notNil]).			OSProcess thisOSProcess stdOut nextPutAll: 'local squeak lock acquired on 104 to: 120'; nextPut: Character lf.			fileStream position: 105.			fileStream nextPutAll: 'IS '.			OSProcess thisOSProcess stdOut nextPutAll: 'local squeak releasing lock on 104 to: 120'; nextPut: Character lf.			accessor unlockFile: fileStream from: 104 to: 120.			OSProcess thisOSProcess stdOut nextPutAll: 'local squeak lock released on 104 to: 120'; nextPut: Character lf.			delay wait.			OSProcess thisOSProcess stdOut nextPutAll: 'local squeak requesting lock on 108 to: 120'; nextPut: Character lf.			self tryUntil: [(accessor lockFile: fileStream from: 108 to: 120) notNil].			OSProcess thisOSProcess stdOut nextPutAll: 'local squeak lock acquired on 108 to: 120'; nextPut: Character lf.			fileStream position: 110.			fileStream nextPutAll: 'TEST '.			OSProcess thisOSProcess stdOut nextPutAll: 'local squeak releasing lock on 108 to: 120'; nextPut: Character lf.			accessor unlockFile: fileStream from: 108 to: 120.			OSProcess thisOSProcess stdOut nextPutAll: 'local squeak lock released on 108 to: 120'; nextPut: Character lf.			delay wait].	self tryUntil: [(accessor lockFile: fileStream from: 100 to: 140) notNil].	fileStream position: 100.	result := fileStream next: 14.	accessor unlockFile: fileStream from: 100 to: 140.	self assert: result = 'THIS IS A TEST'! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - exclusive locking' stamp: 'dtl 8/30/2009 15:55'!testFailFileLockOnLockedFile	"Two cooperating Squeak processes using mandatory file locking. When	child Squeak takes a lock on a region, lock attempt in parent Squeak will	fail."	"(self selector: #testFailFileLockOnLockedFile) run"	self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream) notNil]) ifNil: [self quitImage].			delay wait; wait; wait.			accessor unlockFile: fileStream.			self quitImage]		doLocal:			[self should: [				10 timesRepeat: [ "lock and unlock until failure due to child taking the lock"					accessor lockFile: fileStream							exclusive: true							ifFail: [self error: '#lockFile failed because child Squeak now holds a lock'].					accessor unlockFile: fileStream. "release lock to allow child to acquire it"					delay wait]]				raise: Error				description: '#lockFile failed because child Squeak now holds a lock']! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - exclusive locking' stamp: 'dtl 8/30/2009 16:00'!testFailLockOnLockedOverlappedRegion	"Two cooperating Squeak processes using mandatory file locking. When	child Squeak takes a lock on a region, lock attempt in parent Squeak will	fail. Locked regions overlap by one character."	"(self selector: #testFailLockOnLockedOverlappedRegion) run"	self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 104) notNil]) ifNil: [self quitImage].			delay wait; wait; wait.			accessor unlockFile: fileStream from: 100 to: 104.			self quitImage]		doLocal:			[self should: [				10 timesRepeat: [ "lock and unlock until failure due to child taking the lock"					accessor lockFile: fileStream							from: 104							to: 120							exclusive: true							ifFail: [self error: '#lockFile failed because child Squeak now holds a lock'].					accessor unlockFile: fileStream from: 104 to: 120. "release lock to allow child to acquire it"					delay wait]]				raise: Error				description: '#lockFile failed because child Squeak now holds a lock']! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - exclusive locking' stamp: 'dtl 8/30/2009 15:51'!testFailLockOnLockedRegion	"Two cooperating Squeak processes using mandatory file locking. When	child Squeak takes a lock on a region, lock attempt in parent Squeak will	fail."	"(self selector: #testFailLockOnLockedRegion) run"	self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 120) notNil]) ifNil: [self quitImage].			delay wait; wait; wait.			accessor unlockFile: fileStream from: 100 to: 120.			self quitImage]		doLocal:			[self should: [				10 timesRepeat: [ "lock and unlock until failure due to child taking the lock"					accessor lockFile: fileStream							from: 100							to: 120							exclusive: true							ifFail: [self error: '#lockFile failed because child Squeak now holds a lock'].					accessor unlockFile: fileStream from: 100 to: 120. "release lock to allow child to acquire it"					delay wait]]				raise: Error				description: '#lockFile failed because child Squeak now holds a lock']! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - exclusive locking' stamp: 'dtl 8/30/2009 16:01'!testFailLockOnLockedSupersetRegion	"Two cooperating Squeak processes using mandatory file locking. When	child Squeak takes a lock on a region, lock attempt in parent Squeak will	fail. Fail when requesting a lock on a subset of the locked region."	"(self selector: #testFailLockOnLockedSupersetRegion) run"	self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 140) notNil]) ifNil: [self quitImage].			delay wait; wait; wait.			accessor unlockFile: fileStream from: 100 to: 140.			self quitImage]		doLocal:			[self should: [				10 timesRepeat: [ "lock and unlock until failure due to child taking the lock"					accessor lockFile: fileStream							from: 104							to: 120							exclusive: true							ifFail: [self error: '#lockFile failed because child Squeak now holds a lock'].					accessor unlockFile: fileStream from: 104 to: 120. "release lock to allow child to acquire it"					delay wait]]				raise: Error				description: '#lockFile failed because child Squeak now holds a lock']! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - exclusive locking' stamp: 'dtl 8/30/2009 16:02'!testFailRegionLockOnLockedFile	"Two cooperating Squeak processes using mandatory file locking. When	child Squeak takes a lock on a file, the region lock attempt in parent	Squeak will fail."	"(self selector: #testFailRegionLockOnLockedFile) run"	self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream) notNil]) ifNil: [self quitImage].			delay wait; wait; wait.			accessor unlockFile: fileStream.			self quitImage]		doLocal:			[self should: [				10 timesRepeat: [ "lock and unlock until failure due to child taking the lock"					accessor lockFile: fileStream							from: 100							to: 120							exclusive: true							ifFail: [self error: '#lockFile failed because child Squeak now holds a lock'].					accessor unlockFile: fileStream from: 100 to: 120. "release lock to allow child to acquire it"					delay wait]]				raise: Error				description: '#lockFile failed because child Squeak now holds a lock']! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 22:44'!testLockEntireFileForWrite01	"Local lock request should succeed"	"(self selector: #testLockEntireFileForWrite01) run"	| result |	result := self		doRemote: [nil]		doLocal: [accessor lockFile: fileStream].	self delay wait; wait.	self assert: (result isKindOf: OSFileLock).	result := accessor unlockFile: fileStream.	self assert: (result isKindOf: OSFileLock)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:40'!testLockEntireFileForWrite02	"Local lock request should fail"	"(self selector: #testLockEntireFileForWrite02) run"	| result |	result := self		doRemote:			[accessor lockFile: fileStream]		doLocal: [accessor lockFile: fileStream].	self delay wait; wait.	self assert: result isNil.	"Region is in the cache as a result of the (failed) lock request. This is legitimate	because the lock exists in some other image, so we want to mark it as locked	locally. However, it is not quite correct because the remote lock may pertain to	a different but overlapping region. Nevertheless, this seems like reasonable	behavior."	result := accessor unlockFile: fileStream.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 22:45'!testLockEntireFileForWrite03	"Local lock request should succeed"	"(self selector: #testLockEntireFileForWrite03) run"	| result |	result := self		doRemote:			[accessor lockFile: fileStream.			accessor unlockFile: fileStream]		doLocal:			[accessor lockFile: fileStream].	self delay wait; wait.	self assert: (result isKindOf: OSFileLock).	result := accessor unlockFile: fileStream.	self assert: (result isKindOf: OSFileLock)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:48'!testLockEntireFileForWrite04	"Local lock should be available"	"(self selector: #testLockEntireFileForWrite04) run"	| result |	result := self		doRemote: [nil]		doLocal: [accessor isLockableFile: fileStream].	self delay wait; wait.	self should: result.	"No lock on the region, so the unlock should fail."	result := accessor unlockFile: fileStream.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:50'!testLockEntireFileForWrite05	"Local lock should be available"	"(self selector: #testLockEntireFileForWrite05) run"	| result |	result := self		doRemote:			[accessor lockFile: fileStream]		doLocal: [accessor isLockableFile: fileStream].	self delay wait; wait.	self shouldnt: result.	"No local lock in the cache for this file, so the unlock call will appear to fail.	Actually, it will have passed the unlock request through to the operating system,	and it will actually unlock the file."	result := accessor unlockFile: fileStream.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:49'!testLockEntireFileForWrite06	"Local lock should be available"	"(self selector: #testLockEntireFileForWrite06) run"	| result |	result := self		doRemote:			[accessor lockFile: fileStream.			accessor unlockFile: fileStream]		doLocal:			[accessor isLockableFile: fileStream].	self delay wait; wait.	self should: result.	"No local lock in the cache for this file, so the unlock call will appear to fail.	Actually, it will have passed the unlock request through to the operating system,	but it will have no effect because the file was never locked."	result := accessor unlockFile: fileStream.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'fail blocks' stamp: 'dtl 5/11/2006 07:22'!testLockFileIfFail	"(self selector: #testLockFileIfFail) run"	| fail |	fail := false.	accessor lockFile: fileStream ifFail: [fail := true].	self shouldnt: fail.	fileStream close.	accessor lockFile: fileStream ifFail: [fail := true].	self should: fail! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'fail blocks' stamp: 'dtl 11/28/2010 19:05'!testLockFileRegionIfFail	"(self selector: #testLockFileRegionIfFail) run"	| fail |	fail := false.	accessor		lockFile: fileStream from: 100 to: 199 exclusive: true		ifFail: [fail := true].	self shouldnt: fail.	fileStream close.	accessor		lockFile: fileStream from: 100 to: 199 exclusive: true		ifFail: [fail := true].	self should: fail.	accessor		lockFile: fileStream from: 100 to: 199		ifFail: [fail := true].	self should: fail! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/10/2006 07:04'!testLockPreviouslyLockedFile	self subclassResponsibility! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/10/2006 07:10'!testLockPreviouslyLockedFileRegion	self subclassResponsibility! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 22:46'!testLockRegionForRead01	"Read lock, the local lock request should succeed"	"(self selector: #testLockRegionForRead01) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: false]		doLocal: [accessor lockFile: fileStream from: 100 to: 199 exclusive: false].	self delay wait; wait.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199)).	result := accessor unlockFile: fileStream from: 100 to: 199 exclusive: false.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199))! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:53'!testLockRegionForRead02	"Read lock, the local lock request should fail when requesting a write lock"	"(self selector: #testLockRegionForRead02) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true]		doLocal: [accessor lockFile: fileStream from: 100 to: 199 exclusive: false].	self delay wait; wait.	self assert: result isNil.	result := accessor unlockFile: fileStream from: 100 to: 199.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 22:46'!testLockRegionForWrite01	"Local lock request should succeed"	"(self selector: #testLockRegionForWrite01) run"	| result |	result := self		doRemote: [nil]		doLocal: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true].	self delay wait; wait.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199)).	result := accessor unlockFile: fileStream from: 100 to: 199.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199))! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 4/30/2006 13:47'!testLockRegionForWrite02	"Write lock, the local lock request should fail"	"(self selector: #testLockRegionForWrite02) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true]		doLocal: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true].	self delay wait; wait.	self assert: result isNil.	"Lock is not in the local cache, so unlock will appear to fail. Actually, the region	will be unlocked."	accessor unlockFile: fileStream from: 100 to: 199.	self assert: result isNil.! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:55'!testLockRegionForWrite03	"Write lock, nonoverlapping regions, the lock check should succeed"	"(self selector: #testLockRegionForWrite03) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true]		doLocal: [accessor isLockableFile: fileStream from: 200 to: 299 exclusive: true].	self delay wait; wait.	self assert: result.	result := accessor unlockFile: fileStream from: 200 to: 299.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:53'!testLockRegionForWrite04	"Write lock, overlapping regions, the local lock request should fail"	"(self selector: #testLockRegionForWrite04) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true]		doLocal: [accessor lockFile: fileStream from: 150 to: 249 exclusive: true].	self delay wait; wait.	self assert: result isNil.	result := accessor unlockFile: fileStream from: 150 to: 249.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 22:47'!testLockRegionForWrite05	"Write lock, nonoverlapping regions, the local lock request should succeed"	"(self selector: #testLockRegionForWrite05) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true]		doLocal: [accessor lockFile: fileStream from: 200 to: 299 exclusive: true].	self delay wait; wait.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (200 to: 299)).	result := accessor unlockFile: fileStream from: 200 to: 299.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (200 to: 299))! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:53'!testLockRegionForWrite06	"Write lock, overlapping regions, the local lock request should fail"	"(self selector: #testLockRegionForWrite06) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true]		doLocal: [accessor lockFile: fileStream from: 199 to: 199 exclusive: true].	self delay wait; wait.	self assert: result isNil.	result := accessor unlockFile: fileStream from: 199 to: 199.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:55'!testLockRegionForWrite07	"Write lock, overlapping regions, the lock check should fail"	"(self selector: #testLockRegionForWrite07) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true]		doLocal: [accessor isLockableFile: fileStream from: 100 to: 199 exclusive: true].	self delay wait; wait.	self deny: result.	result := accessor unlockFile: fileStream from: 100 to: 199.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/13/2006 09:55'!testLockRegionForWrite08	"Write lock, overlapping regions, the lock check should fail"	"(self selector: #testLockRegionForWrite08) run"	| result |	result := self		doRemote: [accessor lockFile: fileStream from: 100 to: 199 exclusive: true]		doLocal: [accessor isLockableFile: fileStream from: 150 to: 299 exclusive: true].	self delay wait; wait.	self deny: result.	result := accessor unlockFile: fileStream from: 150 to: 299.	self assert: (self isValidUnlockResult: result)! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - exclusive locking' stamp: 'dtl 8/30/2009 16:03'!testNoFailLockOnAdjacentLockedRegions	"Two cooperating Squeak processes using mandatory file locking. When	child Squeak takes a lock on a region, lock attempt in parent Squeak will	fail. No failure occurs when the regions are adjacent but do not overlap."	"(self selector: #testNoFailLockOnAdjacentLockedRegions) run"	self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 100 to: 103) notNil]) ifNil: [self quitImage].			delay wait; wait; wait.			accessor unlockFile: fileStream from: 100 to: 103.			self quitImage]		doLocal:			[self shouldnt: [				10 timesRepeat: [ "lock and unlock until failure due to child taking the lock"					accessor lockFile: fileStream							from: 104							to: 120							exclusive: true							ifFail: [self error: '#lockFile failed because child Squeak now holds a lock'].					accessor unlockFile: fileStream from: 104 to: 120. "release lock to allow child to acquire it"					delay wait]]				raise: Error]! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - exclusive locking' stamp: 'dtl 8/30/2009 16:03'!testNoFailLockOnDifferentLockedRegion	"Two cooperating Squeak processes using mandatory file locking. When	child Squeak takes a lock on a region, lock attempt in parent Squeak will	fail. No failure occurs if the regions are different and do not overlap."	"(self selector: #testNoFailLockOnDifferentLockedRegion) run"	self		doRemote:			[(self tryUntil: [(accessor lockFile: fileStream from: 50 to: 80) notNil]) ifNil: [self quitImage].			delay wait; wait; wait.			accessor unlockFile: fileStream from: 50 to: 80.			self quitImage]		doLocal:			[self shouldnt: [				10 timesRepeat: [ "lock and unlock until failure due to child taking the lock"					accessor lockFile: fileStream							from: 104							to: 120							exclusive: true							ifFail: [self error: '#lockFile failed because child Squeak now holds a lock'].					accessor unlockFile: fileStream from: 104 to: 120. "release lock to allow child to acquire it"					delay wait]]				raise: Error]! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'fail blocks' stamp: 'dtl 5/11/2006 07:24'!testUnlockFileIfFail	"(self selector: #testUnlockFileIfFail) run"	| fail |	fail := false.	accessor lockFile: fileStream ifFail: [fail := true].	self shouldnt: fail.	accessor unlockFile: fileStream ifFail: [fail := true].	self shouldnt: fail.	fileStream close.	accessor unlockFile: fileStream ifFail: [fail := true].	self should: fail! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'fail blocks' stamp: 'dtl 11/28/2010 19:11'!testUnlockFileRegionIfFail	"(self selector: #testUnlockFileRegionIfFail) run"	| fail |	fail := false.	accessor		lockFile: fileStream from: 100 to: 199 exclusive: true		ifFail: [fail := true].	self shouldnt: fail.	accessor		unlockFile: fileStream from: 100 to: 199 exclusive: true		ifFail: [fail := true].	self shouldnt: fail.	fileStream close.	accessor		unlockFile: fileStream from: 100 to: 199 exclusive: true		ifFail: [fail := true].	self should: fail.	accessor		unlockFile: fileStream from: 100 to: 199		ifFail: [fail := true].	self should: fail! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 06:53'!testUnlockPreviouslyLockedFile	self subclassResponsibility! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 06:54'!testUnlockPreviouslyLockedFileRegion	self subclassResponsibility! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 12:56'!testWin32LockEmulation01	"Make sure the cache does what is expected, and that it can be disabled	Expect non-exclusive read locks to to succeed."	"(self selector: #testWin32LockEmulation01) run"	| result |	accessor class emulateWin32FileLocking: true.	result := accessor lockFile: fileStream from: 100 to: 199 exclusive: false.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199)).	result := accessor lockFile: fileStream from: 100 to: 199 exclusive: false.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199)).	result := accessor unlockFile: fileStream from: 100 to: 199 exclusive: false.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199))! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 12:56'!testWin32LockEmulation02	"Make sure the cache does what is expected, and that it can be disabled.	Expect exclusive read-write locks to be protected by the cache."	"(self selector: #testWin32LockEmulation02) run"	| result |	accessor class emulateWin32FileLocking: true.	result := accessor lockFile: fileStream from: 100 to: 199 exclusive: true.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199)).	result := accessor lockFile: fileStream from: 100 to: 199 exclusive: true.	self assert: result isNil.	result := accessor unlockFile: fileStream from: 100 to: 199 exclusive: true.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199))! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 12:57'!testWin32LockEmulation03	"Make sure the cache does what is expected, and that it can be disabled.	Expect the cache to protect the file even if we open a second stream"	"(self selector: #testWin32LockEmulation03) run"	| result stream2 |	accessor class emulateWin32FileLocking: true.	result := accessor lockFile: fileStream from: 100 to: 199 exclusive: true.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199)).	stream2 := FileStream fileNamed: 'junkfile'.	[result := accessor lockFile: stream2 from: 100 to: 199 exclusive: true.	self assert: result isNil]		ensure: [stream2 close].	result := accessor unlockFile: fileStream from: 100 to: 199 exclusive: true.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199))! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'testing' stamp: 'dtl 5/7/2006 12:57'!testWin32LockEmulation04	"Make sure the cache does what is expected, and that it can be disabled.	Expect the cache to allow a lock after the stream has been closed (since the OS will have freed its lock)"	"(self selector: #testWin32LockEmulation04) run"	| result stream2 |	accessor class emulateWin32FileLocking: true.	stream2 := FileStream fileNamed: 'junkfile'.	[result := accessor lockFile: stream2 from: 100 to: 199 exclusive: true.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199))]		ensure: [stream2 close].	result := accessor lockFile: fileStream from: 100 to: 199 exclusive: true.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199)).	result := accessor unlockFile: fileStream from: 100 to: 199 exclusive: true.	self assert: (result isKindOf: OSFileRegionLock).	self assert: (result interval = (100 to: 199))! !!AbstractUnixProcessFileLockingTestCase methodsFor: 'private' stamp: 'dtl 4/30/2006 13:47'!tryUntil: aBlock	"Repeat until block evaluates true, but do not get in an infinite loop if a primitive is failing"	| result |	10 timesRepeat:		[result := aBlock value.		result ifTrue: [^ result].		delay wait].	^ result! !!UnixProcessUnixFileLockingTestCase class methodsFor: 'testing' stamp: 'dtl 1/13/2007 15:40'!isAbstract	"Override to true if a TestCase subclass is Abstract and should not have	TestCase instances built from it"	^self name = #TestCase! !!UnixProcessUnixFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/13/2006 09:38'!isValidUnlockResult: result	"With no lock cache, the unlock requests will succeed even though there	is no lock to be removed."		^ result isKindOf: OSFileLock! !!UnixProcessUnixFileLockingTestCase methodsFor: 'running' stamp: 'dtl 4/30/2006 14:05'!setUp	"Set system to use Unix file locking semantics. The tearDown method is expected to restore the setting."	OSProcessAccessor emulateWin32FileLocking: false.	^ super setUp! !!UnixProcessUnixFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 07:12'!testLockPreviouslyLockedFile	"Locking a previously locked file is permitted"	"(self selector: #testLockPreviouslyLockedFile) run"	accessor lockFile: fileStream.	self should: (accessor isLockableFile: fileStream).	self should: ((accessor lockFile: fileStream) isKindOf: OSFileLock).	accessor unlockFile: fileStream! !!UnixProcessUnixFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 07:12'!testLockPreviouslyLockedFileRegion	"Locking a previously locked file region is permitted"	"(self selector: #testLockPreviouslyLockedFileRegion) run"	accessor		lockFile: fileStream		from: 100		to: 199		exclusive: true.	self should: (accessor		isLockableFile: fileStream		from: 100		to: 199		exclusive: true).	self should: ((accessor		lockFile: fileStream		from: 100		to: 199		exclusive: true)		isKindOf: OSFileLock).	accessor unlockFile: fileStream! !!UnixProcessUnixFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 07:07'!testUnlockPreviouslyLockedFile	"The unlock operation will succeed even if no lock is in effect"	"(self selector: #testUnlockPreviouslyLockedFile) run"	self should: ((accessor unlockFile: fileStream) isKindOf: OSFileLock).	accessor lockFile: fileStream.	self should: ((accessor unlockFile: fileStream) isKindOf: OSFileLock)! !!UnixProcessUnixFileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 07:07'!testUnlockPreviouslyLockedFileRegion	"The unlock operation will succeed even if no lock is in effect"	"(self selector: #testUnlockPreviouslyLockedFileRegion) run"	self should: ((accessor		unlockFile: fileStream		from: 100		to: 199		exclusive: true) isKindOf: OSFileLock).	accessor		lockFile: fileStream		from: 100		to: 199		exclusive: true.	self should: ((accessor		unlockFile: fileStream		from: 100		to: 199		exclusive: true) isKindOf: OSFileLock)! !!UnixProcessWin32FileLockingTestCase class methodsFor: 'testing' stamp: 'dtl 1/13/2007 15:40'!isAbstract	"Override to true if a TestCase subclass is Abstract and should not have	TestCase instances built from it"	^self name = #TestCase! !!UnixProcessWin32FileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/13/2006 09:47'!isValidUnlockResult: result	"With a lock cache, the unlock requests will fail when if there	is no lock to be removed."		^ result == nil! !!UnixProcessWin32FileLockingTestCase methodsFor: 'running' stamp: 'dtl 4/30/2006 14:06'!setUp	"Set system to use Windows file locking semantics. The tearDown method is expected to restore the setting."	OSProcessAccessor emulateWin32FileLocking: true.	^ super setUp! !!UnixProcessWin32FileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 07:13'!testLockPreviouslyLockedFile	"A previously locked file cannot be locked."	"(self selector: #testLockPreviouslyLockedFile) run"	accessor lockFile: fileStream.	self shouldnt: (accessor isLockableFile: fileStream).	self should: (accessor lockFile: fileStream) isNil.	accessor unlockFile: fileStream! !!UnixProcessWin32FileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 07:13'!testLockPreviouslyLockedFileRegion	"A previously locked file region cannot be locked."	"(self selector: #testLockPreviouslyLockedFileRegion) run"	accessor		lockFile: fileStream		from: 100		to: 199		exclusive: true.	self shouldnt: (accessor		isLockableFile: fileStream		from: 100		to: 199		exclusive: true).	self should: ((accessor		lockFile: fileStream		from: 100		to: 199		exclusive: true) isNil).	accessor unlockFile: fileStream! !!UnixProcessWin32FileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/11/2006 07:08'!testUnlockPreviouslyLockedFile	"The unlock operation will fail if lock is in effect"	"(self selector: #testUnlockPreviouslyLockedFile) run"	self shouldnt: ((accessor unlockFile: fileStream) isKindOf: OSFileLock).	accessor lockFile: fileStream.	self should: ((accessor unlockFile: fileStream) isKindOf: OSFileLock).	self shouldnt: ((accessor unlockFile: fileStream) isKindOf: OSFileLock)! !!UnixProcessWin32FileLockingTestCase methodsFor: 'testing - platform specific' stamp: 'dtl 5/12/2006 07:48'!testUnlockPreviouslyLockedFileRegion	"The unlock operation will fail if a lock is in effect"	"(self selector: #testUnlockPreviouslyLockedFileRegion) run"	self shouldnt: ((accessor		unlockFile: fileStream		from: 100		to: 199		exclusive: true) isKindOf: OSFileLock).	accessor		lockFile: fileStream		from: 100		to: 199		exclusive: true.	self should: ((accessor		unlockFile: fileStream		from: 100		to: 199		exclusive: true) isKindOf: OSFileLock).	self shouldnt: ((accessor		unlockFile: fileStream		from: 100		to: 199		exclusive: true) isKindOf: OSFileLock)! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 8/7/2005 13:02'!testEnableHandleAndDisable	| eventHandler anOpenFile fileHandle aioHandleResult sema semaIndex aioEnableResult aioDisableResult |	eventHandler := AioEventHandler new.	anOpenFile := SourceFiles at: 1.	fileHandle := eventHandler handleForFile: anOpenFile.	sema := Semaphore new.	[semaIndex := Smalltalk registerExternalObject: sema.	[aioEnableResult := eventHandler			aioEnable: fileHandle			forSemaphore: semaIndex			externalObject: true]		on: Warning		do: ["Suppress warning dialog. Unit test will fail next assert."].	self assert: semaIndex == aioEnableResult.	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: true		readEvents: true		writeEvents: true.	self assert: aioHandleResult == 2r0111. "return bitmask, all three bits set"	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: true		readEvents: false		writeEvents: true.	self assert: aioHandleResult == 2r0101.	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: false		writeEvents: true.	self assert: aioHandleResult == 2r0100.	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: true		readEvents: false		writeEvents: false.	self assert: aioHandleResult == 2r0001.	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: false		writeEvents: false.	self assert: aioHandleResult == 2r0000.	aioDisableResult := eventHandler aioDisable: fileHandle.	self assert: aioDisableResult == fileHandle]		ensure:			[Smalltalk unregisterExternalObject: sema.			(fileHandle isKindOf: Integer) ifTrue: [eventHandler aioDisable: fileHandle]]! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 1/23/2013 19:40'!testFileReadableEvent	| eventHandler anOpenFile fileHandle aioHandleResult sema semaIndex aioEnableResult fileName |	fileName := 'DeleteThisTemporaryFile'.	eventHandler := AioEventHandler new.	OSProcess deleteFileNamed: fileName.	[anOpenFile := FileStream fileNamed: fileName.	fileHandle := eventHandler handleForFile: anOpenFile.	sema := Semaphore new.	semaIndex := Smalltalk registerExternalObject: sema.	[aioEnableResult := eventHandler			aioEnable: fileHandle			forSemaphore: semaIndex			externalObject: true]		on: Warning		do: ["Suppress warning dialog. Unit test will fail next assert."].	self assert: semaIndex == aioEnableResult.	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	self assert: aioHandleResult == 2r010.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self assert: sema isSignaled. "File is empty but readable. A signal is sent once,	presumably in the interest of priming the pump. A listening process would	begin reading data based on having received this initial signal."	sema wait. "consume the signal"	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self deny: sema isSignaled. "Nothing has happened to indicate more data available."	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	self assert: aioHandleResult == 2r010.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self assert: sema isSignaled. "File is empty but readable. A signal is sent once,	presumably in the interest of priming the pump. A listening process would	begin reading data based on having received this initial signal."	sema wait. "consume the signal"	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self deny: sema isSignaled. "Nothing has happened to indicate more data available."	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	self assert: aioHandleResult == 2r010.	anOpenFile nextPutAll: 'write some stuff to the file'; flush.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self assert: sema isSignaled. "File is empty but readable. A signal is sent once,	presumably in the interest of priming the pump. A listening process would	begin reading data based on having received this initial signal."	sema wait. "consume the signal"	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	self assert: aioHandleResult == 2r010.	anOpenFile upToEnd.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self assert: sema isSignaled. "File is empty but readable. A signal is sent once,	presumably in the interest of priming the pump. A listening process would	begin reading data based on having received this initial signal."	sema wait. "consume the signal"	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self deny: sema isSignaled. "handler has not been reset"]		ensure:			[[anOpenFile close] on: Error do: [].			Smalltalk unregisterExternalObject: sema.			(fileHandle isKindOf: Integer) ifTrue: [eventHandler aioDisable: fileHandle]]! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 1/23/2013 19:41'!testFileWritableEvent	| eventHandler anOpenFile fileHandle aioHandleResult sema semaIndex aioEnableResult fileName |	fileName := 'DeleteThisTemporaryFile'.	eventHandler := AioEventHandler new.	OSProcess deleteFileNamed: fileName.	[anOpenFile := FileStream fileNamed: fileName.	fileHandle := eventHandler handleForFile: anOpenFile.	sema := Semaphore new.	semaIndex := Smalltalk registerExternalObject: sema.	[aioEnableResult := eventHandler			aioEnable: fileHandle			forSemaphore: semaIndex			externalObject: true]		on: Warning		do: ["Suppress warning dialog. Unit test will fail next assert."].	self assert: semaIndex == aioEnableResult.	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: false		writeEvents: true.	self assert: aioHandleResult == 2r0100.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self assert: sema isSignaled. "File is empty but writable. A signal is sent once,	presumably in the interest of priming the pump. A listening process would	begin writing data based on having received this initial signal."	sema wait. "consume the signal"	self deny: sema isSignaled.	"Reset handler"	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: false		writeEvents: true.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self assert: sema isSignaled. "File is empty but writable. A signal is sent once,	presumably in the interest of priming the pump. A listening process would	begin writing data based on having received this initial signal."	sema wait. "consume the signal"	self deny: sema isSignaled.	"Reset handler"	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: false		writeEvents: true.	anOpenFile upToEnd.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self assert: sema isSignaled. "File is empty but writable. A signal is sent once,	presumably in the interest of priming the pump. A listening process would	begin writing data based on having received this initial signal."	sema wait. "consume the signal"	self deny: sema isSignaled.	"Reset handler"	aioHandleResult := eventHandler		aioHandle: fileHandle		exceptionEvents: false		readEvents: false		writeEvents: true.	anOpenFile nextPutAll: 'write some stuff to the file'; flush.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self assert: sema isSignaled. "File is empty but writable. A signal is sent once,	presumably in the interest of priming the pump. A listening process would	begin writing data based on having received this initial signal."	sema wait. "consume the signal"	self deny: sema isSignaled.	(Delay forMilliseconds: 20) wait. "Allow signals to be handled"	self deny: sema isSignaled. "handler has not been reset"]		ensure:			[[anOpenFile close] on: Error do: [].			Smalltalk unregisterExternalObject: sema.			(fileHandle isKindOf: Integer) ifTrue: [eventHandler aioDisable: fileHandle]]! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 7/9/2005 17:10'!testHandleForFile	| eventHandler anOpenFile fileHandle |	eventHandler := AioEventHandler new.	anOpenFile := SourceFiles at: 1.	fileHandle := eventHandler handleForFile: anOpenFile.	self assert: fileHandle notNil.	self assert: (fileHandle isKindOf: Integer)! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 7/9/2005 17:10'!testHandleForSocket	| eventHandler socket socketHandle |	eventHandler := AioEventHandler new.	socket := Socket newTCP.	socketHandle := eventHandler handleForSocket: socket.	self assert: socketHandle notNil.	self assert: (socketHandle isKindOf: Integer).	self assert: (socketHandle ~= 0) "0 is stdin on unix, unlikely to be used on other platforms"! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 7/9/2005 16:41'!testPrimAioModuleName	| eventHandler moduleName |	eventHandler := AioEventHandler new.	moduleName := eventHandler primAioModuleName.	self assert: ('AioPlugin*' match: moduleName)! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 7/9/2005 16:42'!testPrimAioModuleVersionString	| eventHandler versionString |	eventHandler := AioEventHandler new.	versionString := eventHandler primAioModuleName.	self assert: (versionString isKindOf: String)! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 8/7/2005 12:58'!testSocketExceptionEvent	"Close the client socket to generate an event on the server socket"	| port serverName serverTcpSocket clientTcpSocket sema semaIndex socketHandle eventHandler receivedData |	port := 8086.	serverName := '127.0.0.1'.	Socket initializeNetwork.	"Create the server (reader) socket"	serverTcpSocket := Socket newTCP.	serverTcpSocket listenOn: port.	"Create the client (writer) socket"	clientTcpSocket := Socket newTCP.	clientTcpSocket connectTo: (NetNameResolver addressFromString: serverName) port: port.	"Esstablish socket connection"	[serverTcpSocket waitForConnectionFor: 10] fork.	clientTcpSocket waitForConnectionFor: 10.	["Set up a read event handler on the server socket"	sema := Semaphore new.	semaIndex := Smalltalk registerExternalObject: sema.	eventHandler := AioEventHandler new.	socketHandle := eventHandler handleForSocket: serverTcpSocket.	"An aio handler may already have been established for the socket	by the SocketPlugin. The following request disables any existing handling	in order to prevent a warning message on the console stderr."	eventHandler aioDisable: socketHandle.	"Now set our own handler."	[eventHandler			aioEnable: socketHandle			forSemaphore: semaIndex			externalObject: true]		on: Warning		do: ["Suppress warning dialog. Unit test will fail next assert."].	eventHandler		aioHandle: socketHandle		exceptionEvents: true		readEvents: false		writeEvents: false.	self deny: sema isSignaled.	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	self deny: sema isSignaled.	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	self deny: sema isSignaled.	receivedData := serverTcpSocket receiveAvailableData.	clientTcpSocket close.	(Delay forMilliseconds: 200) wait.	receivedData := serverTcpSocket receiveAvailableData.	(Delay forMilliseconds: 200) wait."	self assert: sema isSignaled.	FIXME: no error generated; need to find a way to generate an error -dtl"	self deny: sema isSignaled.	serverTcpSocket close]		ensure:			[Smalltalk unregisterExternalObject: sema.			(socketHandle isKindOf: Integer) ifTrue: [eventHandler aioDisable: socketHandle]]! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 8/7/2005 13:01'!testSocketExceptionEvent2	"Close the client socket to generate an event on the server socket"	| port serverTcpSocket sema semaIndex socketHandle eventHandler |	port := 8086.	Socket initializeNetwork.	"Create the server (reader) socket"	serverTcpSocket := Socket newTCP.	serverTcpSocket listenOn: port.	["Set up an exception event handler on the server socket"	sema := Semaphore new.	semaIndex := Smalltalk registerExternalObject: sema.	eventHandler := AioEventHandler new.	socketHandle := eventHandler handleForSocket: serverTcpSocket.	"An aio handler may already have been established for the socket	by the SocketPlugin. The following request disables any existing handling	in order to prevent a warning message on the console stderr."	eventHandler aioDisable: socketHandle.	"Now set our own handler."	[eventHandler			aioEnable: socketHandle			forSemaphore: semaIndex			externalObject: true]		on: Warning		do: ["Suppress warning dialog. Unit test will fail next assert."].	eventHandler		aioHandle: socketHandle		exceptionEvents: true		readEvents: false		writeEvents: true.	self deny: sema isSignaled.	[serverTcpSocket		primSocket: serverTcpSocket socketHandle		sendData: 'a string to send'		startIndex: 1		count: 10] on: Error do: [self halt].	serverTcpSocket		receiveSomeDataInto: (String new: 1000)		startingAt: 1."	self assert: sema isSignaled.	FIXME: no error generated; need to find a way to generate an error -dtl"	self deny: sema isSignaled.	serverTcpSocket close]		ensure:			[Smalltalk unregisterExternalObject: sema.			(socketHandle isKindOf: Integer) ifTrue: [eventHandler aioDisable: socketHandle]]! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 8/7/2005 13:02'!testSocketReadableEvent	| port serverName serverTcpSocket clientTcpSocket sema semaIndex socketHandle eventHandler receivedData |	port := 8086.	serverName := '127.0.0.1'.	Socket initializeNetwork.	"Create the server (reader) socket"	serverTcpSocket := Socket newTCP.	serverTcpSocket listenOn: port.	"Create the client (writer) socket"	clientTcpSocket := Socket newTCP.	clientTcpSocket connectTo: (NetNameResolver addressFromString: serverName) port: port.	"Establish socket connection"	[serverTcpSocket waitForConnectionFor: 10] fork.	clientTcpSocket waitForConnectionFor: 10.	["Set up a read event handler on the server socket"	sema := Semaphore new.	semaIndex := Smalltalk registerExternalObject: sema.	eventHandler := AioEventHandler new.	socketHandle := eventHandler handleForSocket: serverTcpSocket.	"An aio handler may already have been established for the socket	by the SocketPlugin. The following request disables any existing handling	in order to prevent a warning message on the console stderr."	eventHandler aioDisable: socketHandle.	"Now set our own handler."	[eventHandler			aioEnable: socketHandle			forSemaphore: semaIndex			externalObject: true]		on: Warning		do: ["Suppress warning dialog. Unit test will fail next assert."].	eventHandler		aioHandle: socketHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	self deny: sema isSignaled.	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	self assert: sema isSignaled.	sema wait. "consume the signal"	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	eventHandler		aioHandle: socketHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	self deny: sema isSignaled.	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	self assert: sema isSignaled.	sema wait. "consume the signal"	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	eventHandler		aioHandle: socketHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	self deny: sema isSignaled.	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	self assert: sema isSignaled.	sema wait. "consume the signal"	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	clientTcpSocket close.	serverTcpSocket close]		ensure:			[Smalltalk unregisterExternalObject: sema.			(socketHandle isKindOf: Integer) ifTrue: [eventHandler aioDisable: socketHandle]]! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 8/7/2005 12:59'!testSocketReadableEventWithMaskNotSet	"Same as testSocketReadableEvent, except that the mask bit for read events is not set,	so we expect to not receive the event notification. This is just a check to ensure that	the event mask is working."	| port serverName serverTcpSocket clientTcpSocket sema semaIndex socketHandle eventHandler receivedData |	port := 8086.	serverName := '127.0.0.1'.	Socket initializeNetwork.	"Create the server (reader) socket"	serverTcpSocket := Socket newTCP.	serverTcpSocket listenOn: port.	"Create the client (writer) socket"	clientTcpSocket := Socket newTCP.	clientTcpSocket connectTo: (NetNameResolver addressFromString: serverName) port: port.	"Establish socket connection"	[serverTcpSocket waitForConnectionFor: 10] fork.	clientTcpSocket waitForConnectionFor: 10.	["Set up a read event handler on the server socket"	sema := Semaphore new.	semaIndex := Smalltalk registerExternalObject: sema.	eventHandler := AioEventHandler new.	socketHandle := eventHandler handleForSocket: serverTcpSocket.	"An aio handler may already have been established for the socket	by the SocketPlugin. The following request disables any existing handling	in order to prevent a warning message on the console stderr."	eventHandler aioDisable: socketHandle.	"Now set our own handler."	[eventHandler			aioEnable: socketHandle			forSemaphore: semaIndex			externalObject: true]		on: Warning		do: ["Suppress warning dialog. Unit test will fail next assert."].	eventHandler		aioHandle: socketHandle		exceptionEvents: true		readEvents: false	"Read event bit not set"		writeEvents: false.	self deny: sema isSignaled.	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	self deny: sema isSignaled. "This time we should not receive a signal"	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	clientTcpSocket close.	serverTcpSocket close]		ensure:			[Smalltalk unregisterExternalObject: sema.			(socketHandle isKindOf: Integer) ifTrue: [eventHandler aioDisable: socketHandle]]! !!AioEventHandlerTestCase methodsFor: 'testing' stamp: 'dtl 8/7/2005 12:59'!testSuspendAioForSocketReadableEvent	| port serverName serverTcpSocket clientTcpSocket sema semaIndex socketHandle eventHandler receivedData |	port := 8086.	serverName := '127.0.0.1'.	Socket initializeNetwork.	"Create the server (reader) socket"	serverTcpSocket := Socket newTCP.	serverTcpSocket listenOn: port.	"Create the client (writer) socket"	clientTcpSocket := Socket newTCP.	clientTcpSocket connectTo: (NetNameResolver addressFromString: serverName) port: port.	"Establish socket connection"	[serverTcpSocket waitForConnectionFor: 10] fork.	clientTcpSocket waitForConnectionFor: 10.	["Set up a read event handler on the server socket"	sema := Semaphore new.	semaIndex := Smalltalk registerExternalObject: sema.	eventHandler := AioEventHandler new.	socketHandle := eventHandler handleForSocket: serverTcpSocket.	"An aio handler may already have been established for the socket	by the SocketPlugin. The following request disables any existing handling	in order to prevent a warning message on the console stderr."	eventHandler aioDisable: socketHandle.	"Now set our own handler."	[eventHandler			aioEnable: socketHandle			forSemaphore: semaIndex			externalObject: true]		on: Warning		do: ["Suppress warning dialog. Unit test will fail next assert."].	eventHandler		aioHandle: socketHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	self deny: sema isSignaled.	"Handler generates a signal"	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	self assert: sema isSignaled.	sema wait.	self deny: sema isSignaled.	"Handler has not been reset, so no signal this time"	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	self deny: sema isSignaled.	"Reset the handler"	eventHandler		aioHandle: socketHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	"Handler generates a signal"	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	self assert: sema isSignaled.	sema wait.	self deny: sema isSignaled.	"Reset the handler"	eventHandler		aioHandle: socketHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	"But temporarily disable it"	eventHandler aioSuspend: socketHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	"Handler suspended, so no signal this time"	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	self deny: sema isSignaled.	"Reset the handler"	eventHandler		aioHandle: socketHandle		exceptionEvents: false		readEvents: true		writeEvents: false.	"Handler generates a signal"	clientTcpSocket sendData: 'some data to send to the socket'.	(Delay forMilliseconds: 200) wait.	receivedData := serverTcpSocket receiveAvailableData.	self assert: 'some data to send to the socket' = receivedData.	self assert: sema isSignaled.	sema wait.	self deny: sema isSignaled.	clientTcpSocket close.	serverTcpSocket close]		ensure:			[Smalltalk unregisterExternalObject: sema.			(socketHandle isKindOf: Integer) ifTrue: [eventHandler aioDisable: socketHandle]]! !!OSPipeTestCase methodsFor: 'private' stamp: 'dtl 11/28/2010 14:05'!primTestEndOfFileFlag: aSqFileStruct	"Answer whether the file represented by aSqFileStruct is at end of file, as determined	by a call to feof(). This is different from StandardFileStream>>primAtEnd: which answers	true if the file pointer is at the end of the file, but which does not call feof() to	determine that an end of file condition has occurred. The difference is significant	if aSqFileStruct represents a pipe or a device file, which may not be positionable	in the sense of a conventional disk file."	<primitive: 'primitiveTestEndOfFileFlag' module: 'UnixOSProcessPlugin'>	^ nil! !!OSPipeTestCase methodsFor: 'private' stamp: 'dtl 6/4/2006 16:03'!readFromAndClose: aPipe writingTo: aStream	| s |	[aPipe atEndOfFile] whileFalse:		[s := aPipe next: 10000.		aStream nextPutAll: s asString.		(Delay forMilliseconds: 100) wait].	(aPipe respondsTo: #reader) ifTrue: [aPipe reader close].	^ aStream! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 4/12/2014 16:07'!testBlocking	"(OSPipeTestCase selector: #testBlocking) run"	| p |	p := OSPipe blockingPipe.	(1 to: 10) do: [:i | p nextPutAll: 'this is line ', i printString; cr].	p flush. "protect against buggy clib that may never flush output"	self should: ['this is line 1*' match: (p next: 15)].	self should: ['this is line 2*' match: (p next: 15)].	self should: ['this is line 3*' match: (p next: 15)].	self should: ['this is line 4*' match: (p next: 15)].	self should: ['this is line 5*' match: (p next: 15)].	self should: ['this is line 6*' match: (p next: 15)].	self should: ['this is line 7*' match: (p next: 15)].	self should: ['this is line 8*' match: (p next: 15)].	self should: ['this is line 9*' match: (p next: 15)].	p writer close.	self shouldnt: p atEnd.	self should: ['this is line 10*' match: (p next: 16)].	self should: p atEnd.	p close! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 6/6/2015 09:27'!testBlockingBufferedPipe	"(OSPipeTestCase selector: #testBlockingBufferedPipe) run"	| p |	p := ExternalPipe bufferedBlockingPipe.	[(1 to: 10) do: [:i | p nextPutAll: 'this is line ', i printString; cr; flush].	(Delay forMilliseconds: 100) wait. "allow pipe reads to complete"	self should: ['this is line 1*' match: (p next: 15)].	self should: ['this is line 2*' match: (p next: 15)].	self should: ['this is line 3*' match: (p next: 15)].	self should: ['this is line 4*' match: (p next: 15)].	self should: ['this is line 5*' match: (p next: 15)].	self should: ['this is line 6*' match: (p next: 15)].	self should: ['this is line 7*' match: (p next: 15)].	self should: ['this is line 8*' match: (p next: 15)].	self should: ['this is line 9*' match: (p next: 15)].	p writer close.	self shouldnt: p atEnd.	self should: ['this is line 10*' match: (p next: 16)].	self should: p atEnd]		ensure: [p close]! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 4/12/2014 16:09'!testBlockingPeek	"(OSPipeTestCase selector: #testBlockingPeek) run"	| p |	p := OSPipe blockingPipe.	p nextPutAll: 'abc'.	p flush. "protect against buggy clib that may never flush output"	self assert: (p peek == $a).	self assert: (p next == $a).	self assert: (p peek == $b).	self assert: (p next == $b).	self assert: (p peek == $c).	self deny: p atEnd.	self assert: (p next == $c).	self deny: p atEnd.	p closeWriter.	self assert: p atEnd.	p close! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 6/6/2015 09:28'!testBlockingPeekBufferedPipe	"(OSPipeTestCase selector: #testBlockingPeekBufferedPipe) run"	| p |	p := ExternalPipe bufferedBlockingPipe.	[p nextPutAll: 'abc'; flush.	(Delay forMilliseconds: 100) wait. "allow pipe reads to complete"	self assert: (p peek == $a).	self assert: (p next == $a).	self assert: (p peek == $b).	self assert: (p next == $b).	self assert: (p peek == $c).	self deny: p atEnd.	self assert: (p next == $c).	self deny: p atEnd.	p closeWriter.	self assert: p atEnd]		ensure: [p close]! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 5/17/2006 23:36'!testBufferedUpToEnd	"(OSPipeTestCase selector: #testBufferedUpToEnd) debug"	| s p r1 r2 |	s := 'some data to put through the pipe'.	p := OSPipe new.	self primTestEndOfFileFlag: p reader fileID. "check that OSPP is updated"	self assert: p setBufferedReader.	[p nextPutAll: s.	p closeWriter.	r1 := p upToEnd. "#atEnd does not detect EOF on a pipe"	self assert: r1 isEmpty.	r2 := p upToEndOfFile. "detects EOF correctly, gets remaining data"	self assert: r2 = s]		ensure: [p close]! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 6/6/2015 09:21'!testIsAtEndOfFile	"(OSPipeTestCase selector: #testIsAtEndOfFile) debug"	| p |	p := OSPipe new.	self primTestEndOfFileFlag: p reader fileID. "check that OSPP is updated"	self deny: (OSProcess accessor isAtEndOfFile: p reader fileID).	self deny: p reader atEnd.	self deny: p atEnd.	self assert: (p reader basicNext == nil).	self deny: (OSProcess accessor isAtEndOfFile: p reader fileID).	self deny: p reader atEnd.	self deny: p atEnd.	p writer nextPut: $X; flush.	self assert: (p reader basicNext == $X).	self deny: (OSProcess accessor isAtEndOfFile: p reader fileID).	self deny: p reader atEnd.	self deny: p atEnd.	self assert: (p reader basicNext == nil).	self deny: (OSProcess accessor isAtEndOfFile: p reader fileID).	self deny: p reader atEnd.	self deny: p atEnd.	p writer close.	self deny: (OSProcess accessor isAtEndOfFile: p reader fileID).	self deny: p atEndOfFile. "no read yet, so flag has not been set"	self deny: p reader atEnd.	self assert: p atEnd. "writer closed and read gives nil"	self assert: (p reader basicNext == nil). "read operation should set flag"	self assert: (OSProcess accessor isAtEndOfFile: p reader fileID).	self deny: p reader atEnd. "#atEnd does not detect EOF on a pipe"	self assert: p reader atEndOfFile.	self assert: p atEnd.	p close! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 6/6/2015 09:23'!testIsAtEndOfFile2	"(OSPipeTestCase selector: #testIsAtEndOfFile2) debug"	| p s |	p := OSPipe new.	[p nextPutAll: 'hello'; flush.	s := p next: 100.	self assert: s = 'hello'.	self deny: p atEndOfFile.	p closeWriter.	self deny: p atEndOfFile.	s := p next: 100.	self assert: s = ''.	self assert: p atEndOfFile]		ensure: [p close]! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 3/25/2006 13:44'!testNonBlocking	"(OSPipeTestCase selector: #testNonBlocking) run"	| p ws str |	p := OSPipe nonBlockingPipe.	self writeStuffOnThenClose: p.	ws := self readFromAndClose: p writingTo: (WriteStream on: String new).	str := (ws contents last: 16).	self should: ['this is line 10*' match: str].	p close! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 4/2/2006 21:40'!testNonBlockingBufferedPipe	"(OSPipeTestCase selector: #testNonBlockingBufferedPipe) run"	| p ws str |	p := ExternalPipe bufferedNonBlockingPipe.	[self writeStuffOnThenClose: p.	self assert: (p peek == nil).	(Delay forMilliseconds: 100) wait. "allow pipe reads to complete"	ws := self readFromAndClose: p writingTo: (WriteStream on: String new).	str := (ws contents last: 16).	self should: ['this is line 10*' match: str]]		ensure: [p close]! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 6/6/2015 09:28'!testNonBlockingPeek	"(OSPipeTestCase selector: #testNonBlockingPeek) run"	| p |	p := OSPipe nonBlockingPipe.	p nextPutAll: 'abc'; flush.	self assert: (p peek == $a).	self assert: (p next == $a).	self assert: (p peek == $b).	self assert: (p next == $b).	self assert: (p peek == $c).	self deny: p atEnd.	self assert: (p next == $c).	self deny: p atEnd.	p closeWriter.	self assert: p atEnd.	p close! !!OSPipeTestCase methodsFor: 'testing' stamp: 'dtl 6/6/2015 09:28'!testNonBlockingPeekBufferedPipe	"(OSPipeTestCase selector: #testNonBlockingPeekBufferedPipe) run"	| p |	p := ExternalPipe bufferedNonBlockingPipe.	[p nextPutAll: 'abc'; flush.	self assert: (p peek == nil).	(Delay forMilliseconds: 100) wait. "allow pipe reads to complete"	self assert: (p peek == $a).	self assert: (p next == $a).	self assert: (p peek == $b).	self assert: (p next == $b).	self assert: (p peek == $c).	self deny: p atEnd.	self assert: (p next == $c).	self deny: p atEnd.	p closeWriter.	self assert: p atEnd]		ensure: [p close]! !!OSPipeTestCase methodsFor: 'private' stamp: 'dtl 3/25/2006 18:29'!writeStuffOnThenClose: aPipe	^ [(1 to: 10) do:		[:i |		[aPipe nextPutAll: 'this is line ', i printString; cr]			on: Error			do: ["Ignore error. Test case will still fail, and throwing an error in this				process would cause a debugger to be scheduled inconveniently."].		(Delay forMilliseconds: 50) wait].	(aPipe respondsTo: #writer)		ifTrue: [[aPipe writer close]					on: Error					do: ["Ignore error to avoid a debugger"]]		ifFalse: [[aPipe close]					on: Error					do: ["Ignore error to avoid a debugger"]]]		forkAt: Processor userBackgroundPriority! !!UnixProcessAccessorTestCase methodsFor: 'testing - C string arrays' stamp: 'dtl 7/11/2005 19:00'!primFixPointersInArrayOfStrings: cStringArray withOffsets: offsetArray count: count	"This primitive call exists only for purposes of testing the	fixPointersInArrayOfStrings:withOffsets:count: method. I believe it to be	reasonably machine and compiler independent, but have no way of verifying	this on a variety of machines, so I'll leave this test method here in case	someone runs into problems on other hardware or compilers. -dtl"	"| a |	a := OSProcess thisOSProcess envAsFlatArrayAndOffsets: UnixProcess env.	UnixProcessAccessorTestCase new		primFixPointersInArrayOfStrings: (a at: 1)		withOffsets: (a at: 2)		count: (a at: 2) size"	<primitive: 'primitiveFixPointersInArrayOfStrings' module: 'UnixOSProcessPlugin'>	^ nil! !!UnixProcessAccessorTestCase methodsFor: 'running' stamp: 'dtl 3/1/2002 18:02'!runAll	"UnixProcessAccessorTestCase new runAll"	| result suite |	suite := TestSuite new.	suite addTest: (UnixProcessAccessorTestCase selector: #testSessionIdentifier).	suite addTest: (UnixProcessAccessorTestCase selector: #testCanAccessSystem).	suite addTest: (UnixProcessAccessorTestCase selector: #testMakePipeHandles).	suite addTest: (UnixProcessAccessorTestCase selector: #testUnixFileNumber).	suite addTest: (UnixProcessAccessorTestCase selector: #testFileProtectionMask).	suite addTest: (UnixProcessAccessorTestCase selector: #testFileStat).	suite addTest: (UnixProcessAccessorTestCase selector: #testIsExecutable).	suite addTest: (UnixProcessAccessorTestCase selector: #testIsExecutableForUserInGroup).	suite addTest: (UnixProcessAccessorTestCase selector: #testIsReadable).	suite addTest: (UnixProcessAccessorTestCase selector: #testIsReadableForUserInGroup).	suite addTest: (UnixProcessAccessorTestCase selector: #testIsWritable).	suite addTest: (UnixProcessAccessorTestCase selector: #testIsWritableForUserInGroup).	suite addTest: (UnixProcessAccessorTestCase selector: #runExternalProcessAccess).	suite addTest: (UnixProcessAccessorTestCase selector: #runForkAndExec).	result := suite run.	self should: [result defects size == 0].	^ result! !!UnixProcessAccessorTestCase methodsFor: 'running' stamp: 'dtl 8/3/2003 18:02'!runExternalProcessAccess	"UnixProcessAccessorTestCase new runExternalProcessAccess"	| result suite |	suite := TestSuite new.	suite addTest: (UnixProcessAccessorTestCase selector: #testCanAccessSystem).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetCurrentWorkingDirectory).	suite addTest: (UnixProcessAccessorTestCase selector: #testChDir).	suite addTest: (UnixProcessAccessorTestCase selector: #testEnvironmentAt).	suite addTest: (UnixProcessAccessorTestCase selector: #testEnvironmentAtPut1).	suite addTest: (UnixProcessAccessorTestCase selector: #testEnvironmentAtPut2).	suite addTest: (UnixProcessAccessorTestCase selector: #testEnvironmentAtPut).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimUnsetEnv).	suite addTest: (UnixProcessAccessorTestCase selector: #testGetStdInHandle).	suite addTest: (UnixProcessAccessorTestCase selector: #testGetStdOutHandle).	suite addTest: (UnixProcessAccessorTestCase selector: #testGetStdErrHandle).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimArgumentAt).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimErrorMessageAt).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetPid).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetGid).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetEGid).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetPid).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetPPid).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetUid).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetSession).	suite addTest: (UnixProcessAccessorTestCase selector: #testRealpath).	result := suite run.	self should: [result defects size == 0].	^ result! !!UnixProcessAccessorTestCase methodsFor: 'running' stamp: 'dtl 10/6/2001 11:37'!runForkAndExec	"Most of this must be tested from class UnixProcess"	"UnixProcessAccessorTestCase new runForkAndExec"	| result suite |	suite := TestSuite new.	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimGetChildExitStatus).	suite addTest: (UnixProcessAccessorTestCase selector: #testPrimForkAndExec).	result := suite run.	self should: [result defects size == 0].	^ result! !!UnixProcessAccessorTestCase methodsFor: 'running' stamp: 'dtl 10/6/2001 08:29'!setUp	accessor := ThisOSProcess accessor! !!UnixProcessAccessorTestCase methodsFor: 'testing - C string arrays' stamp: 'dtl 9/10/2011 14:17'!testArgsAsFlatArrayAndOffsets	"Test conversion of an array of strings into the form used to create a C **char	in UnixOSProcessPlugin."	"(UnixProcessAccessorTestCase selector: #testArgsAsFlatArrayAndOffsets) debug"	| a pointerSize lengthOfCStrings totalLength stringsAndOffsets rs s arrayWithMachineDependentPointers |	pointerSize := OSProcess accessor sizeOfPointer.	a := { 'one ' . 'two ' . 'three ' }.	a do: [:e | e at: e size put: (Character value: 0)].	stringsAndOffsets := OSProcess thisOSProcess argsAsFlatArrayAndOffsets: a.	self assert: stringsAndOffsets size == 2.	self assert: stringsAndOffsets second size == 3.	lengthOfCStrings := (a collect: [:e | e size]) sum.	totalLength := 4 * pointerSize + lengthOfCStrings.	self assert: stringsAndOffsets first size == totalLength.	stringsAndOffsets second do: [:offset |		(stringsAndOffsets first at: offset) == (Character value: 0)].	rs := ReadStream on: stringsAndOffsets first.	rs next: 4 * pointerSize.	s :=  rs next: 3.	rs next.	self assert: s = 'one'.	s :=  rs next: 3.	rs next.	self assert: s = 'two'.	s :=  rs next: 5.	rs next.	self assert: s = 'three'.	rs := ReadStream on: stringsAndOffsets first.	rs next: (stringsAndOffsets second at: 1).	s :=  rs next: 3.	self assert: s = 'one'.	rs := ReadStream on: stringsAndOffsets first.	rs next: (stringsAndOffsets second at: 2).	s :=  rs next: 3.	self assert: s = 'two'.	rs := ReadStream on: stringsAndOffsets first.	rs next: (stringsAndOffsets second at: 3).	s :=  rs next: 5.	self assert: s = 'three'.	arrayWithMachineDependentPointers := self		primFixPointersInArrayOfStrings: stringsAndOffsets first		withOffsets: stringsAndOffsets second		count: stringsAndOffsets second size.	self assert: arrayWithMachineDependentPointers size == stringsAndOffsets first size.	rs := ReadStream on: arrayWithMachineDependentPointers.	s := rs next: pointerSize.	self assert: s ~= (String new: pointerSize). "a C pointer"	s := rs next: pointerSize.	self assert: s ~= (String new: pointerSize). "a C pointer"	s := rs next: pointerSize.	self assert: s ~= (String new: pointerSize). "a C pointer"	s := rs next: pointerSize.	self assert: s = (String new: pointerSize). "a NULL pointer"	self assert: rs upToEnd = (stringsAndOffsets first allButFirst: pointerSize * 4)! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 10/6/2001 08:36'!testCanAccessSystem	"(UnixProcessAccessorTestCase selector: #testCanAccessSystem) run"	self assert: accessor canAccessSystem! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 6/10/2011 15:04'!testChDir	"(UnixProcessAccessorTestCase selector: #testChDir) run"	| cwd new |	cwd := accessor primGetCurrentWorkingDirectory.	new := '/bin'. "nb Do not use /tmp because OS X implements it as a sym link to private/tmp"	accessor chDir: new.	self should: [new = accessor primGetCurrentWorkingDirectory].	accessor chDir: cwd.	self should: [cwd = accessor primGetCurrentWorkingDirectory].! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 6/6/2015 09:38'!testDupTo	"Perform a dup2() call to assign IO to a new file stream"	"(UnixProcessAccessorTestCase selector: #testDupTo) run"	| f1 f2 fd1 fd2 result contents1 contents2 |	OSProcess deleteFileNamed: '/tmp/delete-1.me'.		OSProcess deleteFileNamed: '/tmp/delete-2.me'.		f1 := FileStream newFileNamed: '/tmp/delete-1.me'.	f2 := FileStream newFileNamed: '/tmp/delete-2.me'.	fd1 := OSProcess accessor primUnixFileNumber: f1 fileID.	fd2 := OSProcess accessor primUnixFileNumber: f2 fileID.	result := OSProcess accessor primDup: fd1 to: fd2.	"f1 and f2 now both refer to the same IO stream"	self assert: result = fd2.	f2 nextPutAll: 'write something to the original f2 file stream that will appear in duped f1 instead'; flush.	f1 reset.	contents1 := f1 upToEnd.	self deny: contents1 isEmpty.	self assert: ('write something*' match: contents1).	f2 reset.	contents2 := f2 upToEnd.	self deny: contents2 isEmpty.	self assert: ('write something*' match: contents2).	f1 close.	f2 close.	"check the contents of the actual files"	contents1 := (FileStream fileNamed: '/tmp/delete-1.me') contentsOfEntireFile.	self assert: ('write something*' match: contents1).	contents2 := (FileStream fileNamed: '/tmp/delete-2.me') contentsOfEntireFile.	self assert: contents2 isEmpty.	OSProcess deleteFileNamed: '/tmp/delete-1.me'.		OSProcess deleteFileNamed: '/tmp/delete-2.me'.	! !!UnixProcessAccessorTestCase methodsFor: 'testing - C string arrays' stamp: 'dtl 9/10/2011 14:16'!testEnvAsFlatArrayAndOffsets	"Test conversion of a dictionary of key-value environment variables into the	form used to create a C **char in UnixOSProcessPlugin."	"(UnixProcessAccessorTestCase selector: #testEnvAsFlatArrayAndOffsets) debug"	| pointerSize lengthOfCStrings totalLength stringsAndOffsets rs s arrayWithMachineDependentPointers d |	pointerSize := OSProcess accessor sizeOfPointer.	d := Dictionary new.	d at: #ONE put: 'one'.	d at: #TWO put: 'two'.	d at: #THREE put: 'three'.	stringsAndOffsets := OSProcess thisOSProcess envAsFlatArrayAndOffsets: d.	self assert: stringsAndOffsets size == 2.	self assert: stringsAndOffsets second size == 3.	lengthOfCStrings := d keys		inject: 0		into: [:sum :e | sum + e size + '=' size + (d at: e) size + (String new: 1) size].	totalLength := 4 * pointerSize + lengthOfCStrings.	self assert: stringsAndOffsets first size == totalLength.	stringsAndOffsets second do: [:offset |		(stringsAndOffsets first at: offset) == (Character value: 0)].	arrayWithMachineDependentPointers := self		primFixPointersInArrayOfStrings: stringsAndOffsets first		withOffsets: stringsAndOffsets second		count: stringsAndOffsets second size.	self assert: arrayWithMachineDependentPointers size == stringsAndOffsets first size.	rs := ReadStream on: arrayWithMachineDependentPointers.	s := rs next: pointerSize.	self assert: s ~= (String new: pointerSize). "a C pointer"	s := rs next: pointerSize.	self assert: s ~= (String new: pointerSize). "a C pointer"	s := rs next: pointerSize.	self assert: s ~= (String new: pointerSize). "a C pointer"	s := rs next: pointerSize.	self assert: s = (String new: pointerSize). "a NULL pointer"	self assert: rs upToEnd = (stringsAndOffsets first allButFirst: pointerSize * 4)! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 08:53'!testEnvironmentAt	"(UnixProcessAccessorTestCase selector: #testEnvironmentAt) run"	| path |	path := accessor environmentAt: 'PATH'.	self should: [path notNil and: [path isEmpty not]]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 2/24/2013 10:26'!testEnvironmentAtPut	"(UnixProcessAccessorTestCase selector: #testEnvironmentAtPut) run"	| oldPath newPath resetPath s |	oldPath := accessor environmentAt: 'PATH'.	newPath := 'this is a test string'.	accessor environmentAt: 'PATH' put: newPath.	resetPath := accessor environmentAt: 'PATH'.	self should: [newPath = resetPath].	accessor environmentAt: 'PATH' put: oldPath.	resetPath := accessor environmentAt: 'PATH'.	self should: [oldPath = resetPath].	s := WriteStream on: String new.	10000 timesRepeat: [s nextPutAll: 'Do something to provoke garbage collection'].	resetPath := accessor environmentAt: 'PATH'.	self should: [oldPath = resetPath].! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/7/2001 11:47'!testEnvironmentAtPut1	"(UnixProcessAccessorTestCase selector: #testEnvironmentAtPut1) run"	| oldVal newVal resetVal |	oldVal := accessor environmentAt: 'AAAA'.	newVal := 'this is a test string'.	accessor environmentAt: 'AAAA' put: newVal.	resetVal := accessor environmentAt: 'AAAA'.	self should: [resetVal notNil and: [resetVal isEmpty not]].	self should: [newVal = resetVal].	accessor environmentAt: 'AAAA' put: oldVal.	self should: [oldVal = (accessor environmentAt: 'AAAA')]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/7/2001 12:14'!testEnvironmentAtPut2	"This looks for a bug in which the enviroment is successfully, but later gets	invalidated by memory moves or reallocation."	"(UnixProcessAccessorTestCase selector: #testEnvironmentAtPut2) run"	| oldVal newVal resetVal count ws goodResults notFound totallyBogus |	oldVal := accessor environmentAt: 'AAAA'.	newVal := 'this is a test string'.	accessor environmentAt: 'AAAA' put: newVal.	resetVal := accessor environmentAt: 'AAAA'.	self should: [resetVal notNil and: [resetVal isEmpty not]].	self should: [newVal = resetVal].	count := 50000.	ws := WriteStream on: Array new.	count timesRepeat: [ws nextPut: (accessor environmentAt: 'AAAA')].	goodResults := ws contents select: [:e | e = newVal].	notFound := ws contents select: [:e | e isNil].	totallyBogus := ws contents select: [:e | e notNil and: [e ~= newVal]].	"Uncomment the following to see when the problem is happening"	"(Array with: goodResults with: notFound with: totallyBogus) inspect."	self should: [goodResults size == count].	self should: [notFound isEmpty].	self should: [totallyBogus isEmpty].	accessor environmentAt: 'AAAA' put: oldVal.	self should: [oldVal = (accessor environmentAt: 'AAAA')]! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 10/6/2001 11:59'!testFileProtectionMask	"(UnixProcessAccessorTestCase selector: #testFileProtectionMask) run"	| mask |	mask := accessor fileProtectionMask: '/bin/rm'.	self assert: (mask isKindOf: Array).	self assert: (mask size == 4)! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 10/6/2001 12:06'!testFileStat	"(UnixProcessAccessorTestCase selector: #testFileStat) run"	| stat |	stat := accessor fileStat: '/bin/rm'.	self assert: (stat isKindOf: Array).	self assert: (stat size == 3).	self assert: ((stat at: 1) isKindOf: Integer).	self assert: ((stat at: 2) isKindOf: Integer).	self assert: ((stat at: 3) isKindOf: Array).	self assert: ((stat at: 3) size == 4)! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:36'!testGetStdErrHandle	"(UnixProcessAccessorTestCase selector: #testGetStdErrHandle) run"	| handle |	handle := accessor primGetStdErrHandle.	self assert: handle notNil! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:36'!testGetStdInHandle	"(UnixProcessAccessorTestCase selector: #testGetStdInHandle) run"	| handle |	handle := accessor primGetStdInHandle.	self assert: handle notNil! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:36'!testGetStdOutHandle	"(UnixProcessAccessorTestCase selector: #testGetStdOutHandle) run"	| handle |	handle := accessor primGetStdOutHandle.	self assert: handle notNil! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 10/6/2001 12:08'!testIsExecutable	"(UnixProcessAccessorTestCase selector: #testIsExecutable) run"	self should: [accessor isExecutable: '/bin/sh'].	self shouldnt: [accessor isExecutable: '/etc/hosts']! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 1/23/2013 21:35'!testIsExecutableForUserInGroup	"(UnixProcessAccessorTestCase selector: #testIsExecutableForUserInGroup) run"	self shouldnt: [OSProcess waitForCommand: 'touch /tmp/delete.me']		raise: Warning.	OSProcess waitForCommand: 'chmod 550 /tmp/delete.me'.	"explicitly set file group because OS X may have set it to something other than current gid"	OSProcess waitForCommand: 'chgrp ', accessor primGetGid asString, ' /tmp/delete.me'.	self should: [accessor isExecutable: '/bin/sh'					forUser: accessor primGetUid					inGroup: accessor primGetGid].	self shouldnt: [accessor isExecutable: '/etc/hosts'					forUser: accessor primGetUid					inGroup: accessor primGetGid].	self should: [accessor isExecutable: '/tmp/delete.me'					forUser: accessor primGetUid					inGroup: 99999].	self should: [accessor isExecutable: '/tmp/delete.me'					forUser: 99999					inGroup: accessor primGetGid].	self shouldnt: [accessor isExecutable: '/tmp/delete.me'					forUser: 99999					inGroup: 99999].	OSProcess deleteFileNamed: '/tmp/delete.me'! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 11:13'!testIsLockableFile	"(UnixProcessAccessorTestCase selector: #testIsLockableFile) debug"	| fs result |	fs := FileStream fileNamed: 'junkfile'.	[fs nextPutAll: 'ABCDEFG'.	result := OSProcess accessor isLockableFile: fs.	self should: result.	result := OSProcess accessor lockFile: fs.	self should: (result isKindOf: OSFileLock).	result := OSProcess accessor isLockableFile: fs.	self should: result.	OSProcess accessor unlockFile: fs.	result := OSProcess accessor isLockableFile: fs.	self should: result.	fs close.	result := OSProcess accessor isLockableFile: fs.	self shouldnt: result.	] ensure: [fs close]! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 10/20/2001 11:39'!testIsReadable	"(UnixProcessAccessorTestCase selector: #testIsReadable) run"	self should: [accessor isReadable: '/bin/sh'].	OSProcess waitForCommand: 'touch /tmp/delete.me'.	OSProcess waitForCommand: 'chmod 440 /tmp/delete.me'.	(Delay forMilliseconds: 200) wait.	self should: [accessor isReadable: '/tmp/delete.me'].! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 1/23/2013 21:35'!testIsReadableForUserInGroup	"(UnixProcessAccessorTestCase selector: #testIsReadableForUserInGroup) run"	self shouldnt: [OSProcess waitForCommand: 'touch /tmp/delete.me']		raise: Warning.	OSProcess waitForCommand: 'chmod 550 /tmp/delete.me'.	"explicitly set file group because OS X may have set it to something other than current gid"	OSProcess waitForCommand: 'chgrp ', accessor primGetGid asString, ' /tmp/delete.me'.	self should: [accessor isReadable: '/bin/sh'					forUser: accessor primGetUid					inGroup: accessor primGetGid].	self should: [accessor isReadable: '/tmp/delete.me'					forUser: accessor primGetUid					inGroup: 99999].	self should: [accessor isReadable: '/tmp/delete.me'					forUser: 99999					inGroup: accessor primGetGid].	self shouldnt: [accessor isReadable: '/tmp/delete.me'					forUser: 99999					inGroup: 99999].	OSProcess deleteFileNamed: '/tmp/delete.me'! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 10/20/2001 11:38'!testIsWritable	"(UnixProcessAccessorTestCase selector: #testIsWritable) run"	self shouldnt: [accessor isWritable: '/bin/sh'].	OSProcess waitForCommand: 'touch /tmp/delete.me'.	OSProcess waitForCommand: 'chmod 770 /tmp/delete.me'.	(Delay forMilliseconds: 200) wait.	self should: [accessor isWritable: '/tmp/delete.me'].! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 1/23/2013 21:35'!testIsWritableForUserInGroup	"(UnixProcessAccessorTestCase selector: #testIsWritableForUserInGroup) run"	self shouldnt: [OSProcess waitForCommand: 'touch /tmp/delete.me']		raise: Warning.	OSProcess waitForCommand: 'chmod 770 /tmp/delete.me'.	"explicitly set file group because OS X may have set it to something other than current gid"	OSProcess waitForCommand: 'chgrp ', accessor primGetGid asString, ' /tmp/delete.me'.	self shouldnt: [accessor isWritable: '/bin/sh'					forUser: accessor primGetUid					inGroup: accessor primGetGid].	self should: [accessor isWritable: '/tmp/delete.me'					forUser: accessor primGetUid					inGroup: 99999].	self should: [accessor isWritable: '/tmp/delete.me'					forUser: 99999					inGroup: accessor primGetGid].	self shouldnt: [accessor isWritable: '/tmp/delete.me'					forUser: 99999					inGroup: 99999].	OSProcess deleteFileNamed: '/tmp/delete.me'! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 10:58'!testLockFile	"(UnixProcessAccessorTestCase selector: #testLockFile) debug"	| fs result |	fs := FileStream fileNamed: 'junkfile'.	[fs nextPutAll: 'ABCDEFG'.	result := OSProcess accessor lockFile: fs.	self should: (result isKindOf: OSFileLock).	fs close.	result := OSProcess accessor lockFile: fs.	self should: (result == nil).	] ensure: [fs close]! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 10/6/2001 11:48'!testMakePipeHandles	"(UnixProcessAccessorTestCase selector: #testMakePipeHandles) run"	| p |	p := OSPipe new.	self assert: p reader closed not.	self assert: p writer closed not.	p close! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 10:54'!testOSFileLockLock	"(UnixProcessAccessorTestCase selector: #testOSFileLockLock) debug"	| fs fileLock result |	fs := FileStream fileNamed: 'junkfile'.	[fs nextPutAll: 'ABCDEFG'.	fileLock := OSFileLock onFile: fs exclusive: true.	result := fileLock lock.	self should: (result == true).	result := fileLock lock.	self should: (result == true).	fs close.	result := fileLock lock.	self should: (result == false).	] ensure: [fs close]! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 10:44'!testOSFileLockTest	"(UnixProcessAccessorTestCase selector: #testOSFileLockTest) debug"	| fs fileLock result |	fs := FileStream fileNamed: 'junkfile'.	[fs nextPutAll: 'ABCDEFG'.	fileLock := OSFileLock onFile: fs exclusive: true.	result := fileLock test.	self should: (result == true).	result := fileLock lock.	self should: (result == true).	result := fileLock test.	self should: (result == true).	result := fileLock unlock.	self should: (result == true).	result := fileLock test.	self should: (result == true).	fs close.	result := fileLock test.	self should: (result == false).	] ensure: [fs close]! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 10:41'!testOSFileLockUnlock	"(UnixProcessAccessorTestCase selector: #testOSFileLockUnlock) debug"	| fs fileLock result |	fs := FileStream fileNamed: 'junkfile'.	[fs nextPutAll: 'ABCDEFG'.	fileLock := OSFileLock onFile: fs exclusive: true.	result := fileLock unlock.	self should: (result == true).	result := fileLock lock.	self should: (result == true).	result := fileLock unlock.	self should: (result == true).	fs close.	result := fileLock unlock.	self should: (result == false).	] ensure: [fs close]! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 10:54'!testOSFileRegionLockLock	"(UnixProcessAccessorTestCase selector: #testOSFileRegionLockLock) debug"	| fs fileLock result |	fs := FileStream fileNamed: 'junkfile'.	[fs nextPutAll: 'ABCDEFG'.	fileLock := OSFileRegionLock onFile: fs from: 2 to: 4 exclusive: true.	result := fileLock lock.	self should: (result == true).	result := fileLock lock.	self should: (result == true).	fs close.	result := fileLock lock.	self should: (result == false).	] ensure: [fs close]! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 10:46'!testOSFileRegionLockTest	"(UnixProcessAccessorTestCase selector: #testOSFileRegionLockTest) debug"	| fs fileLock result |	fs := FileStream fileNamed: 'junkfile'.	[fs nextPutAll: 'ABCDEFG'.	fileLock := OSFileRegionLock onFile: fs from: 2 to: 4 exclusive: true.	result := fileLock test.	self should: (result == true).	result := fileLock lock.	self should: (result == true).	result := fileLock test.	self should: (result == true).	result := fileLock unlock.	self should: (result == true).	result := fileLock test.	self should: (result == true).	fs close.	result := fileLock test.	self should: (result == false).	] ensure: [fs close]! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 10:46'!testOSFileRegionLockUnlock	"(UnixProcessAccessorTestCase selector: #testOSFileRegionLockUnlock) debug"	| fs fileLock result |	fs := FileStream fileNamed: 'junkfile'.	[fs nextPutAll: 'ABCDEFG'.	fileLock := OSFileRegionLock onFile: fs from: 2 to: 4 exclusive: true.	result := fileLock unlock.	self should: (result == true).	result := fileLock lock.	self should: (result == true).	result := fileLock unlock.	self should: (result == true).	fs close.	result := fileLock unlock.	self should: (result == false).	] ensure: [fs close]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:42'!testPrimArgumentAt	"(UnixProcessAccessorTestCase selector: #testPrimArgumentAt) run"	| progName |	progName := accessor primArgumentAt: 1.	self should: [progName notNil and: [progName isEmpty not]]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:45'!testPrimErrorMessageAt	"(UnixProcessAccessorTestCase selector: #testPrimErrorMessageAt) run"	| msg |	msg := accessor primErrorMessageAt: 1.	self should: [msg notNil and: [msg isEmpty not]].	msg := accessor primErrorMessageAt: 0.	self should: [msg notNil and: [msg isEmpty not]]! !!UnixProcessAccessorTestCase methodsFor: 'testing - fork and exec' stamp: 'dtl 6/11/2011 12:25'!testPrimForkAndExec	"These methods can only be tested properly from UnixProcess, which knows how	to set up the parameters on the stack."	"(UnixProcessAccessorTestCase selector: #testPrimForkAndExec) run"	| p |	self shouldnt: [p := UnixProcess command: 'ls /bin']		raise: Warning.	(Delay forMilliseconds: 500) wait.	self should: [p isComplete].	self should: [p exitStatus == 0]! !!UnixProcessAccessorTestCase methodsFor: 'testing - fork and exec' stamp: 'dtl 10/6/2001 10:44'!testPrimGetChildExitStatus	"Cannot really test this here, because it needs to be wired into the interrupt	handler. Just make sure it returns nil when there is nothing to do."	"(UnixProcessAccessorTestCase selector: #testPrimGetChildExitStatus) run"	| stat |	stat := accessor primGetChildExitStatus: -1.	self should: [stat isNil].	stat := accessor primGetChildExitStatus: 1.	self should: [stat isNil]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 08:45'!testPrimGetCurrentWorkingDirectory	"(UnixProcessAccessorTestCase selector: #testPrimGetCurrentWorkingDirectory) run"	| cwd |	cwd := accessor primGetCurrentWorkingDirectory.	self should: [cwd notNil and: [cwd isEmpty not]]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:49'!testPrimGetEGid	"(UnixProcessAccessorTestCase selector: #testPrimGetEGid) run"	| id |	id := accessor primGetEGid.	self should: [id isKindOf: Integer]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:49'!testPrimGetEUid	"(UnixProcessAccessorTestCase selector: #testPrimGetEUid) run"	| id |	id := accessor primGetEUid.	self should: [id isKindOf: Integer]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:50'!testPrimGetGid	"(UnixProcessAccessorTestCase selector: #testPrimGetGid) run"	| id |	id := accessor primGetGid.	self should: [id isKindOf: Integer]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:50'!testPrimGetPPid	"(UnixProcessAccessorTestCase selector: #testPrimGetPPid) run"	| id |	id := accessor primGetPPid.	self should: [id isKindOf: Integer]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:50'!testPrimGetPid	"(UnixProcessAccessorTestCase selector: #testPrimGetPid) run"	| id |	id := accessor primGetPid.	self should: [id isKindOf: Integer]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 8/19/2005 06:32'!testPrimGetSession	"As of OSPP version 4 and greater, the session ID should always be obtained from	the interpreter. Previously it was deduced by looking at the handle of an open file."	"(UnixProcessAccessorTestCase selector: #testPrimGetSession) run"	| id expectedSessionSize |	expectedSessionSize := [OSProcess accessor sizeOfInt] on: Error do: [4].	id := OSProcess accessor primGetSession.	self assert: (id isNil or: [id isKindOf: ByteArray]).	id := OSProcess accessor getSessionIdentifier.	self assert: (id isKindOf: ByteArray).	self assert: (id size / expectedSessionSize) == 1! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 09:50'!testPrimGetUid	"(UnixProcessAccessorTestCase selector: #testPrimGetUid) run"	| id |	id := accessor primGetUid.	self should: [id isKindOf: Integer]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/7/2001 14:07'!testPrimUnsetEnv	"(UnixProcessAccessorTestCase selector: #testPrimUnsetEnv) run"	| oldVal newVal resetVal |	oldVal := accessor environmentAt: 'AAAA'.	newVal := 'this is a test string'.	accessor environmentAt: 'AAAA' put: newVal.	resetVal := accessor environmentAt: 'AAAA'.	self should: [resetVal notNil and: [resetVal isEmpty not]].	self should: [newVal = resetVal].	accessor primUnsetEnv: 'AAAA', (Character value: 0) asString.	resetVal := accessor environmentAt: 'AAAA'.	self should: [resetVal isNil].	accessor environmentAt: 'AAAA' put: oldVal.	self should: [oldVal = (accessor environmentAt: 'AAAA')]! !!UnixProcessAccessorTestCase methodsFor: 'testing - external process access' stamp: 'dtl 10/6/2001 10:03'!testRealpath	"(UnixProcessAccessorTestCase selector: #testRealpath) run"	| p |	p := accessor realpath: '/usr/bin'.	self should: [p notNil and: [p isEmpty not]].	p := accessor realpath: '/bogus/path/name'.	self should: [p isNil]! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 6/6/2015 09:40'!testRedirectStdOutTo	"Perform a dup2() call on the standard output descriptor to assign it	to a new file stream"	"(UnixProcessAccessorTestCase selector: #testRedirectStdOutTo) run"	| out aFileStream contents outFd saveFd newFileNo saveFs |	out := OSProcess thisOSProcess stdOut.	"save file number to allow cleanup at end of test"	OSProcess deleteFileNamed: '/tmp/delete.2.me'.		saveFs := FileStream newFileNamed: '/tmp/delete.2.me'.	outFd := OSProcess accessor primUnixFileNumber: out fileID.	saveFd := OSProcess accessor primUnixFileNumber: saveFs fileID.	OSProcess accessor primDup: outFd to: saveFd.	"Original stdout file descriptor is saved as safeFd, to be restored at end of test"	OSProcess deleteFileNamed: '/tmp/delete.me'.		aFileStream := FileStream newFileNamed: '/tmp/delete.me'.	"nb - #contentsOfEntireFile closes the file, do not use"	aFileStream reset.	self assert: aFileStream upToEnd isEmpty.	"note - do not close aFileStream as this affects actual stdout"	out nextPutAll: 'foo'; flush.	aFileStream reset.	self assert: aFileStream upToEnd isEmpty.	OSProcess thisOSProcess redirectStdOutTo: aFileStream.	out nextPutAll: 'foo'; flush.	aFileStream reset.	contents := aFileStream upToEnd.	self deny: contents isEmpty.	self assert: contents = 'foo'. "assume noone else is using stdout right now"	"ensure the we can still find the real stdout"	self deny: OSProcess thisOSProcess stdOut closed.	OSProcess thisOSProcess stdOut nextPutAll: 'bar'; flush.	aFileStream reset.	contents := aFileStream upToEnd.	self deny: contents isEmpty.	self assert: contents = 'foobar'.	"Restore the original file number. The stdOut stream is cached in ThisOSProcess	(and should probably be recalculated following a dup2(), so find the real handle	with getStdOutHandle."	newFileNo := OSProcess accessor primUnixFileNumber: OSProcess accessor getStdOutHandle.	OSProcess accessor primDup: saveFd to: newFileNo.	OSProcess thisOSProcess stdOut lf; nextPutAll: 'UnixProcessAccessorTestCase>>testRedirectStdOutTo - this should appear on original console stdout'; lf.	saveFs close.	aFileStream close.		OSProcess deleteFileNamed: '/tmp/delete.me'.		OSProcess deleteFileNamed: '/tmp/delete.2.me'.	! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 10/1/2005 10:33'!testSessionIdentifier	"This is an indirect way to make sure that the primitive for obtaining the session ID does	not get out of kilter with respect to the method for obtaining session ID from an existing	open file. The dangerous failure mode is if the SQFile data stucture format changes and	OSProcess does not get updated to reflect the change.	As of approximately Squeak 3.8 and beyond, the session id has been moved to the	first slot of the data structure. Deducing the session ID from an open file will not	work for a Squeak VM beyond that point, and will not work for any 64 bit VM.	OSPP version 4.0 or higher obtains session ID from the interpreter, so this is no	longer an issue. Skip this test for OSPP 4.0 and higher."	"(UnixProcessAccessorTestCase selector: #testSessionIdentifier) debug"	| installedOSPPMajorVersion |	self should: [accessor getSessionIdentifier isKindOf: ByteArray].	installedOSPPMajorVersion := (OSProcess accessor osppModuleVersionString		ifNil: [-1]) asInteger.	(installedOSPPMajorVersion >= 4)		ifTrue: ["ignore this test"]		ifFalse: [self should:			[accessor getSessionIdentifierFromSourcesFile = accessor getSessionIdentifier]]! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'eem 3/27/2014 11:32'!testSignalNumbers	"Signal numbers as reported by UnixOSProcessPlugin. Note that some signal definitions	are architecture dependent, with specific number assignments differing between e.g. Intel	and Sparc. Intel architecture is assumed for this test."	"NOTE OSPP prior to version 4.4.12 had several incorrect signal number assignments.	Check the version level of OSPP by evaluating this expression:		OSProcess accessor primOSProcessPluginModuleVersionString"	self assert: OSProcess accessor primSigHupNumber = 1.	self assert: OSProcess accessor primSigIntNumber = 2.	self assert: OSProcess accessor primSigKillNumber = 9.	self assert: OSProcess accessor primSigPipeNumber = 13.	self assert: OSProcess accessor primSigQuitNumber = 3.	self assert: OSProcess accessor primSigTermNumber = 15.	OSProcess platformName caseOf:		{ ['unix']		->			[self assert: OSProcess accessor primSigUsr1Number = 10.			 self assert: OSProcess accessor primSigUsr2Number = 12.			 self assert: OSProcess accessor primSigChldNumber = 17.].		   ['Mac OS']	->			[self assert: OSProcess accessor primSigUsr1Number = 30.			 self assert: OSProcess accessor primSigUsr2Number = 31.			 self assert: OSProcess accessor primSigChldNumber = 20.]}		! !!UnixProcessAccessorTestCase methodsFor: 'testing' stamp: 'dtl 9/10/2011 09:26'!testUnixFileNumber	"For purposes of this test, assume that stdin and stderr have not been	directed."	"(UnixProcessAccessorTestCase selector: #testUnixFileNumber) run"	| err errFileNo errHandle in inFileNo inHandle aFileStream fFileNo fHandle |	err := OSProcess thisOSProcess stdErr.	errHandle := err fileID.	errFileNo := OSProcess accessor unixFileNumber: errHandle.	self assert: errFileNo == 2.	in := OSProcess thisOSProcess stdIn.	inHandle := in fileID.	inFileNo := OSProcess accessor unixFileNumber: inHandle.	self assert: inFileNo == 0.	aFileStream := FileStream fileNamed: '/tmp/delete.me'.	fHandle := aFileStream fileID.	fFileNo := OSProcess accessor unixFileNumber: fHandle.	self assert: fFileNo notNil.	self assert: fFileNo > 2.	aFileStream close! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 12:13'!testUnlockFileUnixCompatible	"(UnixProcessAccessorTestCase selector: #testUnlockFileUnixCompatible) debug"	| mode fs result |	mode := OSProcess accessor emulateWin32FileLocking. "remember setting"	fs := FileStream fileNamed: 'junkfile'.	[OSProcessAccessor emulateWin32FileLocking: false. "unix mode"	fs nextPutAll: 'ABCDEFG'.	result := OSProcess accessor unlockFile: fs.	"On Unix, the fcntl call to unlock the file will succeed even if	the file is not locked."	self should: (result isKindOf: OSFileLock).	result := OSProcess accessor lockFile: fs.	self should: (result isKindOf: OSFileLock).	result := OSProcess accessor unlockFile: fs.	self should: (result isKindOf: OSFileLock).	fs close.	result := OSProcess accessor unlockFile: fs.	self should: result == nil] ensure:		[OSProcessAccessor emulateWin32FileLocking: mode.		fs close]! !!UnixProcessAccessorTestCase methodsFor: 'file locking' stamp: 'dtl 5/7/2006 12:11'!testUnlockFileWin32Compatible	"(UnixProcessAccessorTestCase selector: #testUnlockFileWin32Compatible) debug"	| mode fs result |	mode := OSProcess accessor emulateWin32FileLocking. "remember setting"	fs := FileStream fileNamed: 'junkfile'.	[OSProcessAccessor emulateWin32FileLocking: true. "win32 mode"	fs nextPutAll: 'ABCDEFG'.	result := OSProcess accessor unlockFile: fs.	self should: result == nil.	result := OSProcess accessor lockFile: fs.	self should: (result isKindOf: OSFileLock).	result := OSProcess accessor unlockFile: fs.	self should: (result isKindOf: OSFileLock).	fs close.	result := OSProcess accessor unlockFile: fs.	self should: result == nil] ensure:		[OSProcessAccessor emulateWin32FileLocking: mode.		fs close]! !!UnixProcessFileLockTestCase methodsFor: 'asserting' stamp: 'jf 2/22/2004 19:07'!assertLock: lock1 lock: lock2 conflicts: aBoolean	self assert: (lock1 conflictsWith: lock2) = aBoolean.	self assert: (lock2 conflictsWith: lock1) = aBoolean.! !!UnixProcessFileLockTestCase methodsFor: 'data' stamp: 'jf 2/22/2004 19:11'!entireExclusiveLock	^ OSFileLock onFile: self fileStream exclusive: true! !!UnixProcessFileLockTestCase methodsFor: 'data' stamp: 'jf 2/22/2004 19:11'!entireSharedLock	^ OSFileLock onFile: self fileStream exclusive: false! !!UnixProcessFileLockTestCase methodsFor: 'accessing' stamp: 'jf 2/21/2004 18:14'!fileStream	^ fileStream! !!UnixProcessFileLockTestCase methodsFor: 'data' stamp: 'jf 2/22/2004 19:22'!regionExclusiveLock	^ self regionLockFrom: 10 to: 20 exclusive: true! !!UnixProcessFileLockTestCase methodsFor: 'data' stamp: 'jf 2/22/2004 19:22'!regionLockFrom: from to: to exclusive: exclusive	^ OSFileRegionLock onFile: self fileStream from: from to: to exclusive: exclusive! !!UnixProcessFileLockTestCase methodsFor: 'data' stamp: 'jf 2/22/2004 19:22'!regionSharedLock	^ self regionLockFrom: 10 to: 20 exclusive: false! !!UnixProcessFileLockTestCase methodsFor: 'running' stamp: 'jf 2/21/2004 18:12'!setUp	fileStream := FileStream fileNamed: 'junkfile'.! !!UnixProcessFileLockTestCase methodsFor: 'running' stamp: 'dtl 1/23/2013 19:42'!tearDown	fileStream close.	OSProcess deleteFileNamed: fileStream fullName! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:27'!testDistinctExclusiveRegionWithExclusiveRegion	self		assertLock: (self regionLockFrom: 10 to: 20 exclusive: true)		lock: (self regionLockFrom: 30 to: 40 exclusive: true)		conflicts: false! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:27'!testDistinctExclusiveRegionWithSharedRegion	self		assertLock: (self regionLockFrom: 10 to: 20 exclusive: true)		lock: (self regionLockFrom: 30 to: 40 exclusive: false)		conflicts: false! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:27'!testDistinctSharedRegionWithExclusiveRegion	self		assertLock: (self regionLockFrom: 10 to: 20 exclusive: false)		lock: (self regionLockFrom: 30 to: 40 exclusive: true)		conflicts: false! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:26'!testDistinctSharedRegionWithSharedRegion	self		assertLock: (self regionLockFrom: 10 to: 20 exclusive: false)		lock: (self regionLockFrom: 30 to: 40 exclusive: false)		conflicts: false! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:12'!testEntireExclusiveWithEntireExclusive	self		assertLock: self entireExclusiveLock		lock: self entireExclusiveLock		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:16'!testEntireExclusiveWithExclusiveRegion	self		assertLock: self entireExclusiveLock		lock: self regionExclusiveLock		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:17'!testEntireExclusiveWithSharedRegion	self		assertLock: self entireExclusiveLock		lock: self regionSharedLock		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:12'!testEntireSharedWithEntireExclusive	self		assertLock: self entireSharedLock		lock: self entireExclusiveLock		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:12'!testEntireSharedWithEntireShared	self		assertLock: self entireSharedLock		lock: self entireSharedLock		conflicts: false! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:14'!testEntireSharedWithExclusiveRegion	self		assertLock: self entireSharedLock		lock: self regionExclusiveLock		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:15'!testEntireSharedWithSharedRegion	self		assertLock: self entireSharedLock		lock: self regionSharedLock		conflicts: false! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:18'!testExclusiveRegionWithExclusiveRegion	self		assertLock: self regionExclusiveLock		lock: self regionExclusiveLock		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:25'!testIdenticalExclusiveRegionWithExclusiveRegion	self		assertLock: self regionExclusiveLock		lock: self regionExclusiveLock		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:24'!testIdenticalSharedRegionWithExclusiveRegion	self		assertLock: self regionSharedLock		lock: self regionExclusiveLock		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:24'!testIdenticalSharedRegionWithSharedRegion	self		assertLock: self regionSharedLock		lock: self regionSharedLock		conflicts: false! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:25'!testOverlappingExclusiveRegionWithExclusiveRegion	self		assertLock: (self regionLockFrom: 10 to: 20 exclusive: true)		lock: (self regionLockFrom: 20 to: 30 exclusive: true)		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:26'!testOverlappingExclusiveRegionWithSharedRegion	self		assertLock: (self regionLockFrom: 10 to: 20 exclusive: true)		lock: (self regionLockFrom: 20 to: 30 exclusive: false)		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:26'!testOverlappingSharedRegionWithExclusiveRegion	self		assertLock: (self regionLockFrom: 10 to: 20 exclusive: false)		lock: (self regionLockFrom: 20 to: 30 exclusive: true)		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:26'!testOverlappingSharedRegionWithSharedRegion	self		assertLock: (self regionLockFrom: 10 to: 20 exclusive: false)		lock: (self regionLockFrom: 20 to: 30 exclusive: false)		conflicts: false! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:21'!testSupersetExclusiveRegionWithExclusiveRegion	self		assertLock: (self regionLockFrom: 10 to: 40 exclusive: true)		lock: (self regionLockFrom: 20 to: 30 exclusive: true)		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:23'!testSupersetExclusiveRegionWithSharedRegion	self		assertLock: (self regionLockFrom: 10 to: 40 exclusive: true)		lock: (self regionLockFrom: 20 to: 30 exclusive: false)		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:23'!testSupersetSharedRegionWithExclusiveRegion	self		assertLock: (self regionLockFrom: 10 to: 40 exclusive: false)		lock: (self regionLockFrom: 20 to: 30 exclusive: true)		conflicts: true! !!UnixProcessFileLockTestCase methodsFor: 'testing' stamp: 'jf 2/22/2004 19:24'!testSupersetSharedRegionWithSharedRegion	self		assertLock: (self regionLockFrom: 10 to: 40 exclusive: false)		lock: (self regionLockFrom: 20 to: 30 exclusive: false)		conflicts: false! !!UnixProcessTestCase class methodsFor: 'failures' stamp: 'eem 3/27/2014 11:20'!expectedFailures	^UnixOSProcessAccessor basicNew safeToForkSqueak		ifTrue: [#()]		ifFalse: [#(	testClassForkHeadlessSqueakAndDo					testClassForkHeadlessSqueakAndDoThenQuit					testClassForkSqueak					testClassForkSqueakAndDo					testClassForkSqueakAndDoThenQuit					testForkHeadlessSqueakAndDo					testForkHeadlessSqueakAndDoThenQuit					testForkSqueak					testForkSqueakAndDo					testForkSqueakAndDoThenQuit					testHeadlessChild					testSpawnTenHeadlessChildren)]! !!UnixProcessTestCase methodsFor: 'failures' stamp: 'eem 3/27/2014 11:29'!expectedFailures	^UnixOSProcessAccessor basicNew safeToForkSqueak		ifTrue: [#()]		ifFalse: [#(	testClassForkHeadlessSqueakAndDo					testClassForkHeadlessSqueakAndDoThenQuit					testClassForkSqueak					testClassForkSqueakAndDo					testClassForkSqueakAndDoThenQuit					testEightLeafSqueakTree					testForkHeadlessSqueakAndDo					testForkHeadlessSqueakAndDoThenQuit					testForkSqueak					testForkSqueakAndDo					testForkSqueakAndDoThenQuit					testHeadlessChild					testSpawnTenHeadlessChildren)]! !!UnixProcessTestCase methodsFor: 'private' stamp: 'dtl 1/23/2013 21:30'!numberOfOpenFiles	"Answer the number of files currently open for this OS process. This works	only on a system with a /proc filesystem and file descriptors located in a	directory called /proc/<pid>/fd. On other systems, just answer 0."	"UnixProcessTestCase new numberOfOpenFiles"	| path |	path := '/proc/' , OSProcess thisOSProcess pid printString, '/fd'.	^ (OSProcess directoryExists: path)		ifTrue: [(OSProcess directoryEntryNames: path) size]		ifFalse: [0]! !!UnixProcessTestCase methodsFor: 'running' stamp: 'dtl 3/10/2002 10:52'!runAll	"If you get intermittent failures, try doing a garbage collect. Some of these	tests can fail intermittently on the open file handle count checks"	"UnixProcessTestCase new runAll"	| result suite |	Smalltalk garbageCollect.	suite := TestSuite new.	suite addTest: (UnixProcessTestCase selector: #testClassForkSqueak).	suite addTest: (UnixProcessTestCase selector: #testClassForkSqueakAndDo).	suite addTest: (UnixProcessTestCase selector: #testClassForkSqueakAndDoThenQuit).	suite addTest: (UnixProcessTestCase selector: #testClassForkHeadlessSqueakAndDo).	suite addTest: (UnixProcessTestCase selector: #testClassForkHeadlessSqueakAndDoThenQuit).	suite addTest: (UnixProcessTestCase selector: #testForkSqueak).	suite addTest: (UnixProcessTestCase selector: #testForkSqueakAndDo).	suite addTest: (UnixProcessTestCase selector: #testForkSqueakAndDoThenQuit).	suite addTest: (UnixProcessTestCase selector: #testForkHeadlessSqueakAndDo).	suite addTest: (UnixProcessTestCase selector: #testForkHeadlessSqueakAndDoThenQuit).	suite addTest: (UnixProcessTestCase selector: #testHeadlessChild).	suite addTest: (UnixProcessTestCase selector: #testSpawnTenHeadlessChildren).	suite addTest: (UnixProcessTestCase selector: #testEightLeafSqueakTree).	suite addTest: (UnixProcessTestCase selector: #testCatAFile).	suite addTest: (UnixProcessTestCase selector: #testCatFromFileToFiles).	suite addTest: (UnixProcessTestCase selector: #testRunCommand).	suite addTest: (UnixProcessTestCase selector: #testPipe).	suite addTest: (UnixProcessTestCase selector: #testPipeLine).	result := suite run.	self should: [result defects size == 0].	^ result! !!UnixProcessTestCase methodsFor: 'running' stamp: 'dtl 7/30/2010 16:47'!setUp	(self respondsTo: #timeout: ) "Recent Squeak images with test case timeout"		ifTrue: [self perform: #timeout: with: 60].	thisOSProcess := OSProcess thisOSProcess! !!UnixProcessTestCase methodsFor: 'testing - class examples' stamp: 'dtl 6/11/2011 12:26'!testCatAFile	"(UnixProcessTestCase selector: #testCatAFile) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt: [p := UnixProcess catAFile]		raise: Warning.	self assert: p notNil.	self should: [p isRunning].	[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].	self should: [p isComplete].	self should: [p exitStatus == 0].	self should: [p initialStdIn closed]. "Used a file for input, should be closed"	self shouldnt: [p initialStdOut closed]. "Shared stdout with the VM, should be open"	self shouldnt: [p initialStdErr closed]. "Shared stderr with the VM, should be open"	self assert: self numberOfOpenFiles == openFileCount! !!UnixProcessTestCase methodsFor: 'testing - class examples' stamp: 'dtl 1/23/2013 21:36'!testCatFromFileToFiles	"(UnixProcessTestCase selector: #testCatFromFileToFiles) run"	| p f openFileCount |	openFileCount := self numberOfOpenFiles.	OSProcess deleteFileNamed: '/tmp/deleteMe.out'.	OSProcess deleteFileNamed: '/tmp/deleteMe.err'.	self shouldnt: [p := UnixProcess catFromFileToFiles]		raise: Warning.	self assert: p notNil.	self should: [p isRunning].	[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].	self should: [p isComplete].	self should: [p exitStatus == 0].	self should: [p initialStdIn closed].	self should: [p initialStdOut closed].	self should: [p initialStdErr closed].	f := FileStream oldFileNamed: '/tmp/deleteMe.out'.	self shouldnt: [f upToEnd isEmpty].	f close.	f := FileStream oldFileNamed: '/tmp/deleteMe.err'.	self should: [f upToEnd isEmpty].	f close.	self assert: self numberOfOpenFiles == openFileCount! !!UnixProcessTestCase methodsFor: 'testing - class side methods' stamp: 'dtl 6/29/2005 14:24'!testClassForkHeadlessSqueakAndDo	"(UnixProcessTestCase selector: #testClassForkHeadlessSqueakAndDo) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt:		[p := UnixProcess forkHeadlessSqueakAndDo:			[(Delay forMilliseconds: 100) wait.			OSProcess snapshot: false andQuit: true]]		raise: Warning. "Catch warning if fork fails"	self assert: p notNil.	(p == thisOSProcess)		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - class side methods' stamp: 'dtl 6/29/2005 14:26'!testClassForkHeadlessSqueakAndDoThenQuit	"(UnixProcessTestCase selector: #testClassForkHeadlessSqueakAndDoThenQuit) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt:		[p := UnixProcess forkHeadlessSqueakAndDoThenQuit:			[(Delay forMilliseconds: 100) wait]]		raise: Warning. "Catch warning if fork fails"	self assert: p notNil.	(p == thisOSProcess)		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - class side methods' stamp: 'dtl 6/10/2011 15:38'!testClassForkSqueak	"(UnixProcessTestCase selector: #testClassForkSqueak) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt: [p := UnixProcess forkSqueak]		raise: Warning.	self assert: p notNil.	(p == thisOSProcess)		ifTrue:			["Child Squeak"			p inspect.			(Delay forMilliseconds: 100) wait.			OSProcess snapshot: false andQuit: true]		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - class side methods' stamp: 'dtl 6/10/2011 15:43'!testClassForkSqueakAndDo	"(UnixProcessTestCase selector: #testClassForkSqueakAndDo) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt:			[p := UnixProcess forkSqueakAndDo:					[(Delay forMilliseconds: 100) wait.					OSProcess snapshot: false andQuit: true]]		raise: Warning.	self assert: p notNil.	(p == thisOSProcess)		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - class side methods' stamp: 'dtl 6/10/2011 15:43'!testClassForkSqueakAndDoThenQuit	"(UnixProcessTestCase selector: #testClassForkSqueakAndDoThenQuit) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt:			[p := UnixProcess forkSqueakAndDoThenQuit:					[(Delay forMilliseconds: 100) wait]]		raise: Warning.	self assert: p notNil.	(p == thisOSProcess)		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - class examples' stamp: 'dtl 6/10/2011 15:55'!testEightLeafSqueakTree	"(UnixProcessTestCase selector: #testEightLeafSqueakTree) run"	| a openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt: [a := UnixProcess eightLeafSqueakTree]		raise: Warning.	self assert: (a isKindOf: Array).	self assert: a size == 3.	(a includes: 0)		ifTrue:			[Smalltalk quitPrimitive].	self assert: self numberOfOpenFiles == openFileCount! !!UnixProcessTestCase methodsFor: 'testing - child process creation' stamp: 'dtl 6/10/2011 15:47'!testForkHeadlessSqueakAndDo	"(UnixProcessTestCase selector: #testForkHeadlessSqueakAndDo) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt:			[p := thisOSProcess forkHeadlessSqueakAndDo:					[(Delay forMilliseconds: 100) wait.					OSProcess snapshot: false andQuit: true]]		raise: Warning. "Catch warning if fork fails"	self assert: p notNil.	(p == thisOSProcess)		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - child process creation' stamp: 'dtl 6/10/2011 15:47'!testForkHeadlessSqueakAndDoThenQuit	"(UnixProcessTestCase selector: #testForkHeadlessSqueakAndDoThenQuit) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt:			[p := thisOSProcess forkHeadlessSqueakAndDoThenQuit:					[(Delay forMilliseconds: 100) wait]]		raise: Warning. "Catch warning if fork fails"	self assert: p notNil.	(p == thisOSProcess)		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - child process creation' stamp: 'dtl 6/29/2005 14:30'!testForkSqueak	"(UnixProcessTestCase selector: #testForkSqueak) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt: [p := thisOSProcess forkSqueak]		raise: Warning. "Catch warning if fork fails"	self assert: p notNil.	(p == thisOSProcess)		ifTrue:			["Child Squeak"			p inspect.			(Delay forMilliseconds: 100) wait.			OSProcess snapshot: false andQuit: true]		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - child process creation' stamp: 'dtl 6/10/2011 15:45'!testForkSqueakAndDo	"(UnixProcessTestCase selector: #testForkSqueakAndDo) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt:			[p := thisOSProcess forkSqueakAndDo:					[(Delay forMilliseconds: 100) wait.					OSProcess snapshot: false andQuit: true]]		raise: Warning.	self assert: p notNil.	(p == thisOSProcess)		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - child process creation' stamp: 'dtl 6/10/2011 15:46'!testForkSqueakAndDoThenQuit	"(UnixProcessTestCase selector: #testForkSqueakAndDoThenQuit) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt:			[p := thisOSProcess forkSqueakAndDoThenQuit:					[(Delay forMilliseconds: 100) wait]]		raise: Warning.	self assert: p notNil.	(p == thisOSProcess)		ifFalse:			["Parent Squeak process"			self should: [p isRunning].			[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].			self should: [p isComplete].			self should: [p exitStatus == 0].			self assert: self numberOfOpenFiles == openFileCount]! !!UnixProcessTestCase methodsFor: 'testing - class examples' stamp: 'dtl 6/29/2005 14:32'!testHeadlessChild	"(UnixProcessTestCase selector: #testHeadlessChild) run"	| p openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt: [p := UnixProcess headlessChild]		raise: Warning. "Catch warning if fork fails"	[p isComplete] whileFalse: [(Delay forMilliseconds: 100) wait].	self assert: p isComplete.	self assert: p exitStatus == 0.	self assert: self numberOfOpenFiles == openFileCount! !!UnixProcessTestCase methodsFor: 'testing - class examples' stamp: 'dtl 10/12/2001 08:32'!testPipe	"(UnixProcessTestCase selector: #testPipe) run"	| openFileCount |	openFileCount := self numberOfOpenFiles.	self should: [UnixProcess testPipe = 'this is some text to write into the pipe'].	self assert: self numberOfOpenFiles == openFileCount! !!UnixProcessTestCase methodsFor: 'testing - class examples' stamp: 'dtl 10/12/2001 08:32'!testPipeLine	"(UnixProcessTestCase selector: #testPipeLine) run"	| openFileCount |	openFileCount := self numberOfOpenFiles.	self should: ['This is the text to write*' match: UnixProcess testPipeLine].	self assert: self numberOfOpenFiles == openFileCount! !!UnixProcessTestCase methodsFor: 'testing - class examples' stamp: 'dtl 1/23/2013 21:36'!testRunCommand	"(UnixProcessTestCase selector: #testRunCommand) run"	| p f openFileCount |	openFileCount := self numberOfOpenFiles.	OSProcess deleteFileNamed: '/tmp/deleteMe.out'.	OSProcess deleteFileNamed: '/tmp/deleteMe.err'.	self shouldnt: [p := UnixProcess testRunCommand]		raise: Warning.	self assert: p notNil.	self should: [p isRunning].	[p isRunning] whileTrue: [(Delay forMilliseconds: 100) wait].	self should: [p isComplete].	self should: [p exitStatus > 0].	"Forced an error exit status"	"stdin was shared with the Squeak VM, so it should not have been closed."	self shouldnt: [p initialStdIn closed].	"but the output and error streams should have been closed."	self should: [p initialStdOut closed].	self should: [p initialStdErr closed].	f := FileStream oldFileNamed: '/tmp/deleteMe.out'.	self shouldnt: [f upToEnd isEmpty].	f close.	f := FileStream oldFileNamed: '/tmp/deleteMe.err'.	self shouldnt: [f upToEnd isEmpty].	f close.	self assert: self numberOfOpenFiles == openFileCount! !!UnixProcessTestCase methodsFor: 'testing - class examples' stamp: 'dtl 6/29/2005 14:33'!testSpawnTenHeadlessChildren	"(UnixProcessTestCase selector: #testSpawnTenHeadlessChildren) run"	| a openFileCount |	openFileCount := self numberOfOpenFiles.	self shouldnt: [a := UnixProcess spawnTenHeadlessChildren]		raise: Warning. "Catch warning if fork fails"	[(a detect: [:p | p isComplete not] ifNone: []) notNil]		whileTrue: [(Delay forMilliseconds: 100) wait].	self should: [(a select: [:p | p isComplete not]) isEmpty].	self assert: self numberOfOpenFiles == openFileCount! !"OSProcess-Tests"!!ZnUtils class methodsFor: 'streaming' stamp: 'AutoDeprecationRefactoring 7/15/2017 19:26' prior: 85739958!signalProgress: amount total: total	ZnSignalProgress enabled		ifTrue: [ total				ifNil: [ HTTPProgress new						signal: ('Transferred {1} bytes ...' format: {amount humanReadableSIByteSize}) ]				ifNotNil: [ HTTPProgress new						total: total;						amount: amount;						signal: 'Transferring...' ] ]! !!PPFailure commentStamp: '<historical>' prior: 0!The failure object in PetitParser. It is the only class that responds to #isPetitFailure with true. It contains an error message and a position of the occurrence of the failure.Instance Variables:	message	<String>	The error message of this failure.	position	<Integer>	The position of this failure in the input stream.!!PPMemento commentStamp: '<historical>' prior: 0!PPMemento is an internal class used by PPMemoizedParser to cache results and detect left-recursive calls.Instance Variables:	result	<Object>	The cached result.	count	<Integer>	The number of recursive cycles followed.	position	<Integer>	The position of the cached result in the input stream.!!PPParser commentStamp: '<historical>' prior: 0!An abstract parser for all parsers in PetitParser. Subclasses implement #parseOn: to perform the actual recursive-descent parsing. All parsers support a variety of methods to perform an actual parse, see the methods in the #parsing protocol. Parsers are combined with a series of operators that can be found in the #operations protocol.Instance Variables:	properties	<Dictionary>	Stores additional state in the parser object.!!PPDelegateParser commentStamp: '<historical>' prior: 0!A parser that delegates to another parser.Instance Variables:	parser	<PPParser>	The parser to delegate to.!!PPActionParser commentStamp: '<historical>' prior: 0!A parser that performs an action block with the successful parse result of the delegate.Instance Variables:	block	<BlockClosure>	The action block to be executed.!!PPWrappingParser commentStamp: '<historical>' prior: 0!A parser that performs an action block upon activation with the stream and a continuation block.!!PPAndParser commentStamp: 'TudorGirba 2/27/2011 22:22' prior: 0!The and-predicate, a parser that succeeds whenever its delegate does, but does not consume the input stream [Parr 1994, 1995].!!PPCompositeParser commentStamp: 'lr 12/4/2009 18:38' prior: 0!A PPCompositeParser is composed parser built from various primitive parsers. Every production in the receiver is specified as a method that returns its parser. Note that every production requires an instance variable of the same name, otherwise the production is not cached and cannot be used in recursive grammars. Productions should refer to each other by reading the respective inst-var. Note: these inst-vars are typically not written, as the assignment happens in the initialize method using reflection.The start production is defined in the method start. It is aliased to the inst-var parser defined in the superclass of PPCompositeParser.!!PPEndOfInputParser commentStamp: 'lr 4/18/2008 13:46' prior: 0!A parser that succeeds only at the end of the input stream.!!PPExpressionParser commentStamp: '<historical>' prior: 0!A PPExpressionParser is a parser to conveniently define an expression grammar with prefix, postfix, and left- and right-associative infix operators.The following code initializes a parser for arithmetic expressions. First we instantiate an expression parser, a simple parser for expressions in parenthesis and a simple parser for integer numbers.	expression := PPExpressionParser new.	parens := $( asParser token trim , expression , $) asParser token trim 		==> [ :nodes | nodes second ].	integer := #digit asParser plus token trim		==> [ :token | token value asInteger ].	Then we define on what term the expression grammar is built on:	expression term: parens / integer.	Finally we define the operator-groups in descending precedence. Note, that the action blocks receive both, the terms and the parsed operator in the order they appear in the parsed input. 		expression		group: [ :g |			g prefix: $- asParser token trim do: [ :op :a | a negated ] ];		group: [ :g |			g postfix: '++' asParser token trim do: [ :a :op | a + 1 ].			g postfix: '--' asParser token trim do: [ :a :op | a - 1 ] ];		group: [ :g |			g right: $^ asParser token trim do: [ :a :op :b | a raisedTo: b ] ];		group: [ :g |			g left: $* asParser token trim do: [ :a :op :b | a * b ].			g left: $/ asParser token trim do: [ :a :op :b | a / b ] ];		group: [ :g |			g left: $+ asParser token trim do: [ :a :op :b | a + b ].			g left: $- asParser token trim do: [ :a :op :b | a - b ] ].		After evaluating the above code the 'expression' is an efficient parser that evaluates examples like:	expression parse: '-8++'.	expression parse: '1+2*3'.	expression parse: '1*2+3'.	expression parse: '(1+2)*3'.	expression parse: '8/4/2'.	expression parse: '8/(4/2)'.	expression parse: '2^2^3'.	expression parse: '(2^2)^3'.	Instance Variables:	operators	<Dictionary>	The operators defined in the current group.!!PPFlattenParser commentStamp: 'lr 11/22/2009 13:09' prior: 0!A parser that answers a flat copy of the range my delegate parses.!!PPTokenParser commentStamp: 'lr 2/25/2013 23:31' prior: 0!A parser that answers a token with the value of my delegate parses.Instance Variables:	tokenClass	<PPToken class>	The token sub-class to be used.!!PPMemoizedParser commentStamp: '<historical>' prior: 0!A memoized parser, for refraining redundant computations.Instance Variables:	stream	<PositionableStream>	The stream of the associated memento objects.	buffer	<Array of: PPMemento>	The buffer of memento objects.!!PPNotParser commentStamp: '<historical>' prior: 0!The not-predicate, a parser that succeeds whenever its delegate does not, but consumes no input [Parr 1994, 1995].!!PPOptionalParser commentStamp: 'lr 4/3/2011 14:46' prior: 0!A parser that optionally parsers its delegate, or answers nil.!!PPRepeatingParser commentStamp: 'lr 4/3/2011 14:45' prior: 0!An abstract parser that repeatedly parses between 'min' and 'max' instances of its delegate. The default configuration parses an infinite number of elements, as 'min' is set to 0 and 'max' to infinity (SmallInteger maxVal).Instance Variables:	min	<Integer>	The minimum number of repetitions.	max	<Integer>	The maximum number of repetitions.!!PPLimitedRepeatingParser commentStamp: 'lr 4/3/2011 14:37' prior: 0!An abstract parser that repeatedly parses between 'min' and 'max' instances of my delegate and that requires the input to be completed with a specified parser 'limit'. Subclasses provide repeating behavior as typically seen in regular expression implementations (non-blind).Instance Variables:	limit	<PPParser>	The parser to complete the input with.!!PPGreedyRepeatingParser commentStamp: 'lr 4/3/2011 15:08' prior: 0!A greedy repeating parser, commonly seen in regular expression implementations. It aggressively consumes as much input as possible and then backtracks to meet the 'limit' condition.This class essentially implements the iterative version of the following recursive parser composition:	| parser |	parser := PPChoiceParser new.	parser setParsers: (Array		with: (self , parser map: [ :each :rest | rest addFirst: each; yourself ])		with: (limit and ==> [ :each | OrderedCollection new ])).	^ parser ==> [ :rest | rest asArray ]!!PPLazyRepeatingParser commentStamp: 'lr 4/3/2011 15:08' prior: 0!A lazy repeating parser, commonly seen in regular expression implementations. It limits its consumption to meet the 'limit' condition as early as possible.This class essentially implements the iterative version of the following recursive parser composition:	| parser |	parser := PPChoiceParser new.	parser setParsers: (Array		with: (limit and ==> [ :each | OrderedCollection new ])		with: (self , parser map: [ :each :rest | rest addFirst: each; yourself ])).	^ parser ==> [ :rest | rest asArray ]!!PPPossessiveRepeatingParser commentStamp: 'lr 4/3/2011 14:35' prior: 0!The default repeating parser with standard PEG semantics (i.e. possessive, blind, eager).!!PPTrimmingParser commentStamp: 'lr 4/6/2010 19:27' prior: 0!A parser that silently consumes spaces before and after the delegate parser.!!PPEpsilonParser commentStamp: 'lr 5/15/2008 15:09' prior: 0!A parser that consumes nothing and always succeeds.!!PPFailingParser commentStamp: '<historical>' prior: 0!A parser that consumes nothing and always fails.Instance Variables:	message <String>	The failure message.!!PPListParser commentStamp: '<historical>' prior: 0!Abstract parser that parses a list of things in some way (to be specified by the subclasses).Instance Variables:	parsers	<SequenceableCollection of: PPParser>	A sequence of other parsers to delegate to.!!PPChoiceParser commentStamp: 'lr 4/18/2008 15:35' prior: 0!A parser that uses the first parser that succeeds.!!PPSequenceParser commentStamp: 'lr 4/18/2008 15:34' prior: 0!A parser that parses a sequence of parsers.!!PPLiteralParser commentStamp: '<historical>' prior: 0!Abstract literal parser that parses some kind of literal type (to be specified by subclasses).Instance Variables:	literal	<Object>	The literal object to be parsed.	message	<String>	The error message to be generated.!!PPLiteralObjectParser commentStamp: '<historical>' prior: 0!A parser that accepts a single literal object, such as a character. This is the same as the predicate parser 'PPPredicateParser expect: literal' but slightly more efficient.!!PPLiteralSequenceParser commentStamp: 'lr 12/4/2009 18:39' prior: 0!A parser accepts a sequence of literal objects, such as a String. This is an optimization to avoid having to compose longer sequences from PPSequenceParser.!!PPPluggableParser commentStamp: '<historical>' prior: 0!A pluggable parser that passes the parser stream into a block. This enables users to perform manual parsing or to embed other parser frameworks into PetitParser.Instance Variables:	block	<BlockClosure>	The pluggable one-argument block.!!PPPredicateParser commentStamp: '<historical>' prior: 0!An abstract parser that accepts if a given predicate holds.Instance Variables:	predicate	<BlockClosure>	The block testing for the predicate.	predicateMessage	<String>	The error message of the predicate.	negated	<BlockClosure>	The block testing for the negation of the predicate.	negatedMessage	<String>	The error message of the negated predicate.!!PPPredicateObjectParser commentStamp: '<historical>' prior: 0!A parser that accepts if a given predicate on one element of the input sequence holds.!!PPPredicateSequenceParser commentStamp: '<historical>' prior: 0!A parser that accepts if a given predicate on an arbitrary number of elements of the input sequence holds.Instance Variables:	size	<Integer>	The number of elements to consume.!!PPUnresolvedParser commentStamp: 'lr 11/28/2009 18:50' prior: 0!This is a temporary placeholder or forward reference to a parser that has not been defined yet. If everything goes well it will eventually be replaced with the real parser instance.!!PPToken commentStamp: 'lr 2/25/2013 23:34' prior: 0!PPToken represents a parsed part of the input stream. Contrary to a simple String it remembers where it came from, the original collection, its start and stop position and its parse value.Instance Variables:	collection	<SequenceableCollection>	The collection this token comes from.	start	<Integer>	The start position in the collection.	stop	<Integer>	The stop position in the collection.	value <Object>	The parse result.!!PPStream commentStamp: '<historical>' prior: 0!A positional stream implementation used for parsing. It overrides some methods for optimization reasons.!!Stream methodsFor: '*petitparser-core-converting' stamp: 'lr 4/8/2010 14:46'!asPetitStream	^ self contents asPetitStream! !!Object methodsFor: '*petitparser-core-converting' stamp: 'lr 12/18/2011 15:58'!asParser	"Answer a parser accepting the receiving object."	^ PPPredicateObjectParser expect: self! !!Object methodsFor: '*petitparser-core-testing' stamp: 'lr 2/7/2010 20:54'!isPetitFailure	^ false! !!Object methodsFor: '*petitparser-core-testing' stamp: 'lr 8/6/2010 16:44'!isPetitParser	^ false! !!PPCharSetPredicate class methodsFor: 'instance creation' stamp: 'lr 8/25/2010 11:05'!on: aBlock	^ self basicNew initializeOn: aBlock! !!PPCharSetPredicate methodsFor: 'initialization' stamp: 'lr 8/30/2010 12:19'!initializeOn: aBlock	block := aBlock.	classification := Array new: 255.	1 to: classification size do: [ :index |		classification at: index put: (block			value: (Character value: index)) ]! !!PPCharSetPredicate methodsFor: 'evaluating' stamp: 'lr 8/30/2010 12:19'!value: aCharacter	| index |	index := aCharacter asInteger.	index == 0		ifTrue: [ ^ block value: aCharacter ].	index > 255		ifTrue: [ ^ block value: aCharacter ].	^ classification at: index! !!PPFailure class methodsFor: 'instance creation' stamp: 'lr 5/5/2010 13:56'!message: aString at: anInteger	^ self basicNew initializeMessage: aString at: anInteger! !!PPFailure methodsFor: 'initialization' stamp: 'lr 5/5/2010 13:55'!initializeMessage: aString at: anInteger	message := aString.	position := anInteger! !!PPFailure methodsFor: 'testing' stamp: 'lr 2/7/2010 20:54'!isPetitFailure	"I am the only class that should implement this method to return true."	^ true! !!PPFailure methodsFor: 'accessing' stamp: 'lr 5/5/2010 13:56'!message	"Answer a human readable error message of this parse failure."		^ message! !!PPFailure methodsFor: 'accessing' stamp: 'lr 5/5/2010 13:55'!position	"Answer the position in the source string that caused this parse failure."	^ position! !!PPFailure methodsFor: 'printing' stamp: 'lr 5/5/2010 14:01'!printOn: aStream	aStream nextPutAll: self message; nextPutAll: ' at '; print: position! !!PPMemento class methodsFor: 'instance creation' stamp: 'lr 4/22/2008 18:21'!new	^ self basicNew initialize! !!PPMemento methodsFor: 'accessing-readonly' stamp: 'lr 4/22/2008 18:23'!count	^ count! !!PPMemento methodsFor: 'actions' stamp: 'lr 4/22/2008 18:20'!increment	count := count + 1! !!PPMemento methodsFor: 'initialization' stamp: 'lr 4/22/2008 18:21'!initialize	count := 0	! !!PPMemento methodsFor: 'accessing' stamp: 'lr 4/22/2008 18:23'!position	^ position! !!PPMemento methodsFor: 'accessing' stamp: 'lr 4/26/2008 15:48'!position: anInteger	position := anInteger! !!PPMemento methodsFor: 'accessing' stamp: 'lr 4/24/2008 10:15'!result	^ result! !!PPMemento methodsFor: 'accessing' stamp: 'lr 4/22/2008 18:23'!result: anObject	result := anObject! !!PPActionParser class methodsFor: 'instance creation' stamp: 'lr 5/2/2010 16:58'!on: aParser block: aBlock	^ (self on: aParser) setBlock: aBlock! !!PPActionParser methodsFor: 'accessing' stamp: 'lr 4/30/2010 11:10'!block	"Answer the action block of the receiver."	^ block! !!PPActionParser methodsFor: 'parsing' stamp: 'lr 8/1/2010 17:10'!parseOn: aStream	| element |	^ (element := parser parseOn: aStream) isPetitFailure		ifFalse: [ block value: element ]		ifTrue: [ element ]! !!PPActionParser methodsFor: 'initialization' stamp: 'lr 5/2/2010 16:58'!setBlock: aBlock	block := aBlock! !!PPWrappingParser methodsFor: 'parsing' stamp: 'lr 5/12/2010 20:19'!parseOn: aStream	^ block value: aStream value: [ parser parseOn: aStream ]! !!PPAndParser methodsFor: 'operators' stamp: 'lr 5/1/2010 16:16'!and	^ self! !!PPAndParser methodsFor: 'parsing' stamp: 'lr 8/1/2010 17:10'!parseOn: aStream	| element position |	position := aStream position.	element := parser parseOn: aStream.	aStream position: position.	^ element! !!PPCompositeParser class methodsFor: 'accessing' stamp: 'lr 3/16/2013 21:42'!dependencies	"Answer a collection of PPCompositeParser classes that this parser directly dependends on. Override this method in subclasses to declare dependent parsers. The default implementation does not depend on other PPCompositeParser."	^ #()! !!PPCompositeParser class methodsFor: 'accessing' stamp: 'lr 1/29/2010 11:35'!ignoredNames	"Answer a collection of instance-variables that should not be automatically initialized with productions, but that are used internal to the composite parser."	^ PPCompositeParser allInstVarNames! !!PPCompositeParser class methodsFor: 'instance creation' stamp: 'lr 12/7/2009 08:24'!new	"Answer a new parser starting at the default start symbol."	^ self newStartingAt: self startSymbol! !!PPCompositeParser class methodsFor: 'instance creation' stamp: 'lr 3/16/2013 21:21'!newStartingAt: aSymbol	"Answer a new parser starting at aSymbol. The code makes sure to resolve all dependent parsers correctly."	| parsers remaining |	parsers := IdentityDictionary new.	remaining := OrderedCollection with: self.	[ remaining isEmpty ] whileFalse: [		| dependency |		dependency := remaining removeLast.		(parsers includesKey: dependency) ifFalse: [			parsers at: dependency put: dependency basicNew.			remaining addAll: dependency dependencies ] ].	parsers keysAndValuesDo: [ :class :parser |		| dependencies |		dependencies := IdentityDictionary new.		class dependencies 			do: [ :dependency | dependencies at: dependency put: (parsers at: dependency) ].		parser 			initializeStartingAt: (class == self				ifTrue: [ aSymbol ]				ifFalse: [ class startSymbol ]) 			dependencies: dependencies ].	parsers keysAndValuesDo: [ :class :parser |		parser setParser: (parser perform: parser children first name).		parser productionNames keysAndValuesDo: [ :key :value |			(parser instVarAt: key) setParser: (parser perform: value) ] ].	^ parsers at: self! !!PPCompositeParser class methodsFor: 'parsing' stamp: 'lr 2/7/2010 20:57'!parse: anObject	^ self parse: anObject startingAt: self startSymbol! !!PPCompositeParser class methodsFor: 'parsing' stamp: 'lr 2/7/2010 21:02'!parse: anObject onError: aBlock	^ self parse: anObject startingAt: self startSymbol onError: aBlock! !!PPCompositeParser class methodsFor: 'parsing' stamp: 'lr 2/7/2010 20:57'!parse: anObject startingAt: aSymbol	^ (self newStartingAt: aSymbol) parse: anObject! !!PPCompositeParser class methodsFor: 'parsing' stamp: 'lr 2/7/2010 21:02'!parse: anObject startingAt: aSymbol onError: aBlock	^ (self newStartingAt: aSymbol) parse: anObject onError: aBlock! !!PPCompositeParser class methodsFor: 'accessing' stamp: 'lr 12/7/2009 08:20'!startSymbol	"Answer the method that represents the default start symbol."	^ #start! !!PPCompositeParser methodsFor: 'querying' stamp: 'lr 3/16/2013 21:41'!dependencyAt: aClass	"Answer the dependent parser aClass. Throws an error if this parser class is not declared in the method #dependencies on the class-side of the receiver."		^ dependencies at: aClass ifAbsent: [ self error: 'Undeclared dependency in ' , self class name , ' to ' , aClass name ]! !!PPCompositeParser methodsFor: 'initialization' stamp: 'lr 3/16/2013 17:15'!initializeStartingAt: aSymbol dependencies: aDictionary	self initialize.	parser := PPDelegateParser named: aSymbol.	self productionNames keysAndValuesDo: [ :key :value |		self instVarAt: key put: (PPDelegateParser named: value) ].	dependencies := aDictionary! !!PPCompositeParser methodsFor: 'querying' stamp: 'lr 12/4/2009 18:39'!productionAt: aSymbol	"Answer the production named aSymbol."		^ self productionAt: aSymbol ifAbsent: [ nil ]! !!PPCompositeParser methodsFor: 'querying' stamp: 'lr 6/4/2010 13:37'!productionAt: aSymbol ifAbsent: aBlock	"Answer the production named aSymbol, if there is no such production answer the result of evaluating aBlock."		(self class ignoredNames includes: aSymbol asString)		ifTrue: [ ^ aBlock value ].	(self class startSymbol = aSymbol)		ifTrue: [ ^ parser ].	^ self instVarAt: (self class allInstVarNames		indexOf: aSymbol asString		ifAbsent: [ ^ aBlock value ])! !!PPCompositeParser methodsFor: 'querying' stamp: 'lr 5/8/2011 15:45'!productionNames	"Answer a dictionary of slot indexes and production names."		| productionNames ignoredNames |	productionNames := Dictionary new.	ignoredNames := self class ignoredNames		collect: [ :each | each asSymbol ].	self class allInstVarNames keysAndValuesDo: [ :key :value |		(ignoredNames includes: value asSymbol)			ifFalse: [ productionNames at: key put: value asSymbol ] ].	^ productionNames! !!PPCompositeParser methodsFor: 'accessing' stamp: 'lr 5/16/2008 17:32'!start	"Answer the production to start this parser with."		self subclassResponsibility! !!PPDelegateParser class methodsFor: 'instance creation' stamp: 'lr 4/20/2008 16:22'!on: aParser	^ self new setParser: aParser! !!PPDelegateParser methodsFor: 'accessing' stamp: 'lr 10/21/2009 16:37'!children	^ Array with: parser! !!PPDelegateParser methodsFor: 'parsing' stamp: 'lr 2/7/2010 20:47'!parseOn: aStream	^ parser parseOn: aStream! !!PPDelegateParser methodsFor: 'initialization' stamp: 'lr 4/20/2008 16:23'!setParser: aParser	parser := aParser! !!PPEndOfInputParser methodsFor: 'operators' stamp: 'lr 12/7/2009 08:53'!end	^ self! !!PPEndOfInputParser methodsFor: 'parsing' stamp: 'lr 8/1/2010 17:10'!parseOn: aStream	| position result |	position := aStream position.	result := parser parseOn: aStream.	(result isPetitFailure or: [ aStream atEnd ])		ifTrue: [ ^ result ].	result := PPFailure		message: 'end of input expected'		at: aStream position.	aStream position: position.	^ result! !!PPExpressionParser methodsFor: 'private' stamp: 'FirstnameLastname 11/26/2009 20:48'!build: aParser left: aChoiceParser	^ (aParser separatedBy: aChoiceParser) foldLeft: [ :a :op :b | op first value: a value: op second value: b ]! !!PPExpressionParser methodsFor: 'private' stamp: 'lr 12/4/2009 17:38'!build: aParser postfix: aChoiceParser	^ aParser , aChoiceParser star map: [ :term :ops | ops inject: term into: [ :result :operator | operator first value: result value: operator second ] ]! !!PPExpressionParser methodsFor: 'private' stamp: 'lr 12/4/2009 17:39'!build: aParser prefix: aChoiceParser	^ aChoiceParser star , aParser map: [ :ops :term | ops reversed inject: term into: [ :result :operator | operator first value: operator second value: result ] ]! !!PPExpressionParser methodsFor: 'private' stamp: 'FirstnameLastname 11/26/2009 20:48'!build: aParser right: aChoiceParser	^ (aParser separatedBy: aChoiceParser) foldRight: [ :a :op :b | op first value: a value: op second value: b ]! !!PPExpressionParser methodsFor: 'private' stamp: 'FirstnameLastname 11/26/2009 21:15'!buildOn: aParser	^ self buildSelectors inject: aParser into: [ :term :selector |		| list |		list := operators at: selector ifAbsent: [ #() ].		list isEmpty			ifTrue: [ term ]			ifFalse: [				self					perform: selector with: term 					with: (list size = 1						ifTrue: [ list first first ==> [ :operator | Array with: list first second with: operator ] ]						ifFalse: [ 							list								inject: PPChoiceParser new								into: [ :choice :each | choice / (each first ==> [ :operator | Array with: each second with: operator ]) ] ]) ] ]! !!PPExpressionParser methodsFor: 'private' stamp: 'FirstnameLastname 11/26/2009 20:48'!buildSelectors	^ #(build:prefix: build:postfix: build:right: build:left:)! !!PPExpressionParser methodsFor: 'specifying' stamp: 'lr 2/7/2010 23:20'!group: aOneArgumentBlock	"Defines a priority group by evaluating aOneArgumentBlock."		operators := Dictionary new.	parser := [ 		aOneArgumentBlock value: self.	 	self buildOn: parser ]			ensure: [ operators := nil ]! !!PPExpressionParser methodsFor: 'specifying' stamp: 'FirstnameLastname 11/26/2009 20:49'!left: aParser do: aThreeArgumentBlock	"Define an operator aParser that is left-associative. Evaluate aThreeArgumentBlock with the first term, the operator, and the second term."		self operator: #build:left: parser: aParser do: aThreeArgumentBlock! !!PPExpressionParser methodsFor: 'private' stamp: 'lr 2/7/2010 23:23'!operator: aSymbol parser: aParser do: aBlock	parser isNil		ifTrue: [ ^ self error: 'You did not specify a term when creating the receiver.' ].	operators isNil		ifTrue: [ ^ self error: 'Use #group: to define precedence groups in descending order.' ].	(operators at: aSymbol ifAbsentPut: [ OrderedCollection new ])		addLast: (Array with: aParser asParser with: aBlock)! !!PPExpressionParser methodsFor: 'specifying' stamp: 'FirstnameLastname 11/26/2009 20:49'!postfix: aParser do: aTwoArgumentBlock	"Define a postfix operator aParser. Evaluate aTwoArgumentBlock with the term and the operator."	self operator: #build:postfix: parser: aParser do: aTwoArgumentBlock! !!PPExpressionParser methodsFor: 'specifying' stamp: 'FirstnameLastname 11/26/2009 20:49'!prefix: aParser do: aTwoArgumentBlock	"Define a prefix operator aParser. Evaluate aTwoArgumentBlock with the operator and the term."	self operator: #build:prefix: parser: aParser do: aTwoArgumentBlock! !!PPExpressionParser methodsFor: 'specifying' stamp: 'FirstnameLastname 11/26/2009 20:49'!right: aParser do: aThreeArgumentBlock	"Define an operator aParser that is right-associative. Evaluate aThreeArgumentBlock with the first term, the operator, and the second term."		self operator: #build:right: parser: aParser do: aThreeArgumentBlock! !!PPExpressionParser methodsFor: 'specifying' stamp: 'FirstnameLastname 11/26/2009 21:26'!term: aParser	"Defines the initial term aParser of the receiver."		parser isNil		ifTrue: [ parser := aParser ]		ifFalse: [ self error: 'Unable to redefine the term.' ]! !!PPFlattenParser methodsFor: 'private' stamp: 'lr 2/25/2013 23:31'!on: aCollection start: aStartInteger stop: aStopInteger value: anObject	^ aCollection copyFrom: aStartInteger to: aStopInteger! !!PPFlattenParser methodsFor: 'parsing' stamp: 'lr 2/25/2013 23:30'!parseOn: aStream	| start element |	start := aStream position.	element := parser parseOn: aStream.	element isPetitFailure ifTrue: [ ^ element ].	^ self on: aStream collection start: start + 1 stop: aStream position value: element! !!PPTokenParser methodsFor: 'private' stamp: 'lr 4/6/2010 19:18'!defaultTokenClass	^ PPToken! !!PPTokenParser methodsFor: 'initialization' stamp: 'lr 4/6/2010 19:19'!initialize	tokenClass := self defaultTokenClass	! !!PPTokenParser methodsFor: 'private' stamp: 'lr 2/25/2013 23:32'!on: aCollection start: aStartInteger stop: aStopInteger value: anObject	^ self tokenClass on: aCollection start: aStartInteger stop: aStopInteger value: anObject! !!PPTokenParser methodsFor: 'accessing' stamp: 'lr 4/6/2010 19:23'!tokenClass	^ tokenClass! !!PPTokenParser methodsFor: 'accessing' stamp: 'lr 4/6/2010 19:24'!tokenClass: aTokenClass	tokenClass := aTokenClass! !!PPMemoizedParser methodsFor: 'operators' stamp: 'lr 4/2/2009 19:48'!memoized	"Ther is no point in memoizing more than once."	^ self! !!PPMemoizedParser methodsFor: 'parsing' stamp: 'lr 8/1/2010 17:11'!parseOn: aStream	| memento |	stream == aStream		ifFalse: [ self reset: aStream ].	memento := (buffer at: stream position + 1)		ifNil: [ buffer at: stream position + 1 put: PPMemento new ].	memento position isNil		ifTrue: [			memento result: (stream size - stream position + 2 < memento count				ifTrue: [ PPFailure message: 'overflow' at: stream position ]				ifFalse: [ memento increment. parser parseOn: stream ]).			memento position: stream position ]		ifFalse: [ stream position: memento position ].	^ memento result! !!PPMemoizedParser methodsFor: 'private' stamp: 'lr 4/2/2009 19:22'!reset: aStream	stream := aStream.	buffer := Array new: aStream size + 1! !!PPNotParser methodsFor: 'parsing' stamp: 'lr 8/1/2010 17:11'!parseOn: aStream	| element position |	position := aStream position.	element := parser parseOn: aStream.	aStream position: position.	^ element isPetitFailure		ifFalse: [ PPFailure message: '' at: aStream position ]! !!PPOptionalParser methodsFor: 'parsing' stamp: 'lr 8/14/2011 11:47'!parseOn: aStream	| element |	element := parser parseOn: aStream.	^ element isPetitFailure ifFalse: [ element ]! !!PPGreedyRepeatingParser methodsFor: 'parsing' stamp: 'lr 4/2/2011 15:54'!parseOn: aStream	| start element elements positions |	start := aStream position.	elements := OrderedCollection new.	[ elements size < min ] whileTrue: [ 		(element := parser parseOn: aStream) isPetitFailure ifTrue: [ 			aStream position: start.			^ element ].		elements addLast: element ].	positions := OrderedCollection with: aStream position.	[ elements size < max and: [ (element := parser parseOn: aStream) isPetitFailure not ] ] whileTrue: [		elements addLast: element.		positions addLast: aStream position ].	[ positions isEmpty ] whileFalse: [		aStream position: positions last.		element := limit parseOn: aStream.		element isPetitFailure ifFalse: [			aStream position: positions last.			^ elements asArray ].		elements isEmpty ifTrue: [			aStream position: start.			^ element ].		elements removeLast.		positions removeLast ].	aStream position: start.	^ PPFailure message: 'overflow' at: start! !!PPLazyRepeatingParser methodsFor: 'parsing' stamp: 'lr 4/2/2011 10:14'!parseOn: aStream	| start element elements |	start := aStream position.	elements := OrderedCollection new.	[ elements size < min ] whileTrue: [		(element := parser parseOn: aStream) isPetitFailure ifTrue: [			aStream position: start.			^ element ].		elements addLast: element ].	[ self matchesLimitOn: aStream ] whileFalse: [		elements size < max ifFalse: [			aStream position: start.			^ PPFailure message: 'overflow' at: start ].		element := parser parseOn: aStream.		element isPetitFailure ifTrue: [			aStream position: start.			^ element ].		elements addLast: element ].	^ elements asArray! !!PPLimitedRepeatingParser class methodsFor: 'instance creation' stamp: 'lr 4/3/2011 14:58'!on: aParser limit: aLimitParser	^ (self on: aParser) setLimit: aLimitParser! !!PPLimitedRepeatingParser methodsFor: 'accessing' stamp: 'lr 4/4/2011 18:46'!children	^ Array with: parser with: limit! !!PPLimitedRepeatingParser methodsFor: 'accessing' stamp: 'lr 4/2/2011 10:00'!limit	"Answer the parser that limits (or ends) this repetition."		^ limit! !!PPLimitedRepeatingParser methodsFor: 'private' stamp: 'lr 4/2/2011 10:10'!matchesLimitOn: aStream	| element position |	position := aStream position.	element := limit parseOn: aStream.	aStream position: position.	^ element isPetitFailure not! !!PPLimitedRepeatingParser methodsFor: 'initialization' stamp: 'lr 4/2/2011 10:00'!setLimit: aParser	limit := aParser! !!PPPossessiveRepeatingParser methodsFor: 'parsing' stamp: 'lr 4/2/2011 09:52'!parseOn: aStream	| start element elements |	start := aStream position.	elements := OrderedCollection new.	[ elements size < min ] whileTrue: [		(element := parser parseOn: aStream) isPetitFailure ifTrue: [			aStream position: start.			^ element ].		elements addLast: element ].	[ elements size < max ] whileTrue: [	 	(element := parser parseOn: aStream) isPetitFailure			ifTrue: [ ^ elements asArray ].		elements addLast: element ].	^ elements asArray! !!PPRepeatingParser methodsFor: 'initialization' stamp: 'lr 4/1/2011 21:06'!initialize	super initialize.	self setMin: 0; setMax: SmallInteger maxVal! !!PPRepeatingParser methodsFor: 'accessing' stamp: 'lr 4/30/2010 11:08'!max	"Answer the maximum number of repetitions."	^ max! !!PPRepeatingParser methodsFor: 'accessing' stamp: 'lr 4/30/2010 11:08'!min	"Answer the minimum number of repetitions."		^ min! !!PPRepeatingParser methodsFor: 'printing' stamp: 'lr 6/3/2010 14:00'!printOn: aStream	super printOn: aStream.	aStream nextPutAll: ' ['; print: min; nextPutAll: ', '; nextPutAll: (max = SmallInteger maxVal		ifTrue: [ '*' ] ifFalse: [ max printString ]); nextPut: $]! !!PPRepeatingParser methodsFor: 'initialization' stamp: 'lr 4/1/2011 21:00'!setMax: anInteger	max := anInteger! !!PPRepeatingParser methodsFor: 'initialization' stamp: 'lr 4/1/2011 21:01'!setMin: anInteger	min := anInteger! !!PPTrimmingParser class methodsFor: 'instance creation' stamp: 'lr 7/31/2010 12:01'!on: aParser trimmer: aTrimParser	^ self new		setParser: aParser;		setTrimmer: aTrimParser;		yourself! !!PPTrimmingParser methodsFor: 'parsing' stamp: 'lr 8/1/2010 17:11'!parseOn: aStream	| position element |	position := aStream position.	[ (trimmer parseOn: aStream) isPetitFailure ]		whileFalse.	element := parser parseOn: aStream.	element isPetitFailure ifTrue: [		aStream position: position.		^ element ].	[ (trimmer parseOn: aStream) isPetitFailure ]		whileFalse.	^ element! !!PPTrimmingParser methodsFor: 'initialization' stamp: 'lr 7/31/2010 12:00'!setTrimmer: aParser	trimmer := aParser! !!PPEpsilonParser methodsFor: 'parsing' stamp: 'lr 2/7/2010 20:49'!parseOn: aStream	^ nil! !!PPFailingParser class methodsFor: 'instance creation' stamp: 'lr 5/2/2010 19:16'!message: aString	^ self new setMessage: aString! !!PPFailingParser methodsFor: 'accessing' stamp: 'lr 4/30/2010 11:10'!message	"Answer the error message of the receiving parser."	^ message! !!PPFailingParser methodsFor: 'parsing' stamp: 'lr 5/5/2010 13:57'!parseOn: aStream	^ PPFailure message: message at: aStream position! !!PPFailingParser methodsFor: 'printing' stamp: 'lr 4/16/2010 21:27'!printNameOn: aStream	super printNameOn: aStream.	aStream nextPutAll: ', '; print: message! !!PPFailingParser methodsFor: 'initialization' stamp: 'lr 5/2/2010 19:16'!setMessage: aString	message := aString! !!PPChoiceParser methodsFor: 'operators' stamp: 'lr 9/17/2008 00:16'!/ aRule 	^ self copyWith: aRule! !!PPChoiceParser methodsFor: 'parsing' stamp: 'lr 5/22/2010 11:48'!parseOn: aStream	"This is optimized code that avoids unnecessary block activations, do not change. When all choices fail, the last failure is answered."	| element |	1 to: parsers size do: [ :index |		element := (parsers at: index)			parseOn: aStream.		element isPetitFailure			ifFalse: [ ^ element ] ].	^ element! !!PPListParser class methodsFor: 'instance creation' stamp: 'lr 5/3/2010 20:26'!with: aParser	^ self withAll: (Array with: aParser)! !!PPListParser class methodsFor: 'instance creation' stamp: 'lr 9/23/2008 18:32'!with: aFirstParser with: aSecondParser	^ self withAll: (Array with: aFirstParser with: aSecondParser)! !!PPListParser class methodsFor: 'instance creation' stamp: 'lr 4/29/2010 10:12'!withAll: aCollection	^ self basicNew setParsers: aCollection! !!PPListParser methodsFor: 'accessing' stamp: 'lr 10/21/2009 16:37'!children	^ parsers! !!PPListParser methodsFor: 'copying' stamp: 'lr 9/17/2008 22:36'!copyWith: aParser	^ self species withAll: (parsers copyWith: aParser)! !!PPListParser methodsFor: 'initialization' stamp: 'lr 4/29/2010 10:12'!initialize	super initialize.	self setParsers: #()! !!PPListParser methodsFor: 'copying' stamp: 'lr 5/22/2010 10:26'!postCopy	super postCopy.	parsers := parsers copy! !!PPListParser methodsFor: 'initialization' stamp: 'lr 4/29/2010 10:12'!setParsers: aCollection	parsers := aCollection asArray! !!PPSequenceParser methodsFor: 'operators' stamp: 'lr 9/17/2008 00:17'!, aRule	^ self copyWith: aRule! !!PPSequenceParser methodsFor: 'operators-mapping' stamp: 'lr 5/6/2011 20:27'!map: aBlock	^ aBlock numArgs = self children size		ifTrue: [ self ==> [ :nodes | aBlock valueWithArguments: nodes ] ]		ifFalse: [ self error: aBlock numArgs asString , ' arguments expected.' ]! !!PPSequenceParser methodsFor: 'parsing' stamp: 'lr 5/6/2010 10:47'!parseOn: aStream	"This is optimized code that avoids unnecessary block activations, do not change."		| start elements element |	start := aStream position.	elements := Array new: parsers size.	1 to: parsers size do: [ :index |		element := (parsers at: index) 			parseOn: aStream.		element isPetitFailure ifTrue: [			aStream position: start.			^ element ].		elements at: index put: element ].	^ elements! !!PPSequenceParser methodsFor: 'operators-mapping' stamp: 'lr 1/8/2010 12:01'!permutation: anArrayOfIntegers	"Answer a permutation of the receivers sequence."		anArrayOfIntegers do: [ :index |		(index isInteger and: [ index between: 1 and: parsers size ])			ifFalse: [ self error: 'Invalid permutation index: ' , index printString ] ].	^ self ==> [ :nodes | anArrayOfIntegers collect: [ :index | nodes at: index ] ]! !!PPLiteralObjectParser methodsFor: 'operators' stamp: 'lr 8/18/2010 20:16'!caseInsensitive	"Answer a parser that can parse the receiver case-insensitive."		literal asUppercase = literal asLowercase ifTrue: [ ^ self ].	^ PPPredicateObjectParser on: [ :value | literal sameAs: value ] message: message! !!PPLiteralObjectParser methodsFor: 'operators' stamp: 'lr 4/28/2011 20:02'!negate	^ (PPPredicateObjectParser expect: literal message: message) negate! !!PPLiteralObjectParser methodsFor: 'parsing' stamp: 'lr 10/30/2010 11:48'!parseOn: aStream	^ (aStream atEnd not and: [ literal = aStream uncheckedPeek ])		ifFalse: [ PPFailure message: message at: aStream position ]		ifTrue: [ aStream next ]! !!PPLiteralParser class methodsFor: 'instance creation' stamp: 'lr 1/7/2010 15:30'!on: anObject	^ self on: anObject message: anObject printString , ' expected'! !!PPLiteralParser class methodsFor: 'instance creation' stamp: 'lr 1/7/2010 15:29'!on: anObject message: aString	^ self new initializeOn: anObject message: aString! !!PPLiteralParser methodsFor: 'operators' stamp: 'lr 6/1/2010 22:24'!caseInsensitive	"Answer a parser that can parse the receiver case-insensitive."		self subclassResponsibility! !!PPLiteralParser methodsFor: 'initialization' stamp: 'lr 5/2/2010 13:25'!initializeOn: anObject message: aString	literal := anObject.	message := aString! !!PPLiteralParser methodsFor: 'accessing' stamp: 'lr 5/2/2010 13:26'!literal	"Answer the parsed literal."	^ literal! !!PPLiteralParser methodsFor: 'accessing' stamp: 'lr 5/2/2010 13:26'!message	"Answer the failure message."		^ message! !!PPLiteralParser methodsFor: 'printing' stamp: 'lr 4/16/2010 16:38'!printNameOn: aStream	super printNameOn: aStream.	aStream nextPutAll: ', '; print: literal! !!PPLiteralSequenceParser methodsFor: 'operators' stamp: 'lr 8/18/2010 20:16'!caseInsensitive	"Answer a parser that can parse the receiver case-insensitive."		literal asUppercase = literal asLowercase ifTrue: [ ^ self ].	^ PPPredicateSequenceParser on: [ :value | literal sameAs: value ] message: message size: size! !!PPLiteralSequenceParser methodsFor: 'initialization' stamp: 'lr 6/1/2010 22:21'!initializeOn: anObject message: aString	super initializeOn: anObject message: aString.	size := literal size! !!PPLiteralSequenceParser methodsFor: 'parsing' stamp: 'lr 10/30/2010 11:48'!parseOn: aStream	| position result |	position := aStream position.	result := aStream next: size.	literal = result ifTrue: [ ^ result ].	aStream position: position.	^ PPFailure message: message at: aStream position! !!PPLiteralSequenceParser methodsFor: 'accessing' stamp: 'lr 9/15/2010 11:16'!size	"Answer the sequence size of the receiver."	^ size! !!PPParser class methodsFor: 'instance creation' stamp: 'lr 10/27/2008 11:17'!named: aString	^ self new name: aString! !!PPParser class methodsFor: 'instance creation' stamp: 'lr 4/18/2008 14:00'!new	^ self basicNew initialize! !!PPParser methodsFor: 'operators' stamp: 'lr 9/23/2008 18:32'!, aParser 	"Answer a new parser that parses the receiver followed by aParser."	^ PPSequenceParser with: self with: aParser! !!PPParser methodsFor: 'operators' stamp: 'lr 4/14/2010 11:46'!/ aParser 	"Answer a new parser that parses the receiver, if the receiver fails try with aParser (ordered-choice)."		^ PPChoiceParser with: self with: aParser! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 5/12/2010 20:32'!==> aBlock	"Answer a new parser that performs aBlock as action handler on success."	^ PPActionParser on: self block: aBlock! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 6/12/2010 10:20'!>=> aBlock	"Answer a new parser that wraps the receiving parser with a two argument block. The first argument is the parsed stream, the second argument a continuation block on the delegate parser."	^ PPWrappingParser on: self block: aBlock! !!PPParser methodsFor: 'operators' stamp: 'lr 5/31/2010 15:12'!and	"Answer a new parser (logical and-predicate) that succeeds whenever the receiver does, but never consumes input."	^ PPAndParser on: self! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 2/19/2010 07:42'!answer: anObject	"Answer a new parser that always returns anObject from a successful parse."	^ self ==> [ :nodes | anObject ]! !!PPParser methodsFor: 'converting' stamp: 'lr 11/29/2011 20:48'!asParser	"Answer the receiving parser."		^ self! !!PPParser methodsFor: 'accessing' stamp: 'lr 10/21/2009 16:38'!children	"Answer a set of child parsers that could follow the receiver."	^ #()! !!PPParser methodsFor: 'operators' stamp: 'lr 12/3/2010 11:34'!def: aParser	"Redefine the receiver as the argument aParser. This method is useful when defining recursive parsers: instantiate a PPUnresolvedParser and later redefine it with another one."	^ self becomeForward: (aParser name: self name)! !!PPParser methodsFor: 'operators-convenience' stamp: 'lr 2/19/2010 07:42'!delimitedBy: aParser	"Answer a new parser that parses the receiver one or more times, separated and possibly ended by aParser."		^ (self separatedBy: aParser) , (aParser optional) ==> [ :node |		node second isNil			ifTrue: [ node first ]			ifFalse: [ node first copyWith: node second ] ]! !!PPParser methodsFor: 'operators' stamp: 'lr 4/30/2010 12:13'!end	"Answer a new parser that succeeds at the end of the input and return the result of the receiver."	^ PPEndOfInputParser on: self! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 5/15/2008 16:08'!flatten	"Answer a new parser that flattens the underlying collection."		^ PPFlattenParser on: self! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 4/3/2011 15:00'!foldLeft: aBlock	"Answer a new parser that that folds the result of the receiver from left-to-right into aBlock. The argument aBlock must take two or more arguments."		| size args |	size := aBlock numArgs.	args := Array new: size.	^ self ==> [ :nodes |		args at: 1 put: nodes first.		2 to: nodes size by: size - 1 do: [ :index |			args				replaceFrom: 2 to: size with: nodes startingAt: index;				at: 1 put: (aBlock valueWithArguments: args) ].		args first ]! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 4/3/2011 14:59'!foldRight: aBlock	"Answer a new parser that that folds the result of the receiver from right-to-left into aBlock. The argument aBlock must take two or more arguments."	| size args |	size := aBlock numArgs.	args := Array new: size.	^ self ==> [ :nodes |		args at: size put: nodes last.		nodes size - size + 1 to: 1 by: 1 - size do: [ :index |			args				replaceFrom: 1 to: size - 1 with: nodes startingAt: index;				at: size put: (aBlock valueWithArguments: args) ].		args at: size ]! !!PPParser methodsFor: 'accessing-properties' stamp: 'lr 4/19/2010 10:32'!hasProperty: aKey	"Test if the property aKey is present."		^ properties notNil and: [ properties includesKey: aKey ]! !!PPParser methodsFor: 'initialization' stamp: 'lr 4/24/2008 10:33'!initialize! !!PPParser methodsFor: 'testing' stamp: 'lr 8/6/2010 16:44'!isPetitParser	^ true! !!PPParser methodsFor: 'testing' stamp: 'lr 10/27/2008 11:28'!isUnresolved	^ false! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 5/6/2011 20:28'!map: aBlock	"Answer a new parser that works on the receiving sequence an passes in each element as a block argument."		^ aBlock numArgs = 1		ifTrue: [ self ==> aBlock ]		ifFalse: [ self error: aBlock numArgs asString , ' arguments expected.' ]! !!PPParser methodsFor: 'parsing' stamp: 'lr 2/8/2010 00:30'!matches: anObject	"Answer if anObject can be parsed by the receiver."		^ (self parse: anObject) isPetitFailure not! !!PPParser methodsFor: 'parsing' stamp: 'lr 6/4/2011 18:12'!matchesIn: anObject	"Search anObject repeatedly for the matches of the receiver. Answered an OrderedCollection of the matched parse-trees."	| result |	result := OrderedCollection new.	self 		matchesIn: anObject		do: [ :each | result addLast: each ].	^ result! !!PPParser methodsFor: 'parsing' stamp: 'lr 3/1/2010 21:51'!matchesIn: anObject do: aBlock	"Search anObject repeatedly for the matches of the receiver. Evaluate aBlock for each match with the matched parse-tree as the argument. Make sure to always consume exactly one character with each step, to not miss any match."	((self and ==> aBlock , #any asParser) / #any asParser) star parse: anObject! !!PPParser methodsFor: 'parsing' stamp: 'lr 8/16/2011 07:26'!matchesSkipIn: anObject	"Search anObject repeatedly for the matches of the receiver. Answer an OrderedCollection of the matched parse-trees. Skip over matches."	| result |	result := OrderedCollection new.	self 		matchesSkipIn: anObject		do: [ :each | result addLast: each ].	^ result! !!PPParser methodsFor: 'parsing' stamp: 'lr 8/16/2011 07:26'!matchesSkipIn: anObject do: aBlock	"Search anObject repeatedly for the matches of the receiver. Evaluate aBlock for each match with the matched parse-tree as the argument. Skip over matches."	(self ==> aBlock / #any asParser) star parse: anObject! !!PPParser methodsFor: 'parsing' stamp: 'lr 6/4/2011 18:12'!matchingRangesIn: anObject	"Search anObject repeatedly for the matches of the receiver. Answer an OrderedCollection of ranges of each match (index of first character to: index of last character)."		| result |	result := OrderedCollection new.	self		matchingRangesIn: anObject		do: [ :value | result addLast: value ].	^ result! !!PPParser methodsFor: 'parsing' stamp: 'lr 2/25/2013 23:41'!matchingRangesIn: anObject do: aBlock	"Search anObject repeatedly for the matches of the receiver. Evaluate aBlock with the range of each match (index of first character to: index of last character)."	self token		matchesIn: anObject		do: [ :token | aBlock value: (token start to: token stop) ]! !!PPParser methodsFor: 'parsing' stamp: 'DamienCassou 10/29/2011 19:18'!matchingSkipRangesIn: anObject	"Search anObject repeatedly for the matches of the receiver. Skip over matches. Answer an OrderedCollection of ranges of each match (index of first character to: index of last character)."		| result |	result := OrderedCollection new.	self		matchingSkipRangesIn: anObject		do: [ :value | result addLast: value ].	^ result! !!PPParser methodsFor: 'parsing' stamp: 'lr 2/25/2013 23:42'!matchingSkipRangesIn: anObject do: aBlock	"Search anObject repeatedly for the matches of the receiver. Skip over matches. Evaluate aBlock with the range of each match (index of first character to: index of last character)."		self token		matchesSkipIn: anObject		do: [ :token | aBlock value: (token start to: token stop) ]! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/1/2011 21:03'!max: anInteger	"Answer a new parser that parses the receiver at most anInteger times."		^ self star setMax: anInteger! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/3/2011 14:56'!max: anInteger greedy: aParser	"Answer a new parser that parses the receiver at most anInteger times until it reaches aParser. This is a greedy non-blind implementation. aParser is not consumed."		^ (self starGreedy: aParser) setMax: anInteger! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/3/2011 14:57'!max: anInteger lazy: aParser	"Answer a new parser that parses the receiver at most anInteger times until it reaches aParser. This is a lazy non-blind implementation. aParser is not consumed."		^ (self starLazy: aParser) setMax: anInteger! !!PPParser methodsFor: 'operators' stamp: 'lr 5/31/2010 16:34'!memoized	"Answer a new memoized parser, for refraining redundant computations. This ensures polynomial time O(n^4) for left-recursive grammars and O(n^3) for non left-recursive grammars in the worst case. Not necessary for most grammars that are carefully written and in O(n) anyway."		^ PPMemoizedParser on: self! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/1/2011 21:02'!min: anInteger	"Answer a new parser that parses the receiver at least anInteger times."		^ self star setMin: anInteger! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/3/2011 14:56'!min: anInteger greedy: aParser	"Answer a new parser that parses the receiver at least anInteger times until it reaches aParser. This is a greedy non-blind implementation. aParser is not consumed."		^ (self starGreedy: aParser) setMin: anInteger! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/3/2011 14:57'!min: anInteger lazy: aParser	"Answer a new parser that parses the receiver at least anInteger times until it reaches aParser. This is a lazy non-blind implementation. aParser is not consumed."		^ (self starLazy: aParser) setMin: anInteger! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/1/2011 21:03'!min: aMinInteger max: aMaxInteger	"Answer a new parser that parses the receiver at least aMinInteger and at most aMaxInteger times."		^ self star setMin: aMinInteger; setMax: aMaxInteger! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/3/2011 14:56'!min: aMinInteger max: aMaxInteger greedy: aParser	"Answer a new parser that parses the receiver at least aMinInteger and at most aMaxInteger times until it reaches aParser. This is a greedy non-blind implementation. aParser is not consumed."		^ (self starGreedy: aParser) setMin: aMinInteger; setMax: aMaxInteger! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/3/2011 14:57'!min: aMinInteger max: aMaxInteger lazy: aParser	"Answer a new parser that parses the receiver at least aMinInteger and at most aMaxInteger times until it reaches aParser. This is a greedy non-blind implementation. aParser is not consumed."		^ (self starLazy: aParser) setMin: aMinInteger; setMax: aMaxInteger! !!PPParser methodsFor: 'accessing' stamp: 'lr 4/19/2010 10:35'!name	"Answer the production name of the receiver."		^ self propertyAt: #name ifAbsent: [ nil ]! !!PPParser methodsFor: 'accessing' stamp: 'lr 4/19/2010 10:38'!name: aString	self propertyAt: #name put: aString! !!PPParser methodsFor: 'operators' stamp: 'lr 2/19/2010 07:36'!negate	"Answer a new parser consumes any input token but the receiver."		^ self not , #any asParser ==> #second! !!PPParser methodsFor: 'operators' stamp: 'lr 5/31/2010 15:12'!not	"Answer a new parser (logical not-predicate) that succeeds whenever the receiver fails, but never consumes input."	^ PPNotParser on: self! !!PPParser methodsFor: 'operators' stamp: 'lr 9/1/2010 22:03'!optional	"Answer a new parser that parses the receiver, if possible."	^ PPOptionalParser on: self! !!PPParser methodsFor: 'parsing' stamp: 'lr 2/7/2010 20:53'!parse: anObject	"Parse anObject with the receiving parser and answer the parse-result or an instance of PPFailure."		^ self parseOn: anObject asPetitStream! !!PPParser methodsFor: 'parsing' stamp: 'lr 10/29/2010 17:05'!parse: anObject onError: aBlock	"Parse anObject with the receiving parser and answer the parse-result or answer the result of evaluating aBlock. Depending on the number of arguments of the block it is simply evaluated, evaluated with the failure object, or evaluated with the error message and position."		| result |	result := self parse: anObject.	result isPetitFailure		ifFalse: [ ^ result ].	aBlock numArgs = 0		ifTrue: [ ^ aBlock value ].	aBlock numArgs = 1		ifTrue: [ ^ aBlock value: result ].	^ aBlock value: result message value: result position! !!PPParser methodsFor: 'parsing' stamp: 'lr 2/7/2010 22:18'!parseOn: aStream	"Parse aStream with the receiving parser and answer the parse-result or an instance of PPFailure. Override this method in subclasses to specify custom parse behavior. Do not call this method from outside, instead use #parse:."		self subclassResponsibility! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/1/2011 21:03'!plus	"Answer a new parser that parses the receiver one or more times."	^ self star setMin: 1! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/1/2011 21:04'!plusGreedy: aParser	"Answer a new parser that parses the receiver one or more times until it reaches aParser. This is a greedy non-blind implementation of the star operator. aParser is not consumed."		^ (self starGreedy: aParser) setMin: 1! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/1/2011 21:04'!plusLazy: aParser	"Answer a new parser that parses the receiver one or more times until it reaches aParser. This is a lazy non-blind implementation of the star operator. aParser is not consumed."		^ (self starLazy: aParser) setMin: 1! !!PPParser methodsFor: 'copying' stamp: 'lr 4/19/2010 10:33'!postCopy	super postCopy.	properties := properties copy! !!PPParser methodsFor: 'printing' stamp: 'lr 4/16/2010 16:36'!printNameOn: aStream	self name isNil		ifTrue: [ aStream print: self hash ]		ifFalse: [ aStream nextPutAll: self name ]! !!PPParser methodsFor: 'printing' stamp: 'lr 4/16/2010 16:36'!printOn: aStream	super printOn: aStream.	aStream nextPut: $(.	self printNameOn: aStream.	aStream nextPut: $)! !!PPParser methodsFor: 'accessing-properties' stamp: 'lr 4/19/2010 10:32'!propertyAt: aKey	"Answer the property value associated with aKey."		^ self propertyAt: aKey ifAbsent: [ self error: 'Property not found' ]! !!PPParser methodsFor: 'accessing-properties' stamp: 'lr 4/19/2010 10:32'!propertyAt: aKey ifAbsent: aBlock	"Answer the property value associated with aKey or, if aKey isn't found, answer the result of evaluating aBlock."		^ properties isNil		ifTrue: [ aBlock value ]		ifFalse: [ properties at: aKey ifAbsent: aBlock ]! !!PPParser methodsFor: 'accessing-properties' stamp: 'lr 4/19/2010 10:32'!propertyAt: aKey ifAbsentPut: aBlock	"Answer the property associated with aKey or, if aKey isn't found store the result of evaluating aBlock as new value."		^ self propertyAt: aKey ifAbsent: [ self propertyAt: aKey put: aBlock value ]! !!PPParser methodsFor: 'accessing-properties' stamp: 'lr 4/19/2010 10:33'!propertyAt: aKey put: anObject	"Set the property at aKey to be anObject. If aKey is not found, create a new entry for aKey and set is value to anObject. Answer anObject."	^ (properties ifNil: [ properties := Dictionary new: 1 ])		at: aKey put: anObject! !!PPParser methodsFor: 'accessing-properties' stamp: 'lr 4/19/2010 10:33'!removeProperty: aKey	"Remove the property with aKey. Answer the property or raise an error if aKey isn't found."		^ self removeProperty: aKey ifAbsent: [ self error: 'Property not found' ]! !!PPParser methodsFor: 'accessing-properties' stamp: 'lr 4/19/2010 10:33'!removeProperty: aKey ifAbsent: aBlock	"Remove the property with aKey. Answer the value or, if aKey isn't found, answer the result of evaluating aBlock."		| answer |	properties isNil ifTrue: [ ^ aBlock value ].	answer := properties removeKey: aKey ifAbsent: aBlock.	properties isEmpty ifTrue: [ properties := nil ].	^ answer! !!PPParser methodsFor: 'operators-convenience' stamp: 'lr 2/19/2010 07:56'!separatedBy: aParser	"Answer a new parser that parses the receiver one or more times, separated by aParser."		^ (PPSequenceParser with: self with: (PPSequenceParser with: aParser with: self) star) ==> [ :nodes |		| result |		result := Array new: 2 * nodes second size + 1.		result at: 1 put: nodes first.		nodes second 			keysAndValuesDo: [ :index :pair | result replaceFrom: 2 * index to: 2 * index + 1 with: pair startingAt: 1 ].		result ]! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/2/2011 10:02'!star	"Answer a new parser that parses the receiver zero or more times. This is a greedy and blind implementation that tries to consume as much input as possible and it does not consider what comes afterwards."	^ PPPossessiveRepeatingParser on: self! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/2/2011 10:01'!starGreedy: aParser	"Answer a new parser that parses the receiver zero or more times until it reaches aParser. This is a greedy non-blind implementation of the star operator. aParser is not consumed."		^ PPGreedyRepeatingParser on: self limit: aParser! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 4/2/2011 10:01'!starLazy: aParser	"Answer a new parser that parses the receiver zero or more times until it reaches aParser. This is a lazy non-blind implementation of the star operator. aParser is not consumed."		^ PPLazyRepeatingParser on: self limit: aParser! !!PPParser methodsFor: 'operators-repeating' stamp: 'lr 9/15/2010 09:34'!times: anInteger	"Answer a new parser that parses the receiver exactly anInteger times."		^ self min: anInteger max: anInteger! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 6/29/2010 14:25'!token	"Answer a new parser that transforms the input to a token."		^ PPTokenParser on: self! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 4/6/2010 19:26'!token: aTokenClass	"Answer a new parser that transforms the input to a token of class aTokenClass."		^ self token tokenClass: aTokenClass! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 7/31/2010 12:06'!trim	"Answer a new parser that consumes spaces before and after the receiving parser."		^ self trimSpaces! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 7/11/2011 11:03'!trim: aParser	"Answer a new parser that consumes and ignores aParser repeatedly before and after the receiving parser."		^ PPTrimmingParser on: self trimmer: aParser! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 7/11/2011 11:03'!trimBlanks	"Answer a new parser that consumes blanks before and after the receiving parser."		^ self trim: #blank asParser! !!PPParser methodsFor: 'operators-mapping' stamp: 'lr 7/11/2011 11:03'!trimSpaces	"Answer a new parser that consumes spaces before and after the receiving parser."		^ self trim: #space asParser! !!PPParser methodsFor: 'operators-convenience' stamp: 'lr 2/25/2012 16:54'!withoutSeparators	"Filters out the separators from a parse result produced by one of the productions #delimitedBy: or #separatedBy:."		^ self ==> [ :items |		| result |		result := Array new: items size + 1 // 2.		1 to: result size do: [ :index | result at: index put: (items at: 2 * index - 1) ].		result ]! !!PPParser methodsFor: 'operators' stamp: 'lr 10/23/2008 14:05'!wrapped	"Answer a new parser that is simply wrapped."		^ PPDelegateParser on: self! !!PPParser methodsFor: 'operators' stamp: 'lr 4/14/2010 11:53'!| aParser	"Answer a new parser that either parses the receiver or aParser. Fail if both pass or fail (exclusive choice, unordered choice)."	^ (self not , aParser) / (aParser not , self) ==> #second! !!PPPluggableParser class methodsFor: 'instance creation' stamp: 'lr 5/2/2010 16:52'!on: aBlock	^ self new initializeOn: aBlock! !!PPPluggableParser methodsFor: 'accessing' stamp: 'lr 4/30/2010 11:10'!block	"Answer the pluggable block."	^ block! !!PPPluggableParser methodsFor: 'initialization' stamp: 'lr 5/2/2010 16:52'!initializeOn: aBlock	block := aBlock! !!PPPluggableParser methodsFor: 'parsing' stamp: 'lr 2/7/2010 20:54'!parseOn: aStream	| position result |	position := aStream position.	result := block value: aStream.	result isPetitFailure		ifTrue: [ aStream position: position ].	^ result! !!PPPredicateObjectParser class methodsFor: 'factory-objects' stamp: 'lr 6/12/2010 09:10'!any	^ self		on: [ :each | true ] message: 'input expected'		negated: [ :each | false ] message: 'no input expected'! !!PPPredicateObjectParser class methodsFor: 'factory-objects' stamp: 'lr 4/1/2011 20:05'!anyExceptAnyOf: aCollection	^ self		on: [ :each | (aCollection includes: each) not ] message: 'any except ' , aCollection printString , ' expected'		negated: [ :each | aCollection includes: each ] message: aCollection printString ,  ' not expected'! !!PPPredicateObjectParser class methodsFor: 'factory-objects' stamp: 'lr 4/1/2011 20:05'!anyOf: aCollection	^ self		on: [ :each | aCollection includes: each ] message: 'any of ' , aCollection printString , ' expected'		negated: [ :each | (aCollection includes: each) not ] message: 'none of ' , aCollection printString ,  'expected'! !!PPPredicateObjectParser class methodsFor: 'factory-objects' stamp: 'lr 6/12/2010 09:10'!between: min and: max	^ self		on: [ :each | each >= min and: [ each <= max ] ] message: min printString , '..' , max printString , ' expected'		negated: [ :each | each < min or: [ each > max ] ] message: min printString , '..' , max printString , ' not expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:02'!blank	^ self chars: (String with: Character space with: Character tab) message: 'blank expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:02'!char: aCharacter	^ self expect: aCharacter message: (String with: $" with: aCharacter with: $") , ' expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 10:57'!char: aCharacter message: aString	^ self expect: aCharacter message: aString! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:06'!chars: aCollection message: aString	^ self on: (PPCharSetPredicate on: [ :char | aCollection includes: char ]) message: aString! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:02'!cr	^ self char: Character cr message: 'carriage return expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:06'!digit	^ self on: (PPCharSetPredicate on: [ :char | char isDigit ]) message: 'digit expected'! !!PPPredicateObjectParser class methodsFor: 'factory-objects' stamp: 'lr 8/25/2010 10:57'!expect: anObject	^ self expect: anObject message: anObject printString , ' expected'! !!PPPredicateObjectParser class methodsFor: 'factory-objects' stamp: 'lr 8/25/2010 10:57'!expect: anObject message: aString	^ self 		on: [ :each | each = anObject ] message: aString		negated: [ :each | each ~= anObject ] message: 'no ' , aString! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:06'!hex	^ self 		on: (PPCharSetPredicate on: [ :char | 			(char between: $0 and: $9) 				or: [ (char between: $a and: $f) 				or: [ (char between: $A and: $F) ] ] ])		message: 'hex digit expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:05'!letter	^ self on: (PPCharSetPredicate on: [ :char | char isLetter ]) message: 'letter expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 6/12/2010 09:10'!lf	^ self char: Character lf! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:06'!lowercase	^ self on: (PPCharSetPredicate on: [ :char | char isLowercase ]) message: 'lowercase letter expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:04'!newline	^ self chars: (String with: Character cr with: Character lf) message: 'newline expected'! !!PPPredicateObjectParser class methodsFor: 'instance creation' stamp: 'lr 6/12/2010 09:10'!on: aBlock message: aString	^ self on: aBlock message: aString negated: [ :each | (aBlock value: each) not ] message: 'no ' , aString! !!PPPredicateObjectParser class methodsFor: 'instance creation' stamp: 'lr 6/12/2010 09:10'!on: aBlock message: aString negated: aNegatedBlock message: aNegatedString	^ self new initializeOn: aBlock message: aString negated: aNegatedBlock message: aNegatedString! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:04'!punctuation	^ self chars: '.,"''?!!;:#$%&()*+-/<>=@[]\^_{}|~' message: 'punctuation expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:06'!space	^ self on: (PPCharSetPredicate on: [ :char | char isSeparator ]) message: 'separator expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:04'!tab	^ self char: Character tab message: 'tab expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:06'!uppercase	^ self on: (PPCharSetPredicate on: [ :char | char isUppercase ]) message: 'uppercase letter expected'! !!PPPredicateObjectParser class methodsFor: 'factory-chars' stamp: 'lr 8/25/2010 11:06'!word	^ self on: (PPCharSetPredicate on: [ :char | char isAlphaNumeric ]) message: 'letter or digit expected'! !!PPPredicateObjectParser methodsFor: 'initialization' stamp: 'lr 6/12/2010 09:12'!initializeOn: aBlock message: aString negated: aNegatedBlock message: aNegatedString	predicate := aBlock.	predicateMessage := aString.	negated := aNegatedBlock.	negatedMessage := aNegatedString! !!PPPredicateObjectParser methodsFor: 'operators' stamp: 'lr 6/12/2010 09:12'!negate	"Answer a parser that is the negation of the receiving predicate parser."		^ self class 		on: negated message: negatedMessage 		negated: predicate message: predicateMessage! !!PPPredicateObjectParser methodsFor: 'parsing' stamp: 'lr 9/30/2010 11:05'!parseOn: aStream	^ (aStream atEnd not and: [ predicate value: aStream uncheckedPeek ])		ifFalse: [ PPFailure message: predicateMessage at: aStream position ]		ifTrue: [ aStream next ]! !!PPPredicateParser methodsFor: 'accessing' stamp: 'lr 5/2/2010 13:36'!block	"Answer the predicate block of the receiver."		^ predicate! !!PPPredicateParser methodsFor: 'accessing' stamp: 'lr 5/2/2010 13:36'!message	"Answer the failure message."		^ predicateMessage! !!PPPredicateParser methodsFor: 'printing' stamp: 'lr 5/2/2010 13:37'!printNameOn: aStream	super printNameOn: aStream.	aStream nextPutAll: ', '; print: predicateMessage! !!PPPredicateSequenceParser class methodsFor: 'instance creation' stamp: 'lr 6/12/2010 09:14'!on: aBlock message: aString negated: aNegatedBlock message: aNegatedString size: anInteger 	^ self new initializeOn: aBlock message: aString negated: aNegatedBlock message: aNegatedString size: anInteger! !!PPPredicateSequenceParser class methodsFor: 'instance creation' stamp: 'lr 6/12/2010 09:14'!on: aBlock message: aString size: anInteger	^ self on: aBlock message: aString negated: [ :each | (aBlock value: each) not ] message: 'no ' , aString size: anInteger ! !!PPPredicateSequenceParser methodsFor: 'initialization' stamp: 'lr 6/12/2010 09:13'!initializeOn: aBlock message: aString negated: aNegatedBlock message: aNegatedString size: anInteger	predicate := aBlock.	predicateMessage := aString.	negated := aNegatedBlock.	negatedMessage := aNegatedString.	size := anInteger ! !!PPPredicateSequenceParser methodsFor: 'operators' stamp: 'lr 6/12/2010 09:14'!negate	"Answer a parser that is the negation of the receiving predicate parser."		^ self class 		on: negated message: negatedMessage		negated: predicate message: predicateMessage		size: size! !!PPPredicateSequenceParser methodsFor: 'parsing' stamp: 'lr 6/12/2010 09:25'!parseOn: aStream	| position result |	position := aStream position.	result := aStream next: size.	(result size = size and: [ predicate value: result ])		ifTrue: [ ^ result ].	aStream position: position.	^ PPFailure message: predicateMessage at: aStream position! !!PPPredicateSequenceParser methodsFor: 'accessing' stamp: 'lr 6/12/2010 08:58'!size	"Answer the sequence size of the receiver."	^ size! !!PPUnresolvedParser methodsFor: 'testing' stamp: 'lr 10/27/2008 11:29'!isUnresolved	^ true! !!PPUnresolvedParser methodsFor: 'parsing' stamp: 'lr 2/7/2010 20:51'!parseOn: aStream	self error: self printString , ' need to be resolved before execution.'! !!PPToken class methodsFor: 'initialization' stamp: 'lr 11/29/2011 20:42'!initialize	"Platform independent newline sequence. LF: Unix, CR+LF: Windows, and CR: Apple."	NewLineParser := (Character lf asParser) / (Character cr asParser , Character lf asParser optional)! !!PPToken class methodsFor: 'instance creation' stamp: 'lr 4/6/2010 20:58'!new	self error: 'Token can only be created using a dedicated constructor.'! !!PPToken class methodsFor: 'instance creation' stamp: 'lr 2/25/2013 23:36'!on: aSequenceableCollection	^ self on: aSequenceableCollection start: 1 stop: aSequenceableCollection size value: nil! !!PPToken class methodsFor: 'instance creation' stamp: 'lr 2/25/2013 23:39'!on: aSequenceableCollection start: aStartInteger stop: aStopInteger value: anObject	^ self basicNew 		initializeOn: aSequenceableCollection		start: aStartInteger stop: aStopInteger		value: anObject! !!PPToken methodsFor: 'comparing' stamp: 'lr 2/26/2013 00:34'!= anObject	^ self class = anObject class and: [ self parsedValue = anObject parsedValue ]! !!PPToken methodsFor: 'accessing' stamp: 'lr 6/15/2010 23:34'!collection	"Answer the underlying collection of this token."	^ collection! !!PPToken methodsFor: 'querying' stamp: 'lr 9/7/2011 20:40'!column	"Answer the column number of this token in the underlying collection."		| position |	position := 0.	(NewLineParser , [ :stream |		start <= stream position			ifTrue: [ ^ start - position ].		position := stream position ] asParser		/ #any asParser) star			parse: collection.	 ^ start - position! !!PPToken methodsFor: 'copying' stamp: 'lr 2/26/2013 00:34'!copyFrom: aStartInteger to: aStopInteger	^ self class on: collection start: start + aStartInteger - 1 stop: stop + aStopInteger - 3 value: value! !!PPToken methodsFor: 'comparing' stamp: 'lr 2/26/2013 00:34'!hash	^ self parsedValue hash! !!PPToken methodsFor: 'initialization' stamp: 'lr 2/25/2013 23:36'!initializeOn: aSequenceableCollection start: aStartInteger stop: aStopInteger value: anObject	collection := aSequenceableCollection.	start := aStartInteger.	stop := aStopInteger.	value := anObject! !!PPToken methodsFor: 'accessing-values' stamp: 'lr 2/26/2013 00:32'!inputValue	"Answer the consumed input of this token."	^ collection copyFrom: start to: stop! !!PPToken methodsFor: 'querying' stamp: 'lr 9/7/2011 20:41'!line	"Answer the line number of this token in the underlying collection."		| line |	line := 1.	(NewLineParser , [ :stream |		start <= stream position			ifTrue: [ ^ line ].		line := line + 1 ] asParser		/ #any asParser) star			parse: collection.	^ line! !!PPToken methodsFor: 'accessing-values' stamp: 'lr 2/26/2013 00:32'!parsedValue	"Answer the parsed value of this token."	^ value! !!PPToken methodsFor: 'printing' stamp: 'lr 2/26/2013 00:37'!printOn: aStream	super printOn: aStream.	aStream nextPut: $[; print: self start; nextPut: $,; print: self stop; nextPut: $].	aStream nextPut: $(; print: self parsedValue; nextPut: $)! !!PPToken methodsFor: 'accessing' stamp: 'lr 2/25/2013 23:56'!size	"Answer the size of this token in the underlying collection."	^ stop - start + 1! !!PPToken methodsFor: 'accessing' stamp: 'lr 6/15/2010 23:33'!start	"Answer the start position of this token in the underlying collection."	^ start! !!PPToken methodsFor: 'accessing' stamp: 'lr 6/15/2010 23:33'!stop	"Answer the stop position of this token in the underlying collection."		^ stop! !!PPToken methodsFor: 'accessing-values' stamp: 'lr 2/26/2013 00:34'!value	self notify: 'Token>>#value is no longer supported. Instead use Token>>#inputValue or the more pragmatic #parsedValue.'.	^ self inputValue! !!Symbol methodsFor: '*petitparser-core-converting' stamp: 'lr 12/18/2011 15:58'!asParser	"Answer a predicate parser named after the receiving symbol. Possible symbols are the method selectors on the class-side of PPPredicateObjectParser."	^ PPPredicateObjectParser perform: self! !!UndefinedObject methodsFor: '*petitparser-converting' stamp: 'lr 11/29/2011 20:49'!asParser	"Answer a parser that succeeds and does not consume anything."		^ PPEpsilonParser new! !!String methodsFor: '*petitparser-core-converting' stamp: 'lr 11/29/2011 20:48'!asParser	"Answer a parser that accepts the receiving string."	^ PPLiteralSequenceParser on: self! !!SequenceableCollection methodsFor: '*petitparser-core-converting' stamp: 'lr 2/7/2010 20:53'!asPetitStream	^ PPStream on: self! !!PPStream methodsFor: 'converting' stamp: 'lr 2/7/2010 20:53'!asPetitStream	^ self! !!PPStream methodsFor: 'accessing' stamp: 'lr 2/13/2012 20:25'!collection	"Answer the underlying collection."		^ collection! !!PPStream methodsFor: 'accessing' stamp: 'lr 4/29/2008 21:48'!peek	"An improved version of peek, that is slightly faster than the built in version."	^ self atEnd ifFalse: [ collection at: position + 1 ]! !!PPStream methodsFor: 'accessing' stamp: 'lr 8/25/2010 11:36'!position: anInteger	"The receiver does not check for invalid arguments passed to this method, as it is solely used with valid indexes for backtracking."	position := anInteger! !!PPStream methodsFor: 'printing' stamp: 'lr 11/4/2010 19:23'!printOn: aStream	collection isString		ifFalse: [ ^ super printOn: aStream ].	aStream		nextPutAll: (collection copyFrom: 1 to: position);		nextPutAll: '';		nextPutAll: (collection copyFrom: position + 1 to: readLimit)! !!PPStream methodsFor: 'accessing' stamp: 'lr 10/5/2010 16:29'!uncheckedPeek	"An unchecked version of peek that throws an error if we try to peek over the end of the stream, even faster than #peek."	^ collection at: position + 1! !!Character methodsFor: '*petitparser-core-operators' stamp: 'lr 6/12/2010 09:04'!- aCharacter	"Create a range of characters between the receiver and the argument."		^ PPPredicateObjectParser between: self and: aCharacter! !!Character methodsFor: '*petitparser-core-converting' stamp: 'lr 12/18/2011 15:58'!asParser	"Answer a parser that accepts the receiving character."		^ PPLiteralObjectParser on: self! !!Text methodsFor: '*petitparser-core-converting' stamp: 'lr 2/7/2010 20:53'!asPetitStream	^ string asPetitStream! !!Collection methodsFor: '*petitparser-core-converting' stamp: 'lr 11/29/2011 20:38'!asChoiceParser	^ PPChoiceParser withAll: (self collect: [ :each | each asParser ])! !!Collection methodsFor: '*petitparser-core-converting' stamp: 'lr 11/29/2011 20:38'!asSequenceParser	^ PPSequenceParser withAll: (self collect: [ :each | each asParser ])! !!BlockClosure methodsFor: '*petitparser-core-converting' stamp: 'lr 11/29/2011 20:48'!asParser	"Answer a parser implemented in the receiving one-argument block."	^ PPPluggableParser on: self! !"PetitParser"!!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 7/15/2017 19:32' prior: 54253055!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 7/15/2017 20:21' prior: 36397258!handlesMouseDown: evt		^true.! !----SNAPSHOT----2017-07-15T20:22:29.323419-03:00 Pharo6.0.image priorSource: 383344!!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 7/15/2017 20:23' prior: 36397395!handlesMouseDown: evt		^false.! !----SNAPSHOT----2017-07-15T20:25:42.379419-03:00 Pharo6.0.image priorSource: 2842997!----SNAPSHOT----2017-07-15T20:26:06.380419-03:00 Pharo6.0.image priorSource: 2843220!!PLC_CIAA_FileSystem methodsFor: 'initialize-release' stamp: 'EricPernia 6/23/2019 00:40' prior: 34384091!initialize 	"Inicializaciones"		"Carpeta Firmware default"		firmwarePath := '..' , self ds , 'workspaces' , self ds , 'firmware_v3'.				"Por default inicia para windows"	os := 'windows'.		"Inicializo o refrezco los dems si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 00:45' prior: 36397617!handlesMouseDown: evt		^false.! !!PLC_CIAA_FileSystem methodsFor: 'windows' stamp: 'EricPernia 6/23/2019 01:02' prior: 34389097!windowsConfig 	"Configuro los Paths para windows"			"Por default inicia para windows"	os := 'windows'.		"Carpeta Firmware "		firmwarePath := '..' , self ds , 'workspaces' , self ds , 'firmware_v3'.			"Inicializo o refrezco los dems si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		! !!PLC_CIAA_FileSystem methodsFor: 'windows' stamp: 'EricPernia 6/23/2019 01:20' prior: 36398482!windowsConfig 	"Configuro los Paths para windows"			"Por default inicia para windows"	os := 'windows'.		"Carpeta Firmware "		firmwarePath := 'firmware_v3'.	"firmwarePath := '..' , self ds , 'workspaces' , self ds , 'firmware_v3'."		"Inicializo o refrezco los dems si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		! !!PLC_CIAA_FileSystem methodsFor: 'unix' stamp: 'EricPernia 6/23/2019 01:24' prior: 34384548!linuxConfig 	"Configuro los Paths para linux"		"Por default inicia para windows"	os := 'linux'.		"Carpeta Firmware "		firmwarePath := 'firmware_v3'.				"Inicializo o refrezco los demas si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		"Path a los scripts que compilan y bajan a la placa"	scriptsPath := 'shared' , self ds , 'IDE4PLC_files' , self ds , 'Boards' , 		self ds , PLC_DevicePLC current deviceName , self ds , 'Scripts'.! !!PLC_CIAA_FileSystem methodsFor: 'unix' stamp: 'EricPernia 6/23/2019 01:24' prior: 34385232!macOsXConfig 	"Configuro los Paths para MAC"			"Por default inicia para windows"	os := 'macOsX'.		"Carpeta Firmware "		firmwarePath := 'firmware_v3'.			"Inicializo o refrezco los dems si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 01:49' prior: 36398350!handlesMouseDown: evt		^false.! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 6/23/2019 01:59' prior: 34386688!refreshPaths 	"Refresca los Paths en base a la ubicacion de la carpeta Firmware y del sistema operativo"		"Path gen del CIAA Firmware"	genPath := firmwarePath , self ds , 'out' , self ds , 'gen'.	"Ruta de plc_application"	plcApplicationPath := '..' , self ds , 'workspaces' , self ds , 'ide4plc-ws' , self ds , 'plc_application'.		"Ruta de src donde pone todos los .c generados, 	como genera necesita la / al final, los copiados no"	srcPath := plcApplicationPath , self ds , 'src' , self ds.	"Ruta de inc donde pone todos los .h generados"	incPath := plcApplicationPath , self ds , 'inc' , self ds.		"Ruta de destino del plc_application.oil"	etcPath := plcApplicationPath , self ds , 'etc'.	"Ruta destino de Makefile"	makPath := plcApplicationPath , self ds , 'mak'.		"Path a los archivos que tiene que copiar Makefile y plc_application.oil"	cCodePath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'C_Code'.		"Path a los archivos que tiene que copiar de OSEK, los que se generan a partir del .oil"	osekGenPath := cCodePath , self ds , 'osekGen'.		"Path a los scripts que compilan y bajan a la placa"	scriptsPath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'Scripts'.		"Path a las imagenes de la GUI"	guiImagesPath :=  'IDE4PLC_files' , self ds , 'GUI_Images'. 		"Path a donde genera IL"	ilExportPath := 'IL_Export'.! !!PLC_CIAA_FileSystem methodsFor: 'initialize-release' stamp: 'EricPernia 6/23/2019 02:08' prior: 36397934!initialize 	"Inicializaciones"		"Carpeta Firmware default"		"firmwarePath := '..' , self ds , 'workspaces' , self ds , 'firmware_v3'."			"Por default inicia para windows"	os := 'windows'.		"Inicializo o refrezco los dems si cambio el Sistema Operativo	o el path del firmware."	self refreshPaths.		! !!PLC_CIAA_FileSystem methodsFor: 'initialize-release' stamp: 'EricPernia 6/23/2019 02:13' prior: 36401998!initialize 	"Inicializaciones"	"Por default inicia para windows"	self windowsConfig.		! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 02:19' prior: 36400306!handlesMouseDown: evt		^false.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/23/2019 04:49' prior: 34721869!createCProjectFor: aSoftConfig	"Crea los archivos .C y .H Crea los archivos Proyecto en C que tiene el	 Programa Completo de usuario (Configuracin de Software implementada en C)."		"Copio las carpetas src e inc de OSEK generadas desde el .oil"	"self createOsekGenFilesFor: aSoftConfig."		"Creo las carpetas plc_application "	self createCFolders.		"Copio el Makefile"	self createMakefileFor: aSoftConfig.	"Copio el archivo OIL"	"self createEtcFilesFor: aSoftConfig."	"Creo los archivos C"	self createSrcFilesFor: aSoftConfig.	"Creo los archivos H"	self createIncFilesFor: aSoftConfig.! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 6/23/2019 04:51' prior: 34380436!createCFolders	"Crea las carpetas del proyecto con FileSystem"	| working folder |	"Directorio de trabajo, en este caso IDE4PLC"	working := FileSystem disk workingDirectory.		"Creo la carpeta IDE4PLC/IDE4PLC_user_projects/plc_application, si exite primero borra la anterior"		folder := ( working / plcApplicationPath ).		( folder exists )		ifTrue: [						( (working / srcPath) exists )				ifTrue: [					GrowlMorph 						openWithLabel: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 label' translated						contents: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents1' translated , '' , 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents2' translated , plcApplicationPath asString.				]							ifFalse: [					GrowlMorph 						openWithLabel: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 label' translated						contents: 'CIAA FileSystem -> GrowlMorph -> Compilation 1 contents2' translated , plcApplicationPath asString.				].					folder deleteAll.				].		folder createDirectory.			"Creo la carpeta Firmware/out/gen/plc_application/etc"	"( working / etcPath ) createDirectory."	"Creo la carpeta Firmware/out/gen/plc_application/inc"	( working / incPath ) createDirectory.	"Creo la carpeta Firmware/out/gen/plc_application/mak"	"( working / makPath ) createDirectory."	"Creo la carpeta Firmware/out/gen/plc_application/src"	( working / srcPath ) createDirectory.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/23/2019 04:52' prior: 36402754!createCProjectFor: aSoftConfig	"Crea los archivos .C y .H Crea los archivos Proyecto en C que tiene el	 Programa Completo de usuario (Configuracin de Software implementada en C)."		"Copio las carpetas src e inc de OSEK generadas desde el .oil"	"self createOsekGenFilesFor: aSoftConfig."		"Creo las carpetas plc_application "	self createCFolders.		"Copio el Makefile"	"self createMakefileFor: aSoftConfig."		"Copio el Makefile"	self createMakefileFor: aSoftConfig.	"Copio el archivo OIL"	"self createEtcFilesFor: aSoftConfig."	"Creo los archivos C"	self createSrcFilesFor: aSoftConfig.	"Creo los archivos H"	self createIncFilesFor: aSoftConfig.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/23/2019 04:52' prior: 36404980!createCProjectFor: aSoftConfig	"Crea los archivos .C y .H Crea los archivos Proyecto en C que tiene el	 Programa Completo de usuario (Configuracin de Software implementada en C)."		"Copio las carpetas src e inc de OSEK generadas desde el .oil"	"self createOsekGenFilesFor: aSoftConfig."		"Creo las carpetas plc_application "	self createCFolders.		"Copio el Makefile"	"self createMakefileFor: aSoftConfig."		"Copio el Makefile"	self createConfigMkFileeFor: aSoftConfig.	"Copio el archivo OIL"	"self createEtcFilesFor: aSoftConfig."	"Creo los archivos C"	self createSrcFilesFor: aSoftConfig.	"Creo los archivos H"	self createIncFilesFor: aSoftConfig.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/23/2019 04:52' prior: 36405752!createCProjectFor: aSoftConfig	"Crea los archivos .C y .H Crea los archivos Proyecto en C que tiene el	 Programa Completo de usuario (Configuracin de Software implementada en C)."		"Copio las carpetas src e inc de OSEK generadas desde el .oil"	"self createOsekGenFilesFor: aSoftConfig."		"Creo las carpetas plc_application "	self createCFolders.		"Copio el Makefile"	"self createMakefileFor: aSoftConfig."		"Copio el Makefile"	self createConfigMkFileFor: aSoftConfig.	"Copio el archivo OIL"	"self createEtcFilesFor: aSoftConfig."	"Creo los archivos C"	self createSrcFilesFor: aSoftConfig.	"Creo los archivos H"	self createIncFilesFor: aSoftConfig.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/23/2019 04:53'!createConfigMkFileFor: aSoftConfig	"Grabo el archivo Makefile"		|  working |	"Obtengo el recurso actual. Por ahora tengo uno solo."		"resource := aSoftConfig resources first.			self fileSystem		write: resource makefile 		in: self fileSystem makPath 		in: 'Makefile'."			working := FileSystem disk workingDirectory.		"Copio y pego"	working / self fileSystem cCodePath / 'Makefile'		copyTo: 			working / self fileSystem makPath / 'Makefile'.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/23/2019 04:54' prior: 36407289!createConfigMkFileFor: aSoftConfig	"Grabo el archivo Makefile"		|  working |	"Obtengo el recurso actual. Por ahora tengo uno solo."		"resource := aSoftConfig resources first.			self fileSystem		write: resource makefile 		in: self fileSystem makPath 		in: 'Makefile'."			working := FileSystem disk workingDirectory.		"Copio y pego"	"working / self fileSystem cCodePath / 'Makefile'		copyTo: 			working / self fileSystem makPath / 'Makefile'."	working / self fileSystem cCodePath / 'Makefile'		copyTo: 			working / self fileSystem makPath / 'Makefile'.! !!PLC_CompilerAndWriter methodsFor: 'c compile' stamp: 'EricPernia 6/23/2019 04:55' prior: 36407853!createConfigMkFileFor: aSoftConfig	"Grabo el archivo Makefile"		|  working |	"Obtengo el recurso actual. Por ahora tengo uno solo."		"resource := aSoftConfig resources first.			self fileSystem		write: resource makefile 		in: self fileSystem makPath 		in: 'Makefile'."			working := FileSystem disk workingDirectory.		"Copio y pego"	"working / self fileSystem cCodePath / 'Makefile'		copyTo: 			working / self fileSystem makPath / 'Makefile'."	working / self fileSystem cCodePath / 'config.mk'		copyTo: 			working / self fileSystem makPath / 'config.mk'.! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 6/23/2019 04:58' prior: 36400435!refreshPaths 	"Refresca los Paths en base a la ubicacion de la carpeta Firmware y del sistema operativo"		"Path gen del CIAA Firmware"	genPath := firmwarePath , self ds , 'out' , self ds , 'gen'.	"Ruta de plc_application"	plcApplicationPath := '..' , self ds , 'workspaces' , self ds , 'ide4plc-ws' , self ds , 'plc_application'.		"Ruta de src donde pone todos los .c generados, 	como genera necesita la / al final, los copiados no"	srcPath := plcApplicationPath , self ds , 'src' , self ds.	"Ruta de inc donde pone todos los .h generados"	incPath := plcApplicationPath , self ds , 'inc' , self ds.		"Ruta de destino del plc_application.oil"	"etcPath := plcApplicationPath , self ds , 'etc'."	"Ruta destino de Makefile"	"makPath := plcApplicationPath , self ds , 'mak'."		"Ruta destino de config.mk"		makPath := plcApplicationPath.		"Path a los archivos que tiene que copiar Makefile y plc_application.oil"	cCodePath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'C_Code'.		"Path a los archivos que tiene que copiar de OSEK, los que se generan a partir del .oil"	osekGenPath := cCodePath , self ds , 'osekGen'.		"Path a los scripts que compilan y bajan a la placa"	scriptsPath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'Scripts'.		"Path a las imagenes de la GUI"	guiImagesPath :=  'IDE4PLC_files' , self ds , 'GUI_Images'. 		"Path a donde genera IL"	ilExportPath := 'IL_Export'.! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 6/23/2019 04:59' prior: 36409206!refreshPaths 	"Refresca los Paths en base a la ubicacion de la carpeta Firmware y del sistema operativo"		"Path gen del CIAA Firmware"	genPath := firmwarePath , self ds , 'out' , self ds , 'gen'.	"Ruta de plc_application"	plcApplicationPath := '..' , self ds , 'workspaces' , self ds , 'ide4plc-ws' , self ds , 'plc_application'.		"Ruta de src donde pone todos los .c generados, 	como genera necesita la / al final, los copiados no"	srcPath := plcApplicationPath , self ds , 'src' , self ds.	"Ruta de inc donde pone todos los .h generados"	incPath := plcApplicationPath , self ds , 'inc' , self ds.		"Ruta de destino del plc_application.oil"	"etcPath := plcApplicationPath , self ds , 'etc'."	"Ruta destino de Makefile"	"makPath := plcApplicationPath , self ds , 'mak'."		"Ruta destino de config.mk"		makPath := plcApplicationPath.		"Path a los archivos que tiene que copiar Makefile y plc_application.oil"	cCodePath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'C_Code'.		"Path a los archivos que tiene que copiar de OSEK, los que se generan a partir del .oil"	"osekGenPath := cCodePath , self ds , 'osekGen'."		"Path a los scripts que compilan y bajan a la placa"	scriptsPath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'Scripts'.		"Path a las imagenes de la GUI"	guiImagesPath :=  'IDE4PLC_files' , self ds , 'GUI_Images'. 		"Path a donde genera IL"	ilExportPath := 'IL_Export'.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 05:06' prior: 36402618!handlesMouseDown: evt		^false.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 06:59' prior: 34619763!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2019, Eric Nicols Pernia * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//*==================[inclusions]=============================================*/#include "sapi.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main(void){   // ---------- CONFIGURACIONES ------------------------------   // Inicializar y configurar la plataforma   boardInit();   // FUNCION que inicializa el planificador de tareas   schedulerInit();   // Se agrega la tarea tarea1 al planificador   schedulerAddTask( task1_Update, // funcion de tarea a agregar                     0,            // parametro de la tarea                     0,            // offset de ejecucion en ticks                     100           // periodicidad de ejecucion en ticks                   );   // FUNCION que inicializa la interrupcion que ejecuta el planificador de   // tareas con tick cada 1ms.   schedulerStart( 1 );   // ---------- REPETIR POR SIEMPRE --------------------------   while( TRUE )   {      // Se despachan (ejecutan) las tareas marcadas para su ejecucion.      // Luego se pone el sistema en bajo consumo hasta que ocurra la      // proxima interrupcion, en este caso la de Tick.      // Al ocurrir la interrupcion de Tick se ejecutara el planificador      // que revisa cuales son las tareas a marcar para su ejecucion.      schedulerDispatchTasks();   }   // NO DEBE LLEGAR NUNCA AQUI, debido a que a este programa se ejecuta   // directamenteno sobre un microcontroladore y no es llamado por ningun   // Sistema Operativo, como en el caso de un programa para PC.   return 0;}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:01' prior: 34646363!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "os.h"               /* <= operating system header */#include "ciaaPOSIX_stdio.h"  /* <= device handler header */#include "ciaaPOSIX_string.h" /* <= string header */#include "ciaak.h"            /* <= ciaa kernel header */#include "PLC_App_Lib.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is started automatically in the application mode 1. */TASK(InitTask){       /* init CIAA kernel and devices */   ciaak_start();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;	   /* activate PLC_SystemTask task:    *  - for the first time after 1 ticks (1 ms)    *  - and then every 10 ticks (10 ms)    */   SetRelAlarm(ActivatePLC_SystemTask, 1, 10);	   /* activate periodic task:    *  - for the first time after 10 ticks (10 ms)    *  - and then every 20 ticks (20 ms)    */   SetRelAlarm(ActivatePeriodicTask, 10, 20);      /* terminate task */   TerminateTask();}/** \brief PLC_System Task * * This task is started automatically every time 10 ms * */void PLC_SystemTask( void* ){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;        /* terminate task */   TerminateTask();}/** \brief Periodic Task * * This task is started automatically every time that the alarm * ActivatePeriodicTask expires. This tasks calles the code generated * in IDE4PLC. * */TASK(PeriodicTask){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);      /* terminate task */   TerminateTask();}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:03' prior: 36417659!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "os.h"               /* <= operating system header */#include "ciaaPOSIX_stdio.h"  /* <= device handler header */#include "ciaaPOSIX_string.h" /* <= string header */#include "ciaak.h"            /* <= ciaa kernel header */#include "PLC_App_Lib.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is started automatically in the application mode 1. */TASK(InitTask){       /* init CIAA kernel and devices */   ciaak_start();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;	   /* activate PLC_SystemTask task:    *  - for the first time after 1 ticks (1 ms)    *  - and then every 10 ticks (10 ms)    */   SetRelAlarm(ActivatePLC_SystemTask, 1, 10);	   /* activate periodic task:    *  - for the first time after 10 ticks (10 ms)    *  - and then every 20 ticks (20 ms)    */   SetRelAlarm(ActivatePeriodicTask, 10, 20);      /* terminate task */   TerminateTask();}/** \brief PLC_System Task * * This task is started automatically every time 10 ms * */void PLC_SystemTask( void* ){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;}/** \brief Periodic Task * * This task is started automatically every 10 ms * */void PeriodicTask( void* ){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:05' prior: 36421540!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "sapi.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is executed 1 time. */void InitTask( void ){   boardInit();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;}/** \brief PLC_System Task * * This task is started automatically every time 10 ms * */void PLC_SystemTask( void* ){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;}/** \brief Periodic Task * * This task is started automatically every 10 ms * */void PeriodicTask( void* ){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 6/23/2019 07:07' prior: 34650315!cUserTasksH	" Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.h "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan los prototipos de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*/#ifndef PLC_USER_TASKS_H_	#define PLC_USER_TASKS_H_	/* Prototipos de funciones de tareas de RTOS que implementan las Tareas del PLC. */	   void InitTask( void );   void PeriodicTask( void* );   void PLC_SystemTask( void* );'.		"self taskConfigurations do: [ :each |		cCode := cCode , each cCompilePrototype.		]."		cCode := cCode , '	#endif /* PLC_USER_TASKS_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:07' prior: 36412579!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2019, Eric Nicols Pernia * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//*==================[inclusions]=============================================*/#include "sapi.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main(void){   // ---------- CONFIGURACIONES ------------------------------   // Inicializar y configurar la plataforma   boardInit();   // FUNCION que inicializa el planificador de tareas   schedulerInit();   // Se agrega la tarea tarea1 al planificador   schedulerAddTask( task1_Update, // funcion de tarea a agregar                     0,            // parametro de la tarea                     0,            // offset de ejecucion en ticks                     100           // periodicidad de ejecucion en ticks                   );   // FUNCION que inicializa la interrupcion que ejecuta el planificador de   // tareas con tick cada 1ms.   schedulerStart( 1 );   // ---------- REPETIR POR SIEMPRE --------------------------   while( TRUE )   {      // Se despachan (ejecutan) las tareas marcadas para su ejecucion.      // Luego se pone el sistema en bajo consumo hasta que ocurra la      // proxima interrupcion, en este caso la de Tick.      // Al ocurrir la interrupcion de Tick se ejecutara el planificador      // que revisa cuales son las tareas a marcar para su ejecucion.      schedulerDispatchTasks();   }   // NO DEBE LLEGAR NUNCA AQUI, debido a que a este programa se ejecuta   // directamenteno sobre un microcontroladore y no es llamado por ningun   // Sistema Operativo, como en el caso de un programa para PC.   return 0;}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:08' prior: 36429291!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2019, Eric Nicols Pernia * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//*==================[inclusions]=============================================*/#include "sapi.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main(void){   // ---------- CONFIGURACIONES ------------------------------   // Inicializar y configurar la plataforma   boardInit();   InitTask();   void PeriodicTask( void* );   void PLC_SystemTask( void* );   // FUNCION que inicializa el planificador de tareas   schedulerInit();   // Se agrega la tarea tarea1 al planificador   schedulerAddTask( task1_Update, // funcion de tarea a agregar                     0,            // parametro de la tarea                     0,            // offset de ejecucion en ticks                     100           // periodicidad de ejecucion en ticks                   );   // FUNCION que inicializa la interrupcion que ejecuta el planificador de   // tareas con tick cada 1ms.   schedulerStart( 1 );   // ---------- REPETIR POR SIEMPRE --------------------------   while( TRUE )   {      // Se despachan (ejecutan) las tareas marcadas para su ejecucion.      // Luego se pone el sistema en bajo consumo hasta que ocurra la      // proxima interrupcion, en este caso la de Tick.      // Al ocurrir la interrupcion de Tick se ejecutara el planificador      // que revisa cuales son las tareas a marcar para su ejecucion.      schedulerDispatchTasks();   }   // NO DEBE LLEGAR NUNCA AQUI, debido a que a este programa se ejecuta   // directamenteno sobre un microcontroladore y no es llamado por ningun   // Sistema Operativo, como en el caso de un programa para PC.   return 0;}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:10' prior: 36434373!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2019, Eric Nicols Pernia * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//*==================[inclusions]=============================================*/#include "sapi.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main(void){   // ---------- CONFIGURACIONES ------------------------------   InitTask();   // FUNCION que inicializa el planificador de tareas   schedulerInit();   // Se agrega la tarea tarea1 al planificador   schedulerAddTask( PLC_SystemTask, // funcion de tarea a agregar                     0,              // parametro de la tarea                     0,              // offset de ejecucion en ticks                     10              // periodicidad de ejecucion en ticks                   );   schedulerAddTask( PeriodicTask, // funcion de tarea a agregar                     0,              // parametro de la tarea                     01,              // offset de ejecucion en ticks                     10              // periodicidad de ejecucion en ticks                   );   // FUNCION que inicializa la interrupcion que ejecuta el planificador de   // tareas con tick cada 1ms.   schedulerStart( 1 );   // ---------- REPETIR POR SIEMPRE --------------------------   while( TRUE )   {      // Se despachan (ejecutan) las tareas marcadas para su ejecucion.      // Luego se pone el sistema en bajo consumo hasta que ocurra la      // proxima interrupcion, en este caso la de Tick.      // Al ocurrir la interrupcion de Tick se ejecutara el planificador      // que revisa cuales son las tareas a marcar para su ejecucion.      schedulerDispatchTasks();   }   // NO DEBE LLEGAR NUNCA AQUI, debido a que a este programa se ejecuta   // directamenteno sobre un microcontroladore y no es llamado por ningun   // Sistema Operativo, como en el caso de un programa para PC.   return 0;}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:11' prior: 36439535!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2019, Eric Nicols Pernia * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//*==================[inclusions]=============================================*/#include "sapi.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main(void){   // ---------- CONFIGURACIONES ------------------------------   InitTask();   // FUNCION que inicializa el planificador de tareas   schedulerInit();   // Se agrega la tarea tarea1 al planificador   schedulerAddTask( PLC_SystemTask, // funcion de tarea a agregar                     0,              // parametro de la tarea                     0,              // offset de ejecucion en ticks                     10              // periodicidad de ejecucion en ticks                   );   schedulerAddTask( PeriodicTask, // funcion de tarea a agregar                     0,            // parametro de la tarea                     1,            // offset de ejecucion en ticks                     10            // periodicidad de ejecucion en ticks                   );   // FUNCION que inicializa la interrupcion que ejecuta el planificador de   // tareas con tick cada 1ms.   schedulerStart( 1 );   // ---------- REPETIR POR SIEMPRE --------------------------   while( TRUE )   {      // Se despachan (ejecutan) las tareas marcadas para su ejecucion.      // Luego se pone el sistema en bajo consumo hasta que ocurra la      // proxima interrupcion, en este caso la de Tick.      // Al ocurrir la interrupcion de Tick se ejecutara el planificador      // que revisa cuales son las tareas a marcar para su ejecucion.      schedulerDispatchTasks();   }   // NO DEBE LLEGAR NUNCA AQUI, debido a que a este programa se ejecuta   // directamenteno sobre un microcontroladore y no es llamado por ningun   // Sistema Operativo, como en el caso de un programa para PC.   return 0;}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:17' prior: 36425232!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "sapi.h"#include "PLC_Lib.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is executed 1 time. */void InitTask( void ){   boardInit();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;}/** \brief PLC_System Task * * This task is started automatically every time 10 ms * */void PLC_SystemTask( void* ){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;}/** \brief Periodic Task * * This task is started automatically every 10 ms * */void PeriodicTask( void* ){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:22' prior: 36444874!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2019, Eric Nicols Pernia * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//*==================[inclusions]=============================================*/#include "sapi.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main( void ){   // ---------- CONFIGURACIONES ------------------------------   InitTask();   // FUNCION que inicializa el planificador de tareas   schedulerInit();   // Se agrega la tarea tarea1 al planificador   schedulerAddTask( PLC_SystemTask, // funcion de tarea a agregar                     0,              // parametro de la tarea                     0,              // offset de ejecucion en ticks                     10              // periodicidad de ejecucion en ticks                   );   schedulerAddTask( PeriodicTask, // funcion de tarea a agregar                     0,            // parametro de la tarea                     1,            // offset de ejecucion en ticks                     10            // periodicidad de ejecucion en ticks                   );   // FUNCION que inicializa la interrupcion que ejecuta el planificador de   // tareas con tick cada 1ms.   schedulerStart( 1 );   // ---------- REPETIR POR SIEMPRE --------------------------   while( TRUE )   {      // Se despachan (ejecutan) las tareas marcadas para su ejecucion.      // Luego se pone el sistema en bajo consumo hasta que ocurra la      // proxima interrupcion, en este caso la de Tick.      // Al ocurrir la interrupcion de Tick se ejecutara el planificador      // que revisa cuales son las tareas a marcar para su ejecucion.      schedulerDispatchTasks();   }   // NO DEBE LLEGAR NUNCA AQUI, debido a que a este programa se ejecuta   // directamenteno sobre un microcontroladore y no es llamado por ningun   // Sistema Operativo, como en el caso de un programa para PC.   return 0;}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:27' prior: 36450206!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "sapi.h"#include "plc_application.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is executed 1 time. */void InitTask( void ){   boardInit();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;}/** \brief PLC_System Task * * This task is started automatically every time 10 ms * */void PLC_SystemTask( void* ){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;}/** \brief Periodic Task * * This task is started automatically every 10 ms * */void PeriodicTask( void* ){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:27' prior: 36458533!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "plc_application.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is executed 1 time. */void InitTask( void ){   boardInit();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;}/** \brief PLC_System Task * * This task is started automatically every time 10 ms * */void PLC_SystemTask( void* ){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;}/** \brief Periodic Task * * This task is started automatically every 10 ms * */void PeriodicTask( void* ){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 6/23/2019 07:28' prior: 34625387!cApplicationH	" Devuelve un String con el Cdigo C que va en el archivo plc_application.h"	| cCode |		cCode := '/* Copyright 2014, Mariano Cerdeiro * Copyright 2014, Pablo Ridolfi * Copyright 2014, Juan Cecconi * Copyright 2014, Gustavo Muro * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/#ifndef PLC_APPLICATION_H#define PLC_APPLICATION_H/** \brief PLC Application header file ** ** This is the PLC Application header of the CIAA Firmware ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//* * Initials     Name * --------------------------- * MaCe         Mariano Cerdeiro *//* * modification history (new versions first) * ----------------------------------------------------------- * 20150404 v0.0.1 MaCe initial version *//*==================[inclusions]=============================================*/#include "PLC_App_Lib"#include "PLC_App_Lib"/*==================[macros]=================================================*//*==================[typedef]================================================*//*==================[external data declaration]==============================*//*==================[external functions declaration]=========================*//** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/#endif /* #ifndef PLC_APPLICATION_H */'.	^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 6/23/2019 07:29' prior: 36464521!cApplicationH	" Devuelve un String con el Cdigo C que va en el archivo plc_application.h"	| cCode |		cCode := '/* Copyright 2014, Mariano Cerdeiro * Copyright 2014, Pablo Ridolfi * Copyright 2014, Juan Cecconi * Copyright 2014, Gustavo Muro * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/#ifndef PLC_APPLICATION_H#define PLC_APPLICATION_H/** \brief PLC Application header file ** ** This is the PLC Application header of the CIAA Firmware ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//* * Initials     Name * --------------------------- * MaCe         Mariano Cerdeiro *//* * modification history (new versions first) * ----------------------------------------------------------- * 20150404 v0.0.1 MaCe initial version *//*==================[inclusions]=============================================*/#include "PLC_App_Lib"#include "PLC_CompilerDerivedDataTypes"#include "PLC_StdFunctionBlocks"#include "PLC_StdFunctions"#include "PLC_UserDerivedDataTypes"#include "PLC_UserFunctionBlocks"#include "PLC_UserFunctions"#include "PLC_UserPrograms"#include "PLC_UserTasks"/*==================[macros]=================================================*//*==================[typedef]================================================*//*==================[external data declaration]==============================*//*==================[external functions declaration]=========================*//** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/#endif /* #ifndef PLC_APPLICATION_H */'.	^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:30' prior: 36453200!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2019, Eric Nicols Pernia * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//*==================[inclusions]=============================================*/#include "sapi.h"#include "sapi.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main( void ){   // ---------- CONFIGURACIONES ------------------------------   InitTask();   // FUNCION que inicializa el planificador de tareas   schedulerInit();   // Se agrega la tarea tarea1 al planificador   schedulerAddTask( PLC_SystemTask, // funcion de tarea a agregar                     0,              // parametro de la tarea                     0,              // offset de ejecucion en ticks                     10              // periodicidad de ejecucion en ticks                   );   schedulerAddTask( PeriodicTask, // funcion de tarea a agregar                     0,            // parametro de la tarea                     1,            // offset de ejecucion en ticks                     10            // periodicidad de ejecucion en ticks                   );   // FUNCION que inicializa la interrupcion que ejecuta el planificador de   // tareas con tick cada 1ms.   schedulerStart( 1 );   // ---------- REPETIR POR SIEMPRE --------------------------   while( TRUE )   {      // Se despachan (ejecutan) las tareas marcadas para su ejecucion.      // Luego se pone el sistema en bajo consumo hasta que ocurra la      // proxima interrupcion, en este caso la de Tick.      // Al ocurrir la interrupcion de Tick se ejecutara el planificador      // que revisa cuales son las tareas a marcar para su ejecucion.      schedulerDispatchTasks();   }   // NO DEBE LLEGAR NUNCA AQUI, debido a que a este programa se ejecuta   // directamenteno sobre un microcontroladore y no es llamado por ningun   // Sistema Operativo, como en el caso de un programa para PC.   return 0;}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:31' prior: 36471895!cApplicationC	"Devuelve un String con el Cdigo C que va en el archivo plc_application.c "	| cCode |		cCode := '/* Copyright 2019, Eric Nicols Pernia * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*//** \brief PLC Application source file ** ** This is the PLC Application source ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//*==================[inclusions]=============================================*/#include "plc_application.h"#include "sapi.h"/*==================[macros and definitions]=================================*//*==================[internal data declaration]==============================*//*==================[internal functions declaration]=========================*//*==================[internal data definition]===============================*//*==================[external data definition]===============================*//*==================[internal functions definition]==========================*//*==================[external functions definition]==========================*//** \brief Main function * * This is the main entry point of the software. * * \returns 0 * * \remarks This function never returns. Return value is only to avoid compiler *          warnings or errors. */int main( void ){   // ---------- CONFIGURACIONES ------------------------------   InitTask();   // FUNCION que inicializa el planificador de tareas   schedulerInit();   // Se agrega la tarea tarea1 al planificador   schedulerAddTask( PLC_SystemTask, // funcion de tarea a agregar                     0,              // parametro de la tarea                     0,              // offset de ejecucion en ticks                     10              // periodicidad de ejecucion en ticks                   );   schedulerAddTask( PeriodicTask, // funcion de tarea a agregar                     0,            // parametro de la tarea                     1,            // offset de ejecucion en ticks                     10            // periodicidad de ejecucion en ticks                   );   // FUNCION que inicializa la interrupcion que ejecuta el planificador de   // tareas con tick cada 1ms.   schedulerStart( 1 );   // ---------- REPETIR POR SIEMPRE --------------------------   while( TRUE )   {      // Se despachan (ejecutan) las tareas marcadas para su ejecucion.      // Luego se pone el sistema en bajo consumo hasta que ocurra la      // proxima interrupcion, en este caso la de Tick.      // Al ocurrir la interrupcion de Tick se ejecutara el planificador      // que revisa cuales son las tareas a marcar para su ejecucion.      schedulerDispatchTasks();   }   // NO DEBE LLEGAR NUNCA AQUI, debido a que a este programa se ejecuta   // directamenteno sobre un microcontroladore y no es llamado por ningun   // Sistema Operativo, como en el caso de un programa para PC.   return 0;}/** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/'.	^ cCode."	'/* CREACION DE INSTANCIAS DE TAREAS */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cTaskCreate.		].		cCode := cCode , '"! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:31' prior: 36461536!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "plc_application.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is executed 1 time. */void InitTask( void ){   boardInit();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;}/** \brief PLC_System Task * * This task is started automatically every time 10 ms * */void PLC_SystemTask( void* ){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;}/** \brief Periodic Task * * This task is started automatically every 10 ms * */void PeriodicTask( void* ){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 6/23/2019 07:34' prior: 36468093!cApplicationH	" Devuelve un String con el Cdigo C que va en el archivo plc_application.h"	| cCode |		cCode := '/* Copyright 2014, Mariano Cerdeiro * Copyright 2014, Pablo Ridolfi * Copyright 2014, Juan Cecconi * Copyright 2014, Gustavo Muro * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/#ifndef PLC_APPLICATION_H#define PLC_APPLICATION_H/** \brief PLC Application header file ** ** This is the PLC Application header of the CIAA Firmware ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//* * Initials     Name * --------------------------- * MaCe         Mariano Cerdeiro *//* * modification history (new versions first) * ----------------------------------------------------------- * 20150404 v0.0.1 MaCe initial version *//*==================[inclusions]=============================================*/#include "PLC_App_Lib.h"#include "PLC_CompilerDerivedDataTypes.h"#include "PLC_StdFunctionBlocks.h"#include "PLC_StdFunctions.h"#include "PLC_UserDerivedDataTypes.h"#include "PLC_UserFunctionBlocks.h"#include "PLC_UserFunctions.h"#include "PLC_UserPrograms.h"#include "PLC_UserTasks.h"/*==================[macros]=================================================*//*==================[typedef]================================================*//*==================[external data declaration]==============================*//*==================[external functions declaration]=========================*//** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/#endif /* #ifndef PLC_APPLICATION_H */'.	^ cCode.! !!PLC_Resource methodsFor: 'c src files' stamp: 'EricPernia 6/23/2019 07:48' prior: 36482608!cUserTasksC	"Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.c "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "plc_application.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is executed 1 time. */void InitTask( void ){   boardInit();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;}/** \brief PLC_System Task * * This task is started automatically every time 10 ms * */void PLC_SystemTask( void* ptr ){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;}/** \brief Periodic Task * * This task is started automatically every 10 ms * */void PeriodicTask( void* ptr ){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */' , PLC_DevicePLC current cCodeForDInputs ,'   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			' , PLC_DevicePLC current cCodeForDOutputs ,'   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);}'.		^ cCode."cCode := cCode , 	'	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */'.		self taskConfigurations do: [ :each |		cCode := cCode , each cCompile.		]."! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 6/23/2019 07:48' prior: 36428205!cUserTasksH	" Devuelve un String con el Cdigo C que va en el archivo PLC_UserTasks.h "	| cCode |	 	cCode := '/* ------------------------------------------------------------ * PLC_UserTasks.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan los prototipos de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*/#ifndef PLC_USER_TASKS_H_	#define PLC_USER_TASKS_H_	/* Prototipos de funciones de tareas de RTOS que implementan las Tareas del PLC. */	   void InitTask( void );   void PeriodicTask( void* ptr );   void PLC_SystemTask( void* ptr );'.		"self taskConfigurations do: [ :each |		cCode := cCode , each cCompilePrototype.		]."		cCode := cCode , '	#endif /* PLC_USER_TASKS_H_ */'.		^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 6/23/2019 07:52' prior: 36485593!cApplicationH	" Devuelve un String con el Cdigo C que va en el archivo plc_application.h"	| cCode |		cCode := '/* Copyright 2014, Mariano Cerdeiro * Copyright 2014, Pablo Ridolfi * Copyright 2014, Juan Cecconi * Copyright 2014, Gustavo Muro * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/#ifndef PLC_APPLICATION_H#define PLC_APPLICATION_H/** \brief PLC Application header file ** ** This is the PLC Application header of the CIAA Firmware ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//* * Initials     Name * --------------------------- * MaCe         Mariano Cerdeiro *//* * modification history (new versions first) * ----------------------------------------------------------- * 20150404 v0.0.1 MaCe initial version *//*==================[inclusions]=============================================*/#include "PLC_App_Lib.h"#include "PLC_CompilerDerivedDataTypes.h"#include "PLC_StdFunctionBlocks.h"#include "PLC_StdFunctions.h"#include "PLC_UserDerivedDataTypes.h"#include "PLC_UserFunctionBlocks.h"#include "PLC_UserFunctions.h"#include "PLC_UserPrograms.h"#include "PLC_UserTasks.h"#include "sap.h"/*==================[macros]=================================================*//*==================[typedef]================================================*//*==================[external data declaration]==============================*//*==================[external functions declaration]=========================*//** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/#endif /* #ifndef PLC_APPLICATION_H */'.	^ cCode.! !!PLC_Resource methodsFor: 'c inc files' stamp: 'EricPernia 6/23/2019 07:53' prior: 36493500!cApplicationH	" Devuelve un String con el Cdigo C que va en el archivo plc_application.h"	| cCode |		cCode := '/* Copyright 2014, Mariano Cerdeiro * Copyright 2014, Pablo Ridolfi * Copyright 2014, Juan Cecconi * Copyright 2014, Gustavo Muro * All rights reserved. * * This file is part of CIAA Firmware. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are met: * * 1. Redistributions of source code must retain the above copyright notice, *    this list of conditions and the following disclaimer. * * 2. Redistributions in binary form must reproduce the above copyright notice, *    this list of conditions and the following disclaimer in the documentation *    and/or other materials provided with the distribution. * * 3. Neither the name of the copyright holder nor the names of its *    contributors may be used to endorse or promote products derived from this *    software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. * */ /* ------------------------------------------------------------ * plc_application.h * * Created on: ' , DateAndTime now asString , ' *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/#ifndef PLC_APPLICATION_H#define PLC_APPLICATION_H/** \brief PLC Application header file ** ** This is the PLC Application header of the CIAA Firmware ** **//** \addtogroup CIAA_Firmware CIAA Firmware ** @{ *//** \addtogroup PLC PLC Module ** @{ *//** \addtogroup PLC_Application PLC Application file ** @{ *//* * Initials     Name * --------------------------- * MaCe         Mariano Cerdeiro *//* * modification history (new versions first) * ----------------------------------------------------------- * 20150404 v0.0.1 MaCe initial version *//*==================[inclusions]=============================================*/#include "PLC_App_Lib.h"#include "PLC_CompilerDerivedDataTypes.h"#include "PLC_StdFunctionBlocks.h"#include "PLC_StdFunctions.h"#include "PLC_UserDerivedDataTypes.h"#include "PLC_UserFunctionBlocks.h"#include "PLC_UserFunctions.h"#include "PLC_UserPrograms.h"#include "PLC_UserTasks.h"#include "sapi.h"/*==================[macros]=================================================*//*==================[typedef]================================================*//*==================[external data declaration]==============================*//*==================[external functions declaration]=========================*//** @} doxygen end group definition *//** @} doxygen end group definition *//** @} doxygen end group definition *//*==================[end of file]============================================*/#endif /* #ifndef PLC_APPLICATION_H */'.	^ cCode.! !----SNAPSHOT----2019-06-23T08:15:21.801679-03:00 Pharo6.0.image priorSource: 2843307!!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 6/23/2019 17:00' prior: 36410823!refreshPaths 	"Refresca los Paths en base a la ubicacion de la carpeta Firmware y del sistema operativo"		"Path gen del CIAA Firmware"	"genPath := firmwarePath , self ds , 'out' , self ds , 'gen'."	"Ruta de plc_application"	"plcApplicationPath := '..' , self ds , 'workspaces' , self ds , 'ide4plc-ws' , self ds , 'plc_application'."	plcApplicationPath := firmwarePath , self ds , 'plc_application'.		"Ruta de src donde pone todos los .c generados, 	como genera necesita la / al final, los copiados no"	srcPath := plcApplicationPath , self ds , 'src' , self ds.	"Ruta de inc donde pone todos los .h generados"	incPath := plcApplicationPath , self ds , 'inc' , self ds.		"Ruta de destino del plc_application.oil"	"etcPath := plcApplicationPath , self ds , 'etc'."	"Ruta destino de Makefile"	"makPath := plcApplicationPath , self ds , 'mak'."		"Ruta destino de config.mk"		makPath := plcApplicationPath.		"Path a los archivos que tiene que copiar Makefile y plc_application.oil"	cCodePath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'C_Code'.		"Path a los archivos que tiene que copiar de OSEK, los que se generan a partir del .oil"	"osekGenPath := cCodePath , self ds , 'osekGen'."		"Path a los scripts que compilan y bajan a la placa"	scriptsPath := 'IDE4PLC_files' , self ds , 'Boards' , self ds , PLC_DevicePLC current deviceName , self ds , 'Scripts'.		"Path a las imagenes de la GUI"	guiImagesPath :=  'IDE4PLC_files' , self ds , 'GUI_Images'. 		"Path a donde genera IL"	ilExportPath := 'IL_Export'.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 17:00' prior: 36412450!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 17:10' prior: 36502964!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 18:15' prior: 36503101!handlesMouseDown: evt		^false.! !----SNAPSHOT----2019-06-23T18:15:37.510141-03:00 Pharo6.0.image priorSource: 2946653!----SNAPSHOT----2019-06-23T18:15:46.319141-03:00 Pharo6.0.image priorSource: 2948841!!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:22' prior: 34718558!buildCProgram	"Hace el build del Proyecto en C que tiene el Programa Completo de 	usuario (Configuracin de Software implementada en C) + Entorno de 	Ejecucin."		buildEneable		ifTrue: [			OSProcess command: 'cmd /C start ' , self fileSystem buildFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:23' prior: 36503547!buildCProgram	"Hace el build del Proyecto en C que tiene el Programa Completo de 	usuario (Configuracin de Software implementada en C) + Entorno de 	Ejecucin."		buildEneable		ifTrue: [			OSProcess command: 'cmd /C start ' , self fileSystem buildFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:23' prior: 34718893!buildDownloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	( buildEneable and: [downloadEneable] )		ifTrue: [						"make			make download"			OSProcess command: 'cmd /C start ' , self fileSystem buildDownloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:24' prior: 34720315!cleanCProgram: aSoftConfig	"make clean"		"self cleanCProjectFor: aSoftConfig."		cleanEneable		ifTrue: [			"make clean"			OSProcess command: 'cmd /C start ' , self fileSystem cleanFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:24' prior: 34728142!downloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	downloadEneable		ifTrue: [			"make download"			OSProcess command: 'cmd /C start ' , self fileSystem downloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:29' prior: 36504928!downloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	downloadEneable		ifTrue: [			"make download"			OSProcess command: self fileSystem downloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:29' prior: 36504628!cleanCProgram: aSoftConfig	"make clean"		"self cleanCProjectFor: aSoftConfig."		cleanEneable		ifTrue: [			"make clean"			OSProcess command: self fileSystem cleanFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:30' prior: 36504285!buildDownloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	( buildEneable and: [downloadEneable] )		ifTrue: [						"make			make download"			OSProcess command: self fileSystem buildDownloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:30' prior: 36503916!buildCProgram	"Hace el build del Proyecto en C que tiene el Programa Completo de 	usuario (Configuracin de Software implementada en C) + Entorno de 	Ejecucin."		buildEneable		ifTrue: [			OSProcess command: self fileSystem buildFile.		].! !!PLC_CIAA_FileSystem methodsFor: 'windows' stamp: 'EricPernia 6/23/2019 18:31'!windowsCommand	"Configuro los Paths para windows"	^ 'cmd /C start '! !!PLC_CIAA_FileSystem methodsFor: 'unix' stamp: 'EricPernia 6/23/2019 18:32'!unixCommand	"Configuro los Paths para windows"	^ ''! !!PLC_CIAA_FileSystem methodsFor: 'unix' stamp: 'EricPernia 6/23/2019 18:32' prior: 36506596!unixCommand	"Comando para usar con los targets de make"	^ ''! !!PLC_CIAA_FileSystem methodsFor: 'windows' stamp: 'EricPernia 6/23/2019 18:32' prior: 36506445!windowsCommand	"Comando para usar con los targets de make"	^ 'cmd /C start '! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 6/23/2019 18:33'!osCommand	"Comando para usar con los targets de make"	^ self folderSeparator! !!PLC_CIAA_FileSystem methodsFor: 'file' stamp: 'EricPernia 6/23/2019 18:33' prior: 36507070!osCommand	"Comando para usar con los targets de make"	(os = 'windows')		ifTrue: [			^ self windowsCommand.			]		ifFalse: [			^ self unixCommand.			].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:34' prior: 36506113!buildCProgram	"Hace el build del Proyecto en C que tiene el Programa Completo de 	usuario (Configuracin de Software implementada en C) + Entorno de 	Ejecucin."		buildEneable		ifTrue: [			OSProcess command: self osCommand, self fileSystem buildFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:34' prior: 36505788!buildDownloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	( buildEneable and: [downloadEneable] )		ifTrue: [						"make			make download"			OSProcess command: self osCommand, self fileSystem buildDownloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:34' prior: 36505506!cleanCProgram: aSoftConfig	"make clean"		"self cleanCProjectFor: aSoftConfig."		cleanEneable		ifTrue: [			"make clean"			OSProcess command: self osCommand, self fileSystem cleanFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:34' prior: 36505226!downloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	downloadEneable		ifTrue: [			"make download"			OSProcess command: self osCommand, self fileSystem downloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:35' prior: 36507507!buildCProgram	"Hace el build del Proyecto en C que tiene el Programa Completo de 	usuario (Configuracin de Software implementada en C) + Entorno de 	Ejecucin."		buildEneable		ifTrue: [			OSProcess command: self fileSystem osCommand, self fileSystem buildFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:35' prior: 36507874!buildDownloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	( buildEneable and: [downloadEneable] )		ifTrue: [						"make			make download"			OSProcess command: self fileSystem osCommand, self fileSystem buildDownloadFile.					].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:35' prior: 36508215!cleanCProgram: aSoftConfig	"make clean"		"self cleanCProjectFor: aSoftConfig."		cleanEneable		ifTrue: [			"make clean"			OSProcess command: self fileSystem osCommand, self fileSystem cleanFile.		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:35' prior: 36508513!downloadProgram	"Compila el cdigo C y lo Descarga al dispositivo"	downloadEneable		ifTrue: [			"make download"			OSProcess command: self fileSystem osCommand, self fileSystem downloadFile.					].! !----SNAPSHOT----2019-06-23T18:36:12.209141-03:00 Pharo6.0.image priorSource: 2948928!!PLC_CIAA_FileSystem methodsFor: 'windows' stamp: 'EricPernia 6/23/2019 18:36' prior: 36506910!windowsCommand	"Comando para usar con los targets de make"	^ 'cmd /C start busybox sh '! !!PLC_CIAA_FileSystem methodsFor: 'windows' stamp: 'EricPernia 6/23/2019 18:36' prior: 34389576!windowsScript	"devuelve un string con el tipo de archivo de script de windows"	^ '.sh'.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 18:37' prior: 36503238!handlesMouseDown: evt		^false.! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:43' prior: 36508809!buildCProgram	"Hace el build del Proyecto en C que tiene el Programa Completo de 	usuario (Configuracin de Software implementada en C) + Entorno de 	Ejecucin."		buildEneable		ifTrue: [			OSProcess command: self fileSystem osCommand, 'export BOARD="edu_ciaa_nxp"\cd ${0%/*}\cd ../../../../../\make -C $PWD/firmware_v3'. "self fileSystem buildFile."		].! !!PLC_CompilerAndWriter methodsFor: 'commands' stamp: 'EricPernia 6/23/2019 18:44' prior: 36510759!buildCProgram	"Hace el build del Proyecto en C que tiene el Programa Completo de 	usuario (Configuracin de Software implementada en C) + Entorno de 	Ejecucin."		buildEneable		ifTrue: [			OSProcess command: self fileSystem osCommand, self fileSystem buildFile.		].! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 18:51' prior: 36510624!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/23/2019 19:00' prior: 36511608!handlesMouseDown: evt		^false.! !----SNAPSHOT----2019-06-23T19:01:08.803141-03:00 Pharo6.0.image priorSource: 2955623!----SNAPSHOT----2019-06-23T19:06:53.436059-03:00 Pharo6.0.image priorSource: 2957348!!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/26/2019 20:00' prior: 36511745!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/26/2019 20:00' prior: 36512056!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 6/26/2019 20:00' prior: 36512193!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 7/4/2019 11:55' prior: 36511745!handlesMouseDown: evt		^false.! !----SNAPSHOT----2019-07-17T15:45:47.584507-03:00 Pharo6.0.image priorSource: 2957435!----SNAPSHOT----2019-07-17T15:47:08.463464-03:00 Pharo6.0.image priorSource: 2958069!!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'Anonymous 7/17/2019 17:17' prior: 36511745!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'Anonymous 7/17/2019 17:17' prior: 36512776!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'Anonymous 7/17/2019 17:17' prior: 36512912!handlesMouseDown: evt		^true.! !!PLC_HorizontalLinkMorph methodsFor: 'drawing' stamp: 'Anonymous 7/17/2019 17:22' prior: 35388817!drawElementOn: aCanvas	"Dibujo el rectangulo negro que representa al horizonta link."	aCanvas fillRectangle: self hBar color: Color red.! !!PLC_FunctionBlock class methodsFor: 'Std Counters' stamp: 'Anonymous 7/17/2019 17:25'!createEricFunctionBlockDeclarationWithType: aDataType	"Crea y devuelve una Declaracin del Bloque de Funcin estndar CTD_aDataType"	| pouDecl |		"DECLARACION DE POU"	pouDecl := self		newWithName: 'ERIC'		andDataType: aDataType.			"Agrego la funcin a la biblioteca de funciones estndar"			self addStdFunctionBlock: pouDecl.		"DECLARACIONES DE VARIABLES DE LA POU"	"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'CD' 		).		"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'LD' 		).					"Agrego una declaracion de variable de entrada"	pouDecl inputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'PV' 		).					"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: PLC_DataType Bool			andInitialValue: nil 			andIdentifier: 'Q' 		).				"Agrego una declaracion de variable de salida"	pouDecl outputVarDecls add: ( 		PLC_SymbolicVariableDecl 			newWithDataType: aDataType			andInitialValue: nil 			andIdentifier: 'CV' 		).							"Agrego una declaracion de variable interna persistente de instancia"	"( StdFunctionBlocks at: 'R_EDGE_BOOL' ) Obtengo la declaracin de REDGE desde la biblioteca"	pouDecl varDecls add: ( 		( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL')			instanceDeclForForFBWithIdentifier: 'R_TRIG_IN'		).	"CUERPO DE LA POU"	"Es un cuerpo estandar"	pouDecl pouBody: PLC_StandardBody new.		"Agrego la POU que llama esta pou estandar en su interior"	pouDecl pouBody calledPOUs: ( PLC_FunctionBlock StdFunctionBlocks at: 'R_TRIG_BOOL').		pouDecl pouBody cCode: '			const PLC_INT PVmin = -32768; // Ver esto que esta medio confuso en el estandar,									  // le puse el minimo de PLC Int												// Utilizacin del FB instancia R_TRIG_IN.		// Lo que sigue implementa: CAL R_TRIG_IN(CLK:=CD, Q=>CD)		(pxPOU->R_TRIG_IN).CLK = pxPOU->CD;	// Completo los parametros VAR_INPUT de REDGE		PLC_FB_R_TRIG_BOOL( &(pxPOU->R_TRIG_IN) );	// Llamo a la funcin pasandole la estructura por referencia		pxPOU->CD = (pxPOU->R_TRIG_IN).Q;	// Grabo los parametros VAR_OUTPUT de REDGE a las variables													// a las cuales estan igualadas las VAR_OUTPUT de REDGE		if( pxPOU->LD )		{			pxPOU->CV = pxPOU->PV;		}		else		{			if( pxPOU->CD && (pxPOU->CV > PVmin) )			{				(pxPOU->CV)--;			}		}		pxPOU->Q = (pxPOU->CV <= 0);'.			^ pouDecl.! !!PLC_FunctionBlock class methodsFor: 'Std Function Blocks' stamp: 'Anonymous 7/17/2019 17:26' prior: 34577059!createCounterFunctionBlockDeclarations	"Crea y guarda en la biblioteca los bloques de funcion Contadores"		"CTU"	self createCTUFunctionBlockDeclarationWithType: PLC_DataType Int.	"CTD"	self createCTDFunctionBlockDeclarationWithType:  PLC_DataType Int.		"Eric"	self createEricFunctionBlockDeclarationWithType:  PLC_DataType Int.		"CTUD"	self createCTUDFunctionBlockDeclarationWithType:  PLC_DataType Int.		! !!PLC_FunctionBlock class methodsFor: 'Std Function Blocks' stamp: 'Anonymous 7/17/2019 17:26' prior: 36516282!createCounterFunctionBlockDeclarations	"Crea y guarda en la biblioteca los bloques de funcion Contadores"		"CTU"	self createCTUFunctionBlockDeclarationWithType: PLC_DataType Int.	"CTD"	self createCTDFunctionBlockDeclarationWithType:  PLC_DataType Int.		"Eric"	self createEricFunctionBlockDeclarationWithType:  PLC_DataType Int.		"CTUD"	self createCTUDFunctionBlockDeclarationWithType:  PLC_DataType Int.		! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'Anonymous 7/17/2019 17:27' prior: 36513048!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'Anonymous 9/13/2019 18:47' prior: 36511745!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'Anonymous 9/13/2019 18:47' prior: 36517477!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 10/9/2019 11:38' prior: 36511745!handlesMouseDown: evt		^false.! !----SNAPSHOT----2019-10-09T13:51:37.568819-03:00 Pharo6.0.image priorSource: 2958156!!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 10/11/2019 21:34' prior: 36517750!handlesMouseDown: evt		^true.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 12/3/2019 21:03' prior: 36517750!handlesMouseDown: evt		^false.! !!PasteUpMorph methodsFor: 'as yet unclassified' stamp: 'EricPernia 12/17/2019 13:51' prior: 36517750!handlesMouseDown: evt		^false.! !----SNAPSHOT----2019-12-17T13:51:54.695943-03:00 Pharo6.0.image priorSource: 2963353!----SNAPSHOT----2019-12-17T13:52:04.564943-03:00 Pharo6.0.image priorSource: 2963852!